\hypertarget{worm_8c}{\section{nethack/src/worm.c File Reference}
\label{worm_8c}\index{nethack/src/worm.\+c@{nethack/src/worm.\+c}}
}
{\ttfamily \#include \char`\"{}hack.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}lev.\+h\char`\"{}}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structwseg}{wseg}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{worm_8c_ac2d6ffd6b2f7b1f41ccd075b41cbc10a}{newseg}()~(struct \hyperlink{structwseg}{wseg} $\ast$) \hyperlink{xpm2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(sizeof(struct \hyperlink{structwseg}{wseg}))
\item 
\#define \hyperlink{worm_8c_a1a3e82c0d475a94438a64dd92517e4f3}{dealloc\+\_\+seg}(\hyperlink{structwseg}{wseg})~\hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\+\_\+t}) (\hyperlink{structwseg}{wseg}))
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{worm_8c_a6f13ea4a78ca109e21d6272527aa0256}{F\+D\+E\+C\+L} (\hyperlink{worm_8c_a9f2d1f36f56c623ebecf800c695d5881}{toss\+\_\+wsegs},(struct \hyperlink{structwseg}{wseg} $\ast$, \hyperlink{wingem1_8c_aa2723cc3af18a5199ab4ce7cca84d82b}{B\+O\+O\+L\+E\+A\+N\+\_\+\+P}))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{worm_8c_a9a354c3d45fb46b0659a13c538fe709f}{F\+D\+E\+C\+L} (\hyperlink{worm_8c_a16234a2332d1fe1ced76d50e55d6bb48}{shrink\+\_\+worm},(int))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{worm_8c_aa60399699eb93724a5f117d1304ede8f}{F\+D\+E\+C\+L} (\hyperlink{worm_8c_abff3bf780c1de2576c923ca50a760027}{random\+\_\+dir},(\hyperlink{wingem1_8c_abea04566e20888dd08f477de5f4b9289}{X\+C\+H\+A\+R\+\_\+\+P}, \hyperlink{wingem1_8c_abea04566e20888dd08f477de5f4b9289}{X\+C\+H\+A\+R\+\_\+\+P}, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} $\ast$, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} struct \hyperlink{structwseg}{wseg} $\ast$ \hyperlink{worm_8c_ad5a68387c2cda02e48dec424d1e4b05a}{F\+D\+E\+C\+L} (\hyperlink{worm_8c_af281518e624e43c7f67e62bd89157837}{create\+\_\+worm\+\_\+tail},(int))
\item 
int \hyperlink{worm_8c_ab96a1b71bb8d3d3e793c97f280243188}{get\+\_\+wormno} ()
\item 
void \hyperlink{worm_8c_a05aef5dde943bbd2574310c3893d224c}{initworm} (struct \hyperlink{structmonst}{monst} $\ast$worm, int wseg\+\_\+count)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{worm_8c_a9f2d1f36f56c623ebecf800c695d5881}{toss\+\_\+wsegs} (struct \hyperlink{structwseg}{wseg} $\ast$curr, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} display\+\_\+update)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{worm_8c_a16234a2332d1fe1ced76d50e55d6bb48}{shrink\+\_\+worm} (int wnum)
\item 
void \hyperlink{worm_8c_a49c542788a4a120834b406733ec3fde4}{worm\+\_\+move} (struct \hyperlink{structmonst}{monst} $\ast$worm)
\item 
void \hyperlink{worm_8c_a6b51e1be550c9845a54fa4d7b02a88fc}{worm\+\_\+nomove} (struct \hyperlink{structmonst}{monst} $\ast$worm)
\item 
void \hyperlink{worm_8c_a9f2be33ba7064a89ddc94cc0d890cfa2}{wormgone} (struct \hyperlink{structmonst}{monst} $\ast$worm)
\item 
void \hyperlink{worm_8c_a1ad3e95bd8d6c1acaacbd53d6af5f28f}{wormhitu} (struct \hyperlink{structmonst}{monst} $\ast$worm)
\item 
void \hyperlink{worm_8c_a79a1f54b2e8d6aa7483bb1b6d3cbd83b}{cutworm} (struct \hyperlink{structmonst}{monst} $\ast$worm, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} x, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} y, struct \hyperlink{structobj}{obj} $\ast$weap)
\item 
void \hyperlink{worm_8c_ae1052541ce10767f111a9d22e7761ebc}{see\+\_\+wsegs} (struct \hyperlink{structmonst}{monst} $\ast$worm)
\item 
void \hyperlink{worm_8c_a84d834f52c6685d8bfcf9198c830ae10}{detect\+\_\+wsegs} (struct \hyperlink{structmonst}{monst} $\ast$worm, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} use\+\_\+detection\+\_\+glyph)
\item 
void \hyperlink{worm_8c_ad56054f29cf980ff32aabdc6dde7ad3a}{save\+\_\+worm} (int fd, int mode)
\item 
void \hyperlink{worm_8c_ae4757731ba77b1505eaf868ea938d50f}{rest\+\_\+worm} (int fd)
\item 
void \hyperlink{worm_8c_aa092d65704517ce59bc5b5aa3af2b264}{place\+\_\+wsegs} (struct \hyperlink{structmonst}{monst} $\ast$worm)
\item 
void \hyperlink{worm_8c_ae053c352f0b044f150234f457e7b0a1f}{remove\+\_\+worm} (struct \hyperlink{structmonst}{monst} $\ast$worm)
\item 
void \hyperlink{worm_8c_aa720d031cc0300330fbf45daaa61a260}{place\+\_\+worm\+\_\+tail\+\_\+randomly} (struct \hyperlink{structmonst}{monst} $\ast$worm, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} x, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} y)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{worm_8c_abff3bf780c1de2576c923ca50a760027}{random\+\_\+dir} (\hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} x, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} y, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} $\ast$nx, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} $\ast$ny)
\item 
int \hyperlink{worm_8c_a49d9d0321fe56879dcea667fb15258a2}{count\+\_\+wsegs} (struct \hyperlink{structmonst}{monst} $\ast$mtmp)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} struct \hyperlink{structwseg}{wseg} $\ast$ \hyperlink{worm_8c_af281518e624e43c7f67e62bd89157837}{create\+\_\+worm\+\_\+tail} (int num\+\_\+segs)
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{worm_8c_ae38026b558faadc9a10015ca2376e996}{worm\+\_\+known} (struct \hyperlink{structmonst}{monst} $\ast$worm)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structwseg}{wseg} $\ast$ \hyperlink{worm_8c_a0f633111543ead22d188c52d9eff2c75}{wheads} \mbox{[}\hyperlink{monst_8h_abd692d287679dffe84a4679fba8b32a2}{M\+A\+X\+\_\+\+N\+U\+M\+\_\+\+W\+O\+R\+M\+S}\mbox{]} = \hyperlink{hack_8h_a35beee7b0f2f3e294c4a4a69a5f02df4}{D\+U\+M\+M\+Y}
\item 
struct \hyperlink{structwseg}{wseg} $\ast$ \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails} \mbox{[}\hyperlink{monst_8h_abd692d287679dffe84a4679fba8b32a2}{M\+A\+X\+\_\+\+N\+U\+M\+\_\+\+W\+O\+R\+M\+S}\mbox{]} = \hyperlink{hack_8h_a35beee7b0f2f3e294c4a4a69a5f02df4}{D\+U\+M\+M\+Y}
\item 
long \hyperlink{worm_8c_aca3eeefda6ce7d9142e7432b7a3d90e1}{wgrowtime} \mbox{[}\hyperlink{monst_8h_abd692d287679dffe84a4679fba8b32a2}{M\+A\+X\+\_\+\+N\+U\+M\+\_\+\+W\+O\+R\+M\+S}\mbox{]} = \hyperlink{hack_8h_a35beee7b0f2f3e294c4a4a69a5f02df4}{D\+U\+M\+M\+Y}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{worm_8c_a1a3e82c0d475a94438a64dd92517e4f3}{\index{worm.\+c@{worm.\+c}!dealloc\+\_\+seg@{dealloc\+\_\+seg}}
\index{dealloc\+\_\+seg@{dealloc\+\_\+seg}!worm.\+c@{worm.\+c}}
\subsubsection[{dealloc\+\_\+seg}]{\setlength{\rightskip}{0pt plus 5cm}\#define dealloc\+\_\+seg(
\begin{DoxyParamCaption}
\item[{}]{{\bf wseg}}
\end{DoxyParamCaption}
)~{\bf free}(({\bf genericptr\+\_\+t}) ({\bf wseg}))}}\label{worm_8c_a1a3e82c0d475a94438a64dd92517e4f3}


Definition at line 9 of file worm.\+c.



Referenced by save\+\_\+worm(), and toss\+\_\+wsegs().

\hypertarget{worm_8c_ac2d6ffd6b2f7b1f41ccd075b41cbc10a}{\index{worm.\+c@{worm.\+c}!newseg@{newseg}}
\index{newseg@{newseg}!worm.\+c@{worm.\+c}}
\subsubsection[{newseg}]{\setlength{\rightskip}{0pt plus 5cm}\#define newseg(
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)~(struct {\bf wseg} $\ast$) {\bf alloc}(sizeof(struct {\bf wseg}))}}\label{worm_8c_ac2d6ffd6b2f7b1f41ccd075b41cbc10a}


Definition at line 8 of file worm.\+c.



Referenced by create\+\_\+worm\+\_\+tail(), initworm(), rest\+\_\+worm(), and worm\+\_\+move().



\subsection{Function Documentation}
\hypertarget{worm_8c_a49d9d0321fe56879dcea667fb15258a2}{\index{worm.\+c@{worm.\+c}!count\+\_\+wsegs@{count\+\_\+wsegs}}
\index{count\+\_\+wsegs@{count\+\_\+wsegs}!worm.\+c@{worm.\+c}}
\subsubsection[{count\+\_\+wsegs}]{\setlength{\rightskip}{0pt plus 5cm}int count\+\_\+wsegs (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mtmp}
\end{DoxyParamCaption}
)}}\label{worm_8c_a49d9d0321fe56879dcea667fb15258a2}


Definition at line 682 of file worm.\+c.



References wseg\+::nseg.


\begin{DoxyCode}
684 \{
685     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i=0;
686     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *curr = (\hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[mtmp->wormno])->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg};
687 
688 \textcolor{comment}{/*  if (!mtmp->wormno) return 0;  bullet proofing */}
689 
690     \textcolor{keywordflow}{while} (curr) \{
691     i++;
692     curr = curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg};
693     \}
694 
695     \textcolor{keywordflow}{return} i;
696 \}
\end{DoxyCode}
\hypertarget{worm_8c_af281518e624e43c7f67e62bd89157837}{\index{worm.\+c@{worm.\+c}!create\+\_\+worm\+\_\+tail@{create\+\_\+worm\+\_\+tail}}
\index{create\+\_\+worm\+\_\+tail@{create\+\_\+worm\+\_\+tail}!worm.\+c@{worm.\+c}}
\subsubsection[{create\+\_\+worm\+\_\+tail}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} struct {\bf wseg}$\ast$ create\+\_\+worm\+\_\+tail (
\begin{DoxyParamCaption}
\item[{int}]{num\+\_\+segs}
\end{DoxyParamCaption}
)}}\label{worm_8c_af281518e624e43c7f67e62bd89157837}


Definition at line 704 of file worm.\+c.



References newseg, wseg\+::nseg, wseg\+::wx, and wseg\+::wy.



Referenced by initworm().


\begin{DoxyCode}
706 \{
707     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i=0;
708     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *new\_tail, *curr;
709 
710     \textcolor{keywordflow}{if} (!num\_segs) \textcolor{keywordflow}{return} (\textcolor{keyword}{struct} \hyperlink{structwseg}{wseg} *)0;
711 
712     new\_tail = curr = \hyperlink{worm_8c_ac2d6ffd6b2f7b1f41ccd075b41cbc10a}{newseg}();
713     curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg} = (\textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *)0;
714     curr->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx} = 0;
715     curr->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy} = 0;
716 
717     \textcolor{keywordflow}{while} (i < num\_segs) \{
718     curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg} = \hyperlink{worm_8c_ac2d6ffd6b2f7b1f41ccd075b41cbc10a}{newseg}();
719     curr = curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg};
720     curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg} = (\textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *)0;
721     curr->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx} = 0;
722     curr->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy} = 0;
723     i++;
724     \}
725 
726     \textcolor{keywordflow}{return} (new\_tail);
727 \}
\end{DoxyCode}
\hypertarget{worm_8c_a79a1f54b2e8d6aa7483bb1b6d3cbd83b}{\index{worm.\+c@{worm.\+c}!cutworm@{cutworm}}
\index{cutworm@{cutworm}!worm.\+c@{worm.\+c}}
\subsubsection[{cutworm}]{\setlength{\rightskip}{0pt plus 5cm}void cutworm (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{worm, }
\item[{{\bf xchar}}]{x, }
\item[{{\bf xchar}}]{y, }
\item[{struct {\bf obj} $\ast$}]{weap}
\end{DoxyParamCaption}
)}}\label{worm_8c_a79a1f54b2e8d6aa7483bb1b6d3cbd83b}


Definition at line 315 of file worm.\+c.



References flags, get\+\_\+wormno(), is\+\_\+blade, monst\+::m\+\_\+lev, max, monst\+::mhp, monst\+::mhpmax, flag\+::mon\+\_\+moving, wseg\+::nseg, place\+\_\+wsegs(), remove\+\_\+monster, shrink\+\_\+worm(), toss\+\_\+wsegs(), T\+R\+U\+E, wseg\+::wx, and wseg\+::wy.



Referenced by known\+\_\+hitum(), and thitmonst().


\begin{DoxyCode}
319 \{
320     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg}  *curr, *new\_tail;
321     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structmonst}{monst} *new\_worm;
322     \textcolor{keywordtype}{int} wnum = worm->wormno;
323     \textcolor{keywordtype}{int} cut\_chance, new\_wnum;
324 
325     \textcolor{keywordflow}{if} (!wnum) \textcolor{keywordflow}{return}; \textcolor{comment}{/* bullet proofing */}
326 
327     \textcolor{keywordflow}{if} (x == worm->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx} && y == worm->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my}) \textcolor{keywordflow}{return};     \textcolor{comment}{/* hit on head */}
328 
329     \textcolor{comment}{/* cutting goes best with a bladed weapon */}
330     cut\_chance = rnd(20);   \textcolor{comment}{/* Normally  1-16 does not cut */}
331                 \textcolor{comment}{/* Normally 17-20 does */}
332 
333     \textcolor{keywordflow}{if} (weap && \hyperlink{obj_8h_ae095cd55314db1984d81e3b0103007ca}{is\_blade}(weap)) \textcolor{comment}{/* With a blade 1- 6 does not cut */}
334     cut\_chance += 10;   \textcolor{comment}{/*      7-20 does */}
335 
336     \textcolor{keywordflow}{if} (cut\_chance < 17) \textcolor{keywordflow}{return};    \textcolor{comment}{/* not good enough */}
337 
338     \textcolor{comment}{/* Find the segment that was attacked. */}
339     curr = \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum];
340 
341     \textcolor{keywordflow}{while} ( (curr->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx} != x) || (curr->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy} != y) ) \{
342     curr = curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg};
343     \textcolor{keywordflow}{if} (!curr) \{
344         impossible(\textcolor{stringliteral}{"cutworm: no segment at (%d,%d)"}, (\textcolor{keywordtype}{int}) x, (\textcolor{keywordtype}{int}) y);
345         \textcolor{keywordflow}{return};
346     \}
347     \}
348 
349     \textcolor{comment}{/* If this is the tail segment, then the worm just loses it. */}
350     \textcolor{keywordflow}{if} (curr == \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum]) \{
351     \hyperlink{worm_8c_a16234a2332d1fe1ced76d50e55d6bb48}{shrink\_worm}(wnum);
352     \textcolor{keywordflow}{return};
353     \}
354 
355     \textcolor{comment}{/*}
356 \textcolor{comment}{     *  Split the worm.  The tail for the new worm is the old worm's tail.}
357 \textcolor{comment}{     *  The tail for the old worm is the segment that follows "curr",}
358 \textcolor{comment}{     *  and "curr" becomes the dummy segment under the new head.}
359 \textcolor{comment}{     */}
360     new\_tail = \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum];
361     \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum] = curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg};
362     curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg} = (\textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *) 0; \textcolor{comment}{/* split the worm */}
363 
364     \textcolor{comment}{/*}
365 \textcolor{comment}{     *  At this point, the old worm is correct.  Any new worm will have}
366 \textcolor{comment}{     *  it's head at "curr" and its tail at "new\_tail".}
367 \textcolor{comment}{     */}
368 
369     \textcolor{comment}{/* Sometimes the tail end dies. */}
370     \textcolor{keywordflow}{if} (rn2(3) || !(new\_wnum = \hyperlink{worm_8c_ab96a1b71bb8d3d3e793c97f280243188}{get\_wormno}())) \{
371     \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_aefca97315c578e47f6c6cdf06864db9e}{mon\_moving})
372         pline(\textcolor{stringliteral}{"Part of the tail of %s is cut off."}, mon\_nam(worm));
373     \textcolor{keywordflow}{else}
374         You(\textcolor{stringliteral}{"cut part of the tail off of %s."}, mon\_nam(worm));
375     \hyperlink{worm_8c_a9f2d1f36f56c623ebecf800c695d5881}{toss\_wsegs}(new\_tail, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
376     \textcolor{keywordflow}{if} (worm->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} > 1) worm->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} /= 2;
377     \textcolor{keywordflow}{return};
378     \}
379 
380     \hyperlink{rm_8h_a8b498c0777a4cf5d9894ab76cb6a520e}{remove\_monster}(x, y);     \textcolor{comment}{/* clone\_mon puts new head here */}
381     new\_worm = clone\_mon(worm, x, y);
382     new\_worm->wormno = new\_wnum;    \textcolor{comment}{/* affix new worm number */}
383 
384     \textcolor{comment}{/* Devalue the monster level of both halves of the worm. */}
385     worm->\hyperlink{structmonst_a80ec1118166ea76d347e47d088bd1f7c}{m\_lev} = ((unsigned)worm->\hyperlink{structmonst_a80ec1118166ea76d347e47d088bd1f7c}{m\_lev} <= 3) ?
386            (unsigned)worm->\hyperlink{structmonst_a80ec1118166ea76d347e47d088bd1f7c}{m\_lev} : \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}((\textcolor{keywordtype}{unsigned})worm->\hyperlink{structmonst_a80ec1118166ea76d347e47d088bd1f7c}{m\_lev} - 2, 3);
387     new\_worm->\hyperlink{structmonst_a80ec1118166ea76d347e47d088bd1f7c}{m\_lev} = worm->\hyperlink{structmonst_a80ec1118166ea76d347e47d088bd1f7c}{m\_lev};
388 
389     \textcolor{comment}{/* Calculate the mhp on the new\_worm for the (lower) monster level. */}
390     new\_worm->\hyperlink{structmonst_a66c107319bb7bb318c04e6a0f5f03c60}{mhpmax} = new\_worm->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} = d((\textcolor{keywordtype}{int})new\_worm->\hyperlink{structmonst_a80ec1118166ea76d347e47d088bd1f7c}{m\_lev}, 8);
391 
392     \textcolor{comment}{/* Calculate the mhp on the old worm for the (lower) monster level. */}
393     \textcolor{keywordflow}{if} (worm->\hyperlink{structmonst_a80ec1118166ea76d347e47d088bd1f7c}{m\_lev} > 3) \{
394     worm->\hyperlink{structmonst_a66c107319bb7bb318c04e6a0f5f03c60}{mhpmax} = d((\textcolor{keywordtype}{int})worm->\hyperlink{structmonst_a80ec1118166ea76d347e47d088bd1f7c}{m\_lev}, 8);
395     \textcolor{keywordflow}{if} (worm->\hyperlink{structmonst_a66c107319bb7bb318c04e6a0f5f03c60}{mhpmax} < worm->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp}) worm->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} = worm->\hyperlink{structmonst_a66c107319bb7bb318c04e6a0f5f03c60}{mhpmax};
396     \}
397 
398     \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[new\_wnum] = new\_tail;  \textcolor{comment}{/* We've got all the info right now */}
399     \hyperlink{worm_8c_a0f633111543ead22d188c52d9eff2c75}{wheads}[new\_wnum] = curr;      \textcolor{comment}{/* so we can do this faster than    */}
400     \hyperlink{worm_8c_aca3eeefda6ce7d9142e7432b7a3d90e1}{wgrowtime}[new\_wnum] = 0L;      \textcolor{comment}{/* trying to call initworm().       */}
401 
402     \textcolor{comment}{/* Place the new monster at all the segment locations. */}
403     \hyperlink{worm_8c_aa092d65704517ce59bc5b5aa3af2b264}{place\_wsegs}(new\_worm);
404 
405     \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_aefca97315c578e47f6c6cdf06864db9e}{mon\_moving})
406     pline(\textcolor{stringliteral}{"%s is cut in half."}, Monnam(worm));
407     \textcolor{keywordflow}{else}
408     You(\textcolor{stringliteral}{"cut %s in half."}, mon\_nam(worm));
409 \}
\end{DoxyCode}
\hypertarget{worm_8c_a84d834f52c6685d8bfcf9198c830ae10}{\index{worm.\+c@{worm.\+c}!detect\+\_\+wsegs@{detect\+\_\+wsegs}}
\index{detect\+\_\+wsegs@{detect\+\_\+wsegs}!worm.\+c@{worm.\+c}}
\subsubsection[{detect\+\_\+wsegs}]{\setlength{\rightskip}{0pt plus 5cm}void detect\+\_\+wsegs (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{worm, }
\item[{{\bf boolean}}]{use\+\_\+detection\+\_\+glyph}
\end{DoxyParamCaption}
)}}\label{worm_8c_a84d834f52c6685d8bfcf9198c830ae10}


Definition at line 439 of file worm.\+c.



References detected\+\_\+monnum\+\_\+to\+\_\+glyph, monnum\+\_\+to\+\_\+glyph, wseg\+::nseg, show\+\_\+glyph(), what\+\_\+mon, wseg\+::wx, and wseg\+::wy.



Referenced by monster\+\_\+detect().


\begin{DoxyCode}
442 \{
443     \textcolor{keywordtype}{int} num;
444     \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *curr = \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[worm->wormno];
445 
446 \textcolor{comment}{/*  if (!mtmp->wormno) return;  bullet proofing */}
447 
448     \textcolor{keywordflow}{while} (curr != \hyperlink{worm_8c_a0f633111543ead22d188c52d9eff2c75}{wheads}[worm->wormno]) \{
449     num = use\_detection\_glyph ?
450         \hyperlink{display_8h_abb2c79319464d32507f14995191ab9c8}{detected\_monnum\_to\_glyph}(\hyperlink{display_8h_acff82933acc349b5ecf19a850d2e3005}{what\_mon}(PM\_LONG\_WORM\_TAIL)) :
451         \hyperlink{display_8h_a560cc4daa0badc1538b75ff73d71a995}{monnum\_to\_glyph}(\hyperlink{display_8h_acff82933acc349b5ecf19a850d2e3005}{what\_mon}(PM\_LONG\_WORM\_TAIL));
452     \hyperlink{display_8c_a60d3cfb0df75b80c36125ce154da217f}{show\_glyph}(curr->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx},curr->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy},num);
453     curr = curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg};
454     \}
455 \}
\end{DoxyCode}
\hypertarget{worm_8c_a6f13ea4a78ca109e21d6272527aa0256}{\index{worm.\+c@{worm.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!worm.\+c@{worm.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf toss\+\_\+wsegs}}]{, }
\item[{(struct {\bf wseg} $\ast$, {\bf B\+O\+O\+L\+E\+A\+N\+\_\+\+P})}]{}
\end{DoxyParamCaption}
)}}\label{worm_8c_a6f13ea4a78ca109e21d6272527aa0256}
\hypertarget{worm_8c_a9a354c3d45fb46b0659a13c538fe709f}{\index{worm.\+c@{worm.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!worm.\+c@{worm.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf shrink\+\_\+worm}}]{, }
\item[{(int)}]{}
\end{DoxyParamCaption}
)}}\label{worm_8c_a9a354c3d45fb46b0659a13c538fe709f}
\hypertarget{worm_8c_aa60399699eb93724a5f117d1304ede8f}{\index{worm.\+c@{worm.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!worm.\+c@{worm.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf random\+\_\+dir}}]{, }
\item[{({\bf X\+C\+H\+A\+R\+\_\+\+P}, {\bf X\+C\+H\+A\+R\+\_\+\+P}, {\bf xchar} $\ast$, {\bf xchar} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{worm_8c_aa60399699eb93724a5f117d1304ede8f}
\hypertarget{worm_8c_ad5a68387c2cda02e48dec424d1e4b05a}{\index{worm.\+c@{worm.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!worm.\+c@{worm.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} struct {\bf wseg}$\ast$ F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf create\+\_\+worm\+\_\+tail}}]{, }
\item[{(int)}]{}
\end{DoxyParamCaption}
)}}\label{worm_8c_ad5a68387c2cda02e48dec424d1e4b05a}
\hypertarget{worm_8c_ab96a1b71bb8d3d3e793c97f280243188}{\index{worm.\+c@{worm.\+c}!get\+\_\+wormno@{get\+\_\+wormno}}
\index{get\+\_\+wormno@{get\+\_\+wormno}!worm.\+c@{worm.\+c}}
\subsubsection[{get\+\_\+wormno}]{\setlength{\rightskip}{0pt plus 5cm}int get\+\_\+wormno (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{worm_8c_ab96a1b71bb8d3d3e793c97f280243188}


Definition at line 86 of file worm.\+c.



References M\+A\+X\+\_\+\+N\+U\+M\+\_\+\+W\+O\+R\+M\+S.



Referenced by cutworm().


\begin{DoxyCode}
87 \{
88     \textcolor{keyword}{register} \textcolor{keywordtype}{int} new\_wormno = 1;
89 
90     \textcolor{keywordflow}{while} (new\_wormno < \hyperlink{monst_8h_abd692d287679dffe84a4679fba8b32a2}{MAX\_NUM\_WORMS}) \{
91     \textcolor{keywordflow}{if} (!\hyperlink{worm_8c_a0f633111543ead22d188c52d9eff2c75}{wheads}[new\_wormno])
92         \textcolor{keywordflow}{return} new\_wormno; \textcolor{comment}{/* found an empty wtails[] slot at new\_wormno */}
93     new\_wormno++;
94     \}
95 
96     \textcolor{keywordflow}{return}(0);  \textcolor{comment}{/* level infested with worms */}
97 \}
\end{DoxyCode}
\hypertarget{worm_8c_a05aef5dde943bbd2574310c3893d224c}{\index{worm.\+c@{worm.\+c}!initworm@{initworm}}
\index{initworm@{initworm}!worm.\+c@{worm.\+c}}
\subsubsection[{initworm}]{\setlength{\rightskip}{0pt plus 5cm}void initworm (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{worm, }
\item[{int}]{wseg\+\_\+count}
\end{DoxyParamCaption}
)}}\label{worm_8c_a05aef5dde943bbd2574310c3893d224c}


Definition at line 111 of file worm.\+c.



References create\+\_\+worm\+\_\+tail(), newseg, wseg\+::nseg, wseg\+::wx, and wseg\+::wy.


\begin{DoxyCode}
114 \{
115     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *seg, *new\_tail = \hyperlink{worm_8c_af281518e624e43c7f67e62bd89157837}{create\_worm\_tail}(wseg\_count);
116     \textcolor{keyword}{register} \textcolor{keywordtype}{int} wnum = worm->wormno;
117 
118 \textcolor{comment}{/*  if (!wnum) return;  bullet proofing */}
119 
120     \textcolor{keywordflow}{if} (new\_tail) \{
121     \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum] = new\_tail;
122     \textcolor{keywordflow}{for} (seg = new\_tail; seg->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg}; seg = seg->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg});
123     \hyperlink{worm_8c_a0f633111543ead22d188c52d9eff2c75}{wheads}[wnum] = seg;
124     \} \textcolor{keywordflow}{else} \{
125     \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum] = \hyperlink{worm_8c_a0f633111543ead22d188c52d9eff2c75}{wheads}[wnum] = seg = \hyperlink{worm_8c_ac2d6ffd6b2f7b1f41ccd075b41cbc10a}{newseg}();
126     seg->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg}    = (\textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *) 0;
127     seg->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx}      = worm->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx};
128     seg->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy}      = worm->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my};
129     \}
130     \hyperlink{worm_8c_aca3eeefda6ce7d9142e7432b7a3d90e1}{wgrowtime}[wnum] = 0L;
131 \}
\end{DoxyCode}
\hypertarget{worm_8c_aa720d031cc0300330fbf45daaa61a260}{\index{worm.\+c@{worm.\+c}!place\+\_\+worm\+\_\+tail\+\_\+randomly@{place\+\_\+worm\+\_\+tail\+\_\+randomly}}
\index{place\+\_\+worm\+\_\+tail\+\_\+randomly@{place\+\_\+worm\+\_\+tail\+\_\+randomly}!worm.\+c@{worm.\+c}}
\subsubsection[{place\+\_\+worm\+\_\+tail\+\_\+randomly}]{\setlength{\rightskip}{0pt plus 5cm}void place\+\_\+worm\+\_\+tail\+\_\+randomly (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{worm, }
\item[{{\bf xchar}}]{x, }
\item[{{\bf xchar}}]{y}
\end{DoxyParamCaption}
)}}\label{worm_8c_aa720d031cc0300330fbf45daaa61a260}


Definition at line 590 of file worm.\+c.



References F\+A\+L\+S\+E, goodpos(), newsym(), wseg\+::nseg, place\+\_\+worm\+\_\+seg, random\+\_\+dir(), toss\+\_\+wsegs(), wseg\+::wx, and wseg\+::wy.



Referenced by rloc\+\_\+to().


\begin{DoxyCode}
593 \{
594     \textcolor{keywordtype}{int} wnum = worm->wormno;
595     \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *curr = \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum];
596     \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *new\_tail;
597     \textcolor{keyword}{register} \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} ox = x, oy = y;
598 
599 \textcolor{comment}{/*  if (!wnum) return;  bullet proofing */}
600 
601     \textcolor{keywordflow}{if} (wnum && (!\hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum] || !\hyperlink{worm_8c_a0f633111543ead22d188c52d9eff2c75}{wheads}[wnum]) ) \{
602     impossible(\textcolor{stringliteral}{"place\_worm\_tail\_randomly: wormno is set without a tail!"});
603     \textcolor{keywordflow}{return};
604     \}
605 
606     \hyperlink{worm_8c_a0f633111543ead22d188c52d9eff2c75}{wheads}[wnum] = new\_tail = curr;
607     curr = curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg};
608     new\_tail->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg} = (\textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *) 0;
609     new\_tail->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx} = x;
610     new\_tail->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy} = y;
611 
612     \textcolor{keywordflow}{while}(curr)  \{
613     \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} nx, ny;
614     \textcolor{keywordtype}{char} tryct = 0;
615 
616     \textcolor{comment}{/* pick a random direction from x, y and search for goodpos() */}
617 
618     \textcolor{keywordflow}{do} \{
619         \hyperlink{worm_8c_abff3bf780c1de2576c923ca50a760027}{random\_dir}(ox, oy, &nx, &ny);
620     \} \textcolor{keywordflow}{while} (!\hyperlink{teleport_8c_a6eccfce2bb34ffe646ba537130d622e3}{goodpos}(nx, ny, worm, 0) && (tryct++ < 50));
621 
622     \textcolor{keywordflow}{if} (tryct < 50)  \{
623         \hyperlink{rm_8h_a4bd0ea47804af3458cc53c6aa4123746}{place\_worm\_seg}(worm, nx, ny);
624         curr->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx} = ox = nx;
625         curr->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy} = oy = ny;
626         \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum] = curr;
627         curr = curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg};
628         \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum]->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg} = new\_tail;
629         new\_tail = \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum];
630         \hyperlink{display_8c_a185c6ad6e4c5a6be26a371b9aa17c32e}{newsym}(nx, ny);
631     \} \textcolor{keywordflow}{else} \{            \textcolor{comment}{/* Oops.  Truncate because there was */}
632         \hyperlink{worm_8c_a9f2d1f36f56c623ebecf800c695d5881}{toss\_wsegs}(curr, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});    \textcolor{comment}{/* no place for the rest of it */}
633         curr = (\textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *) 0;
634     \}
635     \}
636 \}
\end{DoxyCode}
\hypertarget{worm_8c_aa092d65704517ce59bc5b5aa3af2b264}{\index{worm.\+c@{worm.\+c}!place\+\_\+wsegs@{place\+\_\+wsegs}}
\index{place\+\_\+wsegs@{place\+\_\+wsegs}!worm.\+c@{worm.\+c}}
\subsubsection[{place\+\_\+wsegs}]{\setlength{\rightskip}{0pt plus 5cm}void place\+\_\+wsegs (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{worm}
\end{DoxyParamCaption}
)}}\label{worm_8c_aa092d65704517ce59bc5b5aa3af2b264}


Definition at line 544 of file worm.\+c.



References wseg\+::nseg, place\+\_\+worm\+\_\+seg, wseg\+::wx, and wseg\+::wy.



Referenced by cutworm(), and getlev().


\begin{DoxyCode}
546 \{
547     \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *curr = \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[worm->wormno];
548 
549 \textcolor{comment}{/*  if (!mtmp->wormno) return;  bullet proofing */}
550 
551     \textcolor{keywordflow}{while} (curr != \hyperlink{worm_8c_a0f633111543ead22d188c52d9eff2c75}{wheads}[worm->wormno]) \{
552     \hyperlink{rm_8h_a4bd0ea47804af3458cc53c6aa4123746}{place\_worm\_seg}(worm,curr->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx},curr->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy});
553     curr = curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg};
554     \}
555 \}
\end{DoxyCode}
\hypertarget{worm_8c_abff3bf780c1de2576c923ca50a760027}{\index{worm.\+c@{worm.\+c}!random\+\_\+dir@{random\+\_\+dir}}
\index{random\+\_\+dir@{random\+\_\+dir}!worm.\+c@{worm.\+c}}
\subsubsection[{random\+\_\+dir}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void random\+\_\+dir (
\begin{DoxyParamCaption}
\item[{{\bf xchar}}]{x, }
\item[{{\bf xchar}}]{y, }
\item[{{\bf xchar} $\ast$}]{nx, }
\item[{{\bf xchar} $\ast$}]{ny}
\end{DoxyParamCaption}
)}}\label{worm_8c_abff3bf780c1de2576c923ca50a760027}


Definition at line 647 of file worm.\+c.



References C\+O\+L\+N\+O, and R\+O\+W\+N\+O.



Referenced by place\+\_\+worm\+\_\+tail\+\_\+randomly().


\begin{DoxyCode}
650 \{
651     *nx = x;
652     *ny = y;
653 
654     *nx += (x > 1 ?         \textcolor{comment}{/* extreme left ? */}
655         (x < \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO} ?        \textcolor{comment}{/* extreme right ? */}
656             (rn2(3) - 1)      \textcolor{comment}{/* neither so +1, 0, or -1 */}
657         :   -rn2(2))     \textcolor{comment}{/* 0, or -1 */}
658        :    rn2(2));        \textcolor{comment}{/* 0, or 1 */}
659 
660     *ny += (*nx == x ?          \textcolor{comment}{/* same kind of thing with y */}
661         (y > 1 ?
662             (y < \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO} ?
663             (rn2(2) ?
664                 1
665             :   -1)
666             :   -1)
667         :   1)
668         :   (y > 1 ?
669             (y < \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO} ?
670             (rn2(3) - 1)
671             :   -rn2(2))
672         :   rn2(2)));
673 \}
\end{DoxyCode}
\hypertarget{worm_8c_ae053c352f0b044f150234f457e7b0a1f}{\index{worm.\+c@{worm.\+c}!remove\+\_\+worm@{remove\+\_\+worm}}
\index{remove\+\_\+worm@{remove\+\_\+worm}!worm.\+c@{worm.\+c}}
\subsubsection[{remove\+\_\+worm}]{\setlength{\rightskip}{0pt plus 5cm}void remove\+\_\+worm (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{worm}
\end{DoxyParamCaption}
)}}\label{worm_8c_ae053c352f0b044f150234f457e7b0a1f}


Definition at line 566 of file worm.\+c.



References newsym(), wseg\+::nseg, remove\+\_\+monster, wseg\+::wx, and wseg\+::wy.



Referenced by movebubbles(), and rloc\+\_\+to().


\begin{DoxyCode}
568 \{
569     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *curr = \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[worm->wormno];
570 
571 \textcolor{comment}{/*  if (!mtmp->wormno) return;  bullet proofing */}
572 
573     \textcolor{keywordflow}{while} (curr) \{
574     \hyperlink{rm_8h_a8b498c0777a4cf5d9894ab76cb6a520e}{remove\_monster}(curr->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx}, curr->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy});
575     \hyperlink{display_8c_a185c6ad6e4c5a6be26a371b9aa17c32e}{newsym}(curr->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx}, curr->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy});
576     curr = curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg};
577     \}
578 \}
\end{DoxyCode}
\hypertarget{worm_8c_ae4757731ba77b1505eaf868ea938d50f}{\index{worm.\+c@{worm.\+c}!rest\+\_\+worm@{rest\+\_\+worm}}
\index{rest\+\_\+worm@{rest\+\_\+worm}!worm.\+c@{worm.\+c}}
\subsubsection[{rest\+\_\+worm}]{\setlength{\rightskip}{0pt plus 5cm}void rest\+\_\+worm (
\begin{DoxyParamCaption}
\item[{int}]{fd}
\end{DoxyParamCaption}
)}}\label{worm_8c_ae4757731ba77b1505eaf868ea938d50f}


Definition at line 511 of file worm.\+c.



References count, M\+A\+X\+\_\+\+N\+U\+M\+\_\+\+W\+O\+R\+M\+S, mread(), newseg, wseg\+::nseg, temp, wseg\+::wx, and wseg\+::wy.



Referenced by getlev().


\begin{DoxyCode}
513 \{
514     \textcolor{keywordtype}{int} i, j, \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
515     \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *curr, *\hyperlink{makedefs_8c_a1eb0cd7f6bb3372ee8b5373484271c74}{temp};
516 
517     \textcolor{keywordflow}{for} (i = 1; i < \hyperlink{monst_8h_abd692d287679dffe84a4679fba8b32a2}{MAX\_NUM\_WORMS}; i++) \{
518     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &count, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
519     \textcolor{keywordflow}{if} (!count) \textcolor{keywordflow}{continue};   \textcolor{comment}{/* none */}
520 
521     \textcolor{comment}{/* Get the segments. */}
522     \textcolor{keywordflow}{for} (curr = (\textcolor{keyword}{struct} \hyperlink{structwseg}{wseg} *) 0, j = 0; j < \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}; j++) \{
523         temp = \hyperlink{worm_8c_ac2d6ffd6b2f7b1f41ccd075b41cbc10a}{newseg}();
524         temp->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg} = (\textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *) 0;
525         \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &(temp->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx}), \textcolor{keyword}{sizeof}(\hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar}));
526         \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &(temp->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy}), \textcolor{keyword}{sizeof}(\hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar}));
527         \textcolor{keywordflow}{if} (curr)
528         curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg} = \hyperlink{makedefs_8c_a1eb0cd7f6bb3372ee8b5373484271c74}{temp};
529         \textcolor{keywordflow}{else}
530         \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[i] = \hyperlink{makedefs_8c_a1eb0cd7f6bb3372ee8b5373484271c74}{temp};
531         curr = \hyperlink{makedefs_8c_a1eb0cd7f6bb3372ee8b5373484271c74}{temp};
532     \}
533     \hyperlink{worm_8c_a0f633111543ead22d188c52d9eff2c75}{wheads}[i] = curr;
534     \}
535     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) \hyperlink{worm_8c_aca3eeefda6ce7d9142e7432b7a3d90e1}{wgrowtime}, \textcolor{keyword}{sizeof}(wgrowtime));
536 \}
\end{DoxyCode}
\hypertarget{worm_8c_ad56054f29cf980ff32aabdc6dde7ad3a}{\index{worm.\+c@{worm.\+c}!save\+\_\+worm@{save\+\_\+worm}}
\index{save\+\_\+worm@{save\+\_\+worm}!worm.\+c@{worm.\+c}}
\subsubsection[{save\+\_\+worm}]{\setlength{\rightskip}{0pt plus 5cm}void save\+\_\+worm (
\begin{DoxyParamCaption}
\item[{int}]{fd, }
\item[{int}]{mode}
\end{DoxyParamCaption}
)}}\label{worm_8c_ad56054f29cf980ff32aabdc6dde7ad3a}


Definition at line 465 of file worm.\+c.



References bwrite(), count, dealloc\+\_\+seg, M\+A\+X\+\_\+\+N\+U\+M\+\_\+\+W\+O\+R\+M\+S, wseg\+::nseg, perform\+\_\+bwrite, release\+\_\+data, temp, wseg\+::wx, and wseg\+::wy.



Referenced by savelev().


\begin{DoxyCode}
467 \{
468     \textcolor{keywordtype}{int} i;
469     \textcolor{keywordtype}{int} \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
470     \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *curr, *\hyperlink{makedefs_8c_a1eb0cd7f6bb3372ee8b5373484271c74}{temp};
471 
472     \textcolor{keywordflow}{if} (\hyperlink{lev_8h_a4bb5a4c92746bd81c40d1452ca38dda7}{perform\_bwrite}(mode)) \{
473     \textcolor{keywordflow}{for} (i = 1; i < \hyperlink{monst_8h_abd692d287679dffe84a4679fba8b32a2}{MAX\_NUM\_WORMS}; i++) \{
474         \textcolor{keywordflow}{for} (count = 0, curr = \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[i]; curr; curr = curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg}) count++;
475         \textcolor{comment}{/* Save number of segments */}
476         \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &count, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
477         \textcolor{comment}{/* Save segment locations of the monster. */}
478         \textcolor{keywordflow}{if} (count) \{
479         \textcolor{keywordflow}{for} (curr = \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[i]; curr; curr = curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg}) \{
480             \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &(curr->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx}), \textcolor{keyword}{sizeof}(
      \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar}));
481             \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &(curr->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy}), \textcolor{keyword}{sizeof}(
      \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar}));
482         \}
483         \}
484     \}
485     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) \hyperlink{worm_8c_aca3eeefda6ce7d9142e7432b7a3d90e1}{wgrowtime}, \textcolor{keyword}{sizeof}(wgrowtime));
486     \}
487 
488     \textcolor{keywordflow}{if} (\hyperlink{lev_8h_a3d5ce4c0a0247545f80a66eadddc6273}{release\_data}(mode)) \{
489     \textcolor{comment}{/* Free the segments only.  savemonchn() will take care of the}
490 \textcolor{comment}{     * monsters. */}
491     \textcolor{keywordflow}{for} (i = 1; i < \hyperlink{monst_8h_abd692d287679dffe84a4679fba8b32a2}{MAX\_NUM\_WORMS}; i++) \{
492         \textcolor{keywordflow}{if} (!(curr = \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[i])) \textcolor{keywordflow}{continue};
493 
494         \textcolor{keywordflow}{while} (curr) \{
495         temp = curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg};
496         \hyperlink{worm_8c_a1a3e82c0d475a94438a64dd92517e4f3}{dealloc\_seg}(curr);       \textcolor{comment}{/* free the segment */}
497         curr = \hyperlink{makedefs_8c_a1eb0cd7f6bb3372ee8b5373484271c74}{temp};
498         \}
499         \hyperlink{worm_8c_a0f633111543ead22d188c52d9eff2c75}{wheads}[i] = \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[i] = (\textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *) 0;
500     \}
501     \}
502 
503 \}
\end{DoxyCode}
\hypertarget{worm_8c_ae1052541ce10767f111a9d22e7761ebc}{\index{worm.\+c@{worm.\+c}!see\+\_\+wsegs@{see\+\_\+wsegs}}
\index{see\+\_\+wsegs@{see\+\_\+wsegs}!worm.\+c@{worm.\+c}}
\subsubsection[{see\+\_\+wsegs}]{\setlength{\rightskip}{0pt plus 5cm}void see\+\_\+wsegs (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{worm}
\end{DoxyParamCaption}
)}}\label{worm_8c_ae1052541ce10767f111a9d22e7761ebc}


Definition at line 420 of file worm.\+c.



References newsym(), wseg\+::nseg, wseg\+::wx, and wseg\+::wy.



Referenced by mon\+\_\+set\+\_\+minvis(), and see\+\_\+monsters().


\begin{DoxyCode}
422 \{
423     \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *curr = \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[worm->wormno];
424 
425 \textcolor{comment}{/*  if (!mtmp->wormno) return;  bullet proofing */}
426 
427     \textcolor{keywordflow}{while} (curr != \hyperlink{worm_8c_a0f633111543ead22d188c52d9eff2c75}{wheads}[worm->wormno]) \{
428     \hyperlink{display_8c_a185c6ad6e4c5a6be26a371b9aa17c32e}{newsym}(curr->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx},curr->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy});
429     curr = curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg};
430     \}
431 \}
\end{DoxyCode}
\hypertarget{worm_8c_a16234a2332d1fe1ced76d50e55d6bb48}{\index{worm.\+c@{worm.\+c}!shrink\+\_\+worm@{shrink\+\_\+worm}}
\index{shrink\+\_\+worm@{shrink\+\_\+worm}!worm.\+c@{worm.\+c}}
\subsubsection[{shrink\+\_\+worm}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void shrink\+\_\+worm (
\begin{DoxyParamCaption}
\item[{int}]{wnum}
\end{DoxyParamCaption}
)}}\label{worm_8c_a16234a2332d1fe1ced76d50e55d6bb48}


Definition at line 175 of file worm.\+c.



References wseg\+::nseg, toss\+\_\+wsegs(), and T\+R\+U\+E.



Referenced by cutworm(), worm\+\_\+move(), and worm\+\_\+nomove().


\begin{DoxyCode}
177 \{
178     \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *seg;
179 
180     \textcolor{keywordflow}{if} (\hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum] == \hyperlink{worm_8c_a0f633111543ead22d188c52d9eff2c75}{wheads}[wnum]) \textcolor{keywordflow}{return};   \textcolor{comment}{/* no tail */}
181 
182     seg = \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum];
183     \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum] = seg->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg};
184     seg->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg} = (\textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *) 0;
185     \hyperlink{worm_8c_a9f2d1f36f56c623ebecf800c695d5881}{toss\_wsegs}(seg, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
186 \}
\end{DoxyCode}
\hypertarget{worm_8c_a9f2d1f36f56c623ebecf800c695d5881}{\index{worm.\+c@{worm.\+c}!toss\+\_\+wsegs@{toss\+\_\+wsegs}}
\index{toss\+\_\+wsegs@{toss\+\_\+wsegs}!worm.\+c@{worm.\+c}}
\subsubsection[{toss\+\_\+wsegs}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void toss\+\_\+wsegs (
\begin{DoxyParamCaption}
\item[{struct {\bf wseg} $\ast$}]{curr, }
\item[{{\bf boolean}}]{display\+\_\+update}
\end{DoxyParamCaption}
)}}\label{worm_8c_a9f2d1f36f56c623ebecf800c695d5881}


Definition at line 142 of file worm.\+c.



References dealloc\+\_\+seg, newsym(), wseg\+::nseg, and remove\+\_\+monster.



Referenced by cutworm(), place\+\_\+worm\+\_\+tail\+\_\+randomly(), shrink\+\_\+worm(), and wormgone().


\begin{DoxyCode}
145 \{
146     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *seg;
147 
148     \textcolor{keywordflow}{while} (curr) \{
149     seg = curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg};
150 
151     \textcolor{comment}{/* remove from level.monsters[][] */}
152 
153     \textcolor{comment}{/* need to check curr->wx for genocided while migrating\_mon */}
154     \textcolor{keywordflow}{if} (curr->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx}) \{
155         \hyperlink{rm_8h_a8b498c0777a4cf5d9894ab76cb6a520e}{remove\_monster}(curr->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx}, curr->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy});
156 
157         \textcolor{comment}{/* update screen before deallocation */}
158         \textcolor{keywordflow}{if} (display\_update) \hyperlink{display_8c_a185c6ad6e4c5a6be26a371b9aa17c32e}{newsym}(curr->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx},curr->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy});
159     \}
160 
161     \textcolor{comment}{/* free memory used by the segment */}
162     \hyperlink{worm_8c_a1a3e82c0d475a94438a64dd92517e4f3}{dealloc\_seg}(curr);
163     curr = seg;
164     \}
165 \}
\end{DoxyCode}
\hypertarget{worm_8c_ae38026b558faadc9a10015ca2376e996}{\index{worm.\+c@{worm.\+c}!worm\+\_\+known@{worm\+\_\+known}}
\index{worm\+\_\+known@{worm\+\_\+known}!worm.\+c@{worm.\+c}}
\subsubsection[{worm\+\_\+known}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} worm\+\_\+known (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{worm}
\end{DoxyParamCaption}
)}}\label{worm_8c_ae38026b558faadc9a10015ca2376e996}


Definition at line 736 of file worm.\+c.



References cansee, F\+A\+L\+S\+E, wseg\+::nseg, T\+R\+U\+E, wseg\+::wx, and wseg\+::wy.



Referenced by lookat().


\begin{DoxyCode}
738 \{
739     \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *curr = \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[worm->wormno];
740 
741     \textcolor{keywordflow}{while} (curr) \{
742     \textcolor{keywordflow}{if}(\hyperlink{vision_8h_a857efc720262bc13a9e4b4bcbb079b5c}{cansee}(curr->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx},curr->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy})) \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
743     curr = curr->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg};
744     \}
745     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
746 \}
\end{DoxyCode}
\hypertarget{worm_8c_a49c542788a4a120834b406733ec3fde4}{\index{worm.\+c@{worm.\+c}!worm\+\_\+move@{worm\+\_\+move}}
\index{worm\+\_\+move@{worm\+\_\+move}!worm.\+c@{worm.\+c}}
\subsubsection[{worm\+\_\+move}]{\setlength{\rightskip}{0pt plus 5cm}void worm\+\_\+move (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{worm}
\end{DoxyParamCaption}
)}}\label{worm_8c_a49c542788a4a120834b406733ec3fde4}


Definition at line 196 of file worm.\+c.



References M\+H\+P\+M\+A\+X, moves, newseg, newsym(), wseg\+::nseg, place\+\_\+worm\+\_\+seg, rn1, shrink\+\_\+worm(), wseg\+::wx, and wseg\+::wy.



Referenced by use\+\_\+defensive(), and use\+\_\+misc().


\begin{DoxyCode}
198 \{
199     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *seg, *new\_seg;    \textcolor{comment}{/* new segment */}
200     \textcolor{keyword}{register} \textcolor{keywordtype}{int}     wnum = worm->wormno;   \textcolor{comment}{/* worm number */}
201 
202 
203 \textcolor{comment}{/*  if (!wnum) return;  bullet proofing */}
204 
205     \textcolor{comment}{/*}
206 \textcolor{comment}{     *  Place a segment at the old worm head.  The head has already moved.}
207 \textcolor{comment}{     */}
208     seg = \hyperlink{worm_8c_a0f633111543ead22d188c52d9eff2c75}{wheads}[wnum];
209     \hyperlink{rm_8h_a4bd0ea47804af3458cc53c6aa4123746}{place\_worm\_seg}(worm, seg->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx}, seg->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy});
210     \hyperlink{display_8c_a185c6ad6e4c5a6be26a371b9aa17c32e}{newsym}(seg->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx},seg->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy});      \textcolor{comment}{/* display the new segment */}
211 
212     \textcolor{comment}{/*}
213 \textcolor{comment}{     *  Create a new dummy segment head and place it at the end of the list.}
214 \textcolor{comment}{     */}
215     new\_seg       = \hyperlink{worm_8c_ac2d6ffd6b2f7b1f41ccd075b41cbc10a}{newseg}();
216     new\_seg->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx}   = worm->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx};
217     new\_seg->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy}   = worm->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my};
218     new\_seg->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg} = (\textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *) 0;
219     seg->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg}     = new\_seg;        \textcolor{comment}{/* attach it to the end of the list */}
220     \hyperlink{worm_8c_a0f633111543ead22d188c52d9eff2c75}{wheads}[wnum]  = new\_seg;      \textcolor{comment}{/* move the end pointer */}
221 
222 
223     \textcolor{keywordflow}{if} (\hyperlink{worm_8c_aca3eeefda6ce7d9142e7432b7a3d90e1}{wgrowtime}[wnum] <= \hyperlink{decl_8h_a2ccad6e8fb93740ed50c6d9a8f72ce2f}{moves}) \{
224     \textcolor{keywordflow}{if} (!\hyperlink{worm_8c_aca3eeefda6ce7d9142e7432b7a3d90e1}{wgrowtime}[wnum])
225         \hyperlink{worm_8c_aca3eeefda6ce7d9142e7432b7a3d90e1}{wgrowtime}[wnum] = \hyperlink{decl_8h_a2ccad6e8fb93740ed50c6d9a8f72ce2f}{moves} + rnd(5);
226     \textcolor{keywordflow}{else}
227         \hyperlink{worm_8c_aca3eeefda6ce7d9142e7432b7a3d90e1}{wgrowtime}[wnum] += \hyperlink{hack_8h_af107ca092682647f298989038020f9c8}{rn1}(15, 3);
228     worm->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} += 3;
229     \textcolor{keywordflow}{if} (worm->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} > \hyperlink{global_8h_ab8e75a79e9f6f087c2bf178df44dc6cb}{MHPMAX}) worm->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} = \hyperlink{global_8h_ab8e75a79e9f6f087c2bf178df44dc6cb}{MHPMAX};
230     \textcolor{keywordflow}{if} (worm->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} > worm->\hyperlink{structmonst_a66c107319bb7bb318c04e6a0f5f03c60}{mhpmax}) worm->\hyperlink{structmonst_a66c107319bb7bb318c04e6a0f5f03c60}{mhpmax} = worm->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp};
231     \} \textcolor{keywordflow}{else}
232     \textcolor{comment}{/* The worm doesn't grow, so the last segment goes away. */}
233     \hyperlink{worm_8c_a16234a2332d1fe1ced76d50e55d6bb48}{shrink\_worm}(wnum);
234 \}
\end{DoxyCode}
\hypertarget{worm_8c_a6b51e1be550c9845a54fa4d7b02a88fc}{\index{worm.\+c@{worm.\+c}!worm\+\_\+nomove@{worm\+\_\+nomove}}
\index{worm\+\_\+nomove@{worm\+\_\+nomove}!worm.\+c@{worm.\+c}}
\subsubsection[{worm\+\_\+nomove}]{\setlength{\rightskip}{0pt plus 5cm}void worm\+\_\+nomove (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{worm}
\end{DoxyParamCaption}
)}}\label{worm_8c_a6b51e1be550c9845a54fa4d7b02a88fc}


Definition at line 244 of file worm.\+c.



References shrink\+\_\+worm().


\begin{DoxyCode}
246 \{
247     \hyperlink{worm_8c_a16234a2332d1fe1ced76d50e55d6bb48}{shrink\_worm}((\textcolor{keywordtype}{int}) worm->wormno); \textcolor{comment}{/* shrink */}
248 
249     \textcolor{keywordflow}{if} (worm->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} > 3)
250     worm->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} -= 3;      \textcolor{comment}{/* mhpmax not changed ! */}
251     \textcolor{keywordflow}{else}
252     worm->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} = 1;
253 \}
\end{DoxyCode}
\hypertarget{worm_8c_a9f2be33ba7064a89ddc94cc0d890cfa2}{\index{worm.\+c@{worm.\+c}!wormgone@{wormgone}}
\index{wormgone@{wormgone}!worm.\+c@{worm.\+c}}
\subsubsection[{wormgone}]{\setlength{\rightskip}{0pt plus 5cm}void wormgone (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{worm}
\end{DoxyParamCaption}
)}}\label{worm_8c_a9f2be33ba7064a89ddc94cc0d890cfa2}


Definition at line 263 of file worm.\+c.



References toss\+\_\+wsegs(), and T\+R\+U\+E.


\begin{DoxyCode}
265 \{
266     \textcolor{keyword}{register} \textcolor{keywordtype}{int} wnum = worm->wormno;
267 
268 \textcolor{comment}{/*  if (!wnum) return;  bullet proofing */}
269 
270     worm->wormno = 0;
271 
272     \textcolor{comment}{/*  This will also remove the real monster (ie 'w') from the its}
273 \textcolor{comment}{     *  position in level.monsters[][].}
274 \textcolor{comment}{     */}
275     \hyperlink{worm_8c_a9f2d1f36f56c623ebecf800c695d5881}{toss\_wsegs}(\hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum], \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
276 
277     \hyperlink{worm_8c_a0f633111543ead22d188c52d9eff2c75}{wheads}[wnum] = \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum] = (\textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *) 0;
278 \}
\end{DoxyCode}
\hypertarget{worm_8c_a1ad3e95bd8d6c1acaacbd53d6af5f28f}{\index{worm.\+c@{worm.\+c}!wormhitu@{wormhitu}}
\index{wormhitu@{wormhitu}!worm.\+c@{worm.\+c}}
\subsubsection[{wormhitu}]{\setlength{\rightskip}{0pt plus 5cm}void wormhitu (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{worm}
\end{DoxyParamCaption}
)}}\label{worm_8c_a1ad3e95bd8d6c1acaacbd53d6af5f28f}


Definition at line 288 of file worm.\+c.



References distu, wseg\+::nseg, wseg\+::wx, and wseg\+::wy.


\begin{DoxyCode}
290 \{
291     \textcolor{keyword}{register} \textcolor{keywordtype}{int} wnum = worm->wormno;
292     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structwseg}{wseg} *seg;
293 
294 \textcolor{comment}{/*  if (!wnum) return;  bullet proofing */}
295 
296 \textcolor{comment}{/*  This does not work right now because mattacku() thinks that the head is}
297 \textcolor{comment}{ *  out of range of the player.  We might try to kludge, and bring the head}
298 \textcolor{comment}{ *  within range for a tiny moment, but this needs a bit more looking at}
299 \textcolor{comment}{ *  before we decide to do this.}
300 \textcolor{comment}{ */}
301     \textcolor{keywordflow}{for} (seg = \hyperlink{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{wtails}[wnum]; seg; seg = seg->\hyperlink{structwseg_ae644fa0cb01dacf54cc5a17c614cd313}{nseg})
302     \textcolor{keywordflow}{if} (\hyperlink{hack_8h_a1f84afcae19c5b60124bc509ed647f84}{distu}(seg->\hyperlink{structwseg_abb5c94582c1ae01368b39d77126cafa1}{wx}, seg->\hyperlink{structwseg_a5f5c26867c4c0aa0ab85e11fdfc93945}{wy}) < 3)
303         (void) mattacku(worm);
304 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{worm_8c_aca3eeefda6ce7d9142e7432b7a3d90e1}{\index{worm.\+c@{worm.\+c}!wgrowtime@{wgrowtime}}
\index{wgrowtime@{wgrowtime}!worm.\+c@{worm.\+c}}
\subsubsection[{wgrowtime}]{\setlength{\rightskip}{0pt plus 5cm}long wgrowtime\mbox{[}{\bf M\+A\+X\+\_\+\+N\+U\+M\+\_\+\+W\+O\+R\+M\+S}\mbox{]} = {\bf D\+U\+M\+M\+Y}}}\label{worm_8c_aca3eeefda6ce7d9142e7432b7a3d90e1}


Definition at line 70 of file worm.\+c.

\hypertarget{worm_8c_a0f633111543ead22d188c52d9eff2c75}{\index{worm.\+c@{worm.\+c}!wheads@{wheads}}
\index{wheads@{wheads}!worm.\+c@{worm.\+c}}
\subsubsection[{wheads}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf wseg}$\ast$ wheads\mbox{[}{\bf M\+A\+X\+\_\+\+N\+U\+M\+\_\+\+W\+O\+R\+M\+S}\mbox{]} = {\bf D\+U\+M\+M\+Y}}}\label{worm_8c_a0f633111543ead22d188c52d9eff2c75}


Definition at line 69 of file worm.\+c.

\hypertarget{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}{\index{worm.\+c@{worm.\+c}!wtails@{wtails}}
\index{wtails@{wtails}!worm.\+c@{worm.\+c}}
\subsubsection[{wtails}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf wseg} $\ast$ wtails\mbox{[}{\bf M\+A\+X\+\_\+\+N\+U\+M\+\_\+\+W\+O\+R\+M\+S}\mbox{]} = {\bf D\+U\+M\+M\+Y}}}\label{worm_8c_a75bdd7391729fb20fa5d72b6d8a9cbc1}


Definition at line 69 of file worm.\+c.

