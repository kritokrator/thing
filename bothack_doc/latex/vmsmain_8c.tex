\hypertarget{vmsmain_8c}{\section{nethack/sys/vms/vmsmain.c File Reference}
\label{vmsmain_8c}\index{nethack/sys/vms/vmsmain.\+c@{nethack/sys/vms/vmsmain.\+c}}
}
{\ttfamily \#include \char`\"{}hack.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}dlb.\+h\char`\"{}}\\*
{\ttfamily \#include $<$signal.\+h$>$}\\*
{\ttfamily \#include $<$ssdef.\+h$>$}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{vmsmain_8c_a6f48d319b6822b0be0bcd30975457d9a}{vms\+\_\+handler\+\_\+type}~int
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{vmsmain_8c_ab317c80f594b60b4a12d64f3e2a55d1e}{N\+D\+E\+C\+L} (\hyperlink{vmsmain_8c_acb3878c0525f3bdce2d3faa1d320dbeb}{whoami})
\item 
static void \hyperlink{vmsmain_8c_a4e2618330bfaf16da0ace1b33d9d8362}{F\+D\+E\+C\+L} (\hyperlink{vmsmain_8c_a987a92f55c7b63b7caa697eb7307f266}{process\+\_\+options},(int, char $\ast$$\ast$))
\item 
static void \hyperlink{vmsmain_8c_a8cbc482102b871d8f877591c89bde80a}{N\+D\+E\+C\+L} (\hyperlink{vmsmain_8c_a8a86505eb7fc82a6ccd83a8b8d5187d1}{byebye})
\item 
void \hyperlink{vmsmain_8c_a653671efb9e4b6f47e2a56dc26fd5375}{F\+D\+E\+C\+L} (V\+A\+X\+C \$E\+S\+T\+A\+B\+L\+I\+S\+H,(\hyperlink{vmsmain_8c_a6f48d319b6822b0be0bcd30975457d9a}{vms\+\_\+handler\+\_\+type}($\ast$)(\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\+\_\+t}, \hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\+\_\+t})))
\item 
static \hyperlink{vmsmain_8c_a6f48d319b6822b0be0bcd30975457d9a}{vms\+\_\+handler\+\_\+type} \hyperlink{vmsmain_8c_a060cc3fae13ed58f54a8d4a17e76f92d}{F\+D\+E\+C\+L} (\hyperlink{vmsmain_8c_a0aaae9e4c7c773d1484e5d99cc3ea470}{vms\+\_\+handler},(\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\+\_\+t}, \hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\+\_\+t}))
\item 
static void \hyperlink{vmsmain_8c_ac0f77e9017ee17cf2ffc0fa15fc1c837}{N\+D\+E\+C\+L} (\hyperlink{vmsmain_8c_aaa3ddf65efbe4146106c12cf1464d917}{wd\+\_\+message})
\item 
int \hyperlink{vmsmain_8c_afced8478b91af5c169926dfa4426333d}{main} (int argc, argv)
\item 
static void \hyperlink{vmsmain_8c_a987a92f55c7b63b7caa697eb7307f266}{process\+\_\+options} (int argc, argv)
\item 
static void \hyperlink{vmsmain_8c_acb3878c0525f3bdce2d3faa1d320dbeb}{whoami} ()
\item 
static void \hyperlink{vmsmain_8c_a8a86505eb7fc82a6ccd83a8b8d5187d1}{byebye} ()
\item 
static \hyperlink{vmsmain_8c_a6f48d319b6822b0be0bcd30975457d9a}{vms\+\_\+handler\+\_\+type} \hyperlink{vmsmain_8c_a0aaae9e4c7c773d1484e5d99cc3ea470}{vms\+\_\+handler} (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\+\_\+t} sigargs, \hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\+\_\+t} mechargs)
\item 
static void \hyperlink{vmsmain_8c_aaa3ddf65efbe4146106c12cf1464d917}{wd\+\_\+message} ()
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{vmsmain_8c_a6f48d319b6822b0be0bcd30975457d9a}{\index{vmsmain.\+c@{vmsmain.\+c}!vms\+\_\+handler\+\_\+type@{vms\+\_\+handler\+\_\+type}}
\index{vms\+\_\+handler\+\_\+type@{vms\+\_\+handler\+\_\+type}!vmsmain.\+c@{vmsmain.\+c}}
\subsubsection[{vms\+\_\+handler\+\_\+type}]{\setlength{\rightskip}{0pt plus 5cm}\#define vms\+\_\+handler\+\_\+type~int}}\label{vmsmain_8c_a6f48d319b6822b0be0bcd30975457d9a}


Definition at line 16 of file vmsmain.\+c.



\subsection{Function Documentation}
\hypertarget{vmsmain_8c_a8a86505eb7fc82a6ccd83a8b8d5187d1}{\index{vmsmain.\+c@{vmsmain.\+c}!byebye@{byebye}}
\index{byebye@{byebye}!vmsmain.\+c@{vmsmain.\+c}}
\subsubsection[{byebye}]{\setlength{\rightskip}{0pt plus 5cm}static void byebye (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{vmsmain_8c_a8a86505eb7fc82a6ccd83a8b8d5187d1}


Definition at line 376 of file vmsmain.\+c.



References chdir(), F\+D\+E\+C\+L(), getenv, and program\+\_\+state.



Referenced by main().


\begin{DoxyCode}
377 \{
378     \textcolor{comment}{/*  Different versions of both VAX C and GNU C use different return types}
379 \textcolor{comment}{    for signal functions.  Return type 'int' along with the explicit casts}
380 \textcolor{comment}{    below satisfy the most combinations of compiler vs <signal.h>.}
381 \textcolor{comment}{     */}
382     int (*hup)();
383 \textcolor{preprocessor}{#ifdef SHELL}
384     \textcolor{keyword}{extern} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} dosh\_pid, mail\_pid;
385     \textcolor{keyword}{extern} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \hyperlink{vmsmain_8c_a4e2618330bfaf16da0ace1b33d9d8362}{FDECL}(sys$delprc,(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} *,\textcolor{keyword}{const} 
      \hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}));
386 
387     \textcolor{comment}{/* clean up any subprocess we've spawned that may still be hanging around */}
388     \textcolor{keywordflow}{if} (dosh\_pid) (void) sys$delprc(&dosh\_pid, 0), dosh\_pid = 0;
389     \textcolor{keywordflow}{if} (mail\_pid) (void) sys$delprc(&mail\_pid, 0), mail\_pid = 0;
390 \textcolor{preprocessor}{#endif}
391 
392     \textcolor{comment}{/* SIGHUP doesn't seem to do anything on VMS, so we fudge it here... */}
393     hup = (int(*)()) signal(SIGHUP, SIG\_IGN);
394     \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_a91c51d44f2b6e70f8a5d42a5b5218dcd}{program\_state}.exiting++ &&
395     hup != (\textcolor{keywordtype}{int}(*)()) SIG\_DFL && hup != (\textcolor{keywordtype}{int}(*)()) SIG\_IGN)
396     (void) (*hup)();
397 
398 \textcolor{preprocessor}{#ifdef CHDIR}
399     (void) \hyperlink{wceconf_8h_ae6d5c38f8d7036c9010142bf4291d5ca}{chdir}(\hyperlink{wceconf_8h_a83c38fc4fff128c27ecf1e12f593a676}{getenv}(\textcolor{stringliteral}{"PATH"}));
400 \textcolor{preprocessor}{#endif}
401 \}
\end{DoxyCode}
\hypertarget{vmsmain_8c_a4e2618330bfaf16da0ace1b33d9d8362}{\index{vmsmain.\+c@{vmsmain.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!vmsmain.\+c@{vmsmain.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}static void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf process\+\_\+options}}]{, }
\item[{(int, char $\ast$$\ast$)}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{vmsmain_8c_a4e2618330bfaf16da0ace1b33d9d8362}


Referenced by byebye().

\hypertarget{vmsmain_8c_a653671efb9e4b6f47e2a56dc26fd5375}{\index{vmsmain.\+c@{vmsmain.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!vmsmain.\+c@{vmsmain.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{V\+A\+X\+C}]{\$\+E\+S\+T\+A\+B\+L\+I\+S\+H, }
\item[{({\bf vms\+\_\+handler\+\_\+type}($\ast$)({\bf genericptr\+\_\+t}, {\bf genericptr\+\_\+t}))}]{}
\end{DoxyParamCaption}
)}}\label{vmsmain_8c_a653671efb9e4b6f47e2a56dc26fd5375}
\hypertarget{vmsmain_8c_a060cc3fae13ed58f54a8d4a17e76f92d}{\index{vmsmain.\+c@{vmsmain.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!vmsmain.\+c@{vmsmain.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf vms\+\_\+handler\+\_\+type} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf vms\+\_\+handler}}]{, }
\item[{({\bf genericptr\+\_\+t}, {\bf genericptr\+\_\+t})}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{vmsmain_8c_a060cc3fae13ed58f54a8d4a17e76f92d}
\hypertarget{vmsmain_8c_afced8478b91af5c169926dfa4426333d}{\index{vmsmain.\+c@{vmsmain.\+c}!main@{main}}
\index{main@{main}!vmsmain.\+c@{vmsmain.\+c}}
\subsubsection[{main}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{argv}]{}
\end{DoxyParamCaption}
)}}\label{vmsmain_8c_afced8478b91af5c169926dfa4426333d}


Definition at line 31 of file vmsmain.\+c.



References askname, byebye(), chdirx(), choose\+\_\+windows(), C\+O\+L\+N\+O, D\+E\+F\+A\+U\+L\+T\+\_\+\+W\+I\+N\+D\+O\+W\+\_\+\+S\+Y\+S, delete\+\_\+savefile(), discover, display\+\_\+file, dlb\+\_\+init, done1(), dorecover(), error(), exit(), E\+X\+I\+T\+\_\+\+S\+U\+C\+C\+E\+S\+S, F\+A\+L\+S\+E, F\+C\+M\+A\+S\+K, flags, fqname(), getlock(), getuid(), hackpid, hname, iflags, init\+\_\+nhwindows, initoptions(), lock, mark\+\_\+synch, flag\+::move, N\+E\+W\+S, instance\+\_\+flags\+::news, nh\+\_\+getenv(), pickup(), player\+\_\+selection, plname, plnamesuffix(), process\+\_\+options(), prscore(), restore\+\_\+saved\+\_\+game(), R\+O\+W\+N\+O, S\+A\+V\+E\+F, S\+A\+V\+E\+P\+R\+E\+F\+I\+X, S\+I\+G\+\_\+\+R\+E\+T\+\_\+\+T\+Y\+P\+E, Sprintf, strcmpi, Strcpy, strncmpi(), T\+R\+U\+E, u, you\+::uhp, umask, vision\+\_\+init(), vms\+\_\+basename(), vms\+\_\+handler(), wd\+\_\+message(), whoami(), wizard, x\+\_\+maze\+\_\+max, y\+\_\+maze\+\_\+max, and yn.


\begin{DoxyCode}
34 \{
35     \textcolor{keyword}{register} \textcolor{keywordtype}{int} fd;
36 \textcolor{preprocessor}{#ifdef CHDIR}
37     \textcolor{keyword}{register} \textcolor{keywordtype}{char} *dir;
38 \textcolor{preprocessor}{#endif}
39 
40 \textcolor{preprocessor}{#ifdef SECURE   }\textcolor{comment}{/* this should be the very first code executed */}\textcolor{preprocessor}{}
41     privoff();
42     fflush((FILE *)0);  \textcolor{comment}{/* force stdio to init itself */}
43     privon();
44 \textcolor{preprocessor}{#endif}
45 
46     atexit(\hyperlink{vmsmain_8c_a8a86505eb7fc82a6ccd83a8b8d5187d1}{byebye});
47     \hyperlink{decl_8h_a723eae5bf45a5d8ecb28dbf26d05bc98}{hname} = argv[0];
48     \hyperlink{decl_8h_a723eae5bf45a5d8ecb28dbf26d05bc98}{hname} = \hyperlink{vmsfiles_8c_ae5c864896564867dcf8863e716b90e44}{vms\_basename}(\hyperlink{decl_8h_a723eae5bf45a5d8ecb28dbf26d05bc98}{hname});  \textcolor{comment}{/* name used in 'usage' type messages */}
49     \hyperlink{decl_8h_a8ce342978cf711fcf79e4f9027bff80b}{hackpid} = getpid();
50     (void) \hyperlink{vmsunix_8c_ad988592bdd4fffff448195f8a041fc92}{umask}(0);
51 
52     \hyperlink{windows_8c_a6879f435c2e64314706d8f2ba946a303}{choose\_windows}(\hyperlink{config_8h_ab27d30612b31fb7333fc40501e15d94c}{DEFAULT\_WINDOW\_SYS});
53 
54 \textcolor{preprocessor}{#ifdef CHDIR            }\textcolor{comment}{/* otherwise no chdir() */}\textcolor{preprocessor}{}
55     \textcolor{comment}{/*}
56 \textcolor{comment}{     * See if we must change directory to the playground.}
57 \textcolor{comment}{     * (Perhaps hack is installed with privs and playground is}
58 \textcolor{comment}{     *  inaccessible for the player.)}
59 \textcolor{comment}{     * The logical name HACKDIR is overridden by a}
60 \textcolor{comment}{     *  -d command line option (must be the first option given)}
61 \textcolor{comment}{     */}
62     dir = \hyperlink{options_8c_a5f6df715fbbfe6e4ee9c64f6a28b0987}{nh\_getenv}(\textcolor{stringliteral}{"NETHACKDIR"});
63     \textcolor{keywordflow}{if} (!dir) dir = \hyperlink{options_8c_a5f6df715fbbfe6e4ee9c64f6a28b0987}{nh\_getenv}(\textcolor{stringliteral}{"HACKDIR"});
64 \textcolor{preprocessor}{#endif}
65     \textcolor{keywordflow}{if}(argc > 1) \{
66 \textcolor{preprocessor}{#ifdef CHDIR}
67         \textcolor{keywordflow}{if} (!strncmp(argv[1], \textcolor{stringliteral}{"-d"}, 2) && argv[1][2] != \textcolor{charliteral}{'e'}) \{
68         \textcolor{comment}{/* avoid matching "-dec" for DECgraphics; since the man page}
69 \textcolor{comment}{         * says -d directory, hope nobody's using -desomething\_else}
70 \textcolor{comment}{         */}
71         argc--;
72         argv++;
73         dir = argv[0]+2;
74         \textcolor{keywordflow}{if}(*dir == \textcolor{charliteral}{'='} || *dir == \textcolor{charliteral}{':'}) dir++;
75         \textcolor{keywordflow}{if}(!*dir && argc > 1) \{
76             argc--;
77             argv++;
78             dir = argv[0];
79         \}
80         \textcolor{keywordflow}{if}(!*dir)
81             \hyperlink{txt2iff_8c_a64e632a682e311bde915784e6a17da31}{error}(\textcolor{stringliteral}{"Flag -d must be followed by a directory name."});
82         \}
83         \textcolor{keywordflow}{if} (argc > 1)
84 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* CHDIR */}\textcolor{preprocessor}{}
85 
86         \textcolor{comment}{/*}
87 \textcolor{comment}{         * Now we know the directory containing 'record' and}
88 \textcolor{comment}{         * may do a prscore().}
89 \textcolor{comment}{         */}
90         \textcolor{keywordflow}{if} (!strncmp(argv[1], \textcolor{stringliteral}{"-s"}, 2)) \{
91 \textcolor{preprocessor}{#ifdef CHDIR}
92         \hyperlink{bemain_8c_a53e222f64a70757b462220929a59eb89}{chdirx}(dir, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
93 \textcolor{preprocessor}{#endif}
94         \hyperlink{topten_8c_a1c335dc4cd97e311acb93aa30107ceaa}{prscore}(argc, argv);
95         \hyperlink{vmsmisc_8c_a358d2e2397ca11ccd17553e3c40e7901}{exit}(\hyperlink{global_8h_a687984f47d8cce148d1b914d2b79612a}{EXIT\_SUCCESS});
96         \}
97     \}
98 
99 \textcolor{preprocessor}{#ifdef CHDIR}
100     \textcolor{comment}{/* move to the playground directory; 'termcap' might be found there */}
101     \hyperlink{bemain_8c_a53e222f64a70757b462220929a59eb89}{chdirx}(dir, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
102 \textcolor{preprocessor}{#endif}
103 
104 \textcolor{preprocessor}{#ifdef SECURE}
105     \textcolor{comment}{/* disable installed privs while loading nethack.cnf and termcap,}
106 \textcolor{comment}{       and also while initializing terminal [$assign("TT:")]. */}
107     privoff();
108 \textcolor{preprocessor}{#endif}
109     \hyperlink{options_8c_a2f4ef6da0d84a10cf334449f652decc9}{initoptions}();
110     \hyperlink{winprocs_8h_a613c5d847a2df7d7ddca4a1308014964}{init\_nhwindows}(&argc, argv);
111     \hyperlink{vmsmain_8c_acb3878c0525f3bdce2d3faa1d320dbeb}{whoami}();
112 \textcolor{preprocessor}{#ifdef SECURE}
113     privon();
114 \textcolor{preprocessor}{#endif}
115 
116     \textcolor{comment}{/*}
117 \textcolor{comment}{     * It seems you really want to play.}
118 \textcolor{comment}{     */}
119     \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a94468a400f14da123d5160f8eefd7641}{uhp} = 1;  \textcolor{comment}{/* prevent RIP on early quits */}
120 \textcolor{preprocessor}{#ifndef SAVE\_ON\_FATAL\_ERROR}
121     \textcolor{comment}{/* used to clear hangup stuff while still giving standard traceback */}
122     VAXC$ESTABLISH(\hyperlink{vmsmain_8c_a0aaae9e4c7c773d1484e5d99cc3ea470}{vms\_handler});
123 \textcolor{preprocessor}{#endif}
124     (void) signal(SIGHUP, (\hyperlink{beconf_8h_a1a6cd64290d8bd530aa53c9094ff277d}{SIG\_RET\_TYPE}) hangup);
125 
126     \hyperlink{vmsmain_8c_a987a92f55c7b63b7caa697eb7307f266}{process\_options}(argc, argv); \textcolor{comment}{/* command line options */}
127 
128 \textcolor{preprocessor}{#ifdef WIZARD}
129     \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a5f48dc2f029e22c05489fb20a491db4b}{wizard})
130         \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(\hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname}, \textcolor{stringliteral}{"wizard"});
131     \textcolor{keywordflow}{else}
132 \textcolor{preprocessor}{#endif}
133     \textcolor{keywordflow}{if} (!*\hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname} || !\hyperlink{winmain_8c_a5dba8f2d62f353a6e27760e54500d3f7}{strncmpi}(\hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname}, \textcolor{stringliteral}{"games"}, 4) ||
134         !\hyperlink{global_8h_a22452a37cca2c671ad3a973f776e2e42}{strcmpi}(\hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname}, \textcolor{stringliteral}{"nethack"}))
135         \hyperlink{winprocs_8h_ad24a017e7b5381254a426b4f653881d6}{askname}();
136     \hyperlink{role_8c_aa0498399050c03eb7ddd757e2d7f320e}{plnamesuffix}();     \textcolor{comment}{/* strip suffix from name; calls askname() */}
137                 \textcolor{comment}{/* again if suffix was whole name */}
138                 \textcolor{comment}{/* accepts any suffix */}
139 \textcolor{preprocessor}{#ifdef WIZARD}
140     \textcolor{keywordflow}{if}(!\hyperlink{flag_8h_a5f48dc2f029e22c05489fb20a491db4b}{wizard}) \{
141 \textcolor{preprocessor}{#endif}
142         \textcolor{comment}{/*}
143 \textcolor{comment}{         * check for multiple games under the same name}
144 \textcolor{comment}{         * (if !locknum) or check max nr of players (otherwise)}
145 \textcolor{comment}{         */}
146         (void) signal(SIGQUIT,SIG\_IGN);
147         (void) signal(SIGINT,SIG\_IGN);
148         \textcolor{keywordflow}{if}(!locknum)
149             \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(\hyperlink{decl_8h_a8b16c414738de372bc32500c786b4942}{lock}, \textcolor{stringliteral}{"\_%u%s"}, (\textcolor{keywordtype}{unsigned})\hyperlink{amidos_8c_adfeaff1e1a26bb8deae36cc9807d09f2}{getuid}(), \hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname});
150         \hyperlink{bemain_8c_a21738d427cae396cec6f2f009adb29c3}{getlock}();
151 \textcolor{preprocessor}{#ifdef WIZARD}
152     \} \textcolor{keywordflow}{else} \{
153         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(\hyperlink{decl_8h_a8b16c414738de372bc32500c786b4942}{lock}, \textcolor{stringliteral}{"\_%u%s"}, (\textcolor{keywordtype}{unsigned})\hyperlink{amidos_8c_adfeaff1e1a26bb8deae36cc9807d09f2}{getuid}(), \hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname});
154         \hyperlink{bemain_8c_a21738d427cae396cec6f2f009adb29c3}{getlock}();
155     \}
156 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* WIZARD */}\textcolor{preprocessor}{}
157 
158     \hyperlink{dlb_8h_af25f20c0b4f30c2b124fbe4f2e54ad3c}{dlb\_init}(); \textcolor{comment}{/* must be before newgame() */}
159 
160     \textcolor{comment}{/*}
161 \textcolor{comment}{     * Initialization of the boundaries of the mazes}
162 \textcolor{comment}{     * Both boundaries have to be even.}
163 \textcolor{comment}{     */}
164     \hyperlink{decl_8h_a5a8f3e210dcf5e1b8319f220200f7e91}{x\_maze\_max} = \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}-1;
165     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a5a8f3e210dcf5e1b8319f220200f7e91}{x\_maze\_max} % 2)
166         \hyperlink{decl_8h_a5a8f3e210dcf5e1b8319f220200f7e91}{x\_maze\_max}--;
167     \hyperlink{decl_8h_a148ae7e81a85b4cab11815530f82da17}{y\_maze\_max} = \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}-1;
168     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a148ae7e81a85b4cab11815530f82da17}{y\_maze\_max} % 2)
169         \hyperlink{decl_8h_a148ae7e81a85b4cab11815530f82da17}{y\_maze\_max}--;
170 
171     \textcolor{comment}{/*}
172 \textcolor{comment}{     *  Initialize the vision system.  This must be before mklev() on a}
173 \textcolor{comment}{     *  new game or before a level restore on a saved game.}
174 \textcolor{comment}{     */}
175     \hyperlink{vision_8c_ae84d85f205596be999ea45113fb8810f}{vision\_init}();
176 
177     display\_gamewindows();
178 
179     \textcolor{keywordflow}{if} ((fd = \hyperlink{files_8c_af780b8c38357751a8a60624825b8e2d8}{restore\_saved\_game}()) >= 0) \{
180 \textcolor{preprocessor}{#ifdef WIZARD}
181         \textcolor{comment}{/* Since wizard is actually flags.debug, restoring might}
182 \textcolor{comment}{         * overwrite it.}
183 \textcolor{comment}{         */}
184         \textcolor{keywordtype}{boolean} remember\_wiz\_mode = \hyperlink{flag_8h_a5f48dc2f029e22c05489fb20a491db4b}{wizard};
185 \textcolor{preprocessor}{#endif}
186         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *fq\_save = \hyperlink{files_8c_a8059f77bb89e5ed0c3bf6ff939a21fc1}{fqname}(\hyperlink{decl_8h_a12ec3caf95cc60603fc1ecc9b7266e48}{SAVEF}, \hyperlink{decl_8h_a70a946c7d1c02b32e83dbc74bc60a0ac}{SAVEPREFIX}, 1);
187 
188         (void) chmod(fq\_save,0);    \textcolor{comment}{/* disallow parallel restores */}
189         (void) signal(SIGINT, (\hyperlink{beconf_8h_a1a6cd64290d8bd530aa53c9094ff277d}{SIG\_RET\_TYPE}) \hyperlink{end_8c_a2082a4dffb6195df4e125aa90a4fe0cd}{done1});
190 \textcolor{preprocessor}{#ifdef NEWS}
191         \textcolor{keywordflow}{if}(\hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_a65a361ffd2534ddff433ba62f3dfb579}{news}) \{
192             \hyperlink{winprocs_8h_a9a2d6fa35e52cd43166e411ec33926ef}{display\_file}(\hyperlink{config_8h_adfcdf96482b20ff90defa8fd75b84a7c}{NEWS}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
193             \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_a65a361ffd2534ddff433ba62f3dfb579}{news} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}; \textcolor{comment}{/* in case dorecover() fails */}
194         \}
195 \textcolor{preprocessor}{#endif}
196         pline(\textcolor{stringliteral}{"Restoring save file..."});
197         \hyperlink{winprocs_8h_a72bbad3e5805d71f128c614261fc7ee0}{mark\_synch}(); \textcolor{comment}{/* flush output */}
198         \textcolor{keywordflow}{if}(!\hyperlink{restore_8c_a4fb439a417b679a962bff63981841e4c}{dorecover}(fd))
199             \textcolor{keywordflow}{goto} not\_recovered;
200 \textcolor{preprocessor}{#ifdef WIZARD}
201         \textcolor{keywordflow}{if}(!\hyperlink{flag_8h_a5f48dc2f029e22c05489fb20a491db4b}{wizard} && remember\_wiz\_mode) \hyperlink{flag_8h_a5f48dc2f029e22c05489fb20a491db4b}{wizard} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
202 \textcolor{preprocessor}{#endif}
203         check\_special\_room(\hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
204         \hyperlink{vmsmain_8c_aaa3ddf65efbe4146106c12cf1464d917}{wd\_message}();
205 
206         \textcolor{keywordflow}{if} (\hyperlink{flag_8h_adb6a5941e60dcb9dff8f2230d31180f9}{discover} || \hyperlink{flag_8h_a5f48dc2f029e22c05489fb20a491db4b}{wizard}) \{
207             \textcolor{keywordflow}{if} (\hyperlink{hack_8h_a22ffd7fa35549db318337a497c38a1ae}{yn}(\textcolor{stringliteral}{"Do you want to keep the save file?"}) == \textcolor{charliteral}{'n'})
208                 (void) \hyperlink{files_8c_a848354a4d70a646ed2c6ecf138054110}{delete\_savefile}();
209             \textcolor{keywordflow}{else}
210                 (\textcolor{keywordtype}{void}) chmod(fq\_save,\hyperlink{beconf_8h_abf4be38c8e5fb2c8a7c719d08e2178ac}{FCMASK}); \textcolor{comment}{/* back to readable */}
211         \}
212 
213         \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_ae91760a156a6d1949297a53272137325}{move} = 0;
214     \} \textcolor{keywordflow}{else} \{
215 not\_recovered:
216         \hyperlink{winprocs_8h_ac766fbb6f1679d4a7d996e8b0cfc6cea}{player\_selection}();
217         newgame();
218         \hyperlink{vmsmain_8c_aaa3ddf65efbe4146106c12cf1464d917}{wd\_message}();
219 
220         \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_ae91760a156a6d1949297a53272137325}{move} = 0;
221         set\_wear();
222         (void) \hyperlink{pickup_8c_ab9fd1f5835d6d35507a05e910e86d862}{pickup}(1);
223     \}
224 
225     moveloop();
226     \hyperlink{vmsmisc_8c_a358d2e2397ca11ccd17553e3c40e7901}{exit}(\hyperlink{global_8h_a687984f47d8cce148d1b914d2b79612a}{EXIT\_SUCCESS});
227     \textcolor{comment}{/*NOTREACHED*/}
228     \textcolor{keywordflow}{return}(0);
229 \}
\end{DoxyCode}
\hypertarget{vmsmain_8c_ab317c80f594b60b4a12d64f3e2a55d1e}{\index{vmsmain.\+c@{vmsmain.\+c}!N\+D\+E\+C\+L@{N\+D\+E\+C\+L}}
\index{N\+D\+E\+C\+L@{N\+D\+E\+C\+L}!vmsmain.\+c@{vmsmain.\+c}}
\subsubsection[{N\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}static void N\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf whoami}}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{vmsmain_8c_ab317c80f594b60b4a12d64f3e2a55d1e}
\hypertarget{vmsmain_8c_a8cbc482102b871d8f877591c89bde80a}{\index{vmsmain.\+c@{vmsmain.\+c}!N\+D\+E\+C\+L@{N\+D\+E\+C\+L}}
\index{N\+D\+E\+C\+L@{N\+D\+E\+C\+L}!vmsmain.\+c@{vmsmain.\+c}}
\subsubsection[{N\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}static void N\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf byebye}}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{vmsmain_8c_a8cbc482102b871d8f877591c89bde80a}
\hypertarget{vmsmain_8c_ac0f77e9017ee17cf2ffc0fa15fc1c837}{\index{vmsmain.\+c@{vmsmain.\+c}!N\+D\+E\+C\+L@{N\+D\+E\+C\+L}}
\index{N\+D\+E\+C\+L@{N\+D\+E\+C\+L}!vmsmain.\+c@{vmsmain.\+c}}
\subsubsection[{N\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}static void N\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf wd\+\_\+message}}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{vmsmain_8c_ac0f77e9017ee17cf2ffc0fa15fc1c837}
\hypertarget{vmsmain_8c_a987a92f55c7b63b7caa697eb7307f266}{\index{vmsmain.\+c@{vmsmain.\+c}!process\+\_\+options@{process\+\_\+options}}
\index{process\+\_\+options@{process\+\_\+options}!vmsmain.\+c@{vmsmain.\+c}}
\subsubsection[{process\+\_\+options}]{\setlength{\rightskip}{0pt plus 5cm}static void process\+\_\+options (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{argv}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{vmsmain_8c_a987a92f55c7b63b7caa697eb7307f266}


Definition at line 232 of file vmsmain.\+c.



References D\+E\+C\+\_\+\+G\+R\+A\+P\+H\+I\+C\+S, discover, F\+A\+L\+S\+E, flags, I\+B\+M\+\_\+\+G\+R\+A\+P\+H\+I\+C\+S, iflags, flag\+::initrace, flag\+::initrole, instance\+\_\+flags\+::news, nh\+\_\+getenv(), plname, flag\+::randomall, raw\+\_\+print, str2race(), str2role(), strcmpi, strncmpi(), switch\+\_\+graphics(), T\+R\+U\+E, and wizard.



Referenced by main().


\begin{DoxyCode}
235 \{
236     \textcolor{keywordtype}{int} i;
237 
238 
239     \textcolor{comment}{/*}
240 \textcolor{comment}{     * Process options.}
241 \textcolor{comment}{     */}
242     \textcolor{keywordflow}{while}(argc > 1 && argv[1][0] == \textcolor{charliteral}{'-'})\{
243         argv++;
244         argc--;
245         \textcolor{keywordflow}{switch}(argv[0][1])\{
246         \textcolor{keywordflow}{case} \textcolor{charliteral}{'D'}:
247 \textcolor{preprocessor}{#ifdef WIZARD}
248             \textcolor{keywordflow}{if}(!\hyperlink{global_8h_a22452a37cca2c671ad3a973f776e2e42}{strcmpi}(\hyperlink{options_8c_a5f6df715fbbfe6e4ee9c64f6a28b0987}{nh\_getenv}(\textcolor{stringliteral}{"USER"}), WIZARD\_NAME)) \{
249                 \hyperlink{flag_8h_a5f48dc2f029e22c05489fb20a491db4b}{wizard} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
250                 \textcolor{keywordflow}{break};
251             \}
252             \textcolor{comment}{/* otherwise fall thru to discover */}
253             wiz\_error\_flag = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
254 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* WIZARD */}\textcolor{preprocessor}{}
255         \textcolor{keywordflow}{case} \textcolor{charliteral}{'X'}:
256         \textcolor{keywordflow}{case} \textcolor{charliteral}{'x'}:
257             \hyperlink{flag_8h_adb6a5941e60dcb9dff8f2230d31180f9}{discover} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
258             \textcolor{keywordflow}{break};
259 \textcolor{preprocessor}{#ifdef NEWS}
260         \textcolor{keywordflow}{case} \textcolor{charliteral}{'n'}:
261             \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_a65a361ffd2534ddff433ba62f3dfb579}{news} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
262             \textcolor{keywordflow}{break};
263 \textcolor{preprocessor}{#endif}
264         \textcolor{keywordflow}{case} \textcolor{charliteral}{'u'}:
265             \textcolor{keywordflow}{if}(argv[0][2])
266               (void) strncpy(\hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname}, argv[0]+2, \textcolor{keyword}{sizeof}(\hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname})-1);
267             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(argc > 1) \{
268               argc--;
269               argv++;
270               (void) strncpy(\hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname}, argv[0], \textcolor{keyword}{sizeof}(\hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname})-1);
271             \} \textcolor{keywordflow}{else}
272                 \hyperlink{winprocs_8h_a49dffdcae248bae8b370f76b434ce744}{raw\_print}(\textcolor{stringliteral}{"Player name expected after -u"});
273             \textcolor{keywordflow}{break};
274         \textcolor{keywordflow}{case} \textcolor{charliteral}{'I'}:
275         \textcolor{keywordflow}{case} \textcolor{charliteral}{'i'}:
276             \textcolor{keywordflow}{if} (!\hyperlink{winmain_8c_a5dba8f2d62f353a6e27760e54500d3f7}{strncmpi}(argv[0]+1, \textcolor{stringliteral}{"IBM"}, 3))
277                 \hyperlink{drawing_8c_a0ba09dee9ab5e45ff03f6b0bfa0b9f1e}{switch\_graphics}(\hyperlink{rm_8h_a935319051fae1fe5674b6fbb39933733}{IBM\_GRAPHICS});
278             \textcolor{keywordflow}{break};
279         \textcolor{comment}{/*  case 'D': */}
280         \textcolor{keywordflow}{case} \textcolor{charliteral}{'d'}:
281             \textcolor{keywordflow}{if} (!\hyperlink{winmain_8c_a5dba8f2d62f353a6e27760e54500d3f7}{strncmpi}(argv[0]+1, \textcolor{stringliteral}{"DEC"}, 3))
282                 \hyperlink{drawing_8c_a0ba09dee9ab5e45ff03f6b0bfa0b9f1e}{switch\_graphics}(\hyperlink{rm_8h_a09c6675e014eb197a43bc2e26fafb6e5}{DEC\_GRAPHICS});
283             \textcolor{keywordflow}{break};
284         \textcolor{keywordflow}{case} \textcolor{charliteral}{'p'}: \textcolor{comment}{/* profession (role) */}
285             \textcolor{keywordflow}{if} (argv[0][2]) \{
286                 \textcolor{keywordflow}{if} ((i = \hyperlink{role_8c_a2de30162987e6e96565ef4f40e4b6287}{str2role}(&argv[0][2])) >= 0)
287                     \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a3b31f41da5faa08ea53d1e7ddf857088}{initrole} = i;
288             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (argc > 1) \{
289                 argc--;
290                 argv++;
291                 \textcolor{keywordflow}{if} ((i = \hyperlink{role_8c_a2de30162987e6e96565ef4f40e4b6287}{str2role}(argv[0])) >= 0)
292                     \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a3b31f41da5faa08ea53d1e7ddf857088}{initrole} = i;
293             \}
294             \textcolor{keywordflow}{break};
295         \textcolor{keywordflow}{case} \textcolor{charliteral}{'r'}: \textcolor{comment}{/* race */}
296             \textcolor{keywordflow}{if} (argv[0][2]) \{
297                 \textcolor{keywordflow}{if} ((i = \hyperlink{role_8c_a53f7288b95e8681fa29297e9a569dedd}{str2race}(&argv[0][2])) >= 0)
298                     \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a4c946d68b3e8e39311a0d20be0027a26}{initrace} = i;
299             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (argc > 1) \{
300                 argc--;
301                 argv++;
302                 \textcolor{keywordflow}{if} ((i = \hyperlink{role_8c_a53f7288b95e8681fa29297e9a569dedd}{str2race}(argv[0])) >= 0)
303                     \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a4c946d68b3e8e39311a0d20be0027a26}{initrace} = i;
304             \}
305             \textcolor{keywordflow}{break};
306         \textcolor{keywordflow}{case} \textcolor{charliteral}{'@'}:
307             \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a06854edfd7c6649ef7381c7ca1865f85}{randomall} = 1;
308             \textcolor{keywordflow}{break};
309         \textcolor{keywordflow}{default}:
310             \textcolor{keywordflow}{if} ((i = \hyperlink{role_8c_a2de30162987e6e96565ef4f40e4b6287}{str2role}(&argv[0][1])) >= 0) \{
311                 \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a3b31f41da5faa08ea53d1e7ddf857088}{initrole} = i;
312                 \textcolor{keywordflow}{break};
313             \}
314             \textcolor{comment}{/* else raw\_printf("Unknown option: %s", *argv); */}
315         \}
316     \}
317 
318     \textcolor{keywordflow}{if}(argc > 1)
319         locknum = atoi(argv[1]);
320 \textcolor{preprocessor}{#ifdef MAX\_NR\_OF\_PLAYERS}
321     \textcolor{keywordflow}{if}(!locknum || locknum > MAX\_NR\_OF\_PLAYERS)
322         locknum = MAX\_NR\_OF\_PLAYERS;
323 \textcolor{preprocessor}{#endif}
324 \}
\end{DoxyCode}
\hypertarget{vmsmain_8c_a0aaae9e4c7c773d1484e5d99cc3ea470}{\index{vmsmain.\+c@{vmsmain.\+c}!vms\+\_\+handler@{vms\+\_\+handler}}
\index{vms\+\_\+handler@{vms\+\_\+handler}!vmsmain.\+c@{vmsmain.\+c}}
\subsubsection[{vms\+\_\+handler}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf vms\+\_\+handler\+\_\+type} vms\+\_\+handler (
\begin{DoxyParamCaption}
\item[{{\bf genericptr\+\_\+t}}]{sigargs, }
\item[{{\bf genericptr\+\_\+t}}]{mechargs}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{vmsmain_8c_a0aaae9e4c7c773d1484e5d99cc3ea470}


Definition at line 408 of file vmsmain.\+c.



References abort, program\+\_\+state, T\+R\+U\+E, and wizard.



Referenced by main().


\begin{DoxyCode}
410 \{
411     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} condition = ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} *)sigargs)[1];
412 
413     \textcolor{keywordflow}{if} (condition == SS$\_ACCVIO     \textcolor{comment}{/* access violation */}
414      || (condition >= SS$\_ASTFLT && condition <= SS$\_TBIT)
415      || (condition >= SS$\_ARTRES && condition <= SS$\_INHCHME)) \{
416     \hyperlink{decl_8h_a91c51d44f2b6e70f8a5d42a5b5218dcd}{program\_state}.done\_hup = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}; \textcolor{comment}{/* pretend hangup has been attempted */}
417 \textcolor{preprocessor}{# if defined(WIZARD) && !defined(BETA)}
418     \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a5f48dc2f029e22c05489fb20a491db4b}{wizard})
419 \textcolor{preprocessor}{# endif }\textcolor{comment}{/*WIZARD && !BETA*/}\textcolor{preprocessor}{}
420 \textcolor{preprocessor}{# if defined(WIZARD) ||  defined(BETA)}
421         \hyperlink{wceconf_8h_aef4ff7cf390aba5ab4172cca329a2c89}{abort}();   \textcolor{comment}{/* enter the debugger */}
422 \textcolor{preprocessor}{# endif }\textcolor{comment}{/*WIZARD || BETA*/}\textcolor{preprocessor}{}
423     \}
424     \textcolor{keywordflow}{return} SS$\_RESIGNAL;
425 \}
\end{DoxyCode}
\hypertarget{vmsmain_8c_aaa3ddf65efbe4146106c12cf1464d917}{\index{vmsmain.\+c@{vmsmain.\+c}!wd\+\_\+message@{wd\+\_\+message}}
\index{wd\+\_\+message@{wd\+\_\+message}!vmsmain.\+c@{vmsmain.\+c}}
\subsubsection[{wd\+\_\+message}]{\setlength{\rightskip}{0pt plus 5cm}static void wd\+\_\+message (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{vmsmain_8c_aaa3ddf65efbe4146106c12cf1464d917}


Definition at line 441 of file vmsmain.\+c.



References discover.



Referenced by main().


\begin{DoxyCode}
442 \{
443 \textcolor{preprocessor}{#ifdef WIZARD}
444     \textcolor{keywordflow}{if} (wiz\_error\_flag) \{
445         pline(\textcolor{stringliteral}{"Only user \(\backslash\)"%s\(\backslash\)" may access debug (wizard) mode."},
446             WIZARD\_NAME);
447         pline(\textcolor{stringliteral}{"Entering discovery mode instead."});
448     \} \textcolor{keywordflow}{else}
449 \textcolor{preprocessor}{#endif}
450     \textcolor{keywordflow}{if} (\hyperlink{flag_8h_adb6a5941e60dcb9dff8f2230d31180f9}{discover})
451         You(\textcolor{stringliteral}{"are in non-scoring discovery mode."});
452 \}
\end{DoxyCode}
\hypertarget{vmsmain_8c_acb3878c0525f3bdce2d3faa1d320dbeb}{\index{vmsmain.\+c@{vmsmain.\+c}!whoami@{whoami}}
\index{whoami@{whoami}!vmsmain.\+c@{vmsmain.\+c}}
\subsubsection[{whoami}]{\setlength{\rightskip}{0pt plus 5cm}static void whoami (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{vmsmain_8c_acb3878c0525f3bdce2d3faa1d320dbeb}


Definition at line 358 of file vmsmain.\+c.



References nh\+\_\+getenv(), and plname.



Referenced by main().


\begin{DoxyCode}
359 \{
360     \textcolor{comment}{/*}
361 \textcolor{comment}{     * Who am i? Algorithm: 1. Use name as specified in NETHACKOPTIONS}
362 \textcolor{comment}{     *          2. Use lowercase of $USER  (if 1. fails)}
363 \textcolor{comment}{     * The resulting name is overridden by command line options.}
364 \textcolor{comment}{     * If everything fails, or if the resulting name is some generic}
365 \textcolor{comment}{     * account like "games" then eventually we'll ask him.}
366 \textcolor{comment}{     * Note that we trust the user here; it is possible to play under}
367 \textcolor{comment}{     * somebody else's name.}
368 \textcolor{comment}{     */}
369     \textcolor{keyword}{register} \textcolor{keywordtype}{char} *s;
370 
371     \textcolor{keywordflow}{if} (!*\hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname} && (s = \hyperlink{options_8c_a5f6df715fbbfe6e4ee9c64f6a28b0987}{nh\_getenv}(\textcolor{stringliteral}{"USER"})))
372         (void) lcase(strncpy(\hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname}, s, \textcolor{keyword}{sizeof}(\hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname})-1));
373 \}
\end{DoxyCode}
