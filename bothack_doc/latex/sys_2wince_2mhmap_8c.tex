\hypertarget{sys_2wince_2mhmap_8c}{\section{nethack/sys/wince/mhmap.c File Reference}
\label{sys_2wince_2mhmap_8c}\index{nethack/sys/wince/mhmap.\+c@{nethack/sys/wince/mhmap.\+c}}
}
{\ttfamily \#include \char`\"{}win\+M\+S.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhmap.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhmsg.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhinput.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhfont.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}patchlevel.\+h\char`\"{}}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structmswin__nethack__map__window}{mswin\+\_\+nethack\+\_\+map\+\_\+window}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{sys_2wince_2mhmap_8c_ad3e0b865c7bff9658de5db29c3ac3798}{N\+H\+M\+A\+P\+\_\+\+F\+O\+N\+T\+\_\+\+N\+A\+M\+E}~T\+E\+X\+T(\char`\"{}Terminal\char`\"{})
\item 
\#define \hyperlink{sys_2wince_2mhmap_8c_a7823f335c74115317a5e71c645dae320}{M\+A\+X\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T}~255
\item 
\#define \hyperlink{sys_2wince_2mhmap_8c_a21594d0d7a347c8a66fb45ddd84260ee}{zap\+\_\+color}(n)
\item 
\#define \hyperlink{sys_2wince_2mhmap_8c_a7af6c3375df7db9c0a656e950e173112}{cmap\+\_\+color}(n)
\item 
\#define \hyperlink{sys_2wince_2mhmap_8c_a416b5979efb02c985539d51e0a9d620e}{obj\+\_\+color}(n)
\item 
\#define \hyperlink{sys_2wince_2mhmap_8c_a440d023c793bae7397f872d8f79803f0}{mon\+\_\+color}(n)
\item 
\#define \hyperlink{sys_2wince_2mhmap_8c_abfd7f07931aaf9517da205d2831b1eb6}{pet\+\_\+color}(c)
\item 
\#define \hyperlink{sys_2wince_2mhmap_8c_aa3ec93aaff402d07c963c954d07c1a51}{warn\+\_\+color}(c)
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \\*
\hyperlink{structmswin__nethack__map__window}{mswin\+\_\+nethack\+\_\+map\+\_\+window} \hyperlink{sys_2wince_2mhmap_8c_a454c3dc21996d0a724cde74e05faa0b7}{N\+H\+Map\+Window}
\item 
typedef struct \\*
\hyperlink{structmswin__nethack__map__window}{mswin\+\_\+nethack\+\_\+map\+\_\+window} $\ast$ \hyperlink{sys_2wince_2mhmap_8c_a82a6298010a5511f78638af4f6e4cd15}{P\+N\+H\+Map\+Window}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
L\+R\+E\+S\+U\+L\+T C\+A\+L\+L\+B\+A\+C\+K \hyperlink{sys_2wince_2mhmap_8c_a86c4e3dd38831a39ff511ae76ea288c2}{Map\+Wnd\+Proc} (H\+W\+N\+D, \hyperlink{def__os2_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{U\+I\+N\+T}, W\+P\+A\+R\+A\+M, L\+P\+A\+R\+A\+M)
\item 
static void \hyperlink{sys_2wince_2mhmap_8c_a1f8f18b4bd46d6298fbadb48f5194ae7}{register\+\_\+map\+\_\+window\+\_\+class} (void)
\item 
static void \hyperlink{sys_2wince_2mhmap_8c_ab1f0aceef05a1dec643246c7cbf5353c}{on\+M\+S\+N\+H\+Command} (H\+W\+N\+D h\+Wnd, W\+P\+A\+R\+A\+M w\+Param, L\+P\+A\+R\+A\+M l\+Param)
\item 
static void \hyperlink{sys_2wince_2mhmap_8c_a1f270ab41a83935a7f1a12c1ebf960c1}{on\+M\+S\+N\+H\+\_\+\+V\+Scroll} (H\+W\+N\+D h\+Wnd, W\+P\+A\+R\+A\+M w\+Param, L\+P\+A\+R\+A\+M l\+Param)
\item 
static void \hyperlink{sys_2wince_2mhmap_8c_ad9a3e28d520ba0d767dd1b281c074ea6}{on\+M\+S\+N\+H\+\_\+\+H\+Scroll} (H\+W\+N\+D h\+Wnd, W\+P\+A\+R\+A\+M w\+Param, L\+P\+A\+R\+A\+M l\+Param)
\item 
static void \hyperlink{sys_2wince_2mhmap_8c_ad09a28d28eea324af31f4fdfa19a44b4}{on\+Paint} (H\+W\+N\+D h\+Wnd)
\item 
static void \hyperlink{sys_2wince_2mhmap_8c_a8d537e532190de086a8d3636c37c57a9}{on\+Create} (H\+W\+N\+D h\+Wnd, W\+P\+A\+R\+A\+M w\+Param, L\+P\+A\+R\+A\+M l\+Param)
\item 
static void \hyperlink{sys_2wince_2mhmap_8c_acfd7d36e3901d8197557d3d407c230f2}{nhcoord2display} (\hyperlink{sys_2wince_2mhmap_8c_a82a6298010a5511f78638af4f6e4cd15}{P\+N\+H\+Map\+Window} data, int x, int y, L\+P\+R\+E\+C\+T lp\+Out)
\item 
static void \hyperlink{sys_2wince_2mhmap_8c_a92c2fac997281e762c8412717d45b070}{nhglyph2charcolor} (short glyph, \hyperlink{config_8h_a65f85814a8290f9797005d3b28e7e5fc}{uchar} $\ast$ch, int $\ast$color)
\item 
static C\+O\+L\+O\+R\+R\+E\+F \hyperlink{sys_2wince_2mhmap_8c_a2890a5b6d70f564ac1adf21acf5c07b4}{nhcolor\+\_\+to\+\_\+\+R\+G\+B} (int c)
\item 
H\+W\+N\+D \hyperlink{sys_2wince_2mhmap_8c_acf950cd4cd206210c7758862afe6bd21}{mswin\+\_\+init\+\_\+map\+\_\+window} ()
\item 
void \hyperlink{sys_2wince_2mhmap_8c_a02cf8b2ed4e7d6cbd2355d759ad547ef}{mswin\+\_\+map\+\_\+stretch} (H\+W\+N\+D h\+Wnd, L\+P\+S\+I\+Z\+E lpsz, B\+O\+O\+L redraw)
\item 
int \hyperlink{sys_2wince_2mhmap_8c_a3cc8c75ab01843325bb704d173373fd4}{mswin\+\_\+map\+\_\+mode} (H\+W\+N\+D h\+Wnd, int mode)
\item 
void \hyperlink{sys_2wince_2mhmap_8c_afb458d94567c267343944df598e6f1e9}{nhapply\+\_\+image\+\_\+transparent} (H\+D\+C h\+D\+C, int x, int y, int \hyperlink{xpm2img_8c_a2474a5474cbff19523a51eb1de01cda4}{width}, int \hyperlink{xpm2img_8c_ad12fc34ce789bce6c8a05d8a17138534}{height}, H\+D\+C source\+D\+C, int s\+\_\+x, int s\+\_\+y, int s\+\_\+width, int s\+\_\+height, C\+O\+L\+O\+R\+R\+E\+F c\+Transparent)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
short \hyperlink{sys_2wince_2mhmap_8c_a4d61aa736dae8287d97c3a68a3a917c5}{glyph2tile} \mbox{[}$\,$\mbox{]}
\item 
static T\+C\+H\+A\+R \hyperlink{sys_2wince_2mhmap_8c_aa3c635b8b814001fd57033f830cfc850}{sz\+N\+H\+Map\+Window\+Class} \mbox{[}$\,$\mbox{]} = T\+E\+X\+T(\char`\"{}M\+S\+Nethack\+Map\+Wnd\+Class\char`\"{})
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{sys_2wince_2mhmap_8c_a7af6c3375df7db9c0a656e950e173112}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!cmap\+\_\+color@{cmap\+\_\+color}}
\index{cmap\+\_\+color@{cmap\+\_\+color}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{cmap\+\_\+color}]{\setlength{\rightskip}{0pt plus 5cm}\#define cmap\+\_\+color(
\begin{DoxyParamCaption}
\item[{}]{n}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2mhmap_8c_a7af6c3375df7db9c0a656e950e173112}


Referenced by nhglyph2charcolor().

\hypertarget{sys_2wince_2mhmap_8c_a7823f335c74115317a5e71c645dae320}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!M\+A\+X\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T@{M\+A\+X\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T}}
\index{M\+A\+X\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T@{M\+A\+X\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{M\+A\+X\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+A\+X\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T~255}}\label{sys_2wince_2mhmap_8c_a7823f335c74115317a5e71c645dae320}


Definition at line 13 of file mhmap.\+c.

\hypertarget{sys_2wince_2mhmap_8c_a440d023c793bae7397f872d8f79803f0}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!mon\+\_\+color@{mon\+\_\+color}}
\index{mon\+\_\+color@{mon\+\_\+color}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{mon\+\_\+color}]{\setlength{\rightskip}{0pt plus 5cm}\#define mon\+\_\+color(
\begin{DoxyParamCaption}
\item[{}]{n}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2mhmap_8c_a440d023c793bae7397f872d8f79803f0}


Referenced by nhglyph2charcolor().

\hypertarget{sys_2wince_2mhmap_8c_ad3e0b865c7bff9658de5db29c3ac3798}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!N\+H\+M\+A\+P\+\_\+\+F\+O\+N\+T\+\_\+\+N\+A\+M\+E@{N\+H\+M\+A\+P\+\_\+\+F\+O\+N\+T\+\_\+\+N\+A\+M\+E}}
\index{N\+H\+M\+A\+P\+\_\+\+F\+O\+N\+T\+\_\+\+N\+A\+M\+E@{N\+H\+M\+A\+P\+\_\+\+F\+O\+N\+T\+\_\+\+N\+A\+M\+E}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{N\+H\+M\+A\+P\+\_\+\+F\+O\+N\+T\+\_\+\+N\+A\+M\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\+H\+M\+A\+P\+\_\+\+F\+O\+N\+T\+\_\+\+N\+A\+M\+E~T\+E\+X\+T(\char`\"{}Terminal\char`\"{})}}\label{sys_2wince_2mhmap_8c_ad3e0b865c7bff9658de5db29c3ac3798}


Definition at line 12 of file mhmap.\+c.



Referenced by mswin\+\_\+map\+\_\+stretch().

\hypertarget{sys_2wince_2mhmap_8c_a416b5979efb02c985539d51e0a9d620e}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!obj\+\_\+color@{obj\+\_\+color}}
\index{obj\+\_\+color@{obj\+\_\+color}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{obj\+\_\+color}]{\setlength{\rightskip}{0pt plus 5cm}\#define obj\+\_\+color(
\begin{DoxyParamCaption}
\item[{}]{n}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2mhmap_8c_a416b5979efb02c985539d51e0a9d620e}


Referenced by nhglyph2charcolor().

\hypertarget{sys_2wince_2mhmap_8c_abfd7f07931aaf9517da205d2831b1eb6}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!pet\+\_\+color@{pet\+\_\+color}}
\index{pet\+\_\+color@{pet\+\_\+color}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{pet\+\_\+color}]{\setlength{\rightskip}{0pt plus 5cm}\#define pet\+\_\+color(
\begin{DoxyParamCaption}
\item[{}]{c}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2mhmap_8c_abfd7f07931aaf9517da205d2831b1eb6}


Referenced by nhglyph2charcolor().

\hypertarget{sys_2wince_2mhmap_8c_aa3ec93aaff402d07c963c954d07c1a51}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!warn\+\_\+color@{warn\+\_\+color}}
\index{warn\+\_\+color@{warn\+\_\+color}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{warn\+\_\+color}]{\setlength{\rightskip}{0pt plus 5cm}\#define warn\+\_\+color(
\begin{DoxyParamCaption}
\item[{}]{c}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2mhmap_8c_aa3ec93aaff402d07c963c954d07c1a51}


Referenced by nhglyph2charcolor().

\hypertarget{sys_2wince_2mhmap_8c_a21594d0d7a347c8a66fb45ddd84260ee}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!zap\+\_\+color@{zap\+\_\+color}}
\index{zap\+\_\+color@{zap\+\_\+color}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{zap\+\_\+color}]{\setlength{\rightskip}{0pt plus 5cm}\#define zap\+\_\+color(
\begin{DoxyParamCaption}
\item[{}]{n}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2mhmap_8c_a21594d0d7a347c8a66fb45ddd84260ee}


Referenced by nhglyph2charcolor().



\subsection{Typedef Documentation}
\hypertarget{sys_2wince_2mhmap_8c_a454c3dc21996d0a724cde74e05faa0b7}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!N\+H\+Map\+Window@{N\+H\+Map\+Window}}
\index{N\+H\+Map\+Window@{N\+H\+Map\+Window}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{N\+H\+Map\+Window}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf mswin\+\_\+nethack\+\_\+map\+\_\+window}  {\bf N\+H\+Map\+Window}}}\label{sys_2wince_2mhmap_8c_a454c3dc21996d0a724cde74e05faa0b7}
\hypertarget{sys_2wince_2mhmap_8c_a82a6298010a5511f78638af4f6e4cd15}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!P\+N\+H\+Map\+Window@{P\+N\+H\+Map\+Window}}
\index{P\+N\+H\+Map\+Window@{P\+N\+H\+Map\+Window}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{P\+N\+H\+Map\+Window}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf mswin\+\_\+nethack\+\_\+map\+\_\+window} $\ast$ {\bf P\+N\+H\+Map\+Window}}}\label{sys_2wince_2mhmap_8c_a82a6298010a5511f78638af4f6e4cd15}


\subsection{Function Documentation}
\hypertarget{sys_2wince_2mhmap_8c_a86c4e3dd38831a39ff511ae76ea288c2}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!Map\+Wnd\+Proc@{Map\+Wnd\+Proc}}
\index{Map\+Wnd\+Proc@{Map\+Wnd\+Proc}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{Map\+Wnd\+Proc}]{\setlength{\rightskip}{0pt plus 5cm}L\+R\+E\+S\+U\+L\+T C\+A\+L\+L\+B\+A\+C\+K Map\+Wnd\+Proc (
\begin{DoxyParamCaption}
\item[{H\+W\+N\+D}]{h\+Wnd, }
\item[{{\bf U\+I\+N\+T}}]{message, }
\item[{W\+P\+A\+R\+A\+M}]{w\+Param, }
\item[{L\+P\+A\+R\+A\+M}]{l\+Param}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2mhmap_8c_a86c4e3dd38831a39ff511ae76ea288c2}


Definition at line 324 of file mhmap.\+c.



References mswin\+\_\+nethack\+\_\+map\+\_\+window\+::b\+Fit\+To\+Screen\+Mode, C\+L\+I\+C\+K\+\_\+1, C\+L\+I\+C\+K\+\_\+2, C\+O\+L\+N\+O, free(), Get\+N\+H\+App(), mswin\+\_\+nethack\+\_\+map\+\_\+window\+::h\+Map\+Font, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::map\+\_\+orig, max, min, mswin\+\_\+map\+\_\+stretch(), N\+H\+E\+V\+E\+N\+T\+\_\+\+M\+S, on\+Create(), on\+M\+S\+N\+H\+\_\+\+H\+Scroll(), on\+M\+S\+N\+H\+\_\+\+V\+Scroll(), on\+M\+S\+N\+H\+Command(), on\+Paint(), R\+O\+W\+N\+O, S\+I\+Z\+E, T\+R\+U\+E, W\+M\+\_\+\+M\+S\+N\+H\+\_\+\+C\+O\+M\+M\+A\+N\+D, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::x\+Pos, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::x\+Scr\+Tile, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::y\+Pos, and mswin\+\_\+nethack\+\_\+map\+\_\+window\+::y\+Scr\+Tile.



Referenced by register\+\_\+map\+\_\+window\+\_\+class().


\begin{DoxyCode}
325 \{
326     \hyperlink{structmswin__nethack__map__window}{PNHMapWindow} data;
327     
328     data = (\hyperlink{sys_2wince_2mhmap_8c_a82a6298010a5511f78638af4f6e4cd15}{PNHMapWindow})GetWindowLong(hWnd, GWL\_USERDATA);
329     \textcolor{keywordflow}{switch} (message) 
330     \{
331     \textcolor{keywordflow}{case} WM\_CREATE:
332         \hyperlink{sys_2wince_2mhmap_8c_a8d537e532190de086a8d3636c37c57a9}{onCreate}( hWnd, wParam, lParam );
333         \textcolor{keywordflow}{break};
334 
335     \textcolor{keywordflow}{case} \hyperlink{sys_2wince_2mhmsg_8h_a55eac656fabe0d462816201ac756eab6}{WM\_MSNH\_COMMAND}:
336         \hyperlink{sys_2wince_2mhmap_8c_ab1f0aceef05a1dec643246c7cbf5353c}{onMSNHCommand}(hWnd, wParam, lParam);
337         \textcolor{keywordflow}{break};
338 
339     \textcolor{keywordflow}{case} WM\_PAINT: 
340         \hyperlink{sys_2wince_2mhmap_8c_ad09a28d28eea324af31f4fdfa19a44b4}{onPaint}(hWnd);
341         \textcolor{keywordflow}{break};
342 
343     \textcolor{keywordflow}{case} WM\_SETFOCUS:
344         \textcolor{comment}{/* transfer focus back to the main window */}
345         SetFocus(\hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->hMainWnd);
346         \textcolor{keywordflow}{break};
347 
348     \textcolor{keywordflow}{case} WM\_HSCROLL:
349         \hyperlink{sys_2wince_2mhmap_8c_ad9a3e28d520ba0d767dd1b281c074ea6}{onMSNH\_HScroll}(hWnd, wParam, lParam);
350         \textcolor{keywordflow}{break};
351 
352     \textcolor{keywordflow}{case} WM\_VSCROLL:
353         \hyperlink{sys_2wince_2mhmap_8c_a1f270ab41a83935a7f1a12c1ebf960c1}{onMSNH\_VScroll}(hWnd, wParam, lParam);
354         \textcolor{keywordflow}{break};
355 
356     \textcolor{keywordflow}{case} WM\_SIZE: 
357     \{ 
358         \hyperlink{global_8h_afd2537d19a3cb6556b0f727580ec6ee7}{SIZE} \hyperlink{structsize}{size};
359 
360         \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} ) \{
361             size.cx = LOWORD(lParam);
362             size.cy = HIWORD(lParam);
363         \} \textcolor{keywordflow}{else} \{
364             \textcolor{comment}{/* mapping factor is unchaged we just need to adjust scroll bars */}
365             size.cx = data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile}*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}; 
366             size.cy = data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile}*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
367         \}
368         \hyperlink{sys_2wince_2mhmap_8c_a02cf8b2ed4e7d6cbd2355d759ad547ef}{mswin\_map\_stretch}(hWnd, &size, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
369     \} 
370     \textcolor{keywordflow}{break}; 
371 
372     \textcolor{keywordflow}{case} WM\_LBUTTONDOWN:
373         \hyperlink{sys_2wince_2mhinput_8h_a4281e55aeaf5f2a99315390737e7f546}{NHEVENT\_MS}( 
374             \hyperlink{wintype_8h_acaefc3f142237be043fe21977bf19afe}{CLICK\_1},
375             \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}, data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos} + (LOWORD(lParam)-data->
      \hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.x)/data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile})),
376             \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}, data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos} + (HIWORD(lParam)-data->
      \hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.y)/data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile}))
377         );
378     \textcolor{keywordflow}{return} 0;
379 
380     \textcolor{keywordflow}{case} WM\_LBUTTONDBLCLK :
381         \hyperlink{sys_2wince_2mhinput_8h_a4281e55aeaf5f2a99315390737e7f546}{NHEVENT\_MS}( 
382             \hyperlink{wintype_8h_ac44dad3d5c7ce9d3af01d967ea38e6e9}{CLICK\_2},
383             \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}, data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos} + (LOWORD(lParam)-data->
      \hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.x)/data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile})),
384             \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}, data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos} + (HIWORD(lParam)-data->
      \hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.y)/data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile}))
385         );
386     \textcolor{keywordflow}{return} 0;
387 
388     \textcolor{keywordflow}{case} WM\_DESTROY:
389         \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_a80fbf3a4db2d22dca0c765a19c54ebc8}{hMapFont} ) DeleteObject(data->\hyperlink{structmswin__nethack__map__window_a80fbf3a4db2d22dca0c765a19c54ebc8}{hMapFont});
390         \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}(data);
391         SetWindowLong(hWnd, GWL\_USERDATA, (LONG)0);
392         \textcolor{keywordflow}{break};
393 
394     \textcolor{keywordflow}{default}:
395         \textcolor{keywordflow}{return} DefWindowProc(hWnd, message, wParam, lParam);
396    \}
397    \textcolor{keywordflow}{return} 0;
398 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2mhmap_8c_acf950cd4cd206210c7758862afe6bd21}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!mswin\+\_\+init\+\_\+map\+\_\+window@{mswin\+\_\+init\+\_\+map\+\_\+window}}
\index{mswin\+\_\+init\+\_\+map\+\_\+window@{mswin\+\_\+init\+\_\+map\+\_\+window}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{mswin\+\_\+init\+\_\+map\+\_\+window}]{\setlength{\rightskip}{0pt plus 5cm}H\+W\+N\+D mswin\+\_\+init\+\_\+map\+\_\+window (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2mhmap_8c_acf950cd4cd206210c7758862afe6bd21}


Definition at line 47 of file mhmap.\+c.



Referenced by mswin\+\_\+create\+\_\+nhwindow().


\begin{DoxyCode}
47                               \{
48     \textcolor{keyword}{static} \textcolor{keywordtype}{int} run\_once = 0;
49     HWND ret;
50     DWORD styles;
51 
52     \textcolor{keywordflow}{if}( !run\_once ) \{
53         \hyperlink{sys_2wince_2mhmap_8c_a1f8f18b4bd46d6298fbadb48f5194ae7}{register\_map\_window\_class}();
54         run\_once = 1;
55     \}
56     
57     styles = WS\_CHILD | WS\_CLIPSIBLINGS;
58     \textcolor{keywordflow}{if}( !\hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->bHideScrollBars ) styles |= WS\_HSCROLL | WS\_VSCROLL;
59     ret = CreateWindow(
60             \hyperlink{sys_2wince_2mhmap_8c_aa3c635b8b814001fd57033f830cfc850}{szNHMapWindowClass},       \textcolor{comment}{/* registered class name */}
61             \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL},                   \textcolor{comment}{/* window name */}
62             styles, \textcolor{comment}{/* window style */}
63             0,  \textcolor{comment}{/* horizontal position of window - set it later */}
64             0,  \textcolor{comment}{/* vertical position of window - set it later */}
65             0,  \textcolor{comment}{/* window width - set it later */}
66             0,  \textcolor{comment}{/* window height - set it later*/}
67             \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->hMainWnd,   \textcolor{comment}{/* handle to parent or owner window */}
68             \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL},                   \textcolor{comment}{/* menu handle or child identifier */}
69             \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->hApp,       \textcolor{comment}{/* handle to application instance */}
70             \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} );                 \textcolor{comment}{/* window-creation data */}
71     \textcolor{keywordflow}{if}( !ret ) \{
72         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"Cannot create map window"});
73     \}
74     \textcolor{keywordflow}{return} ret;
75 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2mhmap_8c_a3cc8c75ab01843325bb704d173373fd4}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!mswin\+\_\+map\+\_\+mode@{mswin\+\_\+map\+\_\+mode}}
\index{mswin\+\_\+map\+\_\+mode@{mswin\+\_\+map\+\_\+mode}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{mswin\+\_\+map\+\_\+mode}]{\setlength{\rightskip}{0pt plus 5cm}int mswin\+\_\+map\+\_\+mode (
\begin{DoxyParamCaption}
\item[{H\+W\+N\+D}]{h\+Wnd, }
\item[{int}]{mode}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2mhmap_8c_a3cc8c75ab01843325bb704d173373fd4}


Definition at line 189 of file mhmap.\+c.



Referenced by mswin\+\_\+clear\+\_\+nhwindow(), and mswin\+\_\+select\+\_\+map\+\_\+mode().


\begin{DoxyCode}
190 \{
191     \hyperlink{structmswin__nethack__map__window}{PNHMapWindow} data;
192     \textcolor{keywordtype}{int} oldMode;
193     \hyperlink{global_8h_afd2537d19a3cb6556b0f727580ec6ee7}{SIZE} mapSize;
194 
195     data = (\hyperlink{sys_2wince_2mhmap_8c_a82a6298010a5511f78638af4f6e4cd15}{PNHMapWindow})GetWindowLong(hWnd, GWL\_USERDATA);
196     \textcolor{keywordflow}{if}( mode == data->\hyperlink{structmswin__nethack__map__window_a75b76933790e3cc4d09c9f97df1afc1d}{mapMode} ) \textcolor{keywordflow}{return} mode;
197     
198     oldMode = data->\hyperlink{structmswin__nethack__map__window_a75b76933790e3cc4d09c9f97df1afc1d}{mapMode};
199     data->\hyperlink{structmswin__nethack__map__window_a75b76933790e3cc4d09c9f97df1afc1d}{mapMode} = mode;
200 
201     \textcolor{keywordflow}{switch}( data->\hyperlink{structmswin__nethack__map__window_a75b76933790e3cc4d09c9f97df1afc1d}{mapMode} ) \{
202 
203     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_a582c67d5746cd9ae752fac90e11294ae}{MAP\_MODE\_ASCII4x6}:
204         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
205         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
206         mapSize.cx = 4*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
207         mapSize.cy = 6*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
208     \textcolor{keywordflow}{break};
209 
210     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_a3899d2308eadec1b1ae23a03e7865234}{MAP\_MODE\_ASCII6x8}:
211         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
212         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
213         mapSize.cx = 6*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
214         mapSize.cy = 8*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
215     \textcolor{keywordflow}{break};
216 
217     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_a2ffafa4f297b5463eabe3b891bc92509}{MAP\_MODE\_ASCII8x8}:
218         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
219         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
220         mapSize.cx = 8*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
221         mapSize.cy = 8*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
222     \textcolor{keywordflow}{break};
223 
224     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_a6f2fe94dd9c875cf4d3c2545fb8d7ed7}{MAP\_MODE\_ASCII16x8}:
225         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
226         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
227         mapSize.cx = 16*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
228         mapSize.cy = 8*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
229     \textcolor{keywordflow}{break};
230 
231     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_a5cdad45aaeb5c092067eb1ce920544b3}{MAP\_MODE\_ASCII7x12}:
232         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
233         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
234         mapSize.cx = 7*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
235         mapSize.cy = 12*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
236     \textcolor{keywordflow}{break};
237 
238     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_ab7bde31d3953c37eddaf0cec4b967ce6}{MAP\_MODE\_ASCII8x12}:
239         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
240         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
241         mapSize.cx = 8*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
242         mapSize.cy = 12*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
243     \textcolor{keywordflow}{break};
244 
245     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_a679aea826169d4062ceb06f8c7ac2561}{MAP\_MODE\_ASCII16x12}:
246         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
247         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
248         mapSize.cx = 16*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
249         mapSize.cy = 12*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
250     \textcolor{keywordflow}{break};
251 
252     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_ae0d763de7f5d48bd0b4f7c3fda36eebb}{MAP\_MODE\_ASCII12x16}:
253         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
254         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
255         mapSize.cx = 12*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
256         mapSize.cy = 16*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
257     \textcolor{keywordflow}{break};
258 
259     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_a6b787f35e03e46f21984e4190707430a}{MAP\_MODE\_ASCII10x18}:
260         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
261         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
262         mapSize.cx = 10*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
263         mapSize.cy = 18*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
264     \textcolor{keywordflow}{break};
265 
266     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_af4e337dbae61232212774e90a30d6506}{MAP\_MODE\_ASCII\_FIT\_TO\_SCREEN}: \{
267         RECT client\_rt;
268         GetClientRect(hWnd, &client\_rt);
269         mapSize.cx = client\_rt.right - client\_rt.left;
270         mapSize.cy = client\_rt.bottom - client\_rt.top;
271 
272         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
273         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
274     \} \textcolor{keywordflow}{break};
275 
276     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_aa30c90d80b3ba942295337a9dc1f9c1e}{MAP\_MODE\_TILES\_FIT\_TO\_SCREEN}: \{
277         RECT client\_rt;
278         GetClientRect(hWnd, &client\_rt);
279         mapSize.cx = client\_rt.right - client\_rt.left;
280         mapSize.cy = client\_rt.bottom - client\_rt.top;
281 
282         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
283         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
284     \} \textcolor{keywordflow}{break};
285 
286     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_a4e5a5df8a98a429b268f73636dbce5ab}{MAP\_MODE\_TILES}:
287     \textcolor{keywordflow}{default}:
288         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
289         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
290         mapSize.cx = \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_adb6d803036dca29b82a10f0fbd007edd}{mapTile\_X}*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
291         mapSize.cy = \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_a699b7a92f8c907030eff6ef5a36d29f3}{mapTile\_Y}*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
292     \textcolor{keywordflow}{break};
293     \}
294 
295     \hyperlink{sys_2wince_2mhmap_8c_a02cf8b2ed4e7d6cbd2355d759ad547ef}{mswin\_map\_stretch}(hWnd, &mapSize, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
296 
297     \textcolor{keywordflow}{return} oldMode;
298 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2mhmap_8c_a02cf8b2ed4e7d6cbd2355d759ad547ef}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!mswin\+\_\+map\+\_\+stretch@{mswin\+\_\+map\+\_\+stretch}}
\index{mswin\+\_\+map\+\_\+stretch@{mswin\+\_\+map\+\_\+stretch}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{mswin\+\_\+map\+\_\+stretch}]{\setlength{\rightskip}{0pt plus 5cm}void mswin\+\_\+map\+\_\+stretch (
\begin{DoxyParamCaption}
\item[{H\+W\+N\+D}]{h\+Wnd, }
\item[{L\+P\+S\+I\+Z\+E}]{lpsz, }
\item[{B\+O\+O\+L}]{redraw}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2mhmap_8c_a02cf8b2ed4e7d6cbd2355d759ad547ef}


Definition at line 77 of file mhmap.\+c.



Referenced by init\+Map\+Tiles(), Map\+Wnd\+Proc(), and mswin\+\_\+map\+\_\+mode().


\begin{DoxyCode}
78 \{
79     \hyperlink{structmswin__nethack__map__window}{PNHMapWindow} data;
80     RECT         client\_rt;
81     SCROLLINFO   si;
82     \hyperlink{global_8h_afd2537d19a3cb6556b0f727580ec6ee7}{SIZE}         wnd\_size;               
83     LOGFONT      lgfnt;
84 
85     \textcolor{comment}{/* check arguments */}
86     \textcolor{keywordflow}{if}( !IsWindow(hWnd) ||
87         !lpsz ||
88         lpsz->cx<=0 ||
89         lpsz->cy<=0 ) \textcolor{keywordflow}{return};
90 
91     \textcolor{comment}{/* calculate window size */}
92     GetClientRect(hWnd, &client\_rt);
93     wnd\_size.cx = client\_rt.right - client\_rt.left;
94     wnd\_size.cy = client\_rt.bottom - client\_rt.top;
95     
96     \textcolor{comment}{/* set new screen tile size */}
97     data = (\hyperlink{sys_2wince_2mhmap_8c_a82a6298010a5511f78638af4f6e4cd15}{PNHMapWindow})GetWindowLong(hWnd, GWL\_USERDATA);
98     data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile} = 
99         \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(1, (data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode}? wnd\_size.cx : lpsz->cx) / 
      \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO});
100     data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile} = 
101         \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(1, (data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode}? wnd\_size.cy : lpsz->cy) / 
      \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO});
102 
103     \textcolor{comment}{/* set map origin point */}
104     data->\hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.x = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, client\_rt.left + (wnd\_size.cx - data->
      \hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile}*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO})/2 );
105     data->\hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.y = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, client\_rt.top + (wnd\_size.cy - data->
      \hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile}*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO})/2 );
106 
107     data->\hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.x -= data->\hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.x % data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile};
108     data->\hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.y -= data->\hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.y % data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile};
109 
110     \textcolor{comment}{/* adjust horizontal scroll bar */}
111     \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} )
112         data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize} = \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}+1;  \textcolor{comment}{/* disable scroll bar */}
113     \textcolor{keywordflow}{else}
114         data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize} = wnd\_size.cx/data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile};
115 
116     \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize} >= \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO} ) \{
117         data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos} = 0;
118         \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_a75259e1f797e53006ad99a4a28fe9b36}{bNoHScroll} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
119     \} \textcolor{keywordflow}{else} \{
120         \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_a75259e1f797e53006ad99a4a28fe9b36}{bNoHScroll} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
121         data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos} = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}-data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize}+1, 
      \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux} - data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize}/2));
122     \}
123 
124     \textcolor{keywordflow}{if}( !\hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->bHideScrollBars ) \{
125         si.cbSize = \textcolor{keyword}{sizeof}(si); 
126         si.fMask  = SIF\_RANGE | SIF\_PAGE | SIF\_POS; 
127         si.nMin   = 0; 
128         si.nMax   = \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}; 
129         si.nPage  = data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize}; 
130         si.nPos   = data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos}; 
131         SetScrollInfo(hWnd, SB\_HORZ, &si, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}); 
132     \}
133 
134     \textcolor{comment}{/* adjust vertical scroll bar */}
135     \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} )
136         data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize} = \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}+1;   \textcolor{comment}{/* disable scroll bar */}
137     \textcolor{keywordflow}{else}
138         data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize} = wnd\_size.cy/data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile};
139 
140     \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize} >= \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO} ) \{
141         data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos} = 0;
142         \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_ad0311b73326a15c00e147d1b9d809979}{bNoVScroll} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
143     \} \textcolor{keywordflow}{else} \{
144         \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_ad0311b73326a15c00e147d1b9d809979}{bNoVScroll} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
145         data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos} = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}-data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize}+1, 
      \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy} - data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize}/2));
146     \}
147 
148     \textcolor{keywordflow}{if}( !\hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->bHideScrollBars ) \{
149         si.cbSize = \textcolor{keyword}{sizeof}(si); 
150         si.fMask  = SIF\_RANGE | SIF\_PAGE | SIF\_POS; 
151         si.nMin   = 0; 
152         si.nMax   = \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}; 
153         si.nPage  = data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize}; 
154         si.nPos   = data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos}; 
155         SetScrollInfo(hWnd, SB\_VERT, &si, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
156     \}
157 
158     \textcolor{comment}{/* create font */}
159     \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_a80fbf3a4db2d22dca0c765a19c54ebc8}{hMapFont} ) DeleteObject(data->\hyperlink{structmswin__nethack__map__window_a80fbf3a4db2d22dca0c765a19c54ebc8}{hMapFont});
160     ZeroMemory(&lgfnt, \textcolor{keyword}{sizeof}(lgfnt));
161     lgfnt.lfHeight          =   -data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile};     \textcolor{comment}{// height of font}
162     lgfnt.lfWidth           =   -data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile};     \textcolor{comment}{// average character width}
163     lgfnt.lfEscapement      =   0;                   \textcolor{comment}{// angle of escapement}
164     lgfnt.lfOrientation     =   0;                   \textcolor{comment}{// base-line orientation angle}
165     lgfnt.lfWeight          =   FW\_NORMAL;           \textcolor{comment}{// font weight}
166     lgfnt.lfItalic          =   \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};              \textcolor{comment}{// italic attribute option}
167     lgfnt.lfUnderline       =   \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};              \textcolor{comment}{// underline attribute option}
168     lgfnt.lfStrikeOut       =   \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};              \textcolor{comment}{// strikeout attribute option}
169     lgfnt.lfCharSet         =   \hyperlink{sys_2wince_2mhfont_8c_af970523ac3adefc3a252ad43200ef52b}{mswin\_charset}();     \textcolor{comment}{// character set identifier}
170     lgfnt.lfOutPrecision    =   OUT\_DEFAULT\_PRECIS;  \textcolor{comment}{// output precision}
171     lgfnt.lfClipPrecision   =   CLIP\_DEFAULT\_PRECIS; \textcolor{comment}{// clipping precision}
172     lgfnt.lfQuality         =   DEFAULT\_QUALITY;     \textcolor{comment}{// output quality}
173     \textcolor{keywordflow}{if}( \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_aa6ea2de4586a805d461b0a92a229b7a8}{wc\_font\_map} &&
174         *\hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_aa6ea2de4586a805d461b0a92a229b7a8}{wc\_font\_map} ) \{
175         lgfnt.lfPitchAndFamily  = DEFAULT\_PITCH;         \textcolor{comment}{// pitch and family}
176         \hyperlink{wceconf_8h_a2ed36c9ee770dfe5f2d0e3088a62adad}{NH\_A2W}(\hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_aa6ea2de4586a805d461b0a92a229b7a8}{wc\_font\_map}, lgfnt.lfFaceName, LF\_FACESIZE);
177     \} \textcolor{keywordflow}{else} \{
178         lgfnt.lfPitchAndFamily  = FIXED\_PITCH;       \textcolor{comment}{// pitch and family}
179         \_tcsncpy(lgfnt.lfFaceName, \hyperlink{sys_2wince_2mhmap_8c_ad3e0b865c7bff9658de5db29c3ac3798}{NHMAP\_FONT\_NAME}, LF\_FACESIZE);
180     \}
181     data->\hyperlink{structmswin__nethack__map__window_a80fbf3a4db2d22dca0c765a19c54ebc8}{hMapFont} = CreateFontIndirect(&lgfnt);
182 
183     \hyperlink{sys_2wince_2mswproc_8c_a7f6e502e24b0302832e4afada1d64805}{mswin\_cliparound}(data->\hyperlink{structmswin__nethack__map__window_aab34317edd92c7cae3930bd9ffe026c4}{xCur}, data->\hyperlink{structmswin__nethack__map__window_a6d0d676450acedb201f08b279667818a}{yCur});
184 
185     \textcolor{keywordflow}{if}(redraw) InvalidateRect(hWnd, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
186 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2mhmap_8c_afb458d94567c267343944df598e6f1e9}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!nhapply\+\_\+image\+\_\+transparent@{nhapply\+\_\+image\+\_\+transparent}}
\index{nhapply\+\_\+image\+\_\+transparent@{nhapply\+\_\+image\+\_\+transparent}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{nhapply\+\_\+image\+\_\+transparent}]{\setlength{\rightskip}{0pt plus 5cm}void nhapply\+\_\+image\+\_\+transparent (
\begin{DoxyParamCaption}
\item[{H\+D\+C}]{h\+D\+C, }
\item[{int}]{x, }
\item[{int}]{y, }
\item[{int}]{width, }
\item[{int}]{height, }
\item[{H\+D\+C}]{source\+D\+C, }
\item[{int}]{s\+\_\+x, }
\item[{int}]{s\+\_\+y, }
\item[{int}]{s\+\_\+width, }
\item[{int}]{s\+\_\+height, }
\item[{C\+O\+L\+O\+R\+R\+E\+F}]{c\+Transparent}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2mhmap_8c_afb458d94567c267343944df598e6f1e9}


Definition at line 902 of file mhmap.\+c.



Referenced by N\+H\+Splash\+Wnd\+Proc(), on\+Draw\+Item(), and on\+Paint().


\begin{DoxyCode}
907 \{
908     TransparentImage(
909         hDC, x, y, \hyperlink{xpm2img_8c_a2474a5474cbff19523a51eb1de01cda4}{width}, \hyperlink{xpm2img_8c_ad12fc34ce789bce6c8a05d8a17138534}{height}, 
910         sourceDC, s\_x, s\_y, s\_width, s\_height,
911         cTransparent 
912     );
913 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2mhmap_8c_a2890a5b6d70f564ac1adf21acf5c07b4}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!nhcolor\+\_\+to\+\_\+\+R\+G\+B@{nhcolor\+\_\+to\+\_\+\+R\+G\+B}}
\index{nhcolor\+\_\+to\+\_\+\+R\+G\+B@{nhcolor\+\_\+to\+\_\+\+R\+G\+B}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{nhcolor\+\_\+to\+\_\+\+R\+G\+B}]{\setlength{\rightskip}{0pt plus 5cm}C\+O\+L\+O\+R\+R\+E\+F nhcolor\+\_\+to\+\_\+\+R\+G\+B (
\begin{DoxyParamCaption}
\item[{int}]{c}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{sys_2wince_2mhmap_8c_a2890a5b6d70f564ac1adf21acf5c07b4}


Definition at line 877 of file mhmap.\+c.



References C\+L\+R\+\_\+\+B\+L\+A\+C\+K, C\+L\+R\+\_\+\+B\+L\+U\+E, C\+L\+R\+\_\+\+B\+R\+I\+G\+H\+T\+\_\+\+B\+L\+U\+E, C\+L\+R\+\_\+\+B\+R\+I\+G\+H\+T\+\_\+\+C\+Y\+A\+N, C\+L\+R\+\_\+\+B\+R\+I\+G\+H\+T\+\_\+\+G\+R\+E\+E\+N, C\+L\+R\+\_\+\+B\+R\+I\+G\+H\+T\+\_\+\+M\+A\+G\+E\+N\+T\+A, C\+L\+R\+\_\+\+B\+R\+O\+W\+N, C\+L\+R\+\_\+\+C\+Y\+A\+N, C\+L\+R\+\_\+\+G\+R\+A\+Y, C\+L\+R\+\_\+\+G\+R\+E\+E\+N, C\+L\+R\+\_\+\+M\+A\+G\+E\+N\+T\+A, C\+L\+R\+\_\+\+O\+R\+A\+N\+G\+E, C\+L\+R\+\_\+\+R\+E\+D, C\+L\+R\+\_\+\+W\+H\+I\+T\+E, C\+L\+R\+\_\+\+Y\+E\+L\+L\+O\+W, N\+O\+\_\+\+C\+O\+L\+O\+R, and R\+G\+B.



Referenced by on\+Paint().


\begin{DoxyCode}
878 \{
879     \textcolor{keywordflow}{switch}(c) \{
880     \textcolor{keywordflow}{case} \hyperlink{color_8h_ad8fc23ac0b5f8e6292135c5647486d5a}{CLR\_BLACK}:            \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0x55, 0x55, 0x55);
881     \textcolor{keywordflow}{case} \hyperlink{color_8h_a440726f8973da46eba779f170566b4cc}{CLR\_RED}:            \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0xFF, 0x00, 0x00);
882     \textcolor{keywordflow}{case} \hyperlink{color_8h_a0c8c42824dd44b52d4289558804a128a}{CLR\_GREEN}:            \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0x00, 0x80, 0x00);
883     \textcolor{keywordflow}{case} \hyperlink{color_8h_ae6183033e0a87a0dc8f345aad0ceb94f}{CLR\_BROWN}:            \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0xA5, 0x2A, 0x2A);
884     \textcolor{keywordflow}{case} \hyperlink{color_8h_a0dab0df401c468a1012750cc6331dbe4}{CLR\_BLUE}:          \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0x00, 0x00, 0xFF);
885     \textcolor{keywordflow}{case} \hyperlink{color_8h_ab6d8d8f1ba06b04bc27ec83e59fad1eb}{CLR\_MAGENTA}:        \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0xFF, 0x00, 0xFF);
886     \textcolor{keywordflow}{case} \hyperlink{color_8h_a59d8c7d9960773718d8dac44a99bcac4}{CLR\_CYAN}:          \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0x00, 0xFF, 0xFF);
887     \textcolor{keywordflow}{case} \hyperlink{color_8h_ae6bc9ef7ab884321d5aed99e40b8bfbf}{CLR\_GRAY}:          \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0xC0, 0xC0, 0xC0);
888     \textcolor{keywordflow}{case} \hyperlink{color_8h_a69d859e537f858ca285d77a66755ded6}{NO\_COLOR}:          \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0xFF, 0xFF, 0xFF);
889     \textcolor{keywordflow}{case} \hyperlink{color_8h_a82bbec903d4fb5d640e1730763a59427}{CLR\_ORANGE}:      \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0xFF, 0xA5, 0x00);
890     \textcolor{keywordflow}{case} \hyperlink{color_8h_ab92660142f4d1045ec3bf75f75bbd351}{CLR\_BRIGHT\_GREEN}:      \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0x00, 0xFF, 0x00);
891     \textcolor{keywordflow}{case} \hyperlink{color_8h_ae0a5a80f5e963a782350b12e9cfcc9f3}{CLR\_YELLOW}:      \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0xFF, 0xFF, 0x00);
892     \textcolor{keywordflow}{case} \hyperlink{color_8h_a5dfd5b39ea9035f71a7054e066c76093}{CLR\_BRIGHT\_BLUE}:        \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0x00, 0xC0, 0xFF);
893     \textcolor{keywordflow}{case} \hyperlink{color_8h_aaf5c56b44c1ce54ae9b26278f652ea17}{CLR\_BRIGHT\_MAGENTA}:  \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0xFF, 0x80, 0xFF);
894     \textcolor{keywordflow}{case} \hyperlink{color_8h_a830c7dc413dc0174d1bad9f6c162fbe9}{CLR\_BRIGHT\_CYAN}:        \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0x80, 0xFF, 0xFF);    \textcolor{comment}{/* something close to
       aquamarine */}
895     \textcolor{keywordflow}{case} \hyperlink{color_8h_a200fd50f64e8a7777954547ef30798a1}{CLR\_WHITE}:            \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0xFF, 0xFF, 0xFF);
896     \textcolor{keywordflow}{default}:            \textcolor{keywordflow}{return} \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0x00, 0x00, 0x00);    \textcolor{comment}{/* black */}
897     \}
898 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2mhmap_8c_acfd7d36e3901d8197557d3d407c230f2}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!nhcoord2display@{nhcoord2display}}
\index{nhcoord2display@{nhcoord2display}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{nhcoord2display}]{\setlength{\rightskip}{0pt plus 5cm}void nhcoord2display (
\begin{DoxyParamCaption}
\item[{{\bf P\+N\+H\+Map\+Window}}]{data, }
\item[{int}]{x, }
\item[{int}]{y, }
\item[{L\+P\+R\+E\+C\+T}]{lp\+Out}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{sys_2wince_2mhmap_8c_acfd7d36e3901d8197557d3d407c230f2}


Definition at line 812 of file mhmap.\+c.



References mswin\+\_\+nethack\+\_\+map\+\_\+window\+::map\+\_\+orig, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::x\+Pos, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::x\+Scr\+Tile, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::y\+Pos, and mswin\+\_\+nethack\+\_\+map\+\_\+window\+::y\+Scr\+Tile.



Referenced by on\+M\+S\+N\+H\+Command(), and on\+Paint().


\begin{DoxyCode}
813 \{
814     lpOut->left = (x - data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos})*data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile} + data->\hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.x;
815     lpOut->top  = (y - data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos})*data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile} + data->\hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.y;
816     lpOut->right = lpOut->left + data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile};
817     lpOut->bottom = lpOut->top + data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile};
818 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2mhmap_8c_a92c2fac997281e762c8412717d45b070}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!nhglyph2charcolor@{nhglyph2charcolor}}
\index{nhglyph2charcolor@{nhglyph2charcolor}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{nhglyph2charcolor}]{\setlength{\rightskip}{0pt plus 5cm}void nhglyph2charcolor (
\begin{DoxyParamCaption}
\item[{short}]{glyph, }
\item[{{\bf uchar} $\ast$}]{ch, }
\item[{int $\ast$}]{color}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{sys_2wince_2mhmap_8c_a92c2fac997281e762c8412717d45b070}


Definition at line 822 of file mhmap.\+c.



References C\+L\+R\+\_\+\+W\+H\+I\+T\+E, cmap\+\_\+color, G\+L\+Y\+P\+H\+\_\+\+B\+O\+D\+Y\+\_\+\+O\+F\+F, G\+L\+Y\+P\+H\+\_\+\+C\+M\+A\+P\+\_\+\+O\+F\+F, G\+L\+Y\+P\+H\+\_\+\+O\+B\+J\+\_\+\+O\+F\+F, G\+L\+Y\+P\+H\+\_\+\+P\+E\+T\+\_\+\+O\+F\+F, G\+L\+Y\+P\+H\+\_\+\+S\+W\+A\+L\+L\+O\+W\+\_\+\+O\+F\+F, G\+L\+Y\+P\+H\+\_\+\+W\+A\+R\+N\+I\+N\+G\+\_\+\+O\+F\+F, G\+L\+Y\+P\+H\+\_\+\+Z\+A\+P\+\_\+\+O\+F\+F, mon\+\_\+color, mons, monsyms, obj\+\_\+color, objects, oc\+\_\+syms, offset, pet\+\_\+color, S\+\_\+sw\+\_\+tl, S\+\_\+vbeam, showsyms, warn\+\_\+color, warnsyms, and zap\+\_\+color.



Referenced by on\+Paint().


\begin{DoxyCode}
823 \{
824     \textcolor{keywordtype}{int} \hyperlink{Window_8c_a6313d4fad4381a8c1cd37bac963cec12}{offset};
825 \textcolor{preprocessor}{#ifdef TEXTCOLOR}
826 
827 \textcolor{preprocessor}{#define zap\_color(n)  *color = iflags.use\_color ? zapcolors[n] : NO\_COLOR}
828 \textcolor{preprocessor}{#define cmap\_color(n) *color = iflags.use\_color ? defsyms[n].color : NO\_COLOR}
829 \textcolor{preprocessor}{#define obj\_color(n)  *color = iflags.use\_color ? objects[n].oc\_color : NO\_COLOR}
830 \textcolor{preprocessor}{#define mon\_color(n)  *color = iflags.use\_color ? mons[n].mcolor : NO\_COLOR}
831 \textcolor{preprocessor}{#define pet\_color(n)  *color = iflags.use\_color ? mons[n].mcolor : NO\_COLOR}
832 \textcolor{preprocessor}{#define warn\_color(n) *color = iflags.use\_color ? def\_warnsyms[n].color : NO\_COLOR}
833 
834 \textcolor{preprocessor}{# else }\textcolor{comment}{/* no text color */}\textcolor{preprocessor}{}
835 
836 \textcolor{preprocessor}{#define zap\_color(n)}
837 \textcolor{preprocessor}{#define cmap\_color(n)}
838 \textcolor{preprocessor}{#define obj\_color(n)}
839 \textcolor{preprocessor}{#define mon\_color(n)}
840 \textcolor{preprocessor}{#define pet\_color(c)}
841 \textcolor{preprocessor}{#define warn\_color(c)}
842     *color = \hyperlink{color_8h_a200fd50f64e8a7777954547ef30798a1}{CLR\_WHITE};
843 \textcolor{preprocessor}{#endif}
844 
845     \textcolor{keywordflow}{if} ((offset = (g - \hyperlink{display_8h_a576bb53ad5713142683ac37a22ae0f94}{GLYPH\_WARNING\_OFF})) >= 0) \{       \textcolor{comment}{/* a warning flash */}
846         *ch = \hyperlink{decl_8h_a4724feb39c4f688d499f9db8c3c21adc}{warnsyms}[\hyperlink{Window_8c_a6313d4fad4381a8c1cd37bac963cec12}{offset}];
847         \hyperlink{sys_2wince_2mhmap_8c_aa3ec93aaff402d07c963c954d07c1a51}{warn\_color}(offset);
848     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((offset = (g - \hyperlink{display_8h_a12c3dedb11601c5df592451fca014723}{GLYPH\_SWALLOW\_OFF})) >= 0) \{  \textcolor{comment}{/* swallow */}
849         \textcolor{comment}{/* see swallow\_to\_glyph() in display.c */}
850         *ch = (\hyperlink{config_8h_a65f85814a8290f9797005d3b28e7e5fc}{uchar}) \hyperlink{rm_8h_ad8e71cd12d6e4d48b240325f0a5f9758}{showsyms}[\hyperlink{rm_8h_a7f752e26209b6ce4093e0602a91bc8c5}{S\_sw\_tl} + (offset & 0x7)];
851         \hyperlink{sys_2wince_2mhmap_8c_a440d023c793bae7397f872d8f79803f0}{mon\_color}(offset >> 3);
852     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((offset = (g - \hyperlink{display_8h_a51ca2fc1986619ae2d009cfdc555a7e4}{GLYPH\_ZAP\_OFF})) >= 0) \{  \textcolor{comment}{/* zap beam */}
853         \textcolor{comment}{/* see zapdir\_to\_glyph() in display.c */}
854         *ch = \hyperlink{rm_8h_ad8e71cd12d6e4d48b240325f0a5f9758}{showsyms}[\hyperlink{rm_8h_a9a6a555a394bf6a8896eb455f38bdf77}{S\_vbeam} + (offset & 0x3)];
855         \hyperlink{sys_2wince_2mhmap_8c_a21594d0d7a347c8a66fb45ddd84260ee}{zap\_color}((offset >> 2));
856     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((offset = (g - \hyperlink{display_8h_a80bd11da4029e7e4a70a1eb525121458}{GLYPH\_CMAP\_OFF})) >= 0) \{    \textcolor{comment}{/* cmap */}
857         *ch = \hyperlink{rm_8h_ad8e71cd12d6e4d48b240325f0a5f9758}{showsyms}[\hyperlink{Window_8c_a6313d4fad4381a8c1cd37bac963cec12}{offset}];
858         \hyperlink{sys_2wince_2mhmap_8c_a7af6c3375df7db9c0a656e950e173112}{cmap\_color}(offset);
859     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((offset = (g - \hyperlink{display_8h_afdd6729aca80c4ecb3cc89f77e70968c}{GLYPH\_OBJ\_OFF})) >= 0) \{  \textcolor{comment}{/* object */}
860         *ch = \hyperlink{decl_8h_a56fccf5eb894981c31e2e5e3a99abf12}{oc\_syms}[(int)\hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[offset].oc\_class];
861         \hyperlink{sys_2wince_2mhmap_8c_a416b5979efb02c985539d51e0a9d620e}{obj\_color}(offset);
862     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((offset = (g - \hyperlink{display_8h_a5b5531a8309865f07de98109cb3e0307}{GLYPH\_BODY\_OFF})) >= 0) \{    \textcolor{comment}{/* a corpse */}
863         *ch = \hyperlink{decl_8h_a56fccf5eb894981c31e2e5e3a99abf12}{oc\_syms}[(int)\hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[CORPSE].oc\_class];
864         \hyperlink{sys_2wince_2mhmap_8c_a440d023c793bae7397f872d8f79803f0}{mon\_color}(offset);
865     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((offset = (g - \hyperlink{display_8h_a6419de72cae8e55fc00371ae9a7abec1}{GLYPH\_PET\_OFF})) >= 0) \{  \textcolor{comment}{/* a pet */}
866         *ch = \hyperlink{decl_8h_a1a4e60e91ff456eebe6d55281f01f852}{monsyms}[(int)\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[offset].mlet];
867         \hyperlink{sys_2wince_2mhmap_8c_abfd7f07931aaf9517da205d2831b1eb6}{pet\_color}(offset);
868     \} \textcolor{keywordflow}{else} \{                            \textcolor{comment}{/* a monster */}
869         *ch = \hyperlink{decl_8h_a1a4e60e91ff456eebe6d55281f01f852}{monsyms}[(int)\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[g].mlet];
870         \hyperlink{sys_2wince_2mhmap_8c_a440d023c793bae7397f872d8f79803f0}{mon\_color}(g);
871     \}   
872     \textcolor{comment}{// end of wintty code}
873 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2mhmap_8c_a8d537e532190de086a8d3636c37c57a9}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!on\+Create@{on\+Create}}
\index{on\+Create@{on\+Create}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{on\+Create}]{\setlength{\rightskip}{0pt plus 5cm}void on\+Create (
\begin{DoxyParamCaption}
\item[{H\+W\+N\+D}]{h\+Wnd, }
\item[{W\+P\+A\+R\+A\+M}]{w\+Param, }
\item[{L\+P\+A\+R\+A\+M}]{l\+Param}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{sys_2wince_2mhmap_8c_a8d537e532190de086a8d3636c37c57a9}


Definition at line 505 of file mhmap.\+c.



References mswin\+\_\+nethack\+\_\+map\+\_\+window\+::b\+Ascii\+Mode, C\+O\+L\+N\+O, F\+A\+L\+S\+E, Get\+N\+H\+App(), malloc(), mswin\+\_\+nethack\+\_\+map\+\_\+window\+::map, mswin\+\_\+nhwindow\+\_\+app\+::map\+Tile\+\_\+\+X, mswin\+\_\+nhwindow\+\_\+app\+::map\+Tile\+\_\+\+Y, panic(), R\+O\+W\+N\+O, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::x\+Scr\+Tile, and mswin\+\_\+nethack\+\_\+map\+\_\+window\+::y\+Scr\+Tile.



Referenced by Map\+Wnd\+Proc().


\begin{DoxyCode}
506 \{
507     \hyperlink{structmswin__nethack__map__window}{PNHMapWindow} data;
508     \textcolor{keywordtype}{int} i,j;
509 
510     \textcolor{comment}{/* set window data */}
511     data = (\hyperlink{sys_2wince_2mhmap_8c_a82a6298010a5511f78638af4f6e4cd15}{PNHMapWindow})\hyperlink{winproto_8h_ab028c02ac00afc0c1d3c568ccad68869}{malloc}(\textcolor{keyword}{sizeof}(\hyperlink{structmswin__nethack__map__window}{NHMapWindow}));
512     \textcolor{keywordflow}{if}( !data ) \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"out of memory"});
513 
514     ZeroMemory(data, \textcolor{keyword}{sizeof}(\hyperlink{structmswin__nethack__map__window}{NHMapWindow}));
515     \textcolor{keywordflow}{for}(i=0; i<\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}; i++) 
516         \textcolor{keywordflow}{for}(j=0; j<\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}; j++) \{
517         data->\hyperlink{structmswin__nethack__map__window_acca7d1798acceef6832742bd7c54083c}{map}[i][j] = -1;
518     \}
519 
520     data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
521 
522     data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile} = \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_adb6d803036dca29b82a10f0fbd007edd}{mapTile\_X};
523     data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile} = \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_a699b7a92f8c907030eff6ef5a36d29f3}{mapTile\_Y};
524 
525     SetWindowLong(hWnd, GWL\_USERDATA, (LONG)data);
526 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2mhmap_8c_ad9a3e28d520ba0d767dd1b281c074ea6}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!on\+M\+S\+N\+H\+\_\+\+H\+Scroll@{on\+M\+S\+N\+H\+\_\+\+H\+Scroll}}
\index{on\+M\+S\+N\+H\+\_\+\+H\+Scroll@{on\+M\+S\+N\+H\+\_\+\+H\+Scroll}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{on\+M\+S\+N\+H\+\_\+\+H\+Scroll}]{\setlength{\rightskip}{0pt plus 5cm}void on\+M\+S\+N\+H\+\_\+\+H\+Scroll (
\begin{DoxyParamCaption}
\item[{H\+W\+N\+D}]{h\+Wnd, }
\item[{W\+P\+A\+R\+A\+M}]{w\+Param, }
\item[{L\+P\+A\+R\+A\+M}]{l\+Param}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{sys_2wince_2mhmap_8c_ad9a3e28d520ba0d767dd1b281c074ea6}


Definition at line 752 of file mhmap.\+c.



References C\+O\+L\+N\+O, Get\+N\+H\+App(), max, min, N\+U\+L\+L, T\+R\+U\+E, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::x\+Page\+Size, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::x\+Pos, and mswin\+\_\+nethack\+\_\+map\+\_\+window\+::x\+Scr\+Tile.



Referenced by Map\+Wnd\+Proc(), and N\+H\+Message\+Wnd\+Proc().


\begin{DoxyCode}
753 \{
754     \hyperlink{structmswin__nethack__map__window}{PNHMapWindow} data;
755     SCROLLINFO si;
756     \textcolor{keywordtype}{int} xNewPos;
757     \textcolor{keywordtype}{int} xDelta;
758  
759     \textcolor{comment}{/* get window data */}
760     data = (\hyperlink{sys_2wince_2mhmap_8c_a82a6298010a5511f78638af4f6e4cd15}{PNHMapWindow})GetWindowLong(hWnd, GWL\_USERDATA);
761     
762     \textcolor{keywordflow}{switch}(LOWORD (wParam)) 
763     \{ 
764         \textcolor{comment}{/* User clicked shaft left of the scroll box. */}
765         \textcolor{keywordflow}{case} SB\_PAGEUP: 
766              xNewPos = data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos}-data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize}; 
767              \textcolor{keywordflow}{break}; 
768 
769         \textcolor{comment}{/* User clicked shaft right of the scroll box. */}
770         \textcolor{keywordflow}{case} SB\_PAGEDOWN: 
771              xNewPos = data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos}+data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize}; 
772              \textcolor{keywordflow}{break}; 
773 
774         \textcolor{comment}{/* User clicked the left arrow. */}
775         \textcolor{keywordflow}{case} SB\_LINEUP: 
776              xNewPos = data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos}-1; 
777              \textcolor{keywordflow}{break}; 
778 
779         \textcolor{comment}{/* User clicked the right arrow. */}
780         \textcolor{keywordflow}{case} SB\_LINEDOWN: 
781              xNewPos = data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos}+1; 
782              \textcolor{keywordflow}{break}; 
783 
784         \textcolor{comment}{/* User dragged the scroll box. */}
785         \textcolor{keywordflow}{case} SB\_THUMBTRACK: 
786              xNewPos = HIWORD(wParam); 
787              \textcolor{keywordflow}{break}; 
788 
789         \textcolor{keywordflow}{default}: 
790              xNewPos = data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos}; 
791     \} 
792 
793     xNewPos = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}-data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize}+1, xNewPos));
794     \textcolor{keywordflow}{if}( xNewPos == data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos} ) \textcolor{keywordflow}{return};
795     
796     xDelta = xNewPos - data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos};
797     data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos} = xNewPos;
798 
799     ScrollWindowEx (hWnd, -data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile} * xDelta, 0, 
800             (CONST RECT *) \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, (CONST RECT *) \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 
801             (HRGN) \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, (LPRECT) NULL, SW\_INVALIDATE | SW\_ERASE); 
802 
803     \textcolor{keywordflow}{if}( !\hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->bHideScrollBars ) \{
804         si.cbSize = \textcolor{keyword}{sizeof}(si); 
805         si.fMask  = SIF\_POS; 
806         si.nPos   = data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos}; 
807         SetScrollInfo(hWnd, SB\_HORZ, &si, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}); 
808     \}
809 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2mhmap_8c_a1f270ab41a83935a7f1a12c1ebf960c1}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!on\+M\+S\+N\+H\+\_\+\+V\+Scroll@{on\+M\+S\+N\+H\+\_\+\+V\+Scroll}}
\index{on\+M\+S\+N\+H\+\_\+\+V\+Scroll@{on\+M\+S\+N\+H\+\_\+\+V\+Scroll}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{on\+M\+S\+N\+H\+\_\+\+V\+Scroll}]{\setlength{\rightskip}{0pt plus 5cm}void on\+M\+S\+N\+H\+\_\+\+V\+Scroll (
\begin{DoxyParamCaption}
\item[{H\+W\+N\+D}]{h\+Wnd, }
\item[{W\+P\+A\+R\+A\+M}]{w\+Param, }
\item[{L\+P\+A\+R\+A\+M}]{l\+Param}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{sys_2wince_2mhmap_8c_a1f270ab41a83935a7f1a12c1ebf960c1}


Definition at line 692 of file mhmap.\+c.



References Get\+N\+H\+App(), max, min, N\+U\+L\+L, R\+O\+W\+N\+O, T\+R\+U\+E, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::y\+Page\+Size, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::y\+Pos, and mswin\+\_\+nethack\+\_\+map\+\_\+window\+::y\+Scr\+Tile.



Referenced by Map\+Wnd\+Proc().


\begin{DoxyCode}
693 \{
694     \hyperlink{structmswin__nethack__map__window}{PNHMapWindow} data;
695     SCROLLINFO si;
696     \textcolor{keywordtype}{int} yNewPos;
697     \textcolor{keywordtype}{int} yDelta;
698  
699     \textcolor{comment}{/* get window data */}
700     data = (\hyperlink{sys_2wince_2mhmap_8c_a82a6298010a5511f78638af4f6e4cd15}{PNHMapWindow})GetWindowLong(hWnd, GWL\_USERDATA);
701 
702     \textcolor{keywordflow}{switch}(LOWORD (wParam)) 
703     \{ 
704         \textcolor{comment}{/* User clicked shaft left of the scroll box. */}
705         \textcolor{keywordflow}{case} SB\_PAGEUP: 
706              yNewPos = data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos}-data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize}; 
707              \textcolor{keywordflow}{break}; 
708 
709         \textcolor{comment}{/* User clicked shaft right of the scroll box. */}
710         \textcolor{keywordflow}{case} SB\_PAGEDOWN: 
711              yNewPos = data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos}+data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize}; 
712              \textcolor{keywordflow}{break}; 
713 
714         \textcolor{comment}{/* User clicked the left arrow. */}
715         \textcolor{keywordflow}{case} SB\_LINEUP: 
716              yNewPos = data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos}-1; 
717              \textcolor{keywordflow}{break}; 
718 
719         \textcolor{comment}{/* User clicked the right arrow. */}
720         \textcolor{keywordflow}{case} SB\_LINEDOWN: 
721              yNewPos = data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos}+1; 
722              \textcolor{keywordflow}{break}; 
723 
724         \textcolor{comment}{/* User dragged the scroll box. */}
725         \textcolor{keywordflow}{case} SB\_THUMBTRACK: 
726              yNewPos = HIWORD(wParam); 
727              \textcolor{keywordflow}{break}; 
728 
729         \textcolor{keywordflow}{default}: 
730              yNewPos = data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos}; 
731     \} 
732 
733     yNewPos = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}-data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize}+1, yNewPos));
734     \textcolor{keywordflow}{if}( yNewPos == data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos} ) \textcolor{keywordflow}{return};
735     
736     yDelta = yNewPos - data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos};
737     data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos} = yNewPos;
738 
739     ScrollWindowEx (hWnd, 0, -data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile} * yDelta, 
740             (CONST RECT *) \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, (CONST RECT *) \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 
741             (HRGN) \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, (LPRECT) NULL, SW\_INVALIDATE | SW\_ERASE); 
742 
743     \textcolor{keywordflow}{if}( !\hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->bHideScrollBars ) \{
744         si.cbSize = \textcolor{keyword}{sizeof}(si); 
745         si.fMask  = SIF\_POS; 
746         si.nPos   = data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos}; 
747         SetScrollInfo(hWnd, SB\_VERT, &si, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}); 
748     \}
749 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2mhmap_8c_ab1f0aceef05a1dec643246c7cbf5353c}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!on\+M\+S\+N\+H\+Command@{on\+M\+S\+N\+H\+Command}}
\index{on\+M\+S\+N\+H\+Command@{on\+M\+S\+N\+H\+Command}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{on\+M\+S\+N\+H\+Command}]{\setlength{\rightskip}{0pt plus 5cm}void on\+M\+S\+N\+H\+Command (
\begin{DoxyParamCaption}
\item[{H\+W\+N\+D}]{h\+Wnd, }
\item[{W\+P\+A\+R\+A\+M}]{w\+Param, }
\item[{L\+P\+A\+R\+A\+M}]{l\+Param}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{sys_2wince_2mhmap_8c_ab1f0aceef05a1dec643246c7cbf5353c}


Definition at line 401 of file mhmap.\+c.



References mswin\+\_\+nethack\+\_\+map\+\_\+window\+::b\+Ascii\+Mode, mswin\+\_\+nhwindow\+\_\+app\+::b\+No\+H\+Scroll, mswin\+\_\+nhwindow\+\_\+app\+::b\+No\+V\+Scroll, C\+O\+L\+N\+O, Get\+N\+H\+App(), mswin\+\_\+nhmsg\+\_\+print\+\_\+glyph\+::glyph, iflags, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::map, max, min, M\+S\+N\+H\+\_\+\+M\+S\+G\+\_\+\+C\+L\+E\+A\+R\+\_\+\+W\+I\+N\+D\+O\+W, M\+S\+N\+H\+\_\+\+M\+S\+G\+\_\+\+C\+L\+I\+P\+A\+R\+O\+U\+N\+D, M\+S\+N\+H\+\_\+\+M\+S\+G\+\_\+\+C\+U\+R\+S\+O\+R, M\+S\+N\+H\+\_\+\+M\+S\+G\+\_\+\+P\+R\+I\+N\+T\+\_\+\+G\+L\+Y\+P\+H, nhcoord2display(), N\+U\+L\+L, R\+O\+W\+N\+O, T\+R\+U\+E, instance\+\_\+flags\+::wc\+\_\+scroll\+\_\+amount, instance\+\_\+flags\+::wc\+\_\+scroll\+\_\+margin, mswin\+\_\+nhmsg\+\_\+print\+\_\+glyph\+::x, mswin\+\_\+nhmsg\+\_\+cliparound\+::x, mswin\+\_\+nhmsg\+\_\+cursor\+::x, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::x\+Cur, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::x\+Page\+Size, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::x\+Pos, mswin\+\_\+nhmsg\+\_\+print\+\_\+glyph\+::y, mswin\+\_\+nhmsg\+\_\+cliparound\+::y, mswin\+\_\+nhmsg\+\_\+cursor\+::y, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::y\+Cur, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::y\+Page\+Size, and mswin\+\_\+nethack\+\_\+map\+\_\+window\+::y\+Pos.



Referenced by Map\+Wnd\+Proc().


\begin{DoxyCode}
402 \{
403     \hyperlink{structmswin__nethack__map__window}{PNHMapWindow} data;
404     RECT rt;
405 
406     data = (\hyperlink{sys_2wince_2mhmap_8c_a82a6298010a5511f78638af4f6e4cd15}{PNHMapWindow})GetWindowLong(hWnd, GWL\_USERDATA);
407     \textcolor{keywordflow}{switch}(wParam) \{
408     \textcolor{keywordflow}{case} \hyperlink{sys_2wince_2mhmsg_8h_a8475ce07e844644a51c6ee4f4e07e769}{MSNH\_MSG\_PRINT\_GLYPH}: 
409     \{
410         \hyperlink{structmswin__nhmsg__print__glyph}{PMSNHMsgPrintGlyph} msg\_data = (\hyperlink{sys_2wince_2mhmsg_8h_a706c1408c33de78c90e6d1f5838f1ef2}{PMSNHMsgPrintGlyph})lParam;
411         data->\hyperlink{structmswin__nethack__map__window_acca7d1798acceef6832742bd7c54083c}{map}[msg\_data->\hyperlink{structmswin__nhmsg__print__glyph_a78882344ead9571272a05592dd30142b}{x}][msg\_data->\hyperlink{structmswin__nhmsg__print__glyph_a50e05842f25a1ae67f16ecba99cd0def}{y}] = msg\_data->\hyperlink{structmswin__nhmsg__print__glyph_a2abfc84b5f4e679af1923281cde0f809}{glyph};
412 
413         \textcolor{comment}{/* invalidate the update area */}
414         \hyperlink{sys_2wince_2mhmap_8c_acfd7d36e3901d8197557d3d407c230f2}{nhcoord2display}(data, msg\_data->\hyperlink{structmswin__nhmsg__print__glyph_a78882344ead9571272a05592dd30142b}{x}, msg\_data->\hyperlink{structmswin__nhmsg__print__glyph_a50e05842f25a1ae67f16ecba99cd0def}{y}, &rt);
415         InvalidateRect(hWnd, &rt, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
416     \} 
417     \textcolor{keywordflow}{break};
418 
419     \textcolor{keywordflow}{case} \hyperlink{sys_2wince_2mhmsg_8h_a65e9694798c4eb5ef185f3e6a91235ca}{MSNH\_MSG\_CLIPAROUND}: 
420     \{
421         \hyperlink{structmswin__nhmsg__cliparound}{PMSNHMsgClipAround} msg\_data = (\hyperlink{sys_2wince_2mhmsg_8h_a2ec2e0036c99e2b4fdc3ebbc2e3e7733}{PMSNHMsgClipAround})lParam;
422         \textcolor{keywordtype}{int} x, y;
423         BOOL scroll\_x, scroll\_y;
424         \textcolor{keywordtype}{int} mcam = \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_acc0ddbf55d8eaa67df7b5a70d17448b8}{wc\_scroll\_margin};
425 
426         \textcolor{comment}{/* calculate if you should clip around */}
427         scroll\_x =  
428             !\hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_a75259e1f797e53006ad99a4a28fe9b36}{bNoHScroll} &&
429             ( msg\_data->\hyperlink{structmswin__nhmsg__cliparound_aa4c933c98c2996de91a2ef67f3a2da60}{x}<(data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos}+mcam) ||
430               msg\_data->\hyperlink{structmswin__nhmsg__cliparound_aa4c933c98c2996de91a2ef67f3a2da60}{x}>(data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos}+data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize}-mcam) );
431         scroll\_y =  
432             !\hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_ad0311b73326a15c00e147d1b9d809979}{bNoVScroll} &&
433             ( msg\_data->\hyperlink{structmswin__nhmsg__cliparound_abc364e920cd9ba1c7e851f369c5ea310}{y}<(data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos}+mcam) ||
434               msg\_data->\hyperlink{structmswin__nhmsg__cliparound_abc364e920cd9ba1c7e851f369c5ea310}{y}>(data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos}+data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize}-mcam) );
435         
436         mcam += \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_ae26c02a271148327f70765f3ae5088af}{wc\_scroll\_amount} - 1;
437         \textcolor{comment}{/* get page size and center horizontally on x-position */}
438         \textcolor{keywordflow}{if}( scroll\_x ) \{
439             \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize}<=2*mcam ) \{
440                 x = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}, msg\_data->\hyperlink{structmswin__nhmsg__cliparound_aa4c933c98c2996de91a2ef67f3a2da60}{x} - data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize}/2));
441             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( msg\_data->\hyperlink{structmswin__nhmsg__cliparound_aa4c933c98c2996de91a2ef67f3a2da60}{x} < data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos}+data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize}/2 ) \{
442                 x = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}, msg\_data->\hyperlink{structmswin__nhmsg__cliparound_aa4c933c98c2996de91a2ef67f3a2da60}{x} - mcam));
443             \} \textcolor{keywordflow}{else} \{
444                 x = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}, msg\_data->\hyperlink{structmswin__nhmsg__cliparound_aa4c933c98c2996de91a2ef67f3a2da60}{x} - data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize} + mcam));
445             \}
446             SendMessage( hWnd, WM\_HSCROLL, (WPARAM)MAKELONG(SB\_THUMBTRACK, x), (LPARAM)
      \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}    );
447         \}
448 
449         \textcolor{comment}{/* get page size and center vertically on y-position */}
450         \textcolor{keywordflow}{if}( scroll\_y ) \{
451             \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize}<=2*mcam ) \{
452                 y = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}, msg\_data->\hyperlink{structmswin__nhmsg__cliparound_abc364e920cd9ba1c7e851f369c5ea310}{y} - data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize}/2));
453             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( msg\_data->\hyperlink{structmswin__nhmsg__cliparound_abc364e920cd9ba1c7e851f369c5ea310}{y} < data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos}+data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize}/2 ) \{
454                 y = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}, msg\_data->\hyperlink{structmswin__nhmsg__cliparound_abc364e920cd9ba1c7e851f369c5ea310}{y} - mcam));
455             \} \textcolor{keywordflow}{else} \{
456                 y = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}, msg\_data->\hyperlink{structmswin__nhmsg__cliparound_abc364e920cd9ba1c7e851f369c5ea310}{y} - data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize} + mcam));
457             \}
458             SendMessage( hWnd, WM\_VSCROLL, (WPARAM)MAKELONG(SB\_THUMBTRACK, y), (LPARAM)
      \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} );
459         \}
460     \} 
461     \textcolor{keywordflow}{break};
462 
463     \textcolor{keywordflow}{case} \hyperlink{sys_2wince_2mhmsg_8h_a569048188a906452ebb6b755cd9ac662}{MSNH\_MSG\_CLEAR\_WINDOW}: 
464     \{
465         \textcolor{keywordtype}{int} i, j;
466         \textcolor{keywordflow}{for}(i=0; i<\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}; i++) 
467             \textcolor{keywordflow}{for}(j=0; j<\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}; j++) \{
468             data->\hyperlink{structmswin__nethack__map__window_acca7d1798acceef6832742bd7c54083c}{map}[i][j] = -1;
469         \}
470         InvalidateRect(hWnd, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
471     \} \textcolor{keywordflow}{break};
472 
473     \textcolor{keywordflow}{case} \hyperlink{sys_2wince_2mhmsg_8h_ad4b0bf60c918e045e8511e014f64f021}{MSNH\_MSG\_CURSOR}:
474     \{
475         \hyperlink{structmswin__nhmsg__cursor}{PMSNHMsgCursor} msg\_data = (\hyperlink{sys_2wince_2mhmsg_8h_a25f858d2772d0e451b737dc5cbed681a}{PMSNHMsgCursor})lParam;
476         HDC    hdc;
477         RECT   rt;
478 
479         \textcolor{comment}{/* move focus rectangle at the cursor postion */}
480         hdc = GetDC(hWnd);
481 
482         \hyperlink{sys_2wince_2mhmap_8c_acfd7d36e3901d8197557d3d407c230f2}{nhcoord2display}(data, data->\hyperlink{structmswin__nethack__map__window_aab34317edd92c7cae3930bd9ffe026c4}{xCur}, data->\hyperlink{structmswin__nethack__map__window_a6d0d676450acedb201f08b279667818a}{yCur}, &rt);
483         \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} ) \{
484             PatBlt(hdc, rt.left, rt.top, rt.right-rt.left, rt.bottom-rt.top, DSTINVERT);    
485         \} \textcolor{keywordflow}{else} \{
486             DrawFocusRect(hdc, &rt);
487         \}
488         
489         data->\hyperlink{structmswin__nethack__map__window_aab34317edd92c7cae3930bd9ffe026c4}{xCur} = msg\_data->\hyperlink{structmswin__nhmsg__cursor_a1bb0698246733cc297b66a312b33e743}{x};
490         data->\hyperlink{structmswin__nethack__map__window_a6d0d676450acedb201f08b279667818a}{yCur} = msg\_data->\hyperlink{structmswin__nhmsg__cursor_a4ecc187448dc2dbd8806212e5f7a4a16}{y};
491 
492         \hyperlink{sys_2wince_2mhmap_8c_acfd7d36e3901d8197557d3d407c230f2}{nhcoord2display}(data, data->\hyperlink{structmswin__nethack__map__window_aab34317edd92c7cae3930bd9ffe026c4}{xCur}, data->\hyperlink{structmswin__nethack__map__window_a6d0d676450acedb201f08b279667818a}{yCur}, &rt);
493         \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} ) \{
494             PatBlt(hdc, rt.left, rt.top, rt.right-rt.left, rt.bottom-rt.top, DSTINVERT);    
495         \} \textcolor{keywordflow}{else} \{
496             DrawFocusRect(hdc, &rt);
497         \}
498 
499         ReleaseDC(hWnd, hdc);
500     \} \textcolor{keywordflow}{break};
501     \}
502 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2mhmap_8c_ad09a28d28eea324af31f4fdfa19a44b4}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!on\+Paint@{on\+Paint}}
\index{on\+Paint@{on\+Paint}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{on\+Paint}]{\setlength{\rightskip}{0pt plus 5cm}void on\+Paint (
\begin{DoxyParamCaption}
\item[{H\+W\+N\+D}]{h\+Wnd}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{sys_2wince_2mhmap_8c_ad09a28d28eea324af31f4fdfa19a44b4}


Definition at line 529 of file mhmap.\+c.



References mswin\+\_\+nethack\+\_\+map\+\_\+window\+::b\+Ascii\+Mode, C\+L\+R\+\_\+\+B\+L\+A\+C\+K, C\+L\+R\+\_\+\+G\+R\+A\+Y, C\+L\+R\+\_\+\+W\+H\+I\+T\+E, C\+O\+L\+N\+O, Get\+N\+H\+App(), glyph2tile, glyph\+\_\+is\+\_\+pet, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::h\+Map\+Font, iflags, Is\+\_\+rogue\+\_\+level, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::map, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::map\+\_\+orig, mapglyph(), mswin\+\_\+nhwindow\+\_\+app\+::map\+Tile\+\_\+\+X, mswin\+\_\+nhwindow\+\_\+app\+::map\+Tile\+\_\+\+Y, mswin\+\_\+nhwindow\+\_\+app\+::map\+Tiles\+Per\+Line, max, M\+G\+\_\+\+D\+E\+T\+E\+C\+T, M\+G\+\_\+\+P\+E\+T, min, N\+H\+\_\+\+A2\+W, nhapply\+\_\+image\+\_\+transparent(), nhcolor\+\_\+to\+\_\+\+R\+G\+B(), nhcoord2display(), nhglyph2charcolor(), R\+E\+I\+N\+C\+A\+R\+N\+A\+T\+I\+O\+N, R\+O\+W\+N\+O, T\+I\+L\+E\+\_\+\+B\+K\+\_\+\+C\+O\+L\+O\+R, T\+I\+L\+E\+\_\+\+X, T\+I\+L\+E\+\_\+\+Y, u, you\+::uz, instance\+\_\+flags\+::wc\+\_\+hilite\+\_\+pet, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::x\+Cur, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::x\+Pos, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::x\+Scr\+Tile, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::y\+Cur, mswin\+\_\+nethack\+\_\+map\+\_\+window\+::y\+Pos, and mswin\+\_\+nethack\+\_\+map\+\_\+window\+::y\+Scr\+Tile.



Referenced by Map\+Wnd\+Proc().


\begin{DoxyCode}
530 \{
531     \hyperlink{structmswin__nethack__map__window}{PNHMapWindow} data;
532     PAINTSTRUCT ps;
533     HDC hDC;
534     HDC tileDC;
535     HGDIOBJ saveBmp;
536     RECT paint\_rt;
537     \textcolor{keywordtype}{int} i, j;
538 
539     \textcolor{comment}{/* get window data */}
540     data = (\hyperlink{sys_2wince_2mhmap_8c_a82a6298010a5511f78638af4f6e4cd15}{PNHMapWindow})GetWindowLong(hWnd, GWL\_USERDATA);
541 
542     hDC = BeginPaint(hWnd, &ps);
543 
544     \textcolor{comment}{/* calculate paint rectangle */}
545     \textcolor{keywordflow}{if}( !IsRectEmpty(&ps.rcPaint) ) \{
546         \textcolor{comment}{/* calculate paint rectangle */}
547         paint\_rt.left = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos} + (ps.rcPaint.left - data->
      \hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.x)/data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile}, 0);
548         paint\_rt.top = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos} + (ps.rcPaint.top - data->\hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.y)/data->
      \hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile}, 0);
549         paint\_rt.right = \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos} + (ps.rcPaint.right - data->
      \hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.x)/data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile}+1, \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO});
550         paint\_rt.bottom = \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos} + (ps.rcPaint.bottom - data->
      \hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.y)/data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile}+1, \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO});
551 
552         \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode}
553 #ifdef \hyperlink{config_8h_a6b9728c18024eafa560aaeb30159e47d}{REINCARNATION}
554             || \hyperlink{dungeon_8h_a2732117523c8540638daf4315dda16b9}{Is\_rogue\_level}(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}) 
555             \textcolor{comment}{/* You enter a VERY primitive world! */}
556 #endif
557             ) \{
558             HGDIOBJ oldFont;
559 
560             oldFont = SelectObject(hDC, data->\hyperlink{structmswin__nethack__map__window_a80fbf3a4db2d22dca0c765a19c54ebc8}{hMapFont});
561             SetBkMode(hDC, TRANSPARENT);
562 
563             \textcolor{comment}{/* draw the map */}
564             \textcolor{keywordflow}{for}(i=paint\_rt.left; i<paint\_rt.right; i++) 
565             \textcolor{keywordflow}{for}(j=paint\_rt.top; j<paint\_rt.bottom; j++) 
566             \textcolor{keywordflow}{if}(data->\hyperlink{structmswin__nethack__map__window_acca7d1798acceef6832742bd7c54083c}{map}[i][j]>=0) \{
567                 \textcolor{keywordtype}{char} ch;
568                 TCHAR wch;
569                 RECT  glyph\_rect;
570                 \textcolor{keywordtype}{int}   color;
571                 \textcolor{keywordtype}{unsigned} special;
572                 \textcolor{keywordtype}{int} mgch;
573                 HBRUSH back\_brush;
574                 COLORREF OldFg;
575 
576                 \hyperlink{sys_2wince_2mhmap_8c_acfd7d36e3901d8197557d3d407c230f2}{nhcoord2display}(data, i, j, &glyph\_rect);
577 
578 \textcolor{preprocessor}{#if (VERSION\_MAJOR < 4) && (VERSION\_MINOR < 4) && (PATCHLEVEL < 2)}
579                 \hyperlink{sys_2wince_2mhmap_8c_a92c2fac997281e762c8412717d45b070}{nhglyph2charcolor}(data->\hyperlink{structmswin__nethack__map__window_acca7d1798acceef6832742bd7c54083c}{map}[i][j], &ch, &color);
580                 OldFg = SetTextColor (hDC, \hyperlink{sys_2wince_2mhmap_8c_a2890a5b6d70f564ac1adf21acf5c07b4}{nhcolor\_to\_RGB}(color) );
581 \textcolor{preprocessor}{#else}
582                 \textcolor{comment}{/* rely on NetHack core helper routine */}
583                 \hyperlink{mapglyph_8c_a41586afa30d047782223d168f8912784}{mapglyph}(data->\hyperlink{structmswin__nethack__map__window_acca7d1798acceef6832742bd7c54083c}{map}[i][j], &mgch, &color,
584                         &special, i, j);
585                 ch = (char)mgch;
586                 \textcolor{keywordflow}{if} (((special & \hyperlink{hack_8h_a12128ae3dc4b1934065104f4bb945ca5}{MG\_PET}) && \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.hilite\_pet) ||
587                     ((special & \hyperlink{hack_8h_a79a8c30f938b77ed9cc08dcec5c6f08c}{MG\_DETECT}) && \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.use\_inverse)) \{
588                     back\_brush = CreateSolidBrush(\hyperlink{sys_2wince_2mhmap_8c_a2890a5b6d70f564ac1adf21acf5c07b4}{nhcolor\_to\_RGB}(
      \hyperlink{color_8h_ae6bc9ef7ab884321d5aed99e40b8bfbf}{CLR\_GRAY}));
589                     FillRect (hDC, &glyph\_rect, back\_brush);
590                     DeleteObject (back\_brush);
591                     \textcolor{keywordflow}{switch} (color)
592                     \{
593                     \textcolor{keywordflow}{case} \hyperlink{color_8h_ae6bc9ef7ab884321d5aed99e40b8bfbf}{CLR\_GRAY}:
594                     \textcolor{keywordflow}{case} \hyperlink{color_8h_a200fd50f64e8a7777954547ef30798a1}{CLR\_WHITE}:
595                         OldFg = SetTextColor( hDC,  \hyperlink{sys_2wince_2mhmap_8c_a2890a5b6d70f564ac1adf21acf5c07b4}{nhcolor\_to\_RGB}(
      \hyperlink{color_8h_ad8fc23ac0b5f8e6292135c5647486d5a}{CLR\_BLACK}));
596                         \textcolor{keywordflow}{break};
597                     \textcolor{keywordflow}{default}:
598                         OldFg = SetTextColor (hDC, \hyperlink{sys_2wince_2mhmap_8c_a2890a5b6d70f564ac1adf21acf5c07b4}{nhcolor\_to\_RGB}(color) );
599                     \}
600                 \} \textcolor{keywordflow}{else} \{
601                     OldFg = SetTextColor (hDC, \hyperlink{sys_2wince_2mhmap_8c_a2890a5b6d70f564ac1adf21acf5c07b4}{nhcolor\_to\_RGB}(color) );
602                 \}
603 \textcolor{preprocessor}{#endif}
604 
605                 DrawText(hDC, 
606                          \hyperlink{wceconf_8h_a2ed36c9ee770dfe5f2d0e3088a62adad}{NH\_A2W}(&ch, &wch, 1),
607                          1,
608                          &glyph\_rect,
609                          DT\_CENTER | DT\_VCENTER | DT\_NOPREFIX
610                          );
611                 SetTextColor (hDC, OldFg);
612             \}
613             SelectObject(hDC, oldFont);
614         \} \textcolor{keywordflow}{else} \{
615             \textcolor{comment}{/* prepare tiles DC for mapping */}
616             tileDC = CreateCompatibleDC(hDC);
617             saveBmp = SelectObject(tileDC, \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->bmpMapTiles);
618 
619             \textcolor{comment}{/* draw the map */}
620             \textcolor{keywordflow}{for}(i=paint\_rt.left; i<paint\_rt.right; i++) 
621             \textcolor{keywordflow}{for}(j=paint\_rt.top; j<paint\_rt.bottom; j++) 
622                 \textcolor{keywordflow}{if}(data->\hyperlink{structmswin__nethack__map__window_acca7d1798acceef6832742bd7c54083c}{map}[i][j]>=0) \{
623                     \textcolor{keywordtype}{short} ntile;
624                     \textcolor{keywordtype}{int} t\_x, t\_y;
625                     RECT glyph\_rect;
626 
627                     ntile = \hyperlink{sys_2wince_2mhmap_8c_a4d61aa736dae8287d97c3a68a3a917c5}{glyph2tile}[ data->\hyperlink{structmswin__nethack__map__window_acca7d1798acceef6832742bd7c54083c}{map}[i][j] ];
628                     t\_x = (ntile % \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_a7a89a59512a3bb56005832843339f479}{mapTilesPerLine})*
      \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_adb6d803036dca29b82a10f0fbd007edd}{mapTile\_X};
629                     t\_y = (ntile / \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_a7a89a59512a3bb56005832843339f479}{mapTilesPerLine})*
      \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_a699b7a92f8c907030eff6ef5a36d29f3}{mapTile\_Y};
630                     
631                     \hyperlink{sys_2wince_2mhmap_8c_acfd7d36e3901d8197557d3d407c230f2}{nhcoord2display}(data, i, j, &glyph\_rect);
632 
633                     StretchBlt( 
634                         hDC, 
635                         glyph\_rect.left,
636                         glyph\_rect.top, 
637                         data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile},
638                         data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile},
639                         tileDC,
640                         t\_x,
641                         t\_y,
642                         \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->mapTile\_X, 
643                         \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->mapTile\_Y, 
644                         SRCCOPY 
645                     );
646                     \textcolor{keywordflow}{if}( \hyperlink{display_8h_acc01c7be93d6e9a59ebe375de8879ca8}{glyph\_is\_pet}(data->\hyperlink{structmswin__nethack__map__window_acca7d1798acceef6832742bd7c54083c}{map}[i][j]) && \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.
      \hyperlink{structinstance__flags_a39b61413550ed104f741d52da8dec685}{wc\_hilite\_pet} ) \{
647                         \textcolor{comment}{/* apply pet mark transparently over }
648 \textcolor{comment}{                           pet image */}
649                         HDC hdcPetMark;
650                         HBITMAP    bmPetMarkOld;
651 
652                         \textcolor{comment}{/* this is DC for petmark bitmap */}
653                         hdcPetMark = CreateCompatibleDC(hDC);
654                         bmPetMarkOld = SelectObject(hdcPetMark, \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->bmpPetMark);
655 
656                         \hyperlink{sys_2wince_2mhmap_8c_afb458d94567c267343944df598e6f1e9}{nhapply\_image\_transparent}( 
657                             hDC,
658                             glyph\_rect.left,
659                             glyph\_rect.top, 
660                             data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile},
661                             data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile},
662                             hdcPetMark,
663                             0,
664                             0,
665                             \hyperlink{sys_2wince_2winMS_8h_a9f3fae6a9058d02850af5deba9be4544}{TILE\_X}, 
666                             \hyperlink{sys_2wince_2winMS_8h_a4a62524a49a9be02996b8e667b45abc9}{TILE\_Y},
667                             \hyperlink{sys_2wince_2winMS_8h_a43f48db3369313aac6df5acfab57a642}{TILE\_BK\_COLOR} 
668                         );
669                         SelectObject(hdcPetMark, bmPetMarkOld);
670                         DeleteDC(hdcPetMark);
671                     \}
672                 \}
673             SelectObject(tileDC, saveBmp);
674             DeleteDC(tileDC);
675         \}
676 
677         \textcolor{comment}{/* draw focus rect */}
678         \hyperlink{sys_2wince_2mhmap_8c_acfd7d36e3901d8197557d3d407c230f2}{nhcoord2display}(data, data->\hyperlink{structmswin__nethack__map__window_aab34317edd92c7cae3930bd9ffe026c4}{xCur}, data->\hyperlink{structmswin__nethack__map__window_a6d0d676450acedb201f08b279667818a}{yCur}, &paint\_rt);
679         \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} ) \{
680             PatBlt( hDC, 
681                     paint\_rt.left, paint\_rt.top, 
682                     paint\_rt.right-paint\_rt.left, paint\_rt.bottom-paint\_rt.top, 
683                     DSTINVERT );    
684         \} \textcolor{keywordflow}{else} \{
685             DrawFocusRect(hDC, &paint\_rt);
686         \}
687     \}
688     EndPaint(hWnd, &ps);
689 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2mhmap_8c_a1f8f18b4bd46d6298fbadb48f5194ae7}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!register\+\_\+map\+\_\+window\+\_\+class@{register\+\_\+map\+\_\+window\+\_\+class}}
\index{register\+\_\+map\+\_\+window\+\_\+class@{register\+\_\+map\+\_\+window\+\_\+class}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{register\+\_\+map\+\_\+window\+\_\+class}]{\setlength{\rightskip}{0pt plus 5cm}void register\+\_\+map\+\_\+window\+\_\+class (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{sys_2wince_2mhmap_8c_a1f8f18b4bd46d6298fbadb48f5194ae7}


Definition at line 301 of file mhmap.\+c.



References Get\+N\+H\+App(), mswin\+\_\+nhwindow\+\_\+app\+::h\+App, Map\+Wnd\+Proc(), N\+U\+L\+L, panic(), R\+G\+B, and sz\+N\+H\+Map\+Window\+Class.



Referenced by mswin\+\_\+init\+\_\+map\+\_\+window().


\begin{DoxyCode}
302 \{
303     WNDCLASS wcex;
304     ZeroMemory( &wcex, \textcolor{keyword}{sizeof}(wcex));
305 
306     \textcolor{comment}{/* window class */}
307     wcex.style          = CS\_NOCLOSE | CS\_DBLCLKS;
308     wcex.lpfnWndProc    = (WNDPROC)\hyperlink{sys_2wince_2mhmap_8c_a86c4e3dd38831a39ff511ae76ea288c2}{MapWndProc};
309     wcex.cbClsExtra     = 0;
310     wcex.cbWndExtra     = 0;
311     wcex.hInstance      = \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_ae3a365ad66195c8e1d915242897c3f24}{hApp};
312     wcex.hIcon          = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
313     wcex.hCursor        = LoadCursor(\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, IDC\_ARROW);
314     wcex.hbrBackground  = CreateSolidBrush(\hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0, 0, 0)); \textcolor{comment}{/* set backgroup here */}
315     wcex.lpszMenuName   = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
316     wcex.lpszClassName  = \hyperlink{sys_2wince_2mhmap_8c_aa3c635b8b814001fd57033f830cfc850}{szNHMapWindowClass};
317 
318     \textcolor{keywordflow}{if}( !RegisterClass(&wcex) ) \{
319         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"cannot register Map window class"});
320     \}
321 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{sys_2wince_2mhmap_8c_a4d61aa736dae8287d97c3a68a3a917c5}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!glyph2tile@{glyph2tile}}
\index{glyph2tile@{glyph2tile}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{glyph2tile}]{\setlength{\rightskip}{0pt plus 5cm}short glyph2tile\mbox{[}$\,$\mbox{]}}}\label{sys_2wince_2mhmap_8c_a4d61aa736dae8287d97c3a68a3a917c5}


Referenced by ghack\+\_\+image\+\_\+from\+\_\+glyph(), Glyph\+To\+Icon(), and on\+Paint().

\hypertarget{sys_2wince_2mhmap_8c_aa3c635b8b814001fd57033f830cfc850}{\index{sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}!sz\+N\+H\+Map\+Window\+Class@{sz\+N\+H\+Map\+Window\+Class}}
\index{sz\+N\+H\+Map\+Window\+Class@{sz\+N\+H\+Map\+Window\+Class}!sys/wince/mhmap.\+c@{sys/wince/mhmap.\+c}}
\subsubsection[{sz\+N\+H\+Map\+Window\+Class}]{\setlength{\rightskip}{0pt plus 5cm}T\+C\+H\+A\+R sz\+N\+H\+Map\+Window\+Class\mbox{[}$\,$\mbox{]} = T\+E\+X\+T(\char`\"{}M\+S\+Nethack\+Map\+Wnd\+Class\char`\"{})\hspace{0.3cm}{\ttfamily [static]}}}\label{sys_2wince_2mhmap_8c_aa3c635b8b814001fd57033f830cfc850}


Definition at line 33 of file mhmap.\+c.



Referenced by mswin\+\_\+init\+\_\+map\+\_\+window(), and register\+\_\+map\+\_\+window\+\_\+class().

