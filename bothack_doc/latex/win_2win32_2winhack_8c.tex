\hypertarget{win_2win32_2winhack_8c}{\section{nethack/win/win32/winhack.c File Reference}
\label{win_2win32_2winhack_8c}\index{nethack/win/win32/winhack.\+c@{nethack/win/win32/winhack.\+c}}
}
{\ttfamily \#include $<$process.\+h$>$}\\*
{\ttfamily \#include \char`\"{}win\+M\+S.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}hack.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}dlb.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}resource.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhmain.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhmap.\+h\char`\"{}}\\*
{\ttfamily \#include $<$shlwapi.\+h$>$}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{win_2win32_2winhack_8c_a59a23745a783d8231bd9424517729ce0}{S\+H\+A\+R\+E\+D\+\_\+\+D\+C\+L}~extern
\item 
\#define \hyperlink{win_2win32_2winhack_8c_a37b792c1f597eec7e0bcf57af95acdc0}{M\+I\+N\+\_\+\+C\+O\+M\+C\+T\+L\+M\+A\+J\+O\+R}~4
\item 
\#define \hyperlink{win_2win32_2winhack_8c_a3f650c1ab1b1688ef3d0a7be06ace937}{M\+I\+N\+\_\+\+C\+O\+M\+C\+T\+L\+M\+I\+N\+O\+R}~71
\item 
\#define \hyperlink{win_2win32_2winhack_8c_affb913efb62ae4cbc9f4396900719bc5}{I\+N\+S\+T\+A\+L\+L\+\_\+\+N\+O\+T\+E\+S}~\char`\"{}http\+://www.\+nethack.\+org/v340/ports/download-\/win.\+html\#cc\char`\"{}
\item 
\#define \hyperlink{win_2win32_2winhack_8c_a9993e50593c85529d2765c55200a3c1e}{M\+A\+X\+\_\+\+C\+M\+D\+L\+I\+N\+E\+\_\+\+P\+A\+R\+A\+M}~255
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{win_2win32_2winhack_8c_a7e74147e106fa0eeb0fbe2d6666a902d}{F\+D\+E\+C\+L} (\hyperlink{bemain_8c_aaf78dc4561c71581ba8f98f2c8db8b9d}{nethack\+\_\+exit},(int))
\item 
static T\+C\+H\+A\+R $\ast$ \hyperlink{win_2win32_2winhack_8c_a457d5d88c1b3751a9028e38bcaca36fe}{\+\_\+get\+\_\+cmd\+\_\+arg} (T\+C\+H\+A\+R $\ast$p\+Cmd\+Line)
\item 
static H\+R\+E\+S\+U\+L\+T \hyperlink{win_2win32_2winhack_8c_ac6d1d669be1ae971a5851191fce99ecd}{Get\+Com\+Ctl\+Version} (L\+P\+D\+W\+O\+R\+D pdw\+Major, L\+P\+D\+W\+O\+R\+D pdw\+Minor)
\item 
void \hyperlink{win_2win32_2winhack_8c_a35ab5aa1c10e2a5443c53bac07d014bf}{F\+D\+E\+C\+L} (pcmain,(int, char $\ast$$\ast$))
\item 
static void \+\_\+\+\_\+cdecl \hyperlink{win_2win32_2winhack_8c_aaa9c68d4ec5e948a847bee2903390945}{mswin\+\_\+moveloop} (void $\ast$)
\item 
int A\+P\+I\+E\+N\+T\+R\+Y \hyperlink{win_2win32_2winhack_8c_a1122673f59be78a3997ec7dd1c4688f9}{Win\+Main} (H\+I\+N\+S\+T\+A\+N\+C\+E h\+Instance, H\+I\+N\+S\+T\+A\+N\+C\+E h\+Prev\+Instance, L\+P\+S\+T\+R lp\+Cmd\+Line, int n\+Cmd\+Show)
\item 
\hyperlink{sys_2wince_2winMS_8h_a78ff8ed1e05072662719865d12608e75}{P\+N\+H\+Win\+App} \hyperlink{win_2win32_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{Get\+N\+H\+App} ()
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{sys_2wince_2winMS_8h_a52b1c3765f37fecb2265032f9c730ff1}{N\+H\+Win\+App} \hyperlink{win_2win32_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\+\_\+nethack\+\_\+app}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{win_2win32_2winhack_8c_affb913efb62ae4cbc9f4396900719bc5}{\index{win/win32/winhack.\+c@{win/win32/winhack.\+c}!I\+N\+S\+T\+A\+L\+L\+\_\+\+N\+O\+T\+E\+S@{I\+N\+S\+T\+A\+L\+L\+\_\+\+N\+O\+T\+E\+S}}
\index{I\+N\+S\+T\+A\+L\+L\+\_\+\+N\+O\+T\+E\+S@{I\+N\+S\+T\+A\+L\+L\+\_\+\+N\+O\+T\+E\+S}!win/win32/winhack.\+c@{win/win32/winhack.\+c}}
\subsubsection[{I\+N\+S\+T\+A\+L\+L\+\_\+\+N\+O\+T\+E\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\+N\+S\+T\+A\+L\+L\+\_\+\+N\+O\+T\+E\+S~\char`\"{}http\+://www.\+nethack.\+org/v340/ports/download-\/win.\+html\#cc\char`\"{}}}\label{win_2win32_2winhack_8c_affb913efb62ae4cbc9f4396900719bc5}


Definition at line 53 of file winhack.\+c.



Referenced by Win\+Main().

\hypertarget{win_2win32_2winhack_8c_a9993e50593c85529d2765c55200a3c1e}{\index{win/win32/winhack.\+c@{win/win32/winhack.\+c}!M\+A\+X\+\_\+\+C\+M\+D\+L\+I\+N\+E\+\_\+\+P\+A\+R\+A\+M@{M\+A\+X\+\_\+\+C\+M\+D\+L\+I\+N\+E\+\_\+\+P\+A\+R\+A\+M}}
\index{M\+A\+X\+\_\+\+C\+M\+D\+L\+I\+N\+E\+\_\+\+P\+A\+R\+A\+M@{M\+A\+X\+\_\+\+C\+M\+D\+L\+I\+N\+E\+\_\+\+P\+A\+R\+A\+M}!win/win32/winhack.\+c@{win/win32/winhack.\+c}}
\subsubsection[{M\+A\+X\+\_\+\+C\+M\+D\+L\+I\+N\+E\+\_\+\+P\+A\+R\+A\+M}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+A\+X\+\_\+\+C\+M\+D\+L\+I\+N\+E\+\_\+\+P\+A\+R\+A\+M~255}}\label{win_2win32_2winhack_8c_a9993e50593c85529d2765c55200a3c1e}


Definition at line 73 of file winhack.\+c.



Referenced by Win\+Main().

\hypertarget{win_2win32_2winhack_8c_a37b792c1f597eec7e0bcf57af95acdc0}{\index{win/win32/winhack.\+c@{win/win32/winhack.\+c}!M\+I\+N\+\_\+\+C\+O\+M\+C\+T\+L\+M\+A\+J\+O\+R@{M\+I\+N\+\_\+\+C\+O\+M\+C\+T\+L\+M\+A\+J\+O\+R}}
\index{M\+I\+N\+\_\+\+C\+O\+M\+C\+T\+L\+M\+A\+J\+O\+R@{M\+I\+N\+\_\+\+C\+O\+M\+C\+T\+L\+M\+A\+J\+O\+R}!win/win32/winhack.\+c@{win/win32/winhack.\+c}}
\subsubsection[{M\+I\+N\+\_\+\+C\+O\+M\+C\+T\+L\+M\+A\+J\+O\+R}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+I\+N\+\_\+\+C\+O\+M\+C\+T\+L\+M\+A\+J\+O\+R~4}}\label{win_2win32_2winhack_8c_a37b792c1f597eec7e0bcf57af95acdc0}


Definition at line 51 of file winhack.\+c.



Referenced by Win\+Main().

\hypertarget{win_2win32_2winhack_8c_a3f650c1ab1b1688ef3d0a7be06ace937}{\index{win/win32/winhack.\+c@{win/win32/winhack.\+c}!M\+I\+N\+\_\+\+C\+O\+M\+C\+T\+L\+M\+I\+N\+O\+R@{M\+I\+N\+\_\+\+C\+O\+M\+C\+T\+L\+M\+I\+N\+O\+R}}
\index{M\+I\+N\+\_\+\+C\+O\+M\+C\+T\+L\+M\+I\+N\+O\+R@{M\+I\+N\+\_\+\+C\+O\+M\+C\+T\+L\+M\+I\+N\+O\+R}!win/win32/winhack.\+c@{win/win32/winhack.\+c}}
\subsubsection[{M\+I\+N\+\_\+\+C\+O\+M\+C\+T\+L\+M\+I\+N\+O\+R}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+I\+N\+\_\+\+C\+O\+M\+C\+T\+L\+M\+I\+N\+O\+R~71}}\label{win_2win32_2winhack_8c_a3f650c1ab1b1688ef3d0a7be06ace937}


Definition at line 52 of file winhack.\+c.



Referenced by Win\+Main().

\hypertarget{win_2win32_2winhack_8c_a59a23745a783d8231bd9424517729ce0}{\index{win/win32/winhack.\+c@{win/win32/winhack.\+c}!S\+H\+A\+R\+E\+D\+\_\+\+D\+C\+L@{S\+H\+A\+R\+E\+D\+\_\+\+D\+C\+L}}
\index{S\+H\+A\+R\+E\+D\+\_\+\+D\+C\+L@{S\+H\+A\+R\+E\+D\+\_\+\+D\+C\+L}!win/win32/winhack.\+c@{win/win32/winhack.\+c}}
\subsubsection[{S\+H\+A\+R\+E\+D\+\_\+\+D\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+H\+A\+R\+E\+D\+\_\+\+D\+C\+L~extern}}\label{win_2win32_2winhack_8c_a59a23745a783d8231bd9424517729ce0}


Definition at line 39 of file winhack.\+c.



\subsection{Function Documentation}
\hypertarget{win_2win32_2winhack_8c_a457d5d88c1b3751a9028e38bcaca36fe}{\index{win/win32/winhack.\+c@{win/win32/winhack.\+c}!\+\_\+get\+\_\+cmd\+\_\+arg@{\+\_\+get\+\_\+cmd\+\_\+arg}}
\index{\+\_\+get\+\_\+cmd\+\_\+arg@{\+\_\+get\+\_\+cmd\+\_\+arg}!win/win32/winhack.\+c@{win/win32/winhack.\+c}}
\subsubsection[{\+\_\+get\+\_\+cmd\+\_\+arg}]{\setlength{\rightskip}{0pt plus 5cm}T\+C\+H\+A\+R $\ast$ \+\_\+get\+\_\+cmd\+\_\+arg (
\begin{DoxyParamCaption}
\item[{T\+C\+H\+A\+R $\ast$}]{p\+Cmd\+Line}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{win_2win32_2winhack_8c_a457d5d88c1b3751a9028e38bcaca36fe}


Definition at line 190 of file winhack.\+c.



References N\+U\+L\+L, and T\+R\+U\+E.



Referenced by Win\+Main().


\begin{DoxyCode}
191 \{
192         \textcolor{keyword}{static} TCHAR* pArgs = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
193         TCHAR  *pRetArg;
194         BOOL   bQuoted;
195 
196         \textcolor{keywordflow}{if}( !pCmdLine && !pArgs ) \textcolor{keywordflow}{return} \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
197         \textcolor{keywordflow}{if}( !pArgs ) pArgs = pCmdLine;
198 
199         \textcolor{comment}{/* skip whitespace */}
200         \textcolor{keywordflow}{for}(pRetArg = pArgs; *pRetArg && \_istspace(*pRetArg); pRetArg = CharNext(pRetArg));
201         \textcolor{keywordflow}{if}( !*pRetArg ) \{
202             pArgs = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
203             \textcolor{keywordflow}{return} \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
204         \}
205 
206         \textcolor{comment}{/* check for quote */}
207         \textcolor{keywordflow}{if}( *pRetArg==TEXT(\textcolor{charliteral}{'"'}) ) \{
208                 bQuoted = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
209                 pRetArg = CharNext(pRetArg);
210                 pArgs = \_tcschr(pRetArg, TEXT(\textcolor{charliteral}{'"'}));
211         \} \textcolor{keywordflow}{else} \{
212             \textcolor{comment}{/* skip to whitespace */}
213             \textcolor{keywordflow}{for}(pArgs = pRetArg; *pArgs && !\_istspace(*pArgs); pArgs = CharNext(pArgs));
214         \}
215         
216         \textcolor{keywordflow}{if}( pArgs && *pArgs ) \{
217             TCHAR* p;
218             p = pArgs;
219             pArgs = CharNext(pArgs);
220             *p = (TCHAR)0;
221         \} \textcolor{keywordflow}{else} \{
222             pArgs = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
223         \}
224 
225         \textcolor{keywordflow}{return} pRetArg;
226 \}
\end{DoxyCode}
\hypertarget{win_2win32_2winhack_8c_a7e74147e106fa0eeb0fbe2d6666a902d}{\index{win/win32/winhack.\+c@{win/win32/winhack.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!win/win32/winhack.\+c@{win/win32/winhack.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf nethack\+\_\+exit}}]{, }
\item[{(int)}]{}
\end{DoxyParamCaption}
)}}\label{win_2win32_2winhack_8c_a7e74147e106fa0eeb0fbe2d6666a902d}
\hypertarget{win_2win32_2winhack_8c_a35ab5aa1c10e2a5443c53bac07d014bf}{\index{win/win32/winhack.\+c@{win/win32/winhack.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!win/win32/winhack.\+c@{win/win32/winhack.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{pcmain}]{, }
\item[{(int, char $\ast$$\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{win_2win32_2winhack_8c_a35ab5aa1c10e2a5443c53bac07d014bf}
\hypertarget{win_2win32_2winhack_8c_ac6d1d669be1ae971a5851191fce99ecd}{\index{win/win32/winhack.\+c@{win/win32/winhack.\+c}!Get\+Com\+Ctl\+Version@{Get\+Com\+Ctl\+Version}}
\index{Get\+Com\+Ctl\+Version@{Get\+Com\+Ctl\+Version}!win/win32/winhack.\+c@{win/win32/winhack.\+c}}
\subsubsection[{Get\+Com\+Ctl\+Version}]{\setlength{\rightskip}{0pt plus 5cm}H\+R\+E\+S\+U\+L\+T Get\+Com\+Ctl\+Version (
\begin{DoxyParamCaption}
\item[{L\+P\+D\+W\+O\+R\+D}]{pdw\+Major, }
\item[{L\+P\+D\+W\+O\+R\+D}]{pdw\+Minor}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{win_2win32_2winhack_8c_ac6d1d669be1ae971a5851191fce99ecd}


Definition at line 231 of file winhack.\+c.



Referenced by Win\+Main().


\begin{DoxyCode}
232 \{
233     HINSTANCE   hComCtl;
234     HRESULT           hr = S\_OK;
235     DLLGETVERSIONPROC pDllGetVersion;
236 
237     \textcolor{keywordflow}{if}(IsBadWritePtr(pdwMajor, \textcolor{keyword}{sizeof}(DWORD)) ||
238        IsBadWritePtr(pdwMinor, \textcolor{keyword}{sizeof}(DWORD)))
239         \textcolor{keywordflow}{return} E\_INVALIDARG;
240     \textcolor{comment}{//load the DLL}
241     hComCtl = LoadLibrary(TEXT(\textcolor{stringliteral}{"comctl32.dll"}));
242     \textcolor{keywordflow}{if} (!hComCtl) \textcolor{keywordflow}{return} E\_FAIL;
243 
244     \textcolor{comment}{/*}
245 \textcolor{comment}{    You must get this function explicitly because earlier versions of the DLL}
246 \textcolor{comment}{    don't implement this function. That makes the lack of implementation of the}
247 \textcolor{comment}{    function a version marker in itself.}
248 \textcolor{comment}{    */}
249     pDllGetVersion = (DLLGETVERSIONPROC)GetProcAddress(hComCtl, TEXT(\textcolor{stringliteral}{"DllGetVersion"}));
250     \textcolor{keywordflow}{if}(pDllGetVersion) \{
251         DLLVERSIONINFO    dvi;
252         ZeroMemory(&dvi, \textcolor{keyword}{sizeof}(dvi));
253         dvi.cbSize = \textcolor{keyword}{sizeof}(dvi);
254         hr = (*pDllGetVersion)(&dvi);
255         \textcolor{keywordflow}{if}(SUCCEEDED(hr)) \{
256             *pdwMajor = dvi.dwMajorVersion;
257             *pdwMinor = dvi.dwMinorVersion;
258                 \} \textcolor{keywordflow}{else} \{
259             hr = E\_FAIL;
260                 \}
261         \} \textcolor{keywordflow}{else} \{
262         \textcolor{comment}{/*}
263 \textcolor{comment}{        If GetProcAddress failed, then the DLL is a version previous to the one}
264 \textcolor{comment}{        shipped with IE 3.x.}
265 \textcolor{comment}{        */}
266         *pdwMajor = 4;
267         *pdwMinor = 0;
268     \}
269     FreeLibrary(hComCtl);
270     \textcolor{keywordflow}{return} hr;
271 \}
\end{DoxyCode}
\hypertarget{win_2win32_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{\index{win/win32/winhack.\+c@{win/win32/winhack.\+c}!Get\+N\+H\+App@{Get\+N\+H\+App}}
\index{Get\+N\+H\+App@{Get\+N\+H\+App}!win/win32/winhack.\+c@{win/win32/winhack.\+c}}
\subsubsection[{Get\+N\+H\+App}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\+N\+H\+Win\+App} Get\+N\+H\+App (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{win_2win32_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}


Definition at line 185 of file winhack.\+c.



References \+\_\+nethack\+\_\+app.



Referenced by mswin\+\_\+display\+\_\+\+R\+I\+P\+\_\+window(), mswin\+\_\+display\+\_\+splash\+\_\+window(), mswin\+\_\+init\+\_\+\+R\+I\+P\+\_\+window(), mswin\+\_\+init\+\_\+text\+\_\+window(), N\+H\+Edit\+Hook\+Wnd\+Proc(), N\+H\+R\+I\+P\+Wnd\+Proc(), N\+H\+Splash\+Wnd\+Proc(), N\+H\+Text\+Wnd\+Proc(), and Text\+Wnd\+Proc().


\begin{DoxyCode}
186 \{
187     \textcolor{keywordflow}{return} &\hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app};
188 \}
\end{DoxyCode}
\hypertarget{win_2win32_2winhack_8c_aaa9c68d4ec5e948a847bee2903390945}{\index{win/win32/winhack.\+c@{win/win32/winhack.\+c}!mswin\+\_\+moveloop@{mswin\+\_\+moveloop}}
\index{mswin\+\_\+moveloop@{mswin\+\_\+moveloop}!win/win32/winhack.\+c@{win/win32/winhack.\+c}}
\subsubsection[{mswin\+\_\+moveloop}]{\setlength{\rightskip}{0pt plus 5cm}static void \+\_\+\+\_\+cdecl mswin\+\_\+moveloop (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{win_2win32_2winhack_8c_aaa9c68d4ec5e948a847bee2903390945}
\hypertarget{win_2win32_2winhack_8c_a1122673f59be78a3997ec7dd1c4688f9}{\index{win/win32/winhack.\+c@{win/win32/winhack.\+c}!Win\+Main@{Win\+Main}}
\index{Win\+Main@{Win\+Main}!win/win32/winhack.\+c@{win/win32/winhack.\+c}}
\subsubsection[{Win\+Main}]{\setlength{\rightskip}{0pt plus 5cm}int A\+P\+I\+E\+N\+T\+R\+Y Win\+Main (
\begin{DoxyParamCaption}
\item[{H\+I\+N\+S\+T\+A\+N\+C\+E}]{h\+Instance, }
\item[{H\+I\+N\+S\+T\+A\+N\+C\+E}]{h\+Prev\+Instance, }
\item[{L\+P\+S\+T\+R}]{lp\+Cmd\+Line, }
\item[{int}]{n\+Cmd\+Show}
\end{DoxyParamCaption}
)}}\label{win_2win32_2winhack_8c_a1122673f59be78a3997ec7dd1c4688f9}


Definition at line 75 of file winhack.\+c.



References \+\_\+get\+\_\+cmd\+\_\+arg(), mswin\+\_\+nhwindow\+\_\+app\+::bmp\+Map\+Tiles, mswin\+\_\+nhwindow\+\_\+app\+::bmp\+Pet\+Mark, mswin\+\_\+nhwindow\+\_\+app\+::bmp\+Rip, mswin\+\_\+nhwindow\+\_\+app\+::bmp\+Splash, mswin\+\_\+nhwindow\+\_\+app\+::bmp\+Tiles, mswin\+\_\+nhwindow\+\_\+app\+::b\+No\+H\+Scroll, mswin\+\_\+nhwindow\+\_\+app\+::b\+No\+V\+Scroll, buf, B\+U\+F\+S\+Z, F\+A\+L\+S\+E, free(), Get\+Com\+Ctl\+Version(), mswin\+\_\+nhwindow\+\_\+app\+::h\+Accel\+Table, mswin\+\_\+nhwindow\+\_\+app\+::h\+App, mswin\+\_\+nhwindow\+\_\+app\+::h\+Main\+Wnd, mswin\+\_\+nhwindow\+\_\+app\+::h\+Popup\+Wnd, I\+D\+B\+\_\+\+P\+E\+T\+M\+A\+R\+K, I\+D\+B\+\_\+\+R\+I\+P, I\+D\+B\+\_\+\+S\+P\+L\+A\+S\+H, I\+D\+B\+\_\+\+T\+I\+L\+E\+S, I\+D\+C\+\_\+\+N\+E\+T\+H\+A\+C\+K\+W, I\+N\+S\+T\+A\+L\+L\+\_\+\+N\+O\+T\+E\+S, mswin\+\_\+nhwindow\+\_\+app\+::map\+Tile\+\_\+\+X, mswin\+\_\+nhwindow\+\_\+app\+::map\+Tile\+\_\+\+Y, mswin\+\_\+nhwindow\+\_\+app\+::map\+Tiles\+Per\+Line, M\+A\+X\+\_\+\+C\+M\+D\+L\+I\+N\+E\+\_\+\+P\+A\+R\+A\+M, M\+I\+N\+\_\+\+C\+O\+M\+C\+T\+L\+M\+A\+J\+O\+R, M\+I\+N\+\_\+\+C\+O\+M\+C\+T\+L\+M\+I\+N\+O\+R, mswin\+\_\+raw\+\_\+print(), mswin\+\_\+raw\+\_\+print\+\_\+bold(), N\+H\+\_\+\+W2\+A, N\+U\+L\+L, panic(), plname, mswin\+\_\+nhwindow\+\_\+app\+::saved\+\_\+text, Sprintf, strdup, T\+B\+U\+F\+S\+Z, T\+I\+L\+E\+\_\+\+X, T\+I\+L\+E\+\_\+\+Y, T\+I\+L\+E\+S\+\_\+\+P\+E\+R\+\_\+\+L\+I\+N\+E, and windowprocs.


\begin{DoxyCode}
79 \{
80     INITCOMMONCONTROLSEX InitCtrls;
81     \textcolor{keywordtype}{int} argc;
82     \textcolor{keywordtype}{char}* argv[\hyperlink{win_2win32_2winhack_8c_a9993e50593c85529d2765c55200a3c1e}{MAX\_CMDLINE\_PARAM}];
83     \textcolor{keywordtype}{size\_t} len;
84     TCHAR *p;
85     TCHAR wbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
86     \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
87     DWORD major, minor;
88 
89 
90     \textcolor{comment}{/* ensure that we don't access violate on a panic() */}
91     \hyperlink{winprocs_8h_a166c17ce426a1c495296575938a60f9c}{windowprocs}.win\_raw\_print = \hyperlink{sys_2wince_2mswproc_8c_af710d0c50e6d609411c4cee463cde502}{mswin\_raw\_print};
92     \hyperlink{winprocs_8h_a166c17ce426a1c495296575938a60f9c}{windowprocs}.win\_raw\_print\_bold = \hyperlink{sys_2wince_2mswproc_8c_ac4a83dc571aef8c90aedd5a94e0afa24}{mswin\_raw\_print\_bold};
93 
94     \textcolor{comment}{/* init applicatio structure */}
95     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_ae3a365ad66195c8e1d915242897c3f24}{hApp} = hInstance;
96     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a98c007521f1719b18eeb1f11c76549d4}{hAccelTable} = LoadAccelerators(hInstance, (LPCTSTR)
      \hyperlink{win_2win32_2resource_8h_a1c09d9049e66e053031bd5f544ae617d}{IDC\_NETHACKW});
97     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_ada318d77e9dd51678af5d9a3ce6ef03a}{hMainWnd} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
98     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a92e7b581dd0fad9d1af8364e5bcfe395}{hPopupWnd} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
99     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a47710a497f0af6c839660652c841575d}{bmpTiles} = LoadBitmap(hInstance, MAKEINTRESOURCE(
      \hyperlink{sys_2wince_2resource_8h_a3bb8441855cb1b87fe9ebab30de22a5a}{IDB\_TILES}));
100     \textcolor{keywordflow}{if}( \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a47710a497f0af6c839660652c841575d}{bmpTiles}==\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} ) \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"cannot load tiles bitmap"});
101     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a786a513972fdf914ae95bcbf5c702ead}{bmpPetMark} = LoadBitmap(hInstance, MAKEINTRESOURCE(
      \hyperlink{sys_2wince_2resource_8h_a23d7e689489e24b5a09aaff2a12aee2d}{IDB\_PETMARK}));
102     \textcolor{keywordflow}{if}( \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a786a513972fdf914ae95bcbf5c702ead}{bmpPetMark}==\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} ) \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"cannot load pet mark bitmap"})
      ;
103     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a999ca1b8a326d75bf29ede7b2cbeb205}{bmpRip} = LoadBitmap(hInstance, MAKEINTRESOURCE(
      \hyperlink{win_2win32_2resource_8h_abeff8268da97da32cc77bd1d20020dc3}{IDB\_RIP}));
104     \textcolor{keywordflow}{if} ( \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a999ca1b8a326d75bf29ede7b2cbeb205}{bmpRip} == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} ) \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"cannot load rip bitmap"});
105     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_ae46760e977e06676139a68adec0d2648}{bmpSplash} = LoadBitmap(hInstance, MAKEINTRESOURCE(
      \hyperlink{win_2win32_2resource_8h_aa97c4be3c442d286f43047fdde31366a}{IDB\_SPLASH}));
106     \textcolor{keywordflow}{if} ( \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_ae46760e977e06676139a68adec0d2648}{bmpSplash} == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} ) \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"cannot load splash bitmap"});
107     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a61984761ecf8b4bbc83b25fdddddc8e7}{bmpMapTiles} = \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.
      \hyperlink{structmswin__nhwindow__app_a47710a497f0af6c839660652c841575d}{bmpTiles};
108     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_adb6d803036dca29b82a10f0fbd007edd}{mapTile\_X} = \hyperlink{sys_2wince_2winMS_8h_a9f3fae6a9058d02850af5deba9be4544}{TILE\_X};
109     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a699b7a92f8c907030eff6ef5a36d29f3}{mapTile\_Y} = \hyperlink{sys_2wince_2winMS_8h_a4a62524a49a9be02996b8e667b45abc9}{TILE\_Y};
110     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a7a89a59512a3bb56005832843339f479}{mapTilesPerLine} = \hyperlink{sys_2wince_2winMS_8h_a1eaa02a47952ddaac086c1c00b92d0d6}{TILES\_PER\_LINE};
111 
112     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a75259e1f797e53006ad99a4a28fe9b36}{bNoHScroll} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
113     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_ad0311b73326a15c00e147d1b9d809979}{bNoVScroll} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
114     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_ace0e848571fb0210599f108fe2bbc009}{saved\_text} = \hyperlink{wceconf_8h_a9254b089d435892385cf14d0ab4a7a2d}{strdup}(\textcolor{stringliteral}{""});
115 
116     \textcolor{comment}{// init controls}
117     \textcolor{keywordflow}{if} (FAILED(\hyperlink{win_2win32_2winhack_8c_ac6d1d669be1ae971a5851191fce99ecd}{GetComCtlVersion}(&major, &minor)))
118     \{
119         \textcolor{keywordtype}{char} buf[\hyperlink{global_8h_aa18046886c403e831e620d0bfb76bdc7}{TBUFSZ}];
120         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(buf, \textcolor{stringliteral}{"Cannot load common control library.\(\backslash\)n%s\(\backslash\)n%s"},
121               \textcolor{stringliteral}{"For further information, refer to the installation notes at"},
122         \hyperlink{win_2win32_2winhack_8c_affb913efb62ae4cbc9f4396900719bc5}{INSTALL\_NOTES});
123         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(buf);
124     \}
125     \textcolor{keywordflow}{if} (major < \hyperlink{win_2win32_2winhack_8c_a37b792c1f597eec7e0bcf57af95acdc0}{MIN\_COMCTLMAJOR}
126         || (major == \hyperlink{win_2win32_2winhack_8c_a37b792c1f597eec7e0bcf57af95acdc0}{MIN\_COMCTLMAJOR} && minor < \hyperlink{win_2win32_2winhack_8c_a3f650c1ab1b1688ef3d0a7be06ace937}{MIN\_COMCTLMINOR}))
127     \{
128         \textcolor{keywordtype}{char} buf[\hyperlink{global_8h_aa18046886c403e831e620d0bfb76bdc7}{TBUFSZ}];
129         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(buf, \textcolor{stringliteral}{"Common control library is outdated.\(\backslash\)n%s %d.%d\(\backslash\)n%s\(\backslash\)n%s"},
130               \textcolor{stringliteral}{"NetHack requires at least version "},
131           \hyperlink{win_2win32_2winhack_8c_a37b792c1f597eec7e0bcf57af95acdc0}{MIN\_COMCTLMAJOR}, \hyperlink{win_2win32_2winhack_8c_a3f650c1ab1b1688ef3d0a7be06ace937}{MIN\_COMCTLMINOR},
132           \textcolor{stringliteral}{"For further information, refer to the installation notes at"},
133         \hyperlink{win_2win32_2winhack_8c_affb913efb62ae4cbc9f4396900719bc5}{INSTALL\_NOTES});
134         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(buf);
135     \}
136     ZeroMemory(&InitCtrls, \textcolor{keyword}{sizeof}(InitCtrls));
137     InitCtrls.dwSize = \textcolor{keyword}{sizeof}(InitCtrls);
138     InitCtrls.dwICC = ICC\_LISTVIEW\_CLASSES;
139     InitCommonControlsEx(&InitCtrls);
140     
141     \textcolor{comment}{/* get command line parameters */}   
142     p = \hyperlink{win_2win32_2winhack_8c_a457d5d88c1b3751a9028e38bcaca36fe}{\_get\_cmd\_arg}(GetCommandLine());
143     p = \hyperlink{win_2win32_2winhack_8c_a457d5d88c1b3751a9028e38bcaca36fe}{\_get\_cmd\_arg}(\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}); \textcolor{comment}{/* skip first paramter - command name */}
144     \textcolor{keywordflow}{for}( argc = 1; p && argc<\hyperlink{win_2win32_2winhack_8c_a9993e50593c85529d2765c55200a3c1e}{MAX\_CMDLINE\_PARAM}; argc++ ) \{
145         len = \_tcslen(p);
146         \textcolor{keywordflow}{if}( len>0 ) \{
147             argv[argc] = \_strdup( \hyperlink{wceconf_8h_a79324084b45d4a7bc4b8813ddfddad96}{NH\_W2A}(p, buf, \hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}) );
148         \} \textcolor{keywordflow}{else} \{
149             argv[argc] = \textcolor{stringliteral}{""};
150         \}
151         p = \hyperlink{win_2win32_2winhack_8c_a457d5d88c1b3751a9028e38bcaca36fe}{\_get\_cmd\_arg}(\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
152     \}
153     GetModuleFileName(\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, wbuf, \hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ});
154     argv[0] = \_strdup(\hyperlink{wceconf_8h_a79324084b45d4a7bc4b8813ddfddad96}{NH\_W2A}(wbuf, buf, \hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}));
155 
156     \textcolor{keywordflow}{if} (argc == 2) \{
157         TCHAR *savefile = \hyperlink{wceconf_8h_a9254b089d435892385cf14d0ab4a7a2d}{strdup}(argv[1]);
158         TCHAR *\hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname};
159         \textcolor{keywordflow}{for} (p = savefile; *p && *p != \textcolor{charliteral}{'-'}; p++)
160             ;
161         \textcolor{keywordflow}{if} (*p) \{
162             \textcolor{comment}{/* we found a '-' */}
163             plname = p + 1;
164             \textcolor{keywordflow}{for} (p = plname; *p && *p != \textcolor{charliteral}{'.'}; p++)
165                 ;
166             \textcolor{keywordflow}{if} (*p) \{
167                 \textcolor{keywordflow}{if} (strcmp(p + 1, \textcolor{stringliteral}{"NetHack-saved-game"}) == 0) \{
168                     *p = \textcolor{charliteral}{'\(\backslash\)0'};
169                     argv[1] = \textcolor{stringliteral}{"-u"};
170                     argv[2] = \_strdup(plname);
171                     argc = 3;
172                 \}
173             \}
174         \}
175         \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}(savefile);
176     \}
177     pcmain(argc,argv);
178 
179     moveloop();
180 
181     \textcolor{keywordflow}{return} 0;
182 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{win_2win32_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\index{win/win32/winhack.\+c@{win/win32/winhack.\+c}!\+\_\+nethack\+\_\+app@{\+\_\+nethack\+\_\+app}}
\index{\+\_\+nethack\+\_\+app@{\+\_\+nethack\+\_\+app}!win/win32/winhack.\+c@{win/win32/winhack.\+c}}
\subsubsection[{\+\_\+nethack\+\_\+app}]{\setlength{\rightskip}{0pt plus 5cm}{\bf N\+H\+Win\+App} \+\_\+nethack\+\_\+app}}\label{win_2win32_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}


Definition at line 62 of file winhack.\+c.

