\hypertarget{end_8c}{\section{nethack/src/end.c File Reference}
\label{end_8c}\index{nethack/src/end.\+c@{nethack/src/end.\+c}}
}
{\ttfamily \#include \char`\"{}hack.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}eshk.\+h\char`\"{}}\\*
{\ttfamily \#include $<$signal.\+h$>$}\\*
{\ttfamily \#include \char`\"{}dlb.\+h\char`\"{}}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structvaluable__data}{valuable\+\_\+data}
\item 
struct \hyperlink{structval__list}{val\+\_\+list}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{end_8c_ae0cbc95d7e612f32d35c1fa270f7445e}{N\+E\+E\+D\+\_\+\+V\+A\+R\+A\+R\+G\+S}~/$\ast$ \hyperlink{thintile_8c_a2b99606d56c8d0fc4c2fb00852128f19}{comment} line for pre-\/compiled headers $\ast$/
\item 
\#define \hyperlink{end_8c_a90f8b34525bb5925a77ca6d21434f8dd}{F\+I\+R\+S\+T\+\_\+\+G\+E\+M}~D\+I\+L\+I\+T\+H\+I\+U\+M\+\_\+\+C\+R\+Y\+S\+T\+A\+L
\item 
\#define \hyperlink{end_8c_a0eddc50c6754baf9d7116e82932e3aee}{F\+I\+R\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T}~A\+M\+U\+L\+E\+T\+\_\+\+O\+F\+\_\+\+E\+S\+P
\item 
\#define \hyperlink{end_8c_a7a5a12b193ae619f671fbc919bc017ed}{L\+A\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T}~A\+M\+U\+L\+E\+T\+\_\+\+O\+F\+\_\+\+Y\+E\+N\+D\+O\+R
\item 
\#define \hyperlink{end_8c_ab463831cccd212b4e87e67ee3e8de2d5}{nethack\+\_\+exit}~\hyperlink{sys_2wince_2winhack_8c_a26248234a12f5d74cede4c5c9968454b}{exit}
\item 
\#define \hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\+\_\+stopprint}~program\+\_\+state.\+stopprint
\item 
\#define \hyperlink{end_8c_ab942d9494cb03e73522a949a4cce0682}{N\+H\+\_\+abort}()~\hyperlink{wceconf_8h_aef4ff7cf390aba5ab4172cca329a2c89}{abort}()
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{hack_8h_ac0f6cfba4138e5e6a773d15a80ea82ff}{S\+T\+A\+T\+I\+C\+\_\+\+P\+T\+R} void \hyperlink{end_8c_aa257847226be6c4e3d883a334dd29bfc}{F\+D\+E\+C\+L} (\hyperlink{end_8c_a643208f7b1c8126977b74ebe2bec6d98}{done\+\_\+intr},(int))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{end_8c_a40322608ce13ceebf4d97d1cfcc07b50}{F\+D\+E\+C\+L} (\hyperlink{end_8c_a2627a6787c0bca3a911878c508a5f04a}{disclose},(int, \hyperlink{wingem1_8c_aa2723cc3af18a5199ab4ce7cca84d82b}{B\+O\+O\+L\+E\+A\+N\+\_\+\+P}))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{end_8c_ad1e5c094d5c34d23420906faf537b44b}{F\+D\+E\+C\+L} (\hyperlink{end_8c_a7a7128ee5a159e4aa0cb277597cbbf3a}{get\+\_\+valuables},(struct \hyperlink{structobj}{obj} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{end_8c_a1ed6d121129c2411ce8483009bc85174}{F\+D\+E\+C\+L} (\hyperlink{end_8c_a2626b1529b8c734fe1494d5290f2c8c0}{sort\+\_\+valuables},(struct \hyperlink{structvaluable__data}{valuable\+\_\+data} $\ast$, int))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{end_8c_afcd69f879c4e4fef71e820e1ab5e1c4d}{F\+D\+E\+C\+L} (\hyperlink{end_8c_aa475252a5c524733c6112c513689707c}{artifact\+\_\+score},(struct \hyperlink{structobj}{obj} $\ast$, \hyperlink{wingem1_8c_aa2723cc3af18a5199ab4ce7cca84d82b}{B\+O\+O\+L\+E\+A\+N\+\_\+\+P}, \hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid}))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{end_8c_ad58f208ea09e5da1530cc8970b649d47}{F\+D\+E\+C\+L} (\hyperlink{end_8c_a52c3880708e4dba1dd140f134f468ced}{savelife},(int))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{end_8c_aa8d6c6089bf8d7aea66aad6c8f6b0b96}{F\+D\+E\+C\+L} (\hyperlink{end_8c_afd2d0b7ad2213b47282aa1873a9eff0b}{list\+\_\+vanquished},(\hyperlink{wingem1_8c_ada878a8b4864a1658ee0f0acd5a89412}{C\+H\+A\+R\+\_\+\+P}, \hyperlink{wingem1_8c_aa2723cc3af18a5199ab4ce7cca84d82b}{B\+O\+O\+L\+E\+A\+N\+\_\+\+P}))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{end_8c_acad0d8e81b49d0637979c374be7b563e}{F\+D\+E\+C\+L} (\hyperlink{end_8c_a227422494d61e1e8f8eccf16c0b29d1a}{list\+\_\+genocided},(\hyperlink{wingem1_8c_ada878a8b4864a1658ee0f0acd5a89412}{C\+H\+A\+R\+\_\+\+P}, \hyperlink{wingem1_8c_aa2723cc3af18a5199ab4ce7cca84d82b}{B\+O\+O\+L\+E\+A\+N\+\_\+\+P}))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{end_8c_aa7fb3e5aea58a626b4d46f07aef4b393}{F\+D\+E\+C\+L} (\hyperlink{end_8c_a18542f5e3b6a088e21d066026fd74b29}{should\+\_\+query\+\_\+disclose\+\_\+option},(int, char $\ast$))
\item 
void \hyperlink{end_8c_a2082a4dffb6195df4e125aa90a4fe0cd}{done1} (int sig\+\_\+unused)
\item 
int \hyperlink{end_8c_aec8aa049129efa2742756fbeacfa6852}{done2} ()
\item 
\hyperlink{hack_8h_ac0f6cfba4138e5e6a773d15a80ea82ff}{S\+T\+A\+T\+I\+C\+\_\+\+P\+T\+R} void \hyperlink{end_8c_a643208f7b1c8126977b74ebe2bec6d98}{done\+\_\+intr} (int sig\+\_\+unused)
\item 
void \hyperlink{end_8c_a2a4518b11efaf16a0b79fa3e7ea4d12d}{done\+\_\+in\+\_\+by} (struct \hyperlink{structmonst}{monst} $\ast$mtmp)
\item 
void \hyperlink{wingem1_8c_a2a3ad5d10bdfe9a5a0f13ec9c6d209a2}{panic} \hyperlink{end_8c_ab81e778f8bb01682d2a2d889c6b73fe3}{V\+A\+\_\+\+D\+E\+C\+L} (\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$, V\+A\+\_\+\+I\+N\+I\+T(str)
\item 
\hyperlink{end_8c_abf7447f6bb57e76e198834c4c9c3d2ae}{raw\+\_\+print} (program\+\_\+state.\+gameover?\char`\"{}Postgame wrapup disrupted.\char`\"{}\+:!program\+\_\+state.\+something\+\_\+worth\+\_\+saving?\char`\"{}Program initialization has failed.\char`\"{}\+:\char`\"{}Suddenly, the \hyperlink{structdungeon}{dungeon} collapses.\char`\"{})
\item 
\hyperlink{end_8c_ae24904afb8c6ae20dfb2a38fca0e2660}{Vsprintf} (\hyperlink{xpm2img_8c_a6f4b9854141692d23b0d072176044ca6}{buf}, str, V\+A\+\_\+\+A\+R\+G\+S)
\item 
\hyperlink{end_8c_aa722f3d191d7ceef6ed865f7e5bef5a9}{raw\+\_\+print} (\hyperlink{xpm2img_8c_a6f4b9854141692d23b0d072176044ca6}{buf})
\item 
\hyperlink{end_8c_af1a422a8c13793b2fb4f10f470f671b3}{paniclog} (\char`\"{}panic\char`\"{}, buf)
\item 
\hyperlink{end_8c_a52ffaaff91c64705846d6e0f506195dc}{V\+A\+\_\+\+E\+N\+D} ()
\item 
\hyperlink{end_8c_a3bc1d99b44570f8c98144d24c1f4e344}{done} (\hyperlink{hack_8h_a42112655d0a453f721ba58c5510dae55}{P\+A\+N\+I\+C\+K\+E\+D})
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{end_8c_a18542f5e3b6a088e21d066026fd74b29}{should\+\_\+query\+\_\+disclose\+\_\+option} (int category, char $\ast$defquery)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{end_8c_a2627a6787c0bca3a911878c508a5f04a}{disclose} (int how, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} taken)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{end_8c_a52c3880708e4dba1dd140f134f468ced}{savelife} (int how)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{end_8c_a7a7128ee5a159e4aa0cb277597cbbf3a}{get\+\_\+valuables} (struct \hyperlink{structobj}{obj} $\ast$list)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{end_8c_a2626b1529b8c734fe1494d5290f2c8c0}{sort\+\_\+valuables} (list, int \hyperlink{structsize}{size})
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{end_8c_aa475252a5c524733c6112c513689707c}{artifact\+\_\+score} (struct \hyperlink{structobj}{obj} $\ast$list, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} counting, \hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} endwin)
\item 
void \hyperlink{end_8c_aefc3e5f7b12c175e783ffc9676520154}{done} (int how)
\item 
void \hyperlink{end_8c_a5781bf7ca572bd7d9200623207423afa}{container\+\_\+contents} (struct \hyperlink{structobj}{obj} $\ast$list, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} identified, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} all\+\_\+containers)
\item 
void \hyperlink{end_8c_a30ebaced48494e6e25f8833532ec17ca}{terminate} (int status)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{end_8c_afd2d0b7ad2213b47282aa1873a9eff0b}{list\+\_\+vanquished} (char defquery, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} ask)
\item 
int \hyperlink{end_8c_a06164e5d987444efbe7ab260e2c13792}{num\+\_\+genocides} ()
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{end_8c_a227422494d61e1e8f8eccf16c0b29d1a}{list\+\_\+genocided} (char defquery, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} ask)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static struct \hyperlink{structvaluable__data}{valuable\+\_\+data} \hyperlink{end_8c_ac012ffb07f14cbc249fb8b7ed980fe12}{gems} \mbox{[}L\+A\+S\+T\+\_\+\+G\+E\+M+1-\/\hyperlink{end_8c_a90f8b34525bb5925a77ca6d21434f8dd}{F\+I\+R\+S\+T\+\_\+\+G\+E\+M}+1\mbox{]}
\item 
static struct \hyperlink{structvaluable__data}{valuable\+\_\+data} \hyperlink{end_8c_a16f54cba952b549755aeff67fcef047d}{amulets} \mbox{[}\hyperlink{end_8c_a7a5a12b193ae619f671fbc919bc017ed}{L\+A\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T}+1-\/\hyperlink{end_8c_a0eddc50c6754baf9d7116e82932e3aee}{F\+I\+R\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T}\mbox{]}
\item 
static struct \hyperlink{structval__list}{val\+\_\+list} \hyperlink{end_8c_acb10921d442ef668d677e5eb065e9bc5}{valuables} \mbox{[}$\,$\mbox{]}
\item 
static \hyperlink{config1_8h_a9987bf629301f5fe76ddd96aa2717ca1}{N\+E\+A\+R\+D\+A\+T\+A} \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$ \hyperlink{end_8c_a17a3cc4328819f4785146308243b084c}{deaths} \mbox{[}$\,$\mbox{]}
\item 
static \hyperlink{config1_8h_a9987bf629301f5fe76ddd96aa2717ca1}{N\+E\+A\+R\+D\+A\+T\+A} \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$ \hyperlink{end_8c_a9b0ae9b5d06e599cad0a7d34f5337332}{ends} \mbox{[}$\,$\mbox{]}
\item 
\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} \hyperlink{end_8c_a1d71c4782ea92771fcdadd8723b4f450}{killed\+\_\+by\+\_\+prefix} \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{\index{end.\+c@{end.\+c}!done\+\_\+stopprint@{done\+\_\+stopprint}}
\index{done\+\_\+stopprint@{done\+\_\+stopprint}!end.\+c@{end.\+c}}
\subsubsection[{done\+\_\+stopprint}]{\setlength{\rightskip}{0pt plus 5cm}\#define done\+\_\+stopprint~program\+\_\+state.\+stopprint}}\label{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}


Definition at line 52 of file end.\+c.



Referenced by disclose(), done(), done2(), done\+\_\+intr(), list\+\_\+genocided(), and list\+\_\+vanquished().

\hypertarget{end_8c_a0eddc50c6754baf9d7116e82932e3aee}{\index{end.\+c@{end.\+c}!F\+I\+R\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T@{F\+I\+R\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T}}
\index{F\+I\+R\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T@{F\+I\+R\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T}!end.\+c@{end.\+c}}
\subsubsection[{F\+I\+R\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\+I\+R\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T~A\+M\+U\+L\+E\+T\+\_\+\+O\+F\+\_\+\+E\+S\+P}}\label{end_8c_a0eddc50c6754baf9d7116e82932e3aee}


Definition at line 16 of file end.\+c.



Referenced by get\+\_\+valuables().

\hypertarget{end_8c_a90f8b34525bb5925a77ca6d21434f8dd}{\index{end.\+c@{end.\+c}!F\+I\+R\+S\+T\+\_\+\+G\+E\+M@{F\+I\+R\+S\+T\+\_\+\+G\+E\+M}}
\index{F\+I\+R\+S\+T\+\_\+\+G\+E\+M@{F\+I\+R\+S\+T\+\_\+\+G\+E\+M}!end.\+c@{end.\+c}}
\subsubsection[{F\+I\+R\+S\+T\+\_\+\+G\+E\+M}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\+I\+R\+S\+T\+\_\+\+G\+E\+M~D\+I\+L\+I\+T\+H\+I\+U\+M\+\_\+\+C\+R\+Y\+S\+T\+A\+L}}\label{end_8c_a90f8b34525bb5925a77ca6d21434f8dd}


Definition at line 15 of file end.\+c.



Referenced by get\+\_\+valuables().

\hypertarget{end_8c_a7a5a12b193ae619f671fbc919bc017ed}{\index{end.\+c@{end.\+c}!L\+A\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T@{L\+A\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T}}
\index{L\+A\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T@{L\+A\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T}!end.\+c@{end.\+c}}
\subsubsection[{L\+A\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\+A\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T~A\+M\+U\+L\+E\+T\+\_\+\+O\+F\+\_\+\+Y\+E\+N\+D\+O\+R}}\label{end_8c_a7a5a12b193ae619f671fbc919bc017ed}


Definition at line 17 of file end.\+c.

\hypertarget{end_8c_ae0cbc95d7e612f32d35c1fa270f7445e}{\index{end.\+c@{end.\+c}!N\+E\+E\+D\+\_\+\+V\+A\+R\+A\+R\+G\+S@{N\+E\+E\+D\+\_\+\+V\+A\+R\+A\+R\+G\+S}}
\index{N\+E\+E\+D\+\_\+\+V\+A\+R\+A\+R\+G\+S@{N\+E\+E\+D\+\_\+\+V\+A\+R\+A\+R\+G\+S}!end.\+c@{end.\+c}}
\subsubsection[{N\+E\+E\+D\+\_\+\+V\+A\+R\+A\+R\+G\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\+E\+E\+D\+\_\+\+V\+A\+R\+A\+R\+G\+S~/$\ast$ {\bf comment} line for pre-\/compiled headers $\ast$/}}\label{end_8c_ae0cbc95d7e612f32d35c1fa270f7445e}


Definition at line 5 of file end.\+c.

\hypertarget{end_8c_ab463831cccd212b4e87e67ee3e8de2d5}{\index{end.\+c@{end.\+c}!nethack\+\_\+exit@{nethack\+\_\+exit}}
\index{nethack\+\_\+exit@{nethack\+\_\+exit}!end.\+c@{end.\+c}}
\subsubsection[{nethack\+\_\+exit}]{\setlength{\rightskip}{0pt plus 5cm}\#define nethack\+\_\+exit~{\bf exit}}}\label{end_8c_ab463831cccd212b4e87e67ee3e8de2d5}


Definition at line 49 of file end.\+c.



Referenced by terminate().

\hypertarget{end_8c_ab942d9494cb03e73522a949a4cce0682}{\index{end.\+c@{end.\+c}!N\+H\+\_\+abort@{N\+H\+\_\+abort}}
\index{N\+H\+\_\+abort@{N\+H\+\_\+abort}!end.\+c@{end.\+c}}
\subsubsection[{N\+H\+\_\+abort}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\+H\+\_\+abort(
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)~{\bf abort}()}}\label{end_8c_ab942d9494cb03e73522a949a4cce0682}


Definition at line 63 of file end.\+c.



Referenced by done2().



\subsection{Function Documentation}
\hypertarget{end_8c_aa475252a5c524733c6112c513689707c}{\index{end.\+c@{end.\+c}!artifact\+\_\+score@{artifact\+\_\+score}}
\index{artifact\+\_\+score@{artifact\+\_\+score}!end.\+c@{end.\+c}}
\subsubsection[{artifact\+\_\+score}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void artifact\+\_\+score (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{list, }
\item[{{\bf boolean}}]{counting, }
\item[{{\bf winid}}]{endwin}
\end{DoxyParamCaption}
)}}\label{end_8c_aa475252a5c524733c6112c513689707c}


Definition at line 498 of file end.\+c.



References B\+U\+F\+S\+Z, obj\+::cobj, Has\+\_\+contents, makeknown, obj\+::nobj, obj\+::oartifact, O\+B\+J\+\_\+\+N\+A\+M\+E, objects, otmp, obj\+::otyp, putstr, Sprintf, u, and you\+::urexp.



Referenced by done().


\begin{DoxyCode}
502 \{
503     \textcolor{keywordtype}{char} pbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
504     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp};
505     \textcolor{keywordtype}{long} value, points;
506     \textcolor{keywordtype}{short} dummy;    \textcolor{comment}{/* object type returned by artifact\_name() */}
507 
508     \textcolor{keywordflow}{for} (otmp = list; \hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp}; otmp = otmp->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj}) \{
509     \textcolor{keywordflow}{if} (otmp->\hyperlink{structobj_af03ce8a6a0ca51e8d8954fb1a1a31fbe}{oartifact} ||
510             otmp->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == BELL\_OF\_OPENING ||
511             otmp->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == SPE\_BOOK\_OF\_THE\_DEAD ||
512             otmp->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == CANDELABRUM\_OF\_INVOCATION) \{
513         value = arti\_cost(otmp);    \textcolor{comment}{/* zorkmid value */}
514         points = value * 5 / 2; \textcolor{comment}{/* score value */}
515         \textcolor{keywordflow}{if} (counting) \{
516         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac096bd7eef66e6d79962d6e9848071df}{urexp} += points;
517         \} \textcolor{keywordflow}{else} \{
518         \hyperlink{hack_8h_afbd3607e7cef2f888f4190d40d058011}{makeknown}(otmp->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp});
519         otmp->known = otmp->dknown = otmp->bknown = otmp->rknown = 1;
520         \textcolor{comment}{/* assumes artifacts don't have quan > 1 */}
521         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(pbuf, \textcolor{stringliteral}{"%s%s (worth %ld %s and %ld points)"},
522             the\_unique\_obj(otmp) ? \textcolor{stringliteral}{"The "} : \textcolor{stringliteral}{""},
523             otmp->\hyperlink{structobj_af03ce8a6a0ca51e8d8954fb1a1a31fbe}{oartifact} ? artifact\_name(xname(otmp), &dummy) :
524                 \hyperlink{objclass_8h_aaa71280f2bfe02894ab8c39af548d6ae}{OBJ\_NAME}(\hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[otmp->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp}]),
525             value, currency(value), points);
526         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(endwin, 0, pbuf);
527         \}
528     \}
529     \textcolor{keywordflow}{if} (\hyperlink{obj_8h_ae2e47c7280efe98de2333e8078f8ce71}{Has\_contents}(otmp))
530         \hyperlink{end_8c_aa475252a5c524733c6112c513689707c}{artifact\_score}(otmp->\hyperlink{structobj_aa7bed832c417657c964b6f5893737586}{cobj}, counting, endwin);
531     \}
532 \}
\end{DoxyCode}
\hypertarget{end_8c_a5781bf7ca572bd7d9200623207423afa}{\index{end.\+c@{end.\+c}!container\+\_\+contents@{container\+\_\+contents}}
\index{container\+\_\+contents@{container\+\_\+contents}!end.\+c@{end.\+c}}
\subsubsection[{container\+\_\+contents}]{\setlength{\rightskip}{0pt plus 5cm}void container\+\_\+contents (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{list, }
\item[{{\bf boolean}}]{identified, }
\item[{{\bf boolean}}]{all\+\_\+containers}
\end{DoxyParamCaption}
)}}\label{end_8c_a5781bf7ca572bd7d9200623207423afa}


Definition at line 919 of file end.\+c.



References buf, B\+U\+F\+S\+Z, obj\+::cobj, create\+\_\+nhwindow, destroy\+\_\+nhwindow, display\+\_\+nhwindow, F\+A\+L\+S\+E, Is\+\_\+container, makeknown, N\+H\+W\+\_\+\+M\+E\+N\+U, obj\+::nobj, obj\+::otyp, putstr, Sprintf, T\+R\+U\+E, and W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E.



Referenced by disclose(), and use\+\_\+container().


\begin{DoxyCode}
922 \{
923     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *box, *\hyperlink{structobj}{obj};
924     \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
925 
926     \textcolor{keywordflow}{for} (box = list; box; box = box->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj}) \{
927         \textcolor{keywordflow}{if} (\hyperlink{obj_8h_a588d9420d81612a88940b1522e279527}{Is\_container}(box) || box->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == STATUE) \{
928         \textcolor{keywordflow}{if} (box->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == BAG\_OF\_TRICKS) \{
929             \textcolor{keywordflow}{continue};   \textcolor{comment}{/* wrong type of container */}
930         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (box->\hyperlink{structobj_aa7bed832c417657c964b6f5893737586}{cobj}) \{
931             \hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} tmpwin = \hyperlink{winprocs_8h_aa13fb35379049d1836397492d10b6b0c}{create\_nhwindow}(\hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU});
932             \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(buf, \textcolor{stringliteral}{"Contents of %s:"}, the(xname(box)));
933             \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(tmpwin, 0, buf);
934             \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(tmpwin, 0, \textcolor{stringliteral}{""});
935             \textcolor{keywordflow}{for} (obj = box->\hyperlink{structobj_aa7bed832c417657c964b6f5893737586}{cobj}; obj; obj = obj->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj}) \{
936             \textcolor{keywordflow}{if} (identified) \{
937                 \hyperlink{hack_8h_afbd3607e7cef2f888f4190d40d058011}{makeknown}(obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp});
938                 obj->known = obj->bknown =
939                 obj->dknown = obj->rknown = 1;
940             \}
941             \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(tmpwin, 0, doname(obj));
942             \}
943             \hyperlink{winprocs_8h_ac8e74d03fbb65b9f5651e63d79bebc60}{display\_nhwindow}(tmpwin, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
944             \hyperlink{winprocs_8h_a77ac4f50de0eedeaead791812762c6a0}{destroy\_nhwindow}(tmpwin);
945             \textcolor{keywordflow}{if} (all\_containers)
946             \hyperlink{end_8c_a5781bf7ca572bd7d9200623207423afa}{container\_contents}(box->\hyperlink{structobj_aa7bed832c417657c964b6f5893737586}{cobj}, identified, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
947         \} \textcolor{keywordflow}{else} \{
948             pline(\textcolor{stringliteral}{"%s empty."}, Tobjnam(box, \textcolor{stringliteral}{"are"}));
949             \hyperlink{winprocs_8h_ac8e74d03fbb65b9f5651e63d79bebc60}{display\_nhwindow}(\hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
950         \}
951         \}
952         \textcolor{keywordflow}{if} (!all\_containers)
953         \textcolor{keywordflow}{break};
954     \}
955 \}
\end{DoxyCode}
\hypertarget{end_8c_a2627a6787c0bca3a911878c508a5f04a}{\index{end.\+c@{end.\+c}!disclose@{disclose}}
\index{disclose@{disclose}!end.\+c@{end.\+c}}
\subsubsection[{disclose}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void disclose (
\begin{DoxyParamCaption}
\item[{int}]{how, }
\item[{{\bf boolean}}]{taken}
\end{DoxyParamCaption}
)}}\label{end_8c_a2627a6787c0bca3a911878c508a5f04a}


Definition at line 351 of file end.\+c.



References container\+\_\+contents(), done\+\_\+stopprint, invent, list\+\_\+genocided(), list\+\_\+vanquished(), makeknown, obj\+::nobj, obj\+::otyp, P\+A\+N\+I\+C\+K\+E\+D, Q\+B\+U\+F\+S\+Z, Q\+U\+I\+T, should\+\_\+query\+\_\+disclose\+\_\+option(), Sprintf, Strcpy, T\+R\+U\+E, and ynqchars.



Referenced by done().


\begin{DoxyCode}
354 \{
355     \textcolor{keywordtype}{char}    c = 0, defquery;
356     \textcolor{keywordtype}{char}    qbuf[\hyperlink{global_8h_a1bb6bf3db7bf52ca1e9fa8fbcd6e9630}{QBUFSZ}];
357     \textcolor{keywordtype}{boolean} ask;
358 
359     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent}) \{
360         \textcolor{keywordflow}{if}(taken)
361         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(qbuf,\textcolor{stringliteral}{"Do you want to see what you had when you %s?"},
362             (how == \hyperlink{hack_8h_ad24e2b54375e12474e65ebf7175988fb}{QUIT}) ? \textcolor{stringliteral}{"quit"} : \textcolor{stringliteral}{"died"});
363         \textcolor{keywordflow}{else}
364         \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(qbuf,\textcolor{stringliteral}{"Do you want your possessions identified?"});
365 
366         ask = \hyperlink{end_8c_a18542f5e3b6a088e21d066026fd74b29}{should\_query\_disclose\_option}(\textcolor{charliteral}{'i'}, &defquery);
367         \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}) \{
368         c = ask ? yn\_function(qbuf, \hyperlink{decl_8h_a435ebb3887b48075c97ff301b972ba1b}{ynqchars}, defquery) : defquery;
369         \textcolor{keywordflow}{if} (c == \textcolor{charliteral}{'y'}) \{
370             \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{structobj}{obj};
371 
372             \textcolor{keywordflow}{for} (obj = \hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent}; obj; obj = obj->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj}) \{
373                 \hyperlink{hack_8h_afbd3607e7cef2f888f4190d40d058011}{makeknown}(obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp});
374                 obj->known = obj->bknown = obj->dknown = obj->rknown = 1;
375             \}
376             (void) display\_inventory((\textcolor{keywordtype}{char} *)0, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
377             \hyperlink{end_8c_a5781bf7ca572bd7d9200623207423afa}{container\_contents}(\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
378         \}
379         \textcolor{keywordflow}{if} (c == \textcolor{charliteral}{'q'})  \hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}++;
380         \}
381     \}
382 
383     ask = \hyperlink{end_8c_a18542f5e3b6a088e21d066026fd74b29}{should\_query\_disclose\_option}(\textcolor{charliteral}{'a'}, &defquery);
384     \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}) \{
385         c = ask ? yn\_function(\textcolor{stringliteral}{"Do you want to see your attributes?"},
386                   \hyperlink{decl_8h_a435ebb3887b48075c97ff301b972ba1b}{ynqchars}, defquery) : defquery;
387         \textcolor{keywordflow}{if} (c == \textcolor{charliteral}{'y'})
388         enlightenment(how >= \hyperlink{hack_8h_a42112655d0a453f721ba58c5510dae55}{PANICKED} ? 1 : 2); \textcolor{comment}{/* final */}
389         \textcolor{keywordflow}{if} (c == \textcolor{charliteral}{'q'}) \hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}++;
390     \}
391 
392     ask = \hyperlink{end_8c_a18542f5e3b6a088e21d066026fd74b29}{should\_query\_disclose\_option}(\textcolor{charliteral}{'v'}, &defquery);
393     \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint})
394         \hyperlink{end_8c_afd2d0b7ad2213b47282aa1873a9eff0b}{list\_vanquished}(defquery, ask);
395 
396     ask = \hyperlink{end_8c_a18542f5e3b6a088e21d066026fd74b29}{should\_query\_disclose\_option}(\textcolor{charliteral}{'g'}, &defquery);
397     \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint})
398         \hyperlink{end_8c_a227422494d61e1e8f8eccf16c0b29d1a}{list\_genocided}(defquery, ask);
399 
400     ask = \hyperlink{end_8c_a18542f5e3b6a088e21d066026fd74b29}{should\_query\_disclose\_option}(\textcolor{charliteral}{'c'}, &defquery);
401     \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}) \{
402         c = ask ? yn\_function(\textcolor{stringliteral}{"Do you want to see your conduct?"},
403                   \hyperlink{decl_8h_a435ebb3887b48075c97ff301b972ba1b}{ynqchars}, defquery) : defquery;
404         \textcolor{keywordflow}{if} (c == \textcolor{charliteral}{'y'})
405         show\_conduct(how >= \hyperlink{hack_8h_a42112655d0a453f721ba58c5510dae55}{PANICKED} ? 1 : 2);
406         \textcolor{keywordflow}{if} (c == \textcolor{charliteral}{'q'}) \hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}++;
407     \}
408 \}
\end{DoxyCode}
\hypertarget{end_8c_a3bc1d99b44570f8c98144d24c1f4e344}{\index{end.\+c@{end.\+c}!done@{done}}
\index{done@{done}!end.\+c@{end.\+c}}
\subsubsection[{done}]{\setlength{\rightskip}{0pt plus 5cm}done (
\begin{DoxyParamCaption}
\item[{{\bf P\+A\+N\+I\+C\+K\+E\+D}}]{}
\end{DoxyParamCaption}
)}}\label{end_8c_a3bc1d99b44570f8c98144d24c1f4e344}


Referenced by done2(), and done\+\_\+in\+\_\+by().

\hypertarget{end_8c_aefc3e5f7b12c175e783ffc9676520154}{\index{end.\+c@{end.\+c}!done@{done}}
\index{done@{done}!end.\+c@{end.\+c}}
\subsubsection[{done}]{\setlength{\rightskip}{0pt plus 5cm}void done (
\begin{DoxyParamCaption}
\item[{int}]{how}
\end{DoxyParamCaption}
)}}\label{end_8c_aefc3e5f7b12c175e783ffc9676520154}


Definition at line 536 of file end.\+c.



References A\+\_\+\+C\+O\+N, artifact\+\_\+score(), A\+S\+C\+E\+N\+D\+E\+D, Blind, B\+U\+F\+S\+Z, B\+U\+R\+N\+I\+N\+G, can\+\_\+make\+\_\+bones(), C\+H\+O\+K\+I\+N\+G, clearlocks(), valuable\+\_\+data\+::count, count, create\+\_\+nhwindow, destroy\+\_\+nhwindow, D\+I\+E\+D, disclose(), discover, display\+\_\+nhwindow, d\+\_\+level\+::dlevel, dungeon\+::dname, d\+\_\+level\+::dnum, done\+\_\+intr(), done\+\_\+stopprint, dungeons, flag\+::end\+\_\+disclose, eos(), E\+S\+C\+A\+P\+E\+D, exit\+\_\+nhwindows, E\+X\+I\+T\+\_\+\+S\+U\+C\+C\+E\+S\+S, Role\+Name\+::f, F\+A\+L\+S\+E, flag\+::female, Race\+::femalenum, flags, G\+\_\+\+N\+O\+C\+O\+R\+P\+S\+E, sinfo\+::gameover, G\+E\+M\+\_\+\+C\+L\+A\+S\+S, G\+E\+N\+O\+C\+I\+D\+E\+D, get\+\_\+valuables(), Goodbye(), iflags, In\+\_\+endgame, I\+N\+\_\+\+S\+I\+G\+H\+T, inven\+\_\+inuse(), invent, Is\+\_\+astralevel, Is\+\_\+knox, K\+I\+L\+L\+E\+D\+\_\+\+B\+Y, K\+I\+L\+L\+E\+D\+\_\+\+B\+Y\+\_\+\+A\+N, killer, killer\+\_\+format, Lifesaved, val\+\_\+list\+::list, L\+O\+W\+\_\+\+P\+M, Role\+Name\+::m, makeknown, Race\+::malenum, monst\+::mhp, mons, moves, monst\+::mtame, mvitals\+::mvflags, mydogs, Role\+::name, N\+H\+W\+\_\+\+T\+E\+X\+T, monst\+::nmon, N\+O\+\_\+\+K\+I\+L\+L\+E\+R\+\_\+\+P\+R\+E\+F\+I\+X, N\+O\+N\+\_\+\+P\+M, objects, objclass\+::oc\+\_\+cost, obj\+::onamelth, otmp, obj\+::otyp, outrip, P\+A\+N\+I\+C\+K\+E\+D, paniclog(), plname, plur, program\+\_\+state, putstr, obj\+::quan, Q\+U\+I\+T, raw\+\_\+print(), savebones(), savelife(), S\+I\+G\+\_\+\+R\+E\+T\+\_\+\+T\+Y\+P\+E, val\+\_\+list\+::size, sinfo\+::something\+\_\+worth\+\_\+saving, sort\+\_\+valuables(), Sprintf, S\+T\+A\+R\+V\+I\+N\+G, S\+T\+O\+N\+I\+N\+G, Strcat, Strcpy, terminate(), flag\+::tombstone, topten(), flag\+::toptenwin, T\+R\+I\+C\+K\+E\+D, T\+R\+U\+E, T\+U\+R\+N\+E\+D\+\_\+\+S\+L\+I\+M\+E, valuable\+\_\+data\+::typ, u, uamul, you\+::ugold, you\+::ugold0, you\+::ugrave\+\_\+arise, you\+::uhave, you\+::uhp, you\+::uhpmax, you\+::ulevel, you\+::umonnum, you\+::umortality, Upolyd, urace, you\+::urexp, urole, you\+::ux, you\+::uy, you\+::uz, valuables, instance\+\_\+flags\+::vision\+\_\+inited, viz\+\_\+array, wait\+\_\+synch, where, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+M\+A\+P, W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E, W\+I\+N\+\_\+\+S\+T\+A\+T\+U\+S, instance\+\_\+flags\+::window\+\_\+inited, wizard, W\+I\+Z\+A\+R\+D, and yn.


\begin{DoxyCode}
538 \{
539     \textcolor{keywordtype}{boolean} taken;
540     \textcolor{keywordtype}{char} kilbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}], pbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
541     \hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} endwin = \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR};
542     \textcolor{keywordtype}{boolean} bones\_ok, have\_windows = \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_a2fc6c78c4c5f6e1d0027ac575135426f}{window\_inited};
543     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *corpse = (\textcolor{keyword}{struct }\hyperlink{structobj}{obj} *)0;
544     \textcolor{keywordtype}{long} umoney;
545 
546     \textcolor{keywordflow}{if} (how == \hyperlink{hack_8h_a2d6235975513e9630a8895cd64a67905}{TRICKED}) \{
547         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_af7d2dea3996fe6d20ea8ec329726e8f9}{killer}) \{
548         \hyperlink{end_8c_af1a422a8c13793b2fb4f10f470f671b3}{paniclog}(\textcolor{stringliteral}{"trickery"}, \hyperlink{decl_8h_af7d2dea3996fe6d20ea8ec329726e8f9}{killer});
549         \hyperlink{decl_8h_af7d2dea3996fe6d20ea8ec329726e8f9}{killer} = 0;
550         \}
551 \textcolor{preprocessor}{#ifdef WIZARD}
552         \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a5f48dc2f029e22c05489fb20a491db4b}{wizard}) \{
553         You(\textcolor{stringliteral}{"are a very tricky wizard, it seems."});
554         \textcolor{keywordflow}{return};
555         \}
556 \textcolor{preprocessor}{#endif}
557     \}
558 
559     \textcolor{comment}{/* kilbuf: used to copy killer in case it comes from something like}
560 \textcolor{comment}{     *  xname(), which would otherwise get overwritten when we call}
561 \textcolor{comment}{     *  xname() when listing possessions}
562 \textcolor{comment}{     * pbuf: holds Sprintf'd output for raw\_print and putstr}
563 \textcolor{comment}{     */}
564     \textcolor{keywordflow}{if} (how == \hyperlink{hack_8h_a2e7ab555dd9c2d74ce5c0b04e13fffcf}{ASCENDED} || (!\hyperlink{decl_8h_af7d2dea3996fe6d20ea8ec329726e8f9}{killer} && how == \hyperlink{hack_8h_a1f501eb9d26f8c52fd5d91a0f86dc924}{GENOCIDED}))
565         \hyperlink{decl_8h_a0a94810d03a0bf68b371c6b1a1a4a905}{killer\_format} = \hyperlink{decl_8h_aa2ea21bcf7bdd470bd96936d5b80e0ba}{NO\_KILLER\_PREFIX};
566     \textcolor{comment}{/* Avoid killed by "a" burning or "a" starvation */}
567     \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_af7d2dea3996fe6d20ea8ec329726e8f9}{killer} && (how == \hyperlink{hack_8h_adfe010d7d0f3fcf9afb009932d31157c}{STARVING} || how == \hyperlink{hack_8h_ae8902ecbf1e862b213423dd36c568e2f}{BURNING}))
568         \hyperlink{decl_8h_a0a94810d03a0bf68b371c6b1a1a4a905}{killer\_format} = \hyperlink{decl_8h_a0b77d6f094070ee1d9900156357f6f62}{KILLED\_BY};
569     \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(kilbuf, (!\hyperlink{decl_8h_af7d2dea3996fe6d20ea8ec329726e8f9}{killer} || how >= \hyperlink{hack_8h_a42112655d0a453f721ba58c5510dae55}{PANICKED} ? \hyperlink{end_8c_a17a3cc4328819f4785146308243b084c}{deaths}[how] : 
      \hyperlink{decl_8h_af7d2dea3996fe6d20ea8ec329726e8f9}{killer}));
570     \hyperlink{decl_8h_af7d2dea3996fe6d20ea8ec329726e8f9}{killer} = kilbuf;
571 
572     \textcolor{keywordflow}{if} (how < \hyperlink{hack_8h_a42112655d0a453f721ba58c5510dae55}{PANICKED}) \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a2d62ea3354111911f4afc839b0d8621b}{umortality}++;
573     \textcolor{keywordflow}{if} (\hyperlink{youprop_8h_a38d1cff4714f19785e6b82de194081ea}{Lifesaved} && (how <= \hyperlink{hack_8h_a1f501eb9d26f8c52fd5d91a0f86dc924}{GENOCIDED})) \{
574         pline(\textcolor{stringliteral}{"But wait..."});
575         \hyperlink{hack_8h_afbd3607e7cef2f888f4190d40d058011}{makeknown}(AMULET\_OF\_LIFE\_SAVING);
576         Your(\textcolor{stringliteral}{"medallion %s!"},
577               !\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind} ? \textcolor{stringliteral}{"begins to glow"} : \textcolor{stringliteral}{"feels warm"});
578         \textcolor{keywordflow}{if} (how == \hyperlink{hack_8h_a5500aa08941fd3a5fa31f7a5edfd588b}{CHOKING}) You(\textcolor{stringliteral}{"vomit ..."});
579         You\_feel(\textcolor{stringliteral}{"much better!"});
580         pline\_The(\textcolor{stringliteral}{"medallion crumbles to dust!"});
581         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a602a9d34078660dd260aed96b2abd4ca}{uamul}) useup(\hyperlink{decl_8h_a602a9d34078660dd260aed96b2abd4ca}{uamul});
582 
583         (void) adjattrib(\hyperlink{attrib_8h_a82a29f9d3d2390f61fc68b2a352b5da3}{A\_CON}, -1, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
584         \textcolor{keywordflow}{if}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ade36670a142a7d38051c74740d02002b}{uhpmax} <= 0) \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ade36670a142a7d38051c74740d02002b}{uhpmax} = 10;  \textcolor{comment}{/* arbitrary */}
585         \hyperlink{end_8c_a52c3880708e4dba1dd140f134f468ced}{savelife}(how);
586         \textcolor{keywordflow}{if} (how == \hyperlink{hack_8h_a1f501eb9d26f8c52fd5d91a0f86dc924}{GENOCIDED})
587             pline(\textcolor{stringliteral}{"Unfortunately you are still genocided..."});
588         \textcolor{keywordflow}{else} \{
589             \hyperlink{decl_8h_af7d2dea3996fe6d20ea8ec329726e8f9}{killer} = 0;
590             \hyperlink{decl_8h_a0a94810d03a0bf68b371c6b1a1a4a905}{killer\_format} = 0;
591             \textcolor{keywordflow}{return};
592         \}
593     \}
594     \textcolor{keywordflow}{if} ((
595 #ifdef \hyperlink{config_8h_a7d25468f2993889250dd6664a4e6b011}{WIZARD}
596             \hyperlink{flag_8h_a5f48dc2f029e22c05489fb20a491db4b}{wizard} ||
597 #endif
598             \hyperlink{flag_8h_adb6a5941e60dcb9dff8f2230d31180f9}{discover}) && (how <= \hyperlink{hack_8h_a1f501eb9d26f8c52fd5d91a0f86dc924}{GENOCIDED})) \{
599         \textcolor{keywordflow}{if}(\hyperlink{hack_8h_a22ffd7fa35549db318337a497c38a1ae}{yn}(\textcolor{stringliteral}{"Die?"}) == \textcolor{charliteral}{'y'}) \textcolor{keywordflow}{goto} die;
600         pline(\textcolor{stringliteral}{"OK, so you don't %s."},
601             (how == \hyperlink{hack_8h_a5500aa08941fd3a5fa31f7a5edfd588b}{CHOKING}) ? \textcolor{stringliteral}{"choke"} : \textcolor{stringliteral}{"die"});
602         \textcolor{keywordflow}{if}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ade36670a142a7d38051c74740d02002b}{uhpmax} <= 0) \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ade36670a142a7d38051c74740d02002b}{uhpmax} = \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a6c7263bb25b91825bf7ecaab470d771a}{ulevel} * 8; \textcolor{comment}{/* arbitrary */}
603         \hyperlink{end_8c_a52c3880708e4dba1dd140f134f468ced}{savelife}(how);
604         \hyperlink{decl_8h_af7d2dea3996fe6d20ea8ec329726e8f9}{killer} = 0;
605         \hyperlink{decl_8h_a0a94810d03a0bf68b371c6b1a1a4a905}{killer\_format} = 0;
606         \textcolor{keywordflow}{return};
607     \}
608 
609     \textcolor{comment}{/*}
610 \textcolor{comment}{     *  The game is now over...}
611 \textcolor{comment}{     */}
612 
613 die:
614     \hyperlink{decl_8h_a91c51d44f2b6e70f8a5d42a5b5218dcd}{program\_state}.\hyperlink{structsinfo_ac1f9d8fcec6871fb805fe566ac8a8823}{gameover} = 1;
615     \textcolor{comment}{/* in case of a subsequent panic(), there's no point trying to save */}
616     \hyperlink{decl_8h_a91c51d44f2b6e70f8a5d42a5b5218dcd}{program\_state}.\hyperlink{structsinfo_ae213176cfedea7945c371048e57e2931}{something\_worth\_saving} = 0;
617     \textcolor{comment}{/* render vision subsystem inoperative */}
618     \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_a61d68e3b4f194bab370620301c0cb7d9}{vision\_inited} = 0;
619     \textcolor{comment}{/* might have been killed while using a disposable item, so make sure}
620 \textcolor{comment}{       it's gone prior to inventory disclosure and creation of bones data */}
621     \hyperlink{restore_8c_ade47737c4a7e12c92904e51ececb6401}{inven\_inuse}(\hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
622 
623     \textcolor{comment}{/* Sometimes you die on the first move.  Life's not fair.}
624 \textcolor{comment}{     * On those rare occasions you get hosed immediately, go out}
625 \textcolor{comment}{     * smiling... :-)  -3.}
626 \textcolor{comment}{     */}
627     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a2ccad6e8fb93740ed50c6d9a8f72ce2f}{moves} <= 1 && how < \hyperlink{hack_8h_a42112655d0a453f721ba58c5510dae55}{PANICKED})  \textcolor{comment}{/* You die... --More-- */}
628         pline(\textcolor{stringliteral}{"Do not pass go.  Do not collect 200 %s."}, currency(200L));
629 
630     \textcolor{keywordflow}{if} (have\_windows) \hyperlink{winprocs_8h_ab3dda14337c8ebd4fe496eab265a8483}{wait\_synch}();   \textcolor{comment}{/* flush screen output */}
631 \textcolor{preprocessor}{#ifndef NO\_SIGNAL}
632     (void) signal(SIGINT, (\hyperlink{beconf_8h_a1a6cd64290d8bd530aa53c9094ff277d}{SIG\_RET\_TYPE}) \hyperlink{end_8c_a643208f7b1c8126977b74ebe2bec6d98}{done\_intr});
633 \textcolor{preprocessor}{# if defined(UNIX) || defined(VMS) || defined (\_\_EMX\_\_)}
634     (void) signal(SIGQUIT, (\hyperlink{beconf_8h_a1a6cd64290d8bd530aa53c9094ff277d}{SIG\_RET\_TYPE}) \hyperlink{end_8c_a643208f7b1c8126977b74ebe2bec6d98}{done\_intr});
635     (void) signal(SIGHUP, (\hyperlink{beconf_8h_a1a6cd64290d8bd530aa53c9094ff277d}{SIG\_RET\_TYPE}) done\_hangup);
636 \textcolor{preprocessor}{# endif}
637 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* NO\_SIGNAL */}\textcolor{preprocessor}{}
638 
639     bones\_ok = (how < \hyperlink{hack_8h_a1f501eb9d26f8c52fd5d91a0f86dc924}{GENOCIDED}) && \hyperlink{bones_8c_a1fd15580e0b84acfbb6e6de030a78290}{can\_make\_bones}();
640 
641     \textcolor{keywordflow}{if} (how == \hyperlink{hack_8h_a227ac76d02839af08220c6632e9062c8}{TURNED\_SLIME})
642         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af66a5ecd2d2a4f3443af9cc10fb928f3}{ugrave\_arise} = PM\_GREEN\_SLIME;
643 
644     \textcolor{keywordflow}{if} (bones\_ok && \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af66a5ecd2d2a4f3443af9cc10fb928f3}{ugrave\_arise} < \hyperlink{permonst_8h_aedc8e4764f8cf4d681f6f6226eeaa6af}{LOW\_PM}) \{
645         \textcolor{comment}{/* corpse gets burnt up too */}
646         \textcolor{keywordflow}{if} (how == \hyperlink{hack_8h_ae8902ecbf1e862b213423dd36c568e2f}{BURNING})
647         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af66a5ecd2d2a4f3443af9cc10fb928f3}{ugrave\_arise} = (\hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM} - 2);   \textcolor{comment}{/* leave no corpse */}
648         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (how == \hyperlink{hack_8h_aac5555456695094b0171cb7f67e0b5f7}{STONING})
649         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af66a5ecd2d2a4f3443af9cc10fb928f3}{ugrave\_arise} = (\hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM} - 1);   \textcolor{comment}{/* statue instead of corpse */}
650         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af66a5ecd2d2a4f3443af9cc10fb928f3}{ugrave\_arise} == \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM} &&
651              !(\hyperlink{structmvitals}{mvitals}[\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ae0b7ade89d09cd3b6d5e05eb8c859b35}{umonnum}].\hyperlink{structmvitals_a51369b55e24dc02d3f5768b8f5b01381}{mvflags} & \hyperlink{monflag_8h_ab29fe4d215c411d059acee4d030f0f1f}{G\_NOCORPSE})) \{
652         \textcolor{keywordtype}{int} mnum = \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ae0b7ade89d09cd3b6d5e05eb8c859b35}{umonnum};
653 
654         \textcolor{keywordflow}{if} (!\hyperlink{you_8h_ab869582031082f2c352b374dc0e0c3b3}{Upolyd}) \{
655             \textcolor{comment}{/* Base corpse on race when not poly'd since original}
656 \textcolor{comment}{             * u.umonnum is based on role, and all role monsters}
657 \textcolor{comment}{             * are human.}
658 \textcolor{comment}{             */}
659             mnum = (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_ae3f866c572c50c676ecadf8acccf0c50}{female} && \hyperlink{you_8h_adaecc633890bd84d5cfceaf4a513bbaa}{urace}.\hyperlink{structRace_aa3c74c68c2bc4f8d1e63d76d5c3b217d}{femalenum} != 
      \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM}) ?
660             \hyperlink{you_8h_adaecc633890bd84d5cfceaf4a513bbaa}{urace}.\hyperlink{structRace_aa3c74c68c2bc4f8d1e63d76d5c3b217d}{femalenum} : \hyperlink{you_8h_adaecc633890bd84d5cfceaf4a513bbaa}{urace}.\hyperlink{structRace_a6dc454d6faae86cdc46c9a4f53f3f132}{malenum};
661         \}
662         corpse = mk\_named\_object(CORPSE, &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[mnum],
663                        \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}, \hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname});
664         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(pbuf, \textcolor{stringliteral}{"%s, %s%s"}, \hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname},
665             \hyperlink{decl_8h_a0a94810d03a0bf68b371c6b1a1a4a905}{killer\_format} == \hyperlink{decl_8h_aa2ea21bcf7bdd470bd96936d5b80e0ba}{NO\_KILLER\_PREFIX} ? \textcolor{stringliteral}{""} :
666             \hyperlink{end_8c_a1d71c4782ea92771fcdadd8723b4f450}{killed\_by\_prefix}[how],
667             \hyperlink{decl_8h_a0a94810d03a0bf68b371c6b1a1a4a905}{killer\_format} == \hyperlink{decl_8h_af4e54910b730baa32b2dfbe4dd2942c1}{KILLED\_BY\_AN} ? an(\hyperlink{decl_8h_af7d2dea3996fe6d20ea8ec329726e8f9}{killer}) : 
      \hyperlink{decl_8h_af7d2dea3996fe6d20ea8ec329726e8f9}{killer});
668         make\_grave(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}, pbuf);
669         \}
670     \}
671 
672     \textcolor{keywordflow}{if} (how == \hyperlink{hack_8h_ad24e2b54375e12474e65ebf7175988fb}{QUIT}) \{
673         \hyperlink{decl_8h_a0a94810d03a0bf68b371c6b1a1a4a905}{killer\_format} = \hyperlink{decl_8h_aa2ea21bcf7bdd470bd96936d5b80e0ba}{NO\_KILLER\_PREFIX};
674         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a94468a400f14da123d5160f8eefd7641}{uhp} < 1) \{
675             how = \hyperlink{hack_8h_a945602f8a7d9cde22e2502ffb5c51f58}{DIED};
676             \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a2d62ea3354111911f4afc839b0d8621b}{umortality}++;  \textcolor{comment}{/* skipped above when how==QUIT */}
677             \textcolor{comment}{/* note that killer is pointing at kilbuf */}
678             \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(kilbuf, \textcolor{stringliteral}{"quit while already on Charon's boat"});
679         \}
680     \}
681     \textcolor{keywordflow}{if} (how == \hyperlink{hack_8h_ac2357bf7093fe80a7c8465c3392b6f12}{ESCAPED} || how == \hyperlink{hack_8h_a42112655d0a453f721ba58c5510dae55}{PANICKED})
682         \hyperlink{decl_8h_a0a94810d03a0bf68b371c6b1a1a4a905}{killer\_format} = \hyperlink{decl_8h_aa2ea21bcf7bdd470bd96936d5b80e0ba}{NO\_KILLER\_PREFIX};
683 
684     \textcolor{keywordflow}{if} (how != \hyperlink{hack_8h_a42112655d0a453f721ba58c5510dae55}{PANICKED}) \{
685         \textcolor{comment}{/* these affect score and/or bones, but avoid them during panic */}
686         taken = paybill((how == \hyperlink{hack_8h_ac2357bf7093fe80a7c8465c3392b6f12}{ESCAPED}) ? -1 : (how != \hyperlink{hack_8h_ad24e2b54375e12474e65ebf7175988fb}{QUIT}));
687         paygd();
688         clearpriests();
689     \} \textcolor{keywordflow}{else}  taken = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}; \textcolor{comment}{/* lint; assert( !bones\_ok ); */}
690 
691     \hyperlink{files_8c_a829000f7fe446d1d26a5c4dbc51643c6}{clearlocks}();
692 
693     \textcolor{keywordflow}{if} (have\_windows) \hyperlink{winprocs_8h_ac8e74d03fbb65b9f5651e63d79bebc60}{display\_nhwindow}(\hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE}, 
      \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
694 
695     \textcolor{keywordflow}{if} (strcmp(\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_ac299d5bda237844a96be2caf62346d60}{end\_disclose}, \textcolor{stringliteral}{"none"}) && how != \hyperlink{hack_8h_a42112655d0a453f721ba58c5510dae55}{PANICKED})
696         \hyperlink{end_8c_a2627a6787c0bca3a911878c508a5f04a}{disclose}(how, taken);
697     \textcolor{comment}{/* finish\_paybill should be called after disclosure but before bones */}
698     \textcolor{keywordflow}{if} (bones\_ok && taken) finish\_paybill();
699 
700     \textcolor{comment}{/* calculate score, before creating bones [container gold] */}
701     \{
702         \textcolor{keywordtype}{long} tmp;
703         \textcolor{keywordtype}{int} deepest = deepest\_lev\_reached(\hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
704 
705 \textcolor{preprocessor}{#ifndef GOLDOBJ}
706         umoney = \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold};
707         tmp = \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a2f0d94fc447b721c2f289fcc201cab38}{ugold0};
708 \textcolor{preprocessor}{#else}
709         umoney = money\_cnt(\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent});
710         tmp = \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.umoney0;
711 \textcolor{preprocessor}{#endif}
712         umoney += hidden\_gold();    \textcolor{comment}{/* accumulate gold from containers */}
713         tmp = umoney - tmp;     \textcolor{comment}{/* net gain */}
714 
715         \textcolor{keywordflow}{if} (tmp < 0L)
716         tmp = 0L;
717         \textcolor{keywordflow}{if} (how < \hyperlink{hack_8h_a42112655d0a453f721ba58c5510dae55}{PANICKED})
718         tmp -= tmp / 10L;
719         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac096bd7eef66e6d79962d6e9848071df}{urexp} += tmp;
720         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac096bd7eef66e6d79962d6e9848071df}{urexp} += 50L * (long)(deepest - 1);
721         \textcolor{keywordflow}{if} (deepest > 20)
722         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac096bd7eef66e6d79962d6e9848071df}{urexp} += 1000L * (long)((deepest > 30) ? 10 : deepest - 20);
723         \textcolor{keywordflow}{if} (how == \hyperlink{hack_8h_a2e7ab555dd9c2d74ce5c0b04e13fffcf}{ASCENDED}) \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac096bd7eef66e6d79962d6e9848071df}{urexp} *= 2L;
724     \}
725 
726     \textcolor{keywordflow}{if} (bones\_ok) \{
727 \textcolor{preprocessor}{#ifdef WIZARD}
728         \textcolor{keywordflow}{if} (!\hyperlink{flag_8h_a5f48dc2f029e22c05489fb20a491db4b}{wizard} || \hyperlink{hack_8h_a22ffd7fa35549db318337a497c38a1ae}{yn}(\textcolor{stringliteral}{"Save bones?"}) == \textcolor{charliteral}{'y'})
729 #endif
730         \hyperlink{bones_8c_aaa45d59230d30fec700f7a97fd5aafda}{savebones}(corpse);
731         \textcolor{comment}{/* corpse may be invalid pointer now so}
732 \textcolor{comment}{        ensure that it isn't used again */}
733         corpse = (\textcolor{keyword}{struct }\hyperlink{structobj}{obj} *)0;
734     \}
735 
736     \textcolor{comment}{/* update gold for the rip output, which can't use hidden\_gold()}
737 \textcolor{comment}{       (containers will be gone by then if bones just got saved...) */}
738 \textcolor{preprocessor}{#ifndef GOLDOBJ}
739     \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold} = umoney;
740 \textcolor{preprocessor}{#else}
741     done\_money = umoney;
742 \textcolor{preprocessor}{#endif}
743 
744     \textcolor{comment}{/* clean up unneeded windows */}
745     \textcolor{keywordflow}{if} (have\_windows) \{
746         \hyperlink{winprocs_8h_ab3dda14337c8ebd4fe496eab265a8483}{wait\_synch}();
747         \hyperlink{winprocs_8h_ac8e74d03fbb65b9f5651e63d79bebc60}{display\_nhwindow}(\hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
748         \hyperlink{winprocs_8h_a77ac4f50de0eedeaead791812762c6a0}{destroy\_nhwindow}(\hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP});
749         \hyperlink{winprocs_8h_a77ac4f50de0eedeaead791812762c6a0}{destroy\_nhwindow}(\hyperlink{decl_8h_ae0690a38fd295760409995ce03b88329}{WIN\_STATUS});
750         \hyperlink{winprocs_8h_a77ac4f50de0eedeaead791812762c6a0}{destroy\_nhwindow}(\hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE});
751         \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} = \hyperlink{decl_8h_ae0690a38fd295760409995ce03b88329}{WIN\_STATUS} = \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} = \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR};
752 
753         \textcolor{keywordflow}{if}(!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint} || \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_adf925ab4c64cb50977b633e1713050d6}{tombstone})
754         endwin = \hyperlink{winprocs_8h_aa13fb35379049d1836397492d10b6b0c}{create\_nhwindow}(\hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT});
755 
756         \textcolor{keywordflow}{if} (how < \hyperlink{hack_8h_a1f501eb9d26f8c52fd5d91a0f86dc924}{GENOCIDED} && \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_adf925ab4c64cb50977b633e1713050d6}{tombstone} && endwin != 
      \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR})
757         \hyperlink{winprocs_8h_ab263796b52bb3f8511c53a33ee45cd5a}{outrip}(endwin, how);
758     \} \textcolor{keywordflow}{else}
759         \hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint} = 1; \textcolor{comment}{/* just avoid any more output */}
760 
761 \textcolor{comment}{/* changing kilbuf really changes killer. we do it this way because}
762 \textcolor{comment}{   killer is declared a (const char *)}
763 \textcolor{comment}{*/}
764     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a3e83735264e74265e8c8777f73e159fa}{uhave}.amulet) \hyperlink{global_8h_a6d985a6c569a61be75fcacf7623f0988}{Strcat}(kilbuf, \textcolor{stringliteral}{" (with the Amulet)"});
765     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (how == \hyperlink{hack_8h_ac2357bf7093fe80a7c8465c3392b6f12}{ESCAPED}) \{
766         \textcolor{keywordflow}{if} (\hyperlink{dungeon_8h_af69a19c1eec378c1cebe9143febbe2b5}{Is\_astralevel}(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}))   \textcolor{comment}{/* offered Amulet to wrong deity */}
767         \hyperlink{global_8h_a6d985a6c569a61be75fcacf7623f0988}{Strcat}(kilbuf, \textcolor{stringliteral}{" (in celestial disgrace)"});
768         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (carrying(FAKE\_AMULET\_OF\_YENDOR))
769         \hyperlink{global_8h_a6d985a6c569a61be75fcacf7623f0988}{Strcat}(kilbuf, \textcolor{stringliteral}{" (with a fake Amulet)"});
770         \textcolor{comment}{/* don't bother counting to see whether it should be plural */}
771     \}
772 
773     \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}) \{
774         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(pbuf, \textcolor{stringliteral}{"%s %s the %s..."}, \hyperlink{role_8c_a121ab51c3cdb138dddd6d9bfde8b636f}{Goodbye}(), \hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname},
775            how != \hyperlink{hack_8h_a2e7ab555dd9c2d74ce5c0b04e13fffcf}{ASCENDED} ?
776               (\textcolor{keyword}{const} \textcolor{keywordtype}{char} *) ((\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_ae3f866c572c50c676ecadf8acccf0c50}{female} && \hyperlink{you_8h_a5e8177648a9df85179098399b7ce2c66}{urole}.\hyperlink{structRole_aca88aa13366db080d9a996e0c8a6c767}{name}.\hyperlink{structRoleName_a9d8f4b8c99abfbf5ca40901e5dcc581a}{f}) ?
777                  \hyperlink{you_8h_a5e8177648a9df85179098399b7ce2c66}{urole}.\hyperlink{structRole_aca88aa13366db080d9a996e0c8a6c767}{name}.\hyperlink{structRoleName_a9d8f4b8c99abfbf5ca40901e5dcc581a}{f} : \hyperlink{you_8h_a5e8177648a9df85179098399b7ce2c66}{urole}.\hyperlink{structRole_aca88aa13366db080d9a996e0c8a6c767}{name}.\hyperlink{structRoleName_a264d1ed0d4715edaaad295e8ab4c1002}{m}) :
778               (\textcolor{keyword}{const} \textcolor{keywordtype}{char} *) (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_ae3f866c572c50c676ecadf8acccf0c50}{female} ? \textcolor{stringliteral}{"Demigoddess"} : \textcolor{stringliteral}{"Demigod"}));
779         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(endwin, 0, pbuf);
780         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(endwin, 0, \textcolor{stringliteral}{""});
781     \}
782 
783     \textcolor{keywordflow}{if} (how == \hyperlink{hack_8h_ac2357bf7093fe80a7c8465c3392b6f12}{ESCAPED} || how == \hyperlink{hack_8h_a2e7ab555dd9c2d74ce5c0b04e13fffcf}{ASCENDED}) \{
784         \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structmonst}{monst} *mtmp;
785         \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp};
786         \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structval__list}{val\_list} *val;
787         \textcolor{keyword}{register} \textcolor{keywordtype}{int} i;
788 
789         \textcolor{keywordflow}{for} (val = \hyperlink{end_8c_acb10921d442ef668d677e5eb065e9bc5}{valuables}; val->\hyperlink{structval__list_a16b694cc1b3306287c794316539a106c}{list}; val++)
790         \textcolor{keywordflow}{for} (i = 0; i < val->\hyperlink{structval__list_a5d57a0aa9b38d5fd6f8dc4efaae9a5df}{size}; i++) \{
791             val->\hyperlink{structval__list_a16b694cc1b3306287c794316539a106c}{list}[i].\hyperlink{structvaluable__data_a0c5f9df0056287f8a8220d1d7a81781d}{count} = 0L;
792         \}
793         \hyperlink{end_8c_a7a7128ee5a159e4aa0cb277597cbbf3a}{get\_valuables}(\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent});
794 
795         \textcolor{comment}{/* add points for collected valuables */}
796         \textcolor{keywordflow}{for} (val = \hyperlink{end_8c_acb10921d442ef668d677e5eb065e9bc5}{valuables}; val->\hyperlink{structval__list_a16b694cc1b3306287c794316539a106c}{list}; val++)
797         \textcolor{keywordflow}{for} (i = 0; i < val->\hyperlink{structval__list_a5d57a0aa9b38d5fd6f8dc4efaae9a5df}{size}; i++)
798             \textcolor{keywordflow}{if} (val->\hyperlink{structval__list_a16b694cc1b3306287c794316539a106c}{list}[i].\hyperlink{structvaluable__data_a0c5f9df0056287f8a8220d1d7a81781d}{count} != 0L)
799             \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac096bd7eef66e6d79962d6e9848071df}{urexp} += val->\hyperlink{structval__list_a16b694cc1b3306287c794316539a106c}{list}[i].\hyperlink{structvaluable__data_a0c5f9df0056287f8a8220d1d7a81781d}{count}
800                   * (long)\hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[val->\hyperlink{structval__list_a16b694cc1b3306287c794316539a106c}{list}[i].\hyperlink{structvaluable__data_a3e054ff977428718f17e0f1a4aa6eef1}{typ}].\hyperlink{structobjclass_aaf9cdc5c158d5ee7aad87728dcaa31cf}{oc\_cost};
801 
802         \textcolor{comment}{/* count the points for artifacts */}
803         \hyperlink{end_8c_aa475252a5c524733c6112c513689707c}{artifact\_score}(\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, endwin);
804 
805         keepdogs(\hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
806         \hyperlink{decl_8h_a011ba0e5242f4afd2abbc3e2729c4622}{viz\_array}[0][0] |= \hyperlink{vision_8h_a3dfc1f262a872b4787aa8fbe68864c6b}{IN\_SIGHT}; \textcolor{comment}{/* need visibility for naming */}
807         mtmp = \hyperlink{decl_8h_adf725793c60d6be3ae981bd224f745e0}{mydogs};
808         \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}) \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(pbuf, \textcolor{stringliteral}{"You"});
809         \textcolor{keywordflow}{if} (mtmp) \{
810         \textcolor{keywordflow}{while} (mtmp) \{
811             \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint})
812             \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(\hyperlink{makedefs_8c_a72563303ed4b67f2a7dd9f2d15a01558}{eos}(pbuf), \textcolor{stringliteral}{" and %s"}, mon\_nam(mtmp));
813             \textcolor{keywordflow}{if} (mtmp->\hyperlink{structmonst_a6d525ec48f9d38cda6accbb0cb39efba}{mtame})
814             \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac096bd7eef66e6d79962d6e9848071df}{urexp} += mtmp->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp};
815             mtmp = mtmp->\hyperlink{structmonst_a4c4bcdcf3c4ec4a85313ade9f9c27b72}{nmon};
816         \}
817         \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}) \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(endwin, 0, pbuf);
818         pbuf[0] = \textcolor{charliteral}{'\(\backslash\)0'};
819         \} \textcolor{keywordflow}{else} \{
820         \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}) \hyperlink{global_8h_a6d985a6c569a61be75fcacf7623f0988}{Strcat}(pbuf, \textcolor{stringliteral}{" "});
821         \}
822         \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}) \{
823         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(\hyperlink{makedefs_8c_a72563303ed4b67f2a7dd9f2d15a01558}{eos}(pbuf), \textcolor{stringliteral}{"%s with %ld point%s,"},
824             how==\hyperlink{hack_8h_a2e7ab555dd9c2d74ce5c0b04e13fffcf}{ASCENDED} ? \textcolor{stringliteral}{"went to your reward"} :
825                     \textcolor{stringliteral}{"escaped from the dungeon"},
826             \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac096bd7eef66e6d79962d6e9848071df}{urexp}, \hyperlink{hack_8h_a6ed0ab51b12ebf31e060e3dd26394db0}{plur}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac096bd7eef66e6d79962d6e9848071df}{urexp}));
827         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(endwin, 0, pbuf);
828         \}
829 
830         \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint})
831         \hyperlink{end_8c_aa475252a5c524733c6112c513689707c}{artifact\_score}(\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, endwin); \textcolor{comment}{/* list artifacts */}
832 
833         \textcolor{comment}{/* list valuables here */}
834         \textcolor{keywordflow}{for} (val = \hyperlink{end_8c_acb10921d442ef668d677e5eb065e9bc5}{valuables}; val->\hyperlink{structval__list_a16b694cc1b3306287c794316539a106c}{list}; val++) \{
835         \hyperlink{end_8c_a2626b1529b8c734fe1494d5290f2c8c0}{sort\_valuables}(val->\hyperlink{structval__list_a16b694cc1b3306287c794316539a106c}{list}, val->\hyperlink{structval__list_a5d57a0aa9b38d5fd6f8dc4efaae9a5df}{size});
836         \textcolor{keywordflow}{for} (i = 0; i < val->\hyperlink{structval__list_a5d57a0aa9b38d5fd6f8dc4efaae9a5df}{size} && !\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}; i++) \{
837             \textcolor{keywordtype}{int} typ = val->\hyperlink{structval__list_a16b694cc1b3306287c794316539a106c}{list}[i].\hyperlink{structvaluable__data_a3e054ff977428718f17e0f1a4aa6eef1}{typ};
838             \textcolor{keywordtype}{long} \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count} = val->\hyperlink{structval__list_a16b694cc1b3306287c794316539a106c}{list}[i].\hyperlink{structvaluable__data_a0c5f9df0056287f8a8220d1d7a81781d}{count};
839 
840             \textcolor{keywordflow}{if} (count == 0L) \textcolor{keywordflow}{continue};
841             \textcolor{keywordflow}{if} (\hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[typ].oc\_class != \hyperlink{objclass_8h_afc09c51ea922e9928f86a51177244796}{GEM\_CLASS} || typ <= LAST\_GEM) \{
842             otmp = mksobj(typ, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
843             \hyperlink{hack_8h_afbd3607e7cef2f888f4190d40d058011}{makeknown}(otmp->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp});
844             otmp->known = 1;    \textcolor{comment}{/* for fake amulets */}
845             otmp->dknown = 1;   \textcolor{comment}{/* seen it (blindness fix) */}
846             otmp->\hyperlink{structobj_a032663f21fa617948660e1102147b47d}{onamelth} = 0;
847             otmp->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} = \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
848             \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(pbuf, \textcolor{stringliteral}{"%8ld %s (worth %ld %s),"},
849                 count, xname(otmp),
850                 count * (\textcolor{keywordtype}{long})\hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[typ].oc\_cost, currency(2L));
851             obfree(otmp, (\textcolor{keyword}{struct} \hyperlink{structobj}{obj} *)0);
852             \} \textcolor{keywordflow}{else} \{
853             \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(pbuf,
854                 \textcolor{stringliteral}{"%8ld worthless piece%s of colored glass,"},
855                 count, \hyperlink{hack_8h_a6ed0ab51b12ebf31e060e3dd26394db0}{plur}(count));
856             \}
857             \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(endwin, 0, pbuf);
858         \}
859         \}
860 
861     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}) \{
862         \textcolor{comment}{/* did not escape or ascend */}
863         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}.\hyperlink{structd__level_a035d301f0a8cafc6c757fbbda2b6935e}{dnum} == 0 && \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}.\hyperlink{structd__level_a7878568dc81a7efd40bea0206dbd109d}{dlevel} <= 0) \{
864         \textcolor{comment}{/* level teleported out of the dungeon; `how' is DIED,}
865 \textcolor{comment}{           due to falling or to "arriving at heaven prematurely" */}
866         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(pbuf, \textcolor{stringliteral}{"You %s beyond the confines of the dungeon"},
867             (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}.\hyperlink{structd__level_a7878568dc81a7efd40bea0206dbd109d}{dlevel} < 0) ? \textcolor{stringliteral}{"passed away"} : \hyperlink{end_8c_a9b0ae9b5d06e599cad0a7d34f5337332}{ends}[how]);
868         \} \textcolor{keywordflow}{else} \{
869         \textcolor{comment}{/* more conventional demise */}
870         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\hyperlink{detect_8c_a8201fc0bfa35306851be2a25ab2d6263}{where} = \hyperlink{decl_8h_ac5ded4d65e561a90b475dc626c392a18}{dungeons}[\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}.\hyperlink{structd__level_a035d301f0a8cafc6c757fbbda2b6935e}{dnum}].\hyperlink{structdungeon_a802ae61c0d552cf15d77175a8d5b7c5c}{dname};
871 
872         \textcolor{keywordflow}{if} (\hyperlink{dungeon_8h_af69a19c1eec378c1cebe9143febbe2b5}{Is\_astralevel}(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz})) where = \textcolor{stringliteral}{"The Astral Plane"};
873         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(pbuf, \textcolor{stringliteral}{"You %s in %s"}, \hyperlink{end_8c_a9b0ae9b5d06e599cad0a7d34f5337332}{ends}[how], where);
874         \textcolor{keywordflow}{if} (!\hyperlink{dungeon_8h_ae85486e6a752224948478a6e9dab0329}{In\_endgame}(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}) && !\hyperlink{dungeon_8h_a91a7bc143ab22db0e11c5f8233af9be9}{Is\_knox}(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}))
875             \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(\hyperlink{makedefs_8c_a72563303ed4b67f2a7dd9f2d15a01558}{eos}(pbuf), \textcolor{stringliteral}{" on dungeon level %d"},
876                 In\_quest(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}) ? dunlev(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}) : depth(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}));
877         \}
878 
879         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(\hyperlink{makedefs_8c_a72563303ed4b67f2a7dd9f2d15a01558}{eos}(pbuf), \textcolor{stringliteral}{" with %ld point%s,"},
880             \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac096bd7eef66e6d79962d6e9848071df}{urexp}, \hyperlink{hack_8h_a6ed0ab51b12ebf31e060e3dd26394db0}{plur}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac096bd7eef66e6d79962d6e9848071df}{urexp}));
881         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(endwin, 0, pbuf);
882     \}
883 
884     \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}) \{
885         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(pbuf, \textcolor{stringliteral}{"and %ld piece%s of gold, after %ld move%s."},
886             umoney, \hyperlink{hack_8h_a6ed0ab51b12ebf31e060e3dd26394db0}{plur}(umoney), \hyperlink{decl_8h_a2ccad6e8fb93740ed50c6d9a8f72ce2f}{moves}, \hyperlink{hack_8h_a6ed0ab51b12ebf31e060e3dd26394db0}{plur}(\hyperlink{decl_8h_a2ccad6e8fb93740ed50c6d9a8f72ce2f}{moves}));
887         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(endwin, 0, pbuf);
888     \}
889     \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}) \{
890         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(pbuf,
891          \textcolor{stringliteral}{"You were level %d with a maximum of %d hit point%s when you %s."},
892             \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a6c7263bb25b91825bf7ecaab470d771a}{ulevel}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ade36670a142a7d38051c74740d02002b}{uhpmax}, \hyperlink{hack_8h_a6ed0ab51b12ebf31e060e3dd26394db0}{plur}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ade36670a142a7d38051c74740d02002b}{uhpmax}), \hyperlink{end_8c_a9b0ae9b5d06e599cad0a7d34f5337332}{ends}[how]);
893         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(endwin, 0, pbuf);
894         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(endwin, 0, \textcolor{stringliteral}{""});
895     \}
896     \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint})
897         \hyperlink{winprocs_8h_ac8e74d03fbb65b9f5651e63d79bebc60}{display\_nhwindow}(endwin, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
898     \textcolor{keywordflow}{if} (endwin != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR})
899         \hyperlink{winprocs_8h_a77ac4f50de0eedeaead791812762c6a0}{destroy\_nhwindow}(endwin);
900 
901     \textcolor{comment}{/* "So when I die, the first thing I will see in Heaven is a}
902 \textcolor{comment}{     * score list?" */}
903     \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a82cef9011b510b91ae45af332672fcc6}{toptenwin}) \{
904         \hyperlink{topten_8c_a0d5a4dbc8c9ff2d3e344247889e9a182}{topten}(how);
905         \textcolor{keywordflow}{if} (have\_windows)
906         \hyperlink{winprocs_8h_ae874ce2b3810c39744ef196e24d5c9fc}{exit\_nhwindows}((\textcolor{keywordtype}{char} *)0);
907     \} \textcolor{keywordflow}{else} \{
908         \textcolor{keywordflow}{if} (have\_windows)
909         \hyperlink{winprocs_8h_ae874ce2b3810c39744ef196e24d5c9fc}{exit\_nhwindows}((\textcolor{keywordtype}{char} *)0);
910         \hyperlink{topten_8c_a0d5a4dbc8c9ff2d3e344247889e9a182}{topten}(how);
911     \}
912 
913     \textcolor{keywordflow}{if}(\hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}) \{ \hyperlink{end_8c_abf7447f6bb57e76e198834c4c9c3d2ae}{raw\_print}(\textcolor{stringliteral}{""}); \hyperlink{end_8c_abf7447f6bb57e76e198834c4c9c3d2ae}{raw\_print}(\textcolor{stringliteral}{""}); \}
914     \hyperlink{end_8c_a30ebaced48494e6e25f8833532ec17ca}{terminate}(\hyperlink{global_8h_a687984f47d8cce148d1b914d2b79612a}{EXIT\_SUCCESS});
915 \}
\end{DoxyCode}
\hypertarget{end_8c_a2082a4dffb6195df4e125aa90a4fe0cd}{\index{end.\+c@{end.\+c}!done1@{done1}}
\index{done1@{done1}!end.\+c@{end.\+c}}
\subsubsection[{done1}]{\setlength{\rightskip}{0pt plus 5cm}void done1 (
\begin{DoxyParamCaption}
\item[{int}]{sig\+\_\+unused}
\end{DoxyParamCaption}
)}}\label{end_8c_a2082a4dffb6195df4e125aa90a4fe0cd}


Definition at line 91 of file end.\+c.



References clear\+\_\+nhwindow, curs\+\_\+on\+\_\+u(), done2(), flags, flag\+::ignintr, multi, S\+I\+G\+\_\+\+R\+E\+T\+\_\+\+T\+Y\+P\+E, wait\+\_\+synch, and W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E.



Referenced by done2(), and main().


\begin{DoxyCode}
93 \{
94 \textcolor{preprocessor}{#ifndef NO\_SIGNAL}
95     (void) signal(SIGINT,SIG\_IGN);
96 \textcolor{preprocessor}{#endif}
97     \textcolor{keywordflow}{if}(\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a6d0389cb18cf906c95391a579f9b14dc}{ignintr}) \{
98 \textcolor{preprocessor}{#ifndef NO\_SIGNAL}
99         (void) signal(SIGINT, (\hyperlink{beconf_8h_a1a6cd64290d8bd530aa53c9094ff277d}{SIG\_RET\_TYPE}) \hyperlink{end_8c_a2082a4dffb6195df4e125aa90a4fe0cd}{done1});
100 \textcolor{preprocessor}{#endif}
101         \hyperlink{winprocs_8h_a177c23e23d7dafb484ad58f01ae1d063}{clear\_nhwindow}(\hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE});
102         \hyperlink{display_8c_a8edd142a64cff572d19c484164e93755}{curs\_on\_u}();
103         \hyperlink{winprocs_8h_ab3dda14337c8ebd4fe496eab265a8483}{wait\_synch}();
104         \textcolor{keywordflow}{if}(\hyperlink{decl_8h_a498406921f71695627a7107240f3ed7a}{multi} > 0) nomul(0);
105     \} \textcolor{keywordflow}{else} \{
106         (void)\hyperlink{end_8c_aec8aa049129efa2742756fbeacfa6852}{done2}();
107     \}
108 \}
\end{DoxyCode}
\hypertarget{end_8c_aec8aa049129efa2742756fbeacfa6852}{\index{end.\+c@{end.\+c}!done2@{done2}}
\index{done2@{done2}!end.\+c@{end.\+c}}
\subsubsection[{done2}]{\setlength{\rightskip}{0pt plus 5cm}int done2 (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{end_8c_aec8aa049129efa2742756fbeacfa6852}


Definition at line 113 of file end.\+c.



References clear\+\_\+nhwindow, curs\+\_\+on\+\_\+u(), done(), done1(), done\+\_\+stopprint, exit\+\_\+nhwindows, F\+A\+L\+S\+E, multi, N\+H\+\_\+abort, Q\+U\+I\+T, S\+I\+G\+\_\+\+R\+E\+T\+\_\+\+T\+Y\+P\+E, u, you\+::usleep, wait\+\_\+synch, W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E, wizard, yn, and ynq.



Referenced by done1(), and on\+W\+M\+Command().


\begin{DoxyCode}
114 \{
115     \textcolor{keywordflow}{if}(\hyperlink{hack_8h_a22ffd7fa35549db318337a497c38a1ae}{yn}(\textcolor{stringliteral}{"Really quit?"}) == \textcolor{charliteral}{'n'}) \{
116 \textcolor{preprocessor}{#ifndef NO\_SIGNAL}
117         (void) signal(SIGINT, (\hyperlink{beconf_8h_a1a6cd64290d8bd530aa53c9094ff277d}{SIG\_RET\_TYPE}) \hyperlink{end_8c_a2082a4dffb6195df4e125aa90a4fe0cd}{done1});
118 \textcolor{preprocessor}{#endif}
119         \hyperlink{winprocs_8h_a177c23e23d7dafb484ad58f01ae1d063}{clear\_nhwindow}(\hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE});
120         \hyperlink{display_8c_a8edd142a64cff572d19c484164e93755}{curs\_on\_u}();
121         \hyperlink{winprocs_8h_ab3dda14337c8ebd4fe496eab265a8483}{wait\_synch}();
122         \textcolor{keywordflow}{if}(\hyperlink{decl_8h_a498406921f71695627a7107240f3ed7a}{multi} > 0) nomul(0);
123         \textcolor{keywordflow}{if}(\hyperlink{decl_8h_a498406921f71695627a7107240f3ed7a}{multi} == 0) \{
124             \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uinvulnerable = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};  \textcolor{comment}{/* avoid ctrl-C bug -dlc */}
125             \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a66ad1d014c330de174c200ca40b701d5}{usleep} = 0;
126         \}
127         \textcolor{keywordflow}{return} 0;
128     \}
129 \textcolor{preprocessor}{#if defined(WIZARD) && (defined(UNIX) || defined(VMS) || defined(LATTICE))}
130     \textcolor{keywordflow}{if}(\hyperlink{flag_8h_a5f48dc2f029e22c05489fb20a491db4b}{wizard}) \{
131         \textcolor{keywordtype}{int} c;
132 \textcolor{preprocessor}{# ifdef VMS}
133         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *tmp = \textcolor{stringliteral}{"Enter debugger?"};
134 \textcolor{preprocessor}{# else}
135 \textcolor{preprocessor}{#  ifdef LATTICE}
136         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *tmp = \textcolor{stringliteral}{"Create SnapShot?"};
137 \textcolor{preprocessor}{#  else}
138         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *tmp = \textcolor{stringliteral}{"Dump core?"};
139 \textcolor{preprocessor}{#  endif}
140 \textcolor{preprocessor}{# endif}
141         \textcolor{keywordflow}{if} ((c = \hyperlink{hack_8h_a104792d619a60e73407115c00499745e}{ynq}(tmp)) == \textcolor{charliteral}{'y'}) \{
142         (void) signal(SIGINT, (\hyperlink{beconf_8h_a1a6cd64290d8bd530aa53c9094ff277d}{SIG\_RET\_TYPE}) \hyperlink{end_8c_a2082a4dffb6195df4e125aa90a4fe0cd}{done1});
143         \hyperlink{winprocs_8h_ae874ce2b3810c39744ef196e24d5c9fc}{exit\_nhwindows}((\textcolor{keywordtype}{char} *)0);
144         \hyperlink{end_8c_ab942d9494cb03e73522a949a4cce0682}{NH\_abort}();
145         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (c == \textcolor{charliteral}{'q'}) \hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}++;
146     \}
147 \textcolor{preprocessor}{#endif}
148 \textcolor{preprocessor}{#ifndef LINT}
149     \hyperlink{end_8c_a3bc1d99b44570f8c98144d24c1f4e344}{done}(\hyperlink{hack_8h_ad24e2b54375e12474e65ebf7175988fb}{QUIT});
150 \textcolor{preprocessor}{#endif}
151     \textcolor{keywordflow}{return} 0;
152 \}
\end{DoxyCode}
\hypertarget{end_8c_a2a4518b11efaf16a0b79fa3e7ea4d12d}{\index{end.\+c@{end.\+c}!done\+\_\+in\+\_\+by@{done\+\_\+in\+\_\+by}}
\index{done\+\_\+in\+\_\+by@{done\+\_\+in\+\_\+by}!end.\+c@{end.\+c}}
\subsubsection[{done\+\_\+in\+\_\+by}]{\setlength{\rightskip}{0pt plus 5cm}void done\+\_\+in\+\_\+by (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mtmp}
\end{DoxyParamCaption}
)}}\label{end_8c_a2a4518b11efaf16a0b79fa3e7ea4d12d}


Definition at line 182 of file end.\+c.



References buf, B\+U\+F\+S\+Z, canspotmon, D\+I\+E\+D, done(), eos(), G\+\_\+\+G\+E\+N\+O\+D, G\+\_\+\+U\+N\+I\+Q, Hallucination, K\+I\+L\+L\+E\+D\+\_\+\+B\+Y, K\+I\+L\+L\+E\+D\+\_\+\+B\+Y\+\_\+\+A\+N, killer, killer\+\_\+format, L\+O\+W\+\_\+\+P\+M, mark\+\_\+synch, mons, multi, Race\+::mummynum, mvitals\+::mvflags, N\+A\+M\+E, N\+O\+N\+\_\+\+P\+M, Race\+\_\+if, S\+\_\+\+M\+U\+M\+M\+Y, S\+\_\+\+V\+A\+M\+P\+I\+R\+E, S\+\_\+\+W\+R\+A\+I\+T\+H, Sprintf, S\+T\+O\+N\+I\+N\+G, Strcat, touch\+\_\+petrifies, type\+\_\+is\+\_\+pname, u, you\+::ugrave\+\_\+arise, and urace.



Referenced by passive().


\begin{DoxyCode}
184 \{
185     \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
186     \textcolor{keywordtype}{boolean} distorted = (\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean})(\hyperlink{youprop_8h_aa873f7ea0a3d096ef94ff651907f7a76}{Hallucination} && 
      \hyperlink{display_8h_a13f0a7cac1ceb73885a59b8598de1648}{canspotmon}(mtmp));
187 
188     You(\textcolor{stringliteral}{"die..."});
189     \hyperlink{winprocs_8h_a72bbad3e5805d71f128c614261fc7ee0}{mark\_synch}(); \textcolor{comment}{/* flush buffered screen output */}
190     buf[0] = \textcolor{charliteral}{'\(\backslash\)0'};
191     \hyperlink{decl_8h_a0a94810d03a0bf68b371c6b1a1a4a905}{killer\_format} = \hyperlink{decl_8h_af4e54910b730baa32b2dfbe4dd2942c1}{KILLED\_BY\_AN};
192     \textcolor{comment}{/* "killed by the high priest of Crom" is okay, "killed by the high}
193 \textcolor{comment}{       priest" alone isn't */}
194     \textcolor{keywordflow}{if} ((mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_a0f9f93635f6228a61551c835640b3c1d}{geno} & \hyperlink{monflag_8h_ab99532c9310183c20279ce79e7f594dd}{G\_UNIQ}) != 0 && !(mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &
      \hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_HIGH\_PRIEST] && !mtmp->ispriest)) \{
195         \textcolor{keywordflow}{if} (!\hyperlink{mondata_8h_a431e6a2710b289745d56debf83fafc33}{type\_is\_pname}(mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}))
196         \hyperlink{global_8h_a6d985a6c569a61be75fcacf7623f0988}{Strcat}(buf, \textcolor{stringliteral}{"the "});
197         \hyperlink{decl_8h_a0a94810d03a0bf68b371c6b1a1a4a905}{killer\_format} = \hyperlink{decl_8h_a0b77d6f094070ee1d9900156357f6f62}{KILLED\_BY};
198     \}
199     \textcolor{comment}{/* \_the\_ <invisible> <distorted> ghost of Dudley */}
200     \textcolor{keywordflow}{if} (mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_GHOST] && mtmp->\hyperlink{structmonst_a03fe7192ae1efd428bc9a0d2f856125f}{mnamelth}) \{
201         \hyperlink{global_8h_a6d985a6c569a61be75fcacf7623f0988}{Strcat}(buf, \textcolor{stringliteral}{"the "});
202         \hyperlink{decl_8h_a0a94810d03a0bf68b371c6b1a1a4a905}{killer\_format} = \hyperlink{decl_8h_a0b77d6f094070ee1d9900156357f6f62}{KILLED\_BY};
203     \}
204     \textcolor{keywordflow}{if} (mtmp->minvis)
205         \hyperlink{global_8h_a6d985a6c569a61be75fcacf7623f0988}{Strcat}(buf, \textcolor{stringliteral}{"invisible "});
206     \textcolor{keywordflow}{if} (distorted)
207         \hyperlink{global_8h_a6d985a6c569a61be75fcacf7623f0988}{Strcat}(buf, \textcolor{stringliteral}{"hallucinogen-distorted "});
208 
209     \textcolor{keywordflow}{if}(mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_GHOST]) \{
210         \hyperlink{global_8h_a6d985a6c569a61be75fcacf7623f0988}{Strcat}(buf, \textcolor{stringliteral}{"ghost"});
211         \textcolor{keywordflow}{if} (mtmp->\hyperlink{structmonst_a03fe7192ae1efd428bc9a0d2f856125f}{mnamelth}) \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(\hyperlink{makedefs_8c_a72563303ed4b67f2a7dd9f2d15a01558}{eos}(buf), \textcolor{stringliteral}{" of %s"}, \hyperlink{monst_8h_ac29ed1d493cdb635e09ebbecb209ac2d}{NAME}(mtmp));
212     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(mtmp->isshk) \{
213         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(\hyperlink{makedefs_8c_a72563303ed4b67f2a7dd9f2d15a01558}{eos}(buf), \textcolor{stringliteral}{"%s %s, the shopkeeper"},
214             (mtmp->female ? \textcolor{stringliteral}{"Ms."} : \textcolor{stringliteral}{"Mr."}), shkname(mtmp));
215         \hyperlink{decl_8h_a0a94810d03a0bf68b371c6b1a1a4a905}{killer\_format} = \hyperlink{decl_8h_a0b77d6f094070ee1d9900156357f6f62}{KILLED\_BY};
216     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mtmp->ispriest || mtmp->isminion) \{
217         \textcolor{comment}{/* m\_monnam() suppresses "the" prefix plus "invisible", and}
218 \textcolor{comment}{           it overrides the effect of Hallucination on priestname() */}
219         \hyperlink{decl_8h_af7d2dea3996fe6d20ea8ec329726e8f9}{killer} = m\_monnam(mtmp);
220         \hyperlink{global_8h_a6d985a6c569a61be75fcacf7623f0988}{Strcat}(buf, \hyperlink{decl_8h_af7d2dea3996fe6d20ea8ec329726e8f9}{killer});
221     \} \textcolor{keywordflow}{else} \{
222         \hyperlink{global_8h_a6d985a6c569a61be75fcacf7623f0988}{Strcat}(buf, mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ae92da7d141243d7e37d4a12340bb248f}{mname});
223         \textcolor{keywordflow}{if} (mtmp->\hyperlink{structmonst_a03fe7192ae1efd428bc9a0d2f856125f}{mnamelth})
224             \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(\hyperlink{makedefs_8c_a72563303ed4b67f2a7dd9f2d15a01558}{eos}(buf), \textcolor{stringliteral}{" called %s"}, \hyperlink{monst_8h_ac29ed1d493cdb635e09ebbecb209ac2d}{NAME}(mtmp));
225     \}
226 
227     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a498406921f71695627a7107240f3ed7a}{multi}) \hyperlink{global_8h_a6d985a6c569a61be75fcacf7623f0988}{Strcat}(buf, \textcolor{stringliteral}{", while helpless"});
228     \hyperlink{decl_8h_af7d2dea3996fe6d20ea8ec329726e8f9}{killer} = \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf};
229     \textcolor{keywordflow}{if} (mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ab402dbf1bed9d0e595a2b3da6558da92}{mlet} == \hyperlink{monsym_8h_a923120ddc98c245500abf2711e27a4a7}{S\_WRAITH})
230         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af66a5ecd2d2a4f3443af9cc10fb928f3}{ugrave\_arise} = PM\_WRAITH;
231     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ab402dbf1bed9d0e595a2b3da6558da92}{mlet} == \hyperlink{monsym_8h_af0c3ce0cab08d748710bf38390422cdd}{S\_MUMMY} && \hyperlink{you_8h_adaecc633890bd84d5cfceaf4a513bbaa}{urace}.\hyperlink{structRace_aa3c20e0a53e012337991e56581ce29c5}{mummynum} != 
      \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM})
232         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af66a5ecd2d2a4f3443af9cc10fb928f3}{ugrave\_arise} = \hyperlink{you_8h_adaecc633890bd84d5cfceaf4a513bbaa}{urace}.\hyperlink{structRace_aa3c20e0a53e012337991e56581ce29c5}{mummynum};
233     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ab402dbf1bed9d0e595a2b3da6558da92}{mlet} == \hyperlink{monsym_8h_ad14ae95a12a1b48239437073d6f614e3}{S\_VAMPIRE} && \hyperlink{you_8h_ac1b9b8d9c3387e3d3a36b9474945879c}{Race\_if}(PM\_HUMAN))
234         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af66a5ecd2d2a4f3443af9cc10fb928f3}{ugrave\_arise} = PM\_VAMPIRE;
235     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_GHOUL])
236         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af66a5ecd2d2a4f3443af9cc10fb928f3}{ugrave\_arise} = PM\_GHOUL;
237     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af66a5ecd2d2a4f3443af9cc10fb928f3}{ugrave\_arise} >= \hyperlink{permonst_8h_aedc8e4764f8cf4d681f6f6226eeaa6af}{LOW\_PM} &&
238                 (\hyperlink{structmvitals}{mvitals}[\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af66a5ecd2d2a4f3443af9cc10fb928f3}{ugrave\_arise}].\hyperlink{structmvitals_a51369b55e24dc02d3f5768b8f5b01381}{mvflags} & 
      \hyperlink{monflag_8h_a89b3308e85c121e38c6bef7077e49fd8}{G\_GENOD}))
239         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af66a5ecd2d2a4f3443af9cc10fb928f3}{ugrave\_arise} = \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM};
240     \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_ad1e85e493d27cdfdbe94c43710c4b191}{touch\_petrifies}(mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}))
241         \hyperlink{end_8c_a3bc1d99b44570f8c98144d24c1f4e344}{done}(\hyperlink{hack_8h_aac5555456695094b0171cb7f67e0b5f7}{STONING});
242     \textcolor{keywordflow}{else}
243         \hyperlink{end_8c_a3bc1d99b44570f8c98144d24c1f4e344}{done}(\hyperlink{hack_8h_a945602f8a7d9cde22e2502ffb5c51f58}{DIED});
244     \textcolor{keywordflow}{return};
245 \}
\end{DoxyCode}
\hypertarget{end_8c_a643208f7b1c8126977b74ebe2bec6d98}{\index{end.\+c@{end.\+c}!done\+\_\+intr@{done\+\_\+intr}}
\index{done\+\_\+intr@{done\+\_\+intr}!end.\+c@{end.\+c}}
\subsubsection[{done\+\_\+intr}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+P\+T\+R} void done\+\_\+intr (
\begin{DoxyParamCaption}
\item[{int}]{sig\+\_\+unused}
\end{DoxyParamCaption}
)}}\label{end_8c_a643208f7b1c8126977b74ebe2bec6d98}


Definition at line 157 of file end.\+c.



References done\+\_\+stopprint.



Referenced by done().


\begin{DoxyCode}
159 \{
160     \hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}++;
161     (void) signal(SIGINT, SIG\_IGN);
162 \textcolor{preprocessor}{# if defined(UNIX) || defined(VMS)}
163     (void) signal(SIGQUIT, SIG\_IGN);
164 \textcolor{preprocessor}{# endif}
165     \textcolor{keywordflow}{return};
166 \}
\end{DoxyCode}
\hypertarget{end_8c_aa257847226be6c4e3d883a334dd29bfc}{\index{end.\+c@{end.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!end.\+c@{end.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+P\+T\+R} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf done\+\_\+intr}}]{, }
\item[{(int)}]{}
\end{DoxyParamCaption}
)}}\label{end_8c_aa257847226be6c4e3d883a334dd29bfc}
\hypertarget{end_8c_a40322608ce13ceebf4d97d1cfcc07b50}{\index{end.\+c@{end.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!end.\+c@{end.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf disclose}}]{, }
\item[{(int, {\bf B\+O\+O\+L\+E\+A\+N\+\_\+\+P})}]{}
\end{DoxyParamCaption}
)}}\label{end_8c_a40322608ce13ceebf4d97d1cfcc07b50}
\hypertarget{end_8c_ad1e5c094d5c34d23420906faf537b44b}{\index{end.\+c@{end.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!end.\+c@{end.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf get\+\_\+valuables}}]{, }
\item[{(struct {\bf obj} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{end_8c_ad1e5c094d5c34d23420906faf537b44b}
\hypertarget{end_8c_a1ed6d121129c2411ce8483009bc85174}{\index{end.\+c@{end.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!end.\+c@{end.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf sort\+\_\+valuables}}]{, }
\item[{(struct {\bf valuable\+\_\+data} $\ast$, int)}]{}
\end{DoxyParamCaption}
)}}\label{end_8c_a1ed6d121129c2411ce8483009bc85174}
\hypertarget{end_8c_afcd69f879c4e4fef71e820e1ab5e1c4d}{\index{end.\+c@{end.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!end.\+c@{end.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf artifact\+\_\+score}}]{, }
\item[{(struct {\bf obj} $\ast$, {\bf B\+O\+O\+L\+E\+A\+N\+\_\+\+P}, {\bf winid})}]{}
\end{DoxyParamCaption}
)}}\label{end_8c_afcd69f879c4e4fef71e820e1ab5e1c4d}
\hypertarget{end_8c_ad58f208ea09e5da1530cc8970b649d47}{\index{end.\+c@{end.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!end.\+c@{end.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf savelife}}]{, }
\item[{(int)}]{}
\end{DoxyParamCaption}
)}}\label{end_8c_ad58f208ea09e5da1530cc8970b649d47}
\hypertarget{end_8c_aa8d6c6089bf8d7aea66aad6c8f6b0b96}{\index{end.\+c@{end.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!end.\+c@{end.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf list\+\_\+vanquished}}]{, }
\item[{({\bf C\+H\+A\+R\+\_\+\+P}, {\bf B\+O\+O\+L\+E\+A\+N\+\_\+\+P})}]{}
\end{DoxyParamCaption}
)}}\label{end_8c_aa8d6c6089bf8d7aea66aad6c8f6b0b96}
\hypertarget{end_8c_acad0d8e81b49d0637979c374be7b563e}{\index{end.\+c@{end.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!end.\+c@{end.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf list\+\_\+genocided}}]{, }
\item[{({\bf C\+H\+A\+R\+\_\+\+P}, {\bf B\+O\+O\+L\+E\+A\+N\+\_\+\+P})}]{}
\end{DoxyParamCaption}
)}}\label{end_8c_acad0d8e81b49d0637979c374be7b563e}
\hypertarget{end_8c_aa7fb3e5aea58a626b4d46f07aef4b393}{\index{end.\+c@{end.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!end.\+c@{end.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf should\+\_\+query\+\_\+disclose\+\_\+option}}]{, }
\item[{(int, char $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{end_8c_aa7fb3e5aea58a626b4d46f07aef4b393}
\hypertarget{end_8c_a7a7128ee5a159e4aa0cb277597cbbf3a}{\index{end.\+c@{end.\+c}!get\+\_\+valuables@{get\+\_\+valuables}}
\index{get\+\_\+valuables@{get\+\_\+valuables}!end.\+c@{end.\+c}}
\subsubsection[{get\+\_\+valuables}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void get\+\_\+valuables (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{list}
\end{DoxyParamCaption}
)}}\label{end_8c_a7a7128ee5a159e4aa0cb277597cbbf3a}


Definition at line 442 of file end.\+c.



References A\+M\+U\+L\+E\+T\+\_\+\+C\+L\+A\+S\+S, amulets, obj\+::cobj, valuable\+\_\+data\+::count, count, F\+I\+R\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T, F\+I\+R\+S\+T\+\_\+\+G\+E\+M, G\+E\+M\+\_\+\+C\+L\+A\+S\+S, gems, Has\+\_\+contents, min, obj\+::nobj, obj\+::oartifact, obj\+::oclass, obj\+::otyp, obj\+::quan, and valuable\+\_\+data\+::typ.



Referenced by done().


\begin{DoxyCode}
444 \{
445     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{structobj}{obj};
446     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i;
447 
448     \textcolor{comment}{/* find amulets and gems, ignoring all artifacts */}
449     \textcolor{keywordflow}{for} (obj = list; obj; obj = obj->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj})
450     \textcolor{keywordflow}{if} (\hyperlink{obj_8h_ae2e47c7280efe98de2333e8078f8ce71}{Has\_contents}(obj)) \{
451         \hyperlink{end_8c_a7a7128ee5a159e4aa0cb277597cbbf3a}{get\_valuables}(obj->\hyperlink{structobj_aa7bed832c417657c964b6f5893737586}{cobj});
452     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_af03ce8a6a0ca51e8d8954fb1a1a31fbe}{oartifact}) \{
453         \textcolor{keywordflow}{continue};
454     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == \hyperlink{objclass_8h_af05e45a3c94a4a19096ee4f048ee96cd}{AMULET\_CLASS}) \{
455         i = obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} - \hyperlink{end_8c_a0eddc50c6754baf9d7116e82932e3aee}{FIRST\_AMULET};
456         \textcolor{keywordflow}{if} (!\hyperlink{end_8c_a16f54cba952b549755aeff67fcef047d}{amulets}[i].\hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}) \{
457         \hyperlink{end_8c_a16f54cba952b549755aeff67fcef047d}{amulets}[i].\hyperlink{structvaluable__data_a0c5f9df0056287f8a8220d1d7a81781d}{count} = obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan};
458         \hyperlink{end_8c_a16f54cba952b549755aeff67fcef047d}{amulets}[i].\hyperlink{structvaluable__data_a3e054ff977428718f17e0f1a4aa6eef1}{typ} = obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp};
459         \} \textcolor{keywordflow}{else} \hyperlink{end_8c_a16f54cba952b549755aeff67fcef047d}{amulets}[i].\hyperlink{structvaluable__data_a0c5f9df0056287f8a8220d1d7a81781d}{count} += obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan}; \textcolor{comment}{/* always adds one */}
460     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == \hyperlink{objclass_8h_afc09c51ea922e9928f86a51177244796}{GEM\_CLASS} && obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} < LUCKSTONE) \{
461         i = \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp}, LAST\_GEM + 1) - \hyperlink{end_8c_a90f8b34525bb5925a77ca6d21434f8dd}{FIRST\_GEM};
462         \textcolor{keywordflow}{if} (!\hyperlink{end_8c_ac012ffb07f14cbc249fb8b7ed980fe12}{gems}[i].\hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}) \{
463         \hyperlink{end_8c_ac012ffb07f14cbc249fb8b7ed980fe12}{gems}[i].\hyperlink{structvaluable__data_a0c5f9df0056287f8a8220d1d7a81781d}{count} = obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan};
464         \hyperlink{end_8c_ac012ffb07f14cbc249fb8b7ed980fe12}{gems}[i].\hyperlink{structvaluable__data_a3e054ff977428718f17e0f1a4aa6eef1}{typ} = obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp};
465         \} \textcolor{keywordflow}{else} \hyperlink{end_8c_ac012ffb07f14cbc249fb8b7ed980fe12}{gems}[i].\hyperlink{structvaluable__data_a0c5f9df0056287f8a8220d1d7a81781d}{count} += obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan};
466     \}
467     \textcolor{keywordflow}{return};
468 \}
\end{DoxyCode}
\hypertarget{end_8c_a227422494d61e1e8f8eccf16c0b29d1a}{\index{end.\+c@{end.\+c}!list\+\_\+genocided@{list\+\_\+genocided}}
\index{list\+\_\+genocided@{list\+\_\+genocided}!end.\+c@{end.\+c}}
\subsubsection[{list\+\_\+genocided}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void list\+\_\+genocided (
\begin{DoxyParamCaption}
\item[{char}]{defquery, }
\item[{{\bf boolean}}]{ask}
\end{DoxyParamCaption}
)}}\label{end_8c_a227422494d61e1e8f8eccf16c0b29d1a}


Definition at line 1063 of file end.\+c.



References buf, B\+U\+F\+S\+Z, create\+\_\+nhwindow, destroy\+\_\+nhwindow, display\+\_\+nhwindow, done\+\_\+stopprint, G\+\_\+\+G\+E\+N\+O\+D, G\+\_\+\+U\+N\+I\+Q, L\+O\+W\+\_\+\+P\+M, mons, N\+H\+W\+\_\+\+M\+E\+N\+U, num\+\_\+genocides(), putstr, Sprintf, Strcpy, T\+R\+U\+E, type\+\_\+is\+\_\+pname, and ynqchars.



Referenced by disclose().


\begin{DoxyCode}
1066 \{
1067     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i;
1068     \textcolor{keywordtype}{int} ngenocided;
1069     \textcolor{keywordtype}{char} c;
1070     \hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} klwin;
1071     \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
1072 
1073     ngenocided = \hyperlink{end_8c_a06164e5d987444efbe7ab260e2c13792}{num\_genocides}();
1074 
1075     \textcolor{comment}{/* genocided species list */}
1076     \textcolor{keywordflow}{if} (ngenocided != 0) \{
1077     c = ask ? yn\_function(\textcolor{stringliteral}{"Do you want a list of species genocided?"},
1078                   \hyperlink{decl_8h_a435ebb3887b48075c97ff301b972ba1b}{ynqchars}, defquery) : defquery;
1079     \textcolor{keywordflow}{if} (c == \textcolor{charliteral}{'q'}) \hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}++;
1080     \textcolor{keywordflow}{if} (c == \textcolor{charliteral}{'y'}) \{
1081         klwin = \hyperlink{winprocs_8h_aa13fb35379049d1836397492d10b6b0c}{create\_nhwindow}(\hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU});
1082         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(klwin, 0, \textcolor{stringliteral}{"Genocided species:"});
1083         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(klwin, 0, \textcolor{stringliteral}{""});
1084 
1085         \textcolor{keywordflow}{for} (i = \hyperlink{permonst_8h_aedc8e4764f8cf4d681f6f6226eeaa6af}{LOW\_PM}; i < NUMMONS; i++)
1086         \textcolor{keywordflow}{if} (\hyperlink{structmvitals}{mvitals}[i].mvflags & \hyperlink{monflag_8h_a89b3308e85c121e38c6bef7077e49fd8}{G\_GENOD}) \{
1087             \textcolor{keywordflow}{if} ((\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[i].geno & \hyperlink{monflag_8h_ab99532c9310183c20279ce79e7f594dd}{G\_UNIQ}) && i != PM\_HIGH\_PRIEST)
1088             \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(buf, \textcolor{stringliteral}{"%s%s"},
1089                 !\hyperlink{mondata_8h_a431e6a2710b289745d56debf83fafc33}{type\_is\_pname}(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[i]) ? \textcolor{stringliteral}{""} : \textcolor{stringliteral}{"the "},
1090                 \hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[i].mname);
1091             \textcolor{keywordflow}{else}
1092             \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(buf, makeplural(\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[i].mname));
1093             \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(klwin, 0, buf);
1094         \}
1095 
1096         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(klwin, 0, \textcolor{stringliteral}{""});
1097         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(buf, \textcolor{stringliteral}{"%d species genocided."}, ngenocided);
1098         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(klwin, 0, buf);
1099 
1100         \hyperlink{winprocs_8h_ac8e74d03fbb65b9f5651e63d79bebc60}{display\_nhwindow}(klwin, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
1101         \hyperlink{winprocs_8h_a77ac4f50de0eedeaead791812762c6a0}{destroy\_nhwindow}(klwin);
1102     \}
1103     \}
1104 \}
\end{DoxyCode}
\hypertarget{end_8c_afd2d0b7ad2213b47282aa1873a9eff0b}{\index{end.\+c@{end.\+c}!list\+\_\+vanquished@{list\+\_\+vanquished}}
\index{list\+\_\+vanquished@{list\+\_\+vanquished}!end.\+c@{end.\+c}}
\subsubsection[{list\+\_\+vanquished}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void list\+\_\+vanquished (
\begin{DoxyParamCaption}
\item[{char}]{defquery, }
\item[{{\bf boolean}}]{ask}
\end{DoxyParamCaption}
)}}\label{end_8c_afd2d0b7ad2213b47282aa1873a9eff0b}


Definition at line 977 of file end.\+c.



References buf, B\+U\+F\+S\+Z, create\+\_\+nhwindow, destroy\+\_\+nhwindow, display\+\_\+nhwindow, done\+\_\+stopprint, eos(), G\+\_\+\+U\+N\+I\+Q, L\+O\+W\+\_\+\+P\+M, permonst\+::mlevel, mons, N\+H\+W\+\_\+\+M\+E\+N\+U, plur, putstr, Sprintf, Strcpy, T\+R\+U\+E, type\+\_\+is\+\_\+pname, and ynqchars.



Referenced by disclose().


\begin{DoxyCode}
980 \{
981     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i, lev;
982     \textcolor{keywordtype}{int} ntypes = 0, max\_lev = 0, nkilled;
983     \textcolor{keywordtype}{long} total\_killed = 0L;
984     \textcolor{keywordtype}{char} c;
985     \hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} klwin;
986     \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
987 
988     \textcolor{comment}{/* get totals first */}
989     \textcolor{keywordflow}{for} (i = \hyperlink{permonst_8h_aedc8e4764f8cf4d681f6f6226eeaa6af}{LOW\_PM}; i < NUMMONS; i++) \{
990     \textcolor{keywordflow}{if} (\hyperlink{structmvitals}{mvitals}[i].died) ntypes++;
991     total\_killed += (long)\hyperlink{structmvitals}{mvitals}[i].died;
992     \textcolor{keywordflow}{if} (\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[i].mlevel > max\_lev) max\_lev = \hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[i].\hyperlink{structpermonst_aeed45d1ab54620bc7e5242b76f1c3c5f}{mlevel};
993     \}
994 
995     \textcolor{comment}{/* vanquished creatures list;}
996 \textcolor{comment}{     * includes all dead monsters, not just those killed by the player}
997 \textcolor{comment}{     */}
998     \textcolor{keywordflow}{if} (ntypes != 0) \{
999     c = ask ? yn\_function(\textcolor{stringliteral}{"Do you want an account of creatures vanquished?"},
1000                   \hyperlink{decl_8h_a435ebb3887b48075c97ff301b972ba1b}{ynqchars}, defquery) : defquery;
1001     \textcolor{keywordflow}{if} (c == \textcolor{charliteral}{'q'}) \hyperlink{end_8c_a395d73fe0b0ae9b7167dfabde4454d15}{done\_stopprint}++;
1002     \textcolor{keywordflow}{if} (c == \textcolor{charliteral}{'y'}) \{
1003         klwin = \hyperlink{winprocs_8h_aa13fb35379049d1836397492d10b6b0c}{create\_nhwindow}(\hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU});
1004         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(klwin, 0, \textcolor{stringliteral}{"Vanquished creatures:"});
1005         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(klwin, 0, \textcolor{stringliteral}{""});
1006 
1007         \textcolor{comment}{/* countdown by monster "toughness" */}
1008         \textcolor{keywordflow}{for} (lev = max\_lev; lev >= 0; lev--)
1009           \textcolor{keywordflow}{for} (i = \hyperlink{permonst_8h_aedc8e4764f8cf4d681f6f6226eeaa6af}{LOW\_PM}; i < NUMMONS; i++)
1010         \textcolor{keywordflow}{if} (\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[i].mlevel == lev && (nkilled = \hyperlink{structmvitals}{mvitals}[i].died) > 0) \{
1011             \textcolor{keywordflow}{if} ((\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[i].geno & \hyperlink{monflag_8h_ab99532c9310183c20279ce79e7f594dd}{G\_UNIQ}) && i != PM\_HIGH\_PRIEST) \{
1012             \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(buf, \textcolor{stringliteral}{"%s%s"},
1013                 !\hyperlink{mondata_8h_a431e6a2710b289745d56debf83fafc33}{type\_is\_pname}(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[i]) ? \textcolor{stringliteral}{"The "} : \textcolor{stringliteral}{""},
1014                 \hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[i].mname);
1015             \textcolor{keywordflow}{if} (nkilled > 1) \{
1016                 \textcolor{keywordflow}{switch} (nkilled) \{
1017                 \textcolor{keywordflow}{case} 2:  \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(\hyperlink{makedefs_8c_a72563303ed4b67f2a7dd9f2d15a01558}{eos}(buf),\textcolor{stringliteral}{" (twice)"});  \textcolor{keywordflow}{break};
1018                 \textcolor{keywordflow}{case} 3:  \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(\hyperlink{makedefs_8c_a72563303ed4b67f2a7dd9f2d15a01558}{eos}(buf),\textcolor{stringliteral}{" (thrice)"});  \textcolor{keywordflow}{break};
1019                 \textcolor{keywordflow}{default}: \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(\hyperlink{makedefs_8c_a72563303ed4b67f2a7dd9f2d15a01558}{eos}(buf),\textcolor{stringliteral}{" (%d time%s)"},
1020                          nkilled, \hyperlink{hack_8h_a6ed0ab51b12ebf31e060e3dd26394db0}{plur}(nkilled));
1021                      \textcolor{keywordflow}{break};
1022                 \}
1023             \}
1024             \} \textcolor{keywordflow}{else} \{
1025             \textcolor{comment}{/* trolls or undead might have come back,}
1026 \textcolor{comment}{               but we don't keep track of that */}
1027             \textcolor{keywordflow}{if} (nkilled == 1)
1028                 \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(buf, an(\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[i].mname));
1029             \textcolor{keywordflow}{else}
1030                 \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(buf, \textcolor{stringliteral}{"%d %s"},
1031                     nkilled, makeplural(\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[i].mname));
1032             \}
1033             \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(klwin, 0, buf);
1034         \}
1035         \textcolor{comment}{/*}
1036 \textcolor{comment}{         * if (Hallucination)}
1037 \textcolor{comment}{         *     putstr(klwin, 0, "and a partridge in a pear tree");}
1038 \textcolor{comment}{         */}
1039         \textcolor{keywordflow}{if} (ntypes > 1) \{
1040         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(klwin, 0, \textcolor{stringliteral}{""});
1041         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(buf, \textcolor{stringliteral}{"%ld creatures vanquished."}, total\_killed);
1042         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(klwin, 0, buf);
1043         \}
1044         \hyperlink{winprocs_8h_ac8e74d03fbb65b9f5651e63d79bebc60}{display\_nhwindow}(klwin, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
1045         \hyperlink{winprocs_8h_a77ac4f50de0eedeaead791812762c6a0}{destroy\_nhwindow}(klwin);
1046     \}
1047     \}
1048 \}
\end{DoxyCode}
\hypertarget{end_8c_a06164e5d987444efbe7ab260e2c13792}{\index{end.\+c@{end.\+c}!num\+\_\+genocides@{num\+\_\+genocides}}
\index{num\+\_\+genocides@{num\+\_\+genocides}!end.\+c@{end.\+c}}
\subsubsection[{num\+\_\+genocides}]{\setlength{\rightskip}{0pt plus 5cm}int num\+\_\+genocides (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{end_8c_a06164e5d987444efbe7ab260e2c13792}


Definition at line 1052 of file end.\+c.



References G\+\_\+\+G\+E\+N\+O\+D, and L\+O\+W\+\_\+\+P\+M.



Referenced by list\+\_\+genocided().


\begin{DoxyCode}
1053 \{
1054     \textcolor{keywordtype}{int} i, n = 0;
1055 
1056     \textcolor{keywordflow}{for} (i = \hyperlink{permonst_8h_aedc8e4764f8cf4d681f6f6226eeaa6af}{LOW\_PM}; i < NUMMONS; ++i)
1057     \textcolor{keywordflow}{if} (\hyperlink{structmvitals}{mvitals}[i].mvflags & \hyperlink{monflag_8h_a89b3308e85c121e38c6bef7077e49fd8}{G\_GENOD}) ++n;
1058 
1059     \textcolor{keywordflow}{return} n;
1060 \}
\end{DoxyCode}
\hypertarget{end_8c_af1a422a8c13793b2fb4f10f470f671b3}{\index{end.\+c@{end.\+c}!paniclog@{paniclog}}
\index{paniclog@{paniclog}!end.\+c@{end.\+c}}
\subsubsection[{paniclog}]{\setlength{\rightskip}{0pt plus 5cm}paniclog (
\begin{DoxyParamCaption}
\item[{\char`\"{}panic\char`\"{}}]{, }
\item[{{\bf buf}}]{}
\end{DoxyParamCaption}
)}}\label{end_8c_af1a422a8c13793b2fb4f10f470f671b3}


Referenced by done(), and savebones().

\hypertarget{end_8c_abf7447f6bb57e76e198834c4c9c3d2ae}{\index{end.\+c@{end.\+c}!raw\+\_\+print@{raw\+\_\+print}}
\index{raw\+\_\+print@{raw\+\_\+print}!end.\+c@{end.\+c}}
\subsubsection[{raw\+\_\+print}]{\setlength{\rightskip}{0pt plus 5cm}raw\+\_\+print (
\begin{DoxyParamCaption}
\item[{program\+\_\+state.\+gameover?\char`\"{}Postgame wrapup disrupted.\char`\"{}\+:!program\+\_\+state.\+something\+\_\+worth\+\_\+saving?\char`\"{}Program initialization has failed.\char`\"{}\+:\char`\"{}}]{Suddenly, }
\item[{the {\bf dungeon} collapses.\char`\"{}}]{}
\end{DoxyParamCaption}
)}}\label{end_8c_abf7447f6bb57e76e198834c4c9c3d2ae}


Referenced by done(), and V\+A\+\_\+\+D\+E\+C\+L().

\hypertarget{end_8c_aa722f3d191d7ceef6ed865f7e5bef5a9}{\index{end.\+c@{end.\+c}!raw\+\_\+print@{raw\+\_\+print}}
\index{raw\+\_\+print@{raw\+\_\+print}!end.\+c@{end.\+c}}
\subsubsection[{raw\+\_\+print}]{\setlength{\rightskip}{0pt plus 5cm}raw\+\_\+print (
\begin{DoxyParamCaption}
\item[{{\bf buf}}]{}
\end{DoxyParamCaption}
)}}\label{end_8c_aa722f3d191d7ceef6ed865f7e5bef5a9}
\hypertarget{end_8c_a52c3880708e4dba1dd140f134f468ced}{\index{end.\+c@{end.\+c}!savelife@{savelife}}
\index{savelife@{savelife}!end.\+c@{end.\+c}}
\subsubsection[{savelife}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void savelife (
\begin{DoxyParamCaption}
\item[{int}]{how}
\end{DoxyParamCaption}
)}}\label{end_8c_a52c3880708e4dba1dd140f134f468ced}


Definition at line 412 of file end.\+c.



References flag\+::botl, C\+H\+O\+K\+I\+N\+G, curs\+\_\+on\+\_\+u(), F\+A\+L\+S\+E, flags, H\+Unchanging, flag\+::move, multi, nomovemsg, N\+O\+N\+\_\+\+P\+M, Sick, T\+I\+M\+E\+O\+U\+T, T\+T\+\_\+\+L\+A\+V\+A, u, you\+::ugrave\+\_\+arise, you\+::uhp, you\+::uhpmax, you\+::uhunger, you\+::uswldtim, you\+::utrap, and you\+::utraptype.



Referenced by done().


\begin{DoxyCode}
414 \{
415     \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774f55da1afa57f6bfe3f26908249e35}{uswldtim} = 0;
416     \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a94468a400f14da123d5160f8eefd7641}{uhp} = \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ade36670a142a7d38051c74740d02002b}{uhpmax};
417     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a66fb9624339df35ac2f9f08fdccde6c9}{uhunger} < 500) \{
418         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a66fb9624339df35ac2f9f08fdccde6c9}{uhunger} = 500;
419         newuhs(\hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
420     \}
421     \textcolor{comment}{/* cure impending doom of sickness hero won't have time to fix */}
422     \textcolor{keywordflow}{if} ((\hyperlink{youprop_8h_a43a7dcd441841e6703322b8a2ea3b6a5}{Sick} & \hyperlink{prop_8h_a45ba202b05caf39795aeca91b0ae547e}{TIMEOUT}) == 1) \{
423         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.usick\_type = 0;
424         \hyperlink{youprop_8h_a43a7dcd441841e6703322b8a2ea3b6a5}{Sick} = 0;
425     \}
426     \textcolor{keywordflow}{if} (how == \hyperlink{hack_8h_a5500aa08941fd3a5fa31f7a5edfd588b}{CHOKING}) init\_uhunger();
427     \hyperlink{decl_8h_a03b001040702c25afae477b18b1692c3}{nomovemsg} = \textcolor{stringliteral}{"You survived that attempt on your life."};
428     \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_ae91760a156a6d1949297a53272137325}{move} = 0;
429     \textcolor{keywordflow}{if}(\hyperlink{decl_8h_a498406921f71695627a7107240f3ed7a}{multi} > 0) \hyperlink{decl_8h_a498406921f71695627a7107240f3ed7a}{multi} = 0; \textcolor{keywordflow}{else} \hyperlink{decl_8h_a498406921f71695627a7107240f3ed7a}{multi} = -1;
430     \textcolor{keywordflow}{if}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a7250d3b13a54b76d846b754a2a6f3fa6}{utrap} && \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a1753632ed4b3b8dea40466c1c92fce19}{utraptype} == \hyperlink{you_8h_a1d97aac071079ee345fc1a88536bf7d6}{TT\_LAVA}) \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a7250d3b13a54b76d846b754a2a6f3fa6}{utrap} = 0;
431     \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a51f16d01a910b52fdf0c05a44739f7d8}{botl} = 1;
432     \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af66a5ecd2d2a4f3443af9cc10fb928f3}{ugrave\_arise} = \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM};
433     \hyperlink{youprop_8h_ad22aa99623ea5d311b5cb897eb33e55d}{HUnchanging} = 0L;
434     \hyperlink{display_8c_a8edd142a64cff572d19c484164e93755}{curs\_on\_u}();
435 \}
\end{DoxyCode}
\hypertarget{end_8c_a18542f5e3b6a088e21d066026fd74b29}{\index{end.\+c@{end.\+c}!should\+\_\+query\+\_\+disclose\+\_\+option@{should\+\_\+query\+\_\+disclose\+\_\+option}}
\index{should\+\_\+query\+\_\+disclose\+\_\+option@{should\+\_\+query\+\_\+disclose\+\_\+option}!end.\+c@{end.\+c}}
\subsubsection[{should\+\_\+query\+\_\+disclose\+\_\+option}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} should\+\_\+query\+\_\+disclose\+\_\+option (
\begin{DoxyParamCaption}
\item[{int}]{category, }
\item[{char $\ast$}]{defquery}
\end{DoxyParamCaption}
)}}\label{end_8c_a18542f5e3b6a088e21d066026fd74b29}


Definition at line 313 of file end.\+c.



References D\+I\+S\+C\+L\+O\+S\+E\+\_\+\+N\+O\+\_\+\+W\+I\+T\+H\+O\+U\+T\+\_\+\+P\+R\+O\+M\+P\+T, D\+I\+S\+C\+L\+O\+S\+E\+\_\+\+P\+R\+O\+M\+P\+T\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+N\+O, D\+I\+S\+C\+L\+O\+S\+E\+\_\+\+P\+R\+O\+M\+P\+T\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+Y\+E\+S, D\+I\+S\+C\+L\+O\+S\+E\+\_\+\+Y\+E\+S\+\_\+\+W\+I\+T\+H\+O\+U\+T\+\_\+\+P\+R\+O\+M\+P\+T, disclosure\+\_\+options, flag\+::end\+\_\+disclose, F\+A\+L\+S\+E, flags, index(), N\+U\+M\+\_\+\+D\+I\+S\+C\+L\+O\+S\+U\+R\+E\+\_\+\+O\+P\+T\+I\+O\+N\+S, and T\+R\+U\+E.



Referenced by disclose().


\begin{DoxyCode}
316 \{
317     \textcolor{keywordtype}{int} idx;
318     \textcolor{keywordtype}{char} *dop = \hyperlink{uudecode_8c_ac82f3cc16110a05458f2b2483236afb7}{index}(\hyperlink{decl_8h_ad8b925abb7464ddb0d965c2963acbb2a}{disclosure\_options}, category);
319 
320     \textcolor{keywordflow}{if} (dop && defquery) \{
321     idx = dop - \hyperlink{decl_8h_ad8b925abb7464ddb0d965c2963acbb2a}{disclosure\_options};
322     \textcolor{keywordflow}{if} (idx < 0 || idx > (\hyperlink{flag_8h_a9d87bc8e08c67c315bd721f30186bbfc}{NUM\_DISCLOSURE\_OPTIONS} - 1)) \{
323         impossible(
324            \textcolor{stringliteral}{"should\_query\_disclose\_option: bad disclosure index %d %c"},
325                idx, category);
326         *defquery = \hyperlink{flag_8h_a1f89f6f16bba3fbbe388551339fdd1be}{DISCLOSE\_PROMPT\_DEFAULT\_YES};
327         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
328     \}
329     \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_ac299d5bda237844a96be2caf62346d60}{end\_disclose}[idx] == \hyperlink{flag_8h_ac2845587d395b11ccd55b721cde0a9e5}{DISCLOSE\_YES\_WITHOUT\_PROMPT})
       \{
330         *defquery = \textcolor{charliteral}{'y'};
331         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
332     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_ac299d5bda237844a96be2caf62346d60}{end\_disclose}[idx] == 
      \hyperlink{flag_8h_a8cb4c43c0446484771fa5c21fd63f1f7}{DISCLOSE\_NO\_WITHOUT\_PROMPT}) \{
333         *defquery = \textcolor{charliteral}{'n'};
334         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
335     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_ac299d5bda237844a96be2caf62346d60}{end\_disclose}[idx] == 
      \hyperlink{flag_8h_a1f89f6f16bba3fbbe388551339fdd1be}{DISCLOSE\_PROMPT\_DEFAULT\_YES}) \{
336         *defquery = \textcolor{charliteral}{'y'};
337         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
338     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_ac299d5bda237844a96be2caf62346d60}{end\_disclose}[idx] == 
      \hyperlink{flag_8h_ac154155d91f0f9d0b1f28087b8e4a97a}{DISCLOSE\_PROMPT\_DEFAULT\_NO}) \{
339         *defquery = \textcolor{charliteral}{'n'};
340         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
341     \}
342     \}
343     \textcolor{keywordflow}{if} (defquery)
344     impossible(\textcolor{stringliteral}{"should\_query\_disclose\_option: bad category %c"}, category);
345     \textcolor{keywordflow}{else}
346     impossible(\textcolor{stringliteral}{"should\_query\_disclose\_option: null defquery"});
347     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
348 \}
\end{DoxyCode}
\hypertarget{end_8c_a2626b1529b8c734fe1494d5290f2c8c0}{\index{end.\+c@{end.\+c}!sort\+\_\+valuables@{sort\+\_\+valuables}}
\index{sort\+\_\+valuables@{sort\+\_\+valuables}!end.\+c@{end.\+c}}
\subsubsection[{sort\+\_\+valuables}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void sort\+\_\+valuables (
\begin{DoxyParamCaption}
\item[{list}]{, }
\item[{int}]{size}
\end{DoxyParamCaption}
)}}\label{end_8c_a2626b1529b8c734fe1494d5290f2c8c0}


Definition at line 475 of file end.\+c.



References valuable\+\_\+data\+::count, and count.



Referenced by done().


\begin{DoxyCode}
478 \{
479     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i, j;
480     \textcolor{keyword}{struct }\hyperlink{structvaluable__data}{valuable\_data} ltmp;
481 
482     \textcolor{comment}{/* move greater quantities to the front of the list */}
483     \textcolor{keywordflow}{for} (i = 1; i < \hyperlink{structsize}{size}; i++) \{
484     \textcolor{keywordflow}{if} (list[i].\hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count} == 0) \textcolor{keywordflow}{continue};  \textcolor{comment}{/* empty slot */}
485     ltmp = list[i]; \textcolor{comment}{/* structure copy */}
486     \textcolor{keywordflow}{for} (j = i; j > 0; --j)
487         \textcolor{keywordflow}{if} (list[j-1].\hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count} >= ltmp.count) \textcolor{keywordflow}{break};
488         \textcolor{keywordflow}{else} \{
489         list[j] = list[j-1];
490         \}
491     list[j] = ltmp;
492     \}
493     \textcolor{keywordflow}{return};
494 \}
\end{DoxyCode}
\hypertarget{end_8c_a30ebaced48494e6e25f8833532ec17ca}{\index{end.\+c@{end.\+c}!terminate@{terminate}}
\index{terminate@{terminate}!end.\+c@{end.\+c}}
\subsubsection[{terminate}]{\setlength{\rightskip}{0pt plus 5cm}void terminate (
\begin{DoxyParamCaption}
\item[{int}]{status}
\end{DoxyParamCaption}
)}}\label{end_8c_a30ebaced48494e6e25f8833532ec17ca}


Definition at line 960 of file end.\+c.



References dlb\+\_\+cleanup, freedynamicdata(), getreturn(), nethack\+\_\+exit, sinfo\+::panicking, and program\+\_\+state.



Referenced by bail(), bwrite(), choose\+\_\+windows(), done(), dosave(), gnome\+\_\+exit\+\_\+nhwindows(), Main\+Wnd\+Proc(), restlevelfile(), and X11\+\_\+player\+\_\+selection().


\begin{DoxyCode}
962 \{
963 \textcolor{preprocessor}{#ifdef MAC}
964     \hyperlink{mttymain_8c_a6107dcc8e843df7242e4a1f17f1bc638}{getreturn}(\textcolor{stringliteral}{"to exit"});
965 \textcolor{preprocessor}{#endif}
966     \textcolor{comment}{/* don't bother to try to release memory if we're in panic mode, to}
967 \textcolor{comment}{       avoid trouble in case that happens to be due to memory problems */}
968     \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_a91c51d44f2b6e70f8a5d42a5b5218dcd}{program\_state}.\hyperlink{structsinfo_abf3b0c7bbd74f57595e53ab0eadd30e9}{panicking}) \{
969         \hyperlink{save_8c_a183c8baf3dc4b198167b5ae80a6a07dd}{freedynamicdata}();
970         \hyperlink{dlb_8h_a7affb22a15ff96189d7bfb23a12ab146}{dlb\_cleanup}();
971     \}
972 
973     \hyperlink{end_8c_ab463831cccd212b4e87e67ee3e8de2d5}{nethack\_exit}(status);
974 \}
\end{DoxyCode}
\hypertarget{end_8c_ab81e778f8bb01682d2a2d889c6b73fe3}{\index{end.\+c@{end.\+c}!V\+A\+\_\+\+D\+E\+C\+L@{V\+A\+\_\+\+D\+E\+C\+L}}
\index{V\+A\+\_\+\+D\+E\+C\+L@{V\+A\+\_\+\+D\+E\+C\+L}!end.\+c@{end.\+c}}
\subsubsection[{V\+A\+\_\+\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf panic} V\+A\+\_\+\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf const} char $\ast$}]{, }
\item[{V\+A\+\_\+\+I\+N\+I\+T(}]{str}
\end{DoxyParamCaption}
)}}\label{end_8c_ab81e778f8bb01682d2a2d889c6b73fe3}


Definition at line 253 of file end.\+c.



References exit\+\_\+nhwindows, iflags, raw\+\_\+print(), wait\+\_\+synch, and instance\+\_\+flags\+::window\+\_\+inited.


\begin{DoxyCode}
260                               \{
261         \hyperlink{end_8c_abf7447f6bb57e76e198834c4c9c3d2ae}{raw\_print}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)nOops..."});
262         \hyperlink{winprocs_8h_ab3dda14337c8ebd4fe496eab265a8483}{wait\_synch}(); \textcolor{comment}{/* make sure all pending output gets flushed */}
263         \hyperlink{winprocs_8h_ae874ce2b3810c39744ef196e24d5c9fc}{exit\_nhwindows}((\textcolor{keywordtype}{char} *)0);
264         \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_a2fc6c78c4c5f6e1d0027ac575135426f}{window\_inited} = 0; \textcolor{comment}{/* they're gone; force raw\_print()ing */}
265     \}
\end{DoxyCode}
\hypertarget{end_8c_a52ffaaff91c64705846d6e0f506195dc}{\index{end.\+c@{end.\+c}!V\+A\+\_\+\+E\+N\+D@{V\+A\+\_\+\+E\+N\+D}}
\index{V\+A\+\_\+\+E\+N\+D@{V\+A\+\_\+\+E\+N\+D}!end.\+c@{end.\+c}}
\subsubsection[{V\+A\+\_\+\+E\+N\+D}]{\setlength{\rightskip}{0pt plus 5cm}V\+A\+\_\+\+E\+N\+D (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{end_8c_a52ffaaff91c64705846d6e0f506195dc}
\hypertarget{end_8c_ae24904afb8c6ae20dfb2a38fca0e2660}{\index{end.\+c@{end.\+c}!Vsprintf@{Vsprintf}}
\index{Vsprintf@{Vsprintf}!end.\+c@{end.\+c}}
\subsubsection[{Vsprintf}]{\setlength{\rightskip}{0pt plus 5cm}Vsprintf (
\begin{DoxyParamCaption}
\item[{{\bf buf}}]{, }
\item[{str}]{, }
\item[{V\+A\+\_\+\+A\+R\+G\+S}]{}
\end{DoxyParamCaption}
)}}\label{end_8c_ae24904afb8c6ae20dfb2a38fca0e2660}


\subsection{Variable Documentation}
\hypertarget{end_8c_a16f54cba952b549755aeff67fcef047d}{\index{end.\+c@{end.\+c}!amulets@{amulets}}
\index{amulets@{amulets}!end.\+c@{end.\+c}}
\subsubsection[{amulets}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf valuable\+\_\+data} amulets\mbox{[}{\bf L\+A\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T}+1-\/{\bf F\+I\+R\+S\+T\+\_\+\+A\+M\+U\+L\+E\+T}\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}}\label{end_8c_a16f54cba952b549755aeff67fcef047d}


Definition at line 21 of file end.\+c.



Referenced by get\+\_\+valuables().

\hypertarget{end_8c_a17a3cc4328819f4785146308243b084c}{\index{end.\+c@{end.\+c}!deaths@{deaths}}
\index{deaths@{deaths}!end.\+c@{end.\+c}}
\subsubsection[{deaths}]{\setlength{\rightskip}{0pt plus 5cm}{\bf N\+E\+A\+R\+D\+A\+T\+A} {\bf const} char$\ast$ deaths\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}}\label{end_8c_a17a3cc4328819f4785146308243b084c}
{\bfseries Initial value\+:}
\begin{DoxyCode}
= \{     
    \textcolor{stringliteral}{"died"}, \textcolor{stringliteral}{"choked"}, \textcolor{stringliteral}{"poisoned"}, \textcolor{stringliteral}{"starvation"}, \textcolor{stringliteral}{"drowning"},
    \textcolor{stringliteral}{"burning"}, \textcolor{stringliteral}{"dissolving under the heat and pressure"},
    \textcolor{stringliteral}{"crushed"}, \textcolor{stringliteral}{"turned to stone"}, \textcolor{stringliteral}{"turned into slime"},
    \textcolor{stringliteral}{"genocided"}, \textcolor{stringliteral}{"panic"}, \textcolor{stringliteral}{"trickery"},
    \textcolor{stringliteral}{"quit"}, \textcolor{stringliteral}{"escaped"}, \textcolor{stringliteral}{"ascended"}
\}
\end{DoxyCode}


Definition at line 71 of file end.\+c.

\hypertarget{end_8c_a9b0ae9b5d06e599cad0a7d34f5337332}{\index{end.\+c@{end.\+c}!ends@{ends}}
\index{ends@{ends}!end.\+c@{end.\+c}}
\subsubsection[{ends}]{\setlength{\rightskip}{0pt plus 5cm}{\bf N\+E\+A\+R\+D\+A\+T\+A} {\bf const} char$\ast$ ends\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}}\label{end_8c_a9b0ae9b5d06e599cad0a7d34f5337332}
{\bfseries Initial value\+:}
\begin{DoxyCode}
= \{     
    \textcolor{stringliteral}{"died"}, \textcolor{stringliteral}{"choked"}, \textcolor{stringliteral}{"were poisoned"}, \textcolor{stringliteral}{"starved"}, \textcolor{stringliteral}{"drowned"},
    \textcolor{stringliteral}{"burned"}, \textcolor{stringliteral}{"dissolved in the lava"},
    \textcolor{stringliteral}{"were crushed"}, \textcolor{stringliteral}{"turned to stone"}, \textcolor{stringliteral}{"turned into slime"},
    \textcolor{stringliteral}{"were genocided"}, \textcolor{stringliteral}{"panicked"}, \textcolor{stringliteral}{"were tricked"},
    \textcolor{stringliteral}{"quit"}, \textcolor{stringliteral}{"escaped"}, \textcolor{stringliteral}{"ascended"}
\}
\end{DoxyCode}


Definition at line 79 of file end.\+c.

\hypertarget{end_8c_ac012ffb07f14cbc249fb8b7ed980fe12}{\index{end.\+c@{end.\+c}!gems@{gems}}
\index{gems@{gems}!end.\+c@{end.\+c}}
\subsubsection[{gems}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf valuable\+\_\+data} gems\mbox{[}L\+A\+S\+T\+\_\+\+G\+E\+M+1-\/{\bf F\+I\+R\+S\+T\+\_\+\+G\+E\+M}+1\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}}\label{end_8c_ac012ffb07f14cbc249fb8b7ed980fe12}


Definition at line 21 of file end.\+c.



Referenced by get\+\_\+valuables().

\hypertarget{end_8c_a1d71c4782ea92771fcdadd8723b4f450}{\index{end.\+c@{end.\+c}!killed\+\_\+by\+\_\+prefix@{killed\+\_\+by\+\_\+prefix}}
\index{killed\+\_\+by\+\_\+prefix@{killed\+\_\+by\+\_\+prefix}!end.\+c@{end.\+c}}
\subsubsection[{killed\+\_\+by\+\_\+prefix}]{\setlength{\rightskip}{0pt plus 5cm}{\bf const} char$\ast$ {\bf const} killed\+\_\+by\+\_\+prefix\mbox{[}$\,$\mbox{]}}}\label{end_8c_a1d71c4782ea92771fcdadd8723b4f450}


Definition at line 79 of file topten.\+c.



Referenced by gnome\+\_\+outrip().

\hypertarget{end_8c_acb10921d442ef668d677e5eb065e9bc5}{\index{end.\+c@{end.\+c}!valuables@{valuables}}
\index{valuables@{valuables}!end.\+c@{end.\+c}}
\subsubsection[{valuables}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf val\+\_\+list}  valuables\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}}\label{end_8c_acb10921d442ef668d677e5eb065e9bc5}
{\bfseries Initial value\+:}
\begin{DoxyCode}
= \{
    \{ \hyperlink{end_8c_ac012ffb07f14cbc249fb8b7ed980fe12}{gems},    \textcolor{keyword}{sizeof} \hyperlink{end_8c_ac012ffb07f14cbc249fb8b7ed980fe12}{gems} / \textcolor{keyword}{sizeof} *\hyperlink{end_8c_ac012ffb07f14cbc249fb8b7ed980fe12}{gems} \},
    \{ \hyperlink{end_8c_a16f54cba952b549755aeff67fcef047d}{amulets}, \textcolor{keyword}{sizeof} \hyperlink{end_8c_a16f54cba952b549755aeff67fcef047d}{amulets} / \textcolor{keyword}{sizeof} *\hyperlink{end_8c_a16f54cba952b549755aeff67fcef047d}{amulets} \},
    \{ 0, 0 \}
\}
\end{DoxyCode}


Referenced by done().

