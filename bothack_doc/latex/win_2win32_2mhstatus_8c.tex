\hypertarget{win_2win32_2mhstatus_8c}{\section{nethack/win/win32/mhstatus.c File Reference}
\label{win_2win32_2mhstatus_8c}\index{nethack/win/win32/mhstatus.\+c@{nethack/win/win32/mhstatus.\+c}}
}
{\ttfamily \#include \char`\"{}win\+M\+S.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhstatus.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhmsg.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhfont.\+h\char`\"{}}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structmswin__nethack__status__window}{mswin\+\_\+nethack\+\_\+status\+\_\+window}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{win_2win32_2mhstatus_8c_aea4af0f005b5d0eba03fdc08ec902cb7}{N\+H\+S\+W\+\_\+\+L\+I\+N\+E\+S}~2
\item 
\#define \hyperlink{win_2win32_2mhstatus_8c_a7823f335c74115317a5e71c645dae320}{M\+A\+X\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T}~\hyperlink{wingem1_8c_ab26c26cbf7a0c97d8960c3cfb413f882}{B\+U\+F\+S\+Z}
\item 
\#define \hyperlink{win_2win32_2mhstatus_8c_a1564e170b34fd563e1eb67cc0440e410}{D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+B\+G\+\_\+\+S\+T\+A\+T\+U\+S}~C\+O\+L\+O\+R\+\_\+\+W\+I\+N\+D\+O\+W
\item 
\#define \hyperlink{win_2win32_2mhstatus_8c_af20684e8bef1921c8eb5852330aa42b1}{D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+F\+G\+\_\+\+S\+T\+A\+T\+U\+S}~C\+O\+L\+O\+R\+\_\+\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \\*
\hyperlink{structmswin__nethack__status__window}{mswin\+\_\+nethack\+\_\+status\+\_\+window} \hyperlink{win_2win32_2mhstatus_8c_a9ca4560918a0d146b6002f63d54d30c3}{N\+H\+Status\+Window}
\item 
typedef struct \\*
\hyperlink{structmswin__nethack__status__window}{mswin\+\_\+nethack\+\_\+status\+\_\+window} $\ast$ \hyperlink{win_2win32_2mhstatus_8c_aeb0889e7a63d0e3137ccddc201bcbdcd}{P\+N\+H\+Status\+Window}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
L\+R\+E\+S\+U\+L\+T C\+A\+L\+L\+B\+A\+C\+K \hyperlink{win_2win32_2mhstatus_8c_af278d268d7b7579f8b3974a6743423c3}{Status\+Wnd\+Proc} (H\+W\+N\+D, \hyperlink{def__os2_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{U\+I\+N\+T}, W\+P\+A\+R\+A\+M, L\+P\+A\+R\+A\+M)
\item 
static void \hyperlink{win_2win32_2mhstatus_8c_a031d6bc0c12d7a25fad5be40b431f48d}{register\+\_\+status\+\_\+window\+\_\+class} (void)
\item 
H\+W\+N\+D \hyperlink{win_2win32_2mhstatus_8c_a9c3e8d6681671a0a19e6bd2fa94218e4}{mswin\+\_\+init\+\_\+status\+\_\+window} ()
\item 
void \hyperlink{win_2win32_2mhstatus_8c_afe3299b041f27146f5608077f0dcf5f2}{mswin\+\_\+status\+\_\+window\+\_\+size} (H\+W\+N\+D h\+Wnd, L\+P\+S\+I\+Z\+E sz)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static T\+C\+H\+A\+R \hyperlink{win_2win32_2mhstatus_8c_a82169a346a8ec1f3a8a134866cd80b48}{sz\+Status\+Window\+Class} \mbox{[}$\,$\mbox{]} = T\+E\+X\+T(\char`\"{}M\+S\+N\+H\+Status\+Wnd\+Class\char`\"{})
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{win_2win32_2mhstatus_8c_a1564e170b34fd563e1eb67cc0440e410}{\index{win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}!D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+B\+G\+\_\+\+S\+T\+A\+T\+U\+S@{D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+B\+G\+\_\+\+S\+T\+A\+T\+U\+S}}
\index{D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+B\+G\+\_\+\+S\+T\+A\+T\+U\+S@{D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+B\+G\+\_\+\+S\+T\+A\+T\+U\+S}!win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}}
\subsubsection[{D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+B\+G\+\_\+\+S\+T\+A\+T\+U\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+B\+G\+\_\+\+S\+T\+A\+T\+U\+S~C\+O\+L\+O\+R\+\_\+\+W\+I\+N\+D\+O\+W}}\label{win_2win32_2mhstatus_8c_a1564e170b34fd563e1eb67cc0440e410}


Definition at line 21 of file mhstatus.\+c.



Referenced by register\+\_\+status\+\_\+window\+\_\+class(), and Status\+Wnd\+Proc().

\hypertarget{win_2win32_2mhstatus_8c_af20684e8bef1921c8eb5852330aa42b1}{\index{win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}!D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+F\+G\+\_\+\+S\+T\+A\+T\+U\+S@{D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+F\+G\+\_\+\+S\+T\+A\+T\+U\+S}}
\index{D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+F\+G\+\_\+\+S\+T\+A\+T\+U\+S@{D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+F\+G\+\_\+\+S\+T\+A\+T\+U\+S}!win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}}
\subsubsection[{D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+F\+G\+\_\+\+S\+T\+A\+T\+U\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+F\+G\+\_\+\+S\+T\+A\+T\+U\+S~C\+O\+L\+O\+R\+\_\+\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T}}\label{win_2win32_2mhstatus_8c_af20684e8bef1921c8eb5852330aa42b1}


Definition at line 22 of file mhstatus.\+c.



Referenced by Status\+Wnd\+Proc().

\hypertarget{win_2win32_2mhstatus_8c_a7823f335c74115317a5e71c645dae320}{\index{win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}!M\+A\+X\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T@{M\+A\+X\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T}}
\index{M\+A\+X\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T@{M\+A\+X\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T}!win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}}
\subsubsection[{M\+A\+X\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+A\+X\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T~{\bf B\+U\+F\+S\+Z}}}\label{win_2win32_2mhstatus_8c_a7823f335c74115317a5e71c645dae320}


Definition at line 10 of file mhstatus.\+c.



Referenced by Status\+Wnd\+Proc().

\hypertarget{win_2win32_2mhstatus_8c_aea4af0f005b5d0eba03fdc08ec902cb7}{\index{win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}!N\+H\+S\+W\+\_\+\+L\+I\+N\+E\+S@{N\+H\+S\+W\+\_\+\+L\+I\+N\+E\+S}}
\index{N\+H\+S\+W\+\_\+\+L\+I\+N\+E\+S@{N\+H\+S\+W\+\_\+\+L\+I\+N\+E\+S}!win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}}
\subsubsection[{N\+H\+S\+W\+\_\+\+L\+I\+N\+E\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\+H\+S\+W\+\_\+\+L\+I\+N\+E\+S~2}}\label{win_2win32_2mhstatus_8c_aea4af0f005b5d0eba03fdc08ec902cb7}


Definition at line 9 of file mhstatus.\+c.



Referenced by mswin\+\_\+status\+\_\+window\+\_\+size(), and Status\+Wnd\+Proc().



\subsection{Typedef Documentation}
\hypertarget{win_2win32_2mhstatus_8c_a9ca4560918a0d146b6002f63d54d30c3}{\index{win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}!N\+H\+Status\+Window@{N\+H\+Status\+Window}}
\index{N\+H\+Status\+Window@{N\+H\+Status\+Window}!win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}}
\subsubsection[{N\+H\+Status\+Window}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf mswin\+\_\+nethack\+\_\+status\+\_\+window}  {\bf N\+H\+Status\+Window}}}\label{win_2win32_2mhstatus_8c_a9ca4560918a0d146b6002f63d54d30c3}
\hypertarget{win_2win32_2mhstatus_8c_aeb0889e7a63d0e3137ccddc201bcbdcd}{\index{win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}!P\+N\+H\+Status\+Window@{P\+N\+H\+Status\+Window}}
\index{P\+N\+H\+Status\+Window@{P\+N\+H\+Status\+Window}!win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}}
\subsubsection[{P\+N\+H\+Status\+Window}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf mswin\+\_\+nethack\+\_\+status\+\_\+window} $\ast$ {\bf P\+N\+H\+Status\+Window}}}\label{win_2win32_2mhstatus_8c_aeb0889e7a63d0e3137ccddc201bcbdcd}


\subsection{Function Documentation}
\hypertarget{win_2win32_2mhstatus_8c_a9c3e8d6681671a0a19e6bd2fa94218e4}{\index{win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}!mswin\+\_\+init\+\_\+status\+\_\+window@{mswin\+\_\+init\+\_\+status\+\_\+window}}
\index{mswin\+\_\+init\+\_\+status\+\_\+window@{mswin\+\_\+init\+\_\+status\+\_\+window}!win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}}
\subsubsection[{mswin\+\_\+init\+\_\+status\+\_\+window}]{\setlength{\rightskip}{0pt plus 5cm}H\+W\+N\+D mswin\+\_\+init\+\_\+status\+\_\+window (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{win_2win32_2mhstatus_8c_a9c3e8d6681671a0a19e6bd2fa94218e4}


Definition at line 24 of file mhstatus.\+c.



References F\+A\+L\+S\+E, Get\+N\+H\+App(), malloc(), mswin\+\_\+nethack\+\_\+status\+\_\+window\+::nhstat\+\_\+format, N\+H\+S\+T\+A\+T\+\_\+\+L\+I\+N\+E\+S\+\_\+4, N\+U\+L\+L, panic(), register\+\_\+status\+\_\+window\+\_\+class(), and sz\+Status\+Window\+Class.


\begin{DoxyCode}
24                                  \{
25     \textcolor{keyword}{static} \textcolor{keywordtype}{int} run\_once = 0;
26     HWND ret;
27     \hyperlink{structmswin__nethack__status__window}{NHStatusWindow}* data;
28 
29     \textcolor{keywordflow}{if}( !run\_once ) \{
30         \hyperlink{win_2win32_2mhstatus_8c_a031d6bc0c12d7a25fad5be40b431f48d}{register\_status\_window\_class}( );
31         run\_once = 1;
32     \}
33     
34     ret = CreateWindow(                                
35             \hyperlink{win_2win32_2mhstatus_8c_a82169a346a8ec1f3a8a134866cd80b48}{szStatusWindowClass},
36             \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL},
37             WS\_CHILD | WS\_DISABLED | WS\_CLIPSIBLINGS,
38             0,  \textcolor{comment}{/* x position */}
39             0,  \textcolor{comment}{/* y position */}
40             0,  \textcolor{comment}{/* x-size - we will set it later */}
41             0,  \textcolor{comment}{/* y-size - we will set it later */}
42             \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->hMainWnd,
43             \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL},
44             \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->hApp,
45             \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} );
46     \textcolor{keywordflow}{if}( !ret ) \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"Cannot create status window"});
47     
48     EnableWindow(ret, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
49 
50     data = (\hyperlink{sys_2wince_2mhstatus_8c_aeb0889e7a63d0e3137ccddc201bcbdcd}{PNHStatusWindow})\hyperlink{winproto_8h_ab028c02ac00afc0c1d3c568ccad68869}{malloc}(\textcolor{keyword}{sizeof}(\hyperlink{structmswin__nethack__status__window}{NHStatusWindow}));
51     \textcolor{keywordflow}{if}( !data ) \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"out of memory"});
52 
53     ZeroMemory(data, \textcolor{keyword}{sizeof}(\hyperlink{structmswin__nethack__status__window}{NHStatusWindow}));
54     SetWindowLong(ret, GWL\_USERDATA, (LONG)data);
55     \textcolor{keywordflow}{return} ret;
56 \}
\end{DoxyCode}
\hypertarget{win_2win32_2mhstatus_8c_afe3299b041f27146f5608077f0dcf5f2}{\index{win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}!mswin\+\_\+status\+\_\+window\+\_\+size@{mswin\+\_\+status\+\_\+window\+\_\+size}}
\index{mswin\+\_\+status\+\_\+window\+\_\+size@{mswin\+\_\+status\+\_\+window\+\_\+size}!win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}}
\subsubsection[{mswin\+\_\+status\+\_\+window\+\_\+size}]{\setlength{\rightskip}{0pt plus 5cm}void mswin\+\_\+status\+\_\+window\+\_\+size (
\begin{DoxyParamCaption}
\item[{H\+W\+N\+D}]{h\+Wnd, }
\item[{L\+P\+S\+I\+Z\+E}]{sz}
\end{DoxyParamCaption}
)}}\label{win_2win32_2mhstatus_8c_afe3299b041f27146f5608077f0dcf5f2}


Definition at line 154 of file mhstatus.\+c.



References A\+T\+R\+\_\+\+N\+O\+N\+E, F\+A\+L\+S\+E, mswin\+\_\+get\+\_\+font(), mswin\+\_\+nethack\+\_\+status\+\_\+window\+::nhstat\+\_\+format, N\+H\+S\+T\+A\+T\+\_\+\+L\+I\+N\+E\+S\+\_\+2, N\+H\+S\+T\+A\+T\+\_\+\+L\+I\+N\+E\+S\+\_\+4, N\+H\+S\+W\+\_\+\+L\+I\+N\+E\+S, and N\+H\+W\+\_\+\+S\+T\+A\+T\+U\+S.


\begin{DoxyCode}
155 \{
156     TEXTMETRIC \hyperlink{structtm}{tm};
157     HGDIOBJ saveFont;
158     HDC hdc;
159     \hyperlink{structmswin__nethack__status__window}{PNHStatusWindow} data;
160     RECT rt;
161     GetWindowRect(hWnd, &rt);
162     sz->cx = rt.right - rt.left;
163     sz->cy = rt.bottom - rt.top;
164 
165     data = (\hyperlink{sys_2wince_2mhstatus_8c_aeb0889e7a63d0e3137ccddc201bcbdcd}{PNHStatusWindow})GetWindowLong(hWnd, GWL\_USERDATA);
166     \textcolor{keywordflow}{if}(data) \{
167         hdc = GetDC(hWnd);
168         saveFont = SelectObject(hdc, \hyperlink{sys_2wince_2mhfont_8c_a480013e685b85460be07910c65a1ef51}{mswin\_get\_font}(\hyperlink{wintype_8h_a8ed5b99ab7f854ace5f67f89aaae5404}{NHW\_STATUS}, 
      \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE}, hdc, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}));
169         GetTextMetrics(hdc, &tm);
170 
171         sz->cy = tm.tmHeight * \hyperlink{win_2win32_2mhstatus_8c_aea4af0f005b5d0eba03fdc08ec902cb7}{NHSW\_LINES};
172 
173         SelectObject(hdc, saveFont);
174         ReleaseDC(hWnd, hdc);
175     \}
176 \}
\end{DoxyCode}
\hypertarget{win_2win32_2mhstatus_8c_a031d6bc0c12d7a25fad5be40b431f48d}{\index{win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}!register\+\_\+status\+\_\+window\+\_\+class@{register\+\_\+status\+\_\+window\+\_\+class}}
\index{register\+\_\+status\+\_\+window\+\_\+class@{register\+\_\+status\+\_\+window\+\_\+class}!win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}}
\subsubsection[{register\+\_\+status\+\_\+window\+\_\+class}]{\setlength{\rightskip}{0pt plus 5cm}void register\+\_\+status\+\_\+window\+\_\+class (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{win_2win32_2mhstatus_8c_a031d6bc0c12d7a25fad5be40b431f48d}


Definition at line 58 of file mhstatus.\+c.



References D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+B\+G\+\_\+\+S\+T\+A\+T\+U\+S, Get\+N\+H\+App(), mswin\+\_\+nhwindow\+\_\+app\+::h\+App, N\+U\+L\+L, status\+\_\+bg\+\_\+brush, Status\+Wnd\+Proc(), S\+Y\+S\+C\+L\+R\+\_\+\+T\+O\+\_\+\+B\+R\+U\+S\+H, and sz\+Status\+Window\+Class.



Referenced by mswin\+\_\+init\+\_\+status\+\_\+window().


\begin{DoxyCode}
59 \{
60     WNDCLASS wcex;
61     ZeroMemory( &wcex, \textcolor{keyword}{sizeof}(wcex));
62 
63     wcex.style          = CS\_NOCLOSE;
64     wcex.lpfnWndProc    = (WNDPROC)\hyperlink{sys_2wince_2mhstatus_8c_af278d268d7b7579f8b3974a6743423c3}{StatusWndProc};
65     wcex.cbClsExtra     = 0;
66     wcex.cbWndExtra     = 0;
67     wcex.hInstance      = \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_ae3a365ad66195c8e1d915242897c3f24}{hApp};
68     wcex.hIcon          = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
69     wcex.hCursor        = LoadCursor(\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, IDC\_ARROW);
70     wcex.hbrBackground  = \hyperlink{win_2win32_2mswproc_8c_a15a5e3bfa73f9f8f4117b568a18c1d81}{status\_bg\_brush} 
71         ? \hyperlink{win_2win32_2mswproc_8c_a15a5e3bfa73f9f8f4117b568a18c1d81}{status\_bg\_brush} : \hyperlink{mhcolor_8h_ababa49ed211db00c071857fdd982ece1}{SYSCLR\_TO\_BRUSH}(
      \hyperlink{win_2win32_2mhstatus_8c_a1564e170b34fd563e1eb67cc0440e410}{DEFAULT\_COLOR\_BG\_STATUS});
72     wcex.lpszMenuName   = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
73     wcex.lpszClassName  = \hyperlink{win_2win32_2mhstatus_8c_a82169a346a8ec1f3a8a134866cd80b48}{szStatusWindowClass};
74 
75     RegisterClass(&wcex);
76 \}
\end{DoxyCode}
\hypertarget{win_2win32_2mhstatus_8c_af278d268d7b7579f8b3974a6743423c3}{\index{win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}!Status\+Wnd\+Proc@{Status\+Wnd\+Proc}}
\index{Status\+Wnd\+Proc@{Status\+Wnd\+Proc}!win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}}
\subsubsection[{Status\+Wnd\+Proc}]{\setlength{\rightskip}{0pt plus 5cm}L\+R\+E\+S\+U\+L\+T C\+A\+L\+L\+B\+A\+C\+K Status\+Wnd\+Proc (
\begin{DoxyParamCaption}
\item[{H\+W\+N\+D}]{h\+Wnd, }
\item[{{\bf U\+I\+N\+T}}]{message, }
\item[{W\+P\+A\+R\+A\+M}]{w\+Param, }
\item[{L\+P\+A\+R\+A\+M}]{l\+Param}
\end{DoxyParamCaption}
)}}\label{win_2win32_2mhstatus_8c_af278d268d7b7579f8b3974a6743423c3}


Definition at line 79 of file mhstatus.\+c.



References A\+T\+R\+\_\+\+N\+O\+N\+E, B\+U\+F\+S\+Z, D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+B\+G\+\_\+\+S\+T\+A\+T\+U\+S, D\+E\+F\+A\+U\+L\+T\+\_\+\+C\+O\+L\+O\+R\+\_\+\+F\+G\+\_\+\+S\+T\+A\+T\+U\+S, F\+A\+L\+S\+E, free(), Get\+N\+H\+App(), mswin\+\_\+nethack\+\_\+status\+\_\+window\+::index, M\+A\+X\+W\+I\+N\+D\+O\+W\+T\+E\+X\+T, M\+S\+N\+H\+\_\+\+M\+S\+G\+\_\+\+C\+L\+E\+A\+R\+\_\+\+W\+I\+N\+D\+O\+W, M\+S\+N\+H\+\_\+\+M\+S\+G\+\_\+\+P\+U\+T\+S\+T\+R, mswin\+\_\+get\+\_\+font(), N\+H\+\_\+\+A2\+W, N\+H\+S\+W\+\_\+\+L\+I\+N\+E\+S, N\+H\+W\+\_\+\+S\+T\+A\+T\+U\+S, N\+U\+L\+L, S\+I\+Z\+E, status\+\_\+bg\+\_\+brush, status\+\_\+bg\+\_\+color, status\+\_\+fg\+\_\+brush, status\+\_\+fg\+\_\+color, mswin\+\_\+nhmsg\+\_\+putstr\+::text, T\+R\+U\+E, mswin\+\_\+nethack\+\_\+status\+\_\+window\+::window\+\_\+text, and W\+M\+\_\+\+M\+S\+N\+H\+\_\+\+C\+O\+M\+M\+A\+N\+D.


\begin{DoxyCode}
80 \{
81     RECT rt;
82     PAINTSTRUCT ps;
83     HDC hdc;
84     \hyperlink{structmswin__nethack__status__window}{PNHStatusWindow} data;
85     
86     data = (\hyperlink{sys_2wince_2mhstatus_8c_aeb0889e7a63d0e3137ccddc201bcbdcd}{PNHStatusWindow})GetWindowLong(hWnd, GWL\_USERDATA);
87     \textcolor{keywordflow}{switch} (message) 
88     \{
89     \textcolor{keywordflow}{case} \hyperlink{sys_2wince_2mhmsg_8h_a55eac656fabe0d462816201ac756eab6}{WM\_MSNH\_COMMAND}: \{
90         \textcolor{keywordflow}{switch}( wParam ) \{
91         \textcolor{keywordflow}{case} \hyperlink{sys_2wince_2mhmsg_8h_a483b8d3a386f1c5d76da1dff6ed549a8}{MSNH\_MSG\_PUTSTR}: \{
92             \hyperlink{structmswin__nhmsg__putstr}{PMSNHMsgPutstr} msg\_data = (\hyperlink{sys_2wince_2mhmsg_8h_ad6db1f0e39180f07f00581a93dbdd846}{PMSNHMsgPutstr})lParam;
93             strncpy(data->\hyperlink{structmswin__nethack__status__window_afc39505634916f0cd93ca59544203033}{window\_text}[data->\hyperlink{structmswin__nethack__status__window_a545efdce058ea9768cc5ffedc65760fe}{index}], msg\_data->
      \hyperlink{structmswin__nhmsg__putstr_a27f09d7286c01fe17c1289761b63502e}{text}, 
94                     \hyperlink{win_2win32_2mhstatus_8c_a7823f335c74115317a5e71c645dae320}{MAXWINDOWTEXT});
95             strncat(data->\hyperlink{structmswin__nethack__status__window_afc39505634916f0cd93ca59544203033}{window\_text}[data->\hyperlink{structmswin__nethack__status__window_a545efdce058ea9768cc5ffedc65760fe}{index}], \textcolor{stringliteral}{"\(\backslash\)n"}, 
96                     \hyperlink{win_2win32_2mhstatus_8c_a7823f335c74115317a5e71c645dae320}{MAXWINDOWTEXT}-strlen(data->\hyperlink{structmswin__nethack__status__window_afc39505634916f0cd93ca59544203033}{window\_text}[data->
      \hyperlink{structmswin__nethack__status__window_a545efdce058ea9768cc5ffedc65760fe}{index}]));
97             data->\hyperlink{structmswin__nethack__status__window_a545efdce058ea9768cc5ffedc65760fe}{index} = (data->\hyperlink{structmswin__nethack__status__window_a545efdce058ea9768cc5ffedc65760fe}{index}+1) % \hyperlink{win_2win32_2mhstatus_8c_aea4af0f005b5d0eba03fdc08ec902cb7}{NHSW\_LINES};
98             InvalidateRect(hWnd, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
99             \textcolor{keywordflow}{break};
100         \}
101         \textcolor{keywordflow}{case} \hyperlink{sys_2wince_2mhmsg_8h_a569048188a906452ebb6b755cd9ac662}{MSNH\_MSG\_CLEAR\_WINDOW}:
102             data->\hyperlink{structmswin__nethack__status__window_a545efdce058ea9768cc5ffedc65760fe}{index} = 0;
103             ZeroMemory(data->\hyperlink{structmswin__nethack__status__window_afc39505634916f0cd93ca59544203033}{window\_text}, \textcolor{keyword}{sizeof}(data->\hyperlink{structmswin__nethack__status__window_afc39505634916f0cd93ca59544203033}{window\_text}));
104             InvalidateRect(hWnd, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
105             \textcolor{keywordflow}{break};
106         \}
107     \} \textcolor{keywordflow}{break};
108 
109     \textcolor{keywordflow}{case} WM\_PAINT: \{
110             \textcolor{keywordtype}{int} i;
111             \hyperlink{global_8h_afd2537d19a3cb6556b0f727580ec6ee7}{SIZE} sz;
112             HGDIOBJ oldFont;
113             TCHAR wbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
114             COLORREF OldBg, OldFg;
115 
116             hdc = BeginPaint(hWnd, &ps);
117             GetClientRect(hWnd, &rt);
118             
119             oldFont = SelectObject(hdc, \hyperlink{sys_2wince_2mhfont_8c_a480013e685b85460be07910c65a1ef51}{mswin\_get\_font}(\hyperlink{wintype_8h_a8ed5b99ab7f854ace5f67f89aaae5404}{NHW\_STATUS}, 
      \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE}, hdc, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}));
120 
121             OldBg = SetBkColor(hdc, \hyperlink{win_2win32_2mswproc_8c_a15a5e3bfa73f9f8f4117b568a18c1d81}{status\_bg\_brush} 
122                 ? \hyperlink{win_2win32_2mswproc_8c_a4d5bcc71748d0b3214bf5677d1aef6c7}{status\_bg\_color} : (COLORREF)GetSysColor(
      \hyperlink{win_2win32_2mhstatus_8c_a1564e170b34fd563e1eb67cc0440e410}{DEFAULT\_COLOR\_BG\_STATUS}));
123             OldFg = SetTextColor(hdc, \hyperlink{win_2win32_2mswproc_8c_aac75529dceea289cfd3b7b82d9065980}{status\_fg\_brush} 
124                 ? \hyperlink{win_2win32_2mswproc_8c_a839e953409a281e2f9e90b7b878da3b9}{status\_fg\_color} : (COLORREF)GetSysColor(
      \hyperlink{win_2win32_2mhstatus_8c_af20684e8bef1921c8eb5852330aa42b1}{DEFAULT\_COLOR\_FG\_STATUS}));
125             
126             \textcolor{keywordflow}{for}(i=0; i<\hyperlink{win_2win32_2mhstatus_8c_aea4af0f005b5d0eba03fdc08ec902cb7}{NHSW\_LINES}; i++ ) \{
127                 GetTextExtentPoint32(hdc, \hyperlink{wceconf_8h_a2ed36c9ee770dfe5f2d0e3088a62adad}{NH\_A2W}(data->\hyperlink{structmswin__nethack__status__window_afc39505634916f0cd93ca59544203033}{window\_text}[i], wbuf, \textcolor{keyword}{sizeof}(wbuf))
      , strlen(data->\hyperlink{structmswin__nethack__status__window_afc39505634916f0cd93ca59544203033}{window\_text}[i]), &sz);
128                 \hyperlink{wceconf_8h_a2ed36c9ee770dfe5f2d0e3088a62adad}{NH\_A2W}(data->\hyperlink{structmswin__nethack__status__window_afc39505634916f0cd93ca59544203033}{window\_text}[i], wbuf, \hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ});
129                 DrawText(hdc, wbuf, strlen(data->\hyperlink{structmswin__nethack__status__window_afc39505634916f0cd93ca59544203033}{window\_text}[i]), &rt, DT\_LEFT | DT\_END\_ELLIPSIS
      );
130                 rt.top += sz.cy;
131             \}
132 
133             SelectObject(hdc, oldFont);
134             SetTextColor (hdc, OldFg);
135             SetBkColor (hdc, OldBg);
136             EndPaint(hWnd, &ps);
137         \} \textcolor{keywordflow}{break};
138 
139     \textcolor{keywordflow}{case} WM\_DESTROY:
140         \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}(data);
141         SetWindowLong(hWnd, GWL\_USERDATA, (LONG)0);
142         \textcolor{keywordflow}{break};
143 
144     \textcolor{keywordflow}{case} WM\_SETFOCUS:
145         SetFocus(\hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->hMainWnd);
146         \textcolor{keywordflow}{break};
147 
148     \textcolor{keywordflow}{default}:
149         \textcolor{keywordflow}{return} DefWindowProc(hWnd, message, wParam, lParam);
150    \}
151    \textcolor{keywordflow}{return} 0;
152 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{win_2win32_2mhstatus_8c_a82169a346a8ec1f3a8a134866cd80b48}{\index{win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}!sz\+Status\+Window\+Class@{sz\+Status\+Window\+Class}}
\index{sz\+Status\+Window\+Class@{sz\+Status\+Window\+Class}!win/win32/mhstatus.\+c@{win/win32/mhstatus.\+c}}
\subsubsection[{sz\+Status\+Window\+Class}]{\setlength{\rightskip}{0pt plus 5cm}T\+C\+H\+A\+R sz\+Status\+Window\+Class\mbox{[}$\,$\mbox{]} = T\+E\+X\+T(\char`\"{}M\+S\+N\+H\+Status\+Wnd\+Class\char`\"{})\hspace{0.3cm}{\ttfamily [static]}}}\label{win_2win32_2mhstatus_8c_a82169a346a8ec1f3a8a134866cd80b48}


Definition at line 17 of file mhstatus.\+c.



Referenced by mswin\+\_\+init\+\_\+status\+\_\+window(), and register\+\_\+status\+\_\+window\+\_\+class().

