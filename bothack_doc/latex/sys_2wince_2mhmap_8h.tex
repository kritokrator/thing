\hypertarget{sys_2wince_2mhmap_8h}{\section{nethack/sys/wince/mhmap.h File Reference}
\label{sys_2wince_2mhmap_8h}\index{nethack/sys/wince/mhmap.\+h@{nethack/sys/wince/mhmap.\+h}}
}
{\ttfamily \#include \char`\"{}win\+M\+S.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}config.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}global.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{sys_2wince_2mhmap_8h_ad50b7e1f32b9504ad8626095b97528c6}{R\+O\+G\+U\+E\+\_\+\+L\+E\+V\+E\+L\+\_\+\+M\+A\+P\+\_\+\+M\+O\+D\+E}~\hyperlink{winprocs_8h_ae0d763de7f5d48bd0b4f7c3fda36eebb}{M\+A\+P\+\_\+\+M\+O\+D\+E\+\_\+\+A\+S\+C\+I\+I12x16}
\item 
\#define \hyperlink{sys_2wince_2mhmap_8h_aa287a33b047f21323504be68f4c23d56}{D\+E\+F\+\_\+\+C\+L\+I\+P\+A\+R\+O\+U\+N\+D\+\_\+\+M\+A\+R\+G\+I\+N}~5
\item 
\#define \hyperlink{sys_2wince_2mhmap_8h_af4555b8e44bc2dcf2864ffda2812140a}{D\+E\+F\+\_\+\+C\+L\+I\+P\+A\+R\+O\+U\+N\+D\+\_\+\+A\+M\+O\+U\+N\+T}~1
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
H\+W\+N\+D \hyperlink{sys_2wince_2mhmap_8h_abded2548566a94f9de0497ad3447913d}{mswin\+\_\+init\+\_\+map\+\_\+window} (void)
\item 
void \hyperlink{sys_2wince_2mhmap_8h_a02cf8b2ed4e7d6cbd2355d759ad547ef}{mswin\+\_\+map\+\_\+stretch} (H\+W\+N\+D h\+Wnd, L\+P\+S\+I\+Z\+E lpsz, B\+O\+O\+L redraw)
\item 
int \hyperlink{sys_2wince_2mhmap_8h_a3cc8c75ab01843325bb704d173373fd4}{mswin\+\_\+map\+\_\+mode} (H\+W\+N\+D h\+Wnd, int mode)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{sys_2wince_2mhmap_8h_af4555b8e44bc2dcf2864ffda2812140a}{\index{sys/wince/mhmap.\+h@{sys/wince/mhmap.\+h}!D\+E\+F\+\_\+\+C\+L\+I\+P\+A\+R\+O\+U\+N\+D\+\_\+\+A\+M\+O\+U\+N\+T@{D\+E\+F\+\_\+\+C\+L\+I\+P\+A\+R\+O\+U\+N\+D\+\_\+\+A\+M\+O\+U\+N\+T}}
\index{D\+E\+F\+\_\+\+C\+L\+I\+P\+A\+R\+O\+U\+N\+D\+\_\+\+A\+M\+O\+U\+N\+T@{D\+E\+F\+\_\+\+C\+L\+I\+P\+A\+R\+O\+U\+N\+D\+\_\+\+A\+M\+O\+U\+N\+T}!sys/wince/mhmap.\+h@{sys/wince/mhmap.\+h}}
\subsubsection[{D\+E\+F\+\_\+\+C\+L\+I\+P\+A\+R\+O\+U\+N\+D\+\_\+\+A\+M\+O\+U\+N\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+E\+F\+\_\+\+C\+L\+I\+P\+A\+R\+O\+U\+N\+D\+\_\+\+A\+M\+O\+U\+N\+T~1}}\label{sys_2wince_2mhmap_8h_af4555b8e44bc2dcf2864ffda2812140a}


Definition at line 19 of file mhmap.\+h.



Referenced by mswin\+\_\+init\+\_\+nhwindows().

\hypertarget{sys_2wince_2mhmap_8h_aa287a33b047f21323504be68f4c23d56}{\index{sys/wince/mhmap.\+h@{sys/wince/mhmap.\+h}!D\+E\+F\+\_\+\+C\+L\+I\+P\+A\+R\+O\+U\+N\+D\+\_\+\+M\+A\+R\+G\+I\+N@{D\+E\+F\+\_\+\+C\+L\+I\+P\+A\+R\+O\+U\+N\+D\+\_\+\+M\+A\+R\+G\+I\+N}}
\index{D\+E\+F\+\_\+\+C\+L\+I\+P\+A\+R\+O\+U\+N\+D\+\_\+\+M\+A\+R\+G\+I\+N@{D\+E\+F\+\_\+\+C\+L\+I\+P\+A\+R\+O\+U\+N\+D\+\_\+\+M\+A\+R\+G\+I\+N}!sys/wince/mhmap.\+h@{sys/wince/mhmap.\+h}}
\subsubsection[{D\+E\+F\+\_\+\+C\+L\+I\+P\+A\+R\+O\+U\+N\+D\+\_\+\+M\+A\+R\+G\+I\+N}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+E\+F\+\_\+\+C\+L\+I\+P\+A\+R\+O\+U\+N\+D\+\_\+\+M\+A\+R\+G\+I\+N~5}}\label{sys_2wince_2mhmap_8h_aa287a33b047f21323504be68f4c23d56}


Definition at line 18 of file mhmap.\+h.



Referenced by mswin\+\_\+init\+\_\+nhwindows().

\hypertarget{sys_2wince_2mhmap_8h_ad50b7e1f32b9504ad8626095b97528c6}{\index{sys/wince/mhmap.\+h@{sys/wince/mhmap.\+h}!R\+O\+G\+U\+E\+\_\+\+L\+E\+V\+E\+L\+\_\+\+M\+A\+P\+\_\+\+M\+O\+D\+E@{R\+O\+G\+U\+E\+\_\+\+L\+E\+V\+E\+L\+\_\+\+M\+A\+P\+\_\+\+M\+O\+D\+E}}
\index{R\+O\+G\+U\+E\+\_\+\+L\+E\+V\+E\+L\+\_\+\+M\+A\+P\+\_\+\+M\+O\+D\+E@{R\+O\+G\+U\+E\+\_\+\+L\+E\+V\+E\+L\+\_\+\+M\+A\+P\+\_\+\+M\+O\+D\+E}!sys/wince/mhmap.\+h@{sys/wince/mhmap.\+h}}
\subsubsection[{R\+O\+G\+U\+E\+\_\+\+L\+E\+V\+E\+L\+\_\+\+M\+A\+P\+\_\+\+M\+O\+D\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+O\+G\+U\+E\+\_\+\+L\+E\+V\+E\+L\+\_\+\+M\+A\+P\+\_\+\+M\+O\+D\+E~{\bf M\+A\+P\+\_\+\+M\+O\+D\+E\+\_\+\+A\+S\+C\+I\+I12x16}}}\label{sys_2wince_2mhmap_8h_ad50b7e1f32b9504ad8626095b97528c6}


Definition at line 16 of file mhmap.\+h.



Referenced by mswin\+\_\+clear\+\_\+nhwindow().



\subsection{Function Documentation}
\hypertarget{sys_2wince_2mhmap_8h_abded2548566a94f9de0497ad3447913d}{\index{sys/wince/mhmap.\+h@{sys/wince/mhmap.\+h}!mswin\+\_\+init\+\_\+map\+\_\+window@{mswin\+\_\+init\+\_\+map\+\_\+window}}
\index{mswin\+\_\+init\+\_\+map\+\_\+window@{mswin\+\_\+init\+\_\+map\+\_\+window}!sys/wince/mhmap.\+h@{sys/wince/mhmap.\+h}}
\subsubsection[{mswin\+\_\+init\+\_\+map\+\_\+window}]{\setlength{\rightskip}{0pt plus 5cm}H\+W\+N\+D mswin\+\_\+init\+\_\+map\+\_\+window (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2mhmap_8h_abded2548566a94f9de0497ad3447913d}


Definition at line 47 of file mhmap.\+c.


\begin{DoxyCode}
47                               \{
48     \textcolor{keyword}{static} \textcolor{keywordtype}{int} run\_once = 0;
49     HWND ret;
50     DWORD styles;
51 
52     \textcolor{keywordflow}{if}( !run\_once ) \{
53         \hyperlink{sys_2wince_2mhmap_8c_a1f8f18b4bd46d6298fbadb48f5194ae7}{register\_map\_window\_class}();
54         run\_once = 1;
55     \}
56     
57     styles = WS\_CHILD | WS\_CLIPSIBLINGS;
58     \textcolor{keywordflow}{if}( !\hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->bHideScrollBars ) styles |= WS\_HSCROLL | WS\_VSCROLL;
59     ret = CreateWindow(
60             \hyperlink{sys_2wince_2mhmap_8c_aa3c635b8b814001fd57033f830cfc850}{szNHMapWindowClass},       \textcolor{comment}{/* registered class name */}
61             \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL},                   \textcolor{comment}{/* window name */}
62             styles, \textcolor{comment}{/* window style */}
63             0,  \textcolor{comment}{/* horizontal position of window - set it later */}
64             0,  \textcolor{comment}{/* vertical position of window - set it later */}
65             0,  \textcolor{comment}{/* window width - set it later */}
66             0,  \textcolor{comment}{/* window height - set it later*/}
67             \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->hMainWnd,   \textcolor{comment}{/* handle to parent or owner window */}
68             \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL},                   \textcolor{comment}{/* menu handle or child identifier */}
69             \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->hApp,       \textcolor{comment}{/* handle to application instance */}
70             \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} );                 \textcolor{comment}{/* window-creation data */}
71     \textcolor{keywordflow}{if}( !ret ) \{
72         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"Cannot create map window"});
73     \}
74     \textcolor{keywordflow}{return} ret;
75 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2mhmap_8h_a3cc8c75ab01843325bb704d173373fd4}{\index{sys/wince/mhmap.\+h@{sys/wince/mhmap.\+h}!mswin\+\_\+map\+\_\+mode@{mswin\+\_\+map\+\_\+mode}}
\index{mswin\+\_\+map\+\_\+mode@{mswin\+\_\+map\+\_\+mode}!sys/wince/mhmap.\+h@{sys/wince/mhmap.\+h}}
\subsubsection[{mswin\+\_\+map\+\_\+mode}]{\setlength{\rightskip}{0pt plus 5cm}int mswin\+\_\+map\+\_\+mode (
\begin{DoxyParamCaption}
\item[{H\+W\+N\+D}]{h\+Wnd, }
\item[{int}]{mode}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2mhmap_8h_a3cc8c75ab01843325bb704d173373fd4}


Definition at line 189 of file mhmap.\+c.


\begin{DoxyCode}
190 \{
191     \hyperlink{structmswin__nethack__map__window}{PNHMapWindow} data;
192     \textcolor{keywordtype}{int} oldMode;
193     \hyperlink{global_8h_afd2537d19a3cb6556b0f727580ec6ee7}{SIZE} mapSize;
194 
195     data = (\hyperlink{sys_2wince_2mhmap_8c_a82a6298010a5511f78638af4f6e4cd15}{PNHMapWindow})GetWindowLong(hWnd, GWL\_USERDATA);
196     \textcolor{keywordflow}{if}( mode == data->\hyperlink{structmswin__nethack__map__window_a75b76933790e3cc4d09c9f97df1afc1d}{mapMode} ) \textcolor{keywordflow}{return} mode;
197     
198     oldMode = data->\hyperlink{structmswin__nethack__map__window_a75b76933790e3cc4d09c9f97df1afc1d}{mapMode};
199     data->\hyperlink{structmswin__nethack__map__window_a75b76933790e3cc4d09c9f97df1afc1d}{mapMode} = mode;
200 
201     \textcolor{keywordflow}{switch}( data->\hyperlink{structmswin__nethack__map__window_a75b76933790e3cc4d09c9f97df1afc1d}{mapMode} ) \{
202 
203     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_a582c67d5746cd9ae752fac90e11294ae}{MAP\_MODE\_ASCII4x6}:
204         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
205         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
206         mapSize.cx = 4*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
207         mapSize.cy = 6*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
208     \textcolor{keywordflow}{break};
209 
210     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_a3899d2308eadec1b1ae23a03e7865234}{MAP\_MODE\_ASCII6x8}:
211         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
212         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
213         mapSize.cx = 6*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
214         mapSize.cy = 8*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
215     \textcolor{keywordflow}{break};
216 
217     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_a2ffafa4f297b5463eabe3b891bc92509}{MAP\_MODE\_ASCII8x8}:
218         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
219         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
220         mapSize.cx = 8*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
221         mapSize.cy = 8*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
222     \textcolor{keywordflow}{break};
223 
224     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_a6f2fe94dd9c875cf4d3c2545fb8d7ed7}{MAP\_MODE\_ASCII16x8}:
225         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
226         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
227         mapSize.cx = 16*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
228         mapSize.cy = 8*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
229     \textcolor{keywordflow}{break};
230 
231     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_a5cdad45aaeb5c092067eb1ce920544b3}{MAP\_MODE\_ASCII7x12}:
232         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
233         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
234         mapSize.cx = 7*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
235         mapSize.cy = 12*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
236     \textcolor{keywordflow}{break};
237 
238     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_ab7bde31d3953c37eddaf0cec4b967ce6}{MAP\_MODE\_ASCII8x12}:
239         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
240         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
241         mapSize.cx = 8*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
242         mapSize.cy = 12*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
243     \textcolor{keywordflow}{break};
244 
245     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_a679aea826169d4062ceb06f8c7ac2561}{MAP\_MODE\_ASCII16x12}:
246         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
247         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
248         mapSize.cx = 16*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
249         mapSize.cy = 12*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
250     \textcolor{keywordflow}{break};
251 
252     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_ae0d763de7f5d48bd0b4f7c3fda36eebb}{MAP\_MODE\_ASCII12x16}:
253         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
254         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
255         mapSize.cx = 12*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
256         mapSize.cy = 16*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
257     \textcolor{keywordflow}{break};
258 
259     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_a6b787f35e03e46f21984e4190707430a}{MAP\_MODE\_ASCII10x18}:
260         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
261         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
262         mapSize.cx = 10*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
263         mapSize.cy = 18*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
264     \textcolor{keywordflow}{break};
265 
266     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_af4e337dbae61232212774e90a30d6506}{MAP\_MODE\_ASCII\_FIT\_TO\_SCREEN}: \{
267         RECT client\_rt;
268         GetClientRect(hWnd, &client\_rt);
269         mapSize.cx = client\_rt.right - client\_rt.left;
270         mapSize.cy = client\_rt.bottom - client\_rt.top;
271 
272         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
273         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
274     \} \textcolor{keywordflow}{break};
275 
276     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_aa30c90d80b3ba942295337a9dc1f9c1e}{MAP\_MODE\_TILES\_FIT\_TO\_SCREEN}: \{
277         RECT client\_rt;
278         GetClientRect(hWnd, &client\_rt);
279         mapSize.cx = client\_rt.right - client\_rt.left;
280         mapSize.cy = client\_rt.bottom - client\_rt.top;
281 
282         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
283         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
284     \} \textcolor{keywordflow}{break};
285 
286     \textcolor{keywordflow}{case} \hyperlink{winprocs_8h_a4e5a5df8a98a429b268f73636dbce5ab}{MAP\_MODE\_TILES}:
287     \textcolor{keywordflow}{default}:
288         data->\hyperlink{structmswin__nethack__map__window_ae71a1d1da2f65a81cdd0ea0cbad8052a}{bAsciiMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
289         data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
290         mapSize.cx = \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_adb6d803036dca29b82a10f0fbd007edd}{mapTile\_X}*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO};
291         mapSize.cy = \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_a699b7a92f8c907030eff6ef5a36d29f3}{mapTile\_Y}*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
292     \textcolor{keywordflow}{break};
293     \}
294 
295     \hyperlink{sys_2wince_2mhmap_8c_a02cf8b2ed4e7d6cbd2355d759ad547ef}{mswin\_map\_stretch}(hWnd, &mapSize, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
296 
297     \textcolor{keywordflow}{return} oldMode;
298 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2mhmap_8h_a02cf8b2ed4e7d6cbd2355d759ad547ef}{\index{sys/wince/mhmap.\+h@{sys/wince/mhmap.\+h}!mswin\+\_\+map\+\_\+stretch@{mswin\+\_\+map\+\_\+stretch}}
\index{mswin\+\_\+map\+\_\+stretch@{mswin\+\_\+map\+\_\+stretch}!sys/wince/mhmap.\+h@{sys/wince/mhmap.\+h}}
\subsubsection[{mswin\+\_\+map\+\_\+stretch}]{\setlength{\rightskip}{0pt plus 5cm}void mswin\+\_\+map\+\_\+stretch (
\begin{DoxyParamCaption}
\item[{H\+W\+N\+D}]{h\+Wnd, }
\item[{L\+P\+S\+I\+Z\+E}]{lpsz, }
\item[{B\+O\+O\+L}]{redraw}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2mhmap_8h_a02cf8b2ed4e7d6cbd2355d759ad547ef}


Definition at line 77 of file mhmap.\+c.


\begin{DoxyCode}
78 \{
79     \hyperlink{structmswin__nethack__map__window}{PNHMapWindow} data;
80     RECT         client\_rt;
81     SCROLLINFO   si;
82     \hyperlink{global_8h_afd2537d19a3cb6556b0f727580ec6ee7}{SIZE}         wnd\_size;               
83     LOGFONT      lgfnt;
84 
85     \textcolor{comment}{/* check arguments */}
86     \textcolor{keywordflow}{if}( !IsWindow(hWnd) ||
87         !lpsz ||
88         lpsz->cx<=0 ||
89         lpsz->cy<=0 ) \textcolor{keywordflow}{return};
90 
91     \textcolor{comment}{/* calculate window size */}
92     GetClientRect(hWnd, &client\_rt);
93     wnd\_size.cx = client\_rt.right - client\_rt.left;
94     wnd\_size.cy = client\_rt.bottom - client\_rt.top;
95     
96     \textcolor{comment}{/* set new screen tile size */}
97     data = (\hyperlink{sys_2wince_2mhmap_8c_a82a6298010a5511f78638af4f6e4cd15}{PNHMapWindow})GetWindowLong(hWnd, GWL\_USERDATA);
98     data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile} = 
99         \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(1, (data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode}? wnd\_size.cx : lpsz->cx) / 
      \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO});
100     data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile} = 
101         \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(1, (data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode}? wnd\_size.cy : lpsz->cy) / 
      \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO});
102 
103     \textcolor{comment}{/* set map origin point */}
104     data->\hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.x = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, client\_rt.left + (wnd\_size.cx - data->
      \hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile}*\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO})/2 );
105     data->\hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.y = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, client\_rt.top + (wnd\_size.cy - data->
      \hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile}*\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO})/2 );
106 
107     data->\hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.x -= data->\hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.x % data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile};
108     data->\hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.y -= data->\hyperlink{structmswin__nethack__map__window_afc6012fbec67e292e844780d1d672aa4}{map\_orig}.y % data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile};
109 
110     \textcolor{comment}{/* adjust horizontal scroll bar */}
111     \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} )
112         data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize} = \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}+1;  \textcolor{comment}{/* disable scroll bar */}
113     \textcolor{keywordflow}{else}
114         data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize} = wnd\_size.cx/data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile};
115 
116     \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize} >= \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO} ) \{
117         data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos} = 0;
118         \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_a75259e1f797e53006ad99a4a28fe9b36}{bNoHScroll} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
119     \} \textcolor{keywordflow}{else} \{
120         \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_a75259e1f797e53006ad99a4a28fe9b36}{bNoHScroll} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
121         data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos} = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}-data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize}+1, 
      \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux} - data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize}/2));
122     \}
123 
124     \textcolor{keywordflow}{if}( !\hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->bHideScrollBars ) \{
125         si.cbSize = \textcolor{keyword}{sizeof}(si); 
126         si.fMask  = SIF\_RANGE | SIF\_PAGE | SIF\_POS; 
127         si.nMin   = 0; 
128         si.nMax   = \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}; 
129         si.nPage  = data->\hyperlink{structmswin__nethack__map__window_abd81fd3a50efd2fe1b47b2f2a86ed0a2}{xPageSize}; 
130         si.nPos   = data->\hyperlink{structmswin__nethack__map__window_a194bde5da5a3744d473a63513c8f0e54}{xPos}; 
131         SetScrollInfo(hWnd, SB\_HORZ, &si, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}); 
132     \}
133 
134     \textcolor{comment}{/* adjust vertical scroll bar */}
135     \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_adcc464e3ebe6973032310a740e332bed}{bFitToScreenMode} )
136         data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize} = \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}+1;   \textcolor{comment}{/* disable scroll bar */}
137     \textcolor{keywordflow}{else}
138         data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize} = wnd\_size.cy/data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile};
139 
140     \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize} >= \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO} ) \{
141         data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos} = 0;
142         \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_ad0311b73326a15c00e147d1b9d809979}{bNoVScroll} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
143     \} \textcolor{keywordflow}{else} \{
144         \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_ad0311b73326a15c00e147d1b9d809979}{bNoVScroll} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
145         data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos} = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}-data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize}+1, 
      \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy} - data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize}/2));
146     \}
147 
148     \textcolor{keywordflow}{if}( !\hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->bHideScrollBars ) \{
149         si.cbSize = \textcolor{keyword}{sizeof}(si); 
150         si.fMask  = SIF\_RANGE | SIF\_PAGE | SIF\_POS; 
151         si.nMin   = 0; 
152         si.nMax   = \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}; 
153         si.nPage  = data->\hyperlink{structmswin__nethack__map__window_a7eaf7cff55b2d986cba8ac01ef07b9a4}{yPageSize}; 
154         si.nPos   = data->\hyperlink{structmswin__nethack__map__window_a65f28fb66beee69ef2502198c8ed01ee}{yPos}; 
155         SetScrollInfo(hWnd, SB\_VERT, &si, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
156     \}
157 
158     \textcolor{comment}{/* create font */}
159     \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__map__window_a80fbf3a4db2d22dca0c765a19c54ebc8}{hMapFont} ) DeleteObject(data->\hyperlink{structmswin__nethack__map__window_a80fbf3a4db2d22dca0c765a19c54ebc8}{hMapFont});
160     ZeroMemory(&lgfnt, \textcolor{keyword}{sizeof}(lgfnt));
161     lgfnt.lfHeight          =   -data->\hyperlink{structmswin__nethack__map__window_a9d566860974e604deb3eab13900fa5e7}{yScrTile};     \textcolor{comment}{// height of font}
162     lgfnt.lfWidth           =   -data->\hyperlink{structmswin__nethack__map__window_a7fdb5eaa836b646caa95fa6b813111f6}{xScrTile};     \textcolor{comment}{// average character width}
163     lgfnt.lfEscapement      =   0;                   \textcolor{comment}{// angle of escapement}
164     lgfnt.lfOrientation     =   0;                   \textcolor{comment}{// base-line orientation angle}
165     lgfnt.lfWeight          =   FW\_NORMAL;           \textcolor{comment}{// font weight}
166     lgfnt.lfItalic          =   \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};              \textcolor{comment}{// italic attribute option}
167     lgfnt.lfUnderline       =   \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};              \textcolor{comment}{// underline attribute option}
168     lgfnt.lfStrikeOut       =   \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};              \textcolor{comment}{// strikeout attribute option}
169     lgfnt.lfCharSet         =   \hyperlink{sys_2wince_2mhfont_8c_af970523ac3adefc3a252ad43200ef52b}{mswin\_charset}();     \textcolor{comment}{// character set identifier}
170     lgfnt.lfOutPrecision    =   OUT\_DEFAULT\_PRECIS;  \textcolor{comment}{// output precision}
171     lgfnt.lfClipPrecision   =   CLIP\_DEFAULT\_PRECIS; \textcolor{comment}{// clipping precision}
172     lgfnt.lfQuality         =   DEFAULT\_QUALITY;     \textcolor{comment}{// output quality}
173     \textcolor{keywordflow}{if}( \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_aa6ea2de4586a805d461b0a92a229b7a8}{wc\_font\_map} &&
174         *\hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_aa6ea2de4586a805d461b0a92a229b7a8}{wc\_font\_map} ) \{
175         lgfnt.lfPitchAndFamily  = DEFAULT\_PITCH;         \textcolor{comment}{// pitch and family}
176         \hyperlink{wceconf_8h_a2ed36c9ee770dfe5f2d0e3088a62adad}{NH\_A2W}(\hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_aa6ea2de4586a805d461b0a92a229b7a8}{wc\_font\_map}, lgfnt.lfFaceName, LF\_FACESIZE);
177     \} \textcolor{keywordflow}{else} \{
178         lgfnt.lfPitchAndFamily  = FIXED\_PITCH;       \textcolor{comment}{// pitch and family}
179         \_tcsncpy(lgfnt.lfFaceName, \hyperlink{sys_2wince_2mhmap_8c_ad3e0b865c7bff9658de5db29c3ac3798}{NHMAP\_FONT\_NAME}, LF\_FACESIZE);
180     \}
181     data->\hyperlink{structmswin__nethack__map__window_a80fbf3a4db2d22dca0c765a19c54ebc8}{hMapFont} = CreateFontIndirect(&lgfnt);
182 
183     \hyperlink{sys_2wince_2mswproc_8c_a7f6e502e24b0302832e4afada1d64805}{mswin\_cliparound}(data->\hyperlink{structmswin__nethack__map__window_aab34317edd92c7cae3930bd9ffe026c4}{xCur}, data->\hyperlink{structmswin__nethack__map__window_a6d0d676450acedb201f08b279667818a}{yCur});
184 
185     \textcolor{keywordflow}{if}(redraw) InvalidateRect(hWnd, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
186 \}
\end{DoxyCode}
