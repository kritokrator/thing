\hypertarget{region_8c}{\section{nethack/src/region.c File Reference}
\label{region_8c}\index{nethack/src/region.\+c@{nethack/src/region.\+c}}
}
{\ttfamily \#include \char`\"{}hack.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}lev.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{N\+O\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K}~(-\/1)
\item 
\#define \hyperlink{region_8c_a3ee3f59dabf8fdeecbe7d581e628c806}{I\+N\+S\+I\+D\+E\+\_\+\+G\+A\+S\+\_\+\+C\+L\+O\+U\+D}~0
\item 
\#define \hyperlink{region_8c_aa03b98bc502e005b85653a2922179f47}{E\+X\+P\+I\+R\+E\+\_\+\+G\+A\+S\+\_\+\+C\+L\+O\+U\+D}~1
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{region_8c_a0203c540e2da49f81f6fcea34edb7435}{F\+D\+E\+C\+L} (\hyperlink{region_8c_ab3ffe884ed3c62bef7405ac5d3dae03c}{inside\+\_\+gas\+\_\+cloud},(\hyperlink{tradstdc_8h_a27b7ef107ad7591f7cd3100aae6c5f6c}{genericptr}, \hyperlink{tradstdc_8h_a27b7ef107ad7591f7cd3100aae6c5f6c}{genericptr}))
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{region_8c_a03da21a8558ff3405d5a18d80a481bd5}{F\+D\+E\+C\+L} (\hyperlink{region_8c_aa44c4cae6537f43f17d1fff993447aab}{expire\+\_\+gas\+\_\+cloud},(\hyperlink{tradstdc_8h_a27b7ef107ad7591f7cd3100aae6c5f6c}{genericptr}, \hyperlink{tradstdc_8h_a27b7ef107ad7591f7cd3100aae6c5f6c}{genericptr}))
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{region_8c_ab49b8a3f9f5c0c76b90e04eedbd60b89}{F\+D\+E\+C\+L} (\hyperlink{region_8c_a5a9b0626d36815ebcc0065d2046507e2}{inside\+\_\+rect},(\hyperlink{rect_8h_ace177dfae9a298f345a8d92a8295e55a}{Nh\+Rect} $\ast$, int, int))
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{region_8c_ac5082c71e6309f0b48fde9b5db73c289}{F\+D\+E\+C\+L} (\hyperlink{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{inside\+\_\+region},(\hyperlink{structNhRegion}{Nh\+Region} $\ast$, int, int))
\item 
\hyperlink{structNhRegion}{Nh\+Region} $\ast$ \hyperlink{region_8c_a1de7d0992e81864a613a4536eda0baf2}{F\+D\+E\+C\+L} (\hyperlink{region_8c_a8f3aaa35b03ac9f0a48221b9ca3c6464}{create\+\_\+region},(\hyperlink{rect_8h_ace177dfae9a298f345a8d92a8295e55a}{Nh\+Rect} $\ast$, int))
\item 
void \hyperlink{region_8c_a6a5ec70081bde9223d0425d11596fce1}{F\+D\+E\+C\+L} (\hyperlink{region_8c_afca3bef5449e5fdc254c8484300d2184}{add\+\_\+rect\+\_\+to\+\_\+reg},(\hyperlink{structNhRegion}{Nh\+Region} $\ast$, \hyperlink{rect_8h_ace177dfae9a298f345a8d92a8295e55a}{Nh\+Rect} $\ast$))
\item 
void \hyperlink{region_8c_a86fb852da27249181290151b895af03b}{F\+D\+E\+C\+L} (\hyperlink{region_8c_a8658ad41f4db86cd40879880694722b9}{add\+\_\+mon\+\_\+to\+\_\+reg},(\hyperlink{structNhRegion}{Nh\+Region} $\ast$, struct \hyperlink{structmonst}{monst} $\ast$))
\item 
void \hyperlink{region_8c_ac62962402018b3c0df516caa24c73307}{F\+D\+E\+C\+L} (\hyperlink{region_8c_a7a95cca3c19765121cb7a339f298e3e1}{remove\+\_\+mon\+\_\+from\+\_\+reg},(\hyperlink{structNhRegion}{Nh\+Region} $\ast$, struct \hyperlink{structmonst}{monst} $\ast$))
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{region_8c_afcc6c328e492487c613ed35d37509128}{F\+D\+E\+C\+L} (\hyperlink{region_8c_a9d136cc978d82d2e1d27aedb7bf2553d}{mon\+\_\+in\+\_\+region},(\hyperlink{structNhRegion}{Nh\+Region} $\ast$, struct \hyperlink{structmonst}{monst} $\ast$))
\item 
void \hyperlink{region_8c_ada3e256645a3f2cf437ee21861361c84}{F\+D\+E\+C\+L} (\hyperlink{region_8c_a931dec1c1658099e9bee65a9752c3913}{free\+\_\+region},(\hyperlink{structNhRegion}{Nh\+Region} $\ast$))
\item 
void \hyperlink{region_8c_abf94ae7fd9f765f3b17e05681e37e44c}{F\+D\+E\+C\+L} (\hyperlink{region_8c_ac80264d420c6597054ef5ba186b90715}{add\+\_\+region},(\hyperlink{structNhRegion}{Nh\+Region} $\ast$))
\item 
void \hyperlink{region_8c_a59c445c837cd09b81805cc61574d572a}{F\+D\+E\+C\+L} (\hyperlink{region_8c_adcca6024184d915b0aa1b7e1e9ed12ff}{remove\+\_\+region},(\hyperlink{structNhRegion}{Nh\+Region} $\ast$))
\item 
static void \hyperlink{region_8c_a28064dc3c73b8ec1d55d12daca5606e2}{F\+D\+E\+C\+L} (\hyperlink{region_8c_a5937a1dcb825953a87b78a00b03495d2}{reset\+\_\+region\+\_\+mids},(\hyperlink{structNhRegion}{Nh\+Region} $\ast$))
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{region_8c_a5a9b0626d36815ebcc0065d2046507e2}{inside\+\_\+rect} (\hyperlink{rect_8h_ace177dfae9a298f345a8d92a8295e55a}{Nh\+Rect} $\ast$r, int x, int y)
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{inside\+\_\+region} (\hyperlink{structNhRegion}{Nh\+Region} $\ast$\hyperlink{structreg}{reg}, int x, int y)
\item 
\hyperlink{structNhRegion}{Nh\+Region} $\ast$ \hyperlink{region_8c_a8f3aaa35b03ac9f0a48221b9ca3c6464}{create\+\_\+region} (\hyperlink{rect_8h_ace177dfae9a298f345a8d92a8295e55a}{Nh\+Rect} $\ast$rects, int nrect)
\item 
void \hyperlink{region_8c_afca3bef5449e5fdc254c8484300d2184}{add\+\_\+rect\+\_\+to\+\_\+reg} (\hyperlink{structNhRegion}{Nh\+Region} $\ast$\hyperlink{structreg}{reg}, \hyperlink{rect_8h_ace177dfae9a298f345a8d92a8295e55a}{Nh\+Rect} $\ast$\hyperlink{rect_8c_a58a1301fcdb736034a47900ee20578ec}{rect})
\item 
void \hyperlink{region_8c_a8658ad41f4db86cd40879880694722b9}{add\+\_\+mon\+\_\+to\+\_\+reg} (\hyperlink{structNhRegion}{Nh\+Region} $\ast$\hyperlink{structreg}{reg}, struct \hyperlink{structmonst}{monst} $\ast$mon)
\item 
void \hyperlink{region_8c_a7a95cca3c19765121cb7a339f298e3e1}{remove\+\_\+mon\+\_\+from\+\_\+reg} (\hyperlink{structNhRegion}{Nh\+Region} $\ast$\hyperlink{structreg}{reg}, struct \hyperlink{structmonst}{monst} $\ast$mon)
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{region_8c_a9d136cc978d82d2e1d27aedb7bf2553d}{mon\+\_\+in\+\_\+region} (\hyperlink{structNhRegion}{Nh\+Region} $\ast$\hyperlink{structreg}{reg}, struct \hyperlink{structmonst}{monst} $\ast$mon)
\item 
void \hyperlink{region_8c_a931dec1c1658099e9bee65a9752c3913}{free\+\_\+region} (\hyperlink{structNhRegion}{Nh\+Region} $\ast$\hyperlink{structreg}{reg})
\item 
void \hyperlink{region_8c_ac80264d420c6597054ef5ba186b90715}{add\+\_\+region} (\hyperlink{structNhRegion}{Nh\+Region} $\ast$\hyperlink{structreg}{reg})
\item 
void \hyperlink{region_8c_adcca6024184d915b0aa1b7e1e9ed12ff}{remove\+\_\+region} (\hyperlink{structNhRegion}{Nh\+Region} $\ast$\hyperlink{structreg}{reg})
\item 
void \hyperlink{region_8c_a1234948d428a2fc1c045dac58f9a2737}{clear\+\_\+regions} ()
\item 
void \hyperlink{region_8c_ab4200c4e3a725df2d919f5eac599cea6}{run\+\_\+regions} ()
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{region_8c_a81f2ad7a49678ddc817ad507962b8d4a}{in\+\_\+out\+\_\+region} (\hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} x, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} y)
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{region_8c_a3e091b3dfe784295e74b9af6a35d8098}{m\+\_\+in\+\_\+out\+\_\+region} (struct \hyperlink{structmonst}{monst} $\ast$mon, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} x, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} y)
\item 
void \hyperlink{region_8c_aa3f81ca2a9d868ca9b8eb54511903561}{update\+\_\+player\+\_\+regions} ()
\item 
void \hyperlink{region_8c_a00b2aa38f5d577f959a3c5ce97e8aa5a}{update\+\_\+monster\+\_\+region} (struct \hyperlink{structmonst}{monst} $\ast$mon)
\item 
\hyperlink{structNhRegion}{Nh\+Region} $\ast$ \hyperlink{region_8c_ad2448764df1a831e33023c09f85b5efb}{visible\+\_\+region\+\_\+at} (\hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} x, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} y)
\item 
void \hyperlink{region_8c_a7174f218af0821b5b14b871be883a6ac}{show\+\_\+region} (\hyperlink{structNhRegion}{Nh\+Region} $\ast$\hyperlink{structreg}{reg}, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} x, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} y)
\item 
void \hyperlink{region_8c_a838af489fa2b6468bef800775160f074}{save\+\_\+regions} (int fd, int mode)
\item 
void \hyperlink{region_8c_a104b720acbe4f7aa1b5a2a8545f10266}{rest\+\_\+regions} (int fd, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} ghostly)
\item 
static void \hyperlink{region_8c_a5937a1dcb825953a87b78a00b03495d2}{reset\+\_\+region\+\_\+mids} (\hyperlink{structNhRegion}{Nh\+Region} $\ast$\hyperlink{structreg}{reg})
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{region_8c_aa44c4cae6537f43f17d1fff993447aab}{expire\+\_\+gas\+\_\+cloud} (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\+\_\+t} p1, \hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\+\_\+t} p2)
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{region_8c_ab3ffe884ed3c62bef7405ac5d3dae03c}{inside\+\_\+gas\+\_\+cloud} (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\+\_\+t} p1, \hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\+\_\+t} p2)
\item 
\hyperlink{structNhRegion}{Nh\+Region} $\ast$ \hyperlink{region_8c_ad093a103851bffd59e7c53f6d0e9aca1}{create\+\_\+gas\+\_\+cloud} (\hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} x, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} y, int radius, int \hyperlink{structdamage}{damage})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{structNhRegion}{Nh\+Region} $\ast$$\ast$ \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}
\item 
static int \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\+\_\+regions} = 0
\item 
static int \hyperlink{region_8c_a49ad6e0de3ce0c01574f49ca37146b2b}{max\+\_\+regions} = 0
\item 
static callback\+\_\+proc \hyperlink{region_8c_ad29a76e7f515cea23ce07477430089bb}{callbacks} \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{region_8c_aa03b98bc502e005b85653a2922179f47}{\index{region.\+c@{region.\+c}!E\+X\+P\+I\+R\+E\+\_\+\+G\+A\+S\+\_\+\+C\+L\+O\+U\+D@{E\+X\+P\+I\+R\+E\+\_\+\+G\+A\+S\+\_\+\+C\+L\+O\+U\+D}}
\index{E\+X\+P\+I\+R\+E\+\_\+\+G\+A\+S\+\_\+\+C\+L\+O\+U\+D@{E\+X\+P\+I\+R\+E\+\_\+\+G\+A\+S\+\_\+\+C\+L\+O\+U\+D}!region.\+c@{region.\+c}}
\subsubsection[{E\+X\+P\+I\+R\+E\+\_\+\+G\+A\+S\+\_\+\+C\+L\+O\+U\+D}]{\setlength{\rightskip}{0pt plus 5cm}\#define E\+X\+P\+I\+R\+E\+\_\+\+G\+A\+S\+\_\+\+C\+L\+O\+U\+D~1}}\label{region_8c_aa03b98bc502e005b85653a2922179f47}


Referenced by create\+\_\+gas\+\_\+cloud().

\hypertarget{region_8c_a3ee3f59dabf8fdeecbe7d581e628c806}{\index{region.\+c@{region.\+c}!I\+N\+S\+I\+D\+E\+\_\+\+G\+A\+S\+\_\+\+C\+L\+O\+U\+D@{I\+N\+S\+I\+D\+E\+\_\+\+G\+A\+S\+\_\+\+C\+L\+O\+U\+D}}
\index{I\+N\+S\+I\+D\+E\+\_\+\+G\+A\+S\+\_\+\+C\+L\+O\+U\+D@{I\+N\+S\+I\+D\+E\+\_\+\+G\+A\+S\+\_\+\+C\+L\+O\+U\+D}!region.\+c@{region.\+c}}
\subsubsection[{I\+N\+S\+I\+D\+E\+\_\+\+G\+A\+S\+\_\+\+C\+L\+O\+U\+D}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\+N\+S\+I\+D\+E\+\_\+\+G\+A\+S\+\_\+\+C\+L\+O\+U\+D~0}}\label{region_8c_a3ee3f59dabf8fdeecbe7d581e628c806}


Referenced by create\+\_\+gas\+\_\+cloud().

\hypertarget{region_8c_ab3744b941a34628f68fa585cf4ba110a}{\index{region.\+c@{region.\+c}!N\+O\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K@{N\+O\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K}}
\index{N\+O\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K@{N\+O\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K}!region.\+c@{region.\+c}}
\subsubsection[{N\+O\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\+O\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K~(-\/1)}}\label{region_8c_ab3744b941a34628f68fa585cf4ba110a}


Definition at line 18 of file region.\+c.



Referenced by create\+\_\+region(), in\+\_\+out\+\_\+region(), m\+\_\+in\+\_\+out\+\_\+region(), and run\+\_\+regions().



\subsection{Function Documentation}
\hypertarget{region_8c_a8658ad41f4db86cd40879880694722b9}{\index{region.\+c@{region.\+c}!add\+\_\+mon\+\_\+to\+\_\+reg@{add\+\_\+mon\+\_\+to\+\_\+reg}}
\index{add\+\_\+mon\+\_\+to\+\_\+reg@{add\+\_\+mon\+\_\+to\+\_\+reg}!region.\+c@{region.\+c}}
\subsubsection[{add\+\_\+mon\+\_\+to\+\_\+reg}]{\setlength{\rightskip}{0pt plus 5cm}void add\+\_\+mon\+\_\+to\+\_\+reg (
\begin{DoxyParamCaption}
\item[{{\bf Nh\+Region} $\ast$}]{reg, }
\item[{struct {\bf monst} $\ast$}]{mon}
\end{DoxyParamCaption}
)}}\label{region_8c_a8658ad41f4db86cd40879880694722b9}


Definition at line 171 of file region.\+c.



References alloc(), free(), monst\+::m\+\_\+id, and M\+O\+N\+S\+T\+\_\+\+I\+N\+C.



Referenced by add\+\_\+region(), m\+\_\+in\+\_\+out\+\_\+region(), and update\+\_\+monster\+\_\+region().


\begin{DoxyCode}
174 \{
175     \textcolor{keywordtype}{int} i;
176     \textcolor{keywordtype}{unsigned} *tmp\_m;
177 
178     \textcolor{keywordflow}{if} (reg->\hyperlink{structNhRegion_a26e6ec350a157299cdd03820faf5948b}{max\_monst} <= reg->\hyperlink{structNhRegion_a03e540a957b87fbd016dbee3c3c0cb9c}{n\_monst}) \{
179     tmp\_m = (\textcolor{keywordtype}{unsigned} *)
180             \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(\textcolor{keyword}{sizeof} (\textcolor{keywordtype}{unsigned}) * (reg->\hyperlink{structNhRegion_a26e6ec350a157299cdd03820faf5948b}{max\_monst} + \hyperlink{region_8h_a5a0b355a22a8f04cd3155fea14062968}{MONST\_INC}));
181     \textcolor{keywordflow}{if} (reg->\hyperlink{structNhRegion_a26e6ec350a157299cdd03820faf5948b}{max\_monst} > 0) \{
182         \textcolor{keywordflow}{for} (i = 0; i < reg->\hyperlink{structNhRegion_a26e6ec350a157299cdd03820faf5948b}{max\_monst}; i++)
183         tmp\_m[i] = reg->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters}[i];
184         \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) reg->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters});
185     \}
186     reg->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters} = tmp\_m;
187     reg->\hyperlink{structNhRegion_a26e6ec350a157299cdd03820faf5948b}{max\_monst} += \hyperlink{region_8h_a5a0b355a22a8f04cd3155fea14062968}{MONST\_INC};
188     \}
189     reg->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters}[reg->\hyperlink{structNhRegion_a03e540a957b87fbd016dbee3c3c0cb9c}{n\_monst}++] = mon->\hyperlink{structmonst_ad8084d1c794f3903b9ffa85fca798abd}{m\_id};
190 \}
\end{DoxyCode}
\hypertarget{region_8c_afca3bef5449e5fdc254c8484300d2184}{\index{region.\+c@{region.\+c}!add\+\_\+rect\+\_\+to\+\_\+reg@{add\+\_\+rect\+\_\+to\+\_\+reg}}
\index{add\+\_\+rect\+\_\+to\+\_\+reg@{add\+\_\+rect\+\_\+to\+\_\+reg}!region.\+c@{region.\+c}}
\subsubsection[{add\+\_\+rect\+\_\+to\+\_\+reg}]{\setlength{\rightskip}{0pt plus 5cm}void add\+\_\+rect\+\_\+to\+\_\+reg (
\begin{DoxyParamCaption}
\item[{{\bf Nh\+Region} $\ast$}]{reg, }
\item[{{\bf Nh\+Rect} $\ast$}]{rect}
\end{DoxyParamCaption}
)}}\label{region_8c_afca3bef5449e5fdc254c8484300d2184}


Definition at line 141 of file region.\+c.



References alloc(), free(), nhrect\+::hx, nhrect\+::hy, nhrect\+::lx, nhrect\+::ly, and rect.



Referenced by create\+\_\+gas\+\_\+cloud().


\begin{DoxyCode}
144 \{
145     \hyperlink{structnhrect}{NhRect} *tmp\_rect;
146 
147     tmp\_rect = (\hyperlink{structnhrect}{NhRect} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(\textcolor{keyword}{sizeof} (\hyperlink{structnhrect}{NhRect}) * (reg->\hyperlink{structNhRegion_a0dd5ab591144d5c85049f3d498191dff}{nrects} + 1));
148     \textcolor{keywordflow}{if} (reg->\hyperlink{structNhRegion_a0dd5ab591144d5c85049f3d498191dff}{nrects} > 0) \{
149     (void) memcpy((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) tmp\_rect, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) reg->
      \hyperlink{structNhRegion_a9f1ce44843237df70ccb94ace5c3d06c}{rects},
150               (sizeof (\hyperlink{structnhrect}{NhRect}) * reg->\hyperlink{structNhRegion_a0dd5ab591144d5c85049f3d498191dff}{nrects}));
151     \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) reg->\hyperlink{structNhRegion_a9f1ce44843237df70ccb94ace5c3d06c}{rects});
152     \}
153     tmp\_rect[reg->\hyperlink{structNhRegion_a0dd5ab591144d5c85049f3d498191dff}{nrects}] = *\hyperlink{rect_8c_a58a1301fcdb736034a47900ee20578ec}{rect};
154     reg->\hyperlink{structNhRegion_a0dd5ab591144d5c85049f3d498191dff}{nrects}++;
155     reg->\hyperlink{structNhRegion_a9f1ce44843237df70ccb94ace5c3d06c}{rects} = tmp\_rect;
156     \textcolor{comment}{/* Update bounding box if needed */}
157     \textcolor{keywordflow}{if} (reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_acfb56c33a9fd34960bb7b86f8470cdcf}{lx} > rect->\hyperlink{structnhrect_acfb56c33a9fd34960bb7b86f8470cdcf}{lx})
158     reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_acfb56c33a9fd34960bb7b86f8470cdcf}{lx} = rect->\hyperlink{structnhrect_acfb56c33a9fd34960bb7b86f8470cdcf}{lx};
159     \textcolor{keywordflow}{if} (reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_ab036ec40a3e9eea9628acfd47c94a181}{ly} > rect->\hyperlink{structnhrect_ab036ec40a3e9eea9628acfd47c94a181}{ly})
160     reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_ab036ec40a3e9eea9628acfd47c94a181}{ly} = rect->\hyperlink{structnhrect_ab036ec40a3e9eea9628acfd47c94a181}{ly};
161     \textcolor{keywordflow}{if} (reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_a42e30acf0258a3280d0e7d39384c235d}{hx} < rect->\hyperlink{structnhrect_a42e30acf0258a3280d0e7d39384c235d}{hx})
162     reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_a42e30acf0258a3280d0e7d39384c235d}{hx} = rect->\hyperlink{structnhrect_a42e30acf0258a3280d0e7d39384c235d}{hx};
163     \textcolor{keywordflow}{if} (reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_a9b42981eb9df1a1b9e37a79e07b1de5e}{hy} < rect->\hyperlink{structnhrect_a9b42981eb9df1a1b9e37a79e07b1de5e}{hy})
164     reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_a9b42981eb9df1a1b9e37a79e07b1de5e}{hy} = rect->\hyperlink{structnhrect_a9b42981eb9df1a1b9e37a79e07b1de5e}{hy};
165 \}
\end{DoxyCode}
\hypertarget{region_8c_ac80264d420c6597054ef5ba186b90715}{\index{region.\+c@{region.\+c}!add\+\_\+region@{add\+\_\+region}}
\index{add\+\_\+region@{add\+\_\+region}!region.\+c@{region.\+c}}
\subsubsection[{add\+\_\+region}]{\setlength{\rightskip}{0pt plus 5cm}void add\+\_\+region (
\begin{DoxyParamCaption}
\item[{{\bf Nh\+Region} $\ast$}]{reg}
\end{DoxyParamCaption}
)}}\label{region_8c_ac80264d420c6597054ef5ba186b90715}


Definition at line 285 of file region.\+c.



References add\+\_\+mon\+\_\+to\+\_\+reg(), alloc(), cansee, clear\+\_\+hero\+\_\+inside, free(), inside\+\_\+region(), level, max\+\_\+regions, M\+O\+N\+\_\+\+A\+T, dlevel\+\_\+t\+::monsters, n\+\_\+regions, newsym(), regions, set\+\_\+hero\+\_\+inside, u, you\+::ux, and you\+::uy.



Referenced by create\+\_\+gas\+\_\+cloud().


\begin{DoxyCode}
287 \{
288     \hyperlink{structNhRegion}{NhRegion} **tmp\_reg;
289     \textcolor{keywordtype}{int} i, j;
290 
291     \textcolor{keywordflow}{if} (\hyperlink{region_8c_a49ad6e0de3ce0c01574f49ca37146b2b}{max\_regions} <= \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}) \{
292     tmp\_reg = \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions};
293     \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions} = (\hyperlink{structNhRegion}{NhRegion} **)\hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(\textcolor{keyword}{sizeof} (\hyperlink{structNhRegion}{NhRegion} *) * (
      \hyperlink{region_8c_a49ad6e0de3ce0c01574f49ca37146b2b}{max\_regions} + 10));
294     \textcolor{keywordflow}{if} (\hyperlink{region_8c_a49ad6e0de3ce0c01574f49ca37146b2b}{max\_regions} > 0) \{
295         (void) memcpy((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) tmp\_reg,
296               \hyperlink{region_8c_a49ad6e0de3ce0c01574f49ca37146b2b}{max\_regions} * \textcolor{keyword}{sizeof} (\hyperlink{structNhRegion}{NhRegion} *));
297         \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) tmp\_reg);
298     \}
299     \hyperlink{region_8c_a49ad6e0de3ce0c01574f49ca37146b2b}{max\_regions} += 10;
300     \}
301     \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[\hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}] = reg;
302     \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}++;
303     \textcolor{comment}{/* Check for monsters inside the region */}
304     \textcolor{keywordflow}{for} (i = reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_acfb56c33a9fd34960bb7b86f8470cdcf}{lx}; i <= reg->bounding\_box.hx; i++)
305     \textcolor{keywordflow}{for} (j = reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_ab036ec40a3e9eea9628acfd47c94a181}{ly}; j <= reg->bounding\_box.hy; j++) \{
306         \textcolor{comment}{/* Some regions can cross the level boundaries */}
307         \textcolor{keywordflow}{if} (!isok(i,j))
308         \textcolor{keywordflow}{continue};
309         \textcolor{keywordflow}{if} (\hyperlink{rm_8h_a17ef631151b987fd582fca76a429c08a}{MON\_AT}(i, j) && \hyperlink{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{inside\_region}(reg, i, j))
310         \hyperlink{region_8c_a8658ad41f4db86cd40879880694722b9}{add\_mon\_to\_reg}(reg, \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_abe8e54209520b4c30e1c8a5364ff1457}{monsters}[i][j]);
311         \textcolor{keywordflow}{if} (reg->\hyperlink{structNhRegion_a2ab12427b9c9d84da999feba4f7ea9cd}{visible} && \hyperlink{vision_8h_a857efc720262bc13a9e4b4bcbb079b5c}{cansee}(i, j))
312         \hyperlink{display_8c_a185c6ad6e4c5a6be26a371b9aa17c32e}{newsym}(i, j);
313     \}
314     \textcolor{comment}{/* Check for player now... */}
315     \textcolor{keywordflow}{if} (\hyperlink{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{inside\_region}(reg, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy})) 
316     \hyperlink{region_8h_a1e86a2debfc0c9ad315e51b3ed927e21}{set\_hero\_inside}(reg);
317     \textcolor{keywordflow}{else}
318     \hyperlink{region_8h_abe8af42aaa94b64c6db6947056a7c86f}{clear\_hero\_inside}(reg);
319 \}
\end{DoxyCode}
\hypertarget{region_8c_a1234948d428a2fc1c045dac58f9a2737}{\index{region.\+c@{region.\+c}!clear\+\_\+regions@{clear\+\_\+regions}}
\index{clear\+\_\+regions@{clear\+\_\+regions}!region.\+c@{region.\+c}}
\subsubsection[{clear\+\_\+regions}]{\setlength{\rightskip}{0pt plus 5cm}void clear\+\_\+regions (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{region_8c_a1234948d428a2fc1c045dac58f9a2737}


Definition at line 354 of file region.\+c.



References free(), free\+\_\+region(), max\+\_\+regions, n\+\_\+regions, and N\+U\+L\+L.



Referenced by clear\+\_\+level\+\_\+structures(), rest\+\_\+regions(), and save\+\_\+regions().


\begin{DoxyCode}
355 \{
356     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i;
357 
358     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}; i++)
359     \hyperlink{region_8c_a931dec1c1658099e9bee65a9752c3913}{free\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]);
360     n\_regions = 0;
361     \textcolor{keywordflow}{if} (\hyperlink{region_8c_a49ad6e0de3ce0c01574f49ca37146b2b}{max\_regions} > 0)
362     \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions});
363     \hyperlink{region_8c_a49ad6e0de3ce0c01574f49ca37146b2b}{max\_regions} = 0;
364     \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
365 \}
\end{DoxyCode}
\hypertarget{region_8c_ad093a103851bffd59e7c53f6d0e9aca1}{\index{region.\+c@{region.\+c}!create\+\_\+gas\+\_\+cloud@{create\+\_\+gas\+\_\+cloud}}
\index{create\+\_\+gas\+\_\+cloud@{create\+\_\+gas\+\_\+cloud}!region.\+c@{region.\+c}}
\subsubsection[{create\+\_\+gas\+\_\+cloud}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Nh\+Region}$\ast$ create\+\_\+gas\+\_\+cloud (
\begin{DoxyParamCaption}
\item[{{\bf xchar}}]{x, }
\item[{{\bf xchar}}]{y, }
\item[{int}]{radius, }
\item[{int}]{damage}
\end{DoxyParamCaption}
)}}\label{region_8c_ad093a103851bffd59e7c53f6d0e9aca1}


Definition at line 951 of file region.\+c.



References add\+\_\+rect\+\_\+to\+\_\+reg(), add\+\_\+region(), Nh\+Region\+::arg, cmap\+\_\+to\+\_\+glyph, create\+\_\+region(), Nh\+Region\+::expire\+\_\+f, E\+X\+P\+I\+R\+E\+\_\+\+G\+A\+S\+\_\+\+C\+L\+O\+U\+D, flags, Nh\+Region\+::glyph, nhrect\+::hx, nhrect\+::hy, in\+\_\+mklev, Nh\+Region\+::inside\+\_\+f, I\+N\+S\+I\+D\+E\+\_\+\+G\+A\+S\+\_\+\+C\+L\+O\+U\+D, nhrect\+::lx, nhrect\+::ly, flag\+::mon\+\_\+moving, rn1, S\+\_\+cloud, set\+\_\+heros\+\_\+fault, T\+R\+U\+E, Nh\+Region\+::ttl, and Nh\+Region\+::visible.


\begin{DoxyCode}
955 \{
956     \hyperlink{structNhRegion}{NhRegion} *cloud;
957     \textcolor{keywordtype}{int} i, nrect;
958     \hyperlink{structnhrect}{NhRect} tmprect;
959 
960     cloud = \hyperlink{region_8c_a8f3aaa35b03ac9f0a48221b9ca3c6464}{create\_region}((\hyperlink{structnhrect}{NhRect} *) 0, 0);
961     nrect = radius;
962     tmprect.\hyperlink{structnhrect_acfb56c33a9fd34960bb7b86f8470cdcf}{lx} = x;
963     tmprect.\hyperlink{structnhrect_a42e30acf0258a3280d0e7d39384c235d}{hx} = x;
964     tmprect.\hyperlink{structnhrect_ab036ec40a3e9eea9628acfd47c94a181}{ly} = y - (radius - 1);
965     tmprect.\hyperlink{structnhrect_a9b42981eb9df1a1b9e37a79e07b1de5e}{hy} = y + (radius - 1);
966     \textcolor{keywordflow}{for} (i = 0; i < nrect; i++) \{
967     \hyperlink{region_8c_afca3bef5449e5fdc254c8484300d2184}{add\_rect\_to\_reg}(cloud, &tmprect);
968     tmprect.\hyperlink{structnhrect_acfb56c33a9fd34960bb7b86f8470cdcf}{lx}--;
969     tmprect.\hyperlink{structnhrect_a42e30acf0258a3280d0e7d39384c235d}{hx}++;
970     tmprect.\hyperlink{structnhrect_ab036ec40a3e9eea9628acfd47c94a181}{ly}++;
971     tmprect.\hyperlink{structnhrect_a9b42981eb9df1a1b9e37a79e07b1de5e}{hy}--;
972     \}
973     cloud->\hyperlink{structNhRegion_aea256aee0ffc4bb6c00199405cf0c775}{ttl} = \hyperlink{hack_8h_af107ca092682647f298989038020f9c8}{rn1}(3,4);
974     \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_abb694ef5acb9945ca69679a8360df51a}{in\_mklev} && !\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_aefca97315c578e47f6c6cdf06864db9e}{mon\_moving})
975     \hyperlink{region_8h_adb5163d9b88dba4af8a218367c5d365f}{set\_heros\_fault}(cloud);      \textcolor{comment}{/* assume player has created it */}
976     cloud->\hyperlink{structNhRegion_a91718cb4cbceb766dad22d61e5b407fe}{inside\_f} = \hyperlink{region_8c_a3ee3f59dabf8fdeecbe7d581e628c806}{INSIDE\_GAS\_CLOUD};
977     cloud->\hyperlink{structNhRegion_ac62d1d5bbe2c6f51caea6b2771db200d}{expire\_f} = \hyperlink{region_8c_aa03b98bc502e005b85653a2922179f47}{EXPIRE\_GAS\_CLOUD};
978     cloud->\hyperlink{structNhRegion_a1d28f1a676034cbfc83cc0eb0a8a6064}{arg} = (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) \hyperlink{structdamage}{damage};
979     cloud->\hyperlink{structNhRegion_a2ab12427b9c9d84da999feba4f7ea9cd}{visible} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
980     cloud->\hyperlink{structNhRegion_ad20e42df1758728ae40670635d7c6af5}{glyph} = \hyperlink{display_8h_a77e69d3b11c3296576f840c9d11ae8fb}{cmap\_to\_glyph}(\hyperlink{rm_8h_af98109ffc75c4cff074cf96bc8b1bd04}{S\_cloud});
981     \hyperlink{region_8c_ac80264d420c6597054ef5ba186b90715}{add\_region}(cloud);
982     \textcolor{keywordflow}{return} cloud;
983 \}
\end{DoxyCode}
\hypertarget{region_8c_a8f3aaa35b03ac9f0a48221b9ca3c6464}{\index{region.\+c@{region.\+c}!create\+\_\+region@{create\+\_\+region}}
\index{create\+\_\+region@{create\+\_\+region}!region.\+c@{region.\+c}}
\subsubsection[{create\+\_\+region}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Nh\+Region}$\ast$ create\+\_\+region (
\begin{DoxyParamCaption}
\item[{{\bf Nh\+Rect} $\ast$}]{rects, }
\item[{int}]{nrect}
\end{DoxyParamCaption}
)}}\label{region_8c_a8f3aaa35b03ac9f0a48221b9ca3c6464}


Definition at line 86 of file region.\+c.



References alloc(), Nh\+Region\+::arg, Nh\+Region\+::attach\+\_\+2\+\_\+m, Nh\+Region\+::attach\+\_\+2\+\_\+u, Nh\+Region\+::bounding\+\_\+box, Nh\+Region\+::can\+\_\+enter\+\_\+f, Nh\+Region\+::can\+\_\+leave\+\_\+f, clear\+\_\+hero\+\_\+inside, clear\+\_\+heros\+\_\+fault, Nh\+Region\+::enter\+\_\+f, Nh\+Region\+::enter\+\_\+msg, Nh\+Region\+::expire\+\_\+f, F\+A\+L\+S\+E, nhrect\+::hx, nhrect\+::hy, Nh\+Region\+::inside\+\_\+f, Nh\+Region\+::leave\+\_\+f, Nh\+Region\+::leave\+\_\+msg, nhrect\+::lx, nhrect\+::ly, Nh\+Region\+::max\+\_\+monst, Nh\+Region\+::monsters, Nh\+Region\+::n\+\_\+monst, N\+O\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K, Nh\+Region\+::nrects, N\+U\+L\+L, Nh\+Region\+::rects, and Nh\+Region\+::ttl.



Referenced by create\+\_\+gas\+\_\+cloud().


\begin{DoxyCode}
89 \{
90     \textcolor{keywordtype}{int} i;
91     \hyperlink{structNhRegion}{NhRegion} *\hyperlink{structreg}{reg};
92 
93     reg = (\hyperlink{structNhRegion}{NhRegion} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(\textcolor{keyword}{sizeof} (\hyperlink{structNhRegion}{NhRegion}));
94     \textcolor{comment}{/* Determines bounding box */}
95     \textcolor{keywordflow}{if} (nrect > 0) \{
96     reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box} = rects[0];
97     \} \textcolor{keywordflow}{else} \{
98     reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_acfb56c33a9fd34960bb7b86f8470cdcf}{lx} = 99;
99     reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_ab036ec40a3e9eea9628acfd47c94a181}{ly} = 99;
100     reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_a42e30acf0258a3280d0e7d39384c235d}{hx} = 0;
101     reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_a9b42981eb9df1a1b9e37a79e07b1de5e}{hy} = 0;
102     \}
103     reg->\hyperlink{structNhRegion_a0dd5ab591144d5c85049f3d498191dff}{nrects} = nrect;
104     reg->\hyperlink{structNhRegion_a9f1ce44843237df70ccb94ace5c3d06c}{rects} = nrect > 0 ? (\hyperlink{structnhrect}{NhRect} *)\hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}((\textcolor{keyword}{sizeof} (\hyperlink{structnhrect}{NhRect})) * nrect) : 
      \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
105     \textcolor{keywordflow}{for} (i = 0; i < nrect; i++) \{
106     \textcolor{keywordflow}{if} (rects[i].lx < reg->bounding\_box.\hyperlink{structnhrect_acfb56c33a9fd34960bb7b86f8470cdcf}{lx})
107         reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_acfb56c33a9fd34960bb7b86f8470cdcf}{lx} = rects[i].\hyperlink{structnhrect_acfb56c33a9fd34960bb7b86f8470cdcf}{lx};
108     \textcolor{keywordflow}{if} (rects[i].ly < reg->bounding\_box.\hyperlink{structnhrect_ab036ec40a3e9eea9628acfd47c94a181}{ly})
109         reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_ab036ec40a3e9eea9628acfd47c94a181}{ly} = rects[i].\hyperlink{structnhrect_ab036ec40a3e9eea9628acfd47c94a181}{ly};
110     \textcolor{keywordflow}{if} (rects[i].hx > reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_a42e30acf0258a3280d0e7d39384c235d}{hx})
111         reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_a42e30acf0258a3280d0e7d39384c235d}{hx} = rects[i].\hyperlink{structnhrect_a42e30acf0258a3280d0e7d39384c235d}{hx};
112     \textcolor{keywordflow}{if} (rects[i].hy > reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_a9b42981eb9df1a1b9e37a79e07b1de5e}{hy})
113         reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_a9b42981eb9df1a1b9e37a79e07b1de5e}{hy} = rects[i].\hyperlink{structnhrect_a9b42981eb9df1a1b9e37a79e07b1de5e}{hy};
114     reg->\hyperlink{structNhRegion_a9f1ce44843237df70ccb94ace5c3d06c}{rects}[i] = rects[i];
115     \}
116     reg->\hyperlink{structNhRegion_aea256aee0ffc4bb6c00199405cf0c775}{ttl} = -1;       \textcolor{comment}{/* Defaults */}
117     reg->\hyperlink{structNhRegion_a21f1c70cde4b7c95d16fc3e452bf1c91}{attach\_2\_u} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
118     reg->\hyperlink{structNhRegion_adefa5343cc4f6d9763f0a3a0038f22ca}{attach\_2\_m} = 0;
119     \textcolor{comment}{/* reg->attach\_2\_o = NULL; */}
120     reg->\hyperlink{structNhRegion_ab95bd75bd12288706dce7a9364acc8c7}{enter\_msg} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
121     reg->\hyperlink{structNhRegion_abfaffe94b8e6f57d98abcb7e28d3bcb2}{leave\_msg} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
122     reg->\hyperlink{structNhRegion_ac62d1d5bbe2c6f51caea6b2771db200d}{expire\_f} = \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK};
123     reg->\hyperlink{structNhRegion_af9c79c43c68e34c27d7e5554abd05196}{enter\_f} = \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK};
124     reg->\hyperlink{structNhRegion_a6ecb97e787cdcba6d6142ebe85192363}{can\_enter\_f} = \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK};
125     reg->\hyperlink{structNhRegion_a667a81429ee1a23dbfc219c410706a48}{leave\_f} = \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK};
126     reg->\hyperlink{structNhRegion_aa7d11bf485e368b5a7a0ab0334c8861c}{can\_leave\_f} = \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK};
127     reg->\hyperlink{structNhRegion_a91718cb4cbceb766dad22d61e5b407fe}{inside\_f} = \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK};
128     \hyperlink{region_8h_abe8af42aaa94b64c6db6947056a7c86f}{clear\_hero\_inside}(reg);
129     \hyperlink{region_8h_ab3feeb394ad32f02c27119ca237d6833}{clear\_heros\_fault}(reg);
130     reg->\hyperlink{structNhRegion_a03e540a957b87fbd016dbee3c3c0cb9c}{n\_monst} = 0;
131     reg->\hyperlink{structNhRegion_a26e6ec350a157299cdd03820faf5948b}{max\_monst} = 0;
132     reg->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
133     reg->\hyperlink{structNhRegion_a1d28f1a676034cbfc83cc0eb0a8a6064}{arg} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
134     \textcolor{keywordflow}{return} reg;
135 \}
\end{DoxyCode}
\hypertarget{region_8c_aa44c4cae6537f43f17d1fff993447aab}{\index{region.\+c@{region.\+c}!expire\+\_\+gas\+\_\+cloud@{expire\+\_\+gas\+\_\+cloud}}
\index{expire\+\_\+gas\+\_\+cloud@{expire\+\_\+gas\+\_\+cloud}!region.\+c@{region.\+c}}
\subsubsection[{expire\+\_\+gas\+\_\+cloud}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} expire\+\_\+gas\+\_\+cloud (
\begin{DoxyParamCaption}
\item[{{\bf genericptr\+\_\+t}}]{p1, }
\item[{{\bf genericptr\+\_\+t}}]{p2}
\end{DoxyParamCaption}
)}}\label{region_8c_aa44c4cae6537f43f17d1fff993447aab}


Definition at line 876 of file region.\+c.



References Nh\+Region\+::arg, F\+A\+L\+S\+E, T\+R\+U\+E, and Nh\+Region\+::ttl.


\begin{DoxyCode}
879 \{
880     \hyperlink{structNhRegion}{NhRegion} *\hyperlink{structreg}{reg};
881     \textcolor{keywordtype}{int} \hyperlink{structdamage}{damage};
882 
883     reg = (\hyperlink{structNhRegion}{NhRegion} *) p1;
884     damage = (int) reg->\hyperlink{structNhRegion_a1d28f1a676034cbfc83cc0eb0a8a6064}{arg};
885 
886     \textcolor{comment}{/* If it was a thick cloud, it dissipates a little first */}
887     if (damage >= 5) \{
888     damage /= 2;        \textcolor{comment}{/* It dissipates, let's do less damage */}
889     reg->\hyperlink{structNhRegion_a1d28f1a676034cbfc83cc0eb0a8a6064}{arg} = (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) damage;
890     reg->\hyperlink{structNhRegion_aea256aee0ffc4bb6c00199405cf0c775}{ttl} = 2;        \textcolor{comment}{/* Here's the trick : reset ttl */}
891     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};      \textcolor{comment}{/* THEN return FALSE, means "still there" */}
892     \}
893     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};        \textcolor{comment}{/* OK, it's gone, you can free it! */}
894 \}
\end{DoxyCode}
\hypertarget{region_8c_a0203c540e2da49f81f6fcea34edb7435}{\index{region.\+c@{region.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!region.\+c@{region.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf inside\+\_\+gas\+\_\+cloud}}]{, }
\item[{({\bf genericptr}, {\bf genericptr})}]{}
\end{DoxyParamCaption}
)}}\label{region_8c_a0203c540e2da49f81f6fcea34edb7435}
\hypertarget{region_8c_a03da21a8558ff3405d5a18d80a481bd5}{\index{region.\+c@{region.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!region.\+c@{region.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf expire\+\_\+gas\+\_\+cloud}}]{, }
\item[{({\bf genericptr}, {\bf genericptr})}]{}
\end{DoxyParamCaption}
)}}\label{region_8c_a03da21a8558ff3405d5a18d80a481bd5}
\hypertarget{region_8c_ab49b8a3f9f5c0c76b90e04eedbd60b89}{\index{region.\+c@{region.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!region.\+c@{region.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf inside\+\_\+rect}}]{, }
\item[{({\bf Nh\+Rect} $\ast$, int, int)}]{}
\end{DoxyParamCaption}
)}}\label{region_8c_ab49b8a3f9f5c0c76b90e04eedbd60b89}
\hypertarget{region_8c_ac5082c71e6309f0b48fde9b5db73c289}{\index{region.\+c@{region.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!region.\+c@{region.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf inside\+\_\+region}}]{, }
\item[{({\bf Nh\+Region} $\ast$, int, int)}]{}
\end{DoxyParamCaption}
)}}\label{region_8c_ac5082c71e6309f0b48fde9b5db73c289}
\hypertarget{region_8c_a1de7d0992e81864a613a4536eda0baf2}{\index{region.\+c@{region.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!region.\+c@{region.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Nh\+Region}$\ast$ F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf create\+\_\+region}}]{, }
\item[{({\bf Nh\+Rect} $\ast$, int)}]{}
\end{DoxyParamCaption}
)}}\label{region_8c_a1de7d0992e81864a613a4536eda0baf2}
\hypertarget{region_8c_a6a5ec70081bde9223d0425d11596fce1}{\index{region.\+c@{region.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!region.\+c@{region.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf add\+\_\+rect\+\_\+to\+\_\+reg}}]{, }
\item[{({\bf Nh\+Region} $\ast$, {\bf Nh\+Rect} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{region_8c_a6a5ec70081bde9223d0425d11596fce1}
\hypertarget{region_8c_a86fb852da27249181290151b895af03b}{\index{region.\+c@{region.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!region.\+c@{region.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf add\+\_\+mon\+\_\+to\+\_\+reg}}]{, }
\item[{({\bf Nh\+Region} $\ast$, struct {\bf monst} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{region_8c_a86fb852da27249181290151b895af03b}
\hypertarget{region_8c_ac62962402018b3c0df516caa24c73307}{\index{region.\+c@{region.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!region.\+c@{region.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf remove\+\_\+mon\+\_\+from\+\_\+reg}}]{, }
\item[{({\bf Nh\+Region} $\ast$, struct {\bf monst} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{region_8c_ac62962402018b3c0df516caa24c73307}
\hypertarget{region_8c_afcc6c328e492487c613ed35d37509128}{\index{region.\+c@{region.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!region.\+c@{region.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf mon\+\_\+in\+\_\+region}}]{, }
\item[{({\bf Nh\+Region} $\ast$, struct {\bf monst} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{region_8c_afcc6c328e492487c613ed35d37509128}
\hypertarget{region_8c_ada3e256645a3f2cf437ee21861361c84}{\index{region.\+c@{region.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!region.\+c@{region.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf free\+\_\+region}}]{, }
\item[{({\bf Nh\+Region} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{region_8c_ada3e256645a3f2cf437ee21861361c84}
\hypertarget{region_8c_abf94ae7fd9f765f3b17e05681e37e44c}{\index{region.\+c@{region.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!region.\+c@{region.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf add\+\_\+region}}]{, }
\item[{({\bf Nh\+Region} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{region_8c_abf94ae7fd9f765f3b17e05681e37e44c}
\hypertarget{region_8c_a59c445c837cd09b81805cc61574d572a}{\index{region.\+c@{region.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!region.\+c@{region.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf remove\+\_\+region}}]{, }
\item[{({\bf Nh\+Region} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{region_8c_a59c445c837cd09b81805cc61574d572a}
\hypertarget{region_8c_a28064dc3c73b8ec1d55d12daca5606e2}{\index{region.\+c@{region.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!region.\+c@{region.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}static void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf reset\+\_\+region\+\_\+mids}}]{, }
\item[{({\bf Nh\+Region} $\ast$)}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{region_8c_a28064dc3c73b8ec1d55d12daca5606e2}
\hypertarget{region_8c_a931dec1c1658099e9bee65a9752c3913}{\index{region.\+c@{region.\+c}!free\+\_\+region@{free\+\_\+region}}
\index{free\+\_\+region@{free\+\_\+region}!region.\+c@{region.\+c}}
\subsubsection[{free\+\_\+region}]{\setlength{\rightskip}{0pt plus 5cm}void free\+\_\+region (
\begin{DoxyParamCaption}
\item[{{\bf Nh\+Region} $\ast$}]{reg}
\end{DoxyParamCaption}
)}}\label{region_8c_a931dec1c1658099e9bee65a9752c3913}


Definition at line 268 of file region.\+c.



References free().



Referenced by clear\+\_\+regions(), and remove\+\_\+region().


\begin{DoxyCode}
270 \{
271     \textcolor{keywordflow}{if} (reg) \{
272     \textcolor{keywordflow}{if} (reg->\hyperlink{structNhRegion_a9f1ce44843237df70ccb94ace5c3d06c}{rects})
273         \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) reg->\hyperlink{structNhRegion_a9f1ce44843237df70ccb94ace5c3d06c}{rects});
274     \textcolor{keywordflow}{if} (reg->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters})
275         \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) reg->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters});
276     \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) reg);
277     \}
278 \}
\end{DoxyCode}
\hypertarget{region_8c_a81f2ad7a49678ddc817ad507962b8d4a}{\index{region.\+c@{region.\+c}!in\+\_\+out\+\_\+region@{in\+\_\+out\+\_\+region}}
\index{in\+\_\+out\+\_\+region@{in\+\_\+out\+\_\+region}!region.\+c@{region.\+c}}
\subsubsection[{in\+\_\+out\+\_\+region}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} in\+\_\+out\+\_\+region (
\begin{DoxyParamCaption}
\item[{{\bf xchar}}]{x, }
\item[{{\bf xchar}}]{y}
\end{DoxyParamCaption}
)}}\label{region_8c_a81f2ad7a49678ddc817ad507962b8d4a}


Definition at line 419 of file region.\+c.



References Nh\+Region\+::attach\+\_\+2\+\_\+u, clear\+\_\+hero\+\_\+inside, F\+A\+L\+S\+E, hero\+\_\+inside, inside\+\_\+region(), n\+\_\+regions, N\+O\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K, N\+U\+L\+L, set\+\_\+hero\+\_\+inside, and T\+R\+U\+E.



Referenced by hurtle\+\_\+step(), and teleok().


\begin{DoxyCode}
422 \{
423     \textcolor{keywordtype}{int} i, f\_indx;
424 
425     \textcolor{comment}{/* First check if we can do the move */}
426     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}; i++) \{
427     \textcolor{keywordflow}{if} (\hyperlink{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{inside\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], x, y)
428         && !\hyperlink{region_8h_a733bc9ef577182ec953f2536653d2f41}{hero\_inside}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]) && !\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->attach\_2\_u) \{
429         \textcolor{keywordflow}{if} ((f\_indx = \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->can\_enter\_f) != \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK})
430         \textcolor{keywordflow}{if} (!(*\hyperlink{region_8c_ad29a76e7f515cea23ce07477430089bb}{callbacks}[f\_indx])(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) 0))
431             \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
432     \} \textcolor{keywordflow}{else}
433         \textcolor{keywordflow}{if} (\hyperlink{region_8h_a733bc9ef577182ec953f2536653d2f41}{hero\_inside}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i])
434         && !\hyperlink{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{inside\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], x, y)
435         && !\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->attach\_2\_u) \{
436         \textcolor{keywordflow}{if} ((f\_indx = \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->can\_leave\_f) != \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK})
437         \textcolor{keywordflow}{if} (!(*\hyperlink{region_8c_ad29a76e7f515cea23ce07477430089bb}{callbacks}[f\_indx])(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) 0))
438             \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
439     \}
440     \}
441 
442     \textcolor{comment}{/* Callbacks for the regions we do leave */}
443     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}; i++)
444     \textcolor{keywordflow}{if} (\hyperlink{region_8h_a733bc9ef577182ec953f2536653d2f41}{hero\_inside}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]) &&
445         !\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->attach\_2\_u && !\hyperlink{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{inside\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], x, y)) \{
446         \hyperlink{region_8h_abe8af42aaa94b64c6db6947056a7c86f}{clear\_hero\_inside}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]);
447         \textcolor{keywordflow}{if} (\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->leave\_msg != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
448         pline(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->leave\_msg);
449         \textcolor{keywordflow}{if} ((f\_indx = \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->leave\_f) != \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK})
450         (void) (*\hyperlink{region_8c_ad29a76e7f515cea23ce07477430089bb}{callbacks}[f\_indx])(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) 0);
451     \}
452 
453     \textcolor{comment}{/* Callbacks for the regions we do enter */}
454     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}; i++)
455     \textcolor{keywordflow}{if} (!\hyperlink{region_8h_a733bc9ef577182ec953f2536653d2f41}{hero\_inside}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]) &&
456         !\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a21f1c70cde4b7c95d16fc3e452bf1c91}{attach\_2\_u} && \hyperlink{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{inside\_region}(
      \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], x, y)) \{
457         \hyperlink{region_8h_a1e86a2debfc0c9ad315e51b3ed927e21}{set\_hero\_inside}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]);
458         \textcolor{keywordflow}{if} (\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->enter\_msg != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
459         pline(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->enter\_msg);
460         \textcolor{keywordflow}{if} ((f\_indx = \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->enter\_f) != \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK})
461         (void) (*\hyperlink{region_8c_ad29a76e7f515cea23ce07477430089bb}{callbacks}[f\_indx])(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) 0);
462     \}
463     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
464 \}
\end{DoxyCode}
\hypertarget{region_8c_ab3ffe884ed3c62bef7405ac5d3dae03c}{\index{region.\+c@{region.\+c}!inside\+\_\+gas\+\_\+cloud@{inside\+\_\+gas\+\_\+cloud}}
\index{inside\+\_\+gas\+\_\+cloud@{inside\+\_\+gas\+\_\+cloud}!region.\+c@{region.\+c}}
\subsubsection[{inside\+\_\+gas\+\_\+cloud}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} inside\+\_\+gas\+\_\+cloud (
\begin{DoxyParamCaption}
\item[{{\bf genericptr\+\_\+t}}]{p1, }
\item[{{\bf genericptr\+\_\+t}}]{p2}
\end{DoxyParamCaption}
)}}\label{region_8c_ab3ffe884ed3c62bef7405ac5d3dae03c}


Definition at line 897 of file region.\+c.



References A\+D\+\_\+\+D\+R\+S\+T, Nh\+Region\+::arg, Blind, breathless, Breathless, cansee, monst\+::data, F\+A\+L\+S\+E, haseyes, heros\+\_\+fault, K\+I\+L\+L\+E\+D\+\_\+\+B\+Y\+\_\+\+A\+N, L\+U\+N\+G, monst\+::mhp, monst\+::mx, monst\+::my, nonliving, N\+U\+L\+L, Poison\+\_\+resistance, resists\+\_\+poison, Something, T\+R\+U\+E, and youmonst.


\begin{DoxyCode}
900 \{
901     \hyperlink{structNhRegion}{NhRegion} *\hyperlink{structreg}{reg};
902     \textcolor{keyword}{struct }\hyperlink{structmonst}{monst} *mtmp;
903     \textcolor{keywordtype}{int} dam;
904 
905     reg = (\hyperlink{structNhRegion}{NhRegion} *) p1;
906     dam = (int) reg->\hyperlink{structNhRegion_a1d28f1a676034cbfc83cc0eb0a8a6064}{arg};
907     if (p2 == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}) \{       \textcolor{comment}{/* This means *YOU* Bozo! */}
908     \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_aeae2da0c70efc6db9195f4216943a3a1}{nonliving}(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) || \hyperlink{youprop_8h_abeb4d64312f013ee1f1709213d4bf8d1}{Breathless})
909         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
910     \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind})
911         make\_blinded(1L, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
912     \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a234b31b7e1eb0c71ea67cdaca939c730}{Poison\_resistance}) \{
913         pline(\textcolor{stringliteral}{"%s is burning your %s!"}, \hyperlink{decl_8h_a5d959c2baa129ffbf809d6ae5372adf5}{Something}, makeplural(body\_part(
      \hyperlink{hack_8h_aa018501b30530649b3f0c2fe383a507a}{LUNG})));
914         You(\textcolor{stringliteral}{"cough and spit blood!"});
915         losehp(rnd(dam) + 5, \textcolor{stringliteral}{"gas cloud"}, \hyperlink{decl_8h_af4e54910b730baa32b2dfbe4dd2942c1}{KILLED\_BY\_AN});
916         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
917     \} \textcolor{keywordflow}{else} \{
918         You(\textcolor{stringliteral}{"cough!"});
919         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
920     \}
921     \} \textcolor{keywordflow}{else} \{            \textcolor{comment}{/* A monster is inside the cloud */}
922     mtmp = (\textcolor{keyword}{struct }\hyperlink{structmonst}{monst} *) p2;
923 
924     \textcolor{comment}{/* Non living and non breathing monsters are not concerned */}
925     \textcolor{keywordflow}{if} (!\hyperlink{mondata_8h_aeae2da0c70efc6db9195f4216943a3a1}{nonliving}(mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) && !\hyperlink{mondata_8h_a77944b6442832379493a29ea70661a96}{breathless}(mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})) \{
926         \textcolor{keywordflow}{if} (\hyperlink{vision_8h_a857efc720262bc13a9e4b4bcbb079b5c}{cansee}(mtmp->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx}, mtmp->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my}))
927         pline(\textcolor{stringliteral}{"%s coughs!"}, Monnam(mtmp));
928         setmangry(mtmp);
929         \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_acef071254b9ae0dcf53724485be10841}{haseyes}(mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) && mtmp->mcansee) \{
930         mtmp->mblinded = 1;
931         mtmp->mcansee = 0;
932         \}
933         \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a419ec031ff4b2508bcd1304366f93ce2}{resists\_poison}(mtmp))
934         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
935         mtmp->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} -= rnd(dam) + 5;
936         \textcolor{keywordflow}{if} (mtmp->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} <= 0) \{
937         \textcolor{keywordflow}{if} (\hyperlink{region_8h_aa021d7c71c8edbc0b9e5fa1ba70acecc}{heros\_fault}(reg))
938             killed(mtmp);
939         \textcolor{keywordflow}{else}
940             monkilled(mtmp, \textcolor{stringliteral}{"gas cloud"}, \hyperlink{monattk_8h_a0ad77a3f1ad018dfbe3cb1fdad8558a7}{AD\_DRST});
941         \textcolor{keywordflow}{if} (mtmp->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} <= 0) \{    \textcolor{comment}{/* not lifesaved */}
942             \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
943         \}
944         \}
945     \}
946     \}
947     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};      \textcolor{comment}{/* Monster is still alive */}
948 \}
\end{DoxyCode}
\hypertarget{region_8c_a5a9b0626d36815ebcc0065d2046507e2}{\index{region.\+c@{region.\+c}!inside\+\_\+rect@{inside\+\_\+rect}}
\index{inside\+\_\+rect@{inside\+\_\+rect}!region.\+c@{region.\+c}}
\subsubsection[{inside\+\_\+rect}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} inside\+\_\+rect (
\begin{DoxyParamCaption}
\item[{{\bf Nh\+Rect} $\ast$}]{r, }
\item[{int}]{x, }
\item[{int}]{y}
\end{DoxyParamCaption}
)}}\label{region_8c_a5a9b0626d36815ebcc0065d2046507e2}


Definition at line 57 of file region.\+c.



Referenced by inside\+\_\+region().


\begin{DoxyCode}
60 \{
61     \textcolor{keywordflow}{return} (x >= r->\hyperlink{structnhrect_acfb56c33a9fd34960bb7b86f8470cdcf}{lx} && x <= r->hx && y >= r->\hyperlink{structnhrect_ab036ec40a3e9eea9628acfd47c94a181}{ly} && y <= r->hy);
62 \}
\end{DoxyCode}
\hypertarget{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{\index{region.\+c@{region.\+c}!inside\+\_\+region@{inside\+\_\+region}}
\index{inside\+\_\+region@{inside\+\_\+region}!region.\+c@{region.\+c}}
\subsubsection[{inside\+\_\+region}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} inside\+\_\+region (
\begin{DoxyParamCaption}
\item[{{\bf Nh\+Region} $\ast$}]{reg, }
\item[{int}]{x, }
\item[{int}]{y}
\end{DoxyParamCaption}
)}}\label{region_8c_aa1cc9f592aada753d0b4274c0468aa38}


Definition at line 68 of file region.\+c.



References F\+A\+L\+S\+E, inside\+\_\+rect(), N\+U\+L\+L, and T\+R\+U\+E.



Referenced by add\+\_\+region(), in\+\_\+out\+\_\+region(), m\+\_\+in\+\_\+out\+\_\+region(), remove\+\_\+region(), update\+\_\+monster\+\_\+region(), update\+\_\+player\+\_\+regions(), and visible\+\_\+region\+\_\+at().


\begin{DoxyCode}
71 \{
72     \textcolor{keywordtype}{int} i;
73 
74     \textcolor{keywordflow}{if} (reg == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || !\hyperlink{region_8c_a5a9b0626d36815ebcc0065d2046507e2}{inside\_rect}(&(reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}), x, y))
75     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
76     \textcolor{keywordflow}{for} (i = 0; i < reg->\hyperlink{structNhRegion_a0dd5ab591144d5c85049f3d498191dff}{nrects}; i++)
77     \textcolor{keywordflow}{if} (\hyperlink{region_8c_a5a9b0626d36815ebcc0065d2046507e2}{inside\_rect}(&(reg->\hyperlink{structNhRegion_a9f1ce44843237df70ccb94ace5c3d06c}{rects}[i]), x, y))
78         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
79     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
80 \}
\end{DoxyCode}
\hypertarget{region_8c_a3e091b3dfe784295e74b9af6a35d8098}{\index{region.\+c@{region.\+c}!m\+\_\+in\+\_\+out\+\_\+region@{m\+\_\+in\+\_\+out\+\_\+region}}
\index{m\+\_\+in\+\_\+out\+\_\+region@{m\+\_\+in\+\_\+out\+\_\+region}!region.\+c@{region.\+c}}
\subsubsection[{m\+\_\+in\+\_\+out\+\_\+region}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} m\+\_\+in\+\_\+out\+\_\+region (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mon, }
\item[{{\bf xchar}}]{x, }
\item[{{\bf xchar}}]{y}
\end{DoxyParamCaption}
)}}\label{region_8c_a3e091b3dfe784295e74b9af6a35d8098}


Definition at line 470 of file region.\+c.



References add\+\_\+mon\+\_\+to\+\_\+reg(), Nh\+Region\+::attach\+\_\+2\+\_\+u, F\+A\+L\+S\+E, hero\+\_\+inside, inside\+\_\+region(), mon\+\_\+in\+\_\+region(), n\+\_\+regions, N\+O\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K, remove\+\_\+mon\+\_\+from\+\_\+reg(), and T\+R\+U\+E.



Referenced by kickdmg(), and mhurtle\+\_\+step().


\begin{DoxyCode}
473 \{
474     \textcolor{keywordtype}{int} i, f\_indx;
475 
476     \textcolor{comment}{/* First check if we can do the move */}
477     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}; i++) \{
478     \textcolor{keywordflow}{if} (\hyperlink{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{inside\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], x, y) &&
479         !\hyperlink{region_8c_a9d136cc978d82d2e1d27aedb7bf2553d}{mon\_in\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], mon) &&
480         \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->attach\_2\_m != mon->\hyperlink{structmonst_ad8084d1c794f3903b9ffa85fca798abd}{m\_id}) \{
481         \textcolor{keywordflow}{if} ((f\_indx = \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->can\_enter\_f) != \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK})
482         \textcolor{keywordflow}{if} (!(*\hyperlink{region_8c_ad29a76e7f515cea23ce07477430089bb}{callbacks}[f\_indx])(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], mon))
483             \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
484     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{region_8c_a9d136cc978d82d2e1d27aedb7bf2553d}{mon\_in\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], mon) &&
485         !\hyperlink{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{inside\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], x, y) &&
486         \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->attach\_2\_m != mon->\hyperlink{structmonst_ad8084d1c794f3903b9ffa85fca798abd}{m\_id}) \{
487         \textcolor{keywordflow}{if} ((f\_indx = \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->can\_leave\_f) != \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK})
488         \textcolor{keywordflow}{if} (!(*\hyperlink{region_8c_ad29a76e7f515cea23ce07477430089bb}{callbacks}[f\_indx])(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], mon))
489             \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
490     \}
491     \}
492 
493     \textcolor{comment}{/* Callbacks for the regions we do leave */}
494     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}; i++)
495     \textcolor{keywordflow}{if} (\hyperlink{region_8c_a9d136cc978d82d2e1d27aedb7bf2553d}{mon\_in\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], mon) &&
496         \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->attach\_2\_m != mon->\hyperlink{structmonst_ad8084d1c794f3903b9ffa85fca798abd}{m\_id} &&
497         !\hyperlink{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{inside\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], x, y)) \{
498         \hyperlink{region_8c_a7a95cca3c19765121cb7a339f298e3e1}{remove\_mon\_from\_reg}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], mon);
499         \textcolor{keywordflow}{if} ((f\_indx = \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->leave\_f) != \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK})
500         (void) (*\hyperlink{region_8c_ad29a76e7f515cea23ce07477430089bb}{callbacks}[f\_indx])(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], mon);
501     \}
502 
503     \textcolor{comment}{/* Callbacks for the regions we do enter */}
504     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}; i++)
505     \textcolor{keywordflow}{if} (!\hyperlink{region_8h_a733bc9ef577182ec953f2536653d2f41}{hero\_inside}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]) &&
506         !\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a21f1c70cde4b7c95d16fc3e452bf1c91}{attach\_2\_u} && \hyperlink{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{inside\_region}(
      \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], x, y)) \{
507         \hyperlink{region_8c_a8658ad41f4db86cd40879880694722b9}{add\_mon\_to\_reg}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], mon);
508         \textcolor{keywordflow}{if} ((f\_indx = \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->enter\_f) != \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK})
509         (void) (*\hyperlink{region_8c_ad29a76e7f515cea23ce07477430089bb}{callbacks}[f\_indx])(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], mon);
510     \}
511     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
512 \}
\end{DoxyCode}
\hypertarget{region_8c_a9d136cc978d82d2e1d27aedb7bf2553d}{\index{region.\+c@{region.\+c}!mon\+\_\+in\+\_\+region@{mon\+\_\+in\+\_\+region}}
\index{mon\+\_\+in\+\_\+region@{mon\+\_\+in\+\_\+region}!region.\+c@{region.\+c}}
\subsubsection[{mon\+\_\+in\+\_\+region}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} mon\+\_\+in\+\_\+region (
\begin{DoxyParamCaption}
\item[{{\bf Nh\+Region} $\ast$}]{reg, }
\item[{struct {\bf monst} $\ast$}]{mon}
\end{DoxyParamCaption}
)}}\label{region_8c_a9d136cc978d82d2e1d27aedb7bf2553d}


Definition at line 216 of file region.\+c.



References F\+A\+L\+S\+E, monst\+::m\+\_\+id, and T\+R\+U\+E.



Referenced by m\+\_\+in\+\_\+out\+\_\+region(), and update\+\_\+monster\+\_\+region().


\begin{DoxyCode}
219 \{
220     \textcolor{keywordtype}{int} i;
221 
222     \textcolor{keywordflow}{for} (i = 0; i < reg->\hyperlink{structNhRegion_a03e540a957b87fbd016dbee3c3c0cb9c}{n\_monst}; i++)
223     \textcolor{keywordflow}{if} (reg->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters}[i] == mon->\hyperlink{structmonst_ad8084d1c794f3903b9ffa85fca798abd}{m\_id})
224         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
225     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
226 \}
\end{DoxyCode}
\hypertarget{region_8c_a7a95cca3c19765121cb7a339f298e3e1}{\index{region.\+c@{region.\+c}!remove\+\_\+mon\+\_\+from\+\_\+reg@{remove\+\_\+mon\+\_\+from\+\_\+reg}}
\index{remove\+\_\+mon\+\_\+from\+\_\+reg@{remove\+\_\+mon\+\_\+from\+\_\+reg}!region.\+c@{region.\+c}}
\subsubsection[{remove\+\_\+mon\+\_\+from\+\_\+reg}]{\setlength{\rightskip}{0pt plus 5cm}void remove\+\_\+mon\+\_\+from\+\_\+reg (
\begin{DoxyParamCaption}
\item[{{\bf Nh\+Region} $\ast$}]{reg, }
\item[{struct {\bf monst} $\ast$}]{mon}
\end{DoxyParamCaption}
)}}\label{region_8c_a7a95cca3c19765121cb7a339f298e3e1}


Definition at line 196 of file region.\+c.



References monst\+::m\+\_\+id.



Referenced by m\+\_\+in\+\_\+out\+\_\+region(), and update\+\_\+monster\+\_\+region().


\begin{DoxyCode}
199 \{
200     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i;
201 
202     \textcolor{keywordflow}{for} (i = 0; i < reg->\hyperlink{structNhRegion_a03e540a957b87fbd016dbee3c3c0cb9c}{n\_monst}; i++)
203     \textcolor{keywordflow}{if} (reg->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters}[i] == mon->\hyperlink{structmonst_ad8084d1c794f3903b9ffa85fca798abd}{m\_id}) \{
204         reg->\hyperlink{structNhRegion_a03e540a957b87fbd016dbee3c3c0cb9c}{n\_monst}--;
205         reg->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters}[i] = reg->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters}[reg->\hyperlink{structNhRegion_a03e540a957b87fbd016dbee3c3c0cb9c}{n\_monst}];
206         \textcolor{keywordflow}{return};
207     \}
208 \}
\end{DoxyCode}
\hypertarget{region_8c_adcca6024184d915b0aa1b7e1e9ed12ff}{\index{region.\+c@{region.\+c}!remove\+\_\+region@{remove\+\_\+region}}
\index{remove\+\_\+region@{remove\+\_\+region}!region.\+c@{region.\+c}}
\subsubsection[{remove\+\_\+region}]{\setlength{\rightskip}{0pt plus 5cm}void remove\+\_\+region (
\begin{DoxyParamCaption}
\item[{{\bf Nh\+Region} $\ast$}]{reg}
\end{DoxyParamCaption}
)}}\label{region_8c_adcca6024184d915b0aa1b7e1e9ed12ff}


Definition at line 325 of file region.\+c.



References cansee, free\+\_\+region(), inside\+\_\+region(), n\+\_\+regions, and newsym().



Referenced by rest\+\_\+regions(), and run\+\_\+regions().


\begin{DoxyCode}
327 \{
328     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i, x, y;
329 
330     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}; i++)
331     \textcolor{keywordflow}{if} (\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i] == reg)
332         \textcolor{keywordflow}{break};
333     \textcolor{keywordflow}{if} (i == n\_regions)
334     \textcolor{keywordflow}{return};
335 
336     \textcolor{comment}{/* Update screen if necessary */}
337     \textcolor{keywordflow}{if} (reg->\hyperlink{structNhRegion_a2ab12427b9c9d84da999feba4f7ea9cd}{visible})
338     \textcolor{keywordflow}{for} (x = reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_acfb56c33a9fd34960bb7b86f8470cdcf}{lx}; x <= reg->bounding\_box.hx; x++)
339         \textcolor{keywordflow}{for} (y = reg->\hyperlink{structNhRegion_a81d129b9fa7d98ab862162b7d5ea0e4d}{bounding\_box}.\hyperlink{structnhrect_ab036ec40a3e9eea9628acfd47c94a181}{ly}; y <= reg->bounding\_box.hy; y++)
340         \textcolor{keywordflow}{if} (isok(x,y) && \hyperlink{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{inside\_region}(reg, x, y) && \hyperlink{vision_8h_a857efc720262bc13a9e4b4bcbb079b5c}{cansee}(x, y))
341             \hyperlink{display_8c_a185c6ad6e4c5a6be26a371b9aa17c32e}{newsym}(x, y);
342 
343     \hyperlink{region_8c_a931dec1c1658099e9bee65a9752c3913}{free\_region}(reg);
344     \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i] = \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[n\_regions - 1];
345     \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[n\_regions - 1] = (\hyperlink{structNhRegion}{NhRegion} *) 0;
346     n\_regions--;
347 \}
\end{DoxyCode}
\hypertarget{region_8c_a5937a1dcb825953a87b78a00b03495d2}{\index{region.\+c@{region.\+c}!reset\+\_\+region\+\_\+mids@{reset\+\_\+region\+\_\+mids}}
\index{reset\+\_\+region\+\_\+mids@{reset\+\_\+region\+\_\+mids}!region.\+c@{region.\+c}}
\subsubsection[{reset\+\_\+region\+\_\+mids}]{\setlength{\rightskip}{0pt plus 5cm}static void reset\+\_\+region\+\_\+mids (
\begin{DoxyParamCaption}
\item[{{\bf Nh\+Region} $\ast$}]{reg}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{region_8c_a5937a1dcb825953a87b78a00b03495d2}


Definition at line 754 of file region.\+c.



References lookup\+\_\+id\+\_\+mapping(), and Nh\+Region\+::n\+\_\+monst.



Referenced by rest\+\_\+regions().


\begin{DoxyCode}
756 \{
757     \textcolor{keywordtype}{int} i = 0, n = reg->\hyperlink{structNhRegion_a03e540a957b87fbd016dbee3c3c0cb9c}{n\_monst};
758     \textcolor{keywordtype}{unsigned} *mid\_list = reg->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters};
759 
760     \textcolor{keywordflow}{while} (i < n)
761     \textcolor{keywordflow}{if} (!\hyperlink{restore_8c_a5d1bd4e03dc078e34d9abae5e53a646a}{lookup\_id\_mapping}(mid\_list[i], &mid\_list[i])) \{
762         \textcolor{comment}{/* shrink list to remove missing monster; order doesn't matter */}
763         mid\_list[i] = mid\_list[--n];
764     \} \textcolor{keywordflow}{else} \{
765         \textcolor{comment}{/* move on to next monster */}
766         ++i;
767     \}
768     reg->\hyperlink{structNhRegion_a03e540a957b87fbd016dbee3c3c0cb9c}{n\_monst} = n;
769     \textcolor{keywordflow}{return};
770 \}
\end{DoxyCode}
\hypertarget{region_8c_a104b720acbe4f7aa1b5a2a8545f10266}{\index{region.\+c@{region.\+c}!rest\+\_\+regions@{rest\+\_\+regions}}
\index{rest\+\_\+regions@{rest\+\_\+regions}!region.\+c@{region.\+c}}
\subsubsection[{rest\+\_\+regions}]{\setlength{\rightskip}{0pt plus 5cm}void rest\+\_\+regions (
\begin{DoxyParamCaption}
\item[{int}]{fd, }
\item[{{\bf boolean}}]{ghostly}
\end{DoxyParamCaption}
)}}\label{region_8c_a104b720acbe4f7aa1b5a2a8545f10266}


Definition at line 665 of file region.\+c.



References alloc(), clear\+\_\+hero\+\_\+inside, clear\+\_\+heros\+\_\+fault, clear\+\_\+regions(), Nh\+Region\+::enter\+\_\+msg, Nh\+Region\+::leave\+\_\+msg, Nh\+Region\+::max\+\_\+monst, max\+\_\+regions, Nh\+Region\+::monsters, moves, mread(), Nh\+Region\+::n\+\_\+monst, n\+\_\+regions, Nh\+Region\+::nrects, N\+U\+L\+L, Nh\+Region\+::rects, remove\+\_\+region(), reset\+\_\+region\+\_\+mids(), and Nh\+Region\+::ttl.



Referenced by getlev().


\begin{DoxyCode}
668 \{
669     \textcolor{keywordtype}{int} i, j;
670     \textcolor{keywordtype}{unsigned} n;
671     \textcolor{keywordtype}{long} tmstamp;
672     \textcolor{keywordtype}{char} *msg\_buf;
673 
674     \hyperlink{region_8c_a1234948d428a2fc1c045dac58f9a2737}{clear\_regions}();       \textcolor{comment}{/* Just for security */}
675     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &tmstamp, \textcolor{keyword}{sizeof} (tmstamp));
676     \textcolor{keywordflow}{if} (ghostly) tmstamp = 0;
677     \textcolor{keywordflow}{else} tmstamp = (\hyperlink{decl_8h_a2ccad6e8fb93740ed50c6d9a8f72ce2f}{moves} - tmstamp);
678     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}, \textcolor{keyword}{sizeof} (n\_regions));
679     \hyperlink{region_8c_a49ad6e0de3ce0c01574f49ca37146b2b}{max\_regions} = \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions};
680     \textcolor{keywordflow}{if} (n\_regions > 0)
681     \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions} = (\hyperlink{structNhRegion}{NhRegion} **) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(\textcolor{keyword}{sizeof} (\hyperlink{structNhRegion}{NhRegion} *) * 
      \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions});
682     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}; i++) \{
683     \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i] = (\hyperlink{structNhRegion}{NhRegion} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(\textcolor{keyword}{sizeof} (\hyperlink{structNhRegion}{NhRegion}));
684     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->bounding\_box, \textcolor{keyword}{sizeof} (
      \hyperlink{structnhrect}{NhRect}));
685     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->nrects, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
686 
687     \textcolor{keywordflow}{if} (\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->nrects > 0)
688         \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a9f1ce44843237df70ccb94ace5c3d06c}{rects} = (\hyperlink{structnhrect}{NhRect} *)
689                   \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(\textcolor{keyword}{sizeof} (\hyperlink{structnhrect}{NhRect}) * \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a0dd5ab591144d5c85049f3d498191dff}{nrects});
690     \textcolor{keywordflow}{for} (j = 0; j < \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a0dd5ab591144d5c85049f3d498191dff}{nrects}; j++)
691         \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a9f1ce44843237df70ccb94ace5c3d06c}{rects}[j], \textcolor{keyword}{sizeof} (
      \hyperlink{rect_8h_ace177dfae9a298f345a8d92a8295e55a}{NhRect}));
692     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->attach\_2\_u, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{boolean}));
693     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->attach\_2\_m, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{unsigned}));
694 
695     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, \textcolor{keyword}{sizeof} n);
696     \textcolor{keywordflow}{if} (n > 0) \{
697         msg\_buf = (\textcolor{keywordtype}{char} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(n + 1);
698         \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) msg\_buf, n);
699         msg\_buf[n] = \textcolor{charliteral}{'\(\backslash\)0'};
700         \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_ab95bd75bd12288706dce7a9364acc8c7}{enter\_msg} = (\textcolor{keyword}{const} \textcolor{keywordtype}{char} *) msg\_buf;
701     \} \textcolor{keywordflow}{else}
702         \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_ab95bd75bd12288706dce7a9364acc8c7}{enter\_msg} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
703 
704     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, \textcolor{keyword}{sizeof} n);
705     \textcolor{keywordflow}{if} (n > 0) \{
706         msg\_buf = (\textcolor{keywordtype}{char} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(n + 1);
707         \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) msg\_buf, n);
708         msg\_buf[n] = \textcolor{charliteral}{'\(\backslash\)0'};
709         \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_abfaffe94b8e6f57d98abcb7e28d3bcb2}{leave\_msg} = (\textcolor{keyword}{const} \textcolor{keywordtype}{char} *) msg\_buf;
710     \} \textcolor{keywordflow}{else}
711         \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_abfaffe94b8e6f57d98abcb7e28d3bcb2}{leave\_msg} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
712 
713     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->ttl, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
714     \textcolor{comment}{/* check for expired region */}
715     \textcolor{keywordflow}{if} (\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->ttl >= 0)
716         \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_aea256aee0ffc4bb6c00199405cf0c775}{ttl} =
717         (\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_aea256aee0ffc4bb6c00199405cf0c775}{ttl} > tmstamp) ? \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->ttl - tmstamp : 0;
718     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->expire\_f, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
719     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->can\_enter\_f, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
720     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->enter\_f, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
721     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->can\_leave\_f, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
722     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->leave\_f, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
723     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->inside\_f, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
724     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->player\_flags, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{boolean}));
725     \textcolor{keywordflow}{if} (ghostly) \{  \textcolor{comment}{/* settings pertained to old player */}
726         \hyperlink{region_8h_abe8af42aaa94b64c6db6947056a7c86f}{clear\_hero\_inside}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]);
727         \hyperlink{region_8h_ab3feeb394ad32f02c27119ca237d6833}{clear\_heros\_fault}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]);
728     \}
729     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->n\_monst, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
730     \textcolor{keywordflow}{if} (\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->n\_monst > 0)
731         \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters} =
732         (\textcolor{keywordtype}{unsigned} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(\textcolor{keyword}{sizeof} (\textcolor{keywordtype}{unsigned}) * \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a03e540a957b87fbd016dbee3c3c0cb9c}{n\_monst});
733     \textcolor{keywordflow}{else}
734         \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
735     \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a26e6ec350a157299cdd03820faf5948b}{max\_monst} = \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a03e540a957b87fbd016dbee3c3c0cb9c}{n\_monst};
736     \textcolor{keywordflow}{for} (j = 0; j < \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a03e540a957b87fbd016dbee3c3c0cb9c}{n\_monst}; j++)
737         \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters}[j],
738           \textcolor{keyword}{sizeof} (unsigned));
739     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->visible, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{boolean}));
740     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->glyph, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{int}));
741     \hyperlink{restore_8c_a4ca409c62ced3355b984139d6499732c}{mread}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->arg, \textcolor{keyword}{sizeof} (
      \hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}));
742     \}
743     \textcolor{comment}{/* remove expired regions, do not trigger the expire\_f callback (yet!);}
744 \textcolor{comment}{       also update monster lists if this data is coming from a bones file */}
745     \textcolor{keywordflow}{for} (i = n\_regions - 1; i >= 0; i--)
746     \textcolor{keywordflow}{if} (\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->ttl == 0)
747         \hyperlink{region_8c_adcca6024184d915b0aa1b7e1e9ed12ff}{remove\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]);
748     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ghostly && \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->n\_monst > 0)
749         \hyperlink{region_8c_a5937a1dcb825953a87b78a00b03495d2}{reset\_region\_mids}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]);
750 \}
\end{DoxyCode}
\hypertarget{region_8c_ab4200c4e3a725df2d919f5eac599cea6}{\index{region.\+c@{region.\+c}!run\+\_\+regions@{run\+\_\+regions}}
\index{run\+\_\+regions@{run\+\_\+regions}!region.\+c@{region.\+c}}
\subsubsection[{run\+\_\+regions}]{\setlength{\rightskip}{0pt plus 5cm}void run\+\_\+regions (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{region_8c_ab4200c4e3a725df2d919f5eac599cea6}


Definition at line 373 of file region.\+c.



References F\+M\+\_\+\+F\+M\+O\+N, hero\+\_\+inside, Nh\+Region\+::inside\+\_\+f, monst\+::mhp, Nh\+Region\+::monsters, Nh\+Region\+::n\+\_\+monst, n\+\_\+regions, N\+O\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K, remove\+\_\+region(), and Nh\+Region\+::ttl.


\begin{DoxyCode}
374 \{
375     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i, j, k;
376     \textcolor{keywordtype}{int} f\_indx;
377 
378     \textcolor{comment}{/* End of life ? */}
379     \textcolor{comment}{/* Do it backward because the array will be modified */}
380     \textcolor{keywordflow}{for} (i = \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions} - 1; i >= 0; i--) \{
381     \textcolor{keywordflow}{if} (\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->ttl == 0) \{
382         \textcolor{keywordflow}{if} ((f\_indx = \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->expire\_f) == \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK} ||
383         (*\hyperlink{region_8c_ad29a76e7f515cea23ce07477430089bb}{callbacks}[f\_indx])(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) 0))
384         \hyperlink{region_8c_adcca6024184d915b0aa1b7e1e9ed12ff}{remove\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]);
385     \}
386     \}
387 
388     \textcolor{comment}{/* Process remaining regions */}
389     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}; i++) \{
390     \textcolor{comment}{/* Make the region age */}
391     \textcolor{keywordflow}{if} (\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->ttl > 0)
392         \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_aea256aee0ffc4bb6c00199405cf0c775}{ttl}--;
393     \textcolor{comment}{/* Check if player is inside region */}
394     f\_indx = \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a91718cb4cbceb766dad22d61e5b407fe}{inside\_f};
395     \textcolor{keywordflow}{if} (f\_indx != \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK} && \hyperlink{region_8h_a733bc9ef577182ec953f2536653d2f41}{hero\_inside}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]))
396         (void) (*\hyperlink{region_8c_ad29a76e7f515cea23ce07477430089bb}{callbacks}[f\_indx])(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) 0);
397     \textcolor{comment}{/* Check if any monster is inside region */}
398     \textcolor{keywordflow}{if} (f\_indx != \hyperlink{region_8c_ab3744b941a34628f68fa585cf4ba110a}{NO\_CALLBACK}) \{
399         \textcolor{keywordflow}{for} (j = 0; j < \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a03e540a957b87fbd016dbee3c3c0cb9c}{n\_monst}; j++) \{
400         \textcolor{keyword}{struct }\hyperlink{structmonst}{monst} *mtmp = find\_mid(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->monsters[j], 
      \hyperlink{hack_8h_a1239fc371ebb320562bbc6fd639d7270}{FM\_FMON});
401 
402         \textcolor{keywordflow}{if} (!mtmp || mtmp->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} <= 0 ||
403                 (*\hyperlink{region_8c_ad29a76e7f515cea23ce07477430089bb}{callbacks}[f\_indx])(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], mtmp)) \{
404             \textcolor{comment}{/* The monster died, remove it from list */}
405             k = (\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a03e540a957b87fbd016dbee3c3c0cb9c}{n\_monst} -= 1);
406             \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters}[j] = \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters}[k];
407             \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a22e5c3cedd81f1f8f83ee6badc4e0ceb}{monsters}[k] = 0;
408             --j;    \textcolor{comment}{/* current slot has been reused; recheck it next */}
409         \}
410         \}
411     \}
412     \}
413 \}
\end{DoxyCode}
\hypertarget{region_8c_a838af489fa2b6468bef800775160f074}{\index{region.\+c@{region.\+c}!save\+\_\+regions@{save\+\_\+regions}}
\index{save\+\_\+regions@{save\+\_\+regions}!region.\+c@{region.\+c}}
\subsubsection[{save\+\_\+regions}]{\setlength{\rightskip}{0pt plus 5cm}void save\+\_\+regions (
\begin{DoxyParamCaption}
\item[{int}]{fd, }
\item[{int}]{mode}
\end{DoxyParamCaption}
)}}\label{region_8c_a838af489fa2b6468bef800775160f074}
save\+\_\+regions \+: 

Definition at line 615 of file region.\+c.



References bwrite(), clear\+\_\+regions(), Nh\+Region\+::enter\+\_\+msg, Nh\+Region\+::leave\+\_\+msg, moves, Nh\+Region\+::n\+\_\+monst, n\+\_\+regions, Nh\+Region\+::nrects, N\+U\+L\+L, perform\+\_\+bwrite, and release\+\_\+data.



Referenced by savelev().


\begin{DoxyCode}
618 \{
619     \textcolor{keywordtype}{int} i, j;
620     \textcolor{keywordtype}{unsigned} n;
621 
622     \textcolor{keywordflow}{if} (!\hyperlink{lev_8h_a4bb5a4c92746bd81c40d1452ca38dda7}{perform\_bwrite}(mode)) \textcolor{keywordflow}{goto} skip\_lots;
623 
624     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{decl_8h_a2ccad6e8fb93740ed50c6d9a8f72ce2f}{moves}, \textcolor{keyword}{sizeof} (moves));   \textcolor{comment}{/* timestamp */}
625     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}, \textcolor{keyword}{sizeof} (n\_regions));
626     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}; i++) \{
627     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->bounding\_box, \textcolor{keyword}{sizeof} (
      \hyperlink{structnhrect}{NhRect}));
628     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->nrects, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
629     \textcolor{keywordflow}{for} (j = 0; j < \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a0dd5ab591144d5c85049f3d498191dff}{nrects}; j++)
630         \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->rects[j], \textcolor{keyword}{sizeof} (
      \hyperlink{structnhrect}{NhRect}));
631     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->attach\_2\_u, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{boolean}));
632     n = 0;
633     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->attach\_2\_m, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{unsigned}));
634     n = \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_ab95bd75bd12288706dce7a9364acc8c7}{enter\_msg} != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} ? strlen(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->enter\_msg) : 0;
635     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, \textcolor{keyword}{sizeof} n);
636     \textcolor{keywordflow}{if} (n > 0)
637         \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->enter\_msg, n);
638     n = \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_abfaffe94b8e6f57d98abcb7e28d3bcb2}{leave\_msg} != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} ? strlen(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->leave\_msg) : 0;
639     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, \textcolor{keyword}{sizeof} n);
640     \textcolor{keywordflow}{if} (n > 0)
641         \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->leave\_msg, n);
642     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->ttl, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
643     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->expire\_f, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
644     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->can\_enter\_f, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
645     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->enter\_f, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
646     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->can\_leave\_f, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
647     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->leave\_f, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
648     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->inside\_f, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
649     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->player\_flags, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{boolean}));
650     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->n\_monst, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{short}));
651     \textcolor{keywordflow}{for} (j = 0; j < \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->\hyperlink{structNhRegion_a03e540a957b87fbd016dbee3c3c0cb9c}{n\_monst}; j++)
652         \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->monsters[j],
653          \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{unsigned}));
654     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->visible, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{boolean}));
655     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->glyph, \textcolor{keyword}{sizeof} (\textcolor{keywordtype}{int}));
656     \hyperlink{save_8c_a2e7663422968049372dd9cc6b325a84a}{bwrite}(fd, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->arg, \textcolor{keyword}{sizeof} (
      \hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}));
657     \}
658 
659 skip\_lots:
660     \textcolor{keywordflow}{if} (\hyperlink{lev_8h_a3d5ce4c0a0247545f80a66eadddc6273}{release\_data}(mode))
661     \hyperlink{region_8c_a1234948d428a2fc1c045dac58f9a2737}{clear\_regions}();
662 \}
\end{DoxyCode}
\hypertarget{region_8c_a7174f218af0821b5b14b871be883a6ac}{\index{region.\+c@{region.\+c}!show\+\_\+region@{show\+\_\+region}}
\index{show\+\_\+region@{show\+\_\+region}!region.\+c@{region.\+c}}
\subsubsection[{show\+\_\+region}]{\setlength{\rightskip}{0pt plus 5cm}void show\+\_\+region (
\begin{DoxyParamCaption}
\item[{{\bf Nh\+Region} $\ast$}]{reg, }
\item[{{\bf xchar}}]{x, }
\item[{{\bf xchar}}]{y}
\end{DoxyParamCaption}
)}}\label{region_8c_a7174f218af0821b5b14b871be883a6ac}


Definition at line 604 of file region.\+c.



References show\+\_\+glyph().



Referenced by newsym().


\begin{DoxyCode}
607 \{
608     \hyperlink{display_8c_a60d3cfb0df75b80c36125ce154da217f}{show\_glyph}(x, y, reg->\hyperlink{structNhRegion_ad20e42df1758728ae40670635d7c6af5}{glyph});
609 \}
\end{DoxyCode}
\hypertarget{region_8c_a00b2aa38f5d577f959a3c5ce97e8aa5a}{\index{region.\+c@{region.\+c}!update\+\_\+monster\+\_\+region@{update\+\_\+monster\+\_\+region}}
\index{update\+\_\+monster\+\_\+region@{update\+\_\+monster\+\_\+region}!region.\+c@{region.\+c}}
\subsubsection[{update\+\_\+monster\+\_\+region}]{\setlength{\rightskip}{0pt plus 5cm}void update\+\_\+monster\+\_\+region (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mon}
\end{DoxyParamCaption}
)}}\label{region_8c_a00b2aa38f5d577f959a3c5ce97e8aa5a}


Definition at line 533 of file region.\+c.



References add\+\_\+mon\+\_\+to\+\_\+reg(), inside\+\_\+region(), mon\+\_\+in\+\_\+region(), n\+\_\+regions, and remove\+\_\+mon\+\_\+from\+\_\+reg().



Referenced by rloc\+\_\+to().


\begin{DoxyCode}
535 \{
536     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i;
537 
538     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}; i++) \{
539     \textcolor{keywordflow}{if} (\hyperlink{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{inside\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], mon->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx}, mon->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my})) \{
540         \textcolor{keywordflow}{if} (!\hyperlink{region_8c_a9d136cc978d82d2e1d27aedb7bf2553d}{mon\_in\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], mon))
541         \hyperlink{region_8c_a8658ad41f4db86cd40879880694722b9}{add\_mon\_to\_reg}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], mon);
542     \} \textcolor{keywordflow}{else} \{
543         \textcolor{keywordflow}{if} (\hyperlink{region_8c_a9d136cc978d82d2e1d27aedb7bf2553d}{mon\_in\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], mon))
544         \hyperlink{region_8c_a7a95cca3c19765121cb7a339f298e3e1}{remove\_mon\_from\_reg}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], mon);
545     \}
546     \}
547 \}
\end{DoxyCode}
\hypertarget{region_8c_aa3f81ca2a9d868ca9b8eb54511903561}{\index{region.\+c@{region.\+c}!update\+\_\+player\+\_\+regions@{update\+\_\+player\+\_\+regions}}
\index{update\+\_\+player\+\_\+regions@{update\+\_\+player\+\_\+regions}!region.\+c@{region.\+c}}
\subsubsection[{update\+\_\+player\+\_\+regions}]{\setlength{\rightskip}{0pt plus 5cm}void update\+\_\+player\+\_\+regions (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{region_8c_aa3f81ca2a9d868ca9b8eb54511903561}


Definition at line 518 of file region.\+c.



References clear\+\_\+hero\+\_\+inside, inside\+\_\+region(), n\+\_\+regions, set\+\_\+hero\+\_\+inside, u, you\+::ux, and you\+::uy.



Referenced by teleds().


\begin{DoxyCode}
519 \{
520     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i;
521 
522     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}; i++)
523     \textcolor{keywordflow}{if} (!\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->attach\_2\_u && \hyperlink{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{inside\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], 
      \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}))
524         \hyperlink{region_8h_a1e86a2debfc0c9ad315e51b3ed927e21}{set\_hero\_inside}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]);
525     \textcolor{keywordflow}{else}
526         \hyperlink{region_8h_abe8af42aaa94b64c6db6947056a7c86f}{clear\_hero\_inside}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]);
527 \}
\end{DoxyCode}
\hypertarget{region_8c_ad2448764df1a831e33023c09f85b5efb}{\index{region.\+c@{region.\+c}!visible\+\_\+region\+\_\+at@{visible\+\_\+region\+\_\+at}}
\index{visible\+\_\+region\+\_\+at@{visible\+\_\+region\+\_\+at}!region.\+c@{region.\+c}}
\subsubsection[{visible\+\_\+region\+\_\+at}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Nh\+Region}$\ast$ visible\+\_\+region\+\_\+at (
\begin{DoxyParamCaption}
\item[{{\bf xchar}}]{x, }
\item[{{\bf xchar}}]{y}
\end{DoxyParamCaption}
)}}\label{region_8c_ad2448764df1a831e33023c09f85b5efb}


Definition at line 591 of file region.\+c.



References inside\+\_\+region(), and n\+\_\+regions.



Referenced by newsym().


\begin{DoxyCode}
593 \{
594     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i;
595 
596     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{n\_regions}; i++)
597     \textcolor{keywordflow}{if} (\hyperlink{region_8c_aa1cc9f592aada753d0b4274c0468aa38}{inside\_region}(\hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i], x, y) && \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->visible &&
598         \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i]->ttl != 0)
599         \textcolor{keywordflow}{return} \hyperlink{region_8c_a7c171e1308442c331b8dc535b5acac90}{regions}[i];
600     \textcolor{keywordflow}{return} (\hyperlink{structNhRegion}{NhRegion} *) 0;
601 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{region_8c_ad29a76e7f515cea23ce07477430089bb}{\index{region.\+c@{region.\+c}!callbacks@{callbacks}}
\index{callbacks@{callbacks}!region.\+c@{region.\+c}}
\subsubsection[{callbacks}]{\setlength{\rightskip}{0pt plus 5cm}callback\+\_\+proc callbacks\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}}\label{region_8c_ad29a76e7f515cea23ce07477430089bb}
{\bfseries Initial value\+:}
\begin{DoxyCode}
= \{
\textcolor{preprocessor}{#define INSIDE\_GAS\_CLOUD}
    \hyperlink{region_8c_ab3ffe884ed3c62bef7405ac5d3dae03c}{inside\_gas\_cloud},
\textcolor{preprocessor}{#define EXPIRE\_GAS\_CLOUD}
    \hyperlink{region_8c_aa44c4cae6537f43f17d1fff993447aab}{expire\_gas\_cloud}
\}
\end{DoxyCode}


Definition at line 48 of file region.\+c.

\hypertarget{region_8c_a49ad6e0de3ce0c01574f49ca37146b2b}{\index{region.\+c@{region.\+c}!max\+\_\+regions@{max\+\_\+regions}}
\index{max\+\_\+regions@{max\+\_\+regions}!region.\+c@{region.\+c}}
\subsubsection[{max\+\_\+regions}]{\setlength{\rightskip}{0pt plus 5cm}int max\+\_\+regions = 0\hspace{0.3cm}{\ttfamily [static]}}}\label{region_8c_a49ad6e0de3ce0c01574f49ca37146b2b}


Definition at line 16 of file region.\+c.



Referenced by add\+\_\+region(), clear\+\_\+regions(), and rest\+\_\+regions().

\hypertarget{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}{\index{region.\+c@{region.\+c}!n\+\_\+regions@{n\+\_\+regions}}
\index{n\+\_\+regions@{n\+\_\+regions}!region.\+c@{region.\+c}}
\subsubsection[{n\+\_\+regions}]{\setlength{\rightskip}{0pt plus 5cm}int n\+\_\+regions = 0\hspace{0.3cm}{\ttfamily [static]}}}\label{region_8c_a36612376ef62bc615b6d88d20ff9c7bc}


Definition at line 15 of file region.\+c.



Referenced by add\+\_\+region(), clear\+\_\+regions(), in\+\_\+out\+\_\+region(), m\+\_\+in\+\_\+out\+\_\+region(), remove\+\_\+region(), rest\+\_\+regions(), run\+\_\+regions(), save\+\_\+regions(), update\+\_\+monster\+\_\+region(), update\+\_\+player\+\_\+regions(), and visible\+\_\+region\+\_\+at().

\hypertarget{region_8c_a7c171e1308442c331b8dc535b5acac90}{\index{region.\+c@{region.\+c}!regions@{regions}}
\index{regions@{regions}!region.\+c@{region.\+c}}
\subsubsection[{regions}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Nh\+Region}$\ast$$\ast$ regions\hspace{0.3cm}{\ttfamily [static]}}}\label{region_8c_a7c171e1308442c331b8dc535b5acac90}


Definition at line 14 of file region.\+c.



Referenced by add\+\_\+region(), and store\+\_\+part().

