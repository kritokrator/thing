\hypertarget{uhitm_8c}{\section{nethack/src/uhitm.c File Reference}
\label{uhitm_8c}\index{nethack/src/uhitm.\+c@{nethack/src/uhitm.\+c}}
}
{\ttfamily \#include \char`\"{}hack.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{uhitm_8c_ade7c6c1f9ae8773e71eaf21c459e1ad3}{P\+R\+O\+J\+E\+C\+T\+I\+L\+E}(\hyperlink{structobj}{obj})~((\hyperlink{structobj}{obj}) \&\& \hyperlink{obj_8h_a17d7bf4a6f8336a314c0825cf5848c54}{is\+\_\+ammo}(\hyperlink{structobj}{obj}))
\item 
\#define \hyperlink{uhitm_8c_a823c59fec9a6bf95417f316132d628bc}{useup\+\_\+eggs}(o)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_aa0a563189042dbb18101357c34d1acab}{F\+D\+E\+C\+L} (\hyperlink{uhitm_8c_a584798493588e0c419478797a914e2e2}{known\+\_\+hitum},(struct \hyperlink{structmonst}{monst} $\ast$, int $\ast$, struct \hyperlink{structattack}{attack} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{uhitm_8c_a76b6db90700c45f5adc8c89a391a1b58}{F\+D\+E\+C\+L} (\hyperlink{uhitm_8c_a80be2dc85a675fa92ad7a3db308f7ea0}{steal\+\_\+it},(struct \hyperlink{structmonst}{monst} $\ast$, struct \hyperlink{structattack}{attack} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_a382a07c83a71ab3e7bbcd599292a0df6}{F\+D\+E\+C\+L} (\hyperlink{uhitm_8c_a81df17e7bc6a68bef3eda955de3071b5}{hitum},(struct \hyperlink{structmonst}{monst} $\ast$, int, struct \hyperlink{structattack}{attack} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_a518b392defbc5730bd8a680d2bc47969}{F\+D\+E\+C\+L} (\hyperlink{uhitm_8c_a9d8bafc68920d5deaaaf935d11709739}{hmon\+\_\+hitmon},(struct \hyperlink{structmonst}{monst} $\ast$, struct \hyperlink{structobj}{obj} $\ast$, int))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{uhitm_8c_a68828eab656038be96a4e7aa5fdd50a0}{N\+D\+E\+C\+L} (\hyperlink{uhitm_8c_a005f8dfabd122add00fcc0cc6fa609a4}{demonpet})
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_a18590d5e03a1b2dbafa6ffa0bfa29e21}{F\+D\+E\+C\+L} (\hyperlink{uhitm_8c_a5544110e943377e363a5ae2c9af36c21}{m\+\_\+slips\+\_\+free},(struct \hyperlink{structmonst}{monst} $\ast$mtmp, struct \hyperlink{structattack}{attack} $\ast$mattk))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int \hyperlink{uhitm_8c_a9cc403583021510fa698a78b0cde8b0b}{F\+D\+E\+C\+L} (\hyperlink{uhitm_8c_a118a7e755b7b9cf312ae6e64f8f66b76}{explum},(struct \hyperlink{structmonst}{monst} $\ast$, struct \hyperlink{structattack}{attack} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{uhitm_8c_a0f8b2ccf27d6ca3057799c4368810325}{F\+D\+E\+C\+L} (\hyperlink{uhitm_8c_a8fc39daab97b65a360b7b6f6ac1e823c}{start\+\_\+engulf},(struct \hyperlink{structmonst}{monst} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{uhitm_8c_a105f81f322fd589353fd89ec7f706b1a}{N\+D\+E\+C\+L} (\hyperlink{uhitm_8c_a1f2b299c2f3ac467c7005cc711ba82c9}{end\+\_\+engulf})
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int \hyperlink{uhitm_8c_a422d61b174b27bd858725eafae3da908}{F\+D\+E\+C\+L} (\hyperlink{uhitm_8c_a913d911a86233fa27072d31fca8c5b3d}{gulpum},(struct \hyperlink{structmonst}{monst} $\ast$, struct \hyperlink{structattack}{attack} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_a55a2373ce055c5cac55d715e75160a66}{F\+D\+E\+C\+L} (\hyperlink{uhitm_8c_a62c1aa5da793b72c6de8bac7688a7365}{hmonas},(struct \hyperlink{structmonst}{monst} $\ast$, int))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{uhitm_8c_a7722983cb5ed23bd376be91575f75894}{F\+D\+E\+C\+L} (\hyperlink{uhitm_8c_a193cbe8cfeaa05ef43a9440da9a8fa5e}{nohandglow},(struct \hyperlink{structmonst}{monst} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_a31925a96adb34b1243ecea4a7cd1d886}{F\+D\+E\+C\+L} (\hyperlink{uhitm_8c_acd4cf489934613a8161f8a797b09c1a9}{shade\+\_\+aware},(struct \hyperlink{structobj}{obj} $\ast$))
\item 
void \hyperlink{uhitm_8c_a7dd49fa34e369a004e933f1c8fa83ca3}{hurtmarmor} (struct \hyperlink{structmonst}{monst} $\ast$mdef, int attk)
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_a3a8da2446d2ea20bc06ffd4ad7ec3301}{attack\+\_\+checks} (struct \hyperlink{structmonst}{monst} $\ast$mtmp, struct \hyperlink{structobj}{obj} $\ast$wep)
\item 
void \hyperlink{uhitm_8c_afec61dbcb8ae406b1caf9d8079627b60}{check\+\_\+caitiff} (struct \hyperlink{structmonst}{monst} $\ast$mtmp)
\item 
\hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} \hyperlink{uhitm_8c_accae76bf34141d0859a6a4476e4720ee}{find\+\_\+roll\+\_\+to\+\_\+hit} (struct \hyperlink{structmonst}{monst} $\ast$mtmp)
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_a320cdd3d1303b45eb1cfb2e59125911a}{attack} (struct \hyperlink{structmonst}{monst} $\ast$mtmp)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_a584798493588e0c419478797a914e2e2}{known\+\_\+hitum} (struct \hyperlink{structmonst}{monst} $\ast$mon, int $\ast$mhit, struct \hyperlink{structattack}{attack} $\ast$uattk)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_a81df17e7bc6a68bef3eda955de3071b5}{hitum} (struct \hyperlink{structmonst}{monst} $\ast$mon, int tmp, struct \hyperlink{structattack}{attack} $\ast$uattk)
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_a995bc5394db9ea09e5851976d7f9f755}{hmon} (struct \hyperlink{structmonst}{monst} $\ast$mon, struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj}, int thrown)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_a9d8bafc68920d5deaaaf935d11709739}{hmon\+\_\+hitmon} (struct \hyperlink{structmonst}{monst} $\ast$mon, struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj}, int thrown)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_acd4cf489934613a8161f8a797b09c1a9}{shade\+\_\+aware} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj})
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_a5544110e943377e363a5ae2c9af36c21}{m\+\_\+slips\+\_\+free} (struct \hyperlink{structmonst}{monst} $\ast$mdef, struct \hyperlink{structattack}{attack} $\ast$mattk)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int \hyperlink{uhitm_8c_a6fea92a8b59242c71925035e7879612b}{joust} (struct \hyperlink{structmonst}{monst} $\ast$mon, struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj})
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{uhitm_8c_a005f8dfabd122add00fcc0cc6fa609a4}{demonpet} ()
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{uhitm_8c_a80be2dc85a675fa92ad7a3db308f7ea0}{steal\+\_\+it} (struct \hyperlink{structmonst}{monst} $\ast$mdef, struct \hyperlink{structattack}{attack} $\ast$mattk)
\item 
int \hyperlink{uhitm_8c_a7e41ad4604083ffd2e383d9cde262df9}{damageum} (struct \hyperlink{structmonst}{monst} $\ast$mdef, struct \hyperlink{structattack}{attack} $\ast$mattk)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int \hyperlink{uhitm_8c_a118a7e755b7b9cf312ae6e64f8f66b76}{explum} (struct \hyperlink{structmonst}{monst} $\ast$mdef, struct \hyperlink{structattack}{attack} $\ast$mattk)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{uhitm_8c_a8fc39daab97b65a360b7b6f6ac1e823c}{start\+\_\+engulf} (struct \hyperlink{structmonst}{monst} $\ast$mdef)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{uhitm_8c_a1f2b299c2f3ac467c7005cc711ba82c9}{end\+\_\+engulf} ()
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int \hyperlink{uhitm_8c_a913d911a86233fa27072d31fca8c5b3d}{gulpum} (struct \hyperlink{structmonst}{monst} $\ast$mdef, struct \hyperlink{structattack}{attack} $\ast$mattk)
\item 
void \hyperlink{uhitm_8c_a2105b902082a7c3513754beaa432e7b6}{missum} (struct \hyperlink{structmonst}{monst} $\ast$mdef, struct \hyperlink{structattack}{attack} $\ast$mattk)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_a62c1aa5da793b72c6de8bac7688a7365}{hmonas} (struct \hyperlink{structmonst}{monst} $\ast$mon, int tmp)
\item 
int \hyperlink{uhitm_8c_a53e92ab7e839e04fe836f61047b8b34c}{passive} (struct \hyperlink{structmonst}{monst} $\ast$mon, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} mhit, int malive, \hyperlink{config_8h_a65f85814a8290f9797005d3b28e7e5fc}{uchar} aatyp)
\item 
void \hyperlink{uhitm_8c_a05b517f10f304b12c4424521ae517c02}{passive\+\_\+obj} (struct \hyperlink{structmonst}{monst} $\ast$mon, struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj}, struct \hyperlink{structattack}{attack} $\ast$mattk)
\item 
void \hyperlink{uhitm_8c_a9e547eaf1632538055c0a209af4b2273}{stumble\+\_\+onto\+\_\+mimic} (struct \hyperlink{structmonst}{monst} $\ast$mtmp)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{uhitm_8c_a193cbe8cfeaa05ef43a9440da9a8fa5e}{nohandglow} (struct \hyperlink{structmonst}{monst} $\ast$mon)
\item 
int \hyperlink{uhitm_8c_ae7936c7531c0a357fdbf6015a820eac9}{flash\+\_\+hits\+\_\+mon} (struct \hyperlink{structmonst}{monst} $\ast$mtmp, struct \hyperlink{structobj}{obj} $\ast$\hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_aa0fe2fdb5136cb5a8960dd3b1f24031a}{notonhead}
\item 
static int \hyperlink{uhitm_8c_ac2d2b71a2fe853fe47029a09aed9aca0}{dieroll}
\item 
static \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{uhitm_8c_a2bc8b513f9502ca3b16e7a154f259057}{override\+\_\+confirmation} = \hyperlink{xpm2img_8c_aa93f0eb578d23995850d61f7d61c55c1}{F\+A\+L\+S\+E}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{uhitm_8c_ade7c6c1f9ae8773e71eaf21c459e1ad3}{\index{uhitm.\+c@{uhitm.\+c}!P\+R\+O\+J\+E\+C\+T\+I\+L\+E@{P\+R\+O\+J\+E\+C\+T\+I\+L\+E}}
\index{P\+R\+O\+J\+E\+C\+T\+I\+L\+E@{P\+R\+O\+J\+E\+C\+T\+I\+L\+E}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{P\+R\+O\+J\+E\+C\+T\+I\+L\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+R\+O\+J\+E\+C\+T\+I\+L\+E(
\begin{DoxyParamCaption}
\item[{}]{{\bf obj}}
\end{DoxyParamCaption}
)~(({\bf obj}) \&\& {\bf is\+\_\+ammo}({\bf obj}))}}\label{uhitm_8c_ade7c6c1f9ae8773e71eaf21c459e1ad3}


Definition at line 30 of file uhitm.\+c.



Referenced by hmon\+\_\+hitmon().

\hypertarget{uhitm_8c_a823c59fec9a6bf95417f316132d628bc}{\index{uhitm.\+c@{uhitm.\+c}!useup\+\_\+eggs@{useup\+\_\+eggs}}
\index{useup\+\_\+eggs@{useup\+\_\+eggs}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{useup\+\_\+eggs}]{\setlength{\rightskip}{0pt plus 5cm}\#define useup\+\_\+eggs(
\begin{DoxyParamCaption}
\item[{}]{o}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a823c59fec9a6bf95417f316132d628bc}
{\bfseries Value\+:}
\begin{DoxyCode}
\{ \textcolor{keywordflow}{if} (thrown) obfree(o,(\textcolor{keyword}{struct} \hyperlink{structobj}{obj} *)0); \(\backslash\)
              else useupall(o); \(\backslash\)
              o = (\textcolor{keyword}{struct }\hyperlink{structobj}{obj} *)0; \} \textcolor{comment}{/* now gone */}
\end{DoxyCode}


Referenced by hmon\+\_\+hitmon().



\subsection{Function Documentation}
\hypertarget{uhitm_8c_a320cdd3d1303b45eb1cfb2e59125911a}{\index{uhitm.\+c@{uhitm.\+c}!attack@{attack}}
\index{attack@{attack}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{attack}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} {\bf attack} (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mtmp}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a320cdd3d1303b45eb1cfb2e59125911a}


Definition at line 293 of file uhitm.\+c.



References A\+\_\+\+S\+T\+R, attack\+\_\+checks(), buf, B\+U\+F\+S\+Z, can\+\_\+twoweapon(), canspotmon, cantwield, monst\+::data, you\+::dx, you\+::dy, F\+A\+L\+S\+E, find\+\_\+roll\+\_\+to\+\_\+hit(), flags, flag\+::forcefight, glyph\+\_\+is\+\_\+invisible, H\+A\+N\+D, hitum(), hmonas(), is\+\_\+longworm, I\+S\+\_\+\+R\+O\+C\+K, is\+\_\+safepet, levl, map\+\_\+invisible(), permonst\+::mattk, permonst\+::mlet, obj\+::oartifact, passes\+\_\+walls, Punished, Role\+\_\+if, R\+O\+O\+M\+O\+F\+F\+S\+E\+T, rooms, S\+\_\+\+L\+E\+P\+R\+E\+C\+H\+A\+U\+N, S\+H\+O\+P\+B\+A\+S\+E, S\+T\+R\+A\+T\+\_\+\+W\+A\+I\+T\+M\+A\+S\+K, Strcpy, T\+R\+U\+E, you\+::twoweap, u, uarmg, untwoweapon(), unweapon, Upolyd, you\+::ustuck, uwep, you\+::ux, you\+::uy, flag\+::verbose, and youmonst.


\begin{DoxyCode}
295 \{
296     \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} tmp;
297     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structpermonst}{permonst} *mdat = mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data};
298 
299     \textcolor{comment}{/* This section of code provides protection against accidentally}
300 \textcolor{comment}{     * hitting peaceful (like '@') and tame (like 'd') monsters.}
301 \textcolor{comment}{     * Protection is provided as long as player is not: blind, confused,}
302 \textcolor{comment}{     * hallucinating or stunned.}
303 \textcolor{comment}{     * changes by wwp 5/16/85}
304 \textcolor{comment}{     * More changes 12/90, -dkh-. if its tame and safepet, (and protected}
305 \textcolor{comment}{     * 07/92) then we assume that you're not trying to attack. Instead,}
306 \textcolor{comment}{     * you'll usually just swap places if this is a movement command}
307 \textcolor{comment}{     */}
308     \textcolor{comment}{/* Intelligent chaotic weapons (Stormbringer) want blood */}
309     \textcolor{keywordflow}{if} (\hyperlink{display_8h_a017f4307c07f0f4e272bfa82602bab99}{is\_safepet}(mtmp) && !\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a527b68a0e2b522d3233eff485aa5f3fc}{forcefight}) \{
310         \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} || \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}->\hyperlink{structobj_af03ce8a6a0ca51e8d8954fb1a1a31fbe}{oartifact} != ART\_STORMBRINGER) \{
311         \textcolor{comment}{/* there are some additional considerations: this won't work}
312 \textcolor{comment}{         * if in a shop or Punished or you miss a random roll or}
313 \textcolor{comment}{         * if you can walk thru walls and your pet cannot (KAA) or}
314 \textcolor{comment}{         * if your pet is a long worm (unless someone does better).}
315 \textcolor{comment}{         * there's also a chance of displacing a "frozen" monster.}
316 \textcolor{comment}{         * sleeping monsters might magically walk in their sleep.}
317 \textcolor{comment}{         */}
318         \textcolor{keywordtype}{boolean} foo = (\hyperlink{youprop_8h_ad76daf081117eb579839073bebe92b45}{Punished} || !rn2(7) || \hyperlink{mondata_8h_ab416708e04e3a2e7d9f4ac450a260db1}{is\_longworm}(mtmp->
      \hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})),
319             inshop = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
320         \textcolor{keywordtype}{char} *p;
321 
322         \textcolor{keywordflow}{for} (p = in\_rooms(mtmp->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx}, mtmp->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my}, \hyperlink{mkroom_8h_a925701a88c7ed0db502cfac9d8fbcf9e}{SHOPBASE}); *p; p++)
323             \textcolor{keywordflow}{if} (tended\_shop(&\hyperlink{mkroom_8h_a45030df62e6451e79233760364dca9e1}{rooms}[*p - \hyperlink{mkroom_8h_acc0f2416007c594c5d38f980dedc1b68}{ROOMOFFSET}])) \{
324             inshop = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
325             \textcolor{keywordflow}{break};
326             \}
327 
328         \textcolor{keywordflow}{if} (inshop || foo ||
329             (\hyperlink{rm_8h_a041df081d95aacdcbf31a3bbfdd36e0e}{IS\_ROCK}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}][\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}].typ) &&
330                     !\hyperlink{mondata_8h_a42b9f266cafddebd01c657d1e39ae72d}{passes\_walls}(mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}))) \{
331             \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
332 
333             monflee(mtmp, rnd(6), \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
334             \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(buf, y\_monnam(mtmp));
335             buf[0] = highc(buf[0]);
336             You(\textcolor{stringliteral}{"stop.  %s is in the way!"}, buf);
337             \textcolor{keywordflow}{return}(\hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
338         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((mtmp->mfrozen || (! mtmp->mcanmove)
339                 || (mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_a939712c539eb16cf6cb51e58ae1c12b0}{mmove} == 0)) && rn2(6)) \{
340             pline(\textcolor{stringliteral}{"%s doesn't seem to move!"}, Monnam(mtmp));
341             \textcolor{keywordflow}{return}(\hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
342         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{return}(\hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
343         \}
344     \}
345 
346     \textcolor{comment}{/* possibly set in attack\_checks;}
347 \textcolor{comment}{       examined in known\_hitum, called via hitum or hmonas below */}
348     \hyperlink{uhitm_8c_a2bc8b513f9502ca3b16e7a154f259057}{override\_confirmation} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
349     \textcolor{keywordflow}{if} (\hyperlink{uhitm_8c_a3a8da2446d2ea20bc06ffd4ad7ec3301}{attack\_checks}(mtmp, \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep})) \textcolor{keywordflow}{return}(\hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
350 
351     \textcolor{keywordflow}{if} (\hyperlink{you_8h_ab869582031082f2c352b374dc0e0c3b3}{Upolyd}) \{
352         \textcolor{comment}{/* certain "pacifist" monsters don't attack */}
353         \textcolor{keywordflow}{if}(noattacks(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})) \{
354             You(\textcolor{stringliteral}{"have no way to attack monsters physically."});
355             mtmp->\hyperlink{structmonst_a5d03af85e4563c4068ac07d616af859f}{mstrategy} &= ~\hyperlink{monst_8h_a4f9dcb847e3f6a5b6d1e5ce78902938b}{STRAT\_WAITMASK};
356             \textcolor{keywordflow}{goto} atk\_done;
357         \}
358     \}
359 
360     \textcolor{keywordflow}{if}(check\_capacity(\textcolor{stringliteral}{"You cannot fight while so heavily loaded."}))
361         \textcolor{keywordflow}{goto} atk\_done;
362 
363     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ade2cee6956bba775aa796bba6ae857ec}{twoweap} && !\hyperlink{wield_8c_a3b7fbd46da00d32eb5b8af935abdce20}{can\_twoweapon}())
364         \hyperlink{wield_8c_a8936c33b1297630daea8e9448b804588}{untwoweapon}();
365 
366     \textcolor{keywordflow}{if}(\hyperlink{decl_8h_abc99d0f4cd19504d514e134524947a9e}{unweapon}) \{
367         \hyperlink{decl_8h_abc99d0f4cd19504d514e134524947a9e}{unweapon} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
368         \textcolor{keywordflow}{if}(\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_afd7dfe45d35356d861ab5e9834231929}{verbose}) \{
369         \textcolor{keywordflow}{if}(\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep})
370             You(\textcolor{stringliteral}{"begin bashing monsters with your %s."},
371             aobjnam(\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}, (\textcolor{keywordtype}{char} *)0));
372         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{mondata_8h_affb79b25deabc9564b20a275b5ac7e5f}{cantwield}(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}))
373             You(\textcolor{stringliteral}{"begin %sing monsters with your %s %s."},
374             \hyperlink{you_8h_a6087f5b8605964c19078b777da740258}{Role\_if}(PM\_MONK) ? \textcolor{stringliteral}{"strik"} : \textcolor{stringliteral}{"bash"},
375             \hyperlink{decl_8h_a374ab5e4582cfafa2d4ef57211f53293}{uarmg} ? \textcolor{stringliteral}{"gloved"} : \textcolor{stringliteral}{"bare"}, \textcolor{comment}{/* Del Lamb */}
376             makeplural(body\_part(\hyperlink{hack_8h_a701f28a9a2b5334b58333f06e27ad91f}{HAND})));
377         \}
378     \}
379     exercise(\hyperlink{attrib_8h_ad53430e3d611a366ec4b5c457b4c67f7}{A\_STR}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});     \textcolor{comment}{/* you're exercising muscles */}
380     \textcolor{comment}{/* andrew@orca: prevent unlimited pick-axe attacks */}
381     u\_wipe\_engr(3);
382 
383     \textcolor{comment}{/* Is the "it died" check actually correct? */}
384     \textcolor{keywordflow}{if}(mdat->\hyperlink{structpermonst_ab402dbf1bed9d0e595a2b3da6558da92}{mlet} == \hyperlink{monsym_8h_a61469c4fc890b937a980c72b87b462de}{S\_LEPRECHAUN} && !mtmp->mfrozen && !mtmp->msleeping &&
385        !mtmp->mconf && mtmp->mcansee && !rn2(7) &&
386        (m\_move(mtmp, 0) == 2 ||             \textcolor{comment}{/* it died */}
387        mtmp->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx} != \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a0b53da9e296cbebbc3dc2fc6ade21aeb}{dx} || mtmp->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my} != \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a80d068cfe5c15ae06e6f152be40a716f}{dy})) \textcolor{comment}{/* it moved */}
388         \textcolor{keywordflow}{return}(\hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
389 
390     tmp = \hyperlink{uhitm_8c_accae76bf34141d0859a6a4476e4720ee}{find\_roll\_to\_hit}(mtmp);
391     \textcolor{keywordflow}{if} (\hyperlink{you_8h_ab869582031082f2c352b374dc0e0c3b3}{Upolyd})
392         (void) \hyperlink{uhitm_8c_a62c1aa5da793b72c6de8bac7688a7365}{hmonas}(mtmp, tmp);
393     \textcolor{keywordflow}{else}
394         (\textcolor{keywordtype}{void}) \hyperlink{uhitm_8c_a81df17e7bc6a68bef3eda955de3071b5}{hitum}(mtmp, tmp, \hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_a8a558cbb5f8985df95bffa4439856374}{mattk});
395     mtmp->\hyperlink{structmonst_a5d03af85e4563c4068ac07d616af859f}{mstrategy} &= ~\hyperlink{monst_8h_a4f9dcb847e3f6a5b6d1e5ce78902938b}{STRAT\_WAITMASK};
396 
397 atk\_done:
398     \textcolor{comment}{/* see comment in attack\_checks() */}
399     \textcolor{comment}{/* we only need to check for this if we did an attack\_checks()}
400 \textcolor{comment}{     * and it returned 0 (it's okay to attack), and the monster didn't}
401 \textcolor{comment}{     * evade.}
402 \textcolor{comment}{     */}
403     \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a527b68a0e2b522d3233eff485aa5f3fc}{forcefight} && mtmp->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} > 0 && !\hyperlink{display_8h_a13f0a7cac1ceb73885a59b8598de1648}{canspotmon}(mtmp) &&
404         !\hyperlink{display_8h_aab760a0bc2c5bad8dbfe7102628dafc6}{glyph\_is\_invisible}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a0b53da9e296cbebbc3dc2fc6ade21aeb}{dx}][\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}+
      \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a80d068cfe5c15ae06e6f152be40a716f}{dy}].glyph) &&
405         !(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uswallow && mtmp == \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck}))
406         \hyperlink{display_8c_add21782d0389d23fbc5a470ef91d77e9}{map\_invisible}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a0b53da9e296cbebbc3dc2fc6ade21aeb}{dx}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a80d068cfe5c15ae06e6f152be40a716f}{dy});
407 
408     \textcolor{keywordflow}{return}(\hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
409 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a3a8da2446d2ea20bc06ffd4ad7ec3301}{\index{uhitm.\+c@{uhitm.\+c}!attack\+\_\+checks@{attack\+\_\+checks}}
\index{attack\+\_\+checks@{attack\+\_\+checks}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{attack\+\_\+checks}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} attack\+\_\+checks (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mtmp, }
\item[{struct {\bf obj} $\ast$}]{wep}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a3a8da2446d2ea20bc06ffd4ad7ec3301}


Definition at line 97 of file uhitm.\+c.



References A\+D\+\_\+\+S\+T\+C\+K, Blind, Blind\+\_\+telepat, canseemon, canspotmon, flag\+::confirm, Confusion, you\+::dx, you\+::dy, F\+A\+L\+S\+E, flags, flag\+::forcefight, glyph\+\_\+at(), glyph\+\_\+is\+\_\+invisible, glyph\+\_\+is\+\_\+warning, Hallucination, hides\+\_\+under, level, levl, map\+\_\+invisible(), flag\+::move, newsym(), obj\+::oartifact, dlevel\+\_\+t\+::objects, Protection\+\_\+from\+\_\+shape\+\_\+changers, Q\+B\+U\+F\+S\+Z, S\+\_\+\+E\+E\+L, sensemon, something, Sprintf, S\+T\+R\+A\+T\+\_\+\+W\+A\+I\+T\+M\+A\+S\+K, stumble\+\_\+onto\+\_\+mimic(), Stunned, T\+R\+U\+E, u, Unblind\+\_\+telepat, Underwater, you\+::ustuck, you\+::ux, you\+::uy, and yn.



Referenced by attack(), and kick\+\_\+monster().


\begin{DoxyCode}
100 \{
101     \textcolor{keywordtype}{char} qbuf[\hyperlink{global_8h_a1bb6bf3db7bf52ca1e9fa8fbcd6e9630}{QBUFSZ}];
102 
103     \textcolor{comment}{/* if you're close enough to attack, alert any waiting monster */}
104     mtmp->\hyperlink{structmonst_a5d03af85e4563c4068ac07d616af859f}{mstrategy} &= ~\hyperlink{monst_8h_a4f9dcb847e3f6a5b6d1e5ce78902938b}{STRAT\_WAITMASK};
105 
106     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uswallow && mtmp == \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck}) \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
107 
108     \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a527b68a0e2b522d3233eff485aa5f3fc}{forcefight}) \{
109         \textcolor{comment}{/* Do this in the caller, after we checked that the monster}
110 \textcolor{comment}{         * didn't die from the blow.  Reason: putting the 'I' there}
111 \textcolor{comment}{         * causes the hero to forget the square's contents since}
112 \textcolor{comment}{         * both 'I' and remembered contents are stored in .glyph.}
113 \textcolor{comment}{         * If the monster dies immediately from the blow, the 'I' will}
114 \textcolor{comment}{         * not stay there, so the player will have suddenly forgotten}
115 \textcolor{comment}{         * the square's contents for no apparent reason.}
116 \textcolor{comment}{        if (!canspotmon(mtmp) &&}
117 \textcolor{comment}{            !glyph\_is\_invisible(levl[u.ux+u.dx][u.uy+u.dy].glyph))}
118 \textcolor{comment}{            map\_invisible(u.ux+u.dx, u.uy+u.dy);}
119 \textcolor{comment}{         */}
120         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
121     \}
122 
123     \textcolor{comment}{/* Put up an invisible monster marker, but with exceptions for}
124 \textcolor{comment}{     * monsters that hide and monsters you've been warned about.}
125 \textcolor{comment}{     * The former already prints a warning message and}
126 \textcolor{comment}{     * prevents you from hitting the monster just via the hidden monster}
127 \textcolor{comment}{     * code below; if we also did that here, similar behavior would be}
128 \textcolor{comment}{     * happening two turns in a row.  The latter shows a glyph on}
129 \textcolor{comment}{     * the screen, so you know something is there.}
130 \textcolor{comment}{     */}
131     \textcolor{keywordflow}{if} (!\hyperlink{display_8h_a13f0a7cac1ceb73885a59b8598de1648}{canspotmon}(mtmp) &&
132             !\hyperlink{display_8h_aafdda3303535decc30d7a329028376f4}{glyph\_is\_warning}(\hyperlink{display_8c_ad3c1a65cc5e35e90067cb04eaf397d8a}{glyph\_at}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a0b53da9e296cbebbc3dc2fc6ade21aeb}{dx},\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.
      \hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a80d068cfe5c15ae06e6f152be40a716f}{dy})) &&
133             !\hyperlink{display_8h_aab760a0bc2c5bad8dbfe7102628dafc6}{glyph\_is\_invisible}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a0b53da9e296cbebbc3dc2fc6ade21aeb}{dx}][\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.
      \hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a80d068cfe5c15ae06e6f152be40a716f}{dy}].glyph) &&
134             !(!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind} && mtmp->mundetected && \hyperlink{mondata_8h_a37a7b9dfee69b94d8e6946bb04c22874}{hides\_under}(mtmp->
      \hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}))) \{
135         pline(\textcolor{stringliteral}{"Wait!  There's %s there you can't see!"},
136             \hyperlink{decl_8h_aa5c50bde0d16d15a08d32d8df49a80ae}{something});
137         \hyperlink{display_8c_add21782d0389d23fbc5a470ef91d77e9}{map\_invisible}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a0b53da9e296cbebbc3dc2fc6ade21aeb}{dx}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a80d068cfe5c15ae06e6f152be40a716f}{dy});
138         \textcolor{comment}{/* if it was an invisible mimic, treat it as if we stumbled}
139 \textcolor{comment}{         * onto a visible mimic}
140 \textcolor{comment}{         */}
141         \textcolor{keywordflow}{if}(mtmp->\hyperlink{structmonst_aab8fc9a0be90b4db8333b09487e2620c}{m\_ap\_type} && !\hyperlink{youprop_8h_a9e650a188eadc75d315da94987861e26}{Protection\_from\_shape\_changers}) \{
142             \textcolor{keywordflow}{if}(!\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck} && !mtmp->mflee && dmgtype(mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data},
      \hyperlink{monattk_8h_a7c15b586eba04f9fb2b34d332640be79}{AD\_STCK}))
143             \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck} = mtmp;
144         \}
145         wakeup(mtmp); \textcolor{comment}{/* always necessary; also un-mimics mimics */}
146         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
147     \}
148 
149     \textcolor{keywordflow}{if} (mtmp->\hyperlink{structmonst_aab8fc9a0be90b4db8333b09487e2620c}{m\_ap\_type} && !\hyperlink{youprop_8h_a9e650a188eadc75d315da94987861e26}{Protection\_from\_shape\_changers} &&
150        !\hyperlink{display_8h_a13881a5dc42ea2076abd050773eee913}{sensemon}(mtmp) &&
151        !\hyperlink{display_8h_aafdda3303535decc30d7a329028376f4}{glyph\_is\_warning}(\hyperlink{display_8c_ad3c1a65cc5e35e90067cb04eaf397d8a}{glyph\_at}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a0b53da9e296cbebbc3dc2fc6ade21aeb}{dx},\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}+
      \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a80d068cfe5c15ae06e6f152be40a716f}{dy}))) \{
152         \textcolor{comment}{/* If a hidden mimic was in a square where a player remembers}
153 \textcolor{comment}{         * some (probably different) unseen monster, the player is in}
154 \textcolor{comment}{         * luck--he attacks it even though it's hidden.}
155 \textcolor{comment}{         */}
156         \textcolor{keywordflow}{if} (\hyperlink{display_8h_aab760a0bc2c5bad8dbfe7102628dafc6}{glyph\_is\_invisible}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[mtmp->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx}][mtmp->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my}].glyph)) \{
157             seemimic(mtmp);
158             \textcolor{keywordflow}{return}(\hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
159         \}
160         \hyperlink{uhitm_8c_a9e547eaf1632538055c0a209af4b2273}{stumble\_onto\_mimic}(mtmp);
161         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
162     \}
163 
164     \textcolor{keywordflow}{if} (mtmp->mundetected && !\hyperlink{display_8h_ad75e04a9624fe7ba0e1715ae3a3feb27}{canseemon}(mtmp) &&
165         !\hyperlink{display_8h_aafdda3303535decc30d7a329028376f4}{glyph\_is\_warning}(\hyperlink{display_8c_ad3c1a65cc5e35e90067cb04eaf397d8a}{glyph\_at}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a0b53da9e296cbebbc3dc2fc6ade21aeb}{dx},\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}+
      \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a80d068cfe5c15ae06e6f152be40a716f}{dy})) &&
166         (\hyperlink{mondata_8h_a37a7b9dfee69b94d8e6946bb04c22874}{hides\_under}(mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) || mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ab402dbf1bed9d0e595a2b3da6558da92}{mlet} == 
      \hyperlink{monsym_8h_a07cd4c997171ec30fbe1376341a26160}{S\_EEL})) \{
167         mtmp->mundetected = mtmp->msleeping = 0;
168         \hyperlink{display_8c_a185c6ad6e4c5a6be26a371b9aa17c32e}{newsym}(mtmp->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx}, mtmp->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my});
169         \textcolor{keywordflow}{if} (\hyperlink{display_8h_aab760a0bc2c5bad8dbfe7102628dafc6}{glyph\_is\_invisible}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[mtmp->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx}][mtmp->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my}].glyph)) \{
170         seemimic(mtmp);
171         \textcolor{keywordflow}{return}(\hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
172         \}
173         \textcolor{keywordflow}{if} (!(\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind} ? \hyperlink{youprop_8h_a27cbd2bb7c71d4627d48c2715be37423}{Blind\_telepat} : \hyperlink{youprop_8h_acf607f2a23654b7517d294a3401122f7}{Unblind\_telepat})) \{
174         \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{structobj}{obj};
175 
176         \textcolor{keywordflow}{if} (\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind} || (is\_pool(mtmp->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx},mtmp->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my}) && !\hyperlink{youprop_8h_a2eb59bdcba2c368fefd253bfcdaa3673}{Underwater}))
177             pline(\textcolor{stringliteral}{"Wait!  There's a hidden monster there!"});
178         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((obj = \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ac128f805d01d7746b499596dd3b92a53}{objects}[mtmp->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx}][mtmp->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my}]) != 0)
179             pline(\textcolor{stringliteral}{"Wait!  There's %s hiding under %s!"},
180               an(l\_monnam(mtmp)), doname(obj));
181         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
182         \}
183     \}
184 
185     \textcolor{comment}{/*}
186 \textcolor{comment}{     * make sure to wake up a monster from the above cases if the}
187 \textcolor{comment}{     * hero can sense that the monster is there.}
188 \textcolor{comment}{     */}
189     \textcolor{keywordflow}{if} ((mtmp->mundetected || mtmp->\hyperlink{structmonst_aab8fc9a0be90b4db8333b09487e2620c}{m\_ap\_type}) && \hyperlink{display_8h_a13881a5dc42ea2076abd050773eee913}{sensemon}(mtmp)) \{
190         mtmp->mundetected = 0;
191         wakeup(mtmp);
192     \}
193 
194     \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_ab97835d9cec46b62b236f42bfe9ce9e0}{confirm} && mtmp->mpeaceful
195         && !\hyperlink{youprop_8h_a85174462efda5cc2dc2a49a0249801bb}{Confusion} && !\hyperlink{youprop_8h_aa873f7ea0a3d096ef94ff651907f7a76}{Hallucination} && !\hyperlink{youprop_8h_afd7fdfec2109113244c347015bab4ad1}{Stunned}) \{
196         \textcolor{comment}{/* Intelligent chaotic weapons (Stormbringer) want blood */}
197         \textcolor{keywordflow}{if} (wep && wep->\hyperlink{structobj_af03ce8a6a0ca51e8d8954fb1a1a31fbe}{oartifact} == ART\_STORMBRINGER) \{
198             \hyperlink{uhitm_8c_a2bc8b513f9502ca3b16e7a154f259057}{override\_confirmation} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
199             \textcolor{keywordflow}{return}(\hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
200         \}
201         \textcolor{keywordflow}{if} (\hyperlink{display_8h_a13f0a7cac1ceb73885a59b8598de1648}{canspotmon}(mtmp)) \{
202             \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(qbuf, \textcolor{stringliteral}{"Really attack %s?"}, mon\_nam(mtmp));
203             \textcolor{keywordflow}{if} (\hyperlink{hack_8h_a22ffd7fa35549db318337a497c38a1ae}{yn}(qbuf) != \textcolor{charliteral}{'y'}) \{
204                 \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_ae91760a156a6d1949297a53272137325}{move} = 0;
205                 \textcolor{keywordflow}{return}(\hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
206             \}
207         \}
208     \}
209 
210     \textcolor{keywordflow}{return}(\hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
211 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_afec61dbcb8ae406b1caf9d8079627b60}{\index{uhitm.\+c@{uhitm.\+c}!check\+\_\+caitiff@{check\+\_\+caitiff}}
\index{check\+\_\+caitiff@{check\+\_\+caitiff}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{check\+\_\+caitiff}]{\setlength{\rightskip}{0pt plus 5cm}void check\+\_\+caitiff (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mtmp}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_afec61dbcb8ae406b1caf9d8079627b60}


Definition at line 217 of file uhitm.\+c.



References A\+\_\+\+L\+A\+W\+F\+U\+L, align\+::record, Role\+\_\+if, align\+::type, u, and you\+::ualign.



Referenced by find\+\_\+roll\+\_\+to\+\_\+hit(), and kickdmg().


\begin{DoxyCode}
219 \{
220     \textcolor{keywordflow}{if} (\hyperlink{you_8h_a6087f5b8605964c19078b777da740258}{Role\_if}(PM\_KNIGHT) && \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a3f202dd89a837a9772a9eb1f1965f30c}{ualign}.\hyperlink{structalign_a0dadfa91b9ff06447f91ea8a2b898827}{type} == \hyperlink{align_8h_aa21537fe5fcc5cd77de27bc6907ecc6a}{A\_LAWFUL} &&
221         (!mtmp->mcanmove || mtmp->msleeping ||
222          (mtmp->mflee && !mtmp->mavenge)) &&
223         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a3f202dd89a837a9772a9eb1f1965f30c}{ualign}.\hyperlink{structalign_ab3a768425270c33f059e3ead817e4e83}{record} > -10) \{
224         You(\textcolor{stringliteral}{"caitiff!"});
225         adjalign(-1);
226     \}
227 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a7e41ad4604083ffd2e383d9cde262df9}{\index{uhitm.\+c@{uhitm.\+c}!damageum@{damageum}}
\index{damageum@{damageum}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{damageum}]{\setlength{\rightskip}{0pt plus 5cm}int damageum (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mdef, }
\item[{struct {\bf attack} $\ast$}]{mattk}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a7e41ad4604083ffd2e383d9cde262df9}


Definition at line 1275 of file uhitm.\+c.



References A\+\_\+\+D\+E\+X, A\+\_\+\+I\+N\+T, A\+\_\+\+W\+I\+S, A\+B\+A\+S\+E, A\+D\+\_\+\+A\+C\+I\+D, A\+D\+\_\+\+B\+L\+N\+D, A\+D\+\_\+\+C\+O\+L\+D, A\+D\+\_\+\+C\+O\+N\+F, A\+D\+\_\+\+C\+O\+R\+R, A\+D\+\_\+\+C\+U\+R\+S, A\+D\+\_\+\+D\+C\+A\+Y, A\+D\+\_\+\+D\+R\+C\+O, A\+D\+\_\+\+D\+R\+D\+X, A\+D\+\_\+\+D\+R\+I\+N, A\+D\+\_\+\+D\+R\+L\+I, A\+D\+\_\+\+D\+R\+S\+T, A\+D\+\_\+\+E\+L\+E\+C, A\+D\+\_\+\+E\+N\+C\+H, A\+D\+\_\+\+F\+I\+R\+E, A\+D\+\_\+\+H\+E\+A\+L, A\+D\+\_\+\+L\+E\+G\+S, A\+D\+\_\+\+P\+H\+Y\+S, A\+D\+\_\+\+P\+L\+Y\+S, A\+D\+\_\+\+R\+U\+S\+T, A\+D\+\_\+\+S\+E\+D\+U, A\+D\+\_\+\+S\+G\+L\+D, A\+D\+\_\+\+S\+I\+T\+M, A\+D\+\_\+\+S\+L\+E\+E, A\+D\+\_\+\+S\+L\+I\+M, A\+D\+\_\+\+S\+L\+O\+W, A\+D\+\_\+\+S\+S\+E\+X, A\+D\+\_\+\+S\+T\+C\+K, A\+D\+\_\+\+S\+T\+O\+N, A\+D\+\_\+\+S\+T\+U\+N, A\+D\+\_\+\+T\+L\+P\+T, A\+D\+\_\+\+W\+E\+R\+E, A\+D\+\_\+\+W\+R\+A\+P, A\+M\+A\+X, amphibious, A\+T\+\_\+\+H\+U\+G\+S, A\+T\+\_\+\+K\+I\+C\+K, A\+T\+\_\+\+W\+E\+A\+P, Blind, flag\+::botl, B\+U\+F\+S\+Z, cansee, canseemon, monst\+::data, delayed\+\_\+killer, demonpet(), F\+A\+L\+S\+E, flags, flaming, u\+\_\+conduct\+::food, has\+\_\+head, hurtmarmor(), invent, is\+\_\+demon, is\+\_\+swimmer, K\+I\+L\+L\+E\+D\+\_\+\+B\+Y\+\_\+\+A\+N, killer\+\_\+format, L\+E\+G, m\+\_\+slips\+\_\+free(), mhis, mindless, mon\+\_\+adjust\+\_\+speed(), mons, M\+S\+L\+O\+W, munstone(), nambuf, P\+O\+T\+I\+O\+N\+\_\+\+C\+L\+A\+S\+S, resists\+\_\+acid, resists\+\_\+cold, resists\+\_\+elec, resists\+\_\+fire, resists\+\_\+poison, R\+I\+N\+G\+\_\+\+C\+L\+A\+S\+S, rn1, S\+C\+R\+O\+L\+L\+\_\+\+C\+L\+A\+S\+S, shieldeff(), Slimed, S\+P\+B\+O\+O\+K\+\_\+\+C\+L\+A\+S\+S, steal\+\_\+it(), Stone\+\_\+resistance, Stoned, S\+T\+R\+A\+T\+\_\+\+W\+A\+I\+T\+F\+O\+R\+U, Strcpy, thick\+\_\+skinned, touch\+\_\+petrifies, T\+R\+U\+E, u, u\+\_\+teleport\+\_\+mon(), uarmf, you\+::uconduct, you\+::ugold, you\+::umonnum, Unchanging, u\+\_\+conduct\+::unvegan, you\+::ustuck, uwep, you\+::ux, you\+::uy, vegan, vegetarian, flag\+::verbose, W\+\_\+\+A\+R\+M\+H, W\+A\+N\+D\+\_\+\+C\+L\+A\+S\+S, and youmonst.



Referenced by hmonas(), and kick\+\_\+monster().


\begin{DoxyCode}
1278 \{
1279     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structpermonst}{permonst} *pd = mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data};
1280     \textcolor{keyword}{register} \textcolor{keywordtype}{int}    tmp = d((\textcolor{keywordtype}{int})mattk->\hyperlink{structattack_abf8c529d3dc814dcbe98780aaa9a9194}{damn}, (\textcolor{keywordtype}{int})mattk->\hyperlink{structattack_ac2b210543d1c0d0db89106b7d5f9ee00}{damd});
1281     \textcolor{keywordtype}{int} armpro;
1282     \textcolor{keywordtype}{boolean} negated;
1283 
1284     armpro = magic\_negation(mdef);
1285     \textcolor{comment}{/* since hero can't be cancelled, only defender's armor applies */}
1286     negated = !((rn2(3) >= armpro) || !rn2(50));
1287 
1288     \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a9f5d39edf86a6137fd76d419c7914af4}{is\_demon}(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) && !rn2(13) && !\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}
1289         && \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ae0b7ade89d09cd3b6d5e05eb8c859b35}{umonnum} != PM\_SUCCUBUS && \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ae0b7ade89d09cd3b6d5e05eb8c859b35}{umonnum} != PM\_INCUBUS
1290         && \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ae0b7ade89d09cd3b6d5e05eb8c859b35}{umonnum} != PM\_BALROG) \{
1291         \hyperlink{uhitm_8c_a005f8dfabd122add00fcc0cc6fa609a4}{demonpet}();
1292         \textcolor{keywordflow}{return}(0);
1293     \}
1294     \textcolor{keywordflow}{switch}(mattk->\hyperlink{structattack_a14286742d9dc1310f5c4852432264080}{adtyp}) \{
1295         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a5e7dec4b42b4a01a99dc810ece40f4b5}{AD\_STUN}:
1296         \textcolor{keywordflow}{if}(!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind})
1297             pline(\textcolor{stringliteral}{"%s %s for a moment."}, Monnam(mdef),
1298               makeplural(stagger(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}, \textcolor{stringliteral}{"stagger"})));
1299         mdef->mstun = 1;
1300         \textcolor{keywordflow}{goto} physical;
1301         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a9a80a2c2ea742328e04b21de5620d9c6}{AD\_LEGS}:
1302          \textcolor{comment}{/* if (u.ucancelled) \{ */}
1303          \textcolor{comment}{/*    tmp = 0;     */}
1304          \textcolor{comment}{/*    break;       */}
1305          \textcolor{comment}{/* \}           */}
1306         \textcolor{keywordflow}{goto} physical;
1307         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a74a7c164c0252682b319ae986e88b48a}{AD\_WERE}:        \textcolor{comment}{/* no special effect on monsters */}
1308         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a9c2a80ab2cdf3cabde78b488aa27a813}{AD\_HEAL}:        \textcolor{comment}{/* likewise */}
1309         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a9191d6bf636e5ada34fa9169ecaa4d9a}{AD\_PHYS}:
1310  physical:
1311         \textcolor{keywordflow}{if}(mattk->\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp} == \hyperlink{monattk_8h_a6db6784344c2424d385f6b460f0c029f}{AT\_WEAP}) \{
1312             \textcolor{keywordflow}{if}(\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}) tmp = 0;
1313         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(mattk->\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp} == \hyperlink{monattk_8h_a0f086b24239ee3c9b8cce9edf3507323}{AT\_KICK}) \{
1314             \textcolor{keywordflow}{if}(\hyperlink{mondata_8h_a8d3b0784e67294ee9fae355fb1dcf8d3}{thick\_skinned}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})) tmp = 0;
1315             \textcolor{keywordflow}{if}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_SHADE]) \{
1316             \textcolor{keywordflow}{if} (!(\hyperlink{decl_8h_a11e2d0f62fa1b42374054c939ebb288f}{uarmf} && \hyperlink{decl_8h_a11e2d0f62fa1b42374054c939ebb288f}{uarmf}->blessed)) \{
1317                 impossible(\textcolor{stringliteral}{"bad shade attack function flow?"});
1318                 tmp = 0;
1319             \} \textcolor{keywordflow}{else}
1320                 tmp = rnd(4); \textcolor{comment}{/* bless damage */}
1321             \}
1322         \}
1323         \textcolor{keywordflow}{break};
1324         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a2435fa84586bb5a35cf46f7abd380c86}{AD\_FIRE}:
1325         \textcolor{keywordflow}{if} (negated) \{
1326             tmp = 0;
1327             \textcolor{keywordflow}{break};
1328         \}
1329         \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind})
1330             pline(\textcolor{stringliteral}{"%s is %s!"}, Monnam(mdef),
1331               on\_fire(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}, mattk));
1332         \textcolor{keywordflow}{if} (pd == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_STRAW\_GOLEM] ||
1333             pd == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_PAPER\_GOLEM]) \{
1334             \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind})
1335             pline(\textcolor{stringliteral}{"%s burns completely!"}, Monnam(mdef));
1336             xkilled(mdef,2);
1337             tmp = 0;
1338             \textcolor{keywordflow}{break};
1339             \textcolor{comment}{/* Don't return yet; keep hp<1 and tmp=0 for pet msg */}
1340         \}
1341         tmp += destroy\_mitem(mdef, \hyperlink{objclass_8h_ac23f261da0f9e2a4c6afccecfc167a96}{SCROLL\_CLASS}, \hyperlink{monattk_8h_a2435fa84586bb5a35cf46f7abd380c86}{AD\_FIRE});
1342         tmp += destroy\_mitem(mdef, \hyperlink{objclass_8h_aba5935524b39b0fdd148a3d466a5c580}{SPBOOK\_CLASS}, \hyperlink{monattk_8h_a2435fa84586bb5a35cf46f7abd380c86}{AD\_FIRE});
1343         \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a9cd1ee3ba3c1e0e78509b763ce6d38d1}{resists\_fire}(mdef)) \{
1344             \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind})
1345             pline\_The(\textcolor{stringliteral}{"fire doesn't heat %s!"}, mon\_nam(mdef));
1346             golemeffects(mdef, \hyperlink{monattk_8h_a2435fa84586bb5a35cf46f7abd380c86}{AD\_FIRE}, tmp);
1347             \hyperlink{display_8c_ac89f44ae626d79f05953e503312a939d}{shieldeff}(mdef->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx}, mdef->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my});
1348             tmp = 0;
1349         \}
1350         \textcolor{comment}{/* only potions damage resistant players in destroy\_item */}
1351         tmp += destroy\_mitem(mdef, \hyperlink{objclass_8h_a05335e5ee18dfa33af1c40056fe8fab9}{POTION\_CLASS}, \hyperlink{monattk_8h_a2435fa84586bb5a35cf46f7abd380c86}{AD\_FIRE});
1352         \textcolor{keywordflow}{break};
1353         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_ad91817bd861d8b17fdfc7069122ab67e}{AD\_COLD}:
1354         \textcolor{keywordflow}{if} (negated) \{
1355             tmp = 0;
1356             \textcolor{keywordflow}{break};
1357         \}
1358         \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind}) pline(\textcolor{stringliteral}{"%s is covered in frost!"}, Monnam(mdef));
1359         \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a889684d1afa503bfbfcd1a3e84035b92}{resists\_cold}(mdef)) \{
1360             \hyperlink{display_8c_ac89f44ae626d79f05953e503312a939d}{shieldeff}(mdef->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx}, mdef->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my});
1361             \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind})
1362             pline\_The(\textcolor{stringliteral}{"frost doesn't chill %s!"}, mon\_nam(mdef));
1363             golemeffects(mdef, \hyperlink{monattk_8h_ad91817bd861d8b17fdfc7069122ab67e}{AD\_COLD}, tmp);
1364             tmp = 0;
1365         \}
1366         tmp += destroy\_mitem(mdef, \hyperlink{objclass_8h_a05335e5ee18dfa33af1c40056fe8fab9}{POTION\_CLASS}, \hyperlink{monattk_8h_ad91817bd861d8b17fdfc7069122ab67e}{AD\_COLD});
1367         \textcolor{keywordflow}{break};
1368         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a3c61973cffe1d7a9ab234e619a05aeab}{AD\_ELEC}:
1369         \textcolor{keywordflow}{if} (negated) \{
1370             tmp = 0;
1371             \textcolor{keywordflow}{break};
1372         \}
1373         \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind}) pline(\textcolor{stringliteral}{"%s is zapped!"}, Monnam(mdef));
1374         tmp += destroy\_mitem(mdef, \hyperlink{objclass_8h_a3465d7e5f808c98fcfc32e3159b9d9c2}{WAND\_CLASS}, \hyperlink{monattk_8h_a3c61973cffe1d7a9ab234e619a05aeab}{AD\_ELEC});
1375         \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a3ec4a5375d05f427a8e3e9d4f0b55f0e}{resists\_elec}(mdef)) \{
1376             \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind})
1377             pline\_The(\textcolor{stringliteral}{"zap doesn't shock %s!"}, mon\_nam(mdef));
1378             golemeffects(mdef, \hyperlink{monattk_8h_a3c61973cffe1d7a9ab234e619a05aeab}{AD\_ELEC}, tmp);
1379             \hyperlink{display_8c_ac89f44ae626d79f05953e503312a939d}{shieldeff}(mdef->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx}, mdef->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my});
1380             tmp = 0;
1381         \}
1382         \textcolor{comment}{/* only rings damage resistant players in destroy\_item */}
1383         tmp += destroy\_mitem(mdef, \hyperlink{objclass_8h_a4d65a9d3e979073915c207bf6a806d63}{RING\_CLASS}, \hyperlink{monattk_8h_a3c61973cffe1d7a9ab234e619a05aeab}{AD\_ELEC});
1384         \textcolor{keywordflow}{break};
1385         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a6bfc66a52d2d02a9d043f28a44f7def3}{AD\_ACID}:
1386         \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a67859b0b3aa8e4ac0d74a818013cb507}{resists\_acid}(mdef)) tmp = 0;
1387         \textcolor{keywordflow}{break};
1388         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_acd88c8b5dc08b255aa9a34768f7efb7c}{AD\_STON}:
1389         \textcolor{keywordflow}{if} (!\hyperlink{muse_8c_a82ac795f5c2a0bc7574b746291a9139e}{munstone}(mdef, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}))
1390             minstapetrify(mdef, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
1391         tmp = 0;
1392         \textcolor{keywordflow}{break};
1393 \textcolor{preprocessor}{#ifdef SEDUCE}
1394         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a146bbc72ef685bcde4cb97f2bdfca815}{AD\_SSEX}:
1395 \textcolor{preprocessor}{#endif}
1396         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_ac4cca9e4794579cfd6f2f521ba6b6bcf}{AD\_SEDU}:
1397         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a31280534e76e46e281962c0e53142a94}{AD\_SITM}:
1398         \hyperlink{uhitm_8c_a80be2dc85a675fa92ad7a3db308f7ea0}{steal\_it}(mdef, mattk);
1399         tmp = 0;
1400         \textcolor{keywordflow}{break};
1401         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a7a3382b3650675a6fc926a3a0c61ef0f}{AD\_SGLD}:
1402 \textcolor{preprocessor}{#ifndef GOLDOBJ}
1403         \textcolor{keywordflow}{if} (mdef->\hyperlink{structmonst_a06dbdd0ca7ee096216aa10f86beed533}{mgold}) \{
1404             \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold} += mdef->\hyperlink{structmonst_a06dbdd0ca7ee096216aa10f86beed533}{mgold};
1405             mdef->\hyperlink{structmonst_a06dbdd0ca7ee096216aa10f86beed533}{mgold} = 0;
1406             Your(\textcolor{stringliteral}{"purse feels heavier."});
1407         \}
1408 \textcolor{preprocessor}{#else}
1409                 \textcolor{comment}{/* This you as a leprechaun, so steal}
1410 \textcolor{comment}{                   real gold only, no lesser coins */}
1411             \{
1412             \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *mongold = findgold(mdef->\hyperlink{structmonst_a480856d6a5db5610593c9816e525a978}{minvent});
1413                 \textcolor{keywordflow}{if} (mongold) \{
1414                 obj\_extract\_self(mongold);  
1415                 \textcolor{keywordflow}{if} (merge\_choice(\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent}, mongold) || inv\_cnt() < 52) \{
1416                 addinv(mongold);
1417                 Your(\textcolor{stringliteral}{"purse feels heavier."});
1418             \} \textcolor{keywordflow}{else} \{
1419                             You(\textcolor{stringliteral}{"grab %s's gold, but find no room in your knapsack."}, mon\_nam(mdef));
1420                 dropy(mongold);
1421                 \}
1422             \}
1423             \}
1424 \textcolor{preprocessor}{#endif}
1425         exercise(\hyperlink{attrib_8h_ad8117dfaac470310d7540a3e8dcc00e0}{A\_DEX}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
1426         tmp = 0;
1427         \textcolor{keywordflow}{break};
1428         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a481c6fdbd3c0c317d27d20388b413f0e}{AD\_TLPT}:
1429         \textcolor{keywordflow}{if} (tmp <= 0) tmp = 1;
1430         \textcolor{keywordflow}{if} (!negated && tmp < mdef->mhp) \{
1431             \textcolor{keywordtype}{char} \hyperlink{questpgr_8c_a0d2e3145707b491c18fd62d7dd92f4a3}{nambuf}[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
1432             \textcolor{keywordtype}{boolean} u\_saw\_mon = \hyperlink{display_8h_ad75e04a9624fe7ba0e1715ae3a3feb27}{canseemon}(mdef) ||
1433                     (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uswallow && \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck} == mdef);
1434             \textcolor{comment}{/* record the name before losing sight of monster */}
1435             \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(nambuf, Monnam(mdef));
1436             \textcolor{keywordflow}{if} (\hyperlink{teleport_8c_a3ef4493051966a97cac12d2c52756d04}{u\_teleport\_mon}(mdef, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}) &&
1437                 u\_saw\_mon && !\hyperlink{display_8h_ad75e04a9624fe7ba0e1715ae3a3feb27}{canseemon}(mdef))
1438             pline(\textcolor{stringliteral}{"%s suddenly disappears!"}, nambuf);
1439         \}
1440         \textcolor{keywordflow}{break};
1441         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a0b9368a6808378c4d573541efff21cb6}{AD\_BLND}:
1442         \textcolor{keywordflow}{if} (can\_blnd(&\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}, mdef, mattk->\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp}, (\textcolor{keyword}{struct} \hyperlink{structobj}{obj}*)0)) \{
1443             \textcolor{keywordflow}{if}(!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind} && mdef->mcansee)
1444             pline(\textcolor{stringliteral}{"%s is blinded."}, Monnam(mdef));
1445             mdef->mcansee = 0;
1446             tmp += mdef->mblinded;
1447             \textcolor{keywordflow}{if} (tmp > 127) tmp = 127;
1448             mdef->mblinded = tmp;
1449         \}
1450         tmp = 0;
1451         \textcolor{keywordflow}{break};
1452         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a83df98259b2ba1385ee7d4d02d799390}{AD\_CURS}:
1453         \textcolor{keywordflow}{if} (night() && !rn2(10) && !mdef->mcan) \{
1454             \textcolor{keywordflow}{if} (mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_CLAY\_GOLEM]) \{
1455             \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind})
1456                 pline(\textcolor{stringliteral}{"Some writing vanishes from %s head!"},
1457                 s\_suffix(mon\_nam(mdef)));
1458             xkilled(mdef, 0);
1459             \textcolor{comment}{/* Don't return yet; keep hp<1 and tmp=0 for pet msg */}
1460             \} \textcolor{keywordflow}{else} \{
1461             mdef->mcan = 1;
1462             You(\textcolor{stringliteral}{"chuckle."});
1463             \}
1464         \}
1465         tmp = 0;
1466         \textcolor{keywordflow}{break};
1467         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a4c57ec4f6d96ffb69d5dd9ec95a2197b}{AD\_DRLI}:
1468         \textcolor{keywordflow}{if} (!negated && !rn2(3) && !resists\_drli(mdef)) \{
1469             \textcolor{keywordtype}{int} xtmp = d(2,6);
1470             pline(\textcolor{stringliteral}{"%s suddenly seems weaker!"}, Monnam(mdef));
1471             mdef->\hyperlink{structmonst_a66c107319bb7bb318c04e6a0f5f03c60}{mhpmax} -= xtmp;
1472             \textcolor{keywordflow}{if} ((mdef->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} -= xtmp) <= 0 || !mdef->\hyperlink{structmonst_a80ec1118166ea76d347e47d088bd1f7c}{m\_lev}) \{
1473                 pline(\textcolor{stringliteral}{"%s dies!"}, Monnam(mdef));
1474                 xkilled(mdef,0);
1475             \} \textcolor{keywordflow}{else}
1476                 mdef->\hyperlink{structmonst_a80ec1118166ea76d347e47d088bd1f7c}{m\_lev}--;
1477             tmp = 0;
1478         \}
1479         \textcolor{keywordflow}{break};
1480         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_ad4c8c292c1231a2dea8f3584aadba386}{AD\_RUST}:
1481         \textcolor{keywordflow}{if} (pd == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_IRON\_GOLEM]) \{
1482             pline(\textcolor{stringliteral}{"%s falls to pieces!"}, Monnam(mdef));
1483             xkilled(mdef,0);
1484         \}
1485         \hyperlink{uhitm_8c_a7dd49fa34e369a004e933f1c8fa83ca3}{hurtmarmor}(mdef, \hyperlink{monattk_8h_ad4c8c292c1231a2dea8f3584aadba386}{AD\_RUST});
1486         tmp = 0;
1487         \textcolor{keywordflow}{break};
1488         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_ab0c26930134a566b9c5a9061cbb3a5da}{AD\_CORR}:
1489         \hyperlink{uhitm_8c_a7dd49fa34e369a004e933f1c8fa83ca3}{hurtmarmor}(mdef, \hyperlink{monattk_8h_ab0c26930134a566b9c5a9061cbb3a5da}{AD\_CORR});
1490         tmp = 0;
1491         \textcolor{keywordflow}{break};
1492         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a0a534678e7151b45f263ed7825ee9940}{AD\_DCAY}:
1493         \textcolor{keywordflow}{if} (pd == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_WOOD\_GOLEM] ||
1494             pd == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_LEATHER\_GOLEM]) \{
1495             pline(\textcolor{stringliteral}{"%s falls to pieces!"}, Monnam(mdef));
1496             xkilled(mdef,0);
1497         \}
1498         \hyperlink{uhitm_8c_a7dd49fa34e369a004e933f1c8fa83ca3}{hurtmarmor}(mdef, \hyperlink{monattk_8h_a0a534678e7151b45f263ed7825ee9940}{AD\_DCAY});
1499         tmp = 0;
1500         \textcolor{keywordflow}{break};
1501         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a0ad77a3f1ad018dfbe3cb1fdad8558a7}{AD\_DRST}:
1502         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a3151d76132b61d1753b0dfdef9b2a8f4}{AD\_DRDX}:
1503         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_abe7238949c34d3575389cb995e764cc3}{AD\_DRCO}:
1504         \textcolor{keywordflow}{if} (!negated && !rn2(8)) \{
1505             Your(\textcolor{stringliteral}{"%s was poisoned!"}, mpoisons\_subj(&\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}, mattk));
1506             \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a419ec031ff4b2508bcd1304366f93ce2}{resists\_poison}(mdef))
1507             pline\_The(\textcolor{stringliteral}{"poison doesn't seem to affect %s."},
1508                 mon\_nam(mdef));
1509             \textcolor{keywordflow}{else} \{
1510             \textcolor{keywordflow}{if} (!rn2(10)) \{
1511                 Your(\textcolor{stringliteral}{"poison was deadly..."});
1512                 tmp = mdef->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp};
1513             \} \textcolor{keywordflow}{else} tmp += \hyperlink{hack_8h_af107ca092682647f298989038020f9c8}{rn1}(10,6);
1514             \}
1515         \}
1516         \textcolor{keywordflow}{break};
1517         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a3513f620bdd0b5b59dd9c3863c3983d7}{AD\_DRIN}:
1518         \textcolor{keywordflow}{if} (\hyperlink{uhitm_8c_aa0fe2fdb5136cb5a8960dd3b1f24031a}{notonhead} || !\hyperlink{mondata_8h_ac3233fd10c8acdc9c9533dea67d53e08}{has\_head}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})) \{
1519             pline(\textcolor{stringliteral}{"%s doesn't seem harmed."}, Monnam(mdef));
1520             tmp = 0;
1521             \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a10db02e9dc6f21655b4bbc61abdd0a12}{Unchanging} && mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_GREEN\_SLIME]) \{
1522             \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a1d6ced121072dc4fb35b71e5fdebe596}{Slimed}) \{
1523                 You(\textcolor{stringliteral}{"suck in some slime and don't feel very well."});
1524                 \hyperlink{youprop_8h_a1d6ced121072dc4fb35b71e5fdebe596}{Slimed} = 10L;
1525             \}
1526             \}
1527             \textcolor{keywordflow}{break};
1528         \}
1529         \textcolor{keywordflow}{if} (\hyperlink{uhitm_8c_a5544110e943377e363a5ae2c9af36c21}{m\_slips\_free}(mdef, mattk)) \textcolor{keywordflow}{break};
1530 
1531         \textcolor{keywordflow}{if} ((mdef->\hyperlink{structmonst_afc2bd39e2f3e797e15bea20ac7f69788}{misc\_worn\_check} & \hyperlink{prop_8h_a4e8958625f891ea2329369d5032d0d6d}{W\_ARMH}) && rn2(8)) \{
1532             pline(\textcolor{stringliteral}{"%s helmet blocks your attack to %s head."},
1533               s\_suffix(Monnam(mdef)), \hyperlink{you_8h_aa53b72a15dda33a02f28703fbc551090}{mhis}(mdef));
1534             \textcolor{keywordflow}{break};
1535         \}
1536 
1537         You(\textcolor{stringliteral}{"eat %s brain!"}, s\_suffix(mon\_nam(mdef)));
1538         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac34f4744daa7ff78a6ff556ade5b9601}{uconduct}.\hyperlink{structu__conduct_a2d5d295afd232b076220ca486b720ed1}{food}++;
1539         \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_ad1e85e493d27cdfdbe94c43710c4b191}{touch\_petrifies}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) && !\hyperlink{youprop_8h_a90b638323d50e1f8d52d4a9576d90551}{Stone\_resistance} && !
      \hyperlink{youprop_8h_afa678675d2c2f1e3b6ca808bab477126}{Stoned}) \{
1540             \hyperlink{youprop_8h_afa678675d2c2f1e3b6ca808bab477126}{Stoned} = 5;
1541             \hyperlink{decl_8h_a0a94810d03a0bf68b371c6b1a1a4a905}{killer\_format} = \hyperlink{decl_8h_af4e54910b730baa32b2dfbe4dd2942c1}{KILLED\_BY\_AN};
1542             \hyperlink{decl_8h_a1d9401b9ae41f36846843249a380776c}{delayed\_killer} = mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ae92da7d141243d7e37d4a12340bb248f}{mname};
1543         \}
1544         \textcolor{keywordflow}{if} (!\hyperlink{mondata_8h_a028ffec60e35d2250ae328b2dbd8acf4}{vegan}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}))
1545             \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac34f4744daa7ff78a6ff556ade5b9601}{uconduct}.\hyperlink{structu__conduct_a3f98bca389fa71f4dabbd75829719dbf}{unvegan}++;
1546         \textcolor{keywordflow}{if} (!\hyperlink{mondata_8h_a57bbc8d06bdcc1788f06bcd3a9028845}{vegetarian}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}))
1547             violated\_vegetarian();
1548         \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a9b2e225376aeed6f19559b2c2dced2d0}{mindless}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})) \{
1549             pline(\textcolor{stringliteral}{"%s doesn't notice."}, Monnam(mdef));
1550             \textcolor{keywordflow}{break};
1551         \}
1552         tmp += rnd(10);
1553         morehungry(-rnd(30)); \textcolor{comment}{/* cannot choke */}
1554         \textcolor{keywordflow}{if} (\hyperlink{attrib_8h_a530e7241d82543590fdc65277c88a739}{ABASE}(\hyperlink{attrib_8h_a583ef0a9b22ce89bcf0df81228b424b5}{A\_INT}) < \hyperlink{attrib_8h_adfa30b8be05d1635d619e03dc89480ac}{AMAX}(\hyperlink{attrib_8h_a583ef0a9b22ce89bcf0df81228b424b5}{A\_INT})) \{
1555             \hyperlink{attrib_8h_a530e7241d82543590fdc65277c88a739}{ABASE}(\hyperlink{attrib_8h_a583ef0a9b22ce89bcf0df81228b424b5}{A\_INT}) += rnd(4);
1556             \textcolor{keywordflow}{if} (\hyperlink{attrib_8h_a530e7241d82543590fdc65277c88a739}{ABASE}(\hyperlink{attrib_8h_a583ef0a9b22ce89bcf0df81228b424b5}{A\_INT}) > \hyperlink{attrib_8h_adfa30b8be05d1635d619e03dc89480ac}{AMAX}(\hyperlink{attrib_8h_a583ef0a9b22ce89bcf0df81228b424b5}{A\_INT}))
1557                 \hyperlink{attrib_8h_a530e7241d82543590fdc65277c88a739}{ABASE}(\hyperlink{attrib_8h_a583ef0a9b22ce89bcf0df81228b424b5}{A\_INT}) = \hyperlink{attrib_8h_adfa30b8be05d1635d619e03dc89480ac}{AMAX}(\hyperlink{attrib_8h_a583ef0a9b22ce89bcf0df81228b424b5}{A\_INT});
1558             \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a51f16d01a910b52fdf0c05a44739f7d8}{botl} = 1;
1559         \}
1560         exercise(\hyperlink{attrib_8h_a4206d6431732a698ede8a237d5c17142}{A\_WIS}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
1561         \textcolor{keywordflow}{break};
1562         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a7c15b586eba04f9fb2b34d332640be79}{AD\_STCK}:
1563         \textcolor{keywordflow}{if} (!negated && !sticks(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}))
1564             \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck} = mdef; \textcolor{comment}{/* it's now stuck to you */}
1565         \textcolor{keywordflow}{break};
1566         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_abd3282c6d3cf3a04bc06ebdc9e8a34ef}{AD\_WRAP}:
1567         \textcolor{keywordflow}{if} (!sticks(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})) \{
1568             \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck} && !rn2(10)) \{
1569             \textcolor{keywordflow}{if} (\hyperlink{uhitm_8c_a5544110e943377e363a5ae2c9af36c21}{m\_slips\_free}(mdef, mattk)) \{
1570                 tmp = 0;
1571             \} \textcolor{keywordflow}{else} \{
1572                 You(\textcolor{stringliteral}{"swing yourself around %s!"},
1573                   mon\_nam(mdef));
1574                 \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck} = mdef;
1575             \}
1576             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck} == mdef) \{
1577             \textcolor{comment}{/* Monsters don't wear amulets of magical breathing */}
1578             \textcolor{keywordflow}{if} (is\_pool(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux},\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}) && !\hyperlink{mondata_8h_ab8ffd447c2b8217b49848268e2b6493d}{is\_swimmer}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) &&
1579                 !\hyperlink{mondata_8h_af598ecbfaf539d9840a9b5e4a872f6b7}{amphibious}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})) \{
1580                 You(\textcolor{stringliteral}{"drown %s..."}, mon\_nam(mdef));
1581                 tmp = mdef->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp};
1582             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(mattk->\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp} == \hyperlink{monattk_8h_a58713b39f99069e88d1a4c50f1142434}{AT\_HUGS})
1583                 pline(\textcolor{stringliteral}{"%s is being crushed."}, Monnam(mdef));
1584             \} \textcolor{keywordflow}{else} \{
1585             tmp = 0;
1586             \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_afd7dfe45d35356d861ab5e9834231929}{verbose})
1587                 You(\textcolor{stringliteral}{"brush against %s %s."},
1588                 s\_suffix(mon\_nam(mdef)),
1589                 mbodypart(mdef, \hyperlink{hack_8h_a18e0de6fde17def36a938036ab8166f5}{LEG}));
1590             \}
1591         \} \textcolor{keywordflow}{else} tmp = 0;
1592         \textcolor{keywordflow}{break};
1593         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a8c4e3cffc2116c9bdc32163adf5b09d5}{AD\_PLYS}:
1594         \textcolor{keywordflow}{if} (!negated && mdef->mcanmove && !rn2(3) && tmp < mdef->mhp) \{
1595             \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind}) pline(\textcolor{stringliteral}{"%s is frozen by you!"}, Monnam(mdef));
1596             mdef->mcanmove = 0;
1597             mdef->mfrozen = rnd(10);
1598         \}
1599         \textcolor{keywordflow}{break};
1600         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a13781951a8a3f2ffb58c5875f0480478}{AD\_SLEE}:
1601         \textcolor{keywordflow}{if} (!negated && !mdef->msleeping &&
1602                 sleep\_monst(mdef, rnd(10), -1)) \{
1603             \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind})
1604             pline(\textcolor{stringliteral}{"%s is put to sleep by you!"}, Monnam(mdef));
1605             slept\_monst(mdef);
1606         \}
1607         \textcolor{keywordflow}{break};
1608         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_ac8d7fd38687725720d5bc472ebd22f9b}{AD\_SLIM}:
1609         \textcolor{keywordflow}{if} (negated) \textcolor{keywordflow}{break}; \textcolor{comment}{/* physical damage only */}
1610         \textcolor{keywordflow}{if} (!rn2(4) && !\hyperlink{mondata_8h_aadb2718743a42260876de9cb19469e1b}{flaming}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) &&
1611                 mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} != &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_GREEN\_SLIME]) \{
1612             You(\textcolor{stringliteral}{"turn %s into slime."}, mon\_nam(mdef));
1613             (void) newcham(mdef, &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_GREEN\_SLIME], \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1614             tmp = 0;
1615         \}
1616         \textcolor{keywordflow}{break};
1617         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a77eab5db3c30ab9b6ac48968de9dfbd9}{AD\_ENCH}:    \textcolor{comment}{/* KMH -- remove enchantment (disenchanter) */}
1618         \textcolor{comment}{/* there's no msomearmor() function, so just do damage */}
1619          \textcolor{comment}{/* if (negated) break; */}
1620         \textcolor{keywordflow}{break};
1621         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a98de67228083eaf5fba23b77ea9d0f95}{AD\_SLOW}:
1622         \textcolor{keywordflow}{if} (!negated && mdef->mspeed != \hyperlink{monst_8h_a0791e61151c83c9f3bba131b79daadec}{MSLOW}) \{
1623             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} oldspeed = mdef->mspeed;
1624 
1625             \hyperlink{worn_8c_adaf11e4f4e6b2b5d86738411700e6050}{mon\_adjust\_speed}(mdef, -1, (\textcolor{keyword}{struct} \hyperlink{structobj}{obj} *)0);
1626             \textcolor{keywordflow}{if} (mdef->mspeed != oldspeed && \hyperlink{display_8h_ad75e04a9624fe7ba0e1715ae3a3feb27}{canseemon}(mdef))
1627             pline(\textcolor{stringliteral}{"%s slows down."}, Monnam(mdef));
1628         \}
1629         \textcolor{keywordflow}{break};
1630         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a1e3fc00c634ffc76573ec93e67f34061}{AD\_CONF}:
1631         \textcolor{keywordflow}{if} (!mdef->mconf) \{
1632             \textcolor{keywordflow}{if} (\hyperlink{display_8h_ad75e04a9624fe7ba0e1715ae3a3feb27}{canseemon}(mdef))
1633             pline(\textcolor{stringliteral}{"%s looks confused."}, Monnam(mdef));
1634             mdef->mconf = 1;
1635         \}
1636         \textcolor{keywordflow}{break};
1637         \textcolor{keywordflow}{default}:    tmp = 0;
1638         \textcolor{keywordflow}{break};
1639     \}
1640 
1641     mdef->\hyperlink{structmonst_a5d03af85e4563c4068ac07d616af859f}{mstrategy} &= ~\hyperlink{monst_8h_a14b3e6ad96fe70130da9a110aa465ed6}{STRAT\_WAITFORU}; \textcolor{comment}{/* in case player is very fast */}
1642     \textcolor{keywordflow}{if}((mdef->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} -= tmp) < 1) \{
1643         \textcolor{keywordflow}{if} (mdef->\hyperlink{structmonst_a6d525ec48f9d38cda6accbb0cb39efba}{mtame} && !\hyperlink{vision_8h_a857efc720262bc13a9e4b4bcbb079b5c}{cansee}(mdef->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx},mdef->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my})) \{
1644         You\_feel(\textcolor{stringliteral}{"embarrassed for a moment."});
1645         \textcolor{keywordflow}{if} (tmp) xkilled(mdef, 0); \textcolor{comment}{/* !tmp but hp<1: already killed */}
1646         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_afd7dfe45d35356d861ab5e9834231929}{verbose}) \{
1647         You(\textcolor{stringliteral}{"destroy it!"});
1648         \textcolor{keywordflow}{if} (tmp) xkilled(mdef, 0);
1649         \} \textcolor{keywordflow}{else}
1650         \textcolor{keywordflow}{if} (tmp) killed(mdef);
1651         \textcolor{keywordflow}{return}(2);
1652     \}
1653     \textcolor{keywordflow}{return}(1);
1654 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a005f8dfabd122add00fcc0cc6fa609a4}{\index{uhitm.\+c@{uhitm.\+c}!demonpet@{demonpet}}
\index{demonpet@{demonpet}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{demonpet}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void demonpet (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a005f8dfabd122add00fcc0cc6fa609a4}


Definition at line 1169 of file uhitm.\+c.



References A\+\_\+\+W\+I\+S, monst\+::data, mons, ndemon(), N\+O\+\_\+\+M\+M\+\_\+\+F\+L\+A\+G\+S, N\+O\+N\+\_\+\+P\+M, T\+R\+U\+E, align\+::type, u, you\+::ualign, you\+::ux, you\+::uy, and youmonst.



Referenced by damageum().


\begin{DoxyCode}
1170 \{
1171     \textcolor{keywordtype}{int} i;
1172     \textcolor{keyword}{struct }\hyperlink{structpermonst}{permonst} *pm;
1173     \textcolor{keyword}{struct }\hyperlink{structmonst}{monst} *dtmp;
1174 
1175     pline(\textcolor{stringliteral}{"Some hell-p has arrived!"});
1176     i = !rn2(6) ? \hyperlink{minion_8c_a44cebb3fe62fbb6f7d4308bf5b3d31c0}{ndemon}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a3f202dd89a837a9772a9eb1f1965f30c}{ualign}.\hyperlink{structalign_a0dadfa91b9ff06447f91ea8a2b898827}{type}) : \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM};
1177     pm = i != \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM} ? &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[i] : \hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data};
1178     \textcolor{keywordflow}{if} ((dtmp = makemon(pm, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}, \hyperlink{hack_8h_ae449582f467baa0da531a6ea116a18f2}{NO\_MM\_FLAGS})) != 0)
1179         (void)tamedog(dtmp, (\textcolor{keyword}{struct} \hyperlink{structobj}{obj} *)0);
1180     exercise(\hyperlink{attrib_8h_a4206d6431732a698ede8a237d5c17142}{A\_WIS}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
1181 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a1f2b299c2f3ac467c7005cc711ba82c9}{\index{uhitm.\+c@{uhitm.\+c}!end\+\_\+engulf@{end\+\_\+engulf}}
\index{end\+\_\+engulf@{end\+\_\+engulf}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{end\+\_\+engulf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void end\+\_\+engulf (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a1f2b299c2f3ac467c7005cc711ba82c9}


Definition at line 1727 of file uhitm.\+c.



References D\+I\+S\+P\+\_\+\+E\+N\+D, Invisible, newsym(), tmp\+\_\+at(), u, you\+::ux, and you\+::uy.



Referenced by gulpum().


\begin{DoxyCode}
1728 \{
1729     \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a3a091215989ce11abb81f94308b01b6d}{Invisible}) \{
1730         \hyperlink{display_8c_a0567746aec3aa9a3e8075d8eabb29846}{tmp\_at}(\hyperlink{display_8h_a6b799a763b3dbf2977bfe7c90951ab53}{DISP\_END}, 0);
1731         \hyperlink{display_8c_a185c6ad6e4c5a6be26a371b9aa17c32e}{newsym}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy});
1732     \}
1733 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a118a7e755b7b9cf312ae6e64f8f66b76}{\index{uhitm.\+c@{uhitm.\+c}!explum@{explum}}
\index{explum@{explum}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{explum}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int explum (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mdef, }
\item[{struct {\bf attack} $\ast$}]{mattk}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a118a7e755b7b9cf312ae6e64f8f66b76}


Definition at line 1657 of file uhitm.\+c.



References A\+D\+\_\+\+B\+L\+N\+D, A\+D\+\_\+\+C\+O\+L\+D, A\+D\+\_\+\+E\+L\+E\+C, A\+D\+\_\+\+F\+I\+R\+E, A\+D\+\_\+\+H\+A\+L\+U, haseyes, is\+\_\+golem, min, resists\+\_\+cold, resists\+\_\+elec, resists\+\_\+fire, and shieldeff().



Referenced by hmonas().


\begin{DoxyCode}
1660 \{
1661     \textcolor{keyword}{register} \textcolor{keywordtype}{int} tmp = d((\textcolor{keywordtype}{int})mattk->\hyperlink{structattack_abf8c529d3dc814dcbe98780aaa9a9194}{damn}, (\textcolor{keywordtype}{int})mattk->\hyperlink{structattack_ac2b210543d1c0d0db89106b7d5f9ee00}{damd});
1662 
1663     You(\textcolor{stringliteral}{"explode!"});
1664     \textcolor{keywordflow}{switch}(mattk->\hyperlink{structattack_a14286742d9dc1310f5c4852432264080}{adtyp}) \{
1665         \textcolor{keywordtype}{boolean} resistance; \textcolor{comment}{/* only for cold/fire/elec */}
1666 
1667         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a0b9368a6808378c4d573541efff21cb6}{AD\_BLND}:
1668         \textcolor{keywordflow}{if} (!resists\_blnd(mdef)) \{
1669             pline(\textcolor{stringliteral}{"%s is blinded by your flash of light!"}, Monnam(mdef));
1670             mdef->mblinded = \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}((\textcolor{keywordtype}{int})mdef->mblinded + tmp, 127);
1671             mdef->mcansee = 0;
1672         \}
1673         \textcolor{keywordflow}{break};
1674         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_aae0eb2eb802f24e236cf6baa4240060d}{AD\_HALU}:
1675         \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_acef071254b9ae0dcf53724485be10841}{haseyes}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) && mdef->mcansee) \{
1676             pline(\textcolor{stringliteral}{"%s is affected by your flash of light!"},
1677               Monnam(mdef));
1678             mdef->mconf = 1;
1679         \}
1680         \textcolor{keywordflow}{break};
1681         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_ad91817bd861d8b17fdfc7069122ab67e}{AD\_COLD}:
1682         resistance = \hyperlink{mondata_8h_a889684d1afa503bfbfcd1a3e84035b92}{resists\_cold}(mdef);
1683         \textcolor{keywordflow}{goto} common;
1684         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a2435fa84586bb5a35cf46f7abd380c86}{AD\_FIRE}:
1685         resistance = \hyperlink{mondata_8h_a9cd1ee3ba3c1e0e78509b763ce6d38d1}{resists\_fire}(mdef);
1686         \textcolor{keywordflow}{goto} common;
1687         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a3c61973cffe1d7a9ab234e619a05aeab}{AD\_ELEC}:
1688         resistance = \hyperlink{mondata_8h_a3ec4a5375d05f427a8e3e9d4f0b55f0e}{resists\_elec}(mdef);
1689 common:
1690         \textcolor{keywordflow}{if} (!resistance) \{
1691             pline(\textcolor{stringliteral}{"%s gets blasted!"}, Monnam(mdef));
1692             mdef->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} -= tmp;
1693             \textcolor{keywordflow}{if} (mdef->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} <= 0) \{
1694              killed(mdef);
1695              \textcolor{keywordflow}{return}(2);
1696             \}
1697         \} \textcolor{keywordflow}{else} \{
1698             \hyperlink{display_8c_ac89f44ae626d79f05953e503312a939d}{shieldeff}(mdef->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx}, mdef->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my});
1699             \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a6fd7f5f330b2b760d6a27b06062945a4}{is\_golem}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}))
1700             golemeffects(mdef, (\textcolor{keywordtype}{int})mattk->\hyperlink{structattack_a14286742d9dc1310f5c4852432264080}{adtyp}, tmp);
1701             \textcolor{keywordflow}{else}
1702             pline\_The(\textcolor{stringliteral}{"blast doesn't seem to affect %s."},
1703                 mon\_nam(mdef));
1704         \}
1705         \textcolor{keywordflow}{break};
1706         \textcolor{keywordflow}{default}:
1707         \textcolor{keywordflow}{break};
1708     \}
1709     \textcolor{keywordflow}{return}(1);
1710 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_aa0a563189042dbb18101357c34d1acab}{\index{uhitm.\+c@{uhitm.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf known\+\_\+hitum}}]{, }
\item[{(struct {\bf monst} $\ast$, int $\ast$, struct {\bf attack} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_aa0a563189042dbb18101357c34d1acab}
\hypertarget{uhitm_8c_a76b6db90700c45f5adc8c89a391a1b58}{\index{uhitm.\+c@{uhitm.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf steal\+\_\+it}}]{, }
\item[{(struct {\bf monst} $\ast$, struct {\bf attack} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a76b6db90700c45f5adc8c89a391a1b58}
\hypertarget{uhitm_8c_a382a07c83a71ab3e7bbcd599292a0df6}{\index{uhitm.\+c@{uhitm.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf hitum}}]{, }
\item[{(struct {\bf monst} $\ast$, int, struct {\bf attack} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a382a07c83a71ab3e7bbcd599292a0df6}
\hypertarget{uhitm_8c_a518b392defbc5730bd8a680d2bc47969}{\index{uhitm.\+c@{uhitm.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf hmon\+\_\+hitmon}}]{, }
\item[{(struct {\bf monst} $\ast$, struct {\bf obj} $\ast$, int)}]{}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a518b392defbc5730bd8a680d2bc47969}
\hypertarget{uhitm_8c_a18590d5e03a1b2dbafa6ffa0bfa29e21}{\index{uhitm.\+c@{uhitm.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf m\+\_\+slips\+\_\+free}}]{, }
\item[{(struct {\bf monst} $\ast$mtmp, struct {\bf attack} $\ast$mattk)}]{}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a18590d5e03a1b2dbafa6ffa0bfa29e21}
\hypertarget{uhitm_8c_a9cc403583021510fa698a78b0cde8b0b}{\index{uhitm.\+c@{uhitm.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf explum}}]{, }
\item[{(struct {\bf monst} $\ast$, struct {\bf attack} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a9cc403583021510fa698a78b0cde8b0b}
\hypertarget{uhitm_8c_a0f8b2ccf27d6ca3057799c4368810325}{\index{uhitm.\+c@{uhitm.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf start\+\_\+engulf}}]{, }
\item[{(struct {\bf monst} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a0f8b2ccf27d6ca3057799c4368810325}
\hypertarget{uhitm_8c_a422d61b174b27bd858725eafae3da908}{\index{uhitm.\+c@{uhitm.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf gulpum}}]{, }
\item[{(struct {\bf monst} $\ast$, struct {\bf attack} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a422d61b174b27bd858725eafae3da908}
\hypertarget{uhitm_8c_a55a2373ce055c5cac55d715e75160a66}{\index{uhitm.\+c@{uhitm.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf hmonas}}]{, }
\item[{(struct {\bf monst} $\ast$, int)}]{}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a55a2373ce055c5cac55d715e75160a66}
\hypertarget{uhitm_8c_a7722983cb5ed23bd376be91575f75894}{\index{uhitm.\+c@{uhitm.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf nohandglow}}]{, }
\item[{(struct {\bf monst} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a7722983cb5ed23bd376be91575f75894}
\hypertarget{uhitm_8c_a31925a96adb34b1243ecea4a7cd1d886}{\index{uhitm.\+c@{uhitm.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf shade\+\_\+aware}}]{, }
\item[{(struct {\bf obj} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a31925a96adb34b1243ecea4a7cd1d886}
\hypertarget{uhitm_8c_accae76bf34141d0859a6a4476e4720ee}{\index{uhitm.\+c@{uhitm.\+c}!find\+\_\+roll\+\_\+to\+\_\+hit@{find\+\_\+roll\+\_\+to\+\_\+hit}}
\index{find\+\_\+roll\+\_\+to\+\_\+hit@{find\+\_\+roll\+\_\+to\+\_\+hit}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{find\+\_\+roll\+\_\+to\+\_\+hit}]{\setlength{\rightskip}{0pt plus 5cm}{\bf schar} find\+\_\+roll\+\_\+to\+\_\+hit (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mtmp}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_accae76bf34141d0859a6a4476e4720ee}


Definition at line 230 of file uhitm.\+c.



References check\+\_\+caitiff(), monst\+::data, find\+\_\+mac(), is\+\_\+elf, is\+\_\+orc, Luck, maybe\+\_\+polyd, permonst\+::mlevel, Race\+\_\+if, align\+::record, Role\+\_\+if, Role\+::spelarmr, u, you\+::ualign, uarm, uarms, you\+::uhitinc, you\+::ulevel, Upolyd, urole, you\+::utrap, uwep, and youmonst.



Referenced by attack(), and kick\+\_\+monster().


\begin{DoxyCode}
232 \{
233     \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} tmp;
234     \textcolor{keywordtype}{int} tmp2;
235 
236     tmp = 1 + \hyperlink{you_8h_ae69937c86a71264fd0e91dab8a64cae4}{Luck} + abon() + \hyperlink{worn_8c_a03e1b53b51c959a61e4c205e65d1095a}{find\_mac}(mtmp) + \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a82f605992d46009b99965f3175ee4187}{uhitinc} +
237         \hyperlink{youprop_8h_a5d9c0d4dec4b697690cb11eb282f04dd}{maybe\_polyd}(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_aeed45d1ab54620bc7e5242b76f1c3c5f}{mlevel}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.
      \hyperlink{structyou_a6c7263bb25b91825bf7ecaab470d771a}{ulevel});
238 
239     \hyperlink{uhitm_8c_afec61dbcb8ae406b1caf9d8079627b60}{check\_caitiff}(mtmp);
240 
241 \textcolor{comment}{/*  attacking peaceful creatures is bad for the samurai's giri */}
242     \textcolor{keywordflow}{if} (\hyperlink{you_8h_a6087f5b8605964c19078b777da740258}{Role\_if}(PM\_SAMURAI) && mtmp->mpeaceful &&
243         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a3f202dd89a837a9772a9eb1f1965f30c}{ualign}.\hyperlink{structalign_ab3a768425270c33f059e3ead817e4e83}{record} > -10) \{
244         You(\textcolor{stringliteral}{"dishonorably attack the innocent!"});
245         adjalign(-1);
246     \}
247 
248 \textcolor{comment}{/*  Adjust vs. (and possibly modify) monster state.     */}
249 
250     \textcolor{keywordflow}{if}(mtmp->mstun) tmp += 2;
251     \textcolor{keywordflow}{if}(mtmp->mflee) tmp += 2;
252 
253     \textcolor{keywordflow}{if} (mtmp->msleeping) \{
254         mtmp->msleeping = 0;
255         tmp += 2;
256     \}
257     \textcolor{keywordflow}{if}(!mtmp->mcanmove) \{
258         tmp += 4;
259         \textcolor{keywordflow}{if}(!rn2(10)) \{
260             mtmp->mcanmove = 1;
261             mtmp->mfrozen = 0;
262         \}
263     \}
264     \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a2e5dce3b8165535b75a3b710aa3dc0bb}{is\_orc}(mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) && \hyperlink{youprop_8h_a5d9c0d4dec4b697690cb11eb282f04dd}{maybe\_polyd}(\hyperlink{mondata_8h_a34b30264e47f5967d450cc2c050951ce}{is\_elf}(
      \hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}),
265             \hyperlink{you_8h_ac1b9b8d9c3387e3d3a36b9474945879c}{Race\_if}(PM\_ELF)))
266         tmp++;
267     \textcolor{keywordflow}{if}(\hyperlink{you_8h_a6087f5b8605964c19078b777da740258}{Role\_if}(PM\_MONK) && !\hyperlink{you_8h_ab869582031082f2c352b374dc0e0c3b3}{Upolyd}) \{
268         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_ad6e6532c78ab5fe0078daf4cf352f3c1}{uarm}) \{
269         Your(\textcolor{stringliteral}{"armor is rather cumbersome..."});
270         tmp -= \hyperlink{you_8h_a5e8177648a9df85179098399b7ce2c66}{urole}.\hyperlink{structRole_ad8ed198d77085f02936e9acc576588c8}{spelarmr};
271         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} && !\hyperlink{decl_8h_aee21972b230a8408f2b85e26f195e91d}{uarms}) \{
272         tmp += (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a6c7263bb25b91825bf7ecaab470d771a}{ulevel} / 3) + 2;
273         \}
274     \}
275 
276 \textcolor{comment}{/*  with a lot of luggage, your agility diminishes */}
277     \textcolor{keywordflow}{if} ((tmp2 = near\_capacity()) != 0) tmp -= (tmp2*2) - 1;
278     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a7250d3b13a54b76d846b754a2a6f3fa6}{utrap}) tmp -= 3;
279 \textcolor{comment}{/*  Some monsters have a combination of weapon attacks and non-weapon}
280 \textcolor{comment}{ *  attacks.  It is therefore wrong to add hitval to tmp; we must add}
281 \textcolor{comment}{ *  it only for the specific attack (in hmonas()).}
282 \textcolor{comment}{ */}
283     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} && !\hyperlink{you_8h_ab869582031082f2c352b374dc0e0c3b3}{Upolyd}) \{
284         tmp += hitval(\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}, mtmp);
285         tmp += weapon\_hit\_bonus(\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep});
286     \}
287     \textcolor{keywordflow}{return} tmp;
288 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_ae7936c7531c0a357fdbf6015a820eac9}{\index{uhitm.\+c@{uhitm.\+c}!flash\+\_\+hits\+\_\+mon@{flash\+\_\+hits\+\_\+mon}}
\index{flash\+\_\+hits\+\_\+mon@{flash\+\_\+hits\+\_\+mon}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{flash\+\_\+hits\+\_\+mon}]{\setlength{\rightskip}{0pt plus 5cm}int flash\+\_\+hits\+\_\+mon (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mtmp, }
\item[{struct {\bf obj} $\ast$}]{otmp}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_ae7936c7531c0a357fdbf6015a820eac9}


Definition at line 2462 of file uhitm.\+c.



References A\+D\+\_\+\+B\+L\+N\+D, cansee, canseemon, canspotmon, F\+A\+L\+S\+E, flags, map\+\_\+invisible(), min, flag\+::mon\+\_\+moving, mons, obj\+::otyp, obj\+::ox, obj\+::oy, S\+\_\+\+L\+I\+G\+H\+T, obj\+::spe, and T\+R\+U\+E.


\begin{DoxyCode}
2465 \{
2466     \textcolor{keywordtype}{int} tmp, amt, res = 0, useeit = \hyperlink{display_8h_ad75e04a9624fe7ba0e1715ae3a3feb27}{canseemon}(mtmp);
2467 
2468     \textcolor{keywordflow}{if} (mtmp->msleeping) \{
2469         mtmp->msleeping = 0;
2470         \textcolor{keywordflow}{if} (useeit) \{
2471         pline\_The(\textcolor{stringliteral}{"flash awakens %s."}, mon\_nam(mtmp));
2472         res = 1;
2473         \}
2474     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ab402dbf1bed9d0e595a2b3da6558da92}{mlet} != \hyperlink{monsym_8h_a12f9073e331246f69c12938498713b20}{S\_LIGHT}) \{
2475         \textcolor{keywordflow}{if} (!resists\_blnd(mtmp)) \{
2476         tmp = dist2(otmp->\hyperlink{structobj_aac936c7da6b4f1eca0a94f75c242e5cc}{ox}, otmp->\hyperlink{structobj_a72dace5e678b56ae42c3fb19292e5839}{oy}, mtmp->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx}, mtmp->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my});
2477         \textcolor{keywordflow}{if} (useeit) \{
2478             pline(\textcolor{stringliteral}{"%s is blinded by the flash!"}, Monnam(mtmp));
2479             res = 1;
2480         \}
2481         \textcolor{keywordflow}{if} (mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_GREMLIN]) \{
2482             \textcolor{comment}{/* Rule #1: Keep them out of the light. */}
2483             amt = otmp->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == WAN\_LIGHT ? d(1 + otmp->\hyperlink{structobj_a14fc8dc59e9073bfbf1e170875a98448}{spe}, 4) :
2484                   rn2(\hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(mtmp->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp},4));
2485             pline(\textcolor{stringliteral}{"%s %s!"}, Monnam(mtmp), amt > mtmp->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} / 2 ?
2486               \textcolor{stringliteral}{"wails in agony"} : \textcolor{stringliteral}{"cries out in pain"});
2487             \textcolor{keywordflow}{if} ((mtmp->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} -= amt) <= 0) \{
2488             \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_aefca97315c578e47f6c6cdf06864db9e}{mon\_moving})
2489                 monkilled(mtmp, (\textcolor{keywordtype}{char} *)0, \hyperlink{monattk_8h_a0b9368a6808378c4d573541efff21cb6}{AD\_BLND});
2490             \textcolor{keywordflow}{else}
2491                 killed(mtmp);
2492             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{vision_8h_a857efc720262bc13a9e4b4bcbb079b5c}{cansee}(mtmp->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx},mtmp->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my}) && !\hyperlink{display_8h_a13f0a7cac1ceb73885a59b8598de1648}{canspotmon}(mtmp))\{
2493             \hyperlink{display_8c_add21782d0389d23fbc5a470ef91d77e9}{map\_invisible}(mtmp->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx}, mtmp->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my});
2494             \}
2495         \}
2496         \textcolor{keywordflow}{if} (mtmp->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} > 0) \{
2497             \textcolor{keywordflow}{if} (!\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_aefca97315c578e47f6c6cdf06864db9e}{mon\_moving}) setmangry(mtmp);
2498             \textcolor{keywordflow}{if} (tmp < 9 && !mtmp->isshk && rn2(4)) \{
2499             \textcolor{keywordflow}{if} (rn2(4))
2500                 monflee(mtmp, rnd(100), \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
2501             \textcolor{keywordflow}{else}
2502                 monflee(mtmp, 0, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
2503             \}
2504             mtmp->mcansee = 0;
2505             mtmp->mblinded = (tmp < 3) ? 0 : rnd(1 + 50/tmp);
2506         \}
2507         \}
2508     \}
2509     \textcolor{keywordflow}{return} res;
2510 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a913d911a86233fa27072d31fca8c5b3d}{\index{uhitm.\+c@{uhitm.\+c}!gulpum@{gulpum}}
\index{gulpum@{gulpum}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{gulpum}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int gulpum (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mdef, }
\item[{struct {\bf attack} $\ast$}]{mattk}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a913d911a86233fa27072d31fca8c5b3d}


Definition at line 1736 of file uhitm.\+c.



References A\+\_\+\+C\+O\+N, A\+D\+\_\+\+A\+C\+I\+D, A\+D\+\_\+\+B\+L\+N\+D, A\+D\+\_\+\+C\+O\+L\+D, A\+D\+\_\+\+D\+G\+S\+T, A\+D\+\_\+\+E\+L\+E\+C, A\+D\+\_\+\+F\+I\+R\+E, A\+D\+\_\+\+P\+H\+Y\+S, amphibious, flag\+::botl, B\+U\+F\+S\+Z, monst\+::data, D\+I\+E\+D, done, end\+\_\+engulf(), F\+A\+L\+S\+E, flags, flaming, u\+\_\+conduct\+::food, G\+\_\+\+N\+O\+C\+O\+R\+P\+S\+E, is\+\_\+animal, is\+\_\+rider, killer, killer\+\_\+format, mons, mvitals\+::mvflags, M\+Z\+\_\+\+H\+U\+G\+E, N\+O\+\_\+\+K\+I\+L\+L\+E\+R\+\_\+\+P\+R\+E\+F\+I\+X, obj\+::nobj, nomovemsg, otmp, resists\+\_\+acid, resists\+\_\+cold, resists\+\_\+elec, resists\+\_\+fire, Slimed, Slow\+\_\+digestion, Sprintf, start\+\_\+engulf(), S\+T\+O\+M\+A\+C\+H, Stone\+\_\+resistance, touch\+\_\+petrifies, T\+R\+U\+E, u, you\+::uconduct, you\+::uhunger, Unchanging, u\+\_\+conduct\+::unvegan, vegan, vegetarian, and youmonst.



Referenced by hmonas().


\begin{DoxyCode}
1739 \{
1740     \textcolor{keyword}{register} \textcolor{keywordtype}{int} tmp;
1741     \textcolor{keyword}{register} \textcolor{keywordtype}{int} dam = d((\textcolor{keywordtype}{int})mattk->\hyperlink{structattack_abf8c529d3dc814dcbe98780aaa9a9194}{damn}, (\textcolor{keywordtype}{int})mattk->\hyperlink{structattack_ac2b210543d1c0d0db89106b7d5f9ee00}{damd});
1742     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp};
1743     \textcolor{comment}{/* Not totally the same as for real monsters.  Specifically, these}
1744 \textcolor{comment}{     * don't take multiple moves.  (It's just too hard, for too little}
1745 \textcolor{comment}{     * result, to program monsters which attack from inside you, which}
1746 \textcolor{comment}{     * would be necessary if done accurately.)  Instead, we arbitrarily}
1747 \textcolor{comment}{     * kill the monster immediately for AD\_DGST and we regurgitate them}
1748 \textcolor{comment}{     * after exactly 1 round of attack otherwise.  -KAA}
1749 \textcolor{comment}{     */}
1750 
1751     \textcolor{keywordflow}{if}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_a29f8d76dae8c7c96eab01dd8ec27717b}{msize} >= \hyperlink{monflag_8h_a44e547132d6203d4d6d025a4d070ca5a}{MZ\_HUGE}) \textcolor{keywordflow}{return} 0;
1752 
1753     \textcolor{keywordflow}{if}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a66fb9624339df35ac2f9f08fdccde6c9}{uhunger} < 1500 && !\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uswallow) \{
1754         \textcolor{keywordflow}{for} (otmp = mdef->\hyperlink{structmonst_a480856d6a5db5610593c9816e525a978}{minvent}; otmp; otmp = otmp->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj})
1755         (void) snuff\_lit(otmp);
1756 
1757         \textcolor{keywordflow}{if}(!\hyperlink{mondata_8h_ad1e85e493d27cdfdbe94c43710c4b191}{touch\_petrifies}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) || \hyperlink{youprop_8h_a90b638323d50e1f8d52d4a9576d90551}{Stone\_resistance}) \{
1758 \textcolor{preprocessor}{#ifdef LINT }\textcolor{comment}{/* static char msgbuf[BUFSZ]; */}\textcolor{preprocessor}{}
1759         \textcolor{keywordtype}{char} msgbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
1760 \textcolor{preprocessor}{#else}
1761         \textcolor{keyword}{static} \textcolor{keywordtype}{char} msgbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
1762 \textcolor{preprocessor}{#endif}
1763         \hyperlink{uhitm_8c_a8fc39daab97b65a360b7b6f6ac1e823c}{start\_engulf}(mdef);
1764         \textcolor{keywordflow}{switch}(mattk->\hyperlink{structattack_a14286742d9dc1310f5c4852432264080}{adtyp}) \{
1765             \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a4e0a073faa0356ce688167de11e4c0fa}{AD\_DGST}:
1766             \textcolor{comment}{/* eating a Rider or its corpse is fatal */}
1767             \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_ae65c0c7b92cbe7cb6e8550523ef4f175}{is\_rider}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})) \{
1768              pline(\textcolor{stringliteral}{"Unfortunately, digesting any of it is fatal."});
1769                 \hyperlink{uhitm_8c_a1f2b299c2f3ac467c7005cc711ba82c9}{end\_engulf}();
1770                 \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(msgbuf, \textcolor{stringliteral}{"unwisely tried to eat %s"},
1771                     mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ae92da7d141243d7e37d4a12340bb248f}{mname});
1772                 \hyperlink{decl_8h_af7d2dea3996fe6d20ea8ec329726e8f9}{killer} = msgbuf;
1773                 \hyperlink{decl_8h_a0a94810d03a0bf68b371c6b1a1a4a905}{killer\_format} = \hyperlink{decl_8h_aa2ea21bcf7bdd470bd96936d5b80e0ba}{NO\_KILLER\_PREFIX};
1774                 \hyperlink{winX_8c_a032589f4f70300762622fd253db008d0}{done}(\hyperlink{hack_8h_a945602f8a7d9cde22e2502ffb5c51f58}{DIED});
1775                 \textcolor{keywordflow}{return} 0;       \textcolor{comment}{/* lifesaved */}
1776             \}
1777 
1778             \textcolor{keywordflow}{if} (\hyperlink{youprop_8h_a7c0b7941d594c5471fceca909a3db7fd}{Slow\_digestion}) \{
1779                 dam = 0;
1780                 \textcolor{keywordflow}{break};
1781             \}
1782 
1783             \textcolor{comment}{/* KMH, conduct */}
1784             \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac34f4744daa7ff78a6ff556ade5b9601}{uconduct}.\hyperlink{structu__conduct_a2d5d295afd232b076220ca486b720ed1}{food}++;
1785             \textcolor{keywordflow}{if} (!\hyperlink{mondata_8h_a028ffec60e35d2250ae328b2dbd8acf4}{vegan}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}))
1786                  \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac34f4744daa7ff78a6ff556ade5b9601}{uconduct}.\hyperlink{structu__conduct_a3f98bca389fa71f4dabbd75829719dbf}{unvegan}++;
1787             \textcolor{keywordflow}{if} (!\hyperlink{mondata_8h_a57bbc8d06bdcc1788f06bcd3a9028845}{vegetarian}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}))
1788                  violated\_vegetarian();
1789 
1790             \textcolor{comment}{/* Use up amulet of life saving */}
1791             \textcolor{keywordflow}{if} (!!(otmp = mlifesaver(mdef))) m\_useup(mdef, otmp);
1792 
1793             newuhs(\hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1794             xkilled(mdef,2);
1795             \textcolor{keywordflow}{if} (mdef->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} > 0) \{ \textcolor{comment}{/* monster lifesaved */}
1796                 You(\textcolor{stringliteral}{"hurriedly regurgitate the sizzling in your %s."},
1797                 body\_part(\hyperlink{hack_8h_afe6da63d3b68440a889df103056403c5}{STOMACH}));
1798             \} \textcolor{keywordflow}{else} \{
1799                 tmp = 1 + (mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_aee69b23cdcca0ae25f25eff876ab86ae}{cwt} >> 8);
1800                 \textcolor{keywordflow}{if} (corpse\_chance(mdef, &\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}) &&
1801                 !(\hyperlink{structmvitals}{mvitals}[monsndx(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})].\hyperlink{structmvitals_a51369b55e24dc02d3f5768b8f5b01381}{mvflags} &
1802                   \hyperlink{monflag_8h_ab29fe4d215c411d059acee4d030f0f1f}{G\_NOCORPSE})) \{
1803                 \textcolor{comment}{/* nutrition only if there can be a corpse */}
1804                 \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a66fb9624339df35ac2f9f08fdccde6c9}{uhunger} += (mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ac13149ec4e586659f7556acf7aab9b01}{cnutrit}+1) / 2;
1805                 \} \textcolor{keywordflow}{else} tmp = 0;
1806                 \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(msgbuf, \textcolor{stringliteral}{"You totally digest %s."},
1807                         mon\_nam(mdef));
1808                 \textcolor{keywordflow}{if} (tmp != 0) \{
1809                 \textcolor{comment}{/* setting afternmv = end\_engulf is tempting,}
1810 \textcolor{comment}{                 * but will cause problems if the player is}
1811 \textcolor{comment}{                 * attacked (which uses his real location) or}
1812 \textcolor{comment}{                 * if his See\_invisible wears off}
1813 \textcolor{comment}{                 */}
1814                 You(\textcolor{stringliteral}{"digest %s."}, mon\_nam(mdef));
1815                 \textcolor{keywordflow}{if} (\hyperlink{youprop_8h_a7c0b7941d594c5471fceca909a3db7fd}{Slow\_digestion}) tmp *= 2;
1816                 nomul(-tmp);
1817                 \hyperlink{decl_8h_a03b001040702c25afae477b18b1692c3}{nomovemsg} = msgbuf;
1818                 \} \textcolor{keywordflow}{else} pline(\textcolor{stringliteral}{"%s"}, msgbuf);
1819                 \textcolor{keywordflow}{if} (mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_GREEN\_SLIME]) \{
1820                 \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(msgbuf, \textcolor{stringliteral}{"%s isn't sitting well with you."},
1821                     The(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ae92da7d141243d7e37d4a12340bb248f}{mname}));
1822                 \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a10db02e9dc6f21655b4bbc61abdd0a12}{Unchanging}) \{
1823                     \hyperlink{youprop_8h_a1d6ced121072dc4fb35b71e5fdebe596}{Slimed} = 5L;
1824                     \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a51f16d01a910b52fdf0c05a44739f7d8}{botl} = 1;
1825                 \}
1826                 \} \textcolor{keywordflow}{else}
1827                 exercise(\hyperlink{attrib_8h_a82a29f9d3d2390f61fc68b2a352b5da3}{A\_CON}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
1828             \}
1829             \hyperlink{uhitm_8c_a1f2b299c2f3ac467c7005cc711ba82c9}{end\_engulf}();
1830             \textcolor{keywordflow}{return}(2);
1831             \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a9191d6bf636e5ada34fa9169ecaa4d9a}{AD\_PHYS}:
1832             \textcolor{keywordflow}{if} (\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_FOG\_CLOUD]) \{
1833                 pline(\textcolor{stringliteral}{"%s is laden with your moisture."},
1834                   Monnam(mdef));
1835                 \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_af598ecbfaf539d9840a9b5e4a872f6b7}{amphibious}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) &&
1836                 !\hyperlink{mondata_8h_aadb2718743a42260876de9cb19469e1b}{flaming}(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})) \{
1837                 dam = 0;
1838                 pline(\textcolor{stringliteral}{"%s seems unharmed."}, Monnam(mdef));
1839                 \}
1840             \} \textcolor{keywordflow}{else}
1841                 pline(\textcolor{stringliteral}{"%s is pummeled with your debris!"},
1842                   Monnam(mdef));
1843             \textcolor{keywordflow}{break};
1844             \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a6bfc66a52d2d02a9d043f28a44f7def3}{AD\_ACID}:
1845             pline(\textcolor{stringliteral}{"%s is covered with your goo!"}, Monnam(mdef));
1846             \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a67859b0b3aa8e4ac0d74a818013cb507}{resists\_acid}(mdef)) \{
1847                 pline(\textcolor{stringliteral}{"It seems harmless to %s."}, mon\_nam(mdef));
1848                 dam = 0;
1849             \}
1850             \textcolor{keywordflow}{break};
1851             \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a0b9368a6808378c4d573541efff21cb6}{AD\_BLND}:
1852             \textcolor{keywordflow}{if} (can\_blnd(&\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}, mdef, mattk->\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp}, (\textcolor{keyword}{struct} \hyperlink{structobj}{obj} *)0)) \{
1853                 \textcolor{keywordflow}{if} (mdef->mcansee)
1854                 pline(\textcolor{stringliteral}{"%s can't see in there!"}, Monnam(mdef));
1855                 mdef->mcansee = 0;
1856                 dam += mdef->mblinded;
1857                 \textcolor{keywordflow}{if} (dam > 127) dam = 127;
1858                 mdef->mblinded = dam;
1859             \}
1860             dam = 0;
1861             \textcolor{keywordflow}{break};
1862             \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a3c61973cffe1d7a9ab234e619a05aeab}{AD\_ELEC}:
1863             \textcolor{keywordflow}{if} (rn2(2)) \{
1864                 pline\_The(\textcolor{stringliteral}{"air around %s crackles with electricity."}, mon\_nam(mdef));
1865                 \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a3ec4a5375d05f427a8e3e9d4f0b55f0e}{resists\_elec}(mdef)) \{
1866                 pline(\textcolor{stringliteral}{"%s seems unhurt."}, Monnam(mdef));
1867                 dam = 0;
1868                 \}
1869                 golemeffects(mdef,(\textcolor{keywordtype}{int})mattk->\hyperlink{structattack_a14286742d9dc1310f5c4852432264080}{adtyp},dam);
1870             \} \textcolor{keywordflow}{else} dam = 0;
1871             \textcolor{keywordflow}{break};
1872             \textcolor{keywordflow}{case} \hyperlink{monattk_8h_ad91817bd861d8b17fdfc7069122ab67e}{AD\_COLD}:
1873             \textcolor{keywordflow}{if} (rn2(2)) \{
1874                 \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a889684d1afa503bfbfcd1a3e84035b92}{resists\_cold}(mdef)) \{
1875                 pline(\textcolor{stringliteral}{"%s seems mildly chilly."}, Monnam(mdef));
1876                 dam = 0;
1877                 \} \textcolor{keywordflow}{else}
1878                 pline(\textcolor{stringliteral}{"%s is freezing to death!"},Monnam(mdef));
1879                 golemeffects(mdef,(\textcolor{keywordtype}{int})mattk->\hyperlink{structattack_a14286742d9dc1310f5c4852432264080}{adtyp},dam);
1880             \} \textcolor{keywordflow}{else} dam = 0;
1881             \textcolor{keywordflow}{break};
1882             \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a2435fa84586bb5a35cf46f7abd380c86}{AD\_FIRE}:
1883             \textcolor{keywordflow}{if} (rn2(2)) \{
1884                 \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a9cd1ee3ba3c1e0e78509b763ce6d38d1}{resists\_fire}(mdef)) \{
1885                 pline(\textcolor{stringliteral}{"%s seems mildly hot."}, Monnam(mdef));
1886                 dam = 0;
1887                 \} \textcolor{keywordflow}{else}
1888                 pline(\textcolor{stringliteral}{"%s is burning to a crisp!"},Monnam(mdef));
1889                 golemeffects(mdef,(\textcolor{keywordtype}{int})mattk->\hyperlink{structattack_a14286742d9dc1310f5c4852432264080}{adtyp},dam);
1890             \} \textcolor{keywordflow}{else} dam = 0;
1891             \textcolor{keywordflow}{break};
1892         \}
1893         \hyperlink{uhitm_8c_a1f2b299c2f3ac467c7005cc711ba82c9}{end\_engulf}();
1894         \textcolor{keywordflow}{if} ((mdef->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} -= dam) <= 0) \{
1895             killed(mdef);
1896             \textcolor{keywordflow}{if} (mdef->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} <= 0)  \textcolor{comment}{/* not lifesaved */}
1897             \textcolor{keywordflow}{return}(2);
1898         \}
1899         You(\textcolor{stringliteral}{"%s %s!"}, \hyperlink{mondata_8h_a6633b7e5ce3955ef878c6890a72b9392}{is\_animal}(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) ? \textcolor{stringliteral}{"regurgitate"}
1900             : \textcolor{stringliteral}{"expel"}, mon\_nam(mdef));
1901         \textcolor{keywordflow}{if} (\hyperlink{youprop_8h_a7c0b7941d594c5471fceca909a3db7fd}{Slow\_digestion} || \hyperlink{mondata_8h_a6633b7e5ce3955ef878c6890a72b9392}{is\_animal}(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.
      \hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})) \{
1902             pline(\textcolor{stringliteral}{"Obviously, you didn't like %s taste."},
1903               s\_suffix(mon\_nam(mdef)));
1904         \}
1905         \} \textcolor{keywordflow}{else} \{
1906         \textcolor{keywordtype}{char} kbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
1907 
1908         You(\textcolor{stringliteral}{"bite into %s."}, mon\_nam(mdef));
1909         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(kbuf, \textcolor{stringliteral}{"swallowing %s whole"}, an(mdef->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ae92da7d141243d7e37d4a12340bb248f}{mname}));
1910         instapetrify(kbuf);
1911         \}
1912     \}
1913     \textcolor{keywordflow}{return}(0);
1914 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a81df17e7bc6a68bef3eda955de3071b5}{\index{uhitm.\+c@{uhitm.\+c}!hitum@{hitum}}
\index{hitum@{hitum}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{hitum}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} hitum (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mon, }
\item[{int}]{tmp, }
\item[{struct {\bf attack} $\ast$}]{uattk}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a81df17e7bc6a68bef3eda955de3071b5}


Definition at line 472 of file uhitm.\+c.



References A\+\_\+\+D\+E\+X, A\+T\+\_\+\+W\+E\+A\+P, known\+\_\+hitum(), passive(), T\+R\+U\+E, and u.



Referenced by attack().


\begin{DoxyCode}
476 \{
477     \textcolor{keywordtype}{boolean} malive;
478     \textcolor{keywordtype}{int} mhit = (tmp > (\hyperlink{uhitm_8c_ac2d2b71a2fe853fe47029a09aed9aca0}{dieroll} = rnd(20)) || \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uswallow);
479 
480     \textcolor{keywordflow}{if}(tmp > dieroll) exercise(\hyperlink{attrib_8h_ad8117dfaac470310d7540a3e8dcc00e0}{A\_DEX}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
481     malive = \hyperlink{uhitm_8c_a584798493588e0c419478797a914e2e2}{known\_hitum}(mon, &mhit, uattk);
482     (void) \hyperlink{uhitm_8c_a53e92ab7e839e04fe836f61047b8b34c}{passive}(mon, mhit, malive, \hyperlink{monattk_8h_a6db6784344c2424d385f6b460f0c029f}{AT\_WEAP});
483     \textcolor{keywordflow}{return}(malive);
484 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a995bc5394db9ea09e5851976d7f9f755}{\index{uhitm.\+c@{uhitm.\+c}!hmon@{hmon}}
\index{hmon@{hmon}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{hmon}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} hmon (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mon, }
\item[{struct {\bf obj} $\ast$}]{obj, }
\item[{int}]{thrown}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a995bc5394db9ea09e5851976d7f9f755}


Definition at line 487 of file uhitm.\+c.



References flags, hmon\+\_\+hitmon(), mons, and flag\+::soundok.



Referenced by drag\+\_\+ball(), known\+\_\+hitum(), and thitmonst().


\begin{DoxyCode}
491 \{
492     \textcolor{keywordtype}{boolean} result, anger\_guards;
493 
494     anger\_guards = (mon->mpeaceful &&
495                 (mon->ispriest || mon->isshk ||
496                  mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_WATCHMAN] ||
497                  mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_WATCH\_CAPTAIN]));
498     result = \hyperlink{uhitm_8c_a9d8bafc68920d5deaaaf935d11709739}{hmon\_hitmon}(mon, obj, thrown);
499     \textcolor{keywordflow}{if} (mon->ispriest && !rn2(2)) ghod\_hitsu(mon);
500     \textcolor{keywordflow}{if} (anger\_guards) (void)angry\_guards(!\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_ae3871fd2268fbc24b89cece8eb352dfc}{soundok});
501     \textcolor{keywordflow}{return} result;
502 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a9d8bafc68920d5deaaaf935d11709739}{\index{uhitm.\+c@{uhitm.\+c}!hmon\+\_\+hitmon@{hmon\+\_\+hitmon}}
\index{hmon\+\_\+hitmon@{hmon\+\_\+hitmon}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{hmon\+\_\+hitmon}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} hmon\+\_\+hitmon (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mon, }
\item[{struct {\bf obj} $\ast$}]{obj, }
\item[{int}]{thrown}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a9d8bafc68920d5deaaaf935d11709739}


Definition at line 506 of file uhitm.\+c.



References A\+\_\+\+L\+A\+W\+F\+U\+L, A\+\_\+\+W\+I\+S, ammo\+\_\+and\+\_\+launcher, A\+T\+\_\+\+S\+P\+I\+T, A\+T\+\_\+\+W\+E\+A\+P, bigmonst, bimanual, Blind, breaktest(), B\+U\+F\+S\+Z, canseemon, canspotmon, obj\+::corpsenm, D\+E\+A\+D\+M\+O\+N\+S\+T\+E\+R, you\+::dx, you\+::dy, F\+A\+C\+E, F\+A\+L\+S\+E, flags, G\+E\+M\+\_\+\+C\+L\+A\+S\+S, greatest\+\_\+erosion, haseyes, I\+R\+O\+N, is\+\_\+ammo, is\+\_\+demon, is\+\_\+flimsy, is\+\_\+launcher, is\+\_\+missile, is\+\_\+poisonable, is\+\_\+pole, is\+\_\+undead, is\+\_\+weptool, joust(), L\+O\+W\+\_\+\+P\+M, m\+\_\+shot, martial\+\_\+bonus, mhurtle(), permonst\+::mname, M\+O\+N\+\_\+\+N\+O\+W\+E\+P, M\+O\+N\+\_\+\+W\+E\+P, mons, permonst\+::msize, munstone(), multishot\+::n, N\+E\+E\+D\+\_\+\+W\+E\+A\+P\+O\+N, nohandglow(), N\+O\+N\+\_\+\+P\+M, noncorporeal, N\+O\+T\+E\+L\+L, multishot\+::o, obj\+::oartifact, objects, obj\+::oclass, obj\+::otyp, obj\+::owt, P\+\_\+\+B\+A\+R\+E\+\_\+\+H\+A\+N\+D\+E\+D\+\_\+\+C\+O\+M\+B\+A\+T, P\+\_\+\+L\+A\+N\+C\+E, P\+\_\+\+N\+O\+N\+E, P\+\_\+\+S\+K\+I\+L\+L, P\+\_\+\+S\+K\+I\+L\+L\+E\+D, plur, P\+O\+T\+I\+O\+N\+\_\+\+C\+L\+A\+S\+S, P\+R\+O\+J\+E\+C\+T\+I\+L\+E, obj\+::quan, Race\+\_\+if, align\+::record, resists\+\_\+acid, resists\+\_\+poison, resists\+\_\+ston, rn1, R\+O\+C\+K, Role\+\_\+if, setuwep(), shade\+\_\+aware(), S\+I\+L\+V\+E\+R, S\+P\+B\+O\+O\+K\+\_\+\+C\+L\+A\+S\+S, obj\+::spe, Sprintf, stale\+\_\+egg, S\+T\+E\+E\+D, Strcpy, thick\+\_\+skinned, obj\+::timed, touch\+\_\+petrifies, T\+R\+U\+E, you\+::twoweap, align\+::type, u, you\+::ualign, uarm, uarmg, uarms, you\+::udaminc, uleft, you\+::ulevel, you\+::umconf, unweapon, Upolyd, uright, useup\+\_\+eggs, you\+::ustuck, uwep, uwepgone(), flag\+::verbose, W\+E\+A\+P\+O\+N\+\_\+\+C\+L\+A\+S\+S, what, and youmonst.



Referenced by hmon().


\begin{DoxyCode}
510 \{
511     \textcolor{keywordtype}{int} tmp;
512     \textcolor{keyword}{struct }\hyperlink{structpermonst}{permonst} *mdat = mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data};
513     \textcolor{keywordtype}{int} barehand\_silver\_rings = 0;
514     \textcolor{comment}{/* The basic reason we need all these booleans is that we don't want}
515 \textcolor{comment}{     * a "hit" message when a monster dies, so we have to know how much}
516 \textcolor{comment}{     * damage it did \_before\_ outputting a hit message, but any messages}
517 \textcolor{comment}{     * associated with the damage don't come out until \_after\_ outputting}
518 \textcolor{comment}{     * a hit message.}
519 \textcolor{comment}{     */}
520     \textcolor{keywordtype}{boolean} hittxt = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, destroyed = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, already\_killed = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
521     \textcolor{keywordtype}{boolean} get\_dmg\_bonus = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
522     \textcolor{keywordtype}{boolean} ispoisoned = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, needpoismsg = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, poiskilled = 
      \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
523     \textcolor{keywordtype}{boolean} silvermsg = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, silverobj = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
524     \textcolor{keywordtype}{boolean} valid\_weapon\_attack = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
525     \textcolor{keywordtype}{boolean} unarmed = !\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} && !\hyperlink{decl_8h_ad6e6532c78ab5fe0078daf4cf352f3c1}{uarm} && !\hyperlink{decl_8h_aee21972b230a8408f2b85e26f195e91d}{uarms};
526 \textcolor{preprocessor}{#ifdef STEED}
527     \textcolor{keywordtype}{int} jousting = 0;
528 \textcolor{preprocessor}{#endif}
529     \textcolor{keywordtype}{int} wtype;
530     \textcolor{keyword}{struct }obj *monwep;
531     \textcolor{keywordtype}{char} yourbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
532     \textcolor{keywordtype}{char} unconventional[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];    \textcolor{comment}{/* substituted for word "attack" in msg */}
533     \textcolor{keywordtype}{char} saved\_oname[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
534 
535     unconventional[0] = \textcolor{charliteral}{'\(\backslash\)0'};
536     saved\_oname[0] = \textcolor{charliteral}{'\(\backslash\)0'};
537 
538     wakeup(mon);
539     \textcolor{keywordflow}{if}(!obj) \{  \textcolor{comment}{/* attack with bare hands */}
540         \textcolor{keywordflow}{if} (mdat == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_SHADE])
541         tmp = 0;
542         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{skills_8h_a37f3764f7dee27c5242e62d8ac6c401e}{martial\_bonus}())
543         tmp = rnd(4);   \textcolor{comment}{/* bonus for martial arts */}
544         \textcolor{keywordflow}{else}
545         tmp = rnd(2);
546         valid\_weapon\_attack = (tmp > 1);
547         \textcolor{comment}{/* blessed gloves give bonuses when fighting 'bare-handed' */}
548         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a374ab5e4582cfafa2d4ef57211f53293}{uarmg} && \hyperlink{decl_8h_a374ab5e4582cfafa2d4ef57211f53293}{uarmg}->blessed && (\hyperlink{mondata_8h_a8e10c42bf31c42d748765a29105842fc}{is\_undead}(mdat) || 
      \hyperlink{mondata_8h_a9f5d39edf86a6137fd76d419c7914af4}{is\_demon}(mdat)))
549         tmp += rnd(4);
550         \textcolor{comment}{/* So do silver rings.  Note: rings are worn under gloves, so you}
551 \textcolor{comment}{         * don't get both bonuses.}
552 \textcolor{comment}{         */}
553         \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_a374ab5e4582cfafa2d4ef57211f53293}{uarmg}) \{
554         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_abc75269125700f0668785d8f073a3646}{uleft} && \hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[\hyperlink{decl_8h_abc75269125700f0668785d8f073a3646}{uleft}->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp}].oc\_material == 
      \hyperlink{objclass_8h_a7e76a14a479114a4b9b20782bb00e69a}{SILVER})
555             barehand\_silver\_rings++;
556         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a2d7c456e0ac88316ae0b9e8ae32d17b3}{uright} && \hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[\hyperlink{decl_8h_a2d7c456e0ac88316ae0b9e8ae32d17b3}{uright}->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp}].oc\_material == 
      \hyperlink{objclass_8h_a7e76a14a479114a4b9b20782bb00e69a}{SILVER})
557             barehand\_silver\_rings++;
558         \textcolor{keywordflow}{if} (barehand\_silver\_rings && hates\_silver(mdat)) \{
559             tmp += rnd(20);
560             silvermsg = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
561         \}
562         \}
563     \} \textcolor{keywordflow}{else} \{
564         \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(saved\_oname, cxname(obj));
565         \textcolor{keywordflow}{if}(obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == \hyperlink{objclass_8h_a615c2dc6d3501d6b5e14c3373bc37ec1}{WEAPON\_CLASS} || \hyperlink{obj_8h_a5f347f7456e4da8284a9bc369bc32d45}{is\_weptool}(obj) ||
566            obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == \hyperlink{objclass_8h_afc09c51ea922e9928f86a51177244796}{GEM\_CLASS}) \{
567 
568         \textcolor{comment}{/* is it not a melee weapon? */}
569         \textcolor{keywordflow}{if} (\textcolor{comment}{/* if you strike with a bow... */}
570             \hyperlink{obj_8h_a1e24f22788f0b91381a52c8fb38850bd}{is\_launcher}(obj) ||
571             \textcolor{comment}{/* or strike with a missile in your hand... */}
572             (!thrown && (\hyperlink{obj_8h_a8f997086cdf86ba7eb98102f6e7d4b90}{is\_missile}(obj) || \hyperlink{obj_8h_a17d7bf4a6f8336a314c0825cf5848c54}{is\_ammo}(obj))) ||
573             \textcolor{comment}{/* or use a pole at short range and not mounted... */}
574             (!thrown &&
575 #ifdef \hyperlink{config_8h_a0386a3058afaec36a953bb688cf7cf04}{STEED}
576              !\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.usteed &&
577 #endif
578              \hyperlink{obj_8h_a29685da5fad6a22d02355fb61bbf234b}{is\_pole}(obj)) ||
579             \textcolor{comment}{/* or throw a missile without the proper bow... */}
580             (\hyperlink{obj_8h_a17d7bf4a6f8336a314c0825cf5848c54}{is\_ammo}(obj) && !\hyperlink{obj_8h_a766dc63537673239906c55a19f384b1d}{ammo\_and\_launcher}(obj, 
      \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}))) \{
581             \textcolor{comment}{/* then do only 1-2 points of damage */}
582             \textcolor{keywordflow}{if} (mdat == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_SHADE] && obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} != SILVER\_ARROW)
583             tmp = 0;
584             \textcolor{keywordflow}{else}
585             tmp = rnd(2);
586             \textcolor{keywordflow}{if} (!thrown && obj == \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} && obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == BOOMERANG &&
587                 rnl(4) == 4-1) \{
588             \textcolor{keywordtype}{boolean} more\_than\_1 = (obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} > 1L);
589 
590             pline(\textcolor{stringliteral}{"As you hit %s, %s%s %s breaks into splinters."},
591                   mon\_nam(mon), more\_than\_1 ? \textcolor{stringliteral}{"one of "} : \textcolor{stringliteral}{""},
592                   shk\_your(yourbuf, obj), xname(obj));
593             \textcolor{keywordflow}{if} (!more\_than\_1) \hyperlink{wield_8c_acfe25ed4d9db889cb4bc70a9c5ab9c4d}{uwepgone}();   \textcolor{comment}{/* set unweapon */}
594             useup(obj);
595             \textcolor{keywordflow}{if} (!more\_than\_1) obj = (\textcolor{keyword}{struct }obj *) 0;
596             hittxt = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
597             \textcolor{keywordflow}{if} (mdat != &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_SHADE])
598                 tmp++;
599             \}
600         \} \textcolor{keywordflow}{else} \{
601             tmp = dmgval(obj, mon);
602             \textcolor{comment}{/* a minimal hit doesn't exercise proficiency */}
603             valid\_weapon\_attack = (tmp > 1);
604             \textcolor{keywordflow}{if} (!valid\_weapon\_attack || mon == \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck} || \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ade2cee6956bba775aa796bba6ae857ec}{twoweap}) \{
605             ;   \textcolor{comment}{/* no special bonuses */}
606             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mon->mflee && \hyperlink{you_8h_a6087f5b8605964c19078b777da740258}{Role\_if}(PM\_ROGUE) && !\hyperlink{you_8h_ab869582031082f2c352b374dc0e0c3b3}{Upolyd}) \{
607             You(\textcolor{stringliteral}{"strike %s from behind!"}, mon\_nam(mon));
608             tmp += rnd(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a6c7263bb25b91825bf7ecaab470d771a}{ulevel});
609             hittxt = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
610             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{uhitm_8c_ac2d2b71a2fe853fe47029a09aed9aca0}{dieroll} == 2 && obj == \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} &&
611               obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == \hyperlink{objclass_8h_a615c2dc6d3501d6b5e14c3373bc37ec1}{WEAPON\_CLASS} &&
612               (\hyperlink{obj_8h_a6cd644088e281f2bcc78f1d94dc91476}{bimanual}(obj) ||
613                 (\hyperlink{you_8h_a6087f5b8605964c19078b777da740258}{Role\_if}(PM\_SAMURAI) && obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == KATANA && !\hyperlink{decl_8h_aee21972b230a8408f2b85e26f195e91d}{uarms})) &&
614               ((wtype = uwep\_skill\_type()) != \hyperlink{skills_8h_a85d9ffb730a902e2dc0e7a90621b2144}{P\_NONE} &&
615                 \hyperlink{skills_8h_a778eff14f7209290967e1627b0b737ea}{P\_SKILL}(wtype) >= \hyperlink{skills_8h_a63b5a038baa248a89d0cb288e6fa01ef}{P\_SKILLED}) &&
616               ((monwep = \hyperlink{monst_8h_a19da8d7346e2a28afa6385a73cf36f86}{MON\_WEP}(mon)) != 0 &&
617                !\hyperlink{obj_8h_abddc351efe0b64d02040a3ae8c320c19}{is\_flimsy}(monwep) &&
618                !obj\_resists(monwep,
619                  50 + 15 * \hyperlink{obj_8h_ac240beb25ae6ec398ee270cdf4c79155}{greatest\_erosion}(obj), 100))) \{
620             \textcolor{comment}{/*}
621 \textcolor{comment}{             * 2.5% chance of shattering defender's weapon when}
622 \textcolor{comment}{             * using a two-handed weapon; less if uwep is rusted.}
623 \textcolor{comment}{             * [dieroll == 2 is most successful non-beheading or}
624 \textcolor{comment}{             * -bisecting hit, in case of special artifact damage;}
625 \textcolor{comment}{             * the percentage chance is (1/20)*(50/100).]}
626 \textcolor{comment}{             */}
627             setmnotwielded(mon,monwep);
628             \hyperlink{monst_8h_a34607029d74c5c6d0cb7f33d2092b8c8}{MON\_NOWEP}(mon);
629             mon->\hyperlink{structmonst_a78c189917d1c1a53b6ac4fa2fb65611a}{weapon\_check} = \hyperlink{monst_8h_a1fa676706b8c4f16d29a9d6536041f3b}{NEED\_WEAPON};
630             pline(\textcolor{stringliteral}{"%s %s %s from the force of your blow!"},
631                   s\_suffix(Monnam(mon)), xname(monwep),
632                   otense(monwep, \textcolor{stringliteral}{"shatter"}));
633             m\_useup(mon, monwep);
634             \textcolor{comment}{/* If someone just shattered MY weapon, I'd flee! */}
635             \textcolor{keywordflow}{if} (rn2(4)) \{
636                 monflee(mon, d(2,3), \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
637             \}
638             hittxt = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
639             \}
640 
641             \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_af03ce8a6a0ca51e8d8954fb1a1a31fbe}{oartifact} &&
642             artifact\_hit(&\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}, mon, obj, &tmp, \hyperlink{uhitm_8c_ac2d2b71a2fe853fe47029a09aed9aca0}{dieroll})) \{
643             \textcolor{keywordflow}{if}(mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} <= 0) \textcolor{comment}{/* artifact killed monster */}
644                 \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
645             \textcolor{keywordflow}{if} (tmp == 0) \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
646             hittxt = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
647             \}
648             \textcolor{keywordflow}{if} (\hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp}].oc\_material == \hyperlink{objclass_8h_a7e76a14a479114a4b9b20782bb00e69a}{SILVER}
649                 && hates\_silver(mdat)) \{
650             silvermsg = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}; silverobj = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
651             \}
652 \textcolor{preprocessor}{#ifdef STEED}
653             \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.usteed && !thrown && tmp > 0 &&
654                 weapon\_type(obj) == \hyperlink{skills_8h_a79d6d31d98c7b76f6d5690bd0ea4e055}{P\_LANCE} && mon != \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck}) \{
655             jousting = \hyperlink{uhitm_8c_a6fea92a8b59242c71925035e7879612b}{joust}(mon, obj);
656             \textcolor{comment}{/* exercise skill even for minimal damage hits */}
657             \textcolor{keywordflow}{if} (jousting) valid\_weapon\_attack = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
658             \}
659 \textcolor{preprocessor}{#endif}
660             \textcolor{keywordflow}{if} (thrown && (\hyperlink{obj_8h_a17d7bf4a6f8336a314c0825cf5848c54}{is\_ammo}(obj) || \hyperlink{obj_8h_a8f997086cdf86ba7eb98102f6e7d4b90}{is\_missile}(obj))) \{
661             \textcolor{keywordflow}{if} (\hyperlink{obj_8h_a766dc63537673239906c55a19f384b1d}{ammo\_and\_launcher}(obj, \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep})) \{
662                 \textcolor{comment}{/* Elves and Samurai do extra damage using}
663 \textcolor{comment}{                 * their bows&arrows; they're highly trained.}
664 \textcolor{comment}{                 */}
665                 \textcolor{keywordflow}{if} (\hyperlink{you_8h_a6087f5b8605964c19078b777da740258}{Role\_if}(PM\_SAMURAI) &&
666                 obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == YA && \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == YUMI)
667                 tmp++;
668                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{you_8h_ac1b9b8d9c3387e3d3a36b9474945879c}{Race\_if}(PM\_ELF) &&
669                      obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == ELVEN\_ARROW &&
670                      \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == ELVEN\_BOW)
671                 tmp++;
672             \}
673             \textcolor{keywordflow}{if}(obj->opoisoned && \hyperlink{obj_8h_a6c9b07c199b118761a2675a3826d12c4}{is\_poisonable}(obj))
674                 ispoisoned = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
675             \}
676         \}
677         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == \hyperlink{objclass_8h_a05335e5ee18dfa33af1c40056fe8fab9}{POTION\_CLASS}) \{
678         \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} > 1L)
679             obj = splitobj(obj, 1L);
680         \textcolor{keywordflow}{else}
681             \hyperlink{wield_8c_adc7f46a6707f98835bb3c181d7ae1821}{setuwep}((\textcolor{keyword}{struct} obj *)0);
682         freeinv(obj);
683         potionhit(mon, obj, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
684         \textcolor{keywordflow}{if} (mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} <= 0) \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};    \textcolor{comment}{/* killed */}
685         hittxt = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
686         \textcolor{comment}{/* in case potion effect causes transformation */}
687         mdat = mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data};
688         tmp = (mdat == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_SHADE]) ? 0 : 1;
689         \} \textcolor{keywordflow}{else} \{
690         \textcolor{keywordflow}{if} (mdat == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_SHADE] && !\hyperlink{uhitm_8c_acd4cf489934613a8161f8a797b09c1a9}{shade\_aware}(obj)) \{
691             tmp = 0;
692             \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(unconventional, cxname(obj));
693         \} \textcolor{keywordflow}{else} \{
694             \textcolor{keywordflow}{switch}(obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp}) \{
695             \textcolor{keywordflow}{case} BOULDER:       \textcolor{comment}{/* 1d20 */}
696             \textcolor{keywordflow}{case} HEAVY\_IRON\_BALL:   \textcolor{comment}{/* 1d25 */}
697             \textcolor{keywordflow}{case} IRON\_CHAIN:        \textcolor{comment}{/* 1d4+1 */}
698             tmp = dmgval(obj, mon);
699             \textcolor{keywordflow}{break};
700             \textcolor{keywordflow}{case} MIRROR:
701             \textcolor{keywordflow}{if} (\hyperlink{dothrow_8c_ace740cf113a1ab7d0370990900d94e03}{breaktest}(obj)) \{
702                 You(\textcolor{stringliteral}{"break %s mirror.  That's bad luck!"},
703                 shk\_your(yourbuf, obj));
704                 change\_luck(-2);
705                 useup(obj);
706                 obj = (\textcolor{keyword}{struct }obj *) 0;
707                 unarmed = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};   \textcolor{comment}{/* avoid obj==0 confusion */}
708                 get\_dmg\_bonus = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
709                 hittxt = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
710             \}
711             tmp = 1;
712             \textcolor{keywordflow}{break};
713 \textcolor{preprocessor}{#ifdef TOURIST}
714             \textcolor{keywordflow}{case} EXPENSIVE\_CAMERA:
715             You(\textcolor{stringliteral}{"succeed in destroying %s camera.  Congratulations!"},
716                     shk\_your(yourbuf, obj));
717             useup(obj);
718             \textcolor{keywordflow}{return}(\hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
719             \textcolor{comment}{/*NOTREACHED*/}
720             \textcolor{keywordflow}{break};
721 \textcolor{preprocessor}{#endif}
722             \textcolor{keywordflow}{case} CORPSE:        \textcolor{comment}{/* fixed by polder@cs.vu.nl */}
723             \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_ad1e85e493d27cdfdbe94c43710c4b191}{touch\_petrifies}(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[obj->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm}])) \{
724                 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{char} withwhat[] = \textcolor{stringliteral}{"corpse"};
725                 tmp = 1;
726                 hittxt = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
727                 You(\textcolor{stringliteral}{"hit %s with %s %s."}, mon\_nam(mon),
728                 obj->dknown ? the(\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[obj->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm}].\hyperlink{structpermonst_ae92da7d141243d7e37d4a12340bb248f}{mname}) :
729                 an(\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[obj->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm}].\hyperlink{structpermonst_ae92da7d141243d7e37d4a12340bb248f}{mname}),
730                 (obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} > 1) ? makeplural(withwhat) : withwhat);
731                 \textcolor{keywordflow}{if} (!\hyperlink{muse_8c_a82ac795f5c2a0bc7574b746291a9139e}{munstone}(mon, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}))
732                 minstapetrify(mon, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
733                 \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a372753958b3b36d2edd0add67aa6fc75}{resists\_ston}(mon)) \textcolor{keywordflow}{break};
734                 \textcolor{comment}{/* note: hp may be <= 0 even if munstoned==TRUE */}
735                 \textcolor{keywordflow}{return} (\textcolor{keywordtype}{boolean}) (mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} > 0);
736 \textcolor{preprocessor}{#if 0}
737             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_ad1e85e493d27cdfdbe94c43710c4b191}{touch\_petrifies}(mdat)) \{
738                 \textcolor{comment}{/* maybe turn the corpse into a statue? */}
739 \textcolor{preprocessor}{#endif}
740             \}
741             tmp = (obj->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm} >= \hyperlink{permonst_8h_aedc8e4764f8cf4d681f6f6226eeaa6af}{LOW\_PM} ?
742                     \hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[obj->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm}].\hyperlink{structpermonst_a29f8d76dae8c7c96eab01dd8ec27717b}{msize} : 0) + 1;
743             \textcolor{keywordflow}{break};
744             \textcolor{keywordflow}{case} EGG:
745               \{
746 \textcolor{preprocessor}{#define useup\_eggs(o)   \{ if (thrown) obfree(o,(struct obj *)0); \(\backslash\)}
747 \textcolor{preprocessor}{              else useupall(o); \(\backslash\)}
748 \textcolor{preprocessor}{              o = (struct obj *)0; \}    }\textcolor{comment}{/* now gone */}\textcolor{preprocessor}{}
749             \textcolor{keywordtype}{long} cnt = obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan};
750 
751             tmp = 1;        \textcolor{comment}{/* nominal physical damage */}
752             get\_dmg\_bonus = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
753             hittxt = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};      \textcolor{comment}{/* message always given */}
754             \textcolor{comment}{/* egg is always either used up or transformed, so next}
755 \textcolor{comment}{               hand-to-hand attack should yield a "bashing" mesg */}
756             \textcolor{keywordflow}{if} (obj == \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}) \hyperlink{decl_8h_abc99d0f4cd19504d514e134524947a9e}{unweapon} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
757             \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a14fc8dc59e9073bfbf1e170875a98448}{spe} && obj->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm} >= \hyperlink{permonst_8h_aedc8e4764f8cf4d681f6f6226eeaa6af}{LOW\_PM}) \{
758                 \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} < 5)
759                 change\_luck((\hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar}) -(obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan}));
760                 \textcolor{keywordflow}{else}
761                 change\_luck(-5);
762             \}
763 
764             \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_ad1e85e493d27cdfdbe94c43710c4b191}{touch\_petrifies}(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[obj->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm}])) \{
765                 \textcolor{comment}{/*learn\_egg\_type(obj->corpsenm);*/}
766                 pline(\textcolor{stringliteral}{"Splat! You hit %s with %s %s egg%s!"},
767                 mon\_nam(mon),
768                 obj->known ? \textcolor{stringliteral}{"the"} : cnt > 1L ? \textcolor{stringliteral}{"some"} : \textcolor{stringliteral}{"a"},
769                 obj->known ? \hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[obj->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm}].\hyperlink{structpermonst_ae92da7d141243d7e37d4a12340bb248f}{mname} : \textcolor{stringliteral}{"petrifying"},
770                 \hyperlink{hack_8h_a6ed0ab51b12ebf31e060e3dd26394db0}{plur}(cnt));
771                 obj->known = 1; \textcolor{comment}{/* (not much point...) */}
772                 \hyperlink{uhitm_8c_a823c59fec9a6bf95417f316132d628bc}{useup\_eggs}(obj);
773                 \textcolor{keywordflow}{if} (!\hyperlink{muse_8c_a82ac795f5c2a0bc7574b746291a9139e}{munstone}(mon, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}))
774                 minstapetrify(mon, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
775                 \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a372753958b3b36d2edd0add67aa6fc75}{resists\_ston}(mon)) \textcolor{keywordflow}{break};
776                 \textcolor{keywordflow}{return} (\textcolor{keywordtype}{boolean}) (mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} > 0);
777             \} \textcolor{keywordflow}{else} \{    \textcolor{comment}{/* ordinary egg(s) */}
778                 \textcolor{keyword}{const} \textcolor{keywordtype}{char} *eggp =
779                      (obj->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm} != \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM} && obj->known) ?
780                           the(\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[obj->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm}].\hyperlink{structpermonst_ae92da7d141243d7e37d4a12340bb248f}{mname}) :
781                           (cnt > 1L) ? \textcolor{stringliteral}{"some"} : \textcolor{stringliteral}{"an"};
782                 You(\textcolor{stringliteral}{"hit %s with %s egg%s."},
783                 mon\_nam(mon), eggp, \hyperlink{hack_8h_a6ed0ab51b12ebf31e060e3dd26394db0}{plur}(cnt));
784                 \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_ad1e85e493d27cdfdbe94c43710c4b191}{touch\_petrifies}(mdat) && !\hyperlink{obj_8h_aa960c14bde9549163592a6d8a2472499}{stale\_egg}(obj)) \{
785                 pline\_The(\textcolor{stringliteral}{"egg%s %s alive any more..."},
786                       \hyperlink{hack_8h_a6ed0ab51b12ebf31e060e3dd26394db0}{plur}(cnt),
787                       (cnt == 1L) ? \textcolor{stringliteral}{"isn't"} : \textcolor{stringliteral}{"aren't"});
788                 \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a1606b78f4b7e85536033e77348551f5f}{timed}) obj\_stop\_timers(obj);
789                 obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} = \hyperlink{objects_8c_ac1b5af7f6cac1028cbf4a80a05496eea}{ROCK};
790                 obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} = \hyperlink{objclass_8h_afc09c51ea922e9928f86a51177244796}{GEM\_CLASS};
791                 obj->\hyperlink{structobj_af03ce8a6a0ca51e8d8954fb1a1a31fbe}{oartifact} = 0;
792                 obj->\hyperlink{structobj_a14fc8dc59e9073bfbf1e170875a98448}{spe} = 0;
793                 obj->known = obj->dknown = obj->bknown = 0;
794                 obj->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt} = weight(obj);
795                 \textcolor{keywordflow}{if} (thrown) place\_object(obj, mon->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx}, mon->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my});
796                 \} \textcolor{keywordflow}{else} \{
797                 pline(\textcolor{stringliteral}{"Splat!"});
798                 \hyperlink{uhitm_8c_a823c59fec9a6bf95417f316132d628bc}{useup\_eggs}(obj);
799                 exercise(\hyperlink{attrib_8h_a4206d6431732a698ede8a237d5c17142}{A\_WIS}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
800                 \}
801             \}
802             \textcolor{keywordflow}{break};
803 \textcolor{preprocessor}{#undef useup\_eggs}
804               \}
805             \textcolor{keywordflow}{case} CLOVE\_OF\_GARLIC:   \textcolor{comment}{/* no effect against demons */}
806             \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a8e10c42bf31c42d748765a29105842fc}{is\_undead}(mdat)) \{
807                 monflee(mon, d(2, 4), \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
808             \}
809             tmp = 1;
810             \textcolor{keywordflow}{break};
811             \textcolor{keywordflow}{case} CREAM\_PIE:
812             \textcolor{keywordflow}{case} BLINDING\_VENOM:
813             mon->msleeping = 0;
814             \textcolor{keywordflow}{if} (can\_blnd(&\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}, mon, (\hyperlink{config_8h_a65f85814a8290f9797005d3b28e7e5fc}{uchar})
815                     (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == BLINDING\_VENOM
816                      ? \hyperlink{monattk_8h_a6792e3b455e9139c121261397dcf7422}{AT\_SPIT} : \hyperlink{monattk_8h_a6db6784344c2424d385f6b460f0c029f}{AT\_WEAP}), obj)) \{
817                 \textcolor{keywordflow}{if} (\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind}) \{
818                 pline(obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == CREAM\_PIE ?
819                       \textcolor{stringliteral}{"Splat!"} : \textcolor{stringliteral}{"Splash!"});
820                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == BLINDING\_VENOM) \{
821                 pline\_The(\textcolor{stringliteral}{"venom blinds %s%s!"}, mon\_nam(mon),
822                       mon->mcansee ? \textcolor{stringliteral}{""} : \textcolor{stringliteral}{" further"});
823                 \} \textcolor{keywordflow}{else} \{
824                 \textcolor{keywordtype}{char} *whom = mon\_nam(mon);
825                 \textcolor{keywordtype}{char} *\hyperlink{detect_8c_a951a98f1e2d69ca61adcd53c0f8faca3}{what} = The(xname(obj));
826                 \textcolor{keywordflow}{if} (!thrown && obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} > 1)
827                     what = An(singular(obj, xname));
828                 \textcolor{comment}{/* note: s\_suffix returns a modifiable buffer */}
829                 \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_acef071254b9ae0dcf53724485be10841}{haseyes}(mdat)
830                     && mdat != &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_FLOATING\_EYE])
831                     whom = strcat(strcat(s\_suffix(whom), \textcolor{stringliteral}{" "}),
832                           mbodypart(mon, \hyperlink{hack_8h_a8cec063149d793579c0e9d0b992b9fd0}{FACE}));
833                 pline(\textcolor{stringliteral}{"%s %s over %s!"},
834                       what, vtense(what, \textcolor{stringliteral}{"splash"}), whom);
835                 \}
836                 setmangry(mon);
837                 mon->mcansee = 0;
838                 tmp = \hyperlink{hack_8h_af107ca092682647f298989038020f9c8}{rn1}(25, 21);
839                 \textcolor{keywordflow}{if}(((\textcolor{keywordtype}{int}) mon->mblinded + tmp) > 127)
840                 mon->mblinded = 127;
841                 \textcolor{keywordflow}{else} mon->mblinded += tmp;
842             \} \textcolor{keywordflow}{else} \{
843                 pline(obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp}==CREAM\_PIE ? \textcolor{stringliteral}{"Splat!"} : \textcolor{stringliteral}{"Splash!"});
844                 setmangry(mon);
845             \}
846             \textcolor{keywordflow}{if} (thrown) obfree(obj, (\textcolor{keyword}{struct} obj *)0);
847             \textcolor{keywordflow}{else} useup(obj);
848             hittxt = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
849             get\_dmg\_bonus = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
850             tmp = 0;
851             \textcolor{keywordflow}{break};
852             \textcolor{keywordflow}{case} ACID\_VENOM: \textcolor{comment}{/* thrown (or spit) */}
853             \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a67859b0b3aa8e4ac0d74a818013cb507}{resists\_acid}(mon)) \{
854                 Your(\textcolor{stringliteral}{"venom hits %s harmlessly."},
855                     mon\_nam(mon));
856                 tmp = 0;
857             \} \textcolor{keywordflow}{else} \{
858                 Your(\textcolor{stringliteral}{"venom burns %s!"}, mon\_nam(mon));
859                 tmp = dmgval(obj, mon);
860             \}
861             \textcolor{keywordflow}{if} (thrown) obfree(obj, (\textcolor{keyword}{struct} obj *)0);
862             \textcolor{keywordflow}{else} useup(obj);
863             hittxt = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
864             get\_dmg\_bonus = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
865             \textcolor{keywordflow}{break};
866             \textcolor{keywordflow}{default}:
867             \textcolor{comment}{/* non-weapons can damage because of their weight */}
868             \textcolor{comment}{/* (but not too much) */}
869             tmp = obj->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt}/100;
870             \textcolor{keywordflow}{if}(tmp < 1) tmp = 1;
871             \textcolor{keywordflow}{else} tmp = rnd(tmp);
872             \textcolor{keywordflow}{if}(tmp > 6) tmp = 6;
873             \textcolor{comment}{/*}
874 \textcolor{comment}{             * Things like silver wands can arrive here so}
875 \textcolor{comment}{             * so we need another silver check.}
876 \textcolor{comment}{             */}
877             \textcolor{keywordflow}{if} (\hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp}].oc\_material == \hyperlink{objclass_8h_a7e76a14a479114a4b9b20782bb00e69a}{SILVER}
878                         && hates\_silver(mdat)) \{
879                 tmp += rnd(20);
880                 silvermsg = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}; silverobj = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
881             \}
882             \}
883         \}
884         \}
885     \}
886 
887     \textcolor{comment}{/****** NOTE: perhaps obj is undefined!! (if !thrown && BOOMERANG)}
888 \textcolor{comment}{     *      *OR* if attacking bare-handed!! */}
889 
890     \textcolor{keywordflow}{if} (get\_dmg\_bonus && tmp > 0) \{
891         tmp += \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ae7c0602a1e4514ff0f22039746957799}{udaminc};
892         \textcolor{comment}{/* If you throw using a propellor, you don't get a strength}
893 \textcolor{comment}{         * bonus but you do get an increase-damage bonus.}
894 \textcolor{comment}{         */}
895         \textcolor{keywordflow}{if}(!thrown || !obj || !\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} || !\hyperlink{obj_8h_a766dc63537673239906c55a19f384b1d}{ammo\_and\_launcher}(obj, 
      \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}))
896             tmp += dbon();
897     \}
898 
899     \textcolor{keywordflow}{if} (valid\_weapon\_attack) \{
900         \textcolor{keyword}{struct }obj *wep;
901 
902         \textcolor{comment}{/* to be valid a projectile must have had the correct projector */}
903         wep = \hyperlink{uhitm_8c_ade7c6c1f9ae8773e71eaf21c459e1ad3}{PROJECTILE}(obj) ? \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} : obj;
904         tmp += weapon\_dam\_bonus(wep);
905         \textcolor{comment}{/* [this assumes that `!thrown' implies wielded...] */}
906         wtype = thrown ? weapon\_type(wep) : uwep\_skill\_type();
907         use\_skill(wtype, 1);
908     \}
909 
910     \textcolor{keywordflow}{if} (ispoisoned) \{
911         \textcolor{keywordtype}{int} nopoison = (10 - (obj->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt}/10));            
912         \textcolor{keywordflow}{if}(nopoison < 2) nopoison = 2;
913         \textcolor{keywordflow}{if} \hyperlink{you_8h_a6087f5b8605964c19078b777da740258}{Role\_if}(PM\_SAMURAI) \{
914         You(\textcolor{stringliteral}{"dishonorably use a poisoned weapon!"});
915         adjalign(-sgn(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a3f202dd89a837a9772a9eb1f1965f30c}{ualign}.\hyperlink{structalign_a0dadfa91b9ff06447f91ea8a2b898827}{type}));
916         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a3f202dd89a837a9772a9eb1f1965f30c}{ualign}.\hyperlink{structalign_a0dadfa91b9ff06447f91ea8a2b898827}{type} == \hyperlink{align_8h_aa21537fe5fcc5cd77de27bc6907ecc6a}{A\_LAWFUL}) && (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a3f202dd89a837a9772a9eb1f1965f30c}{ualign}.
      \hyperlink{structalign_ab3a768425270c33f059e3ead817e4e83}{record} > -10)) \{
917         You\_feel(\textcolor{stringliteral}{"like an evil coward for using a poisoned weapon."});
918         adjalign(-1);
919         \}
920         \textcolor{keywordflow}{if} (obj && !rn2(nopoison)) \{
921         obj->opoisoned = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
922         Your(\textcolor{stringliteral}{"%s %s no longer poisoned."}, xname(obj),
923              otense(obj, \textcolor{stringliteral}{"are"}));
924         \}
925         \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a419ec031ff4b2508bcd1304366f93ce2}{resists\_poison}(mon))
926         needpoismsg = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
927         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rn2(10))
928         tmp += rnd(6);
929         \textcolor{keywordflow}{else} poiskilled = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
930     \}
931     \textcolor{keywordflow}{if} (tmp < 1) \{
932         \textcolor{comment}{/* make sure that negative damage adjustment can't result}
933 \textcolor{comment}{           in inadvertently boosting the victim's hit points */}
934         tmp = 0;
935         \textcolor{keywordflow}{if} (mdat == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_SHADE]) \{
936         \textcolor{keywordflow}{if} (!hittxt) \{
937             \textcolor{keyword}{const} \textcolor{keywordtype}{char} *what = unconventional[0] ? unconventional : \textcolor{stringliteral}{"attack"};
938             Your(\textcolor{stringliteral}{"%s %s harmlessly through %s."},
939                 what, vtense(what, \textcolor{stringliteral}{"pass"}),
940             mon\_nam(mon));
941             hittxt = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
942         \}
943         \} \textcolor{keywordflow}{else} \{
944         \textcolor{keywordflow}{if} (get\_dmg\_bonus) tmp = 1;
945         \}
946     \}
947 
948 \textcolor{preprocessor}{#ifdef STEED}
949     \textcolor{keywordflow}{if} (jousting) \{
950         tmp += d(2, (obj == \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}) ? 10 : 2);    \textcolor{comment}{/* [was in dmgval()] */}
951         You(\textcolor{stringliteral}{"joust %s%s"},
952              mon\_nam(mon), \hyperlink{display_8h_ad75e04a9624fe7ba0e1715ae3a3feb27}{canseemon}(mon) ? exclam(tmp) : \textcolor{stringliteral}{"."});
953         \textcolor{keywordflow}{if} (jousting < 0) \{
954         Your(\textcolor{stringliteral}{"%s shatters on impact!"}, xname(obj));
955         \textcolor{comment}{/* (must be either primary or secondary weapon to get here) */}
956         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ade2cee6956bba775aa796bba6ae857ec}{twoweap} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}; \textcolor{comment}{/* untwoweapon() is too verbose here */}
957         \textcolor{keywordflow}{if} (obj == \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}) \hyperlink{wield_8c_acfe25ed4d9db889cb4bc70a9c5ab9c4d}{uwepgone}();        \textcolor{comment}{/* set unweapon */}
958         \textcolor{comment}{/* minor side-effect: broken lance won't split puddings */}
959         useup(obj);
960         obj = 0;
961         \}
962         \textcolor{comment}{/* avoid migrating a dead monster */}
963         \textcolor{keywordflow}{if} (mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} > tmp) \{
964         \hyperlink{dothrow_8c_a10dae152f3b0975ef98ec3739172886e}{mhurtle}(mon, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a0b53da9e296cbebbc3dc2fc6ade21aeb}{dx}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a80d068cfe5c15ae06e6f152be40a716f}{dy}, 1);
965         mdat = mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}; \textcolor{comment}{/* in case of a polymorph trap */}
966         \textcolor{keywordflow}{if} (\hyperlink{monst_8h_a87ebcb12436dc12747fed36e83561249}{DEADMONSTER}(mon)) already\_killed = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
967         \}
968         hittxt = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
969     \} \textcolor{keywordflow}{else}
970 \textcolor{preprocessor}{#endif}
971 
972     \textcolor{comment}{/* VERY small chance of stunning opponent if unarmed. */}
973     \textcolor{keywordflow}{if} (unarmed && tmp > 1 && !thrown && !obj && !\hyperlink{you_8h_ab869582031082f2c352b374dc0e0c3b3}{Upolyd}) \{
974         \textcolor{keywordflow}{if} (rnd(100) < \hyperlink{skills_8h_a778eff14f7209290967e1627b0b737ea}{P\_SKILL}(\hyperlink{skills_8h_a382509ba0e919af17888be3475bb94f3}{P\_BARE\_HANDED\_COMBAT}) &&
975             !\hyperlink{mondata_8h_a28750a402487965f08dcce597c8af6be}{bigmonst}(mdat) && !\hyperlink{mondata_8h_a8d3b0784e67294ee9fae355fb1dcf8d3}{thick\_skinned}(mdat)) \{
976         \textcolor{keywordflow}{if} (\hyperlink{display_8h_a13f0a7cac1ceb73885a59b8598de1648}{canspotmon}(mon))
977             pline(\textcolor{stringliteral}{"%s %s from your powerful strike!"}, Monnam(mon),
978               makeplural(stagger(mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}, \textcolor{stringliteral}{"stagger"})));
979         \textcolor{comment}{/* avoid migrating a dead monster */}
980         \textcolor{keywordflow}{if} (mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} > tmp) \{
981             \hyperlink{dothrow_8c_a10dae152f3b0975ef98ec3739172886e}{mhurtle}(mon, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a0b53da9e296cbebbc3dc2fc6ade21aeb}{dx}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a80d068cfe5c15ae06e6f152be40a716f}{dy}, 1);
982             mdat = mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}; \textcolor{comment}{/* in case of a polymorph trap */}
983             \textcolor{keywordflow}{if} (\hyperlink{monst_8h_a87ebcb12436dc12747fed36e83561249}{DEADMONSTER}(mon)) already\_killed = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
984         \}
985         hittxt = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
986         \}
987     \}
988 
989     \textcolor{keywordflow}{if} (!already\_killed) mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} -= tmp;
990     \textcolor{comment}{/* adjustments might have made tmp become less than what}
991 \textcolor{comment}{       a level draining artifact has already done to max HP */}
992     \textcolor{keywordflow}{if} (mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} > mon->\hyperlink{structmonst_a66c107319bb7bb318c04e6a0f5f03c60}{mhpmax}) mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} = mon->\hyperlink{structmonst_a66c107319bb7bb318c04e6a0f5f03c60}{mhpmax};
993     \textcolor{keywordflow}{if} (mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} < 1)
994         destroyed = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
995     \textcolor{keywordflow}{if} (mon->\hyperlink{structmonst_a6d525ec48f9d38cda6accbb0cb39efba}{mtame} && (!mon->mflee || mon->mfleetim) && tmp > 0) \{
996         abuse\_dog(mon);
997         monflee(mon, 10 * rnd(tmp), \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
998     \}
999     \textcolor{keywordflow}{if}((mdat == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_BLACK\_PUDDING] || mdat == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_BROWN\_PUDDING])
1000            && obj && obj == \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}
1001            && \hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp}].oc\_material == \hyperlink{objclass_8h_a3c344bd0876915ca614f68b06d878c44}{IRON}
1002            && mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} > 1 && !thrown && !mon->mcan
1003            \textcolor{comment}{/* && !destroyed  -- guaranteed by mhp > 1 */} ) \{
1004         \textcolor{keywordflow}{if} (clone\_mon(mon, 0, 0)) \{
1005             pline(\textcolor{stringliteral}{"%s divides as you hit it!"}, Monnam(mon));
1006             hittxt = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1007         \}
1008     \}
1009 
1010     \textcolor{keywordflow}{if} (!hittxt &&          \textcolor{comment}{/*( thrown => obj exists )*/}
1011       (!destroyed || (thrown && \hyperlink{decl_8h_a7f81da35e8b9f1f4bfd6c2e3255eba9a}{m\_shot}.\hyperlink{structmultishot_a62215723667a2eb09dd1203380b62f21}{n} > 1 && \hyperlink{decl_8h_a7f81da35e8b9f1f4bfd6c2e3255eba9a}{m\_shot}.\hyperlink{structmultishot_addd43be0e56011781a690bb29031f58e}{o} == obj->
      \hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp}))) \{
1012         \textcolor{keywordflow}{if} (thrown) hit(mshot\_xname(obj), mon, exclam(tmp));
1013         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_afd7dfe45d35356d861ab5e9834231929}{verbose}) You(\textcolor{stringliteral}{"hit it."});
1014         \textcolor{keywordflow}{else} You(\textcolor{stringliteral}{"%s %s%s"}, \hyperlink{you_8h_a6087f5b8605964c19078b777da740258}{Role\_if}(PM\_BARBARIAN) ? \textcolor{stringliteral}{"smite"} : \textcolor{stringliteral}{"hit"},
1015              mon\_nam(mon), \hyperlink{display_8h_ad75e04a9624fe7ba0e1715ae3a3feb27}{canseemon}(mon) ? exclam(tmp) : \textcolor{stringliteral}{"."});
1016     \}
1017 
1018     \textcolor{keywordflow}{if} (silvermsg) \{
1019         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *fmt;
1020         \textcolor{keywordtype}{char} *whom = mon\_nam(mon);
1021         \textcolor{keywordtype}{char} silverobjbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
1022 
1023         \textcolor{keywordflow}{if} (\hyperlink{display_8h_a13f0a7cac1ceb73885a59b8598de1648}{canspotmon}(mon)) \{
1024             \textcolor{keywordflow}{if} (barehand\_silver\_rings == 1)
1025             fmt = \textcolor{stringliteral}{"Your silver ring sears %s!"};
1026             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (barehand\_silver\_rings == 2)
1027             fmt = \textcolor{stringliteral}{"Your silver rings sear %s!"};
1028             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (silverobj && saved\_oname[0]) \{
1029                 \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(silverobjbuf, \textcolor{stringliteral}{"Your %s%s %s %%s!"},
1030                     strstri(saved\_oname, \textcolor{stringliteral}{"silver"}) ?
1031                     \textcolor{stringliteral}{""} : \textcolor{stringliteral}{"silver "},
1032                 saved\_oname, vtense(saved\_oname, \textcolor{stringliteral}{"sear"}));
1033                 fmt = silverobjbuf;
1034             \} \textcolor{keywordflow}{else}
1035             fmt = \textcolor{stringliteral}{"The silver sears %s!"};
1036         \} \textcolor{keywordflow}{else} \{
1037             *whom = highc(*whom);   \textcolor{comment}{/* "it" -> "It" */}
1038             fmt = \textcolor{stringliteral}{"%s is seared!"};
1039         \}
1040         \textcolor{comment}{/* note: s\_suffix returns a modifiable buffer */}
1041         \textcolor{keywordflow}{if} (!\hyperlink{mondata_8h_a8ef85e65e7dda38e65d7e3801cde6d2e}{noncorporeal}(mdat))
1042             whom = strcat(s\_suffix(whom), \textcolor{stringliteral}{" flesh"});
1043         pline(fmt, whom);
1044     \}
1045 
1046     \textcolor{keywordflow}{if} (needpoismsg)
1047         pline\_The(\textcolor{stringliteral}{"poison doesn't seem to affect %s."}, mon\_nam(mon));
1048     \textcolor{keywordflow}{if} (poiskilled) \{
1049         pline\_The(\textcolor{stringliteral}{"poison was deadly..."});
1050         \textcolor{keywordflow}{if} (!already\_killed) xkilled(mon, 0);
1051         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1052     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (destroyed) \{
1053         \textcolor{keywordflow}{if} (!already\_killed)
1054             killed(mon);    \textcolor{comment}{/* takes care of most messages */}
1055     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ae6400919d6031ac41b98d31ce9906308}{umconf} && !thrown) \{
1056         \hyperlink{uhitm_8c_a193cbe8cfeaa05ef43a9440da9a8fa5e}{nohandglow}(mon);
1057         \textcolor{keywordflow}{if} (!mon->mconf && !resist(mon, \hyperlink{objclass_8h_aba5935524b39b0fdd148a3d466a5c580}{SPBOOK\_CLASS}, 0, \hyperlink{hack_8h_a7450be636c853f464d4b5c77a6b19844}{NOTELL})) \{
1058             mon->mconf = 1;
1059             \textcolor{keywordflow}{if} (!mon->mstun && mon->mcanmove && !mon->msleeping &&
1060                 \hyperlink{display_8h_ad75e04a9624fe7ba0e1715ae3a3feb27}{canseemon}(mon))
1061                 pline(\textcolor{stringliteral}{"%s appears confused."}, Monnam(mon));
1062         \}
1063     \}
1064 
1065     \textcolor{keywordflow}{return}((\textcolor{keywordtype}{boolean})(destroyed ? \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE} : \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}));
1066 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a62c1aa5da793b72c6de8bac7688a7365}{\index{uhitm.\+c@{uhitm.\+c}!hmonas@{hmonas}}
\index{hmonas@{hmonas}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{hmonas}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} hmonas (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mon, }
\item[{int}]{tmp}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a62c1aa5da793b72c6de8bac7688a7365}


Definition at line 1932 of file uhitm.\+c.



References attack\+::aatyp, A\+D\+\_\+\+P\+H\+Y\+S, A\+D\+\_\+\+S\+P\+E\+L, attack\+::adtyp, A\+T\+\_\+\+B\+I\+T\+E, A\+T\+\_\+\+B\+O\+O\+M, A\+T\+\_\+\+B\+R\+E\+A, A\+T\+\_\+\+B\+U\+T\+T, A\+T\+\_\+\+C\+L\+A\+W, A\+T\+\_\+\+E\+N\+G\+L, A\+T\+\_\+\+E\+X\+P\+L, A\+T\+\_\+\+G\+A\+Z\+E, A\+T\+\_\+\+H\+U\+G\+S, A\+T\+\_\+\+K\+I\+C\+K, A\+T\+\_\+\+M\+A\+G\+C, A\+T\+\_\+\+N\+O\+N\+E, A\+T\+\_\+\+S\+P\+I\+T, A\+T\+\_\+\+S\+T\+N\+G, A\+T\+\_\+\+T\+E\+N\+T, A\+T\+\_\+\+T\+U\+C\+H, A\+T\+\_\+\+W\+E\+A\+P, cantwield, damageum(), monst\+::data, you\+::dx, you\+::dy, explum(), gulpum(), haseyes, known\+\_\+hitum(), m\+\_\+at, you\+::mh, missum(), permonst\+::mlet, mons, multi, N\+A\+T\+T\+K, passive(), S\+\_\+\+G\+N\+O\+M\+E, S\+\_\+\+K\+O\+B\+O\+L\+D, S\+\_\+\+L\+I\+C\+H, S\+\_\+\+M\+U\+M\+M\+Y, S\+\_\+\+O\+R\+C, S\+\_\+\+Z\+O\+M\+B\+I\+E, Sick, Sick\+\_\+resistance, u, uarmf, you\+::umonnum, Upolyd, you\+::ustuck, uwep, you\+::ux, you\+::uy, and youmonst.



Referenced by attack().


\begin{DoxyCode}
1935 \{
1936     \textcolor{keyword}{struct }\hyperlink{structattack}{attack} *mattk, alt\_attk;
1937     \textcolor{keywordtype}{int} i, sum[\hyperlink{permonst_8h_af9119a416b08e0f343f33a0a7a945e93}{NATTK}], hittmp = 0;
1938     \textcolor{keywordtype}{int} nsum = 0;
1939     \textcolor{keywordtype}{int} dhit = 0;
1940 
1941     \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{permonst_8h_af9119a416b08e0f343f33a0a7a945e93}{NATTK}; i++) \{
1942 
1943         sum[i] = 0;
1944         mattk = getmattk(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}, i, sum, &alt\_attk);
1945         \textcolor{keywordflow}{switch}(mattk->\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp}) \{
1946         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a6db6784344c2424d385f6b460f0c029f}{AT\_WEAP}:
1947 use\_weapon:
1948     \textcolor{comment}{/* Certain monsters don't use weapons when encountered as enemies,}
1949 \textcolor{comment}{     * but players who polymorph into them have hands or claws and thus}
1950 \textcolor{comment}{     * should be able to use weapons.  This shouldn't prohibit the use}
1951 \textcolor{comment}{     * of most special abilities, either.}
1952 \textcolor{comment}{     */}
1953     \textcolor{comment}{/* Potential problem: if the monster gets multiple weapon attacks,}
1954 \textcolor{comment}{     * we currently allow the player to get each of these as a weapon}
1955 \textcolor{comment}{     * attack.  Is this really desirable?}
1956 \textcolor{comment}{     */}
1957             \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}) \{
1958                 hittmp = hitval(\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}, mon);
1959                 hittmp += weapon\_hit\_bonus(\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep});
1960                 tmp += hittmp;
1961             \}
1962             dhit = (tmp > (\hyperlink{uhitm_8c_ac2d2b71a2fe853fe47029a09aed9aca0}{dieroll} = rnd(20)) || \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uswallow);
1963             \textcolor{comment}{/* KMH -- Don't accumulate to-hit bonuses */}
1964             \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}) tmp -= hittmp;
1965             \textcolor{comment}{/* Enemy dead, before any special abilities used */}
1966             \textcolor{keywordflow}{if} (!\hyperlink{uhitm_8c_a584798493588e0c419478797a914e2e2}{known\_hitum}(mon,&dhit,mattk)) \{
1967                 sum[i] = 2;
1968                 \textcolor{keywordflow}{break};
1969             \} \textcolor{keywordflow}{else} sum[i] = dhit;
1970             \textcolor{comment}{/* might be a worm that gets cut in half */}
1971             \textcolor{keywordflow}{if} (\hyperlink{rm_8h_a4d8dddf3df3fad65478980d2c8cbf53c}{m\_at}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a0b53da9e296cbebbc3dc2fc6ade21aeb}{dx}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a80d068cfe5c15ae06e6f152be40a716f}{dy}) != mon) \textcolor{keywordflow}{return}((\textcolor{keywordtype}{boolean})(nsum != 0));
1972             \textcolor{comment}{/* Do not print "You hit" message, since known\_hitum}
1973 \textcolor{comment}{             * already did it.}
1974 \textcolor{comment}{             */}
1975             \textcolor{keywordflow}{if} (dhit && mattk->\hyperlink{structattack_a14286742d9dc1310f5c4852432264080}{adtyp} != \hyperlink{monattk_8h_a5bf56649aa346d27c5e5748791f7d65c}{AD\_SPEL}
1976                 && mattk->\hyperlink{structattack_a14286742d9dc1310f5c4852432264080}{adtyp} != \hyperlink{monattk_8h_a9191d6bf636e5ada34fa9169ecaa4d9a}{AD\_PHYS})
1977                 sum[i] = \hyperlink{uhitm_8c_a7e41ad4604083ffd2e383d9cde262df9}{damageum}(mon,mattk);
1978             \textcolor{keywordflow}{break};
1979         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_acb01686ab7b5bde2514f32fe5cc19fa5}{AT\_CLAW}:
1980             \textcolor{keywordflow}{if} (i==0 && \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} && !\hyperlink{mondata_8h_affb79b25deabc9564b20a275b5ac7e5f}{cantwield}(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})) \textcolor{keywordflow}{goto} use\_weapon;
1981 \textcolor{preprocessor}{#ifdef SEDUCE}
1982             \textcolor{comment}{/* succubi/incubi are humanoid, but their \_second\_}
1983 \textcolor{comment}{             * attack is AT\_CLAW, not their first...}
1984 \textcolor{comment}{             */}
1985             \textcolor{keywordflow}{if} (i==1 && \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} && (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ae0b7ade89d09cd3b6d5e05eb8c859b35}{umonnum} == PM\_SUCCUBUS ||
1986                 \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ae0b7ade89d09cd3b6d5e05eb8c859b35}{umonnum} == PM\_INCUBUS)) \textcolor{keywordflow}{goto} use\_weapon;
1987 \textcolor{preprocessor}{#endif}
1988         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a0f086b24239ee3c9b8cce9edf3507323}{AT\_KICK}:
1989         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a23719123709e3174f160784fd3b3d679}{AT\_BITE}:
1990         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a0aa5abc1176b259b9f99f34c190255e1}{AT\_STNG}:
1991         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a54d39da7ea09917045c00898714803f4}{AT\_TUCH}:
1992         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a3920c85a3766d32754a057931a6db631}{AT\_BUTT}:
1993         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_ace93bb777ac6aa1863b4498efc2b20ea}{AT\_TENT}:
1994             \textcolor{keywordflow}{if} (i==0 && \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} && (\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ab402dbf1bed9d0e595a2b3da6558da92}{mlet}==\hyperlink{monsym_8h_ae5085838a60dca2e0c3fc8242fa659a7}{S\_LICH})) \textcolor{keywordflow}{goto} use\_weapon;
1995             \textcolor{keywordflow}{if} ((dhit = (tmp > rnd(20) || \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uswallow)) != 0) \{
1996                 \textcolor{keywordtype}{int} compat;
1997 
1998                 \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uswallow &&
1999                 (compat=could\_seduce(&\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}, mon, mattk))) \{
2000                 You(\textcolor{stringliteral}{"%s %s %s."},
2001                     mon->mcansee && \hyperlink{mondata_8h_acef071254b9ae0dcf53724485be10841}{haseyes}(mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})
2002                     ? \textcolor{stringliteral}{"smile at"} : \textcolor{stringliteral}{"talk to"},
2003                     mon\_nam(mon),
2004                     compat == 2 ? \textcolor{stringliteral}{"engagingly"}:\textcolor{stringliteral}{"seductively"});
2005                 \textcolor{comment}{/* doesn't anger it; no wakeup() */}
2006                 sum[i] = \hyperlink{uhitm_8c_a7e41ad4604083ffd2e383d9cde262df9}{damageum}(mon, mattk);
2007                 \textcolor{keywordflow}{break};
2008                 \}
2009                 wakeup(mon);
2010                 \textcolor{comment}{/* maybe this check should be in damageum()? */}
2011                 \textcolor{keywordflow}{if} (mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_SHADE] &&
2012                     !(mattk->\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp} == \hyperlink{monattk_8h_a0f086b24239ee3c9b8cce9edf3507323}{AT\_KICK} &&
2013                         \hyperlink{decl_8h_a11e2d0f62fa1b42374054c939ebb288f}{uarmf} && \hyperlink{decl_8h_a11e2d0f62fa1b42374054c939ebb288f}{uarmf}->blessed)) \{
2014                 Your(\textcolor{stringliteral}{"attack passes harmlessly through %s."},
2015                     mon\_nam(mon));
2016                 \textcolor{keywordflow}{break};
2017                 \}
2018                 \textcolor{keywordflow}{if} (mattk->\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp} == \hyperlink{monattk_8h_a0f086b24239ee3c9b8cce9edf3507323}{AT\_KICK})
2019                     You(\textcolor{stringliteral}{"kick %s."}, mon\_nam(mon));
2020                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mattk->\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp} == \hyperlink{monattk_8h_a23719123709e3174f160784fd3b3d679}{AT\_BITE})
2021                     You(\textcolor{stringliteral}{"bite %s."}, mon\_nam(mon));
2022                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mattk->\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp} == \hyperlink{monattk_8h_a0aa5abc1176b259b9f99f34c190255e1}{AT\_STNG})
2023                     You(\textcolor{stringliteral}{"sting %s."}, mon\_nam(mon));
2024                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mattk->\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp} == \hyperlink{monattk_8h_a3920c85a3766d32754a057931a6db631}{AT\_BUTT})
2025                     You(\textcolor{stringliteral}{"butt %s."}, mon\_nam(mon));
2026                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mattk->\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp} == \hyperlink{monattk_8h_a54d39da7ea09917045c00898714803f4}{AT\_TUCH})
2027                     You(\textcolor{stringliteral}{"touch %s."}, mon\_nam(mon));
2028                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mattk->\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp} == \hyperlink{monattk_8h_ace93bb777ac6aa1863b4498efc2b20ea}{AT\_TENT})
2029                     Your(\textcolor{stringliteral}{"tentacles suck %s."}, mon\_nam(mon));
2030                 \textcolor{keywordflow}{else} You(\textcolor{stringliteral}{"hit %s."}, mon\_nam(mon));
2031                 sum[i] = \hyperlink{uhitm_8c_a7e41ad4604083ffd2e383d9cde262df9}{damageum}(mon, mattk);
2032             \} \textcolor{keywordflow}{else}
2033                 \hyperlink{uhitm_8c_a2105b902082a7c3513754beaa432e7b6}{missum}(mon, mattk);
2034             \textcolor{keywordflow}{break};
2035 
2036         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a58713b39f99069e88d1a4c50f1142434}{AT\_HUGS}:
2037             \textcolor{comment}{/* automatic if prev two attacks succeed, or if}
2038 \textcolor{comment}{             * already grabbed in a previous attack}
2039 \textcolor{comment}{             */}
2040             dhit = 1;
2041             wakeup(mon);
2042             \textcolor{keywordflow}{if} (mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_SHADE])
2043                 Your(\textcolor{stringliteral}{"hug passes harmlessly through %s."},
2044                 mon\_nam(mon));
2045             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!sticks(mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) && !\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uswallow) \{
2046                 \textcolor{keywordflow}{if} (mon==\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck}) \{
2047                 pline(\textcolor{stringliteral}{"%s is being %s."}, Monnam(mon),
2048                     \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ae0b7ade89d09cd3b6d5e05eb8c859b35}{umonnum}==PM\_ROPE\_GOLEM ? \textcolor{stringliteral}{"choked"}:
2049                     \textcolor{stringliteral}{"crushed"});
2050                 sum[i] = \hyperlink{uhitm_8c_a7e41ad4604083ffd2e383d9cde262df9}{damageum}(mon, mattk);
2051                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(i >= 2 && sum[i-1] && sum[i-2]) \{
2052                 You(\textcolor{stringliteral}{"grab %s!"}, mon\_nam(mon));
2053                 \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck} = mon;
2054                 sum[i] = \hyperlink{uhitm_8c_a7e41ad4604083ffd2e383d9cde262df9}{damageum}(mon, mattk);
2055                 \}
2056             \}
2057             \textcolor{keywordflow}{break};
2058 
2059         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a35bb1695a67a7a4357e857b0ec6645aa}{AT\_EXPL}:    \textcolor{comment}{/* automatic hit if next to */}
2060             dhit = -1;
2061             wakeup(mon);
2062             sum[i] = \hyperlink{uhitm_8c_a118a7e755b7b9cf312ae6e64f8f66b76}{explum}(mon, mattk);
2063             \textcolor{keywordflow}{break};
2064 
2065         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a3c8350828a964640ea6eb30c64194932}{AT\_ENGL}:
2066             \textcolor{keywordflow}{if}((dhit = (tmp > rnd(20+i)))) \{
2067                 wakeup(mon);
2068                 \textcolor{keywordflow}{if} (mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_SHADE])
2069                     Your(\textcolor{stringliteral}{"attempt to surround %s is harmless."},
2070                     mon\_nam(mon));
2071                 \textcolor{keywordflow}{else} \{
2072                     sum[i]= \hyperlink{uhitm_8c_a913d911a86233fa27072d31fca8c5b3d}{gulpum}(mon,mattk);
2073                     \textcolor{keywordflow}{if} (sum[i] == 2 &&
2074                         (mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ab402dbf1bed9d0e595a2b3da6558da92}{mlet} == \hyperlink{monsym_8h_ab0712e0f0d926039e2a9df8cdf27aab9}{S\_ZOMBIE} ||
2075                         mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ab402dbf1bed9d0e595a2b3da6558da92}{mlet} == \hyperlink{monsym_8h_af0c3ce0cab08d748710bf38390422cdd}{S\_MUMMY}) &&
2076                         rn2(5) &&
2077                         !\hyperlink{youprop_8h_a75bcb0928cae59055018e20ecca7a49a}{Sick\_resistance}) \{
2078                     You\_feel(\textcolor{stringliteral}{"%ssick."},
2079                         (\hyperlink{youprop_8h_a43a7dcd441841e6703322b8a2ea3b6a5}{Sick}) ? \textcolor{stringliteral}{"very "} : \textcolor{stringliteral}{""});
2080                     mdamageu(mon, rnd(8));
2081                     \}
2082                 \}
2083             \} \textcolor{keywordflow}{else}
2084                 \hyperlink{uhitm_8c_a2105b902082a7c3513754beaa432e7b6}{missum}(mon, mattk);
2085             \textcolor{keywordflow}{break};
2086 
2087         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_aae08f3175f1d778d2656ec379266fc49}{AT\_MAGC}:
2088             \textcolor{comment}{/* No check for uwep; if wielding nothing we want to}
2089 \textcolor{comment}{             * do the normal 1-2 points bare hand damage...}
2090 \textcolor{comment}{             */}
2091             \textcolor{keywordflow}{if} (i==0 && (\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ab402dbf1bed9d0e595a2b3da6558da92}{mlet}==\hyperlink{monsym_8h_ac270eaa90b0025e153c630d7a3ec2705}{S\_KOBOLD}
2092                 || \hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ab402dbf1bed9d0e595a2b3da6558da92}{mlet}==\hyperlink{monsym_8h_a2f5e3288d9c62ffe94eae6e003a5ebf8}{S\_ORC}
2093                 || \hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ab402dbf1bed9d0e595a2b3da6558da92}{mlet}==\hyperlink{monsym_8h_ad489a3139c9449d82808b50e602a97e3}{S\_GNOME}
2094                 )) \textcolor{keywordflow}{goto} use\_weapon;
2095 
2096         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a284d61578dfa4e8d1d8acdd7e13da824}{AT\_NONE}:
2097         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a77a32645039ee7cefa43b1218da336e0}{AT\_BOOM}:
2098             \textcolor{keywordflow}{continue};
2099             \textcolor{comment}{/* Not break--avoid passive attacks from enemy */}
2100 
2101         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a0c8b4d5ce553a46024b2cb67c441514b}{AT\_BREA}:
2102         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a6792e3b455e9139c121261397dcf7422}{AT\_SPIT}:
2103         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_aa24837bc8de1c47a08514d4eeffdfe48}{AT\_GAZE}:    \textcolor{comment}{/* all done using #monster command */}
2104             dhit = 0;
2105             \textcolor{keywordflow}{break};
2106 
2107         \textcolor{keywordflow}{default}: \textcolor{comment}{/* Strange... */}
2108             impossible(\textcolor{stringliteral}{"strange attack of yours (%d)"},
2109                  mattk->\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp});
2110         \}
2111         \textcolor{keywordflow}{if} (dhit == -1) \{
2112         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a2106fda1b357aa3395703a3abff426f8}{mh} = -1;   \textcolor{comment}{/* dead in the current form */}
2113         rehumanize();
2114         \}
2115         \textcolor{keywordflow}{if} (sum[i] == 2)
2116         \textcolor{keywordflow}{return}((\textcolor{keywordtype}{boolean})\hyperlink{uhitm_8c_a53e92ab7e839e04fe836f61047b8b34c}{passive}(mon, 1, 0, mattk->\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp}));
2117                             \textcolor{comment}{/* defender dead */}
2118         \textcolor{keywordflow}{else} \{
2119         (void) \hyperlink{uhitm_8c_a53e92ab7e839e04fe836f61047b8b34c}{passive}(mon, sum[i], 1, mattk->\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp});
2120         nsum |= sum[i];
2121         \}
2122         \textcolor{keywordflow}{if} (!\hyperlink{you_8h_ab869582031082f2c352b374dc0e0c3b3}{Upolyd})
2123         \textcolor{keywordflow}{break}; \textcolor{comment}{/* No extra attacks if no longer a monster */}
2124         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a498406921f71695627a7107240f3ed7a}{multi} < 0)
2125         \textcolor{keywordflow}{break}; \textcolor{comment}{/* If paralyzed while attacking, i.e. floating eye */}
2126     \}
2127     \textcolor{keywordflow}{return}((\textcolor{keywordtype}{boolean})(nsum != 0));
2128 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a7dd49fa34e369a004e933f1c8fa83ca3}{\index{uhitm.\+c@{uhitm.\+c}!hurtmarmor@{hurtmarmor}}
\index{hurtmarmor@{hurtmarmor}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{hurtmarmor}]{\setlength{\rightskip}{0pt plus 5cm}void hurtmarmor (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mdef, }
\item[{int}]{attk}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a7dd49fa34e369a004e933f1c8fa83ca3}


Definition at line 35 of file uhitm.\+c.



References A\+D\+\_\+\+C\+O\+R\+R, A\+D\+\_\+\+R\+U\+S\+T, F\+A\+L\+S\+E, T\+R\+U\+E, W\+\_\+\+A\+R\+M, W\+\_\+\+A\+R\+M\+C, W\+\_\+\+A\+R\+M\+F, W\+\_\+\+A\+R\+M\+G, W\+\_\+\+A\+R\+M\+H, W\+\_\+\+A\+R\+M\+S, and which\+\_\+armor().



Referenced by damageum().


\begin{DoxyCode}
38 \{
39     \textcolor{keywordtype}{int} hurt;
40     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *target;
41 
42     \textcolor{keywordflow}{switch}(attk) \{
43         \textcolor{comment}{/* 0 is burning, which we should never be called with */}
44         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_ad4c8c292c1231a2dea8f3584aadba386}{AD\_RUST}: hurt = 1; \textcolor{keywordflow}{break};
45         \textcolor{keywordflow}{case} \hyperlink{monattk_8h_ab0c26930134a566b9c5a9061cbb3a5da}{AD\_CORR}: hurt = 3; \textcolor{keywordflow}{break};
46         \textcolor{keywordflow}{default}: hurt = 2; \textcolor{keywordflow}{break};
47     \}
48     \textcolor{comment}{/* What the following code does: it keeps looping until it}
49 \textcolor{comment}{     * finds a target for the rust monster.}
50 \textcolor{comment}{     * Head, feet, etc... not covered by metal, or covered by}
51 \textcolor{comment}{     * rusty metal, are not targets.  However, your body always}
52 \textcolor{comment}{     * is, no matter what covers it.}
53 \textcolor{comment}{     */}
54     \textcolor{keywordflow}{while} (1) \{
55         \textcolor{keywordflow}{switch}(rn2(5)) \{
56         \textcolor{keywordflow}{case} 0:
57         target = \hyperlink{worn_8c_a260cadb0c77a7032f8e53716072e6cd7}{which\_armor}(mdef, \hyperlink{prop_8h_a4e8958625f891ea2329369d5032d0d6d}{W\_ARMH});
58         \textcolor{keywordflow}{if} (!target || !rust\_dmg(target, xname(target), hurt, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, mdef))
59             \textcolor{keywordflow}{continue};
60         \textcolor{keywordflow}{break};
61         \textcolor{keywordflow}{case} 1:
62         target = \hyperlink{worn_8c_a260cadb0c77a7032f8e53716072e6cd7}{which\_armor}(mdef, \hyperlink{prop_8h_ac1d6573f77f2d9fe6bf8fad682246773}{W\_ARMC});
63         \textcolor{keywordflow}{if} (target) \{
64             (void)rust\_dmg(target, xname(target), hurt, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, mdef);
65             \textcolor{keywordflow}{break};
66         \}
67         \textcolor{keywordflow}{if} ((target = \hyperlink{worn_8c_a260cadb0c77a7032f8e53716072e6cd7}{which\_armor}(mdef, \hyperlink{prop_8h_a4f442d75a01cf88dcd71965d0d1f6155}{W\_ARM})) != (\textcolor{keyword}{struct }\hyperlink{structobj}{obj} *)0) \{
68             (void)rust\_dmg(target, xname(target), hurt, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, mdef);
69 \textcolor{preprocessor}{#ifdef TOURIST}
70         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((target = \hyperlink{worn_8c_a260cadb0c77a7032f8e53716072e6cd7}{which\_armor}(mdef, W\_ARMU)) != (\textcolor{keyword}{struct} 
      \hyperlink{structobj}{obj} *)0) \{
71             (void)rust\_dmg(target, xname(target), hurt, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, mdef);
72 \textcolor{preprocessor}{#endif}
73         \}
74         \textcolor{keywordflow}{break};
75         \textcolor{keywordflow}{case} 2:
76         target = \hyperlink{worn_8c_a260cadb0c77a7032f8e53716072e6cd7}{which\_armor}(mdef, \hyperlink{prop_8h_a14ac9957d8019d2304ceedb5d794fb4f}{W\_ARMS});
77         \textcolor{keywordflow}{if} (!target || !rust\_dmg(target, xname(target), hurt, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, mdef))
78             \textcolor{keywordflow}{continue};
79         \textcolor{keywordflow}{break};
80         \textcolor{keywordflow}{case} 3:
81         target = \hyperlink{worn_8c_a260cadb0c77a7032f8e53716072e6cd7}{which\_armor}(mdef, \hyperlink{prop_8h_ab96deae86360c93dcb4c33fdf246109f}{W\_ARMG});
82         \textcolor{keywordflow}{if} (!target || !rust\_dmg(target, xname(target), hurt, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, mdef))
83             \textcolor{keywordflow}{continue};
84         \textcolor{keywordflow}{break};
85         \textcolor{keywordflow}{case} 4:
86         target = \hyperlink{worn_8c_a260cadb0c77a7032f8e53716072e6cd7}{which\_armor}(mdef, \hyperlink{prop_8h_a10a0477af46978e26b84ea4f7e1d5af0}{W\_ARMF});
87         \textcolor{keywordflow}{if} (!target || !rust\_dmg(target, xname(target), hurt, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, mdef))
88             \textcolor{keywordflow}{continue};
89         \textcolor{keywordflow}{break};
90         \}
91         \textcolor{keywordflow}{break}; \textcolor{comment}{/* Out of while loop */}
92     \}
93 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a6fea92a8b59242c71925035e7879612b}{\index{uhitm.\+c@{uhitm.\+c}!joust@{joust}}
\index{joust@{joust}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{joust}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int joust (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mon, }
\item[{struct {\bf obj} $\ast$}]{obj}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a6fea92a8b59242c71925035e7879612b}


Definition at line 1135 of file uhitm.\+c.



References Fumbling, P\+\_\+\+I\+S\+R\+E\+S\+T\+R\+I\+C\+T\+E\+D, P\+\_\+\+S\+K\+I\+L\+L, P\+\_\+\+T\+W\+O\+\_\+\+W\+E\+A\+P\+O\+N\+\_\+\+C\+O\+M\+B\+A\+T, P\+\_\+\+U\+N\+S\+K\+I\+L\+L\+E\+D, Stunned, you\+::twoweap, u, unsolid, uswapwep, and uwep.



Referenced by hmon\+\_\+hitmon().


\begin{DoxyCode}
1138 \{
1139     \textcolor{keywordtype}{int} skill\_rating, joust\_dieroll;
1140 
1141     \textcolor{keywordflow}{if} (\hyperlink{youprop_8h_a10fa91003c3a9bc23959159d75d035c2}{Fumbling} || \hyperlink{youprop_8h_afd7fdfec2109113244c347015bab4ad1}{Stunned}) \textcolor{keywordflow}{return} 0;
1142     \textcolor{comment}{/* sanity check; lance must be wielded in order to joust */}
1143     \textcolor{keywordflow}{if} (obj != \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} && (obj != \hyperlink{decl_8h_ab2586a729017fc01f4612808c80c1945}{uswapwep} || !\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ade2cee6956bba775aa796bba6ae857ec}{twoweap})) \textcolor{keywordflow}{return} 0;
1144 
1145     \textcolor{comment}{/* if using two weapons, use worse of lance and two-weapon skills */}
1146     skill\_rating = \hyperlink{skills_8h_a778eff14f7209290967e1627b0b737ea}{P\_SKILL}(weapon\_type(obj));    \textcolor{comment}{/* lance skill */}
1147     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ade2cee6956bba775aa796bba6ae857ec}{twoweap} && \hyperlink{skills_8h_a778eff14f7209290967e1627b0b737ea}{P\_SKILL}(\hyperlink{skills_8h_a3a3fdbe653d405eabf351c0337601380}{P\_TWO\_WEAPON\_COMBAT}) < skill\_rating)
1148     skill\_rating = \hyperlink{skills_8h_a778eff14f7209290967e1627b0b737ea}{P\_SKILL}(\hyperlink{skills_8h_a3a3fdbe653d405eabf351c0337601380}{P\_TWO\_WEAPON\_COMBAT});
1149     \textcolor{keywordflow}{if} (skill\_rating == \hyperlink{skills_8h_a5e7033edfae828240370215ad86ec742}{P\_ISRESTRICTED}) skill\_rating = \hyperlink{skills_8h_ae53bad8310b894f49a03b74160146837}{P\_UNSKILLED}; \textcolor{comment}{/* 0=>1 */}
1150 
1151     \textcolor{comment}{/* odds to joust are expert:80%, skilled:60%, basic:40%, unskilled:20% */}
1152     \textcolor{keywordflow}{if} ((joust\_dieroll = rn2(5)) < skill\_rating) \{
1153     \textcolor{keywordflow}{if} (joust\_dieroll == 0 && rnl(50) == (50-1) &&
1154         !\hyperlink{mondata_8h_aa072852c97f59a8374d1595cda2ab700}{unsolid}(mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) && !obj\_resists(obj, 0, 100))
1155         \textcolor{keywordflow}{return} -1;  \textcolor{comment}{/* hit that breaks lance */}
1156     \textcolor{keywordflow}{return} 1;   \textcolor{comment}{/* successful joust */}
1157     \}
1158     \textcolor{keywordflow}{return} 0;   \textcolor{comment}{/* no joust bonus; revert to ordinary attack */}
1159 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a584798493588e0c419478797a914e2e2}{\index{uhitm.\+c@{uhitm.\+c}!known\+\_\+hitum@{known\+\_\+hitum}}
\index{known\+\_\+hitum@{known\+\_\+hitum}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{known\+\_\+hitum}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} known\+\_\+hitum (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mon, }
\item[{int $\ast$}]{mhit, }
\item[{struct {\bf attack} $\ast$}]{uattk}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a584798493588e0c419478797a914e2e2}


Definition at line 412 of file uhitm.\+c.



References cutworm(), monst\+::data, you\+::dx, you\+::dy, F\+A\+L\+S\+E, flags, hmon(), is\+\_\+weptool, m\+\_\+at, missum(), obj\+::oclass, T\+R\+U\+E, you\+::twoweap, u, you\+::uconduct, you\+::ustuck, uswapwep, uwep, you\+::ux, you\+::uy, flag\+::verbose, u\+\_\+conduct\+::weaphit, W\+E\+A\+P\+O\+N\+\_\+\+C\+L\+A\+S\+S, and youmonst.



Referenced by hitum(), and hmonas().


\begin{DoxyCode}
416 \{
417     \textcolor{keyword}{register} \textcolor{keywordtype}{boolean} malive = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
418 
419     \textcolor{keywordflow}{if} (\hyperlink{uhitm_8c_a2bc8b513f9502ca3b16e7a154f259057}{override\_confirmation}) \{
420         \textcolor{comment}{/* this may need to be generalized if weapons other than}
421 \textcolor{comment}{           Stormbringer acquire similar anti-social behavior... */}
422         \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_afd7dfe45d35356d861ab5e9834231929}{verbose}) Your(\textcolor{stringliteral}{"bloodthirsty blade attacks!"});
423     \}
424 
425     \textcolor{keywordflow}{if}(!*mhit) \{
426         \hyperlink{uhitm_8c_a2105b902082a7c3513754beaa432e7b6}{missum}(mon, uattk);
427     \} \textcolor{keywordflow}{else} \{
428         \textcolor{keywordtype}{int} oldhp = mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp},
429         x = \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux} + \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a0b53da9e296cbebbc3dc2fc6ade21aeb}{dx}, y = \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy} + \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a80d068cfe5c15ae06e6f152be40a716f}{dy};
430 
431         \textcolor{comment}{/* KMH, conduct */}
432         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} && (\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == \hyperlink{objclass_8h_a615c2dc6d3501d6b5e14c3373bc37ec1}{WEAPON\_CLASS} || 
      \hyperlink{obj_8h_a5f347f7456e4da8284a9bc369bc32d45}{is\_weptool}(\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep})))
433         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac34f4744daa7ff78a6ff556ade5b9601}{uconduct}.\hyperlink{structu__conduct_a5faa37ddcce277ff9f9d27de1132673b}{weaphit}++;
434 
435         \textcolor{comment}{/* we hit the monster; be careful: it might die or}
436 \textcolor{comment}{           be knocked into a different location */}
437         \hyperlink{uhitm_8c_aa0fe2fdb5136cb5a8960dd3b1f24031a}{notonhead} = (mon->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx} != x || mon->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my} != y);
438         malive = \hyperlink{uhitm_8c_a995bc5394db9ea09e5851976d7f9f755}{hmon}(mon, \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}, 0);
439         \textcolor{comment}{/* this assumes that Stormbringer was uwep not uswapwep */} 
440         \textcolor{keywordflow}{if} (malive && \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ade2cee6956bba775aa796bba6ae857ec}{twoweap} && !\hyperlink{uhitm_8c_a2bc8b513f9502ca3b16e7a154f259057}{override\_confirmation} &&
441             \hyperlink{rm_8h_a4d8dddf3df3fad65478980d2c8cbf53c}{m\_at}(x, y) == mon)
442         malive = \hyperlink{uhitm_8c_a995bc5394db9ea09e5851976d7f9f755}{hmon}(mon, \hyperlink{decl_8h_ab2586a729017fc01f4612808c80c1945}{uswapwep}, 0);
443         \textcolor{keywordflow}{if} (malive) \{
444         \textcolor{comment}{/* monster still alive */}
445         \textcolor{keywordflow}{if}(!rn2(25) && mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} < mon->\hyperlink{structmonst_a66c107319bb7bb318c04e6a0f5f03c60}{mhpmax}/2
446                 && !(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uswallow && mon == \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck})) \{
447             \textcolor{comment}{/* maybe should regurgitate if swallowed? */}
448             \textcolor{keywordflow}{if}(!rn2(3)) \{
449             monflee(mon, rnd(100), \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
450             \} \textcolor{keywordflow}{else} monflee(mon, 0, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
451 
452             \textcolor{keywordflow}{if}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck} == mon && !\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uswallow && !sticks(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.
      \hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}))
453             \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck} = 0;
454         \}
455         \textcolor{comment}{/* Vorpal Blade hit converted to miss */}
456         \textcolor{comment}{/* could be headless monster or worm tail */}
457         \textcolor{keywordflow}{if} (mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} == oldhp) \{
458             *mhit = 0;
459             \textcolor{comment}{/* a miss does not break conduct */}
460             \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} &&
461             (\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == \hyperlink{objclass_8h_a615c2dc6d3501d6b5e14c3373bc37ec1}{WEAPON\_CLASS} || \hyperlink{obj_8h_a5f347f7456e4da8284a9bc369bc32d45}{is\_weptool}(
      \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep})))
462             --\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ac34f4744daa7ff78a6ff556ade5b9601}{uconduct}.\hyperlink{structu__conduct_a5faa37ddcce277ff9f9d27de1132673b}{weaphit};
463         \}
464         \textcolor{keywordflow}{if} (mon->wormno && *mhit)
465             \hyperlink{worm_8c_a79a1f54b2e8d6aa7483bb1b6d3cbd83b}{cutworm}(mon, x, y, \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep});
466         \}
467     \}
468     \textcolor{keywordflow}{return}(malive);
469 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a5544110e943377e363a5ae2c9af36c21}{\index{uhitm.\+c@{uhitm.\+c}!m\+\_\+slips\+\_\+free@{m\+\_\+slips\+\_\+free}}
\index{m\+\_\+slips\+\_\+free@{m\+\_\+slips\+\_\+free}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{m\+\_\+slips\+\_\+free}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} m\+\_\+slips\+\_\+free (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mdef, }
\item[{struct {\bf attack} $\ast$}]{mattk}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a5544110e943377e363a5ae2c9af36c21}


Definition at line 1092 of file uhitm.\+c.



References A\+D\+\_\+\+D\+R\+I\+N, A\+D\+\_\+\+W\+R\+A\+P, attack\+::adtyp, F\+A\+L\+S\+E, objects, obj\+::otyp, T\+R\+U\+E, W\+\_\+\+A\+R\+M, W\+\_\+\+A\+R\+M\+C, W\+\_\+\+A\+R\+M\+H, and which\+\_\+armor().



Referenced by damageum().


\begin{DoxyCode}
1095 \{
1096     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{structobj}{obj};
1097 
1098     \textcolor{keywordflow}{if} (mattk->\hyperlink{structattack_a14286742d9dc1310f5c4852432264080}{adtyp} == \hyperlink{monattk_8h_a3513f620bdd0b5b59dd9c3863c3983d7}{AD\_DRIN}) \{
1099         \textcolor{comment}{/* intelligence drain attacks the head */}
1100         obj = \hyperlink{worn_8c_a260cadb0c77a7032f8e53716072e6cd7}{which\_armor}(mdef, \hyperlink{prop_8h_a4e8958625f891ea2329369d5032d0d6d}{W\_ARMH});
1101     \} \textcolor{keywordflow}{else} \{
1102         \textcolor{comment}{/* grabbing attacks the body */}
1103         obj = \hyperlink{worn_8c_a260cadb0c77a7032f8e53716072e6cd7}{which\_armor}(mdef, \hyperlink{prop_8h_ac1d6573f77f2d9fe6bf8fad682246773}{W\_ARMC});       \textcolor{comment}{/* cloak */}
1104         \textcolor{keywordflow}{if} (!obj) obj = \hyperlink{worn_8c_a260cadb0c77a7032f8e53716072e6cd7}{which\_armor}(mdef, \hyperlink{prop_8h_a4f442d75a01cf88dcd71965d0d1f6155}{W\_ARM});   \textcolor{comment}{/* suit */}
1105 \textcolor{preprocessor}{#ifdef TOURIST}
1106         \textcolor{keywordflow}{if} (!obj) obj = \hyperlink{worn_8c_a260cadb0c77a7032f8e53716072e6cd7}{which\_armor}(mdef, W\_ARMU);   \textcolor{comment}{/* shirt */}
1107 \textcolor{preprocessor}{#endif}
1108     \}
1109 
1110     \textcolor{comment}{/* if your cloak/armor is greased, monster slips off; this}
1111 \textcolor{comment}{       protection might fail (33% chance) when the armor is cursed */}
1112     \textcolor{keywordflow}{if} (obj && (obj->greased || obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == OILSKIN\_CLOAK) &&
1113         (!obj->cursed || rn2(3))) \{
1114         You(\textcolor{stringliteral}{"%s %s %s %s!"},
1115         mattk->\hyperlink{structattack_a14286742d9dc1310f5c4852432264080}{adtyp} == \hyperlink{monattk_8h_abd3282c6d3cf3a04bc06ebdc9e8a34ef}{AD\_WRAP} ?
1116             \textcolor{stringliteral}{"slip off of"} : \textcolor{stringliteral}{"grab, but cannot hold onto"},
1117         s\_suffix(mon\_nam(mdef)),
1118         obj->greased ? \textcolor{stringliteral}{"greased"} : \textcolor{stringliteral}{"slippery"},
1119         \textcolor{comment}{/* avoid "slippery slippery cloak"}
1120 \textcolor{comment}{           for undiscovered oilskin cloak */}
1121         (obj->greased || \hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp}].oc\_name\_known) ?
1122             xname(obj) : cloak\_simple\_name(obj));
1123 
1124         \textcolor{keywordflow}{if} (obj->greased && !rn2(2)) \{
1125         pline\_The(\textcolor{stringliteral}{"grease wears off."});
1126         obj->greased = 0;
1127         \}
1128         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1129     \}
1130     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1131 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a2105b902082a7c3513754beaa432e7b6}{\index{uhitm.\+c@{uhitm.\+c}!missum@{missum}}
\index{missum@{missum}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{missum}]{\setlength{\rightskip}{0pt plus 5cm}void missum (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mdef, }
\item[{struct {\bf attack} $\ast$}]{mattk}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a2105b902082a7c3513754beaa432e7b6}


Definition at line 1917 of file uhitm.\+c.



References canspotmon, flags, flag\+::verbose, and youmonst.



Referenced by hmonas(), kick\+\_\+monster(), and known\+\_\+hitum().


\begin{DoxyCode}
1920 \{
1921     \textcolor{keywordflow}{if} (could\_seduce(&\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}, mdef, mattk))
1922         You(\textcolor{stringliteral}{"pretend to be friendly to %s."}, mon\_nam(mdef));
1923     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{display_8h_a13f0a7cac1ceb73885a59b8598de1648}{canspotmon}(mdef) && \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_afd7dfe45d35356d861ab5e9834231929}{verbose})
1924         You(\textcolor{stringliteral}{"miss %s."}, mon\_nam(mdef));
1925     \textcolor{keywordflow}{else}
1926         You(\textcolor{stringliteral}{"miss it."});
1927     \textcolor{keywordflow}{if} (!mdef->msleeping && mdef->mcanmove)
1928         wakeup(mdef);
1929 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a68828eab656038be96a4e7aa5fdd50a0}{\index{uhitm.\+c@{uhitm.\+c}!N\+D\+E\+C\+L@{N\+D\+E\+C\+L}}
\index{N\+D\+E\+C\+L@{N\+D\+E\+C\+L}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{N\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void N\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf demonpet}}]{}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a68828eab656038be96a4e7aa5fdd50a0}
\hypertarget{uhitm_8c_a105f81f322fd589353fd89ec7f706b1a}{\index{uhitm.\+c@{uhitm.\+c}!N\+D\+E\+C\+L@{N\+D\+E\+C\+L}}
\index{N\+D\+E\+C\+L@{N\+D\+E\+C\+L}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{N\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void N\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf end\+\_\+engulf}}]{}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a105f81f322fd589353fd89ec7f706b1a}
\hypertarget{uhitm_8c_a193cbe8cfeaa05ef43a9440da9a8fa5e}{\index{uhitm.\+c@{uhitm.\+c}!nohandglow@{nohandglow}}
\index{nohandglow@{nohandglow}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{nohandglow}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void nohandglow (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mon}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a193cbe8cfeaa05ef43a9440da9a8fa5e}


Definition at line 2440 of file uhitm.\+c.



References Blind, H\+A\+N\+D, N\+H\+\_\+\+R\+E\+D, u, and you\+::umconf.



Referenced by hmon\+\_\+hitmon().


\begin{DoxyCode}
2442 \{
2443     \textcolor{keywordtype}{char} *hands=makeplural(body\_part(\hyperlink{hack_8h_a701f28a9a2b5334b58333f06e27ad91f}{HAND}));
2444 
2445     \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ae6400919d6031ac41b98d31ce9906308}{umconf} || mon->mconf) \textcolor{keywordflow}{return};
2446     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ae6400919d6031ac41b98d31ce9906308}{umconf} == 1) \{
2447         \textcolor{keywordflow}{if} (\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind})
2448             Your(\textcolor{stringliteral}{"%s stop tingling."}, hands);
2449         \textcolor{keywordflow}{else}
2450             Your(\textcolor{stringliteral}{"%s stop glowing %s."}, hands, hcolor(\hyperlink{decl_8h_ab6e8227ad07bf3b22f5ccec46928662f}{NH\_RED}));
2451     \} \textcolor{keywordflow}{else} \{
2452         \textcolor{keywordflow}{if} (\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind})
2453             pline\_The(\textcolor{stringliteral}{"tingling in your %s lessens."}, hands);
2454         \textcolor{keywordflow}{else}
2455             Your(\textcolor{stringliteral}{"%s no longer glow so brightly %s."}, hands,
2456                 hcolor(\hyperlink{decl_8h_ab6e8227ad07bf3b22f5ccec46928662f}{NH\_RED}));
2457     \}
2458     \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ae6400919d6031ac41b98d31ce9906308}{umconf}--;
2459 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a53e92ab7e839e04fe836f61047b8b34c}{\index{uhitm.\+c@{uhitm.\+c}!passive@{passive}}
\index{passive@{passive}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{passive}]{\setlength{\rightskip}{0pt plus 5cm}int passive (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mon, }
\item[{{\bf boolean}}]{mhit, }
\item[{int}]{malive, }
\item[{{\bf uchar}}]{aatyp}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a53e92ab7e839e04fe836f61047b8b34c}


Definition at line 2133 of file uhitm.\+c.



References A\+\_\+\+D\+E\+X, A\+\_\+\+S\+T\+R, A\+\_\+\+W\+I\+S, attack\+::aatyp, Acid\+\_\+resistance, A\+C\+U\+R\+R, A\+D\+\_\+\+A\+C\+I\+D, A\+D\+\_\+\+C\+O\+L\+D, A\+D\+\_\+\+C\+O\+R\+R, A\+D\+\_\+\+E\+L\+E\+C, A\+D\+\_\+\+E\+N\+C\+H, A\+D\+\_\+\+F\+I\+R\+E, A\+D\+\_\+\+M\+A\+G\+M, A\+D\+\_\+\+P\+L\+Y\+S, A\+D\+\_\+\+R\+U\+S\+T, A\+D\+\_\+\+S\+T\+O\+N, A\+D\+\_\+\+S\+T\+U\+N, attack\+::adtyp, Antimagic, A\+T\+\_\+\+B\+I\+T\+E, A\+T\+\_\+\+B\+U\+T\+T, A\+T\+\_\+\+C\+L\+A\+W, A\+T\+\_\+\+K\+I\+C\+K, A\+T\+\_\+\+M\+A\+G\+C, A\+T\+\_\+\+N\+O\+N\+E, A\+T\+\_\+\+S\+T\+N\+G, A\+T\+\_\+\+T\+U\+C\+H, A\+T\+\_\+\+W\+E\+A\+P, Blind, canseemon, Cold\+\_\+resistance, attack\+::damd, attack\+::damn, monst\+::data, done\+\_\+in\+\_\+by(), F\+A\+L\+S\+E, Fire\+\_\+resistance, flags, Free\+\_\+action, permonst\+::mattk, mons, N\+A\+T\+T\+K, nomovemsg, passive\+\_\+obj(), shieldeff(), Shock\+\_\+resistance, Stone\+\_\+resistance, Stunned, T\+R\+U\+E, u, uarmc, uarmf, uarmg, uarmh, ureflects(), uwep, you\+::ux, you\+::uy, flag\+::verbose, W\+\_\+\+A\+R\+M\+C, W\+\_\+\+A\+R\+M\+F, W\+\_\+\+A\+R\+M\+G, W\+\_\+\+A\+R\+M\+H, and youmonst.



Referenced by hitum(), hmonas(), kick\+\_\+monster(), and kickdmg().


\begin{DoxyCode}
2138 \{
2139     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structpermonst}{permonst} *ptr = mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data};
2140     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i, tmp;
2141 
2142     \textcolor{keywordflow}{for}(i = 0; ; i++) \{
2143         \textcolor{keywordflow}{if}(i >= \hyperlink{permonst_8h_af9119a416b08e0f343f33a0a7a945e93}{NATTK}) \textcolor{keywordflow}{return}(malive | mhit);  \textcolor{comment}{/* no passive attacks */}
2144         \textcolor{keywordflow}{if}(ptr->\hyperlink{structpermonst_a8a558cbb5f8985df95bffa4439856374}{mattk}[i].\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp} == \hyperlink{monattk_8h_a284d61578dfa4e8d1d8acdd7e13da824}{AT\_NONE}) \textcolor{keywordflow}{break};  \textcolor{comment}{/* try this one */}
2145     \}
2146     \textcolor{comment}{/* Note: tmp not always used */}
2147     \textcolor{keywordflow}{if} (ptr->\hyperlink{structpermonst_a8a558cbb5f8985df95bffa4439856374}{mattk}[i].\hyperlink{structattack_abf8c529d3dc814dcbe98780aaa9a9194}{damn})
2148         tmp = d((\textcolor{keywordtype}{int})ptr->\hyperlink{structpermonst_a8a558cbb5f8985df95bffa4439856374}{mattk}[i].\hyperlink{structattack_abf8c529d3dc814dcbe98780aaa9a9194}{damn}, (\textcolor{keywordtype}{int})ptr->\hyperlink{structpermonst_a8a558cbb5f8985df95bffa4439856374}{mattk}[i].\hyperlink{structattack_ac2b210543d1c0d0db89106b7d5f9ee00}{damd});
2149     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(ptr->\hyperlink{structpermonst_a8a558cbb5f8985df95bffa4439856374}{mattk}[i].\hyperlink{structattack_ac2b210543d1c0d0db89106b7d5f9ee00}{damd})
2150         tmp = d((\textcolor{keywordtype}{int})mon->\hyperlink{structmonst_a80ec1118166ea76d347e47d088bd1f7c}{m\_lev}+1, (\textcolor{keywordtype}{int})ptr->\hyperlink{structpermonst_a8a558cbb5f8985df95bffa4439856374}{mattk}[i].\hyperlink{structattack_ac2b210543d1c0d0db89106b7d5f9ee00}{damd});
2151     \textcolor{keywordflow}{else}
2152         tmp = 0;
2153 
2154 \textcolor{comment}{/*  These affect you even if they just died */}
2155 
2156     \textcolor{keywordflow}{switch}(ptr->\hyperlink{structpermonst_a8a558cbb5f8985df95bffa4439856374}{mattk}[i].\hyperlink{structattack_a14286742d9dc1310f5c4852432264080}{adtyp}) \{
2157 
2158       \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a6bfc66a52d2d02a9d043f28a44f7def3}{AD\_ACID}:
2159         \textcolor{keywordflow}{if}(mhit && rn2(2)) \{
2160         \textcolor{keywordflow}{if} (\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind} || !\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_afd7dfe45d35356d861ab5e9834231929}{verbose}) You(\textcolor{stringliteral}{"are splashed!"});
2161         \textcolor{keywordflow}{else}    You(\textcolor{stringliteral}{"are splashed by %s acid!"},
2162                             s\_suffix(mon\_nam(mon)));
2163 
2164         \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a31048f052c05a1b5528866e3501876a4}{Acid\_resistance})
2165             mdamageu(mon, tmp);
2166         \textcolor{keywordflow}{if}(!rn2(30)) erode\_armor(&\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
2167         \}
2168         \textcolor{keywordflow}{if} (mhit) \{
2169         \textcolor{keywordflow}{if} (aatyp == \hyperlink{monattk_8h_a0f086b24239ee3c9b8cce9edf3507323}{AT\_KICK}) \{
2170             \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a11e2d0f62fa1b42374054c939ebb288f}{uarmf} && !rn2(6))
2171             (void)rust\_dmg(\hyperlink{decl_8h_a11e2d0f62fa1b42374054c939ebb288f}{uarmf}, xname(\hyperlink{decl_8h_a11e2d0f62fa1b42374054c939ebb288f}{uarmf}), 3, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, &\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst});
2172         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (aatyp == \hyperlink{monattk_8h_a6db6784344c2424d385f6b460f0c029f}{AT\_WEAP} || aatyp == \hyperlink{monattk_8h_acb01686ab7b5bde2514f32fe5cc19fa5}{AT\_CLAW} ||
2173                aatyp == \hyperlink{monattk_8h_aae08f3175f1d778d2656ec379266fc49}{AT\_MAGC} || aatyp == \hyperlink{monattk_8h_a54d39da7ea09917045c00898714803f4}{AT\_TUCH})
2174             \hyperlink{uhitm_8c_a05b517f10f304b12c4424521ae517c02}{passive\_obj}(mon, (\textcolor{keyword}{struct} \hyperlink{structobj}{obj}*)0, &(ptr->\hyperlink{structpermonst_a8a558cbb5f8985df95bffa4439856374}{mattk}[i]));
2175         \}
2176         exercise(\hyperlink{attrib_8h_ad53430e3d611a366ec4b5c457b4c67f7}{A\_STR}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
2177         \textcolor{keywordflow}{break};
2178       \textcolor{keywordflow}{case} \hyperlink{monattk_8h_acd88c8b5dc08b255aa9a34768f7efb7c}{AD\_STON}:
2179         \textcolor{keywordflow}{if} (mhit) \{     \textcolor{comment}{/* successful attack */}
2180         \textcolor{keywordtype}{long} protector = attk\_protection((\textcolor{keywordtype}{int})aatyp);
2181 
2182         \textcolor{comment}{/* hero using monsters' AT\_MAGC attack is hitting hand to}
2183 \textcolor{comment}{           hand rather than casting a spell */}
2184         \textcolor{keywordflow}{if} (aatyp == \hyperlink{monattk_8h_aae08f3175f1d778d2656ec379266fc49}{AT\_MAGC}) protector = \hyperlink{prop_8h_ab96deae86360c93dcb4c33fdf246109f}{W\_ARMG};
2185 
2186         \textcolor{keywordflow}{if} (protector == 0L ||      \textcolor{comment}{/* no protection */}
2187             (protector == \hyperlink{prop_8h_ab96deae86360c93dcb4c33fdf246109f}{W\_ARMG} && !\hyperlink{decl_8h_a374ab5e4582cfafa2d4ef57211f53293}{uarmg} && !\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}) ||
2188             (protector == \hyperlink{prop_8h_a10a0477af46978e26b84ea4f7e1d5af0}{W\_ARMF} && !\hyperlink{decl_8h_a11e2d0f62fa1b42374054c939ebb288f}{uarmf}) ||
2189             (protector == \hyperlink{prop_8h_a4e8958625f891ea2329369d5032d0d6d}{W\_ARMH} && !\hyperlink{decl_8h_a5990ad491dff32418089ab967be227a5}{uarmh}) ||
2190             (protector == (\hyperlink{prop_8h_ac1d6573f77f2d9fe6bf8fad682246773}{W\_ARMC}|\hyperlink{prop_8h_ab96deae86360c93dcb4c33fdf246109f}{W\_ARMG}) && (!\hyperlink{decl_8h_a586be55c11f20a38a490f6bb922a437d}{uarmc} || !\hyperlink{decl_8h_a374ab5e4582cfafa2d4ef57211f53293}{uarmg}))) \{
2191             \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a90b638323d50e1f8d52d4a9576d90551}{Stone\_resistance} &&
2192                 !(poly\_when\_stoned(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) &&
2193                 polymon(PM\_STONE\_GOLEM))) \{
2194             You(\textcolor{stringliteral}{"turn to stone..."});
2195             \hyperlink{end_8c_a2a4518b11efaf16a0b79fa3e7ea4d12d}{done\_in\_by}(mon);
2196             \textcolor{keywordflow}{return} 2;
2197             \}
2198         \}
2199         \}
2200         \textcolor{keywordflow}{break};
2201       \textcolor{keywordflow}{case} \hyperlink{monattk_8h_ad4c8c292c1231a2dea8f3584aadba386}{AD\_RUST}:
2202         \textcolor{keywordflow}{if}(mhit && !mon->mcan) \{
2203         \textcolor{keywordflow}{if} (aatyp == \hyperlink{monattk_8h_a0f086b24239ee3c9b8cce9edf3507323}{AT\_KICK}) \{
2204             \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a11e2d0f62fa1b42374054c939ebb288f}{uarmf})
2205             (void)rust\_dmg(\hyperlink{decl_8h_a11e2d0f62fa1b42374054c939ebb288f}{uarmf}, xname(\hyperlink{decl_8h_a11e2d0f62fa1b42374054c939ebb288f}{uarmf}), 1, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, &\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst});
2206         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (aatyp == \hyperlink{monattk_8h_a6db6784344c2424d385f6b460f0c029f}{AT\_WEAP} || aatyp == \hyperlink{monattk_8h_acb01686ab7b5bde2514f32fe5cc19fa5}{AT\_CLAW} ||
2207                aatyp == \hyperlink{monattk_8h_aae08f3175f1d778d2656ec379266fc49}{AT\_MAGC} || aatyp == \hyperlink{monattk_8h_a54d39da7ea09917045c00898714803f4}{AT\_TUCH})
2208             \hyperlink{uhitm_8c_a05b517f10f304b12c4424521ae517c02}{passive\_obj}(mon, (\textcolor{keyword}{struct} \hyperlink{structobj}{obj}*)0, &(ptr->\hyperlink{structpermonst_a8a558cbb5f8985df95bffa4439856374}{mattk}[i]));
2209         \}
2210         \textcolor{keywordflow}{break};
2211       \textcolor{keywordflow}{case} \hyperlink{monattk_8h_ab0c26930134a566b9c5a9061cbb3a5da}{AD\_CORR}:
2212         \textcolor{keywordflow}{if}(mhit && !mon->mcan) \{
2213         \textcolor{keywordflow}{if} (aatyp == \hyperlink{monattk_8h_a0f086b24239ee3c9b8cce9edf3507323}{AT\_KICK}) \{
2214             \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a11e2d0f62fa1b42374054c939ebb288f}{uarmf})
2215             (void)rust\_dmg(\hyperlink{decl_8h_a11e2d0f62fa1b42374054c939ebb288f}{uarmf}, xname(\hyperlink{decl_8h_a11e2d0f62fa1b42374054c939ebb288f}{uarmf}), 3, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, &\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst});
2216         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (aatyp == \hyperlink{monattk_8h_a6db6784344c2424d385f6b460f0c029f}{AT\_WEAP} || aatyp == \hyperlink{monattk_8h_acb01686ab7b5bde2514f32fe5cc19fa5}{AT\_CLAW} ||
2217                aatyp == \hyperlink{monattk_8h_aae08f3175f1d778d2656ec379266fc49}{AT\_MAGC} || aatyp == \hyperlink{monattk_8h_a54d39da7ea09917045c00898714803f4}{AT\_TUCH})
2218             \hyperlink{uhitm_8c_a05b517f10f304b12c4424521ae517c02}{passive\_obj}(mon, (\textcolor{keyword}{struct} \hyperlink{structobj}{obj}*)0, &(ptr->\hyperlink{structpermonst_a8a558cbb5f8985df95bffa4439856374}{mattk}[i]));
2219         \}
2220         \textcolor{keywordflow}{break};
2221       \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a7227932d2d810c400533577fe02d5971}{AD\_MAGM}:
2222         \textcolor{comment}{/* wrath of gods for attacking Oracle */}
2223         \textcolor{keywordflow}{if}(\hyperlink{youprop_8h_aaa17c946f184a85fbf104cdb4d55e24e}{Antimagic}) \{
2224         \hyperlink{display_8c_ac89f44ae626d79f05953e503312a939d}{shieldeff}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy});
2225         pline(\textcolor{stringliteral}{"A hail of magic missiles narrowly misses you!"});
2226         \} \textcolor{keywordflow}{else} \{
2227         You(\textcolor{stringliteral}{"are hit by magic missiles appearing from thin air!"});
2228         mdamageu(mon, tmp);
2229         \}
2230         \textcolor{keywordflow}{break};
2231       \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a77eab5db3c30ab9b6ac48968de9dfbd9}{AD\_ENCH}:  \textcolor{comment}{/* KMH -- remove enchantment (disenchanter) */}
2232         \textcolor{keywordflow}{if} (mhit) \{
2233         \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{structobj}{obj} = (\textcolor{keyword}{struct }obj *)0;
2234 
2235         \textcolor{keywordflow}{if} (aatyp == \hyperlink{monattk_8h_a0f086b24239ee3c9b8cce9edf3507323}{AT\_KICK}) \{
2236             obj = \hyperlink{decl_8h_a11e2d0f62fa1b42374054c939ebb288f}{uarmf};
2237             \textcolor{keywordflow}{if} (!obj) \textcolor{keywordflow}{break};
2238         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (aatyp == \hyperlink{monattk_8h_a23719123709e3174f160784fd3b3d679}{AT\_BITE} || aatyp == \hyperlink{monattk_8h_a3920c85a3766d32754a057931a6db631}{AT\_BUTT} ||
2239                (aatyp >= \hyperlink{monattk_8h_a0aa5abc1176b259b9f99f34c190255e1}{AT\_STNG} && aatyp < \hyperlink{monattk_8h_a6db6784344c2424d385f6b460f0c029f}{AT\_WEAP})) \{
2240             \textcolor{keywordflow}{break};      \textcolor{comment}{/* no object involved */}
2241         \}
2242         \hyperlink{uhitm_8c_a05b517f10f304b12c4424521ae517c02}{passive\_obj}(mon, obj, &(ptr->\hyperlink{structpermonst_a8a558cbb5f8985df95bffa4439856374}{mattk}[i]));
2243         \}
2244         \textcolor{keywordflow}{break};
2245       \textcolor{keywordflow}{default}:
2246         \textcolor{keywordflow}{break};
2247     \}
2248 
2249 \textcolor{comment}{/*  These only affect you if they still live */}
2250 
2251     \textcolor{keywordflow}{if}(malive && !mon->mcan && rn2(3)) \{
2252 
2253         \textcolor{keywordflow}{switch}(ptr->\hyperlink{structpermonst_a8a558cbb5f8985df95bffa4439856374}{mattk}[i].\hyperlink{structattack_a14286742d9dc1310f5c4852432264080}{adtyp}) \{
2254 
2255           \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a8c4e3cffc2116c9bdc32163adf5b09d5}{AD\_PLYS}:
2256         \textcolor{keywordflow}{if}(ptr == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_FLOATING\_EYE]) \{
2257             \textcolor{keywordflow}{if} (!\hyperlink{display_8h_ad75e04a9624fe7ba0e1715ae3a3feb27}{canseemon}(mon)) \{
2258             \textcolor{keywordflow}{break};
2259             \}
2260             \textcolor{keywordflow}{if}(mon->mcansee) \{
2261             \textcolor{keywordflow}{if} (\hyperlink{muse_8c_a07a7a604bbcb07e0140b43f374474805}{ureflects}(\textcolor{stringliteral}{"%s gaze is reflected by your %s."},
2262                     s\_suffix(Monnam(mon))))
2263                 ;
2264             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{youprop_8h_a53b2779a9e83e6058b918ea7de6bf64a}{Free\_action})
2265                 You(\textcolor{stringliteral}{"momentarily stiffen under %s gaze!"},
2266                     s\_suffix(mon\_nam(mon)));
2267             \textcolor{keywordflow}{else} \{
2268                 You(\textcolor{stringliteral}{"are frozen by %s gaze!"},
2269                   s\_suffix(mon\_nam(mon)));
2270                 nomul((\hyperlink{attrib_8h_ab83869fac11f870c2193469440573f84}{ACURR}(\hyperlink{attrib_8h_a4206d6431732a698ede8a237d5c17142}{A\_WIS}) > 12 || rn2(4)) ? -tmp : -127);
2271             \}
2272             \} \textcolor{keywordflow}{else} \{
2273             pline(\textcolor{stringliteral}{"%s cannot defend itself."},
2274                 Adjmonnam(mon,\textcolor{stringliteral}{"blind"}));
2275             \textcolor{keywordflow}{if}(!rn2(500)) change\_luck(-1);
2276             \}
2277         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{youprop_8h_a53b2779a9e83e6058b918ea7de6bf64a}{Free\_action}) \{
2278             You(\textcolor{stringliteral}{"momentarily stiffen."});
2279         \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{/* gelatinous cube */}
2280             You(\textcolor{stringliteral}{"are frozen by %s!"}, mon\_nam(mon));
2281                 \hyperlink{decl_8h_a03b001040702c25afae477b18b1692c3}{nomovemsg} = 0; \textcolor{comment}{/* default: "you can move again" */}
2282             nomul(-tmp);
2283             exercise(\hyperlink{attrib_8h_ad8117dfaac470310d7540a3e8dcc00e0}{A\_DEX}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
2284         \}
2285         \textcolor{keywordflow}{break};
2286           \textcolor{keywordflow}{case} \hyperlink{monattk_8h_ad91817bd861d8b17fdfc7069122ab67e}{AD\_COLD}:      \textcolor{comment}{/* brown mold or blue jelly */}
2287         \textcolor{keywordflow}{if}(monnear(mon, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy})) \{
2288             \textcolor{keywordflow}{if}(\hyperlink{youprop_8h_a5c156e9b9dbad0fa9abfd2132a72c8b1}{Cold\_resistance}) \{
2289             \hyperlink{display_8c_ac89f44ae626d79f05953e503312a939d}{shieldeff}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy});
2290             You\_feel(\textcolor{stringliteral}{"a mild chill."});
2291             ugolemeffects(\hyperlink{monattk_8h_ad91817bd861d8b17fdfc7069122ab67e}{AD\_COLD}, tmp);
2292             \textcolor{keywordflow}{break};
2293             \}
2294             You(\textcolor{stringliteral}{"are suddenly very cold!"});
2295             mdamageu(mon, tmp);
2296         \textcolor{comment}{/* monster gets stronger with your heat! */}
2297             mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} += tmp / 2;
2298             \textcolor{keywordflow}{if} (mon->\hyperlink{structmonst_a66c107319bb7bb318c04e6a0f5f03c60}{mhpmax} < mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp}) mon->\hyperlink{structmonst_a66c107319bb7bb318c04e6a0f5f03c60}{mhpmax} = mon->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp};
2299         \textcolor{comment}{/* at a certain point, the monster will reproduce! */}
2300             \textcolor{keywordflow}{if}(mon->\hyperlink{structmonst_a66c107319bb7bb318c04e6a0f5f03c60}{mhpmax} > ((\textcolor{keywordtype}{int}) (mon->\hyperlink{structmonst_a80ec1118166ea76d347e47d088bd1f7c}{m\_lev}+1) * 8))
2301             (void)split\_mon(mon, &\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst});
2302         \}
2303         \textcolor{keywordflow}{break};
2304           \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a5e7dec4b42b4a01a99dc810ece40f4b5}{AD\_STUN}:      \textcolor{comment}{/* specifically yellow mold */}
2305         \textcolor{keywordflow}{if}(!\hyperlink{youprop_8h_afd7fdfec2109113244c347015bab4ad1}{Stunned})
2306             make\_stunned((\textcolor{keywordtype}{long})tmp, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
2307         \textcolor{keywordflow}{break};
2308           \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a2435fa84586bb5a35cf46f7abd380c86}{AD\_FIRE}:
2309         \textcolor{keywordflow}{if}(monnear(mon, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy})) \{
2310             \textcolor{keywordflow}{if}(\hyperlink{youprop_8h_a37f314f0655e4ea92122aa8788a28e19}{Fire\_resistance}) \{
2311             \hyperlink{display_8c_ac89f44ae626d79f05953e503312a939d}{shieldeff}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy});
2312             You\_feel(\textcolor{stringliteral}{"mildly warm."});
2313             ugolemeffects(\hyperlink{monattk_8h_a2435fa84586bb5a35cf46f7abd380c86}{AD\_FIRE}, tmp);
2314             \textcolor{keywordflow}{break};
2315             \}
2316             You(\textcolor{stringliteral}{"are suddenly very hot!"});
2317             mdamageu(mon, tmp);
2318         \}
2319         \textcolor{keywordflow}{break};
2320           \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a3c61973cffe1d7a9ab234e619a05aeab}{AD\_ELEC}:
2321         \textcolor{keywordflow}{if}(\hyperlink{youprop_8h_acf41a934b6c52ace60238e5a65f94261}{Shock\_resistance}) \{
2322             \hyperlink{display_8c_ac89f44ae626d79f05953e503312a939d}{shieldeff}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy});
2323             You\_feel(\textcolor{stringliteral}{"a mild tingle."});
2324             ugolemeffects(\hyperlink{monattk_8h_a3c61973cffe1d7a9ab234e619a05aeab}{AD\_ELEC}, tmp);
2325             \textcolor{keywordflow}{break};
2326         \}
2327         You(\textcolor{stringliteral}{"are jolted with electricity!"});
2328         mdamageu(mon, tmp);
2329         \textcolor{keywordflow}{break};
2330           \textcolor{keywordflow}{default}:
2331         \textcolor{keywordflow}{break};
2332         \}
2333     \}
2334     \textcolor{keywordflow}{return}(malive | mhit);
2335 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a05b517f10f304b12c4424521ae517c02}{\index{uhitm.\+c@{uhitm.\+c}!passive\+\_\+obj@{passive\+\_\+obj}}
\index{passive\+\_\+obj@{passive\+\_\+obj}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{passive\+\_\+obj}]{\setlength{\rightskip}{0pt plus 5cm}void passive\+\_\+obj (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mon, }
\item[{struct {\bf obj} $\ast$}]{obj, }
\item[{struct {\bf attack} $\ast$}]{mattk}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a05b517f10f304b12c4424521ae517c02}


Definition at line 2342 of file uhitm.\+c.



References attack\+::aatyp, A\+D\+\_\+\+A\+C\+I\+D, A\+D\+\_\+\+C\+O\+R\+R, A\+D\+\_\+\+E\+N\+C\+H, A\+D\+\_\+\+R\+U\+S\+T, attack\+::adtyp, A\+R\+M\+O\+R\+\_\+\+C\+L\+A\+S\+S, A\+T\+\_\+\+N\+O\+N\+E, carried, erode\+\_\+obj(), F\+A\+L\+S\+E, permonst\+::mattk, N\+A\+T\+T\+K, T\+R\+U\+E, you\+::twoweap, u, uarmg, update\+\_\+inventory, uswapwep, and uwep.



Referenced by passive(), and thitmonst().


\begin{DoxyCode}
2346 \{
2347     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structpermonst}{permonst} *ptr = mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data};
2348     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i;
2349 
2350     \textcolor{comment}{/* if caller hasn't specified an object, use uwep, uswapwep or uarmg */}
2351     \textcolor{keywordflow}{if} (!obj) \{
2352         obj = (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ade2cee6956bba775aa796bba6ae857ec}{twoweap} && \hyperlink{decl_8h_ab2586a729017fc01f4612808c80c1945}{uswapwep} && !rn2(2)) ? \hyperlink{decl_8h_ab2586a729017fc01f4612808c80c1945}{uswapwep} : 
      \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep};
2353         \textcolor{keywordflow}{if} (!obj && mattk->\hyperlink{structattack_a14286742d9dc1310f5c4852432264080}{adtyp} == \hyperlink{monattk_8h_a77eab5db3c30ab9b6ac48968de9dfbd9}{AD\_ENCH})
2354         obj = \hyperlink{decl_8h_a374ab5e4582cfafa2d4ef57211f53293}{uarmg};       \textcolor{comment}{/* no weapon? then must be gloves */}
2355         \textcolor{keywordflow}{if} (!obj) \textcolor{keywordflow}{return};       \textcolor{comment}{/* no object to affect */}
2356     \}
2357 
2358     \textcolor{comment}{/* if caller hasn't specified an attack, find one */}
2359     \textcolor{keywordflow}{if} (!mattk) \{
2360         \textcolor{keywordflow}{for}(i = 0; ; i++) \{
2361         \textcolor{keywordflow}{if}(i >= \hyperlink{permonst_8h_af9119a416b08e0f343f33a0a7a945e93}{NATTK}) \textcolor{keywordflow}{return}; \textcolor{comment}{/* no passive attacks */}
2362         \textcolor{keywordflow}{if}(ptr->\hyperlink{structpermonst_a8a558cbb5f8985df95bffa4439856374}{mattk}[i].\hyperlink{structattack_a0836728d155c969f6b43814c6a200ccd}{aatyp} == \hyperlink{monattk_8h_a284d61578dfa4e8d1d8acdd7e13da824}{AT\_NONE}) \textcolor{keywordflow}{break}; \textcolor{comment}{/* try this one */}
2363         \}
2364         mattk = &(ptr->\hyperlink{structpermonst_a8a558cbb5f8985df95bffa4439856374}{mattk}[i]);
2365     \}
2366 
2367     \textcolor{keywordflow}{switch}(mattk->\hyperlink{structattack_a14286742d9dc1310f5c4852432264080}{adtyp}) \{
2368 
2369     \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a6bfc66a52d2d02a9d043f28a44f7def3}{AD\_ACID}:
2370         \textcolor{keywordflow}{if}(!rn2(6)) \{
2371         \hyperlink{wield_8c_a4a244d8bac0d5f5e1003b738cb04aaf9}{erode\_obj}(obj, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
2372         \}
2373         \textcolor{keywordflow}{break};
2374     \textcolor{keywordflow}{case} \hyperlink{monattk_8h_ad4c8c292c1231a2dea8f3584aadba386}{AD\_RUST}:
2375         \textcolor{keywordflow}{if}(!mon->mcan) \{
2376         \hyperlink{wield_8c_a4a244d8bac0d5f5e1003b738cb04aaf9}{erode\_obj}(obj, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
2377         \}
2378         \textcolor{keywordflow}{break};
2379     \textcolor{keywordflow}{case} \hyperlink{monattk_8h_ab0c26930134a566b9c5a9061cbb3a5da}{AD\_CORR}:
2380         \textcolor{keywordflow}{if}(!mon->mcan) \{
2381         \hyperlink{wield_8c_a4a244d8bac0d5f5e1003b738cb04aaf9}{erode\_obj}(obj, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
2382         \}
2383         \textcolor{keywordflow}{break};
2384     \textcolor{keywordflow}{case} \hyperlink{monattk_8h_a77eab5db3c30ab9b6ac48968de9dfbd9}{AD\_ENCH}:
2385         \textcolor{keywordflow}{if} (!mon->mcan) \{
2386         \textcolor{keywordflow}{if} (drain\_item(obj) && \hyperlink{obj_8h_a4adde9a5428fde9b6faf64253a1507e8}{carried}(obj) &&
2387             (obj->known || obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == \hyperlink{objclass_8h_a038c650e790f05f72fa9204b1b82660b}{ARMOR\_CLASS})) \{
2388             Your(\textcolor{stringliteral}{"%s less effective."}, aobjnam(obj, \textcolor{stringliteral}{"seem"}));
2389             \}
2390             \textcolor{keywordflow}{break};
2391         \}
2392       \textcolor{keywordflow}{default}:
2393         \textcolor{keywordflow}{break};
2394     \}
2395 
2396     \textcolor{keywordflow}{if} (\hyperlink{obj_8h_a4adde9a5428fde9b6faf64253a1507e8}{carried}(obj)) \hyperlink{winprocs_8h_a12feb374290012aafc2340c5ba15f7e8}{update\_inventory}();
2397 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_acd4cf489934613a8161f8a797b09c1a9}{\index{uhitm.\+c@{uhitm.\+c}!shade\+\_\+aware@{shade\+\_\+aware}}
\index{shade\+\_\+aware@{shade\+\_\+aware}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{shade\+\_\+aware}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} shade\+\_\+aware (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{obj}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_acd4cf489934613a8161f8a797b09c1a9}


Definition at line 1069 of file uhitm.\+c.



References F\+A\+L\+S\+E, objects, S\+I\+L\+V\+E\+R, and T\+R\+U\+E.



Referenced by hmon\+\_\+hitmon().


\begin{DoxyCode}
1071 \{
1072     \textcolor{keywordflow}{if} (!obj) \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1073     \textcolor{comment}{/*}
1074 \textcolor{comment}{     * The things in this list either}
1075 \textcolor{comment}{     * 1) affect shades.}
1076 \textcolor{comment}{     *  OR}
1077 \textcolor{comment}{     * 2) are dealt with properly by other routines}
1078 \textcolor{comment}{     *    when it comes to shades.}
1079 \textcolor{comment}{     */}
1080     \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == BOULDER || obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == HEAVY\_IRON\_BALL
1081         || obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == IRON\_CHAIN      \textcolor{comment}{/* dmgval handles those first three */}
1082         || obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == MIRROR      \textcolor{comment}{/* silver in the reflective surface */}
1083         || obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == CLOVE\_OF\_GARLIC \textcolor{comment}{/* causes shades to flee */}
1084         || \hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp}].oc\_material == \hyperlink{objclass_8h_a7e76a14a479114a4b9b20782bb00e69a}{SILVER})
1085         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1086     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1087 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a8fc39daab97b65a360b7b6f6ac1e823c}{\index{uhitm.\+c@{uhitm.\+c}!start\+\_\+engulf@{start\+\_\+engulf}}
\index{start\+\_\+engulf@{start\+\_\+engulf}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{start\+\_\+engulf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void start\+\_\+engulf (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mdef}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a8fc39daab97b65a360b7b6f6ac1e823c}


Definition at line 1713 of file uhitm.\+c.



References delay\+\_\+output, D\+I\+S\+P\+\_\+\+A\+L\+W\+A\+Y\+S, Invisible, map\+\_\+location(), mon\+\_\+to\+\_\+glyph, tmp\+\_\+at(), T\+R\+U\+E, u, you\+::ux, you\+::uy, and youmonst.



Referenced by gulpum().


\begin{DoxyCode}
1715 \{
1716     \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a3a091215989ce11abb81f94308b01b6d}{Invisible}) \{
1717         \hyperlink{display_8c_a9675dacd157a137b805dd9261524d7a8}{map\_location}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
1718         \hyperlink{display_8c_a0567746aec3aa9a3e8075d8eabb29846}{tmp\_at}(\hyperlink{display_8h_a649697258eb2dc5242572b7722f93ac6}{DISP\_ALWAYS}, \hyperlink{display_8h_a1fa83f592d6dcf87df43743338ece721}{mon\_to\_glyph}(&\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}));
1719         \hyperlink{display_8c_a0567746aec3aa9a3e8075d8eabb29846}{tmp\_at}(mdef->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx}, mdef->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my});
1720     \}
1721     You(\textcolor{stringliteral}{"engulf %s!"}, mon\_nam(mdef));
1722     \hyperlink{winprocs_8h_a52ac0892dec99e42da526fda2126d9e9}{delay\_output}();
1723     \hyperlink{winprocs_8h_a52ac0892dec99e42da526fda2126d9e9}{delay\_output}();
1724 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a80be2dc85a675fa92ad7a3db308f7ea0}{\index{uhitm.\+c@{uhitm.\+c}!steal\+\_\+it@{steal\+\_\+it}}
\index{steal\+\_\+it@{steal\+\_\+it}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{steal\+\_\+it}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void steal\+\_\+it (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mdef, }
\item[{struct {\bf attack} $\ast$}]{mattk}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a80be2dc85a675fa92ad7a3db308f7ea0}


Definition at line 1196 of file uhitm.\+c.



References B\+U\+F\+S\+Z, obj\+::corpsenm, monst\+::data, F\+A\+L\+S\+E, mhe, mhis, permonst\+::mlet, permonst\+::mname, M\+O\+N\+\_\+\+N\+O\+W\+E\+P, mons, obj\+::nobj, O\+B\+J\+\_\+\+I\+N\+V\+E\+N\+T, otmp, obj\+::otyp, obj\+::owornmask, panic(), S\+\_\+\+N\+Y\+M\+P\+H, Sprintf, touch\+\_\+petrifies, T\+R\+U\+E, u, uarmg, update\+\_\+mon\+\_\+intrinsics(), Upolyd, W\+\_\+\+A\+R\+M, W\+\_\+\+A\+R\+M\+G, W\+\_\+\+W\+E\+P, obj\+::where, and youmonst.



Referenced by damageum().


\begin{DoxyCode}
1199 \{
1200     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp}, *stealoid, **minvent\_ptr;
1201     \textcolor{keywordtype}{long} unwornmask;
1202 
1203     \textcolor{keywordflow}{if} (!mdef->\hyperlink{structmonst_a480856d6a5db5610593c9816e525a978}{minvent}) \textcolor{keywordflow}{return};      \textcolor{comment}{/* nothing to take */}
1204 
1205     \textcolor{comment}{/* look for worn body armor */}
1206     stealoid = (\textcolor{keyword}{struct }\hyperlink{structobj}{obj} *)0;
1207     \textcolor{keywordflow}{if} (could\_seduce(&\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}, mdef, mattk)) \{
1208         \textcolor{comment}{/* find armor, and move it to end of inventory in the process */}
1209         minvent\_ptr = &mdef->\hyperlink{structmonst_a480856d6a5db5610593c9816e525a978}{minvent};
1210         \textcolor{keywordflow}{while} ((otmp = *minvent\_ptr) != 0)
1211         \textcolor{keywordflow}{if} (otmp->\hyperlink{structobj_a7906e045755ba4099705764a4eb076c6}{owornmask} & \hyperlink{prop_8h_a4f442d75a01cf88dcd71965d0d1f6155}{W\_ARM}) \{
1212             \textcolor{keywordflow}{if} (stealoid) \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"steal\_it: multiple worn suits"});
1213             *minvent\_ptr = otmp->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj};  \textcolor{comment}{/* take armor out of minvent */}
1214             stealoid = \hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp};
1215             stealoid->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj} = (\textcolor{keyword}{struct }\hyperlink{structobj}{obj} *)0;
1216         \} \textcolor{keywordflow}{else} \{
1217             minvent\_ptr = &otmp->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj};
1218         \}
1219         *minvent\_ptr = stealoid;    \textcolor{comment}{/* put armor back into minvent */}
1220     \}
1221 
1222     \textcolor{keywordflow}{if} (stealoid) \{     \textcolor{comment}{/* we will be taking everything */}
1223         \textcolor{keywordflow}{if} (gender(mdef) == (int) \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.mfemale &&
1224             \hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ab402dbf1bed9d0e595a2b3da6558da92}{mlet} == \hyperlink{monsym_8h_a9e0d9f6e11465919bac8252be7ead3f8}{S\_NYMPH})
1225         You(\textcolor{stringliteral}{"charm %s.  She gladly hands over her possessions."},
1226             mon\_nam(mdef));
1227         \textcolor{keywordflow}{else}
1228         You(\textcolor{stringliteral}{"seduce %s and %s starts to take off %s clothes."},
1229             mon\_nam(mdef), \hyperlink{you_8h_a02ab05651821bbe8851d8459a27553e3}{mhe}(mdef), \hyperlink{you_8h_aa53b72a15dda33a02f28703fbc551090}{mhis}(mdef));
1230     \}
1231 
1232     \textcolor{keywordflow}{while} ((otmp = mdef->\hyperlink{structmonst_a480856d6a5db5610593c9816e525a978}{minvent}) != 0) \{
1233         \textcolor{keywordflow}{if} (!\hyperlink{you_8h_ab869582031082f2c352b374dc0e0c3b3}{Upolyd}) \textcolor{keywordflow}{break};       \textcolor{comment}{/* no longer have ability to steal */}
1234         \textcolor{comment}{/* take the object away from the monster */}
1235         obj\_extract\_self(otmp);
1236         \textcolor{keywordflow}{if} ((unwornmask = otmp->\hyperlink{structobj_a7906e045755ba4099705764a4eb076c6}{owornmask}) != 0L) \{
1237         mdef->\hyperlink{structmonst_afc2bd39e2f3e797e15bea20ac7f69788}{misc\_worn\_check} &= ~unwornmask;
1238         \textcolor{keywordflow}{if} (otmp->\hyperlink{structobj_a7906e045755ba4099705764a4eb076c6}{owornmask} & \hyperlink{prop_8h_abd75a55f67b13523ef4377d4eb6fb6ad}{W\_WEP}) \{
1239             setmnotwielded(mdef,otmp);
1240             \hyperlink{monst_8h_a34607029d74c5c6d0cb7f33d2092b8c8}{MON\_NOWEP}(mdef);
1241         \}
1242         otmp->\hyperlink{structobj_a7906e045755ba4099705764a4eb076c6}{owornmask} = 0L;
1243         \hyperlink{worn_8c_af698b30adfe86cacfe152fa4010d46c8}{update\_mon\_intrinsics}(mdef, otmp, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1244 
1245         \textcolor{keywordflow}{if} (otmp == stealoid)   \textcolor{comment}{/* special message for final item */}
1246             pline(\textcolor{stringliteral}{"%s finishes taking off %s suit."},
1247               Monnam(mdef), \hyperlink{you_8h_aa53b72a15dda33a02f28703fbc551090}{mhis}(mdef));
1248         \}
1249         \textcolor{comment}{/* give the object to the character */}
1250         otmp = hold\_another\_object(otmp, \textcolor{stringliteral}{"You snatched but dropped %s."},
1251                        doname(otmp), \textcolor{stringliteral}{"You steal: "});
1252         \textcolor{keywordflow}{if} (otmp->\hyperlink{structobj_a57f24060a7aa1c3d2fd02c1c550cb5c6}{where} != \hyperlink{obj_8h_af1a65072bbaff49e63dd0e724e205067}{OBJ\_INVENT}) \textcolor{keywordflow}{continue};
1253         \textcolor{keywordflow}{if} (otmp->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == CORPSE &&
1254             \hyperlink{mondata_8h_ad1e85e493d27cdfdbe94c43710c4b191}{touch\_petrifies}(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[otmp->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm}]) && !
      \hyperlink{decl_8h_a374ab5e4582cfafa2d4ef57211f53293}{uarmg}) \{
1255         \textcolor{keywordtype}{char} kbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
1256 
1257         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(kbuf, \textcolor{stringliteral}{"stolen %s corpse"}, \hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[otmp->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm}].
      \hyperlink{structpermonst_ae92da7d141243d7e37d4a12340bb248f}{mname});
1258         instapetrify(kbuf);
1259         \textcolor{keywordflow}{break};      \textcolor{comment}{/* stop the theft even if hero survives */}
1260         \}
1261         \textcolor{comment}{/* more take-away handling, after theft message */}
1262         \textcolor{keywordflow}{if} (unwornmask & \hyperlink{prop_8h_abd75a55f67b13523ef4377d4eb6fb6ad}{W\_WEP}) \{      \textcolor{comment}{/* stole wielded weapon */}
1263         possibly\_unwield(mdef, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1264         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (unwornmask & \hyperlink{prop_8h_ab96deae86360c93dcb4c33fdf246109f}{W\_ARMG}) \{ \textcolor{comment}{/* stole worn gloves */}
1265         mselftouch(mdef, (\textcolor{keyword}{const} \textcolor{keywordtype}{char} *)0, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
1266         \textcolor{keywordflow}{if} (mdef->\hyperlink{structmonst_abe22e95755f1348a6a1c78252be5d76d}{mhp} <= 0)  \textcolor{comment}{/* it's now a statue */}
1267             \textcolor{keywordflow}{return};     \textcolor{comment}{/* can't continue stealing */}
1268         \}
1269 
1270         \textcolor{keywordflow}{if} (!stealoid) \textcolor{keywordflow}{break};   \textcolor{comment}{/* only taking one item */}
1271     \}
1272 \}
\end{DoxyCode}
\hypertarget{uhitm_8c_a9e547eaf1632538055c0a209af4b2273}{\index{uhitm.\+c@{uhitm.\+c}!stumble\+\_\+onto\+\_\+mimic@{stumble\+\_\+onto\+\_\+mimic}}
\index{stumble\+\_\+onto\+\_\+mimic@{stumble\+\_\+onto\+\_\+mimic}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{stumble\+\_\+onto\+\_\+mimic}]{\setlength{\rightskip}{0pt plus 5cm}void stumble\+\_\+onto\+\_\+mimic (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mtmp}
\end{DoxyParamCaption}
)}}\label{uhitm_8c_a9e547eaf1632538055c0a209af4b2273}


Definition at line 2401 of file uhitm.\+c.



References A\+D\+\_\+\+S\+T\+C\+K, Blind, Blind\+\_\+telepat, you\+::dx, you\+::dy, glyph\+\_\+is\+\_\+cmap, glyph\+\_\+is\+\_\+object, glyph\+\_\+to\+\_\+cmap, glyph\+\_\+to\+\_\+obj, levl, M\+\_\+\+A\+P\+\_\+\+M\+O\+N\+S\+T\+E\+R, S\+\_\+hcdoor, S\+\_\+vcdoor, See\+\_\+invisible, u, you\+::ustuck, you\+::ux, you\+::uy, and what.



Referenced by attack\+\_\+checks().


\begin{DoxyCode}
2403 \{
2404     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *fmt = \textcolor{stringliteral}{"Wait!  That's %s!"},
2405            *\textcolor{keyword}{generic} = \textcolor{stringliteral}{"a monster"},
2406            *\hyperlink{detect_8c_a951a98f1e2d69ca61adcd53c0f8faca3}{what} = 0;
2407 
2408     \textcolor{keywordflow}{if}(!\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck} && !mtmp->mflee && dmgtype(mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data},\hyperlink{monattk_8h_a7c15b586eba04f9fb2b34d332640be79}{AD\_STCK}))
2409         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck} = mtmp;
2410 
2411     \textcolor{keywordflow}{if} (\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind}) \{
2412         \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a27cbd2bb7c71d4627d48c2715be37423}{Blind\_telepat})
2413         \hyperlink{detect_8c_a951a98f1e2d69ca61adcd53c0f8faca3}{what} = \textcolor{keyword}{generic};     \textcolor{comment}{/* with default fmt */}
2414         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mtmp->\hyperlink{structmonst_aab8fc9a0be90b4db8333b09487e2620c}{m\_ap\_type} == \hyperlink{monst_8h_ac3674020cb0ffbb50a783e53e76e21f4}{M\_AP\_MONSTER})
2415         \hyperlink{detect_8c_a951a98f1e2d69ca61adcd53c0f8faca3}{what} = a\_monnam(mtmp);  \textcolor{comment}{/* differs from what was sensed */}
2416     \} \textcolor{keywordflow}{else} \{
2417         \textcolor{keywordtype}{int} glyph = \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a0b53da9e296cbebbc3dc2fc6ade21aeb}{dx}][\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}+\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a80d068cfe5c15ae06e6f152be40a716f}{dy}].glyph;
2418 
2419         \textcolor{keywordflow}{if} (\hyperlink{display_8h_ae849bd5a5de7fbf41783c5af0d81aecd}{glyph\_is\_cmap}(glyph) &&
2420             (\hyperlink{display_8h_a7bbc740e05e67c80b7b7dd81f2dd825d}{glyph\_to\_cmap}(glyph) == \hyperlink{rm_8h_aa2fb4b079e394b211180b9a57cff39ac}{S\_hcdoor} ||
2421              \hyperlink{display_8h_a7bbc740e05e67c80b7b7dd81f2dd825d}{glyph\_to\_cmap}(glyph) == \hyperlink{rm_8h_a48b567f0b941ec718d04a736f71da55f}{S\_vcdoor}))
2422         fmt = \textcolor{stringliteral}{"The door actually was %s!"};
2423         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{display_8h_a5a3c3067dbac4b44ad002fbe980a90dd}{glyph\_is\_object}(glyph) &&
2424             \hyperlink{display_8h_afea03e8d4cb058f7ac029417c0f4d73f}{glyph\_to\_obj}(glyph) == GOLD\_PIECE)
2425         fmt = \textcolor{stringliteral}{"That gold was %s!"};
2426 
2427         \textcolor{comment}{/* cloned Wiz starts out mimicking some other monster and}
2428 \textcolor{comment}{           might make himself invisible before being revealed */}
2429         \textcolor{keywordflow}{if} (mtmp->minvis && !\hyperlink{youprop_8h_ae00ea7702fa1870643d604364b0640c7}{See\_invisible})
2430         \hyperlink{detect_8c_a951a98f1e2d69ca61adcd53c0f8faca3}{what} = \textcolor{keyword}{generic};
2431         \textcolor{keywordflow}{else}
2432         \hyperlink{detect_8c_a951a98f1e2d69ca61adcd53c0f8faca3}{what} = a\_monnam(mtmp);
2433     \}
2434     \textcolor{keywordflow}{if} (\hyperlink{detect_8c_a951a98f1e2d69ca61adcd53c0f8faca3}{what}) pline(fmt, \hyperlink{detect_8c_a951a98f1e2d69ca61adcd53c0f8faca3}{what});
2435 
2436     wakeup(mtmp);   \textcolor{comment}{/* clears mimicking */}
2437 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{uhitm_8c_ac2d2b71a2fe853fe47029a09aed9aca0}{\index{uhitm.\+c@{uhitm.\+c}!dieroll@{dieroll}}
\index{dieroll@{dieroll}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{dieroll}]{\setlength{\rightskip}{0pt plus 5cm}int dieroll\hspace{0.3cm}{\ttfamily [static]}}}\label{uhitm_8c_ac2d2b71a2fe853fe47029a09aed9aca0}


Definition at line 26 of file uhitm.\+c.

\hypertarget{uhitm_8c_aa0fe2fdb5136cb5a8960dd3b1f24031a}{\index{uhitm.\+c@{uhitm.\+c}!notonhead@{notonhead}}
\index{notonhead@{notonhead}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{notonhead}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} notonhead}}\label{uhitm_8c_aa0fe2fdb5136cb5a8960dd3b1f24031a}
\hypertarget{uhitm_8c_a2bc8b513f9502ca3b16e7a154f259057}{\index{uhitm.\+c@{uhitm.\+c}!override\+\_\+confirmation@{override\+\_\+confirmation}}
\index{override\+\_\+confirmation@{override\+\_\+confirmation}!uhitm.\+c@{uhitm.\+c}}
\subsubsection[{override\+\_\+confirmation}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} override\+\_\+confirmation = {\bf F\+A\+L\+S\+E}\hspace{0.3cm}{\ttfamily [static]}}}\label{uhitm_8c_a2bc8b513f9502ca3b16e7a154f259057}


Definition at line 28 of file uhitm.\+c.

