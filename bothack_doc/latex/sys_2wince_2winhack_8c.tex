\hypertarget{sys_2wince_2winhack_8c}{\section{nethack/sys/wince/winhack.c File Reference}
\label{sys_2wince_2winhack_8c}\index{nethack/sys/wince/winhack.\+c@{nethack/sys/wince/winhack.\+c}}
}
{\ttfamily \#include \char`\"{}win\+M\+S.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}hack.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}dlb.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhmain.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhmap.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{sys_2wince_2winhack_8c_a59a23745a783d8231bd9424517729ce0}{S\+H\+A\+R\+E\+D\+\_\+\+D\+C\+L}~extern
\item 
\#define \hyperlink{sys_2wince_2winhack_8c_a9993e50593c85529d2765c55200a3c1e}{M\+A\+X\+\_\+\+C\+M\+D\+L\+I\+N\+E\+\_\+\+P\+A\+R\+A\+M}~255
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{sys_2wince_2winhack_8c_a7e74147e106fa0eeb0fbe2d6666a902d}{F\+D\+E\+C\+L} (\hyperlink{bemain_8c_aaf78dc4561c71581ba8f98f2c8db8b9d}{nethack\+\_\+exit},(int))
\item 
static T\+C\+H\+A\+R $\ast$ \hyperlink{sys_2wince_2winhack_8c_a457d5d88c1b3751a9028e38bcaca36fe}{\+\_\+get\+\_\+cmd\+\_\+arg} (T\+C\+H\+A\+R $\ast$p\+Cmd\+Line)
\item 
B\+O\+O\+L \hyperlink{sys_2wince_2winhack_8c_a5f77d4e3e5569ff9d236463fd80ebe28}{Init\+Instance} (H\+I\+N\+S\+T\+A\+N\+C\+E, int)
\item 
static void \hyperlink{sys_2wince_2winhack_8c_aaa11254a2c9bc6c5e309a445c27d130a}{win\+\_\+hack\+\_\+init} (int, char $\ast$$\ast$)
\item 
static void \+\_\+\+\_\+cdecl \hyperlink{sys_2wince_2winhack_8c_aaa9c68d4ec5e948a847bee2903390945}{mswin\+\_\+moveloop} (void $\ast$)
\item 
static B\+O\+O\+L \hyperlink{sys_2wince_2winhack_8c_a995f8ba4962f0c330a4dd27510f339d2}{set\+Map\+Tiles} (\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$\hyperlink{lev__main_8c_a6a2fc0c236288b07ce5bd1335ca89fa2}{fname})
\item 
void \hyperlink{sys_2wince_2winhack_8c_a35ab5aa1c10e2a5443c53bac07d014bf}{F\+D\+E\+C\+L} (pcmain,(int, char $\ast$$\ast$))
\item 
int A\+P\+I\+E\+N\+T\+R\+Y \hyperlink{sys_2wince_2winhack_8c_aba10a0c0be1d239beb613ef2ce28c869}{Win\+Main} (H\+I\+N\+S\+T\+A\+N\+C\+E h\+Instance, H\+I\+N\+S\+T\+A\+N\+C\+E h\+Prev\+Instance, L\+P\+W\+S\+T\+R lp\+Cmd\+Line, int n\+Cmd\+Show)
\item 
\hyperlink{sys_2wince_2winMS_8h_a78ff8ed1e05072662719865d12608e75}{P\+N\+H\+Win\+App} \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{Get\+N\+H\+App} ()
\item 
static int \hyperlink{sys_2wince_2winhack_8c_adfb2280562113b5c1e01fee89c8a1ded}{eraseoldlocks} ()
\item 
void \hyperlink{sys_2wince_2winhack_8c_a26fa619107ec2ebabf6ffe345da1fcc4}{getlock} ()
\item 
void \hyperlink{macerrs_8c_ae04dbb69042f37c4c595fc9beb4ca754}{error} \hyperlink{sys_2wince_2winhack_8c_ae7d8058871f31151592733e0e82ab2fd}{V\+A\+\_\+\+D\+E\+C\+L} (\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$, V\+A\+\_\+\+I\+N\+I\+T(s)
\item 
\hyperlink{sys_2wince_2winhack_8c_a52ffaaff91c64705846d6e0f506195dc}{V\+A\+\_\+\+E\+N\+D} ()
\item 
\hyperlink{sys_2wince_2winhack_8c_a2879dc701085dff777122c1a265cc67f}{Message\+Box} (\hyperlink{uudecode_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{N\+U\+L\+L}, wbuf, T\+E\+X\+T(\char`\"{}Error\char`\"{}), M\+B\+\_\+\+O\+K$\vert$M\+B\+\_\+\+I\+C\+O\+N\+E\+R\+R\+O\+R)
\item 
\hyperlink{sys_2wince_2winhack_8c_a26248234a12f5d74cede4c5c9968454b}{exit} (\hyperlink{global_8h_a73efe787c131b385070f25d18b7c9aa4}{E\+X\+I\+T\+\_\+\+F\+A\+I\+L\+U\+R\+E})
\item 
void \hyperlink{sys_2wince_2winhack_8c_a50a46845849e6e33fe78e27e7051b074}{nt\+\_\+regularize} (char $\ast$s)
\item 
void \hyperlink{sys_2wince_2winhack_8c_a3ff672e64e68c72bc22ab226c272bb0f}{win32\+\_\+abort} ()
\item 
void \hyperlink{sys_2wince_2winhack_8c_a7d2499070603e220eaa00936d661359c}{append\+\_\+port\+\_\+id} (char $\ast$\hyperlink{xpm2img_8c_a6f4b9854141692d23b0d072176044ca6}{buf})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{win_2win32_2winhack_8c_a59a23745a783d8231bd9424517729ce0}{S\+H\+A\+R\+E\+D\+\_\+\+D\+C\+L} char \hyperlink{sys_2wince_2winhack_8c_a660405f8daeac10e2bcc02e76a58dc83}{orgdir} \mbox{[}\hyperlink{wceconf_8h_a306ffcae7edd4e8e4f5779ad8359ee1c}{P\+A\+T\+H\+L\+E\+N}\mbox{]}
\item 
\hyperlink{sys_2wince_2winMS_8h_a52b1c3765f37fecb2265032f9c730ff1}{N\+H\+Win\+App} \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\+\_\+nethack\+\_\+app}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{sys_2wince_2winhack_8c_a9993e50593c85529d2765c55200a3c1e}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!M\+A\+X\+\_\+\+C\+M\+D\+L\+I\+N\+E\+\_\+\+P\+A\+R\+A\+M@{M\+A\+X\+\_\+\+C\+M\+D\+L\+I\+N\+E\+\_\+\+P\+A\+R\+A\+M}}
\index{M\+A\+X\+\_\+\+C\+M\+D\+L\+I\+N\+E\+\_\+\+P\+A\+R\+A\+M@{M\+A\+X\+\_\+\+C\+M\+D\+L\+I\+N\+E\+\_\+\+P\+A\+R\+A\+M}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{M\+A\+X\+\_\+\+C\+M\+D\+L\+I\+N\+E\+\_\+\+P\+A\+R\+A\+M}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+A\+X\+\_\+\+C\+M\+D\+L\+I\+N\+E\+\_\+\+P\+A\+R\+A\+M~255}}\label{sys_2wince_2winhack_8c_a9993e50593c85529d2765c55200a3c1e}


Definition at line 34 of file winhack.\+c.



Referenced by Win\+Main().

\hypertarget{sys_2wince_2winhack_8c_a59a23745a783d8231bd9424517729ce0}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!S\+H\+A\+R\+E\+D\+\_\+\+D\+C\+L@{S\+H\+A\+R\+E\+D\+\_\+\+D\+C\+L}}
\index{S\+H\+A\+R\+E\+D\+\_\+\+D\+C\+L@{S\+H\+A\+R\+E\+D\+\_\+\+D\+C\+L}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{S\+H\+A\+R\+E\+D\+\_\+\+D\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+H\+A\+R\+E\+D\+\_\+\+D\+C\+L~extern}}\label{sys_2wince_2winhack_8c_a59a23745a783d8231bd9424517729ce0}


Definition at line 14 of file winhack.\+c.



\subsection{Function Documentation}
\hypertarget{sys_2wince_2winhack_8c_a457d5d88c1b3751a9028e38bcaca36fe}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!\+\_\+get\+\_\+cmd\+\_\+arg@{\+\_\+get\+\_\+cmd\+\_\+arg}}
\index{\+\_\+get\+\_\+cmd\+\_\+arg@{\+\_\+get\+\_\+cmd\+\_\+arg}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{\+\_\+get\+\_\+cmd\+\_\+arg}]{\setlength{\rightskip}{0pt plus 5cm}T\+C\+H\+A\+R $\ast$ \+\_\+get\+\_\+cmd\+\_\+arg (
\begin{DoxyParamCaption}
\item[{T\+C\+H\+A\+R $\ast$}]{p\+Cmd\+Line}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{sys_2wince_2winhack_8c_a457d5d88c1b3751a9028e38bcaca36fe}


Definition at line 290 of file winhack.\+c.



References N\+U\+L\+L, and T\+R\+U\+E.



Referenced by Win\+Main().


\begin{DoxyCode}
291 \{
292     \textcolor{keyword}{static} TCHAR* pArgs = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
293     TCHAR  *pRetArg;
294     BOOL   bQuoted;
295 
296     \textcolor{keywordflow}{if}( !pCmdLine && !pArgs ) \textcolor{keywordflow}{return} \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
297     \textcolor{keywordflow}{if}( !pArgs ) pArgs = pCmdLine;
298 
299     \textcolor{comment}{/* skip whitespace */}
300     \textcolor{keywordflow}{for}(pRetArg = pArgs; *pRetArg && \_istspace(*pRetArg); pRetArg = CharNext(pRetArg));
301     \textcolor{keywordflow}{if}( !*pRetArg ) \{
302         pArgs = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
303         \textcolor{keywordflow}{return} \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
304     \}
305 
306     \textcolor{comment}{/* check for quote */}
307     \textcolor{keywordflow}{if}( *pRetArg==TEXT(\textcolor{charliteral}{'"'}) ) \{
308             bQuoted = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
309             pRetArg = CharNext(pRetArg);
310             pArgs = \_tcschr(pRetArg, TEXT(\textcolor{charliteral}{'"'}));
311     \} \textcolor{keywordflow}{else} \{
312         \textcolor{comment}{/* skip to whitespace */}
313         \textcolor{keywordflow}{for}(pArgs = pRetArg; *pArgs && !\_istspace(*pArgs); pArgs = CharNext(pArgs));
314     \}
315     
316     \textcolor{keywordflow}{if}( pArgs && *pArgs ) \{
317         TCHAR* p;
318         p = pArgs;
319         pArgs = CharNext(pArgs);
320         *p = (TCHAR)0;
321     \} \textcolor{keywordflow}{else} \{
322         pArgs = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
323     \}
324 
325     \textcolor{keywordflow}{return} pRetArg;
326 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2winhack_8c_a7d2499070603e220eaa00936d661359c}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!append\+\_\+port\+\_\+id@{append\+\_\+port\+\_\+id}}
\index{append\+\_\+port\+\_\+id@{append\+\_\+port\+\_\+id}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{append\+\_\+port\+\_\+id}]{\setlength{\rightskip}{0pt plus 5cm}void append\+\_\+port\+\_\+id (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{buf}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2winhack_8c_a7d2499070603e220eaa00936d661359c}


Definition at line 356 of file winhack.\+c.



References eos(), and Sprintf.



Referenced by getversionstring().


\begin{DoxyCode}
358 \{
359     \textcolor{keywordtype}{char} *portstr = PORT\_CE\_PLATFORM \textcolor{stringliteral}{" "} PORT\_CE\_CPU;
360     \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(\hyperlink{makedefs_8c_a72563303ed4b67f2a7dd9f2d15a01558}{eos}(\hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}), \textcolor{stringliteral}{" %s"}, portstr);
361 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2winhack_8c_adfb2280562113b5c1e01fee89c8a1ded}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!eraseoldlocks@{eraseoldlocks}}
\index{eraseoldlocks@{eraseoldlocks}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{eraseoldlocks}]{\setlength{\rightskip}{0pt plus 5cm}static int eraseoldlocks (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{sys_2wince_2winhack_8c_adfb2280562113b5c1e01fee89c8a1ded}


Definition at line 160 of file winhack.\+c.



References fqname(), L\+E\+V\+E\+L\+P\+R\+E\+F\+I\+X, lock, M\+A\+X\+D\+U\+N\+G\+E\+O\+N, M\+A\+X\+L\+E\+V\+E\+L, set\+\_\+levelfile\+\_\+name(), and unlink().


\begin{DoxyCode}
161 \{
162     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i;
163 
164     \textcolor{comment}{/* cannot use maxledgerno() here, because we need to find a lock name}
165 \textcolor{comment}{     * before starting everything (including the dungeon initialization}
166 \textcolor{comment}{     * that sets astral\_level, needed for maxledgerno()) up}
167 \textcolor{comment}{     */}
168     \textcolor{keywordflow}{for}(i = 1; i <= \hyperlink{global_8h_a1a21793acfe9387a78ebc2a03178cf02}{MAXDUNGEON}*\hyperlink{global_8h_a7cdfb44bf10c2e268d7a04a48a1ae6c0}{MAXLEVEL} + 1; i++) \{
169         \textcolor{comment}{/* try to remove all */}
170         \hyperlink{files_8c_afcc4febcf4dd9d86ba3cc3df34f5a588}{set\_levelfile\_name}(\hyperlink{decl_8h_a8b16c414738de372bc32500c786b4942}{lock}, i);
171         (void) \hyperlink{wceconf_8h_aaa6f9697fa5339b751a4394678403892}{unlink}(\hyperlink{files_8c_a8059f77bb89e5ed0c3bf6ff939a21fc1}{fqname}(\hyperlink{decl_8h_a8b16c414738de372bc32500c786b4942}{lock}, \hyperlink{decl_8h_a3927e6e5163851a0485f8e8adba6f784}{LEVELPREFIX}, 0));
172     \}
173     \hyperlink{files_8c_afcc4febcf4dd9d86ba3cc3df34f5a588}{set\_levelfile\_name}(\hyperlink{decl_8h_a8b16c414738de372bc32500c786b4942}{lock}, 0);
174     \textcolor{keywordflow}{if}(\hyperlink{wceconf_8h_aaa6f9697fa5339b751a4394678403892}{unlink}(\hyperlink{files_8c_a8059f77bb89e5ed0c3bf6ff939a21fc1}{fqname}(\hyperlink{decl_8h_a8b16c414738de372bc32500c786b4942}{lock}, \hyperlink{decl_8h_a3927e6e5163851a0485f8e8adba6f784}{LEVELPREFIX}, 0)))
175         \textcolor{keywordflow}{return} 0;               \textcolor{comment}{/* cannot remove it */}
176     \textcolor{keywordflow}{return}(1);                  \textcolor{comment}{/* success! */}
177 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2winhack_8c_a26248234a12f5d74cede4c5c9968454b}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!exit@{exit}}
\index{exit@{exit}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{exit}]{\setlength{\rightskip}{0pt plus 5cm}exit (
\begin{DoxyParamCaption}
\item[{{\bf E\+X\+I\+T\+\_\+\+F\+A\+I\+L\+U\+R\+E}}]{}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2winhack_8c_a26248234a12f5d74cede4c5c9968454b}
\hypertarget{sys_2wince_2winhack_8c_a7e74147e106fa0eeb0fbe2d6666a902d}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf nethack\+\_\+exit}}]{, }
\item[{(int)}]{}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2winhack_8c_a7e74147e106fa0eeb0fbe2d6666a902d}
\hypertarget{sys_2wince_2winhack_8c_a35ab5aa1c10e2a5443c53bac07d014bf}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{pcmain}]{, }
\item[{(int, char $\ast$$\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2winhack_8c_a35ab5aa1c10e2a5443c53bac07d014bf}
\hypertarget{sys_2wince_2winhack_8c_a26fa619107ec2ebabf6ffe345da1fcc4}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!getlock@{getlock}}
\index{getlock@{getlock}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{getlock}]{\setlength{\rightskip}{0pt plus 5cm}void getlock (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2winhack_8c_a26fa619107ec2ebabf6ffe345da1fcc4}


Definition at line 180 of file winhack.\+c.



References B\+U\+F\+S\+Z, close(), creat(), error(), F\+C\+M\+A\+S\+K, fqname(), Get\+N\+H\+App(), hackpid, H\+L\+O\+C\+K, L\+E\+V\+E\+L\+P\+R\+E\+F\+I\+X, lock, Message\+Box(), N\+H\+\_\+\+A2\+W, N\+U\+L\+L, set\+\_\+levelfile\+\_\+name(), Sprintf, unlock\+\_\+file(), and write().


\begin{DoxyCode}
181 \{
182     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *fq\_lock;
183     \textcolor{keywordtype}{char} tbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
184     TCHAR wbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
185     HANDLE f;
186     \textcolor{keywordtype}{int} fd;
187     \textcolor{keywordtype}{int} choice;
188 
189     \textcolor{comment}{/* regularize(lock); */} \textcolor{comment}{/* already done in pcmain */}
190     \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(tbuf, \textcolor{stringliteral}{"%s"}, \hyperlink{files_8c_a8059f77bb89e5ed0c3bf6ff939a21fc1}{fqname}(\hyperlink{decl_8h_a8b16c414738de372bc32500c786b4942}{lock}, \hyperlink{decl_8h_a3927e6e5163851a0485f8e8adba6f784}{LEVELPREFIX}, 0));
191     \hyperlink{files_8c_afcc4febcf4dd9d86ba3cc3df34f5a588}{set\_levelfile\_name}(\hyperlink{decl_8h_a8b16c414738de372bc32500c786b4942}{lock}, 0);
192     fq\_lock = \hyperlink{files_8c_a8059f77bb89e5ed0c3bf6ff939a21fc1}{fqname}(\hyperlink{decl_8h_a8b16c414738de372bc32500c786b4942}{lock}, \hyperlink{decl_8h_a3927e6e5163851a0485f8e8adba6f784}{LEVELPREFIX}, 1);
193 
194     f = CreateFile(
195             \hyperlink{wceconf_8h_a2ed36c9ee770dfe5f2d0e3088a62adad}{NH\_A2W}(fq\_lock, wbuf, \hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}),
196             GENERIC\_READ,
197             0,
198             \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL},
199             OPEN\_EXISTING,
200             FILE\_ATTRIBUTE\_NORMAL,
201             \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
202     \textcolor{keywordflow}{if}( f==INVALID\_HANDLE\_VALUE ) \{
203         \textcolor{keywordflow}{if}(GetLastError()==ERROR\_FILE\_NOT\_FOUND) \textcolor{keywordflow}{goto} gotlock;    \textcolor{comment}{/* no such file */}
204         \hyperlink{txt2iff_8c_a64e632a682e311bde915784e6a17da31}{error}(\textcolor{stringliteral}{"Cannot open %s"}, fq\_lock);
205     \}
206 
207     CloseHandle(f);
208 
209     \textcolor{comment}{/* prompt user that the game alredy exist */}
210     choice = \hyperlink{sys_2wince_2winhack_8c_a2879dc701085dff777122c1a265cc67f}{MessageBox}(
211         \hyperlink{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{GetNHApp}()->hMainWnd,
212         TEXT(\textcolor{stringliteral}{"There are files from a game in progress under your name. Recover?"}),
213         TEXT(\textcolor{stringliteral}{"Nethack"}),
214         MB\_YESNO | MB\_DEFBUTTON1 
215         );
216     \textcolor{keywordflow}{switch}(choice) \{
217     \textcolor{keywordflow}{case} IDYES:
218         \textcolor{keywordflow}{if}(recover\_savefile()) \{
219             \textcolor{keywordflow}{goto} gotlock;
220         \} \textcolor{keywordflow}{else} \{
221             \hyperlink{txt2iff_8c_a64e632a682e311bde915784e6a17da31}{error}(\textcolor{stringliteral}{"Couldn't recover old game."});
222         \}
223         \textcolor{keywordflow}{break};
224 
225     \textcolor{keywordflow}{case} IDNO: 
226         \hyperlink{files_8c_a84521e5fe9e1e74c551af4ea9441cbe7}{unlock\_file}(\hyperlink{ntconf_8h_ac9a24df010a94943b265c1b23f14f8bc}{HLOCK});
227         \hyperlink{txt2iff_8c_a64e632a682e311bde915784e6a17da31}{error}(\textcolor{stringliteral}{"%s"}, \textcolor{stringliteral}{"Cannot start a new game."});
228         \textcolor{keywordflow}{break};
229     \};
230 
231 gotlock:
232     fd = \hyperlink{wceconf_8h_a8e3d15ba88c8177901cb71711b060b36}{creat}(fq\_lock, \hyperlink{beconf_8h_abf4be38c8e5fb2c8a7c719d08e2178ac}{FCMASK});
233     \textcolor{keywordflow}{if}(fd == -1) \{
234         \hyperlink{txt2iff_8c_a64e632a682e311bde915784e6a17da31}{error}(\textcolor{stringliteral}{"cannot creat lock file (%s.)"}, fq\_lock);
235     \} \textcolor{keywordflow}{else} \{
236         \textcolor{keywordflow}{if}(\hyperlink{wceconf_8h_a0c029374a95b1e46ea446a2b958bae95}{write}(fd, (\textcolor{keywordtype}{char} *) &\hyperlink{decl_8h_a8ce342978cf711fcf79e4f9027bff80b}{hackpid}, \textcolor{keyword}{sizeof}(\hyperlink{decl_8h_a8ce342978cf711fcf79e4f9027bff80b}{hackpid}))
237             != \textcolor{keyword}{sizeof}(\hyperlink{decl_8h_a8ce342978cf711fcf79e4f9027bff80b}{hackpid}))\{
238             \hyperlink{txt2iff_8c_a64e632a682e311bde915784e6a17da31}{error}(\textcolor{stringliteral}{"cannot write lock (%s)"}, fq\_lock);
239         \}
240         \textcolor{keywordflow}{if}(\hyperlink{wceconf_8h_aaf66f9bf47dbed159bf1a600f11c785e}{close}(fd) == -1) \{
241             \hyperlink{txt2iff_8c_a64e632a682e311bde915784e6a17da31}{error}(\textcolor{stringliteral}{"cannot close lock (%s)"}, fq\_lock);
242         \}
243     \}
244 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!Get\+N\+H\+App@{Get\+N\+H\+App}}
\index{Get\+N\+H\+App@{Get\+N\+H\+App}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{Get\+N\+H\+App}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\+N\+H\+Win\+App} Get\+N\+H\+App (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2winhack_8c_ad72c8d80c9fc01eaf07a3c2463ab88bd}


Definition at line 154 of file winhack.\+c.



Referenced by \+\_\+get\+\_\+main\+\_\+menu(), About(), Check\+Input\+Dialog(), Ext\+Cmd\+Dlg\+Proc(), Getlin\+Dlg\+Proc(), getlock(), init\+Map\+Tiles(), Main\+Wnd\+Proc(), Map\+Wnd\+Proc(), Menu\+Wnd\+Proc(), mswin\+\_\+add\+\_\+menu(), mswin\+\_\+clear\+\_\+nhwindow(), mswin\+\_\+cliparound(), mswin\+\_\+create\+\_\+nhwindow(), mswin\+\_\+curs(), mswin\+\_\+destroy\+\_\+nhwindow(), mswin\+\_\+destroy\+\_\+reg(), mswin\+\_\+display\+\_\+file(), mswin\+\_\+display\+\_\+nhwindow(), mswin\+\_\+end\+\_\+menu(), mswin\+\_\+ext\+\_\+cmd\+\_\+window(), mswin\+\_\+get\+\_\+nh\+\_\+event(), mswin\+\_\+getlin\+\_\+window(), mswin\+\_\+hwnd\+\_\+from\+\_\+winid(), mswin\+\_\+init\+\_\+command\+\_\+window(), mswin\+\_\+init\+\_\+main\+\_\+window(), mswin\+\_\+init\+\_\+map\+\_\+window(), mswin\+\_\+init\+\_\+menu\+\_\+window(), mswin\+\_\+init\+\_\+message\+\_\+window(), mswin\+\_\+init\+\_\+nhwindows(), mswin\+\_\+init\+\_\+status\+\_\+window(), mswin\+\_\+layout\+\_\+main\+\_\+window(), mswin\+\_\+main\+\_\+loop(), mswin\+\_\+map\+\_\+mode(), mswin\+\_\+map\+\_\+stretch(), mswin\+\_\+menu\+\_\+check\+\_\+intf\+\_\+mode(), mswin\+\_\+outrip(), mswin\+\_\+player\+\_\+selection\+\_\+window(), mswin\+\_\+popup\+\_\+destroy(), mswin\+\_\+popup\+\_\+display(), mswin\+\_\+preference\+\_\+update(), mswin\+\_\+print\+\_\+glyph(), mswin\+\_\+putstr\+\_\+ex(), mswin\+\_\+raw\+\_\+print(), mswin\+\_\+raw\+\_\+print\+\_\+bold(), mswin\+\_\+read\+\_\+reg(), mswin\+\_\+select\+\_\+map\+\_\+mode(), mswin\+\_\+select\+\_\+menu(), mswin\+\_\+set\+\_\+fullscreen(), mswin\+\_\+start\+\_\+menu(), mswin\+\_\+window\+\_\+mark\+\_\+dead(), mswin\+\_\+winid\+\_\+from\+\_\+handle(), mswin\+\_\+winid\+\_\+from\+\_\+type(), mswin\+\_\+write\+\_\+reg(), mswin\+\_\+yn\+\_\+function(), N\+H\+Menu\+Text\+Wnd\+Proc(), N\+H\+Message\+Box(), N\+H\+Message\+Wnd\+Proc(), on\+Create(), on\+Draw\+Item(), on\+List\+Char(), on\+M\+S\+N\+H\+\_\+\+H\+Scroll(), on\+M\+S\+N\+H\+\_\+\+V\+Scroll(), on\+M\+S\+N\+H\+Command(), on\+Paint(), on\+W\+M\+Command(), Player\+Selector\+Dlg\+Proc(), register\+\_\+command\+\_\+window\+\_\+class(), register\+\_\+main\+\_\+window\+\_\+class(), register\+\_\+map\+\_\+window\+\_\+class(), register\+\_\+message\+\_\+window\+\_\+class(), register\+\_\+status\+\_\+window\+\_\+class(), Set\+Menu\+List\+Type(), and Status\+Wnd\+Proc().


\begin{DoxyCode}
155 \{
156     \textcolor{keywordflow}{return} &\hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app};
157 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2winhack_8c_a5f77d4e3e5569ff9d236463fd80ebe28}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!Init\+Instance@{Init\+Instance}}
\index{Init\+Instance@{Init\+Instance}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{Init\+Instance}]{\setlength{\rightskip}{0pt plus 5cm}B\+O\+O\+L Init\+Instance (
\begin{DoxyParamCaption}
\item[{H\+I\+N\+S\+T\+A\+N\+C\+E}]{h\+Instance, }
\item[{int}]{n\+Cmd\+Show}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2winhack_8c_a5f77d4e3e5569ff9d236463fd80ebe28}


Definition at line 149 of file winhack.\+c.



References T\+R\+U\+E.



Referenced by Win\+Main().


\begin{DoxyCode}
150 \{
151    \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
152 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2winhack_8c_a2879dc701085dff777122c1a265cc67f}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!Message\+Box@{Message\+Box}}
\index{Message\+Box@{Message\+Box}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{Message\+Box}]{\setlength{\rightskip}{0pt plus 5cm}Message\+Box (
\begin{DoxyParamCaption}
\item[{{\bf N\+U\+L\+L}}]{, }
\item[{wbuf}]{, }
\item[{T\+E\+X\+T(\char`\"{}Error\char`\"{})}]{, }
\item[{M\+B\+\_\+\+O\+K$\vert$}]{M\+B\+\_\+\+I\+C\+O\+N\+E\+R\+R\+O\+R}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2winhack_8c_a2879dc701085dff777122c1a265cc67f}


Referenced by alloc\+\_\+file\+\_\+handle(), getlock(), mswin\+\_\+display\+\_\+file(), mswin\+\_\+raw\+\_\+print(), mswin\+\_\+raw\+\_\+print\+\_\+bold(), N\+H\+Message\+Box(), Player\+Selector\+Dlg\+Proc(), plsel\+Final\+Selection(), prompt\+\_\+for\+\_\+player\+\_\+selection(), and Win\+Main().

\hypertarget{sys_2wince_2winhack_8c_aaa9c68d4ec5e948a847bee2903390945}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!mswin\+\_\+moveloop@{mswin\+\_\+moveloop}}
\index{mswin\+\_\+moveloop@{mswin\+\_\+moveloop}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{mswin\+\_\+moveloop}]{\setlength{\rightskip}{0pt plus 5cm}static void \+\_\+\+\_\+cdecl mswin\+\_\+moveloop (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{sys_2wince_2winhack_8c_aaa9c68d4ec5e948a847bee2903390945}
\hypertarget{sys_2wince_2winhack_8c_a50a46845849e6e33fe78e27e7051b074}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!nt\+\_\+regularize@{nt\+\_\+regularize}}
\index{nt\+\_\+regularize@{nt\+\_\+regularize}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{nt\+\_\+regularize}]{\setlength{\rightskip}{0pt plus 5cm}void nt\+\_\+regularize (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{s}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2winhack_8c_a50a46845849e6e33fe78e27e7051b074}


Definition at line 333 of file winhack.\+c.


\begin{DoxyCode}
335 \{
336     \textcolor{keyword}{register} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *lp;
337 
338     \textcolor{keywordflow}{for} (lp = s; *lp; lp++)
339         \textcolor{keywordflow}{if} ( *lp == \textcolor{charliteral}{'?'} || *lp == \textcolor{charliteral}{'"'} || *lp == \textcolor{charliteral}{'\(\backslash\)\(\backslash\)'} ||
340          *lp == \textcolor{charliteral}{'/'} || *lp == \textcolor{charliteral}{'>'} || *lp == \textcolor{charliteral}{'<'}  ||
341          *lp == \textcolor{charliteral}{'*'} || *lp == \textcolor{charliteral}{'|'} || *lp == \textcolor{charliteral}{':'}  || (*lp > 127))
342             *lp = \textcolor{charliteral}{'\_'};
343 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2winhack_8c_a995f8ba4962f0c330a4dd27510f339d2}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!set\+Map\+Tiles@{set\+Map\+Tiles}}
\index{set\+Map\+Tiles@{set\+Map\+Tiles}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{set\+Map\+Tiles}]{\setlength{\rightskip}{0pt plus 5cm}static B\+O\+O\+L set\+Map\+Tiles (
\begin{DoxyParamCaption}
\item[{{\bf const} char $\ast$}]{fname}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{sys_2wince_2winhack_8c_a995f8ba4962f0c330a4dd27510f339d2}
\hypertarget{sys_2wince_2winhack_8c_ae7d8058871f31151592733e0e82ab2fd}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!V\+A\+\_\+\+D\+E\+C\+L@{V\+A\+\_\+\+D\+E\+C\+L}}
\index{V\+A\+\_\+\+D\+E\+C\+L@{V\+A\+\_\+\+D\+E\+C\+L}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{V\+A\+\_\+\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf error} V\+A\+\_\+\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf const} char $\ast$}]{, }
\item[{V\+A\+\_\+\+I\+N\+I\+T(}]{s}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2winhack_8c_ae7d8058871f31151592733e0e82ab2fd}


Definition at line 248 of file winhack.\+c.



References N\+U\+L\+L.


\begin{DoxyCode}
260                        \{
261         LPVOID lpMsgBuf;
262         \textcolor{keywordflow}{if}( FormatMessage( 
263                 FORMAT\_MESSAGE\_ALLOCATE\_BUFFER | 
264                 FORMAT\_MESSAGE\_FROM\_SYSTEM | 
265                 FORMAT\_MESSAGE\_IGNORE\_INSERTS,
266                 \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL},
267                 last\_error,
268                 0, \textcolor{comment}{// Default language}
269                 (LPTSTR) &lpMsgBuf,
270                 0,
271                 \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} 
272             )
273             )
274         \{
275             
276             \_tcsncat(wbuf, TEXT(\textcolor{stringliteral}{"\(\backslash\)nSystem Error: "}), \textcolor{keyword}{sizeof}(wbuf)/\textcolor{keyword}{sizeof}(wbuf[0]) - \_tcslen(wbuf) );
277             \_tcsncat(wbuf, lpMsgBuf, \textcolor{keyword}{sizeof}(wbuf)/\textcolor{keyword}{sizeof}(wbuf[0]) - \_tcslen(wbuf) );
278 
279             \textcolor{comment}{// Free the buffer.}
280             LocalFree( lpMsgBuf );
281         \}
282     \}
\end{DoxyCode}
\hypertarget{sys_2wince_2winhack_8c_a52ffaaff91c64705846d6e0f506195dc}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!V\+A\+\_\+\+E\+N\+D@{V\+A\+\_\+\+E\+N\+D}}
\index{V\+A\+\_\+\+E\+N\+D@{V\+A\+\_\+\+E\+N\+D}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{V\+A\+\_\+\+E\+N\+D}]{\setlength{\rightskip}{0pt plus 5cm}V\+A\+\_\+\+E\+N\+D (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2winhack_8c_a52ffaaff91c64705846d6e0f506195dc}
\hypertarget{sys_2wince_2winhack_8c_a3ff672e64e68c72bc22ab226c272bb0f}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!win32\+\_\+abort@{win32\+\_\+abort}}
\index{win32\+\_\+abort@{win32\+\_\+abort}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{win32\+\_\+abort}]{\setlength{\rightskip}{0pt plus 5cm}void win32\+\_\+abort (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2winhack_8c_a3ff672e64e68c72bc22ab226c272bb0f}


Definition at line 345 of file winhack.\+c.



References abort, and wizard.


\begin{DoxyCode}
346 \{
347 
348 \textcolor{preprocessor}{#ifdef WIZARD}
349     \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a5f48dc2f029e22c05489fb20a491db4b}{wizard})
350         DebugBreak();
351 \textcolor{preprocessor}{#endif}
352     \hyperlink{wceconf_8h_aef4ff7cf390aba5ab4172cca329a2c89}{abort}();
353 \}
\end{DoxyCode}
\hypertarget{sys_2wince_2winhack_8c_aaa11254a2c9bc6c5e309a445c27d130a}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!win\+\_\+hack\+\_\+init@{win\+\_\+hack\+\_\+init}}
\index{win\+\_\+hack\+\_\+init@{win\+\_\+hack\+\_\+init}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{win\+\_\+hack\+\_\+init}]{\setlength{\rightskip}{0pt plus 5cm}static void win\+\_\+hack\+\_\+init (
\begin{DoxyParamCaption}
\item[{int}]{, }
\item[{char $\ast$$\ast$}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{sys_2wince_2winhack_8c_aaa11254a2c9bc6c5e309a445c27d130a}
\hypertarget{sys_2wince_2winhack_8c_aba10a0c0be1d239beb613ef2ce28c869}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!Win\+Main@{Win\+Main}}
\index{Win\+Main@{Win\+Main}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{Win\+Main}]{\setlength{\rightskip}{0pt plus 5cm}int A\+P\+I\+E\+N\+T\+R\+Y Win\+Main (
\begin{DoxyParamCaption}
\item[{H\+I\+N\+S\+T\+A\+N\+C\+E}]{h\+Instance, }
\item[{H\+I\+N\+S\+T\+A\+N\+C\+E}]{h\+Prev\+Instance, }
\item[{L\+P\+W\+S\+T\+R}]{lp\+Cmd\+Line, }
\item[{int}]{n\+Cmd\+Show}
\end{DoxyParamCaption}
)}}\label{sys_2wince_2winhack_8c_aba10a0c0be1d239beb613ef2ce28c869}


Definition at line 36 of file winhack.\+c.



References \+\_\+get\+\_\+cmd\+\_\+arg(), mswin\+\_\+nhwindow\+\_\+app\+::b\+Cmd\+Pad, mswin\+\_\+nhwindow\+\_\+app\+::b\+Full\+Screen, mswin\+\_\+nhwindow\+\_\+app\+::b\+Hide\+Scroll\+Bars, mswin\+\_\+nhwindow\+\_\+app\+::bmp\+Map\+Tiles, mswin\+\_\+nhwindow\+\_\+app\+::bmp\+Pet\+Mark, mswin\+\_\+nhwindow\+\_\+app\+::bmp\+Tiles, mswin\+\_\+nhwindow\+\_\+app\+::b\+No\+H\+Scroll, mswin\+\_\+nhwindow\+\_\+app\+::b\+No\+V\+Scroll, buf, B\+U\+F\+S\+Z, mswin\+\_\+nhwindow\+\_\+app\+::b\+Use\+S\+I\+P, mswin\+\_\+nhwindow\+\_\+app\+::b\+Wrap\+Text, F\+A\+L\+S\+E, mswin\+\_\+nhwindow\+\_\+app\+::h\+Accel\+Table, mswin\+\_\+nhwindow\+\_\+app\+::h\+App, mswin\+\_\+nhwindow\+\_\+app\+::h\+Main\+Wnd, mswin\+\_\+nhwindow\+\_\+app\+::h\+Menu\+Bar, mswin\+\_\+nhwindow\+\_\+app\+::h\+Popup\+Wnd, I\+D\+B\+\_\+\+P\+E\+T\+M\+A\+R\+K, I\+D\+B\+\_\+\+T\+I\+L\+E\+S, I\+D\+C\+\_\+\+W\+I\+N\+H\+A\+C\+K, Init\+Instance(), mswin\+\_\+nhwindow\+\_\+app\+::map\+Tile\+\_\+\+X, mswin\+\_\+nhwindow\+\_\+app\+::map\+Tile\+\_\+\+Y, mswin\+\_\+nhwindow\+\_\+app\+::map\+Tiles\+Per\+Line, M\+A\+X\+\_\+\+C\+M\+D\+L\+I\+N\+E\+\_\+\+P\+A\+R\+A\+M, Message\+Box(), mswin\+\_\+raw\+\_\+print(), mswin\+\_\+raw\+\_\+print\+\_\+bold(), mswin\+\_\+nhwindow\+\_\+app\+::n\+Cmd\+Show, N\+H\+\_\+\+W2\+A, N\+H\+S\+T\+R\+\_\+\+B\+U\+F\+S\+I\+Z\+E, N\+U\+L\+L, panic(), sz\+Main\+Window\+Class, T\+I\+L\+E\+\_\+\+X, T\+I\+L\+E\+\_\+\+Y, T\+I\+L\+E\+S\+\_\+\+P\+E\+R\+\_\+\+L\+I\+N\+E, T\+R\+U\+E, and windowprocs.


\begin{DoxyCode}
40 \{
41     INITCOMMONCONTROLSEX InitCtrls;
42     HWND nethackWnd;
43     \textcolor{keywordtype}{int} argc;
44     \textcolor{keywordtype}{char}* argv[\hyperlink{sys_2wince_2winhack_8c_a9993e50593c85529d2765c55200a3c1e}{MAX\_CMDLINE\_PARAM}];
45     \textcolor{keywordtype}{size\_t} len;
46     TCHAR* p;
47     TCHAR wbuf[\hyperlink{wceconf_8h_a3328d64c4b8744a6e59079303035a040}{NHSTR\_BUFSIZE}];
48     \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[\hyperlink{wceconf_8h_a3328d64c4b8744a6e59079303035a040}{NHSTR\_BUFSIZE}];
49 
50     \textcolor{comment}{/* ensure that we don't access violate on a panic() */}
51     \hyperlink{winprocs_8h_a166c17ce426a1c495296575938a60f9c}{windowprocs}.win\_raw\_print = \hyperlink{sys_2wince_2mswproc_8c_af710d0c50e6d609411c4cee463cde502}{mswin\_raw\_print};
52     \hyperlink{winprocs_8h_a166c17ce426a1c495296575938a60f9c}{windowprocs}.win\_raw\_print\_bold = \hyperlink{sys_2wince_2mswproc_8c_ac4a83dc571aef8c90aedd5a94e0afa24}{mswin\_raw\_print\_bold};
53 
54     \textcolor{comment}{/* init applicatio structure */}
55     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_ae3a365ad66195c8e1d915242897c3f24}{hApp} = hInstance;
56     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a824b12aab95b45962e0385edd96efb2e}{nCmdShow} = nCmdShow;
57     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a98c007521f1719b18eeb1f11c76549d4}{hAccelTable} = LoadAccelerators(hInstance, (LPCTSTR)
      \hyperlink{sys_2wince_2resource_8h_a7580373126b32a6102eab2c742c6ba23}{IDC\_WINHACK});
58     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_ada318d77e9dd51678af5d9a3ce6ef03a}{hMainWnd} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
59     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a92e7b581dd0fad9d1af8364e5bcfe395}{hPopupWnd} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
60     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a975394932faf736ccaa592f525d66bc8}{hMenuBar} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
61     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a47710a497f0af6c839660652c841575d}{bmpTiles} = LoadBitmap(hInstance, MAKEINTRESOURCE(
      \hyperlink{sys_2wince_2resource_8h_a3bb8441855cb1b87fe9ebab30de22a5a}{IDB\_TILES}));
62     \textcolor{keywordflow}{if}( \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a47710a497f0af6c839660652c841575d}{bmpTiles}==\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} ) \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"cannot load tiles bitmap"});
63     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a786a513972fdf914ae95bcbf5c702ead}{bmpPetMark} = LoadBitmap(hInstance, MAKEINTRESOURCE(
      \hyperlink{sys_2wince_2resource_8h_a23d7e689489e24b5a09aaff2a12aee2d}{IDB\_PETMARK}));
64     \textcolor{keywordflow}{if}( \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a786a513972fdf914ae95bcbf5c702ead}{bmpPetMark}==\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} ) \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"cannot load pet mark bitmap"})
      ;
65     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a61984761ecf8b4bbc83b25fdddddc8e7}{bmpMapTiles} = \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.
      \hyperlink{structmswin__nhwindow__app_a47710a497f0af6c839660652c841575d}{bmpTiles};
66     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_adb6d803036dca29b82a10f0fbd007edd}{mapTile\_X} = \hyperlink{sys_2wince_2winMS_8h_a9f3fae6a9058d02850af5deba9be4544}{TILE\_X};
67     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a699b7a92f8c907030eff6ef5a36d29f3}{mapTile\_Y} = \hyperlink{sys_2wince_2winMS_8h_a4a62524a49a9be02996b8e667b45abc9}{TILE\_Y};
68     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a7a89a59512a3bb56005832843339f479}{mapTilesPerLine} = \hyperlink{sys_2wince_2winMS_8h_a1eaa02a47952ddaac086c1c00b92d0d6}{TILES\_PER\_LINE};
69     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a75259e1f797e53006ad99a4a28fe9b36}{bNoHScroll} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
70     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_ad0311b73326a15c00e147d1b9d809979}{bNoVScroll} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
71 
72 \textcolor{preprocessor}{#if  defined(WIN\_CE\_PS2xx) || defined(WIN\_CE\_POCKETPC) || defined(WIN\_CE\_SMARTPHONE)}
73     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_ad92d2a6da1489504549e4cd7d8237d8e}{bCmdPad} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
74 \textcolor{preprocessor}{#else}
75     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_ad92d2a6da1489504549e4cd7d8237d8e}{bCmdPad} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
76 \textcolor{preprocessor}{#endif}
77 
78     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a602ad0b692afb2be5e62dbec41942b17}{bWrapText} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
79     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a03ec520343918e83b3b20c9c08ee9d57}{bFullScreen} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
80 
81 \textcolor{preprocessor}{#if defined(WIN\_CE\_SMARTPHONE)}
82     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a9bf5a4ea1b1d3680e30d893f16117a8f}{bHideScrollBars} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
83 \textcolor{preprocessor}{#else}
84     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_a9bf5a4ea1b1d3680e30d893f16117a8f}{bHideScrollBars} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
85 \textcolor{preprocessor}{#endif}
86 
87     \hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app}.\hyperlink{structmswin__nhwindow__app_af8a7fc1fc5568f109bb31fd054a38470}{bUseSIP} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
88 
89     \textcolor{comment}{// check for running nethack programs}
90     nethackWnd = FindWindow(\hyperlink{sys_2wince_2mhmain_8c_a7ca9b3ace892ddc7646eb64d69b562df}{szMainWindowClass}, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
91     \textcolor{keywordflow}{if}( nethackWnd ) \{
92         \textcolor{comment}{// bring on top}
93         SetForegroundWindow(nethackWnd);
94         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
95     \}
96 
97     \textcolor{comment}{// init controls}
98     ZeroMemory(&InitCtrls, \textcolor{keyword}{sizeof}(InitCtrls));
99     InitCtrls.dwSize = \textcolor{keyword}{sizeof}(InitCtrls);
100     InitCtrls.dwICC = ICC\_LISTVIEW\_CLASSES;
101     \textcolor{keywordflow}{if}( !InitCommonControlsEx(&InitCtrls) ) \{
102         \hyperlink{sys_2wince_2winhack_8c_a2879dc701085dff777122c1a265cc67f}{MessageBox}(\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, TEXT(\textcolor{stringliteral}{"Cannot init common controls"}), TEXT(\textcolor{stringliteral}{"ERROR"}), MB\_OK | 
      MB\_ICONSTOP);
103         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
104     \}
105 
106     \textcolor{comment}{// Perform application initialization:}
107     \textcolor{keywordflow}{if} (!\hyperlink{sys_2wince_2winhack_8c_a5f77d4e3e5569ff9d236463fd80ebe28}{InitInstance} (hInstance, nCmdShow)) 
108     \{
109         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
110     \}
111 
112     \textcolor{comment}{/* get command line parameters */}   
113     p = \hyperlink{sys_2wince_2winhack_8c_a457d5d88c1b3751a9028e38bcaca36fe}{\_get\_cmd\_arg}(
114 #\textcolor{keywordflow}{if} defined(WIN\_CE\_PS2xx) || defined(WIN32\_PLATFORM\_HPCPRO)
115         lpCmdLine
116 #\textcolor{keywordflow}{else}
117         GetCommandLine()
118 #endif
119         );
120     \textcolor{keywordflow}{for}( argc = 1; p && argc<\hyperlink{sys_2wince_2winhack_8c_a9993e50593c85529d2765c55200a3c1e}{MAX\_CMDLINE\_PARAM}; argc++ ) \{
121         len = \_tcslen(p);
122         \textcolor{keywordflow}{if}( len>0 ) \{
123             argv[argc] = \_strdup( \hyperlink{wceconf_8h_a79324084b45d4a7bc4b8813ddfddad96}{NH\_W2A}(p, buf, \hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}) );
124         \} \textcolor{keywordflow}{else} \{
125             argv[argc] = \textcolor{stringliteral}{""};
126         \}
127         p = \hyperlink{sys_2wince_2winhack_8c_a457d5d88c1b3751a9028e38bcaca36fe}{\_get\_cmd\_arg}(\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
128     \}
129     GetModuleFileName(\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, wbuf, \hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ});
130     argv[0] = \_strdup(\hyperlink{wceconf_8h_a79324084b45d4a7bc4b8813ddfddad96}{NH\_W2A}(wbuf, buf, \hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}));
131 
132     pcmain(argc,argv);
133 
134     moveloop();
135 
136     \textcolor{keywordflow}{return} 0;
137 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!\+\_\+nethack\+\_\+app@{\+\_\+nethack\+\_\+app}}
\index{\+\_\+nethack\+\_\+app@{\+\_\+nethack\+\_\+app}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{\+\_\+nethack\+\_\+app}]{\setlength{\rightskip}{0pt plus 5cm}{\bf N\+H\+Win\+App} \+\_\+nethack\+\_\+app}}\label{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}


Definition at line 23 of file winhack.\+c.



Referenced by Get\+N\+H\+App().

\hypertarget{sys_2wince_2winhack_8c_a660405f8daeac10e2bcc02e76a58dc83}{\index{sys/wince/winhack.\+c@{sys/wince/winhack.\+c}!orgdir@{orgdir}}
\index{orgdir@{orgdir}!sys/wince/winhack.\+c@{sys/wince/winhack.\+c}}
\subsubsection[{orgdir}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+H\+A\+R\+E\+D\+\_\+\+D\+C\+L} char orgdir\mbox{[}{\bf P\+A\+T\+H\+L\+E\+N}\mbox{]}}}\label{sys_2wince_2winhack_8c_a660405f8daeac10e2bcc02e76a58dc83}


Definition at line 17 of file winhack.\+c.

