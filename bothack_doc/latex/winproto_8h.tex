\hypertarget{winproto_8h}{\section{nethack/sys/amiga/winproto.h File Reference}
\label{winproto_8h}\index{nethack/sys/amiga/winproto.\+h@{nethack/sys/amiga/winproto.\+h}}
}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{winproto_8h_a8b8c3f2cb3b8247c9610be0bb0d23f3e}{Edit\+Color} (void)
\item 
void \hyperlink{winproto_8h_a614ba0cf5df7db4e8e464ea269143a38}{Edit\+Clipping} (void)
\item 
void \hyperlink{winproto_8h_aab86548f4b4be239a38c53e5bb10302a}{Draw\+Col} (struct Window $\ast$w, int idx, \hyperlink{bitmfile_8h_a0428171499a4ab7aebc2bf058ae337df}{U\+W\+O\+R\+D} $\ast$colors)
\item 
void \hyperlink{winproto_8h_a11c44eb0694ea5e51081e54d8df22cd2}{Disp\+Col} (struct Window $\ast$w, int idx, \hyperlink{bitmfile_8h_a0428171499a4ab7aebc2bf058ae337df}{U\+W\+O\+R\+D} $\ast$colors)
\item 
void \hyperlink{winproto_8h_a0de222c442d3c7dc50e972c1f4ab16d4}{amii\+\_\+change\+\_\+color} (int, long, int)
\item 
char $\ast$ \hyperlink{winproto_8h_aff9d8c4b941f1e78656d123d92efdfe1}{amii\+\_\+get\+\_\+color\+\_\+string} ()
\item 
void \hyperlink{winproto_8h_af10d73c7abbeacb1dbf7c63fd6f50fab}{amii\+\_\+getlin} (\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$prompt, char $\ast$bufp)
\item 
void \hyperlink{winproto_8h_ac9afe077a992b95425c7d8a549c4e5ba}{getlind} (\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$prompt, char $\ast$bufp, \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$dflt)
\item 
int \hyperlink{winproto_8h_a790ffd3ec24be06476653119a754050b}{filecopy} (char $\ast$from, char $\ast$to)
\item 
char $\ast$ \hyperlink{winproto_8h_a817969c4fe20a121e99fda658e88fbc7}{basename} (char $\ast$str)
\item 
char $\ast$ \hyperlink{winproto_8h_ac27f2c6cf41fe0cd9d8e47c6e23e4c0a}{dirname} (char $\ast$str)
\item 
void \hyperlink{winproto_8h_a9fdbf76005ec3ae5b77b3002366c04d3}{amii\+\_\+putstr} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} window, int attr, \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$str)
\item 
void \hyperlink{winproto_8h_a55e9e9c33e29d3698d29ff252bf2aae8}{outmore} (struct \hyperlink{structamii__WinDesc}{amii\+\_\+\+Win\+Desc} $\ast$cw)
\item 
void \hyperlink{winproto_8h_a93a76f6f311b1a6c5bf0b64a3904c462}{outsubstr} (struct \hyperlink{structamii__WinDesc}{amii\+\_\+\+Win\+Desc} $\ast$cw, char $\ast$str, int len, int fudge)
\item 
void \hyperlink{winproto_8h_a79bd8694c08f5692ceb222c0ff4f5336}{amii\+\_\+putsym} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} st, int i, int y, \hyperlink{wingem1_8c_ada878a8b4864a1658ee0f0acd5a89412}{C\+H\+A\+R\+\_\+\+P} c)
\item 
void \hyperlink{winproto_8h_a5bf6130a3329d0281c363af9f77e6448}{amii\+\_\+addtopl} (\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$s)
\item 
void \hyperlink{winproto_8h_a948e00a84111ca94231f9b411ed7ec42}{Text\+Spaces} (struct Rast\+Port $\ast$\hyperlink{amirip_8c_aa0639b6491ec144930d14703053f32a4}{rp}, int nr)
\item 
void \hyperlink{winproto_8h_a23cfeb0082243bfa986f1c2d865a382e}{amii\+\_\+remember\+\_\+topl} (void)
\item 
long \hyperlink{winproto_8h_ad3d1ca643965bdb9df28feb9f3a15b0a}{Count\+Lines} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid})
\item 
long \hyperlink{winproto_8h_a4d4ea82c540cd06c8a9808a448599df9}{Find\+Line} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid}, int)
\item 
int \hyperlink{winproto_8h_ae41f9210f43b92a5ed2aef70982e7f9e}{amii\+\_\+doprev\+\_\+message} (void)
\item 
void \hyperlink{winproto_8h_a918f50a64d9c2b87014897c5ec05ffc1}{flush\+I\+D\+C\+M\+P} (struct Msg\+Port $\ast$)
\item 
int \hyperlink{winproto_8h_a6a1482acb616e0e5300e1f7655ff1a31}{amii\+\_\+msgborder} (struct Window $\ast$)
\item 
void \hyperlink{winproto_8h_ab858da7b4bf790de1cdd61c1d1d27cfe}{amii\+\_\+scrollmsg} (\hyperlink{mkmaze_8c_a24ac627a7839caecddfc66f1d46033f0}{register} struct Window $\ast$w, \hyperlink{mkmaze_8c_a24ac627a7839caecddfc66f1d46033f0}{register} struct \hyperlink{structamii__WinDesc}{amii\+\_\+\+Win\+Desc} $\ast$cw)
\item 
int \hyperlink{winproto_8h_a8a5e71a57c4b97bc82326de356d6e6f2}{amii\+\_\+nh\+\_\+poskey} (int $\ast$x, int $\ast$y, int $\ast$mod)
\item 
int \hyperlink{winproto_8h_afd65a0d6a2b0455f657812d7e3675b06}{amii\+\_\+nhgetch} (void)
\item 
void \hyperlink{winproto_8h_ad87aef3d81ba2f815e13260793c51c16}{amii\+\_\+get\+\_\+nh\+\_\+event} (void)
\item 
void \hyperlink{winproto_8h_abac67bb181e97ddcf156ec25e0660f9a}{amii\+\_\+getret} (void)
\item 
void \hyperlink{winproto_8h_a230942d950e207d2a95a0eaf3bcdf345}{amii\+\_\+start\+\_\+menu} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} window)
\item 
void \hyperlink{winproto_8h_a011cab3eb1bd78d60817aa2d9cc1ee57}{F\+D\+E\+C\+L} (\hyperlink{sys_2amiga_2winmenu_8c_af51e6a3371b277061496ecc1fd4096da}{amii\+\_\+add\+\_\+menu},(\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid}, int, \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} \hyperlink{wintype_8h_a49720928e6af182ee38aa332d0483b2a}{anything} $\ast$, \hyperlink{wingem1_8c_ada878a8b4864a1658ee0f0acd5a89412}{C\+H\+A\+R\+\_\+\+P}, \hyperlink{wingem1_8c_ada878a8b4864a1658ee0f0acd5a89412}{C\+H\+A\+R\+\_\+\+P}, int, \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$, \hyperlink{wingem1_8c_aa2723cc3af18a5199ab4ce7cca84d82b}{B\+O\+O\+L\+E\+A\+N\+\_\+\+P}))
\item 
void \hyperlink{winproto_8h_a3dd266d4ff629b4065bfbca2d52b4461}{F\+D\+E\+C\+L} (\hyperlink{sys_2amiga_2winmenu_8c_a619402e82816d6c7ecb4ce2f1ed7ee8c}{amii\+\_\+end\+\_\+menu},(\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid}, \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$))
\item 
int \hyperlink{winproto_8h_a21c78ad3e4eef4d3f0e2e9f7db1c1f55}{F\+D\+E\+C\+L} (\hyperlink{sys_2amiga_2winmenu_8c_ac6e5a44c3929632a8d47a2061bc8bad8}{amii\+\_\+select\+\_\+menu},(\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid}, int, \hyperlink{wintype_8h_aaef709f77068fd7ba62812589327f08f}{menu\+\_\+item} $\ast$$\ast$))
\item 
int \hyperlink{winproto_8h_a1d40ce8115a542aa37cb76a586dfefee}{Do\+Menu\+Scroll} (int win, int blocking, int how, \hyperlink{wintype_8h_aaef709f77068fd7ba62812589327f08f}{menu\+\_\+item} $\ast$$\ast$)
\item 
void \hyperlink{winproto_8h_a0d631bd0422a752b9471cd23834a863d}{Re\+Display\+Data} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} win)
\item 
void \hyperlink{winproto_8h_a3b9f0aa6b0cb58acb709d87e44a3eb99}{Display\+Data} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} win, int start)
\item 
void \hyperlink{winproto_8h_a28121fc0d5fc72d2292fa04d5bbf7d60}{Set\+Prop\+Info} (struct Window $\ast$win, struct Gadget $\ast$gad, long vis, long total, long top)
\item 
struct Window $\ast$ \hyperlink{winproto_8h_a4fbda1b274fbd7f990be789cfbb8fd52}{Open\+Sh\+Window} (struct New\+Window $\ast$nw)
\item 
void \hyperlink{winproto_8h_a343849f85cbb4ebc40f0977834cfc7be}{Close\+Sh\+Window} (struct Window $\ast$win)
\item 
int \hyperlink{winproto_8h_a63bceb4935b25e00e97a8b1cf17719bb}{Convert\+Key} (struct Intui\+Message $\ast$message)
\item 
int \hyperlink{winproto_8h_a97e9b1fe8d4c010474637a654aad6566}{kbhit} (void)
\item 
int \hyperlink{winproto_8h_ac506d1c2744895972ab13c3b19d702c3}{amikbhit} (void)
\item 
int \hyperlink{winproto_8h_a173d2dc6a888352bb65b7cacd4576308}{Window\+Getchar} (void)
\item 
\hyperlink{winami_8h_a947974ed96ae99c292b698854e310ebe}{W\+E\+T\+Y\+P\+E} \hyperlink{winproto_8h_a0cf134f2e1ce65f95d4c673c8c03ab2d}{Window\+Getevent} (void)
\item 
void \hyperlink{winproto_8h_aa0ab31344b2d7cf560f9c39c419139b7}{amii\+\_\+cleanup} (void)
\item 
void \hyperlink{winproto_8h_acd807e8b552ad939e3ae2fcb45e14c46}{Abort} (long rc)
\item 
void \hyperlink{winproto_8h_a081d5cd1a7136b98c1621dfdec338098}{Clean\+Up} (void)
\item 
void \hyperlink{winproto_8h_a5ca4d00a20e9469642bb87e62cdf4be2}{flush\+\_\+glyph\+\_\+buffer} (struct Window $\ast$w)
\item 
void \hyperlink{winproto_8h_a203b786b96fe4c8be21c63f474486d52}{amiga\+\_\+print\+\_\+glyph} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} window, int \hyperlink{tiletext_8c_ab4cc0e0b57e1c74c77467ab8ab596e3e}{color\+\_\+index}, int glyph)
\item 
void \hyperlink{winproto_8h_ad39162b44919dddfdd5add508daa3877}{start\+\_\+glyphout} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} window)
\item 
void \hyperlink{winproto_8h_af54c03b382ca47347d8e223319baa106}{amii\+\_\+end\+\_\+glyphout} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} window)
\item 
struct New\+Window $\ast$ \hyperlink{winproto_8h_ac3377d82ce911663e05ba9a63d464d90}{Dup\+New\+Window} (struct New\+Window $\ast$win)
\item 
void \hyperlink{winproto_8h_a81a885084baad168d6f5acbb40bfd42c}{Free\+New\+Window} (struct New\+Window $\ast$win)
\item 
void \hyperlink{winproto_8h_aa5da7dc4719848ae9157b977c1e1db71}{bell} (void)
\item 
void \hyperlink{winproto_8h_a1745b65b570e73d18ef385e55d71eef3}{amii\+\_\+delay\+\_\+output} (void)
\item 
void \hyperlink{winproto_8h_a7ac539968f0a526e1a4dd733d88f4b53}{amii\+\_\+number\+\_\+pad} (int \hyperlink{random_8c_a12a8a0122ec9c2b08b4ef888b28f4c15}{state})
\item 
void \hyperlink{winproto_8h_a34202204b8a823ec191848d8210df54c}{amiv\+\_\+loadlib} (void)
\item 
void \hyperlink{winproto_8h_a9c8bfd055bcb4a11d7cb73477faf8811}{amii\+\_\+loadlib} (void)
\item 
void \hyperlink{winproto_8h_a97c825c2d0c70743706367f421c8aaa1}{preserve\+\_\+icon} (void)
\item 
void \hyperlink{winproto_8h_ae769e473e3e63c0b8f24ce0541c1901f}{clear\+\_\+icon} (void)
\item 
void \hyperlink{winproto_8h_aa650954bd0e8c4a5ef3b283050cd646c}{amii\+\_\+destroy\+\_\+nhwindow} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} win)
\item 
int \hyperlink{winproto_8h_ad2252169a553a59a47299eed01b9b9ee}{amii\+\_\+create\+\_\+nhwindow} (int \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type})
\item 
void \hyperlink{winproto_8h_a8d9a0355e4c511ee2725034e1549e798}{amii\+\_\+init\+\_\+nhwindows} (int $\ast$, char $\ast$$\ast$)
\item 
void \hyperlink{winproto_8h_a7e627c455ba61be81b8318b295b93f1b}{amii\+\_\+setdrawpens} (struct Window $\ast$, int \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type})
\item 
void \hyperlink{winproto_8h_ab17ace282a2e397063b0f2ddeb94f324}{amii\+\_\+sethipens} (struct Window $\ast$, int \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type}, int attr)
\item 
void \hyperlink{winproto_8h_ae5b985026bec913a04e00d1e0d742541}{amii\+\_\+setfillpens} (struct Window $\ast$, int \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type})
\item 
void \hyperlink{winproto_8h_ac2b43ff5e6b6394438fd8fde2008d264}{amii\+\_\+clear\+\_\+nhwindow} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} win)
\item 
void \hyperlink{winproto_8h_ac946cc5b4c43a936e168ddc80b74c4bd}{dismiss\+\_\+nhwindow} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} win)
\item 
void \hyperlink{winproto_8h_afd925fb80d381b7e22df32bf7ec56012}{amii\+\_\+exit\+\_\+nhwindows} (\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$str)
\item 
void \hyperlink{winproto_8h_a743c0fb6beb3516ba3022d5680276991}{amii\+\_\+display\+\_\+nhwindow} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} win, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} blocking)
\item 
void \hyperlink{winproto_8h_ad16d76372b2790f7b6926dc6174e4111}{amii\+\_\+curs} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} window, int x, int y)
\item 
void \hyperlink{winproto_8h_a72b5bc3695faa88e00240b100758f23a}{kill\+\_\+nhwindows} (int all)
\item 
void \hyperlink{winproto_8h_a1e49c8ee67a4421aa81f5679981a4d8d}{amii\+\_\+cl\+\_\+end} (struct \hyperlink{structamii__WinDesc}{amii\+\_\+\+Win\+Desc} $\ast$cw, int i)
\item 
void \hyperlink{winproto_8h_a21dcf06b1e3a62331c49092d9911f189}{cursor\+\_\+off} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} window)
\item 
void \hyperlink{winproto_8h_ae43c0ee78599c3fa7f2fe2fe4c2b71a1}{cursor\+\_\+on} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} window)
\item 
void \hyperlink{winproto_8h_a083c06f70e2b81552708b8bb812a69e6}{amii\+\_\+suspend\+\_\+nhwindows} (\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$str)
\item 
void \hyperlink{winproto_8h_a180248b0a811ed91cd8e861da3276c8b}{amii\+\_\+resume\+\_\+nhwindows} (void)
\item 
void \hyperlink{winproto_8h_a550451159f9b1a8db45fa4bb2415a53d}{amii\+\_\+bell} (void)
\item 
void \hyperlink{winproto_8h_a286a3e794d3dba209062e7862565e70f}{removetopl} (int cnt)
\item 
void \hyperlink{winproto_8h_a168bbce4413e8e2551bf7ce24fc59506}{port\+\_\+help} (void)
\item 
void \hyperlink{winproto_8h_ad2513d411f99ff1bb783473275fedd1a}{amii\+\_\+print\+\_\+glyph} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} win, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} x, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} y, int glyph)
\item 
void \hyperlink{winproto_8h_aab47181efcfda8c085c6739aca882b94}{amii\+\_\+raw\+\_\+print} (\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$s)
\item 
void \hyperlink{winproto_8h_a7c303cbf1af1f00c78362eef85bbfa64}{amii\+\_\+raw\+\_\+print\+\_\+bold} (\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$s)
\item 
void \hyperlink{winproto_8h_a19156a1b85e94cc75203e825ee77e7c0}{amii\+\_\+update\+\_\+inventory} (void)
\item 
void \hyperlink{winproto_8h_ac8c0864548759176d8020d4f682eadf4}{amii\+\_\+mark\+\_\+synch} (void)
\item 
void \hyperlink{winproto_8h_a179bd05e544d405029628d33886400e2}{amii\+\_\+wait\+\_\+synch} (void)
\item 
void \hyperlink{winproto_8h_aa4137ced6d879e2a02a6a746e566e659}{amii\+\_\+setclipped} (void)
\item 
void \hyperlink{winproto_8h_ab842f92a372d2e1e20a0538937488950}{amii\+\_\+cliparound} (int x, int y)
\item 
void \hyperlink{winproto_8h_a519a5cd689b995154d319a65b3aca6a7}{amii\+\_\+set\+\_\+text\+\_\+font} (char $\ast$font, int \hyperlink{structsize}{size})
\item 
\hyperlink{structBitMapHeader}{Bit\+Map\+Header} \hyperlink{winproto_8h_a38dff02b63465e90aac84581f2076a40}{Read\+Image\+Files} (char $\ast$$\ast$, struct Bit\+Map $\ast$$\ast$, char $\ast$$\ast$)
\item 
\hyperlink{structBitMapHeader}{Bit\+Map\+Header} \hyperlink{winproto_8h_a317e860ba7c5cb6bc220926f5571046b}{Read\+Tile\+Image\+Files} (void)
\item 
void \hyperlink{winproto_8h_ab678d4f6f0bc71028253ad299999b95e}{Free\+Image\+Files} (char $\ast$$\ast$, struct Bit\+Map $\ast$$\ast$)
\item 
void \hyperlink{winproto_8h_a52004e01e897470f11cc048fc78f4649}{Free\+Tile\+Image\+Files} ()
\item 
void \hyperlink{winproto_8h_ae6090b74804f78ac988bfc25e2269613}{amii\+\_\+askname} (void)
\item 
void \hyperlink{winproto_8h_ad99322c107df2755cbeeb440e8991bb9}{amii\+\_\+player\+\_\+selection} (void)
\item 
void \hyperlink{winproto_8h_ade500df920f0504bb2bb7668cd0130fe}{Random\+Window} (char $\ast$\hyperlink{lev__main_8c_a8f8f80d37794cde9472343e4487ba3eb}{name})
\item 
int \hyperlink{winproto_8h_a4564c9a84f5dc940f3d35ac5211b794f}{amii\+\_\+get\+\_\+ext\+\_\+cmd} (void)
\item 
char \hyperlink{winproto_8h_ae89562752fc8144bd5514e7366b14dfa}{amii\+\_\+yn\+\_\+function} (\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$prompt, \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$resp, char def)
\item 
void \hyperlink{winproto_8h_a09ab688be08946790ca04552594110e3}{amii\+\_\+display\+\_\+file} (\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$fn, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} complain)
\item 
void \hyperlink{winproto_8h_aaa6575d9ac823d93fcc4176f3b1341c3}{Set\+Border} (struct Gadget $\ast$gd)
\item 
void $\ast$ \hyperlink{winproto_8h_ab028c02ac00afc0c1d3c568ccad68869}{malloc} (\hyperlink{mkmaze_8c_a24ac627a7839caecddfc66f1d46033f0}{register} unsigned \hyperlink{structsize}{size})
\item 
void \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free} (void $\ast$q)
\item 
void \hyperlink{winproto_8h_a74e68fe571f43e494e70d9616e4961c3}{F\+D\+E\+C\+L} (amii\+\_\+outrip,(\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} tmpwin, int how))
\item 
void \hyperlink{winproto_8h_a3eaca7a39bb270379315c3d079fd0202}{Set\+Maze\+Type} (\hyperlink{winext_8h_a4023b9ade32dcc4a00ae2f068b79e639}{Maze\+Type})
\item 
int \hyperlink{winproto_8h_aa96d3ccb91f8e74506caca1d75112644}{Glyph\+To\+Icon} (int glyph)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{winproto_8h_acd807e8b552ad939e3ae2fcb45e14c46}{\index{winproto.\+h@{winproto.\+h}!Abort@{Abort}}
\index{Abort@{Abort}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Abort}]{\setlength{\rightskip}{0pt plus 5cm}void Abort (
\begin{DoxyParamCaption}
\item[{long}]{rc}
\end{DoxyParamCaption}
)}}\label{winproto_8h_acd807e8b552ad939e3ae2fcb45e14c46}


Definition at line 741 of file amiwind.\+c.



References Abort(), amii\+\_\+getret(), amii\+\_\+procs, chdir(), exit(), orgdir, printf, and windowprocs.



Referenced by Abort(), amii\+\_\+create\+\_\+nhwindow(), and amii\+\_\+init\+\_\+nhwindows().


\begin{DoxyCode}
743 \{
744     \textcolor{keywordtype}{int} fault = 1;
745 \textcolor{preprocessor}{#ifdef CHDIR}
746     \textcolor{keyword}{extern} \textcolor{keywordtype}{char} \hyperlink{pcmain_8c_a660405f8daeac10e2bcc02e76a58dc83}{orgdir}[];
747     \hyperlink{wceconf_8h_ae6d5c38f8d7036c9010142bf4291d5ca}{chdir}(orgdir);
748 \textcolor{preprocessor}{#endif}
749 \textcolor{preprocessor}{#ifdef AMII\_GRAPHICS}
750     \textcolor{keywordflow}{if} (\hyperlink{amidos_8c_a55b41cec1916f4628807321204d03d9f}{Initialized}
751       && ConsoleDevice
752       && \hyperlink{winprocs_8h_a166c17ce426a1c495296575938a60f9c}{windowprocs}.win\_init\_nhwindows==\hyperlink{amidos_8c_a15de23af499d6c155c1ba39cec0e1cb2}{amii\_procs}.win\_init\_nhwindows) \{
753       \hyperlink{sound_8c_a3cb9f0894fab1c8fbb0753c9c7c2a8d9}{printf}(\textcolor{stringliteral}{"\(\backslash\)n\(\backslash\)nAbort with alert code %08lx...\(\backslash\)n"}, rc);
754       \hyperlink{winkey_8c_afaf5347d355ac4af27caba3454fc448a}{amii\_getret}();
755     \} \textcolor{keywordflow}{else}
756 \textcolor{preprocessor}{#endif}
757       \hyperlink{sound_8c_a3cb9f0894fab1c8fbb0753c9c7c2a8d9}{printf}(\textcolor{stringliteral}{"\(\backslash\)n\(\backslash\)nAbort with alert code %08lx...\(\backslash\)n"},rc);
758       \textcolor{comment}{/* Alert(rc);              this is too severe */}
759 \textcolor{preprocessor}{#ifdef \_\_SASC}
760 \textcolor{preprocessor}{# ifdef INTUI\_NEW\_LOOK}
761     \textcolor{keywordflow}{if}( IntuitionBase->LibNode.lib\_Version >= 37 )
762     \{
763         \textcolor{keyword}{struct }EasyStruct es =
764         \{
765             \textcolor{keyword}{sizeof}( \textcolor{keyword}{struct }EasyStruct ),
766             0,
767             "NetHack Panic Request",
768             "NetHack is Aborting with code == 0x%08lx\textcolor{stringliteral}{",}
769 \textcolor{stringliteral}{        "}Continue \hyperlink{amiwind_8c_acd807e8b552ad939e3ae2fcb45e14c46}{Abort}|Return to Program|Clean up and \hyperlink{vmsmisc_8c_a358d2e2397ca11ccd17553e3c40e7901}{exit}\textcolor{stringliteral}{",}
770 \textcolor{stringliteral}{        \};}
771 \textcolor{stringliteral}{        fault = EasyRequest( NULL, &es, NULL, (long)rc );}
772 \textcolor{stringliteral}{        if( fault == 2 )}
773 \textcolor{stringliteral}{            return;}
774 \textcolor{stringliteral}{    \}}
775 \textcolor{stringliteral}{# endif}
776 \textcolor{stringliteral}{    if( fault == 1 )}
777 \textcolor{stringliteral}{    \{}
778 \textcolor{stringliteral}{/*  \_\_emit(0x4afc); */    /* illegal instruction */}
779 \textcolor{stringliteral}{    \_\_emit(0x40fc);     /* divide by */}
780 \textcolor{stringliteral}{    \_\_emit(0x0000);     /*  #0  */}
781 \textcolor{stringliteral}{      /* NOTE: don't move amii\_cleanup() above here - */}
782 \textcolor{stringliteral}{      /* it is too likely to kill the system     */}
783 \textcolor{stringliteral}{      /* before it can get the SnapShot out, if  */}
784 \textcolor{stringliteral}{      /* there is something really wrong.    */}
785 \textcolor{stringliteral}{    \}}
786 \textcolor{stringliteral}{#endif}
787 \textcolor{stringliteral}{#ifdef AMII\_GRAPHICS}
788 \textcolor{stringliteral}{    if(windowprocs.win\_init\_nhwindows==amii\_procs.win\_init\_nhwindows)}
789 \textcolor{stringliteral}{      amii\_cleanup();}
790 \textcolor{stringliteral}{#endif}
791 \textcolor{stringliteral}{#undef exit}
792 \textcolor{stringliteral}{#ifdef AZTEC\_C}
793 \textcolor{stringliteral}{    \_abort();}
794 \textcolor{stringliteral}{#endif}
795 \textcolor{stringliteral}{    exit((int) rc);}
796 \textcolor{stringliteral}{\}}
\end{DoxyCode}
\hypertarget{winproto_8h_a203b786b96fe4c8be21c63f474486d52}{\index{winproto.\+h@{winproto.\+h}!amiga\+\_\+print\+\_\+glyph@{amiga\+\_\+print\+\_\+glyph}}
\index{amiga\+\_\+print\+\_\+glyph@{amiga\+\_\+print\+\_\+glyph}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amiga\+\_\+print\+\_\+glyph}]{\setlength{\rightskip}{0pt plus 5cm}void amiga\+\_\+print\+\_\+glyph (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{window, }
\item[{int}]{color\+\_\+index, }
\item[{int}]{glyph}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a203b786b96fe4c8be21c63f474486d52}


Referenced by amii\+\_\+print\+\_\+glyph(), and Display\+Data().

\hypertarget{winproto_8h_a5bf6130a3329d0281c363af9f77e6448}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+addtopl@{amii\+\_\+addtopl}}
\index{amii\+\_\+addtopl@{amii\+\_\+addtopl}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+addtopl}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+addtopl (
\begin{DoxyParamCaption}
\item[{{\bf const} char $\ast$}]{s}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a5bf6130a3329d0281c363af9f77e6448}
\hypertarget{winproto_8h_ae6090b74804f78ac988bfc25e2269613}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+askname@{amii\+\_\+askname}}
\index{amii\+\_\+askname@{amii\+\_\+askname}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+askname}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+askname (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ae6090b74804f78ac988bfc25e2269613}
\hypertarget{winproto_8h_a550451159f9b1a8db45fa4bb2415a53d}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+bell@{amii\+\_\+bell}}
\index{amii\+\_\+bell@{amii\+\_\+bell}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+bell}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+bell (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a550451159f9b1a8db45fa4bb2415a53d}


Definition at line 2000 of file winfuncs.\+c.



References N\+U\+L\+L.


\begin{DoxyCode}
2001 \{
2002     DisplayBeep( \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} );
2003 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a0de222c442d3c7dc50e972c1f4ab16d4}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+change\+\_\+color@{amii\+\_\+change\+\_\+color}}
\index{amii\+\_\+change\+\_\+color@{amii\+\_\+change\+\_\+color}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+change\+\_\+color}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+change\+\_\+color (
\begin{DoxyParamCaption}
\item[{int}]{, }
\item[{long}]{, }
\item[{int}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a0de222c442d3c7dc50e972c1f4ab16d4}


Definition at line 1149 of file winreq.\+c.


\begin{DoxyCode}
1152 \{
1153     \textcolor{keywordflow}{if}( rev )
1154     \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.amii\_curmap[ pen ] = ~val;
1155     \textcolor{keywordflow}{else}
1156     \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.amii\_curmap[ pen ] = val;
1157 
1158     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen} )
1159     LoadRGB4( &\hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->ViewPort, \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.amii\_curmap, 
      \hyperlink{winext_8h_ae3cfaa8053fd2f089c9fe1ba90289e98}{amii\_numcolors} );
1160 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a1e49c8ee67a4421aa81f5679981a4d8d}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+cl\+\_\+end@{amii\+\_\+cl\+\_\+end}}
\index{amii\+\_\+cl\+\_\+end@{amii\+\_\+cl\+\_\+end}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+cl\+\_\+end}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+cl\+\_\+end (
\begin{DoxyParamCaption}
\item[{struct {\bf amii\+\_\+\+Win\+Desc} $\ast$}]{cw, }
\item[{int}]{i}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a1e49c8ee67a4421aa81f5679981a4d8d}


Definition at line 1817 of file winfuncs.\+c.



References panic(), and Text\+Spaces().



Referenced by amii\+\_\+doprev\+\_\+message(), amii\+\_\+putstr(), Display\+Data(), outmore(), and removetopl().


\begin{DoxyCode}
1820 \{
1821     \textcolor{keyword}{register} \textcolor{keyword}{struct }Window *w = cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
1822     \textcolor{keyword}{register} \textcolor{keywordtype}{int} oy, ox;
1823 
1824     \textcolor{keywordflow}{if}( !w )
1825     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"NULL window pointer in amii\_cl\_end()"});
1826 
1827     oy = w->RPort->cp\_y;
1828     ox = w->RPort->cp\_x;
1829 
1830     \hyperlink{winproto_8h_a948e00a84111ca94231f9b411ed7ec42}{TextSpaces}( w->RPort, cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} - \hyperlink{mactty_8c_a583dba93dfd738ae8a11a49b9b8e6085}{curs\_pos} );
1831 
1832     Move( w->RPort, ox, oy );
1833 \}
\end{DoxyCode}
\hypertarget{winproto_8h_aa0ab31344b2d7cf560f9c39c419139b7}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+cleanup@{amii\+\_\+cleanup}}
\index{amii\+\_\+cleanup@{amii\+\_\+cleanup}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+cleanup}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+cleanup (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_aa0ab31344b2d7cf560f9c39c419139b7}
\hypertarget{winproto_8h_ac2b43ff5e6b6394438fd8fde2008d264}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+clear\+\_\+nhwindow@{amii\+\_\+clear\+\_\+nhwindow}}
\index{amii\+\_\+clear\+\_\+nhwindow@{amii\+\_\+clear\+\_\+nhwindow}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+clear\+\_\+nhwindow}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+clear\+\_\+nhwindow (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{win}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ac2b43ff5e6b6394438fd8fde2008d264}


Definition at line 1414 of file winfuncs.\+c.



References amii\+\_\+clear\+\_\+nhwindow(), amii\+\_\+curs(), amii\+\_\+setfillpens(), amii\+\_\+wins, amii\+\_\+\+Win\+Desc\+::cols, cursor\+\_\+off(), amii\+\_\+\+Win\+Desc\+::curx, amii\+\_\+\+Win\+Desc\+::cury, F\+L\+M\+A\+P\+\_\+\+C\+U\+R\+S\+U\+P, N\+H\+W\+\_\+\+M\+A\+P, N\+H\+W\+\_\+\+M\+E\+N\+U, N\+H\+W\+\_\+\+M\+E\+S\+S\+A\+G\+E, N\+H\+W\+\_\+\+T\+E\+X\+T, N\+U\+L\+L, panic(), reclip, scrollmsg, Text\+Spaces(), amii\+\_\+\+Win\+Desc\+::type, amii\+\_\+\+Win\+Desc\+::wflags, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+M\+A\+P, W\+I\+N\+\_\+\+O\+V\+E\+R, winpanicstr, and W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V.



Referenced by amii\+\_\+clear\+\_\+nhwindow(), amii\+\_\+init\+\_\+nhwindows(), and amii\+\_\+start\+\_\+menu().


\begin{DoxyCode}
1416 \{
1417     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
1418     \textcolor{keyword}{register} \textcolor{keyword}{struct }Window *w;
1419 
1420     \textcolor{keywordflow}{if}( \hyperlink{winchar_8c_abaef652f2ecc14cf7257f91b8f5f0527}{reclip} == 2 ) \textcolor{keywordflow}{return};
1421 
1422     \textcolor{keywordflow}{if}( win == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} || ( cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[win] ) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
1423     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \hyperlink{winext_8h_a4264157ee8930111caf21b62c212e08c}{winpanicstr}, win, \textcolor{stringliteral}{"clear\_nhwindow"} );
1424 
1425     \textcolor{comment}{/* Clear the overview window too if it is displayed */}
1426     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} && ( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} && \hyperlink{winami_8h_a6a2b237abaae6aafe05c90be6d49d72e}{WIN\_OVER} != 
      \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && \hyperlink{winchar_8c_abaef652f2ecc14cf7257f91b8f5f0527}{reclip} == 0 ) )
1427     \{
1428     \hyperlink{winfuncs_8c_ac2b43ff5e6b6394438fd8fde2008d264}{amii\_clear\_nhwindow}( \hyperlink{winami_8h_a6a2b237abaae6aafe05c90be6d49d72e}{WIN\_OVER} );
1429     \}
1430 
1431     \textcolor{keywordflow}{if}( w = cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} )
1432     SetDrMd( w->RPort, JAM2);
1433     \textcolor{keywordflow}{else}
1434         \textcolor{keywordflow}{return};
1435 
1436     \textcolor{keywordflow}{if}( (cw->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} & \hyperlink{winami_8h_a7273e3f6e628faf1db9b852fc1c56729}{FLMAP\_CURSUP} ) )
1437     \{
1438     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} != \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP} )
1439         \hyperlink{winfuncs_8c_a21dcf06b1e3a62331c49092d9911f189}{cursor\_off}( win );
1440     \textcolor{keywordflow}{else}
1441         cw->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} &= ~\hyperlink{winami_8h_a7273e3f6e628faf1db9b852fc1c56729}{FLMAP\_CURSUP};
1442     \}
1443 
1444     \hyperlink{winfuncs_8c_a4df453dcf15e61612e6e06b40279d5d8}{amii\_setfillpens}( w, cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} );
1445     SetDrMd( w->RPort, JAM2 );
1446 
1447     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU} || cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT} )
1448     \{
1449     RectFill( w->RPort, w->BorderLeft, w->BorderTop,
1450       w->Width - w->BorderRight-1,
1451       w->Height - w->BorderBottom-1 );
1452     \}
1453     \textcolor{keywordflow}{else}
1454     \{
1455     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} )
1456     \{
1457         \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}( win, 1, 0 );
1458         \textcolor{keywordflow}{if}( !\hyperlink{winext_8h_a3b783f5f077454f156585be54b99746b}{scrollmsg} )
1459         \hyperlink{winproto_8h_a948e00a84111ca94231f9b411ed7ec42}{TextSpaces}( w->RPort, cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} );
1460     \}
1461     \textcolor{keywordflow}{else}
1462     \{
1463         RectFill( w->RPort, w->BorderLeft, w->BorderTop,
1464           w->Width - w->BorderRight-1,
1465           w->Height - w->BorderBottom-1 );
1466     \}
1467     \}
1468 
1469     cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury} = 0;
1470     cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} = 0;
1471     \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}( win, 1, 0 );
1472 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ab842f92a372d2e1e20a0538937488950}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+cliparound@{amii\+\_\+cliparound}}
\index{amii\+\_\+cliparound@{amii\+\_\+cliparound}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+cliparound}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+cliparound (
\begin{DoxyParamCaption}
\item[{int}]{x, }
\item[{int}]{y}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ab842f92a372d2e1e20a0538937488950}


Definition at line 2249 of file winfuncs.\+c.



References amii\+\_\+wins, C\+O, C\+O\+L\+N\+O, cursor\+\_\+off(), doredraw(), flush\+\_\+glyph\+\_\+buffer(), Is\+\_\+rogue\+\_\+level, L\+I, max, min, moves, mxsize, mysize, reclip, restoring, R\+O\+W\+N\+O, u, you\+::uz, you\+::uz0, amii\+\_\+\+Win\+Desc\+::win, and W\+I\+N\+\_\+\+M\+A\+P.


\begin{DoxyCode}
2251 \{
2252     \textcolor{keyword}{extern} \textcolor{keywordtype}{boolean} \hyperlink{decl_8h_a7033dc2d60ad2928ce6551e80e98372d}{restoring};
2253 \textcolor{preprocessor}{#ifdef  CLIPPING}
2254     \textcolor{keywordtype}{int} oldx = clipx, oldy = clipy;
2255     \textcolor{keywordtype}{int} oldxmax = clipxmax, oldymax = clipymax;
2256     \textcolor{keywordtype}{int} COx, LIx;
2257 \textcolor{preprocessor}{#define SCROLLCNT   1   }\textcolor{comment}{/* Get there in 3 moves... */}\textcolor{preprocessor}{}
2258     \textcolor{keywordtype}{int} scrollcnt = SCROLLCNT;  \textcolor{comment}{/* ...or 1 if we changed level */}
2259     \textcolor{keywordflow}{if} (!clipping)      \textcolor{comment}{/* And 1 in anycase, cleaner, simpler, quicker */}
2260     \textcolor{keywordflow}{return};
2261 
2262     \textcolor{keywordflow}{if}(\hyperlink{dungeon_8h_a2732117523c8540638daf4315dda16b9}{Is\_rogue\_level}(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}))\{
2263     \textcolor{keyword}{struct }Window *w = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[\hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP}]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
2264     \textcolor{keyword}{struct }RastPort *\hyperlink{amirip_8c_aa0639b6491ec144930d14703053f32a4}{rp} = w->RPort;
2265 
2266     COx = (w->Width-w->BorderLeft-w->BorderRight)/rp->TxWidth;
2267     LIx = (w->Height-w->BorderTop-w->BorderBottom)/rp->TxHeight;
2268     \}\textcolor{keywordflow}{else}\{
2269     COx = \hyperlink{winext_8h_abdcb66bae1fc240beb333f1932bdc30d}{CO};
2270     LIx = \hyperlink{winext_8h_a4952935dee70ae06274495dcddf10856}{LI};
2271     \}
2272         \textcolor{comment}{/*}
2273 \textcolor{comment}{         * On a level change, move the clipping region so that for a}
2274 \textcolor{comment}{         * reasonablely large window extra motion is avoided; for}
2275 \textcolor{comment}{         * the rogue level hopefully this means no motion at all.}
2276 \textcolor{comment}{         */}
2277     \{
2278     \textcolor{keyword}{static} \hyperlink{structd__level}{d\_level} saved\_level = \{127,127\};      \textcolor{comment}{/* XXX */}
2279 
2280     \textcolor{keywordflow}{if}(!on\_level(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}, &saved\_level))\{
2281         scrollcnt = 1;  \textcolor{comment}{/* jump with blanking */}
2282         clipx=clipy=0;
2283         clipxmax = COx; clipymax = LIx;
2284         saved\_level = \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz};      \textcolor{comment}{/* save as new current level */}
2285     \}
2286     \}
2287 
2288     \textcolor{keywordflow}{if} (x <= clipx + xclipbord ) \{
2289     clipx = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, x - (clipxmax - clipx)/2 );
2290     clipxmax = clipx + COx;
2291     \}
2292     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (x > clipxmax - xclipbord ) \{
2293     clipxmax = \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}, x + (clipxmax - clipx)/2 );
2294     clipx = clipxmax - COx;
2295     \}
2296 
2297     \textcolor{keywordflow}{if} (y <= clipy + yclipbord ) \{
2298     clipy = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(0, y - (clipymax - clipy) / 2);
2299     clipymax = clipy + LIx;
2300     \}
2301     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (y > clipymax - yclipbord ) \{
2302     clipymax = \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}, y + (clipymax - clipy) / 2);
2303     clipy = clipymax - LIx;
2304     \}
2305 
2306     \hyperlink{winchar_8c_abaef652f2ecc14cf7257f91b8f5f0527}{reclip} = 1;
2307     \textcolor{keywordflow}{if} (clipx != oldx || clipy != oldy || clipxmax != oldxmax || clipymax != oldymax )
2308     \{
2309 \textcolor{preprocessor}{#ifndef NOSCROLLRASTER}
2310         \textcolor{keyword}{struct }Window *w = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
2311         \textcolor{keyword}{struct }RastPort *\hyperlink{amirip_8c_aa0639b6491ec144930d14703053f32a4}{rp} = w->RPort;
2312         \textcolor{keywordtype}{int} xdelta, ydelta, xmod, ymod, i;
2313         \textcolor{keywordtype}{int} incx, incy, mincx, mincy;
2314         \textcolor{keywordtype}{int} savex, savey, savexmax, saveymax;
2315     \textcolor{keywordtype}{int} scrx, scry;
2316 
2317     \textcolor{keywordflow}{if}(\hyperlink{dungeon_8h_a2732117523c8540638daf4315dda16b9}{Is\_rogue\_level}(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}))\{
2318         scrx = rp->TxWidth;
2319         scry = rp->TxHeight;
2320     \} \textcolor{keywordflow}{else} \{
2321         scrx = \hyperlink{winfuncs_8c_afba9a8d2cd024c7010eae489091d11d6}{mxsize};
2322         scry = \hyperlink{winfuncs_8c_a9703aea67c83633a25beaa737dad2b65}{mysize};
2323     \}
2324 
2325     \textcolor{comment}{/* Ask that the glyph routines not draw the overview window */}
2326     \hyperlink{winchar_8c_abaef652f2ecc14cf7257f91b8f5f0527}{reclip} = 2;
2327     \hyperlink{winfuncs_8c_a21dcf06b1e3a62331c49092d9911f189}{cursor\_off}( \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} );
2328 
2329     \textcolor{comment}{/* Compute how far we are moving in terms of tiles */}
2330     mincx = clipx - oldx ;
2331     mincy = clipy - oldy ;
2332 
2333     \textcolor{comment}{/* How many tiles to get there in SCROLLCNT moves */}
2334     incx = ( clipx - oldx )/scrollcnt;
2335     incy = ( clipy - oldy )/scrollcnt;
2336 
2337     \textcolor{comment}{/* If less than SCROLLCNT tiles, then move by 1 tile if moving at all */}
2338     \textcolor{keywordflow}{if}( incx == 0 ) incx = (mincx != 0);
2339     \textcolor{keywordflow}{if}( incy == 0 ) incy = (mincy != 0);
2340 
2341     \textcolor{comment}{/* Get count of pixels to move each iteration and final pixel count */}
2342         xdelta = ((clipx-oldx )*scrx) / scrollcnt;
2343         xmod = ((clipx-oldx )*scrx) % scrollcnt;
2344         ydelta = ((clipy-oldy )*scry) / scrollcnt;
2345         ymod = ((clipy-oldy )*scry) % scrollcnt;
2346 
2347     \textcolor{comment}{/* Preserve the final move location */}
2348         savex = clipx;
2349         savey = clipy;
2350     saveymax = clipymax;
2351     savexmax = clipxmax;
2352 
2353     \textcolor{comment}{/*}
2354 \textcolor{comment}{     * Set clipping rectangle to be just the region that will be exposed so}
2355 \textcolor{comment}{     * that drawing will be faster}
2356 \textcolor{comment}{     */}
2357 \textcolor{preprocessor}{#if 0   }\textcolor{comment}{/* Doesn't seem to work quite the way it should */}\textcolor{preprocessor}{}
2358     \textcolor{comment}{/* In some cases hero is 'centered' offscreen */}
2359     \textcolor{keywordflow}{if}( xdelta < 0 )
2360     \{
2361         clipx = oldx;
2362         clipxmax = clipx + incx;
2363     \}
2364     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( xdelta > 0 )
2365     \{
2366         clipxmax = oldxmax;
2367         clipx = clipxmax - incx;
2368     \}
2369     \textcolor{keywordflow}{else}
2370     \{
2371         clipx = oldx;
2372         clipxmax = oldxmax;
2373     \}
2374 
2375     \textcolor{keywordflow}{if}( ydelta < 0 )
2376     \{
2377         clipy = oldy;
2378         clipymax = clipy + incy;
2379     \}
2380     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( ydelta > 0 )
2381     \{
2382         clipymax = oldymax;
2383         clipy = clipymax - incy;
2384     \}
2385     \textcolor{keywordflow}{else}
2386     \{
2387         clipy = oldy;
2388         clipymax = oldymax;
2389     \}
2390 \textcolor{preprocessor}{#endif}
2391     \textcolor{comment}{/* Now, in scrollcnt moves, move the picture toward the final view */}
2392         \textcolor{keywordflow}{for}( i = 0; i < scrollcnt; ++i )
2393         \{
2394 \textcolor{preprocessor}{#ifdef  DISPMAP}
2395         \textcolor{keywordflow}{if}( i == scrollcnt - 1 && (xmod != 0 || ymod != 0) &&
2396             (xdelta != 0 || ydelta != 0) )
2397         \{
2398         incx += (clipx - oldx)%scrollcnt;
2399         incy += (clipy - oldy)%scrollcnt;
2400         xdelta += xmod;
2401         ydelta += ymod;
2402         \}
2403 \textcolor{preprocessor}{#endif}
2404         \textcolor{comment}{/* Scroll the raster if we are scrolling */}
2405         \textcolor{keywordflow}{if}( xdelta != 0 || ydelta != 0 )
2406         \{
2407         ScrollRaster( rp, xdelta, ydelta,
2408                 w->BorderLeft, w->BorderTop,
2409                 w->Width - w->BorderRight - 1,
2410                 w->Height - w->BorderBottom - 1 );
2411 
2412         \textcolor{keywordflow}{if}( mincx == 0 ) incx = 0;
2413         \textcolor{keywordflow}{else} mincx -= incx;
2414 
2415         clipx += incx;
2416         clipxmax += incx;
2417 
2418         \textcolor{keywordflow}{if}( mincy == 0 ) incy = 0;
2419         \textcolor{keywordflow}{else} mincy -= incy;
2420 
2421         clipy += incy;
2422         clipymax += incy;
2423 
2424         \textcolor{comment}{/* Draw the exposed portion */}
2425         \textcolor{keywordflow}{if} (on\_level(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a91637ade745880be0af66e4c0b0ff1c1}{uz0}, &\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}) && !restoring)
2426             (void) \hyperlink{display_8c_abf432a93fec9c94db8570f8a2c01468e}{doredraw}();
2427         \hyperlink{winchar_8c_aedd7ad0350a58b8fca664bcbdc5f1f35}{flush\_glyph\_buffer}( \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} ]->win );
2428         \}
2429         \}
2430 
2431         clipx = savex;
2432         clipy = savey;
2433     clipymax = saveymax;
2434     clipxmax = savexmax;
2435 \textcolor{preprocessor}{#endif}
2436     \textcolor{keywordflow}{if} (on\_level(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a91637ade745880be0af66e4c0b0ff1c1}{uz0}, &\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}) && !restoring && \hyperlink{decl_8h_a2ccad6e8fb93740ed50c6d9a8f72ce2f}{moves} > 1)
2437         (void) \hyperlink{display_8c_abf432a93fec9c94db8570f8a2c01468e}{doredraw}();
2438     \hyperlink{winchar_8c_aedd7ad0350a58b8fca664bcbdc5f1f35}{flush\_glyph\_buffer}( \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} ]->win );
2439     \}
2440     \hyperlink{winchar_8c_abaef652f2ecc14cf7257f91b8f5f0527}{reclip} = 0;
2441 \textcolor{preprocessor}{#endif}
2442 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ad2252169a553a59a47299eed01b9b9ee}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+create\+\_\+nhwindow@{amii\+\_\+create\+\_\+nhwindow}}
\index{amii\+\_\+create\+\_\+nhwindow@{amii\+\_\+create\+\_\+nhwindow}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+create\+\_\+nhwindow}]{\setlength{\rightskip}{0pt plus 5cm}int amii\+\_\+create\+\_\+nhwindow (
\begin{DoxyParamCaption}
\item[{int}]{type}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ad2252169a553a59a47299eed01b9b9ee}


Definition at line 317 of file winfuncs.\+c.



References Abort(), amii\+\_\+\+Win\+Desc\+::active, alloc(), amii\+\_\+oldmsg, amii\+\_\+oldover, amii\+\_\+setclipped(), amii\+\_\+wins, ami\+I\+Display, bigscreen, buf, C\+\_\+\+B\+L\+A\+C\+K, C\+\_\+\+G\+R\+E\+Y\+B\+L\+U\+E, C\+\_\+\+W\+H\+I\+T\+E, amii\+\_\+\+Win\+Desc\+::canresp, C\+O, amii\+\_\+\+Win\+Desc\+::cols, amii\+\_\+\+Display\+Desc\+::cols, Console\+I\+O, amii\+\_\+\+Win\+Desc\+::curx, amii\+\_\+\+Win\+Desc\+::cury, amii\+\_\+\+Win\+Desc\+::data, F\+A\+L\+S\+E, fillhook, Hack\+Font, H\+A\+C\+K\+F\+O\+N\+T, Hack\+Port, Hack\+Screen, Height, amii\+\_\+\+Win\+Desc\+::hook, iflags, Kbd\+Buffered, Layer\+Fill\+Hook(), L\+I, amii\+\_\+\+Win\+Desc\+::maxcol, win\+\_\+setup\+::maxcol, amii\+\_\+\+Win\+Desc\+::maxrow, win\+\_\+setup\+::maxrow, M\+A\+X\+W\+I\+N, Menu\+Scroll, Menu\+Strip, amii\+\_\+\+Win\+Desc\+::morestr, instance\+\_\+flags\+::msg\+\_\+history, Msg\+Prop\+Scroll, Msg\+Scroll, mxsize, mysize, new\+\_\+wins, amii\+\_\+\+Win\+Desc\+::newwin, win\+\_\+setup\+::newwin, N\+H\+W\+\_\+\+B\+A\+S\+E, N\+H\+W\+\_\+\+M\+A\+P, N\+H\+W\+\_\+\+M\+E\+N\+U, N\+H\+W\+\_\+\+M\+E\+S\+S\+A\+G\+E, N\+H\+W\+\_\+\+O\+V\+E\+R, N\+H\+W\+\_\+\+S\+T\+A\+T\+U\+S, N\+H\+W\+\_\+\+T\+E\+X\+T, N\+U\+L\+L, Open\+Sh\+Window(), panic(), pr\+\_\+\+Window\+Ptr, Prop\+Scroll, raw\+\_\+print, amii\+\_\+\+Win\+Desc\+::resp, Rogue\+Font, amii\+\_\+\+Win\+Desc\+::rows, scrollmsg, Texts\+Font, T\+R\+U\+E, txbaseline, txheight, txwidth, amii\+\_\+\+Win\+Desc\+::type, type, wd, amii\+\_\+\+Win\+Desc\+::wflags, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+B\+A\+S\+E, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+M\+A\+P, W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E, W\+I\+N\+\_\+\+S\+T\+A\+T\+U\+S, wincnt, instance\+\_\+flags\+::window\+\_\+inited, amii\+\_\+\+Win\+Desc\+::wintags, wintags, W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+I, W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V, amii\+\_\+\+Display\+Desc\+::xpix, and amii\+\_\+\+Display\+Desc\+::ypix.



Referenced by amii\+\_\+init\+\_\+nhwindows(), and amii\+\_\+putstr().


\begin{DoxyCode}
319 \{
320     \textcolor{keyword}{register} \textcolor{keyword}{struct }Window *w = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
321     \textcolor{keyword}{register} \textcolor{keyword}{struct }NewWindow *nw = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
322     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *\hyperlink{celib_8c_a083a2d27d21ee31bc447f1d4260b94ba}{wd} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
323     \textcolor{keyword}{struct }Window *mapwin = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, *stwin = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, *msgwin = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
324     \textcolor{keyword}{register} \textcolor{keywordtype}{int} newid;
325     \textcolor{keywordtype}{int} maph, stath, scrfontysize;
326 
327     scrfontysize = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->Font->ta\_YSize;
328 
329     \textcolor{comment}{/*}
330 \textcolor{comment}{     * Initial mapwindow height, this might change later in tilemode}
331 \textcolor{comment}{     * and low screen}
332 \textcolor{comment}{     */}
333     maph = ( 21 * \hyperlink{winfuncs_8c_afba9a8d2cd024c7010eae489091d11d6}{mxsize} ) + 2 + (\hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} ?
334     \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->WBorTop + \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->WBorBottom + scrfontysize + 1 : 0);
335 
336     \textcolor{comment}{/* Status window height, avoids having to calculate many times */}
337     stath = \hyperlink{winext_8h_afdf567214d70875e5c17efe40a02b53a}{txheight} * 2 + 2 + (\hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} || \hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} ?
338     \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->WBorTop + \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->WBorBottom +
339     ( \hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} ? scrfontysize + 1 : 0 ) : 0);
340 
341     \textcolor{keywordflow}{if}( \hyperlink{decl_8h_ae0690a38fd295760409995ce03b88329}{WIN\_STATUS} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_ae0690a38fd295760409995ce03b88329}{WIN\_STATUS} ] )
342     stwin = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_ae0690a38fd295760409995ce03b88329}{WIN\_STATUS} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
343 
344     \textcolor{keywordflow}{if}( \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ 
      \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} ] )
345     msgwin = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
346 
347     \textcolor{keywordflow}{if}( \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} ] )
348     mapwin = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
349 
350     \textcolor{comment}{/* Create Port anytime that we need it */}
351 
352     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a392c49118e04b9257df71fca005829e0}{HackPort} == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
353     \{
354     \hyperlink{winext_8h_a392c49118e04b9257df71fca005829e0}{HackPort} = CreateMsgPort();
355     \textcolor{keywordflow}{if}( !\hyperlink{winext_8h_a392c49118e04b9257df71fca005829e0}{HackPort} )
356         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \textcolor{stringliteral}{"no memory for msg port"} );
357     \}
358 
359     nw = &\hyperlink{winext_8h_a2b4f8d028c6b8c047e86aa0c49348f36}{new\_wins}[ \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} ].\hyperlink{structwin__setup_a274eccbc444f827a7db33a83c4f4ec70}{newwin};
360     nw->Width = \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix};
361     nw->Screen = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen};
362 
363     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
364     \{
365     nw->DetailPen = \hyperlink{windefs_8h_a67fead37547ff67ca0a269d712e87822}{C\_WHITE};
366     nw->BlockPen = \hyperlink{windefs_8h_ac90add32f96ca4f82528fd6195b47157}{C\_GREYBLUE};
367     \}
368     \textcolor{keywordflow}{else}
369     \{
370     nw->DetailPen = \hyperlink{windefs_8h_a67fead37547ff67ca0a269d712e87822}{C\_WHITE};
371     nw->BlockPen = \hyperlink{windefs_8h_a22a9543e081938a146a8bce60a84200a}{C\_BLACK};
372     \}
373 
374     \textcolor{keywordflow}{if} ( \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} == \hyperlink{macwin_8h_ab575e634e51462bf534b7ee541cefc46}{NHW\_BASE} ) \{
375     nw->LeftEdge = 0;
376     nw->TopEdge = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->BarHeight+1;
377     nw->Width = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->Width;
378     nw->Height = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->Height - nw->TopEdge;
379     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( !\hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} && \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} == \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP} ) \{
380     nw->LeftEdge = 0;
381     nw->Height = maph;
382 
383     \textcolor{keywordflow}{if}( msgwin && stwin ) \{
384         nw->TopEdge = stwin->TopEdge - maph;
385     \} \textcolor{keywordflow}{else} \{
386         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \textcolor{stringliteral}{"msgwin and stwin must open before map"} );
387     \}
388     \textcolor{keywordflow}{if} (nw->TopEdge < 0)
389         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \textcolor{stringliteral}{"Too small screen to fit map"} );
390     \}
391     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} == \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP} && \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
392     \{
393     \textcolor{keyword}{struct }Window *w;
394 
395     w = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
396     nw->LeftEdge = 0;
397     nw->TopEdge = w->TopEdge + w->Height;
398     nw->Width = \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} - nw->LeftEdge;
399 
400     w = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_ae0690a38fd295760409995ce03b88329}{WIN\_STATUS} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
401     nw->Height = w->TopEdge - nw->TopEdge;
402     nw->MaxHeight = 0xffff;
403     nw->MaxWidth = 0xffff;
404 
405     \textcolor{keywordflow}{if}( nw->TopEdge + nw->Height > \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} - 1 )
406         nw->Height = \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} - nw->TopEdge - 1;
407     \}
408     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} == \hyperlink{wintype_8h_a8ed5b99ab7f854ace5f67f89aaae5404}{NHW\_STATUS} )
409     \{
410     \textcolor{keywordflow}{if}( !\hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} && ( WIN\_MAP != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ WIN\_MAP ] ) )
411         w = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
412     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE} ] )
413         w = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
414     \textcolor{keywordflow}{else}
415         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \textcolor{stringliteral}{"No window to base STATUS location from"} );
416 
417     nw->Height = stath;
418     nw->TopEdge = \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} - nw->Height;
419     nw->LeftEdge = w->LeftEdge;
420 
421     \textcolor{keywordflow}{if}( nw->LeftEdge + nw->Width >= \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} )
422         nw->LeftEdge = 0;
423 
424     \textcolor{keywordflow}{if}( nw->Width >= \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} - nw->LeftEdge )
425         nw->Width = \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} - nw->LeftEdge;
426     \}
427     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} && \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} == \hyperlink{winami_8h_ade6ff25a1de12300d538d40c306f4b2a}{NHW\_OVER} )
428     \{
429     nw->Flags |= WINDOWSIZING|WINDOWDRAG|WINDOWCLOSE;
430     nw->IDCMPFlags |= CLOSEWINDOW;
431     \textcolor{comment}{/* Bring up window as half the width of the message window, and make}
432 \textcolor{comment}{     * the message window change to one half the width...}
433 \textcolor{comment}{     */}
434     \textcolor{keywordflow}{if}( \hyperlink{winfuncs_8c_a0a7c9ea82e04a8326edfd11f48eae0aa}{amii\_oldover}.MaxX != 0 )
435     \{
436         nw->LeftEdge = \hyperlink{winfuncs_8c_a0a7c9ea82e04a8326edfd11f48eae0aa}{amii\_oldover}.MinX;
437         nw->TopEdge = \hyperlink{winfuncs_8c_a0a7c9ea82e04a8326edfd11f48eae0aa}{amii\_oldover}.MinY;
438         nw->Width = \hyperlink{winfuncs_8c_a0a7c9ea82e04a8326edfd11f48eae0aa}{amii\_oldover}.MaxX;
439         nw->Height = \hyperlink{winfuncs_8c_a0a7c9ea82e04a8326edfd11f48eae0aa}{amii\_oldover}.MaxY;
440         ChangeWindowBox( \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ WIN\_MESSAGE ]->win,
441             \hyperlink{winfuncs_8c_abf1a8ff4e563d7d084463a3b9c8a4171}{amii\_oldmsg}.MinX, \hyperlink{winfuncs_8c_abf1a8ff4e563d7d084463a3b9c8a4171}{amii\_oldmsg}.MinY,
442             \hyperlink{winfuncs_8c_abf1a8ff4e563d7d084463a3b9c8a4171}{amii\_oldmsg}.MaxX, \hyperlink{winfuncs_8c_abf1a8ff4e563d7d084463a3b9c8a4171}{amii\_oldmsg}.MaxY );
443     \}
444     \textcolor{keywordflow}{else}
445     \{
446         nw->LeftEdge = (\hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}->Width*4)/9;
447         nw->TopEdge = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}->TopEdge;
448         nw->Width = \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} - nw->LeftEdge;
449         nw->Height = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}->Height;
450         SizeWindow( \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ WIN\_MESSAGE ]->win,
451             nw->LeftEdge - \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ WIN\_MESSAGE ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}->Width, 0 );
452     \}
453     \}
454     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} )
455     \{
456     \textcolor{keywordflow}{if}( !\hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} && ( WIN\_MAP != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ WIN\_MAP ] ) )
457         w = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
458     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( WIN\_BASE != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ WIN\_BASE ] )
459         w = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
460     \textcolor{keywordflow}{else}
461         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \textcolor{stringliteral}{"No window to base STATUS location from"} );
462 
463     nw->TopEdge = \hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} ? \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->BarHeight+1 : 0;
464 
465     \textcolor{comment}{/* Assume highest possible message window */}
466     nw->Height = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->Height - nw->TopEdge - maph - stath;
467 
468     \textcolor{comment}{/* In tilemode we can cope with this */}
469     \textcolor{keywordflow}{if} (\hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} && nw->Height < 0)
470         nw->Height = 0;
471 
472     \textcolor{comment}{/* If in fontmode messagewindow is too small, open it with 3 lines}
473 \textcolor{comment}{       and overlap it with map */}
474     \textcolor{keywordflow}{if} (nw->Height < \hyperlink{winext_8h_afdf567214d70875e5c17efe40a02b53a}{txheight}+2) \{
475         nw->Height = \hyperlink{winext_8h_afdf567214d70875e5c17efe40a02b53a}{txheight}*4 + 3 + \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->WBorTop + 
      \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->WBorBottom;
476     \}
477 
478     \textcolor{keywordflow}{if} ((nw->Height-2)/\hyperlink{winext_8h_afdf567214d70875e5c17efe40a02b53a}{txheight} < 3) \{
479         \hyperlink{winext_8h_a3b783f5f077454f156585be54b99746b}{scrollmsg} = 0;
480         nw->Title = 0;
481     \} \textcolor{keywordflow}{else} \{
482         nw->FirstGadget = &\hyperlink{winext_8h_a7714cdb5ca9e060cae6bfc059f1973f4}{MsgScroll};
483         nw->Flags |= WINDOWSIZING|WINDOWDRAG;
484         nw->Flags &= ~BORDERLESS;
485 
486         \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} || nw->Height == 0) \{
487         \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} ) \{
488             nw->Height = \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_YSize + \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->WBorTop + 3 +
489                 \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->WBorBottom;
490             \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} )
491             nw->Height += ( \hyperlink{winext_8h_afdf567214d70875e5c17efe40a02b53a}{txheight} * 6 );
492             \textcolor{keywordflow}{else}
493             nw->Height += ( \hyperlink{winext_8h_afdf567214d70875e5c17efe40a02b53a}{txheight} * 3 );
494         \}
495         \textcolor{keywordflow}{else}
496         \{
497             nw->Height = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->Height - nw->TopEdge - stath - maph;
498         \}
499         \}
500     \}
501 
502     \textcolor{comment}{/* Do we have room for larger message window ?}
503 \textcolor{comment}{     * This is possible if we can show full height map in tile}
504 \textcolor{comment}{     * mode with default scaling.}
505 \textcolor{comment}{     */}
506     \textcolor{keywordflow}{if} (nw->Height + stath + maph < HackScreen->\hyperlink{txt2iff_8c_aaadefba794062a2ca7e58ceb10b955a1}{Height} - nw->TopEdge )
507         nw->Height = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->Height - nw->TopEdge - 1 - maph - stath;
508 
509 \textcolor{preprocessor}{#ifdef  INTUI\_NEW\_LOOK}
510     \textcolor{keywordflow}{if}( IntuitionBase->LibNode.lib\_Version >= 37 )
511     \{
512         \hyperlink{winext_8h_acdba525e6ace0e1086dd878da6fd4cd7}{MsgPropScroll}.Flags |= PROPNEWLOOK;
513         \hyperlink{winext_8h_ac03b382c1a8a8d6748fc7bfe920e0ec2}{PropScroll}.Flags |= PROPNEWLOOK;
514     \}
515 \textcolor{preprocessor}{#endif}
516     \}
517 
518     nw->IDCMPFlags |= MENUPICK;
519 
520     \textcolor{comment}{/* Check if there is "Room" for all this stuff... */}
521     \textcolor{keywordflow}{if}( ( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} || \hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} ) &&
522     \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} != \hyperlink{macwin_8h_ab575e634e51462bf534b7ee541cefc46}{NHW\_BASE} )
523     \{
524     nw->Flags &= ~( BORDERLESS | BACKDROP );
525 
526     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
527     \{
528         \textcolor{keywordflow}{if}( \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} == \hyperlink{wintype_8h_a8ed5b99ab7f854ace5f67f89aaae5404}{NHW\_STATUS} )
529         \{
530         nw->Flags &= ~( WINDOWDRAG | WINDOWDEPTH | SIZEBRIGHT | WINDOWSIZING );
531         nw->IDCMPFlags &= ~NEWSIZE;
532         \}
533         \textcolor{keywordflow}{else}
534         \{
535         nw->Flags |= ( WINDOWDRAG | WINDOWDEPTH | SIZEBRIGHT | WINDOWSIZING );
536         nw->IDCMPFlags |= NEWSIZE;
537         \}
538     \}
539     \textcolor{keywordflow}{else}
540     \{
541         \textcolor{keywordflow}{if}( \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->Width < 657 )
542         \{
543         nw->Flags |= ( WINDOWDRAG | WINDOWDEPTH );
544         \}
545         \textcolor{keywordflow}{else}
546         \{
547         nw->Flags |= ( WINDOWDRAG | WINDOWDEPTH | SIZEBRIGHT );
548         \}
549     \}
550     \}
551 
552     \textcolor{keywordflow}{if} ( \hyperlink{windefs_8h_adf1601afd1e2d6555110cd79bbbf4705}{WINVERS\_AMII} && \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} == \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP} )
553     nw->Flags &= ~WINDOWSIZING;
554 
555     \textcolor{keywordflow}{if} ( \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} && \hyperlink{winext_8h_a3b783f5f077454f156585be54b99746b}{scrollmsg} ) \{
556     nw->Flags |= WINDOWDRAG|WINDOWDEPTH|SIZEBRIGHT|WINDOWSIZING;
557     nw->Flags &= ~BORDERLESS;
558     \}
559 
560     \textcolor{comment}{/* No titles on a hires only screen except for messagewindow */}
561     \textcolor{keywordflow}{if}( !(\hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} && \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} == \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP}) && !\hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} && 
      \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} != \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} )
562     nw->Title = 0;
563 
564     wd = (\textcolor{keyword}{struct} \hyperlink{structamii__WinDesc}{amii\_WinDesc} *)\hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(\textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} 
      \hyperlink{structamii__WinDesc}{amii\_WinDesc}));
565     memset( wd, 0, \textcolor{keyword}{sizeof}( \textcolor{keyword}{struct} \hyperlink{structamii__WinDesc}{amii\_WinDesc} ) );
566 
567     \textcolor{comment}{/* Both, since user may have changed the pen settings so respect those */}
568     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_adf1601afd1e2d6555110cd79bbbf4705}{WINVERS\_AMII} || \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
569     \{
570     \textcolor{comment}{/* Special backfill for these types of layers */}
571     \textcolor{keywordflow}{switch}( \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} )
572     \{
573     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE}:
574     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a8ed5b99ab7f854ace5f67f89aaae5404}{NHW\_STATUS}:
575     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT}:
576     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU}:
577     \textcolor{keywordflow}{case} \hyperlink{macwin_8h_ab575e634e51462bf534b7ee541cefc46}{NHW\_BASE}:
578     \textcolor{keywordflow}{case} \hyperlink{winami_8h_ade6ff25a1de12300d538d40c306f4b2a}{NHW\_OVER}:
579     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP}:
580         \textcolor{keywordflow}{if}( wd )
581         \{
582 \textcolor{preprocessor}{#ifdef \_\_GNUC\_\_}
583         \hyperlink{winext_8h_a6ff9485e071d0a750346503394100a89}{fillhook}.h\_Entry = (\textcolor{keywordtype}{void} *)&\hyperlink{winext_8h_a9e524533351c8e043ccc43941ad1055f}{LayerFillHook};
584 \textcolor{preprocessor}{#else}
585         \hyperlink{winext_8h_a6ff9485e071d0a750346503394100a89}{fillhook}.h\_Entry = (\hyperlink{def__os2_8h_af632da489ebc3708ec3ab6791ee53fa4}{ULONG}(*)())\hyperlink{winext_8h_a9e524533351c8e043ccc43941ad1055f}{LayerFillHook};
586 \textcolor{preprocessor}{#endif}
587         \hyperlink{winext_8h_a6ff9485e071d0a750346503394100a89}{fillhook}.h\_Data = (\textcolor{keywordtype}{void} *)\hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type};
588         \hyperlink{winext_8h_a6ff9485e071d0a750346503394100a89}{fillhook}.h\_SubEntry = 0;
589         wd->\hyperlink{structamii__WinDesc_a95adbcba37257f02f7d9b3e5ef4c8411}{hook} = \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}( \textcolor{keyword}{sizeof}( \hyperlink{winext_8h_a6ff9485e071d0a750346503394100a89}{fillhook} ) );
590         memcpy( wd->\hyperlink{structamii__WinDesc_a95adbcba37257f02f7d9b3e5ef4c8411}{hook}, &\hyperlink{winext_8h_a6ff9485e071d0a750346503394100a89}{fillhook}, \textcolor{keyword}{sizeof}( \hyperlink{winext_8h_a6ff9485e071d0a750346503394100a89}{fillhook} ) );
591         memcpy( wd->\hyperlink{structamii__WinDesc_a982df47148570e92162c13c1d158ef1b}{wintags}, \hyperlink{winext_8h_af89b1b4ca5e09b3b019caabfbf2243cd}{wintags}, \textcolor{keyword}{sizeof}( wd->\hyperlink{structamii__WinDesc_a982df47148570e92162c13c1d158ef1b}{wintags}) );
592         wd->\hyperlink{structamii__WinDesc_a982df47148570e92162c13c1d158ef1b}{wintags}[0].ti\_Data = (long)wd->\hyperlink{structamii__WinDesc_a95adbcba37257f02f7d9b3e5ef4c8411}{hook};
593         nw->Extension = (\textcolor{keywordtype}{void} *)wd->\hyperlink{structamii__WinDesc_a982df47148570e92162c13c1d158ef1b}{wintags};
594         \}
595         \textcolor{keywordflow}{break};
596     \}
597     \}
598 
599     \textcolor{comment}{/* Don't open MENU or TEXT windows yet */}
600 
601     \textcolor{keywordflow}{if}( \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} == \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU} || \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} == \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT} )
602     w = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
603     \textcolor{keywordflow}{else}
604     w=\hyperlink{winproto_8h_a4fbda1b274fbd7f990be789cfbb8fd52}{OpenShWindow}( (\textcolor{keywordtype}{void} *)nw );
605 
606     \textcolor{keywordflow}{if}( w == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} != \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU} && \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} != \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT} )
607     \{
608     \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[ 100 ];
609 
610     sprintf( buf, \textcolor{stringliteral}{"nw type (%d) dims l: %d, t: %d, w: %d, h: %d"},
611         \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type},
612         nw->LeftEdge, nw->TopEdge,
613         nw->Width, nw->Height );
614     \hyperlink{winprocs_8h_a49dffdcae248bae8b370f76b434ce744}{raw\_print}( buf );
615     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"bad openwin %d"},\hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type});
616     \}
617 
618     \textcolor{comment}{/* Check for an empty slot */}
619 
620     \textcolor{keywordflow}{for}(newid = 0; newid<\hyperlink{winami_8h_a0882b20213d1ebf14d860e611d06cf36}{MAXWIN} + 1; newid++)
621     \{
622     \textcolor{keywordflow}{if}(\hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[newid] == 0)
623         \textcolor{keywordflow}{break};
624     \}
625 
626     \textcolor{keywordflow}{if}(newid==MAXWIN+1)
627     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"time to write re-alloc code\(\backslash\)n"});
628 
629     \textcolor{comment}{/* Set wincnt accordingly */}
630 
631     \textcolor{keywordflow}{if}( newid > \hyperlink{winext_8h_a30dc3fadf33c084cd14b5632ce7a4002}{wincnt} )
632     \hyperlink{winext_8h_a30dc3fadf33c084cd14b5632ce7a4002}{wincnt} = newid;
633 
634     \textcolor{comment}{/* Do common initialization */}
635 
636     \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[newid] = \hyperlink{celib_8c_a083a2d27d21ee31bc447f1d4260b94ba}{wd};
637 
638     wd->\hyperlink{structamii__WinDesc_a96e2d1e26527cec8fe44903009a365a8}{newwin} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
639     wd->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} = w;
640     wd->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} = \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type};
641     wd->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} = 0;
642     wd->\hyperlink{structamii__WinDesc_a0977c321f7baae08763a4f998c2e2c3b}{active} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
643     wd->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx}=wd->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury} = 0;
644     wd->\hyperlink{structamii__WinDesc_a7c77cae36fa87a80e7c5b0cf9ed8284f}{resp} = wd->\hyperlink{structamii__WinDesc_ac8c4b6085649b349a4d36d38d3c4344d}{canresp} = wd->\hyperlink{structamii__WinDesc_a18f1ba88dadd6f00144ad9f0b16a2b20}{morestr} = 0;   \textcolor{comment}{/* CHECK THESE */}
645     wd->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow} = \hyperlink{winext_8h_a2b4f8d028c6b8c047e86aa0c49348f36}{new\_wins}[\hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type}].\hyperlink{structwin__setup_aa8dc4df6c1d1b3ba409d0b81d3bb3f94}{maxrow};
646     wd->\hyperlink{structamii__WinDesc_a7abaf7568c45c6f6efabdfdc13164a4c}{maxcol} = \hyperlink{winext_8h_a2b4f8d028c6b8c047e86aa0c49348f36}{new\_wins}[\hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type}].\hyperlink{structwin__setup_a672999163c8dad3dd4e1a68bc8ec2604}{maxcol};
647 
648     \textcolor{keywordflow}{if}( \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} != \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT} && \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} != \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU} )
649     \{
650     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} && ( \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} || \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} == 
      \hyperlink{wintype_8h_a8ed5b99ab7f854ace5f67f89aaae5404}{NHW\_STATUS} ) )
651     \{
652         SetFont(w->RPort, \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont});
653         \hyperlink{winext_8h_afdf567214d70875e5c17efe40a02b53a}{txheight} = w->RPort->TxHeight;
654         \hyperlink{winext_8h_a017c6ef07f078c21f903ea8942bb43b3}{txwidth} = w->RPort->TxWidth;
655         \hyperlink{winext_8h_aceba433f8539ff3b9ea76a9484290a5a}{txbaseline} = w->RPort->TxBaseline;
656         \textcolor{keywordflow}{if}( \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} )
657         \{
658         \textcolor{keywordflow}{if} (\hyperlink{winext_8h_a3b783f5f077454f156585be54b99746b}{scrollmsg} )
659         \{
660             \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
661             \{
662             WindowLimits( w, 100, w->BorderTop +
663                 w->BorderBottom +
664                 ((\hyperlink{winext_8h_afdf567214d70875e5c17efe40a02b53a}{txheight}+1)*2) + 1, 0, 0 );
665             \}
666             \textcolor{keywordflow}{else}
667             \{
668             WindowLimits( w, w->Width, w->BorderTop +
669                 w->BorderBottom +
670                 ((\hyperlink{winext_8h_afdf567214d70875e5c17efe40a02b53a}{txheight}+1)*2) + 1, 0, 0 );
671             \}
672         \}
673         \textcolor{keywordflow}{else}
674         \{
675             WindowLimits( w, w->Width, w->BorderTop +
676                 w->BorderBottom +
677                 \hyperlink{winext_8h_afdf567214d70875e5c17efe40a02b53a}{txheight} + 2, 0, 0 );
678         \}
679         \}
680     \}
681     \textcolor{keywordflow}{if} ( \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} != \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP}) \{
682         SetFont(w->RPort, \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont});
683     \}
684 \textcolor{preprocessor}{#ifdef HACKFONT}
685     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \hyperlink{winext_8h_addd84e576afd1379e2aa7fa9921de0a5}{HackFont} )
686         SetFont(w->RPort, \hyperlink{winext_8h_addd84e576afd1379e2aa7fa9921de0a5}{HackFont});
687 \textcolor{preprocessor}{#endif}
688     \}
689 
690     \textcolor{comment}{/* Text and menu windows are not opened yet */}
691     \textcolor{keywordflow}{if}( w )
692     \{
693     wd->\hyperlink{structamii__WinDesc_a465b4a9c04b3c325f2af2722aac9c5f3}{rows} = ( w->Height - w->BorderTop -
694         w->BorderBottom - 2 ) / w->RPort->TxHeight;
695     wd->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft -
696         w->BorderRight - 2 ) / w->RPort->TxWidth;
697     \}
698 
699     \textcolor{comment}{/* Okay, now do the individual type initialization */}
700 
701     \textcolor{keywordflow}{switch}(\hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type})
702     \{
703     \textcolor{comment}{/* History lines for MESSAGE windows are stored in cw->data[?].}
704 \textcolor{comment}{     * maxcol and maxrow are used as cursors.  maxrow is the count}
705 \textcolor{comment}{     * of the number of history lines stored.  maxcol is the cursor}
706 \textcolor{comment}{     * to the last line that was displayed by ^P.}
707 \textcolor{comment}{     */}
708     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE}:
709         SetMenuStrip(w, \hyperlink{winext_8h_a53bb7c231eb4b4a1df2f0a7e3b21786a}{MenuStrip});
710         \hyperlink{winext_8h_a7714cdb5ca9e060cae6bfc059f1973f4}{MsgScroll}.TopEdge = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->WBorTop + scrfontysize + 1;
711         \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_adbf4e331046e9ace346e832fc8a59074}{msg\_history} = wd->\hyperlink{structamii__WinDesc_a465b4a9c04b3c325f2af2722aac9c5f3}{rows}*10;
712         \textcolor{keywordflow}{if} (\hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_adbf4e331046e9ace346e832fc8a59074}{msg\_history} < 40)
713         \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_adbf4e331046e9ace346e832fc8a59074}{msg\_history} = 40;
714         \textcolor{keywordflow}{if} (\hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_adbf4e331046e9ace346e832fc8a59074}{msg\_history} > 400)
715         \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_adbf4e331046e9ace346e832fc8a59074}{msg\_history} = 400;
716         \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_a2fc6c78c4c5f6e1d0027ac575135426f}{window\_inited}=\hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
717         wd->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data} = (\textcolor{keywordtype}{char} **)\hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}( \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_adbf4e331046e9ace346e832fc8a59074}{msg\_history}*\textcolor{keyword}{sizeof}( \textcolor{keywordtype}{char} * ) );
718         memset( wd->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}, 0, \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_adbf4e331046e9ace346e832fc8a59074}{msg\_history} * \textcolor{keyword}{sizeof}( \textcolor{keywordtype}{char} * ) );
719         wd->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow} = wd->\hyperlink{structamii__WinDesc_a7abaf7568c45c6f6efabdfdc13164a4c}{maxcol} = 0;
720         \textcolor{comment}{/* Indicate that we have not positioned the cursor yet */}
721         wd->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} = -1;
722         \textcolor{keywordflow}{break};
723 
724         \textcolor{comment}{/* A MENU contains a list of lines in wd->data[?].  These}
725 \textcolor{comment}{         * lines are created in amii\_putstr() by reallocating the size}
726 \textcolor{comment}{         * of wd->data to hold enough (char *)'s.  wd->rows is the}
727 \textcolor{comment}{         * number of (char *)'s allocated.  wd->maxrow is the number}
728 \textcolor{comment}{         * used.  wd->maxcol is used to track how wide the menu needs}
729 \textcolor{comment}{         * to be.  wd->resp[x] contains the characters that correspond}
730 \textcolor{comment}{         * to selecting wd->data[x].  wd->resp[x] corresponds to}
731 \textcolor{comment}{         * wd->data[x] for any x. Elements of wd->data[?] that are not}
732 \textcolor{comment}{         * valid selections have the corresponding element of}
733 \textcolor{comment}{         * wd->resp[] set to a value of '\(\backslash\)01';  i.e. a ^A which is}
734 \textcolor{comment}{         * not currently a valid keystroke for responding to any}
735 \textcolor{comment}{         * MENU or TEXT window.}
736 \textcolor{comment}{         */}
737     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU}:
738         \hyperlink{winext_8h_a0be771971036f589c1013474c1fcd264}{MenuScroll}.TopEdge = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->WBorTop + scrfontysize + 1;
739         wd->\hyperlink{structamii__WinDesc_a7c77cae36fa87a80e7c5b0cf9ed8284f}{resp}=(\textcolor{keywordtype}{char}*)\hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(256);
740         wd->\hyperlink{structamii__WinDesc_a7c77cae36fa87a80e7c5b0cf9ed8284f}{resp}[0]=0;
741         wd->\hyperlink{structamii__WinDesc_a465b4a9c04b3c325f2af2722aac9c5f3}{rows} = wd->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow} = 0;
742         wd->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = wd->\hyperlink{structamii__WinDesc_a7abaf7568c45c6f6efabdfdc13164a4c}{maxcol} = 0;
743         wd->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
744         \textcolor{keywordflow}{break};
745 
746         \textcolor{comment}{/* See the explanation of MENU above.  Except, wd->resp[] is not}
747 \textcolor{comment}{         * used for TEXT windows since there is no selection of a}
748 \textcolor{comment}{         * a line performed/allowed.  The window is always full}
749 \textcolor{comment}{         * screen width.}
750 \textcolor{comment}{         */}
751     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT}:
752         \hyperlink{winext_8h_a0be771971036f589c1013474c1fcd264}{MenuScroll}.TopEdge = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->WBorTop + scrfontysize + 1;
753         wd->\hyperlink{structamii__WinDesc_a465b4a9c04b3c325f2af2722aac9c5f3}{rows} = wd->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow} = 0;
754         wd->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = wd->\hyperlink{structamii__WinDesc_a7abaf7568c45c6f6efabdfdc13164a4c}{maxcol} = \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a3f8803e91afede713625203f1cb22b80}{cols};
755         wd->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
756         wd->\hyperlink{structamii__WinDesc_a18f1ba88dadd6f00144ad9f0b16a2b20}{morestr} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
757         \textcolor{keywordflow}{break};
758 
759         \textcolor{comment}{/* The status window has only two lines.  These are stored in}
760 \textcolor{comment}{         * wd->data[], and here we allocate the space for them.}
761 \textcolor{comment}{         */}
762     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a8ed5b99ab7f854ace5f67f89aaae5404}{NHW\_STATUS}:
763         SetMenuStrip(w, \hyperlink{winext_8h_a53bb7c231eb4b4a1df2f0a7e3b21786a}{MenuStrip});
764         \textcolor{comment}{/* wd->cols is the number of characters which fit across the}
765 \textcolor{comment}{         * screen.}
766 \textcolor{comment}{         */}
767         wd->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}=(\textcolor{keywordtype}{char} **)\hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char} *));
768         wd->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[0] = (\textcolor{keywordtype}{char} *)\hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(wd->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} + 10);
769         wd->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[1] = (\textcolor{keywordtype}{char} *)\hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(wd->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} + 10);
770         wd->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[2] = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
771         \textcolor{keywordflow}{break};
772 
773         \textcolor{comment}{/* NHW\_OVER does not use wd->data[] or the other text}
774 \textcolor{comment}{         * manipulating members of the amii\_WinDesc structure.}
775 \textcolor{comment}{         */}
776     \textcolor{keywordflow}{case} \hyperlink{winami_8h_ade6ff25a1de12300d538d40c306f4b2a}{NHW\_OVER}:
777         SetMenuStrip(w, \hyperlink{winext_8h_a53bb7c231eb4b4a1df2f0a7e3b21786a}{MenuStrip});
778         \textcolor{keywordflow}{break};
779 
780         \textcolor{comment}{/* NHW\_MAP does not use wd->data[] or the other text}
781 \textcolor{comment}{         * manipulating members of the amii\_WinDesc structure.}
782 \textcolor{comment}{         */}
783     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP}:
784         SetMenuStrip(w, \hyperlink{winext_8h_a53bb7c231eb4b4a1df2f0a7e3b21786a}{MenuStrip});
785         \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
786         \{
787         \hyperlink{winext_8h_abdcb66bae1fc240beb333f1932bdc30d}{CO} = (w->Width-w->BorderLeft-w->BorderRight)/\hyperlink{winfuncs_8c_afba9a8d2cd024c7010eae489091d11d6}{mxsize};
788         \hyperlink{winext_8h_a4952935dee70ae06274495dcddf10856}{LI} = (w->Height-w->BorderTop-w->BorderBottom)/\hyperlink{winfuncs_8c_a9703aea67c83633a25beaa737dad2b65}{mysize};
789         \hyperlink{winfuncs_8c_a2876464c6431712b2c89e8066669c311}{amii\_setclipped}();
790         SetFont( w->RPort, \hyperlink{winfuncs_8c_ab4180a3dac152c2cdb9d0debce284a33}{RogueFont});
791         SetAPen( w->RPort, \hyperlink{windefs_8h_a67fead37547ff67ca0a269d712e87822}{C\_WHITE}); \textcolor{comment}{/* XXX not sufficient */}
792         SetBPen( w->RPort, \hyperlink{windefs_8h_a22a9543e081938a146a8bce60a84200a}{C\_BLACK});
793         SetDrMd( w->RPort, JAM2);
794         \}
795         \textcolor{keywordflow}{else}
796         \{
797         \textcolor{keywordflow}{if}( \hyperlink{winext_8h_addd84e576afd1379e2aa7fa9921de0a5}{HackFont} )
798             SetFont( w->RPort, \hyperlink{winext_8h_addd84e576afd1379e2aa7fa9921de0a5}{HackFont} );
799         \}
800         \textcolor{keywordflow}{break};
801 
802         \textcolor{comment}{/* The base window must exist until CleanUp() deletes it. */}
803     \textcolor{keywordflow}{case} \hyperlink{macwin_8h_ab575e634e51462bf534b7ee541cefc46}{NHW\_BASE}:
804         SetMenuStrip(w, \hyperlink{winext_8h_a53bb7c231eb4b4a1df2f0a7e3b21786a}{MenuStrip});
805         \textcolor{comment}{/* Make our requesters come to our screen */}
806         \{
807         \textcolor{keyword}{register} \textcolor{keyword}{struct }Process *myProcess =
808                     (\textcolor{keyword}{struct }Process *) FindTask(\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
809         \hyperlink{winext_8h_a6c86952ac4734bcf73b0ecac2e01bb14}{pr\_WindowPtr} = (\textcolor{keyword}{struct }Window *)(myProcess->pr\_WindowPtr);
810         myProcess->pr\_WindowPtr = (APTR) w;
811         \}
812 
813         \textcolor{comment}{/* Need this for RawKeyConvert() */}
814 
815         \hyperlink{winext_8h_ae3c14d8be57ba57c37740ecc37d0f917}{ConsoleIO}.io\_Data = (APTR) w;
816         \hyperlink{winext_8h_ae3c14d8be57ba57c37740ecc37d0f917}{ConsoleIO}.io\_Length = \textcolor{keyword}{sizeof}( \textcolor{keyword}{struct }Window );
817         \hyperlink{winext_8h_ae3c14d8be57ba57c37740ecc37d0f917}{ConsoleIO}.io\_Message.mn\_ReplyPort = CreateMsgPort();
818         \textcolor{keywordflow}{if}( OpenDevice(\textcolor{stringliteral}{"console.device"}, -1L,
819                 (\textcolor{keyword}{struct} IORequest *) &\hyperlink{winext_8h_ae3c14d8be57ba57c37740ecc37d0f917}{ConsoleIO}, 0L) != 0)
820         \{
821         \hyperlink{amiwind_8c_acd807e8b552ad939e3ae2fcb45e14c46}{Abort}(AG\_OpenDev | AO\_ConsoleDev);
822         \}
823 
824         ConsoleDevice = (\textcolor{keyword}{struct }Library *) \hyperlink{winext_8h_ae3c14d8be57ba57c37740ecc37d0f917}{ConsoleIO}.io\_Device;
825 
826         \hyperlink{winext_8h_a1f7c852742582b3b9a76ea350f6976d7}{KbdBuffered} = 0;
827 
828 #ifdef \hyperlink{amiconf_8h_a5f0f0bf01f686f59bc540578a50f3432}{HACKFONT}
829         \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} )
830         SetFont( w->RPort, \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} );
831         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \hyperlink{winext_8h_addd84e576afd1379e2aa7fa9921de0a5}{HackFont} )
832         SetFont( w->RPort, \hyperlink{winext_8h_addd84e576afd1379e2aa7fa9921de0a5}{HackFont} );
833 \textcolor{preprocessor}{#endif}
834         \hyperlink{winext_8h_a017c6ef07f078c21f903ea8942bb43b3}{txwidth} = w->RPort->TxWidth;
835         \hyperlink{winext_8h_afdf567214d70875e5c17efe40a02b53a}{txheight} = w->RPort->TxHeight;
836         \hyperlink{winext_8h_aceba433f8539ff3b9ea76a9484290a5a}{txbaseline} = w->RPort->TxBaseline;
837         \textcolor{keywordflow}{break};
838 
839     \textcolor{keywordflow}{default}:
840         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"bad create\_nhwindow( %d )\(\backslash\)n"},\hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type});
841         \textcolor{keywordflow}{return} \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR};
842     \}
843 
844     \textcolor{keywordflow}{return}( newid );
845 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ad16d76372b2790f7b6926dc6174e4111}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+curs@{amii\+\_\+curs}}
\index{amii\+\_\+curs@{amii\+\_\+curs}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+curs}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+curs (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{window, }
\item[{int}]{x, }
\item[{int}]{y}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ad16d76372b2790f7b6926dc6174e4111}


Definition at line 1584 of file winfuncs.\+c.



References amii\+\_\+wins, ami\+I\+Display, C\+\_\+\+W\+H\+I\+T\+E, amii\+\_\+\+Win\+Desc\+::cols, amii\+\_\+\+Win\+Desc\+::curx, amii\+\_\+\+Win\+Desc\+::cury, flush\+\_\+glyph\+\_\+buffer(), Is\+\_\+rogue\+\_\+level, amii\+\_\+\+Display\+Desc\+::lastwin, max, mxsize, mysize, N\+H\+W\+\_\+\+B\+A\+S\+E, N\+H\+W\+\_\+\+M\+A\+P, N\+H\+W\+\_\+\+M\+E\+N\+U, N\+H\+W\+\_\+\+M\+E\+S\+S\+A\+G\+E, N\+H\+W\+\_\+\+O\+V\+E\+R, N\+H\+W\+\_\+\+S\+T\+A\+T\+U\+S, N\+H\+W\+\_\+\+T\+E\+X\+T, N\+U\+L\+L, panic(), pictdata, printf, amii\+\_\+\+Win\+Desc\+::rows, rp, scrollmsg, amii\+\_\+\+Win\+Desc\+::type, u, you\+::uz, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+I\+N\+V\+E\+N, winpanicstr, W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V, P\+D\+A\+T\+::xsize, and P\+D\+A\+T\+::ysize.



Referenced by amii\+\_\+clear\+\_\+nhwindow(), amii\+\_\+doprev\+\_\+message(), amii\+\_\+print\+\_\+glyph(), amii\+\_\+putstr(), amii\+\_\+putsym(), amii\+\_\+scrollmsg(), Display\+Data(), outmore(), and removetopl().


\begin{DoxyCode}
1588 \{
1589     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
1590     \textcolor{keyword}{register} \textcolor{keyword}{struct }Window *w;
1591     \textcolor{keyword}{register} \textcolor{keyword}{struct }RastPort *\hyperlink{amirip_8c_aa0639b6491ec144930d14703053f32a4}{rp};
1592 
1593     \textcolor{keywordflow}{if}( window == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} || ( cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[window] ) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
1594     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\hyperlink{winext_8h_a4264157ee8930111caf21b62c212e08c}{winpanicstr},  window, \textcolor{stringliteral}{"curs"});
1595     \textcolor{keywordflow}{if}( (w = cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
1596     \{
1597     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU} || cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT} )
1598         \textcolor{keywordflow}{return};
1599     \textcolor{keywordflow}{else}
1600         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \textcolor{stringliteral}{"No window open yet in curs() for winid %d\(\backslash\)n"}, window );
1601     \}
1602     \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a7cba815a57de07b72960832e3e454fb2}{lastwin} = window;
1603 
1604     \textcolor{comment}{/* Make sure x is within bounds */}
1605     \textcolor{keywordflow}{if}( x > 0 )
1606     --x;    \textcolor{comment}{/* column 0 is never used */}
1607     \textcolor{keywordflow}{else}
1608     x = 0;
1609 
1610     cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} = x;
1611     cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury} = y;
1612 
1613 \textcolor{preprocessor}{#ifdef DEBUG}
1614     \textcolor{keywordflow}{if}( x<0 || y<0 || y >= cw->\hyperlink{structamii__WinDesc_a465b4a9c04b3c325f2af2722aac9c5f3}{rows} || x >= cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} )
1615     \{
1616     \textcolor{keywordtype}{char} *s = \textcolor{stringliteral}{"[unknown type]"};
1617     \textcolor{keywordflow}{switch}(cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type})
1618     \{
1619         \textcolor{keywordflow}{case} \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE}: s = \textcolor{stringliteral}{"[topl window]"}; \textcolor{keywordflow}{break};
1620         \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a8ed5b99ab7f854ace5f67f89aaae5404}{NHW\_STATUS}: s = \textcolor{stringliteral}{"[status window]"}; \textcolor{keywordflow}{break};
1621         \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP}: s = \textcolor{stringliteral}{"[map window]"}; \textcolor{keywordflow}{break};
1622         \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU}: s = \textcolor{stringliteral}{"[menu window]"}; \textcolor{keywordflow}{break};
1623         \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT}: s = \textcolor{stringliteral}{"[text window]"}; \textcolor{keywordflow}{break};
1624         \textcolor{keywordflow}{case} \hyperlink{macwin_8h_ab575e634e51462bf534b7ee541cefc46}{NHW\_BASE}: s = \textcolor{stringliteral}{"[base window]"}; \textcolor{keywordflow}{break};
1625         \textcolor{keywordflow}{case} \hyperlink{winami_8h_ade6ff25a1de12300d538d40c306f4b2a}{NHW\_OVER}: s = \textcolor{stringliteral}{"[overview window]"}; \textcolor{keywordflow}{break};
1626     \}
1627     impossible(\textcolor{stringliteral}{"bad curs positioning win %d %s (%d,%d)"}, window, s, x, y);
1628     \textcolor{keywordflow}{return};
1629     \}
1630 \textcolor{preprocessor}{#endif}
1631 
1632 \textcolor{preprocessor}{#ifdef CLIPPING}
1633     \textcolor{keywordflow}{if}(clipping && cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP})
1634     \{
1635     x -= clipx;
1636     y -= clipy;
1637     \}
1638 \textcolor{preprocessor}{#endif}
1639 
1640     \textcolor{comment}{/* Output all saved output before doing cursor movements for MAP */}
1641 
1642     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP} )
1643     \{
1644     \hyperlink{winchar_8c_aedd7ad0350a58b8fca664bcbdc5f1f35}{flush\_glyph\_buffer}( w );
1645     \}
1646 
1647     \textcolor{comment}{/* Actually do it */}
1648 
1649     rp = w->RPort;
1650     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU} )
1651     \{
1652     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
1653     \{
1654         \textcolor{keywordflow}{if}( window == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
1655         \{
1656         Move( rp, (x * rp->TxWidth) + w->BorderLeft + 1 + \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_a957fade03cbfb4ce4de9df4e09be7fc7}{xsize} + 4,
1657             (y * \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(rp->TxHeight,\hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_ad7ef994c367e747b85e09149fdccff1b}{ysize} + 3) ) +
1658              rp->TxBaseline + \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_ad7ef994c367e747b85e09149fdccff1b}{ysize} - rp->TxHeight + w->BorderTop + 4 );
1659         \}
1660         \textcolor{keywordflow}{else}
1661         \{
1662         Move( rp, (x * rp->TxWidth) + w->BorderLeft + 1,
1663             (y * rp->TxHeight) + rp->TxBaseline + w->BorderTop + 1 );
1664         \}
1665     \}
1666     \textcolor{keywordflow}{else}
1667     \{
1668         Move( rp, (x * rp->TxWidth) + w->BorderLeft + 1,
1669         (y*rp->TxHeight ) + rp->TxBaseline + w->BorderTop + 1 );
1670     \}
1671     \}
1672     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT} )
1673     \{
1674     Move( rp, (x * rp->TxWidth) + w->BorderLeft + 1,
1675         (y*rp->TxHeight ) + rp->TxBaseline + w->BorderTop + 1 );
1676     \}
1677     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP} || cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{macwin_8h_ab575e634e51462bf534b7ee541cefc46}{NHW\_BASE} )
1678     \{
1679     \textcolor{comment}{/* These coordinate calculations must be synced with those}
1680 \textcolor{comment}{     * in flush\_glyph\_buffer() in winchar.c.  curs\_on\_u() will}
1681 \textcolor{comment}{     * use this code, all other drawing occurs through the glyph}
1682 \textcolor{comment}{     * code.  In order for the cursor to appear on top of the hero,}
1683 \textcolor{comment}{     * the code must compute X,Y in the same manner relative to}
1684 \textcolor{comment}{     * the RastPort coordinates.}
1685 \textcolor{comment}{     *}
1686 \textcolor{comment}{     * y = w->BorderTop + (g\_nodes[i].y-2) * rp->TxHeight +}
1687 \textcolor{comment}{     *   rp->TxBaseline + 1;}
1688 \textcolor{comment}{     * x = g\_nodes[i].x * rp->TxWidth + w->BorderLeft;}
1689 \textcolor{comment}{     */}
1690 
1691     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
1692     \{
1693         \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP} )
1694         \{
1695           \textcolor{keywordflow}{if}(\hyperlink{dungeon_8h_a2732117523c8540638daf4315dda16b9}{Is\_rogue\_level}(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}))\{
1696 \textcolor{preprocessor}{#if 0}
1697 \textcolor{keywordtype}{int} qqx= (x * w->RPort->TxWidth) + w->BorderLeft;
1698 \textcolor{keywordtype}{int} qqy= w->BorderTop + ( (y+1) * w->RPort->TxHeight ) + 1;
1699 \hyperlink{sound_8c_a3cb9f0894fab1c8fbb0753c9c7c2a8d9}{printf}(\textcolor{stringliteral}{"pos: (%d,%d)->(%d,%d)\(\backslash\)n"},x,y,qqx,qqy);
1700 \textcolor{preprocessor}{#endif}
1701         SetAPen(w->RPort,\hyperlink{windefs_8h_a67fead37547ff67ca0a269d712e87822}{C\_WHITE}); \textcolor{comment}{/* XXX should be elsewhere (was 4)*/}
1702         Move( rp, (x * w->RPort->TxWidth) + w->BorderLeft,
1703             w->BorderTop + ( (y+1) * w->RPort->TxHeight ) + 1 );
1704           \} \textcolor{keywordflow}{else} \{
1705         Move( rp, (x * \hyperlink{winfuncs_8c_afba9a8d2cd024c7010eae489091d11d6}{mxsize}) + w->BorderLeft,
1706                 w->BorderTop + ( (y+1) * \hyperlink{winfuncs_8c_a9703aea67c83633a25beaa737dad2b65}{mysize} ) + 1 );
1707           \}
1708         \}
1709         \textcolor{keywordflow}{else}
1710         \{
1711         Move( rp, (x * w->RPort->TxWidth) + w->BorderLeft,
1712                 w->BorderTop + ( (y + 1) * w->RPort->TxHeight ) +
1713                 w->RPort->TxBaseline + 1 );
1714         \}
1715     \}
1716     \textcolor{keywordflow}{else}
1717     \{
1718         Move( rp, (x * w->RPort->TxWidth) + w->BorderLeft,
1719             w->BorderTop + ( y * w->RPort->TxHeight ) +
1720             w->RPort->TxBaseline + 1 );
1721     \}
1722     \}
1723     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} && cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{winami_8h_ade6ff25a1de12300d538d40c306f4b2a}{NHW\_OVER} )
1724     \{
1725     Move( rp, (x * w->RPort->TxWidth) + w->BorderLeft + 2,
1726             w->BorderTop + w->RPort->TxBaseline + 3 );
1727     \}
1728     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} && !\hyperlink{winext_8h_a3b783f5f077454f156585be54b99746b}{scrollmsg} )
1729     \{
1730     Move( rp, (x * w->RPort->TxWidth) + w->BorderLeft + 2,
1731             w->BorderTop + w->RPort->TxBaseline + 3 );
1732     \}
1733     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a8ed5b99ab7f854ace5f67f89aaae5404}{NHW\_STATUS} )
1734     \{
1735     Move( rp, (x * w->RPort->TxWidth) + w->BorderLeft + 2,
1736             (y*(w->RPort->TxHeight+1)) + w->BorderTop +
1737             w->RPort->TxBaseline + 1 );
1738     \}
1739     \textcolor{keywordflow}{else}
1740     \{
1741     Move( rp, (x * w->RPort->TxWidth) + w->BorderLeft + 2,
1742             (y*w->RPort->TxHeight) + w->BorderTop +
1743             w->RPort->TxBaseline + 1 );
1744     \}
1745 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a1745b65b570e73d18ef385e55d71eef3}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+delay\+\_\+output@{amii\+\_\+delay\+\_\+output}}
\index{amii\+\_\+delay\+\_\+output@{amii\+\_\+delay\+\_\+output}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+delay\+\_\+output}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+delay\+\_\+output (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a1745b65b570e73d18ef385e55d71eef3}
\hypertarget{winproto_8h_aa650954bd0e8c4a5ef3b283050cd646c}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+destroy\+\_\+nhwindow@{amii\+\_\+destroy\+\_\+nhwindow}}
\index{amii\+\_\+destroy\+\_\+nhwindow@{amii\+\_\+destroy\+\_\+nhwindow}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+destroy\+\_\+nhwindow}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+destroy\+\_\+nhwindow (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{win}
\end{DoxyParamCaption}
)}}\label{winproto_8h_aa650954bd0e8c4a5ef3b283050cd646c}


Definition at line 139 of file winfuncs.\+c.



References alwaysinvent, amii\+\_\+destroy\+\_\+nhwindow(), amii\+\_\+oldmsg, amii\+\_\+oldover, amii\+\_\+wins, ami\+I\+Display, amii\+\_\+\+Win\+Desc\+::canresp, amii\+\_\+\+Win\+Desc\+::data, dismiss\+\_\+nhwindow(), free(), amii\+\_\+\+Win\+Desc\+::hook, amii\+\_\+\+Win\+Desc\+::maxrow, amii\+\_\+\+Win\+Desc\+::morestr, N\+H\+W\+\_\+\+M\+A\+P, N\+H\+W\+\_\+\+M\+E\+N\+U, N\+H\+W\+\_\+\+M\+E\+S\+S\+A\+G\+E, N\+H\+W\+\_\+\+O\+V\+E\+R, N\+H\+W\+\_\+\+T\+E\+X\+T, N\+U\+L\+L, panic(), amii\+\_\+\+Win\+Desc\+::resp, amii\+\_\+\+Win\+Desc\+::type, type, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+I\+N\+V\+E\+N, W\+I\+N\+\_\+\+M\+A\+P, W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E, W\+I\+N\+\_\+\+O\+V\+E\+R, W\+I\+N\+\_\+\+S\+T\+A\+T\+U\+S, winpanicstr, W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V, and amii\+\_\+\+Display\+Desc\+::xpix.



Referenced by amii\+\_\+destroy\+\_\+nhwindow(), and kill\+\_\+nhwindows().


\begin{DoxyCode}
141 \{
142     \textcolor{keywordtype}{int} i;
143     \textcolor{keywordtype}{int} \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type};
144     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
145 
146     \textcolor{keywordflow}{if}( \hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} || ( cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}] ) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
147     \{
148     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\hyperlink{winext_8h_a4264157ee8930111caf21b62c212e08c}{winpanicstr},win,\textcolor{stringliteral}{"destroy\_nhwindow"});
149     \}
150 
151     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
152     \{
153     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP} )
154     \{
155         \textcolor{comment}{/* If inventory is up, close it now, it will be freed later */}
156         \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a5f7057e3372d8abeddf1df4f99752979}{alwaysinvent} && \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} &&
157                 \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} ] &&
158                 \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} ]->win )
159         \{
160         \hyperlink{winfuncs_8c_ac946cc5b4c43a936e168ddc80b74c4bd}{dismiss\_nhwindow}( \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} );
161         \}
162 
163         \textcolor{comment}{/* Tear down overview window if it is up */}
164         \textcolor{keywordflow}{if}( \hyperlink{winami_8h_a6a2b237abaae6aafe05c90be6d49d72e}{WIN\_OVER} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} )
165         \{
166         \hyperlink{winfuncs_8c_aa650954bd0e8c4a5ef3b283050cd646c}{amii\_destroy\_nhwindow}( \hyperlink{winami_8h_a6a2b237abaae6aafe05c90be6d49d72e}{WIN\_OVER} );
167         \hyperlink{winami_8h_a6a2b237abaae6aafe05c90be6d49d72e}{WIN\_OVER} = \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR};
168         \}
169     \}
170     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{winami_8h_ade6ff25a1de12300d538d40c306f4b2a}{NHW\_OVER} )
171     \{
172         \textcolor{keyword}{struct }Window *w = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{winami_8h_a6a2b237abaae6aafe05c90be6d49d72e}{WIN\_OVER} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
173         \hyperlink{winfuncs_8c_a0a7c9ea82e04a8326edfd11f48eae0aa}{amii\_oldover}.MinX = w->LeftEdge;
174         \hyperlink{winfuncs_8c_a0a7c9ea82e04a8326edfd11f48eae0aa}{amii\_oldover}.MinY = w->TopEdge;
175         \hyperlink{winfuncs_8c_a0a7c9ea82e04a8326edfd11f48eae0aa}{amii\_oldover}.MaxX = w->Width;
176         \hyperlink{winfuncs_8c_a0a7c9ea82e04a8326edfd11f48eae0aa}{amii\_oldover}.MaxY = w->Height;
177 
178         \textcolor{keywordflow}{if}( \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ 
      \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} ] )
179         \{
180         w = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
181         \hyperlink{winfuncs_8c_abf1a8ff4e563d7d084463a3b9c8a4171}{amii\_oldmsg}.MinX = w->LeftEdge;
182         \hyperlink{winfuncs_8c_abf1a8ff4e563d7d084463a3b9c8a4171}{amii\_oldmsg}.MinY = w->TopEdge;
183         \hyperlink{winfuncs_8c_abf1a8ff4e563d7d084463a3b9c8a4171}{amii\_oldmsg}.MaxX = w->Width;
184         \hyperlink{winfuncs_8c_abf1a8ff4e563d7d084463a3b9c8a4171}{amii\_oldmsg}.MaxY = w->Height;
185         SizeWindow( \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ WIN\_MESSAGE ]->win,
186             (\hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} -
187             \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ WIN\_MESSAGE ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}->LeftEdge) -
188             \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ WIN\_MESSAGE ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}->Width,
189             0 );
190         \}
191     \}
192     \}
193 
194     \textcolor{comment}{/* Tear down the Intuition stuff */}
195     \hyperlink{winfuncs_8c_ac946cc5b4c43a936e168ddc80b74c4bd}{dismiss\_nhwindow}(win);
196     type = cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type};
197 
198     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a7c77cae36fa87a80e7c5b0cf9ed8284f}{resp} ) \{
199     \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}( cw->\hyperlink{structamii__WinDesc_a7c77cae36fa87a80e7c5b0cf9ed8284f}{resp} );
200     cw->\hyperlink{structamii__WinDesc_a7c77cae36fa87a80e7c5b0cf9ed8284f}{resp} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
201     \}
202     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ac8c4b6085649b349a4d36d38d3c4344d}{canresp} ) \{
203     \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}( cw->\hyperlink{structamii__WinDesc_ac8c4b6085649b349a4d36d38d3c4344d}{canresp} );
204     cw->\hyperlink{structamii__WinDesc_ac8c4b6085649b349a4d36d38d3c4344d}{canresp} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
205     \}
206     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a18f1ba88dadd6f00144ad9f0b16a2b20}{morestr} ) \{
207     \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}( cw->\hyperlink{structamii__WinDesc_a18f1ba88dadd6f00144ad9f0b16a2b20}{morestr} );
208     cw->\hyperlink{structamii__WinDesc_a18f1ba88dadd6f00144ad9f0b16a2b20}{morestr} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
209     \}
210     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a95adbcba37257f02f7d9b3e5ef4c8411}{hook} ) \{
211     \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}( cw->\hyperlink{structamii__WinDesc_a95adbcba37257f02f7d9b3e5ef4c8411}{hook} );
212     cw->\hyperlink{structamii__WinDesc_a95adbcba37257f02f7d9b3e5ef4c8411}{hook} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
213     \}
214 
215     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data} && ( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} ||
216                 cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU} || cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT} ) )
217     \{
218     \textcolor{keywordflow}{for}( i = 0; i < cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow}; ++i )
219     \{
220         \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ i ] )
221         \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ i ] );
222     \}
223     \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data} );
224     \}
225 
226     \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}( cw );
227     \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[win] = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
228 
229     \textcolor{comment}{/* Set globals to WIN\_ERR for known one-of-a-kind windows. */}
230     \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP}) \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} = \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR};
231     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_ae0690a38fd295760409995ce03b88329}{WIN\_STATUS}) \hyperlink{decl_8h_ae0690a38fd295760409995ce03b88329}{WIN\_STATUS} = \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR};
232     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE}) \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} = \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR};
233     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN}) \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} = \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR};
234 
235 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a09ab688be08946790ca04552594110e3}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+display\+\_\+file@{amii\+\_\+display\+\_\+file}}
\index{amii\+\_\+display\+\_\+file@{amii\+\_\+display\+\_\+file}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+display\+\_\+file}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+display\+\_\+file (
\begin{DoxyParamCaption}
\item[{{\bf const} char $\ast$}]{fn, }
\item[{{\bf boolean}}]{complain}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a09ab688be08946790ca04552594110e3}
\hypertarget{winproto_8h_a743c0fb6beb3516ba3022d5680276991}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+display\+\_\+nhwindow@{amii\+\_\+display\+\_\+nhwindow}}
\index{amii\+\_\+display\+\_\+nhwindow@{amii\+\_\+display\+\_\+nhwindow}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+display\+\_\+nhwindow}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+display\+\_\+nhwindow (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{win, }
\item[{{\bf boolean}}]{blocking}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a743c0fb6beb3516ba3022d5680276991}


Definition at line 1541 of file winfuncs.\+c.



References amii\+\_\+end\+\_\+glyphout(), amii\+\_\+wins, amii\+\_\+\+Win\+Desc\+::curx, Do\+Menu\+Scroll(), F\+L\+M\+A\+P\+\_\+\+S\+K\+I\+P, flush\+\_\+glyph\+\_\+buffer(), Initialized, N\+H\+W\+\_\+\+M\+A\+P, N\+H\+W\+\_\+\+M\+E\+N\+U, N\+H\+W\+\_\+\+M\+E\+S\+S\+A\+G\+E, N\+H\+W\+\_\+\+S\+T\+A\+T\+U\+S, N\+H\+W\+\_\+\+T\+E\+X\+T, N\+U\+L\+L, outmore(), panic(), P\+I\+C\+K\+\_\+\+O\+N\+E, T\+R\+U\+E, amii\+\_\+\+Win\+Desc\+::type, amii\+\_\+\+Win\+Desc\+::wflags, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+M\+A\+P, W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E, and winpanicstr.


\begin{DoxyCode}
1544 \{
1545     \hyperlink{structmi}{menu\_item} *mip;
1546     \textcolor{keywordtype}{int} cnt;
1547     \textcolor{keyword}{static} \textcolor{keywordtype}{int} lastwin = -1;
1548     \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
1549 
1550     \textcolor{keywordflow}{if}( !\hyperlink{amidos_8c_a55b41cec1916f4628807321204d03d9f}{Initialized} )
1551     \textcolor{keywordflow}{return};
1552     lastwin = \hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
1553 
1554     \textcolor{keywordflow}{if}( \hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} || ( cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}] ) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
1555     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\hyperlink{winext_8h_a4264157ee8930111caf21b62c212e08c}{winpanicstr},win,\textcolor{stringliteral}{"display\_nhwindow"});
1556 
1557     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} )
1558     cw->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} &= ~\hyperlink{winami_8h_a20db85ff854e288c5f3b7c380e6ceb91}{FLMAP\_SKIP};
1559 
1560     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} || cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a8ed5b99ab7f854ace5f67f89aaae5404}{NHW\_STATUS} )
1561     \textcolor{keywordflow}{return};
1562 
1563     \textcolor{keywordflow}{if}( \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} ] )
1564     \{
1565     \hyperlink{winchar_8c_aedd7ad0350a58b8fca664bcbdc5f1f35}{flush\_glyph\_buffer}( \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ WIN\_MAP ]->win );
1566     \}
1567 
1568     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU} || cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT} )
1569     \{
1570     cnt = \hyperlink{sys_2amiga_2winmenu_8c_a2ab7ed911fa9e298491912256dad69be}{DoMenuScroll}( win, blocking, \hyperlink{wintype_8h_a53377e7b2fddfaf7cc2351dab3b2b139}{PICK\_ONE}, &mip );
1571     \}
1572     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type}==\hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP} )
1573     \{
1574     \hyperlink{winchar_8c_ad2db856235b6b0b57afd73a5dd1e286d}{amii\_end\_glyphout}( win );
1575     \textcolor{comment}{/* Do more if it is time... */}
1576     \textcolor{keywordflow}{if}( blocking == \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} && \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} ]->
      \hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} )
1577     \{
1578         \hyperlink{winproto_8h_a55e9e9c33e29d3698d29ff252bf2aae8}{outmore}( \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} ] );
1579     \}
1580     \}
1581 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ae41f9210f43b92a5ed2aef70982e7f9e}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+doprev\+\_\+message@{amii\+\_\+doprev\+\_\+message}}
\index{amii\+\_\+doprev\+\_\+message@{amii\+\_\+doprev\+\_\+message}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+doprev\+\_\+message}]{\setlength{\rightskip}{0pt plus 5cm}int amii\+\_\+doprev\+\_\+message (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ae41f9210f43b92a5ed2aef70982e7f9e}


Definition at line 460 of file winstr.\+c.



References amii\+\_\+cl\+\_\+end(), amii\+\_\+curs(), amii\+\_\+setdrawpens(), amii\+\_\+wins, amii\+\_\+\+Win\+Desc\+::cols, amii\+\_\+\+Win\+Desc\+::curx, amii\+\_\+\+Win\+Desc\+::data, Display\+Data(), max, amii\+\_\+\+Win\+Desc\+::maxcol, amii\+\_\+\+Win\+Desc\+::maxrow, Msg\+Scroll, N\+H\+W\+\_\+\+M\+E\+S\+S\+A\+G\+E, N\+U\+L\+L, panic(), scrollmsg, Set\+Prop\+Info(), S\+O\+F\+F, amii\+\_\+\+Win\+Desc\+::vwy, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E, and winpanicstr.


\begin{DoxyCode}
461 \{
462     \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
463     \textcolor{keyword}{struct }Window *w;
464     \textcolor{keywordtype}{char} *str;
465 
466     \textcolor{keywordflow}{if}( \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} ||
467     ( cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} ] ) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || ( w = cw->
      \hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} ) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
468     \{
469     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\hyperlink{winext_8h_a4264157ee8930111caf21b62c212e08c}{winpanicstr},WIN\_MESSAGE, \textcolor{stringliteral}{"doprev\_message"});
470     \}
471 
472     \textcolor{comment}{/* When an interlaced/tall screen is in use, the scroll bar will be there */}
473     \textcolor{comment}{/* Or in some other cases as well */}
474     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a3b783f5f077454f156585be54b99746b}{scrollmsg} )
475     \{
476     \textcolor{keyword}{struct }Gadget *gd;
477     \textcolor{keyword}{struct }PropInfo *pip;
478     \textcolor{keywordtype}{int} hidden, topidx, i, total, wheight;
479 
480     \textcolor{keywordflow}{for}( gd = w->FirstGadget; gd && gd->GadgetID != 1; )
481         gd = gd->NextGadget;
482 
483     \textcolor{keywordflow}{if}( gd )
484     \{
485         pip = (\textcolor{keyword}{struct }PropInfo *)gd->SpecialInfo;
486         wheight = ( w->Height - w->BorderTop -
487                 w->BorderBottom - 2 ) / w->RPort->TxHeight;
488         hidden = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}( cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow} - wheight, 0 );
489         topidx = (((\hyperlink{def__os2_8h_af632da489ebc3708ec3ab6791ee53fa4}{ULONG})hidden * pip->VertPot) + (MAXPOT/2)) >> 16;
490         \textcolor{keywordflow}{for}( total = i = 0; i < cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow}; ++i )
491         \{
492         \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[i][1] != 0 )
493             ++total;
494         \}
495 
496         i = 0;
497         topidx -= wheight/4 + 1;
498         \textcolor{keywordflow}{if} (topidx < 0)
499         topidx = 0;
500         \hyperlink{sys_2amiga_2winmenu_8c_a28121fc0d5fc72d2292fa04d5bbf7d60}{SetPropInfo}( w, &\hyperlink{winext_8h_a7714cdb5ca9e060cae6bfc059f1973f4}{MsgScroll}, wheight, total, topidx );
501         \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}( WIN\_MESSAGE, topidx );
502     \}
503     \textcolor{keywordflow}{return}(0);
504     \}
505 
506     \textcolor{keywordflow}{if}( --cw->\hyperlink{structamii__WinDesc_a55e0b7473323fe60385ad4750437b831}{vwy} < 0 )
507     \{
508     cw->\hyperlink{structamii__WinDesc_a7abaf7568c45c6f6efabdfdc13164a4c}{maxcol} = 0;
509     DisplayBeep( \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} );
510     str = \textcolor{stringliteral}{"\(\backslash\)0\(\backslash\)0No more history saved..."};
511     \}
512     \textcolor{keywordflow}{else}
513     str = cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ cw->\hyperlink{structamii__WinDesc_a55e0b7473323fe60385ad4750437b831}{vwy} ];
514 
515     \hyperlink{winfuncs_8c_ace7ed7ac165d8e68bbc3df59a8ac5ec6}{amii\_cl\_end}(cw, 0);
516     \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}( WIN\_MESSAGE, 1, 0 );
517     \hyperlink{winfuncs_8c_a2c51c999c9751e89fcdcbf313d741da7}{amii\_setdrawpens}( \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[WIN\_MESSAGE]->win, 
      \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} );
518     Text(w->RPort,str+\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF},strlen(str+\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}));
519     cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} = cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} + 1;
520 
521     \textcolor{keywordflow}{return}( 0 );
522 \}
\end{DoxyCode}
\hypertarget{winproto_8h_af54c03b382ca47347d8e223319baa106}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+end\+\_\+glyphout@{amii\+\_\+end\+\_\+glyphout}}
\index{amii\+\_\+end\+\_\+glyphout@{amii\+\_\+end\+\_\+glyphout}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+end\+\_\+glyphout}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+end\+\_\+glyphout (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{window}
\end{DoxyParamCaption}
)}}\label{winproto_8h_af54c03b382ca47347d8e223319baa106}


Definition at line 899 of file winchar.\+c.



References amii\+\_\+wins, F\+L\+M\+A\+P\+\_\+\+I\+N\+G\+L\+Y\+P\+H, iflags, N\+U\+L\+L, panic(), usecolor, amii\+\_\+\+Win\+Desc\+::wflags, and amii\+\_\+\+Win\+Desc\+::win.



Referenced by amii\+\_\+display\+\_\+nhwindow(), and amiv\+\_\+flush\+\_\+glyph\+\_\+buffer().


\begin{DoxyCode}
901 \{
902     \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
903     \textcolor{keyword}{struct }Window *w;
904 
905     \textcolor{keywordflow}{if}( ( cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ window ] ) == (\textcolor{keyword}{struct} \hyperlink{structamii__WinDesc}{amii\_WinDesc} *)
      \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
906     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"bad window id %d in amii\_end\_glyphout()"}, window );
907 
908     \textcolor{keywordflow}{if}( ( cw->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} & \hyperlink{winami_8h_acd25e68fa1580269477b392d687904f6}{FLMAP\_INGLYPH} ) == 0 )
909     \textcolor{keywordflow}{return};
910     cw->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} &= ~(\hyperlink{winami_8h_acd25e68fa1580269477b392d687904f6}{FLMAP\_INGLYPH});
911 
912     \textcolor{keywordflow}{if}( !(w = cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} ) )
913     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \textcolor{stringliteral}{"bad winid %d, no window ptr set"}, window );
914 
915     \textcolor{comment}{/*}
916 \textcolor{comment}{     * Clean up whatever is left in the buffer}
917 \textcolor{comment}{     */}
918     \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.use\_color = \hyperlink{winchar_8c_a59f1f5efd63bf119d0ff187caa2dffde}{usecolor};
919 
920     \textcolor{comment}{/*}
921 \textcolor{comment}{     * Reset internal data structs}
922 \textcolor{comment}{     */}
923     SetAPen(w->RPort, \hyperlink{winchar_8c_ad50e5dcd3712e91f244ef4763ece7705}{apensave});
924     SetBPen(w->RPort, \hyperlink{winchar_8c_a24084014a9beff291e6199285e4f035e}{bpensave});
925     SetDrMd(w->RPort, \hyperlink{winchar_8c_a7301f7ec6ca8a7e74922796f044057fd}{modesave});
926 
927     Move(w->RPort, \hyperlink{winchar_8c_a9b80bf2de8aa03db642b0e8e4b06e1b4}{xsave}, \hyperlink{winchar_8c_adc6ad80b68d03a20fb5dd1394df034dc}{ysave});
928 \}
\end{DoxyCode}
\hypertarget{winproto_8h_afd925fb80d381b7e22df32bf7ec56012}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+exit\+\_\+nhwindows@{amii\+\_\+exit\+\_\+nhwindows}}
\index{amii\+\_\+exit\+\_\+nhwindows@{amii\+\_\+exit\+\_\+nhwindows}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+exit\+\_\+nhwindows}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+exit\+\_\+nhwindows (
\begin{DoxyParamCaption}
\item[{{\bf const} char $\ast$}]{str}
\end{DoxyParamCaption}
)}}\label{winproto_8h_afd925fb80d381b7e22df32bf7ec56012}
\hypertarget{winproto_8h_aff9d8c4b941f1e78656d123d92efdfe1}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+get\+\_\+color\+\_\+string@{amii\+\_\+get\+\_\+color\+\_\+string}}
\index{amii\+\_\+get\+\_\+color\+\_\+string@{amii\+\_\+get\+\_\+color\+\_\+string}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+get\+\_\+color\+\_\+string}]{\setlength{\rightskip}{0pt plus 5cm}char $\ast$ amii\+\_\+get\+\_\+color\+\_\+string (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_aff9d8c4b941f1e78656d123d92efdfe1}


Definition at line 1163 of file winreq.\+c.


\begin{DoxyCode}
1164 \{
1165     \textcolor{keywordtype}{int} i;
1166     \textcolor{keywordtype}{char} s[ 10 ];
1167     \textcolor{keyword}{static} \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[ \hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ} ];
1168 
1169     *buf = 0;
1170     \textcolor{keywordflow}{for}( i = 0; i < \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(32,\hyperlink{winext_8h_ae3cfaa8053fd2f089c9fe1ba90289e98}{amii\_numcolors}); ++i )
1171     \{
1172         sprintf( s, \textcolor{stringliteral}{"%s%03lx"}, i ? \textcolor{stringliteral}{"/"} : \textcolor{stringliteral}{""}, (\textcolor{keywordtype}{long})\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.amii\_curmap[ i ] );
1173     strcat( buf, s );
1174     \}
1175 
1176     \textcolor{keywordflow}{return}( buf );
1177 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a4564c9a84f5dc940f3d35ac5211b794f}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+get\+\_\+ext\+\_\+cmd@{amii\+\_\+get\+\_\+ext\+\_\+cmd}}
\index{amii\+\_\+get\+\_\+ext\+\_\+cmd@{amii\+\_\+get\+\_\+ext\+\_\+cmd}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+get\+\_\+ext\+\_\+cmd}]{\setlength{\rightskip}{0pt plus 5cm}int amii\+\_\+get\+\_\+ext\+\_\+cmd (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a4564c9a84f5dc940f3d35ac5211b794f}
\hypertarget{winproto_8h_ad87aef3d81ba2f815e13260793c51c16}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+get\+\_\+nh\+\_\+event@{amii\+\_\+get\+\_\+nh\+\_\+event}}
\index{amii\+\_\+get\+\_\+nh\+\_\+event@{amii\+\_\+get\+\_\+nh\+\_\+event}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+get\+\_\+nh\+\_\+event}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+get\+\_\+nh\+\_\+event (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ad87aef3d81ba2f815e13260793c51c16}


Definition at line 82 of file winkey.\+c.


\begin{DoxyCode}
83 \{
84     \textcolor{comment}{/* nothing now - later I have no idea.  Is this just a Mac hook? */}
85 \}
\end{DoxyCode}
\hypertarget{winproto_8h_af10d73c7abbeacb1dbf7c63fd6f50fab}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+getlin@{amii\+\_\+getlin}}
\index{amii\+\_\+getlin@{amii\+\_\+getlin}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+getlin}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+getlin (
\begin{DoxyParamCaption}
\item[{{\bf const} char $\ast$}]{prompt, }
\item[{char $\ast$}]{bufp}
\end{DoxyParamCaption}
)}}\label{winproto_8h_af10d73c7abbeacb1dbf7c63fd6f50fab}


Referenced by Do\+Menu\+Scroll().

\hypertarget{winproto_8h_abac67bb181e97ddcf156ec25e0660f9a}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+getret@{amii\+\_\+getret}}
\index{amii\+\_\+getret@{amii\+\_\+getret}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+getret}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+getret (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_abac67bb181e97ddcf156ec25e0660f9a}


Definition at line 88 of file winkey.\+c.



References Hack\+Port, raw\+\_\+print, and Window\+Getchar().



Referenced by Abort().


\begin{DoxyCode}
89 \{
90     \textcolor{keyword}{register} \textcolor{keywordtype}{int} c;
91 
92     \hyperlink{winprocs_8h_a49dffdcae248bae8b370f76b434ce744}{raw\_print}( \textcolor{stringliteral}{""} );
93     \hyperlink{winprocs_8h_a49dffdcae248bae8b370f76b434ce744}{raw\_print}( \textcolor{stringliteral}{"Press Return..."} );
94 
95     c = 0;
96 
97     \textcolor{keywordflow}{while}( c != \textcolor{charliteral}{'\(\backslash\)n'} && c != \textcolor{charliteral}{'\(\backslash\)r'} )
98     \{
99     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a392c49118e04b9257df71fca005829e0}{HackPort} )
100         c = \hyperlink{winproto_8h_a173d2dc6a888352bb65b7cacd4576308}{WindowGetchar}();
101     \textcolor{keywordflow}{else}
102         c = getchar();
103     \}
104     \textcolor{keywordflow}{return};
105 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a8d9a0355e4c511ee2725034e1549e798}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+init\+\_\+nhwindows@{amii\+\_\+init\+\_\+nhwindows}}
\index{amii\+\_\+init\+\_\+nhwindows@{amii\+\_\+init\+\_\+nhwindows}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+init\+\_\+nhwindows}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+init\+\_\+nhwindows (
\begin{DoxyParamCaption}
\item[{int $\ast$}]{, }
\item[{char $\ast$$\ast$}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a8d9a0355e4c511ee2725034e1549e798}


Definition at line 892 of file winfuncs.\+c.



References Abort(), alloc(), alwaysinvent, amii\+\_\+clear\+\_\+nhwindow(), amii\+\_\+create\+\_\+nhwindow(), amii\+\_\+init\+\_\+map, amii\+\_\+initmap, amii\+\_\+libvers, amii\+\_\+numcolors, amii\+\_\+putstr(), amii\+\_\+scrnmode, ami\+I\+Display, bigscreen, Border\+Vectors1, Border\+Vectors2, C\+\_\+\+B\+L\+A\+C\+K, C\+\_\+\+W\+H\+I\+T\+E, amii\+\_\+\+Display\+Desc\+::cols, C\+O\+P\+Y\+R\+I\+G\+H\+T\+\_\+\+B\+A\+N\+N\+E\+R\+\_\+\+A, C\+O\+P\+Y\+R\+I\+G\+H\+T\+\_\+\+B\+A\+N\+N\+E\+R\+\_\+\+B, C\+O\+P\+Y\+R\+I\+G\+H\+T\+\_\+\+B\+A\+N\+N\+E\+R\+\_\+\+C, flags, fname, F\+O\+N\+T\+H\+E\+I\+G\+H\+T, F\+O\+N\+T\+W\+I\+D\+T\+H, Gfx\+Base, G\+T\+Hack\+Menu, Hack80, Hack\+Font, Hack\+Screen, Initialized, amii\+\_\+\+Display\+Desc\+::lastwin, max, Menu\+Strip, New\+Hack\+Screen, N\+H\+W\+\_\+\+B\+A\+S\+E, N\+U\+L\+L, panic(), P\+A\+T\+C\+H\+L\+E\+V\+E\+L, amii\+\_\+\+Display\+Desc\+::rawprint, Read\+Tile\+Image\+Files(), Rogue\+Font, amii\+\_\+\+Display\+Desc\+::rows, S\+C\+R\+E\+E\+N\+H\+E\+I\+G\+H\+T, scrntags, S\+I\+Z\+E\+O\+F\+\_\+\+D\+I\+S\+K\+N\+A\+M\+E, S\+M\+\_\+\+Filter(), Texts\+Font, Texts\+Font13, amii\+\_\+\+Display\+Desc\+::toplin, T\+R\+U\+E, V\+E\+R\+S\+I\+O\+N\+\_\+\+M\+A\+J\+O\+R, V\+E\+R\+S\+I\+O\+N\+\_\+\+M\+I\+N\+O\+R, Visual\+Info, W\+I\+D\+T\+H, W\+I\+N\+\_\+\+B\+A\+S\+E, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+I\+N\+V\+E\+N, W\+I\+N\+\_\+\+M\+A\+P, W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E, W\+I\+N\+\_\+\+O\+V\+E\+R, W\+I\+N\+\_\+\+S\+T\+A\+T\+U\+S, W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V, amii\+\_\+\+Display\+Desc\+::xpix, and amii\+\_\+\+Display\+Desc\+::ypix.


\begin{DoxyCode}
895 \{
896     \textcolor{keywordtype}{int} i;
897     \textcolor{keyword}{struct }Screen *wbscr;
898     \textcolor{keywordtype}{int} forcenobig = 0;
899 
900     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen} )
901     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \textcolor{stringliteral}{"init\_nhwindows() called twice"}, 0 );
902 
903     \textcolor{comment}{/* run args & set bigscreen from -L(1)/-l(-1) */}
904     \{
905     \textcolor{keywordtype}{int} lclargc = *argcp;
906     \textcolor{keywordtype}{int} t;
907     \textcolor{keywordtype}{char} **argv\_in = argv;
908     \textcolor{keywordtype}{char} **argv\_out = argv;
909 
910     \textcolor{keywordflow}{for}(t=1;t<=lclargc;t++)\{
911         \textcolor{keywordflow}{if}(!strcmp(\textcolor{stringliteral}{"-L"},*argv\_in) || !strcmp(\textcolor{stringliteral}{"-l"},*argv\_in))\{
912         \hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} = (*argv\_in[1]==\textcolor{charliteral}{'l'}) ? -1 : 1;
913         \textcolor{comment}{/* and eat the flag */}
914         (*argcp)--;
915         \} \textcolor{keywordflow}{else} \{
916         *argv\_out = *argv\_in;   \textcolor{comment}{/* keep the flag */}
917         argv\_out++;
918         \}
919         argv\_in++;
920     \}
921     *argv\_out = 0;
922     \}
923 
924     \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} = \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR};
925     \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} = \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR};
926     \hyperlink{decl_8h_ae0690a38fd295760409995ce03b88329}{WIN\_STATUS} = \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR};
927     \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} = \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR};
928     \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE} = \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR};
929     \hyperlink{winami_8h_a6a2b237abaae6aafe05c90be6d49d72e}{WIN\_OVER} = \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR};
930 
931     \textcolor{keywordflow}{if} ( (IntuitionBase = (\textcolor{keyword}{struct} IntuitionBase *)
932       OpenLibrary(\textcolor{stringliteral}{"intuition.library"}, \hyperlink{winfuncs_8c_a671ae6e85756b2cbd50580e85216e311}{amii\_libvers} )) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
933     \{
934     \hyperlink{amiwind_8c_acd807e8b552ad939e3ae2fcb45e14c46}{Abort}(AG\_OpenLib | AO\_Intuition);
935     \}
936 
937     \textcolor{keywordflow}{if} ( (\hyperlink{amisnd_8c_a27b8182e2ba664f425ed01cbb790f0ad}{GfxBase} = (\textcolor{keyword}{struct} \hyperlink{amisnd_8c_a27b8182e2ba664f425ed01cbb790f0ad}{GfxBase} *)
938           OpenLibrary(\textcolor{stringliteral}{"graphics.library"}, \hyperlink{winfuncs_8c_a671ae6e85756b2cbd50580e85216e311}{amii\_libvers} )) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
939     \{
940     \hyperlink{amiwind_8c_acd807e8b552ad939e3ae2fcb45e14c46}{Abort}(AG\_OpenLib | AO\_GraphicsLib);
941     \}
942 
943     \textcolor{keywordflow}{if}( (LayersBase = (\textcolor{keyword}{struct} Library *)
944         OpenLibrary(\textcolor{stringliteral}{"layers.library"}, \hyperlink{winfuncs_8c_a671ae6e85756b2cbd50580e85216e311}{amii\_libvers} )) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
945     \{
946     \hyperlink{amiwind_8c_acd807e8b552ad939e3ae2fcb45e14c46}{Abort}(AG\_OpenLib | AO\_LayersLib);
947     \}
948 
949     \textcolor{keywordflow}{if} ((GadToolsBase = OpenLibrary(\textcolor{stringliteral}{"gadtools.library"}, \hyperlink{winfuncs_8c_a671ae6e85756b2cbd50580e85216e311}{amii\_libvers})) == 
      \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}) \{
950     \hyperlink{amiwind_8c_acd807e8b552ad939e3ae2fcb45e14c46}{Abort}(AG\_OpenLib | AO\_GadTools);
951     \}
952 
953     \textcolor{keywordflow}{if} ((AslBase = OpenLibrary(\textcolor{stringliteral}{"asl.library"}, \hyperlink{winfuncs_8c_a671ae6e85756b2cbd50580e85216e311}{amii\_libvers})) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}) \{
954     \hyperlink{amiwind_8c_acd807e8b552ad939e3ae2fcb45e14c46}{Abort}(AG\_OpenLib);
955     \}
956 
957     \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}=(\textcolor{keyword}{struct }\hyperlink{structamii__DisplayDesc}{amii\_DisplayDesc} *)\hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(\textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} 
      \hyperlink{structamii__DisplayDesc}{amii\_DisplayDesc}));
958     memset( \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}, 0, \textcolor{keyword}{sizeof}( \textcolor{keyword}{struct} \hyperlink{structamii__DisplayDesc}{amii\_DisplayDesc} ) );
959 
960     \textcolor{comment}{/* Use Intuition sizes for overscan screens... */}
961 
962     \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} = 0;
963 \textcolor{preprocessor}{#ifdef  INTUI\_NEW\_LOOK}
964     \textcolor{keywordflow}{if}( IntuitionBase->LibNode.lib\_Version >= 37 )
965     \{
966     \textcolor{keywordflow}{if}( wbscr = LockPubScreen( \textcolor{stringliteral}{"Workbench"} ) )
967     \{
968         \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} = wbscr->Width;
969         \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} = wbscr->Height;
970         UnlockPubScreen( \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, wbscr );
971     \}
972     \}
973 \textcolor{preprocessor}{#endif}
974     \textcolor{keywordflow}{if}( \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} == 0 )
975     \{
976     \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} = \hyperlink{amisnd_8c_a27b8182e2ba664f425ed01cbb790f0ad}{GfxBase}->NormalDisplayRows;
977     \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} = \hyperlink{amisnd_8c_a27b8182e2ba664f425ed01cbb790f0ad}{GfxBase}->NormalDisplayColumns;
978     \}
979 
980     \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a3f8803e91afede713625203f1cb22b80}{cols} = \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} / 
      \hyperlink{windefs_8h_a187fc573e9da24a6e0d86b11ed520fb3}{FONTWIDTH};
981 
982     \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_ae1f6917b2fc9ca142cd05d6fb615845d}{toplin}=0;
983     \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_aaee7b747d7620b0e53252edc0bfc5782}{rawprint}=0;
984     \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a7cba815a57de07b72960832e3e454fb2}{lastwin}=0;
985 
986     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} == 0 )
987     \{
988     \textcolor{keywordflow}{if}( ( \hyperlink{amisnd_8c_a27b8182e2ba664f425ed01cbb790f0ad}{GfxBase}->ActiView->ViewPort->Modes & LACE ) == LACE )
989     \{
990         \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} *= 2;
991         \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.ViewModes |= LACE;
992         \hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} = 1;
993     \}
994     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \hyperlink{amisnd_8c_a27b8182e2ba664f425ed01cbb790f0ad}{GfxBase}->NormalDisplayRows >= 300 ||
995          \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} >= 300 )
996     \{
997         \hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} = 1;
998     \}
999     \}
1000     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} == -1 )
1001     \{
1002     \hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} = 0;
1003     forcenobig = 1;
1004     \}
1005     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} )
1006     \{
1007     \textcolor{comment}{/* If bigscreen requested and we don't have enough rows in}
1008 \textcolor{comment}{     * noninterlaced mode, switch to interlaced...}
1009 \textcolor{comment}{     */}
1010     \textcolor{keywordflow}{if}( \hyperlink{amisnd_8c_a27b8182e2ba664f425ed01cbb790f0ad}{GfxBase}->NormalDisplayRows < 300 )
1011     \{
1012         \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} *= 2;
1013         \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.ViewModes |= LACE;
1014     \}
1015     \}
1016 
1017     \textcolor{keywordflow}{if}( !\hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} )
1018     \{
1019         \hyperlink{winext_8h_a5f7057e3372d8abeddf1df4f99752979}{alwaysinvent} = 0;
1020     \}
1021     \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_aff6e45d6e31f2217bb6ba101207b74a2}{rows} = \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} / 
      \hyperlink{windefs_8h_afb76020ea3a049e31eef16a4bf89bdd1}{FONTHEIGHT};
1022 
1023 \textcolor{preprocessor}{#ifdef HACKFONT}
1024     \textcolor{comment}{/*}
1025 \textcolor{comment}{     *  Load the fonts that we need.}
1026 \textcolor{comment}{     */}
1027 
1028     \textcolor{keywordflow}{if}( DiskfontBase =
1029         OpenLibrary( \textcolor{stringliteral}{"diskfont.library"}, \hyperlink{winfuncs_8c_a671ae6e85756b2cbd50580e85216e311}{amii\_libvers}  ) )
1030     \{
1031     \hyperlink{winext_8h_a7d3f60d4b667890526b20253da680106}{Hack80}.ta\_Name -= \hyperlink{windefs_8h_a71491b072ff6b37324925cbd32099ec5}{SIZEOF\_DISKNAME};
1032     \hyperlink{winext_8h_addd84e576afd1379e2aa7fa9921de0a5}{HackFont} = OpenDiskFont( &\hyperlink{winext_8h_a7d3f60d4b667890526b20253da680106}{Hack80} );
1033     \hyperlink{winext_8h_a7d3f60d4b667890526b20253da680106}{Hack80}.ta\_Name += \hyperlink{windefs_8h_a71491b072ff6b37324925cbd32099ec5}{SIZEOF\_DISKNAME};
1034 
1035     \textcolor{comment}{/* Textsfont13 is filled in with "FONT=" settings. The default is}
1036 \textcolor{comment}{     * courier/13.}
1037 \textcolor{comment}{     */}
1038     \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
1039     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} )
1040         \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} = OpenDiskFont( &\hyperlink{winext_8h_ae025c8071639e4d9dc591d74e997ed7d}{TextsFont13} );
1041 
1042     \textcolor{comment}{/* Try hack/8 for texts if no user specified font */}
1043     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
1044     \{
1045         \hyperlink{winext_8h_a7d3f60d4b667890526b20253da680106}{Hack80}.ta\_Name -= \hyperlink{windefs_8h_a71491b072ff6b37324925cbd32099ec5}{SIZEOF\_DISKNAME};
1046         \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} = OpenDiskFont( &\hyperlink{winext_8h_a7d3f60d4b667890526b20253da680106}{Hack80} );
1047         \hyperlink{winext_8h_a7d3f60d4b667890526b20253da680106}{Hack80}.ta\_Name += \hyperlink{windefs_8h_a71491b072ff6b37324925cbd32099ec5}{SIZEOF\_DISKNAME};
1048     \}
1049 
1050     \textcolor{comment}{/* If no fonts, make everything topaz 8 for non-view windows.}
1051 \textcolor{comment}{     */}
1052     \hyperlink{winext_8h_a7d3f60d4b667890526b20253da680106}{Hack80}.ta\_Name = \textcolor{stringliteral}{"topaz.font"};
1053     \hyperlink{winfuncs_8c_ab4180a3dac152c2cdb9d0debce284a33}{RogueFont} = OpenFont( &\hyperlink{winext_8h_a7d3f60d4b667890526b20253da680106}{Hack80} );
1054     \textcolor{keywordflow}{if}(!\hyperlink{winfuncs_8c_ab4180a3dac152c2cdb9d0debce284a33}{RogueFont}) \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"Can't get topaz:8"});
1055     \textcolor{keywordflow}{if}( !\hyperlink{winext_8h_addd84e576afd1379e2aa7fa9921de0a5}{HackFont} || !\hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} )
1056     \{
1057         \textcolor{keywordflow}{if}( !\hyperlink{winext_8h_addd84e576afd1379e2aa7fa9921de0a5}{HackFont} )
1058         \{
1059         \hyperlink{winext_8h_addd84e576afd1379e2aa7fa9921de0a5}{HackFont} = OpenFont( &\hyperlink{winext_8h_a7d3f60d4b667890526b20253da680106}{Hack80} );
1060         \textcolor{keywordflow}{if}( !\hyperlink{winext_8h_addd84e576afd1379e2aa7fa9921de0a5}{HackFont} )
1061             \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \textcolor{stringliteral}{"Can't get a map font, topaz:8"} );
1062         \}
1063 
1064         \textcolor{keywordflow}{if}( !\hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} )
1065         \{
1066         \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} = OpenFont( &\hyperlink{winext_8h_a7d3f60d4b667890526b20253da680106}{Hack80} );
1067         \textcolor{keywordflow}{if}( !\hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} )
1068             \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \textcolor{stringliteral}{"Can't open text font"} );
1069         \}
1070     \}
1071     CloseLibrary(DiskfontBase);
1072     DiskfontBase = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
1073     \}
1074 \textcolor{preprocessor}{#endif}
1075 
1076     \textcolor{comment}{/* Adjust getlin window size to font */}
1077 
1078     \textcolor{keywordflow}{if} (\hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}) \{
1079     \textcolor{keyword}{extern} SHORT \hyperlink{winreq_8c_a1381d91aade7627f31ecd17317b7c353}{BorderVectors1}[];
1080     \textcolor{keyword}{extern} SHORT \hyperlink{winreq_8c_a84e8d4156ff66493213a02bcdc659a50}{BorderVectors2}[];
1081     \textcolor{keyword}{extern} \textcolor{keyword}{struct }Gadget \hyperlink{winreq_8c_ae33165f9a2f6158045b42e35c9b17ad9}{Gadget2};
1082     \textcolor{keyword}{extern} \textcolor{keyword}{struct }Gadget \hyperlink{winreq_8c_a390a5f3d86203009670d84592ac44102}{String};
1083     \textcolor{keyword}{extern} \textcolor{keyword}{struct }NewWindow \hyperlink{winreq_8c_ae265d659b782e056634b435548b53c1e}{StrWindow};
1084     BorderVectors1[2] += (\hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_XSize-8)*6; \textcolor{comment}{/* strlen("Cancel") == 6 */}
1085     BorderVectors1[4] += (\hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_XSize-8)*6;
1086     BorderVectors1[5] += \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_YSize-8;
1087     BorderVectors1[7] += \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_YSize-8;
1088     BorderVectors2[2] += (\hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_XSize-8)*6;
1089     BorderVectors2[4] += (\hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_XSize-8)*6;
1090     BorderVectors2[5] += \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_YSize-8;
1091     BorderVectors2[7] += \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_YSize-8;
1092     \hyperlink{winreq_8c_ae33165f9a2f6158045b42e35c9b17ad9}{Gadget2}.TopEdge += \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_YSize-8;
1093     \hyperlink{winreq_8c_ae33165f9a2f6158045b42e35c9b17ad9}{Gadget2}.Width += (\hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_XSize-8)*6;
1094     \hyperlink{winreq_8c_ae33165f9a2f6158045b42e35c9b17ad9}{Gadget2}.Height += \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_YSize-8;
1095     \hyperlink{winreq_8c_a390a5f3d86203009670d84592ac44102}{String}.LeftEdge += (\hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_XSize-8)*6;
1096     \hyperlink{winreq_8c_a390a5f3d86203009670d84592ac44102}{String}.TopEdge += \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_YSize-8;
1097     \hyperlink{winreq_8c_a390a5f3d86203009670d84592ac44102}{String}.Width += \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_XSize-8;
1098     \hyperlink{winreq_8c_a390a5f3d86203009670d84592ac44102}{String}.Height += \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_YSize-8;
1099     \hyperlink{winreq_8c_ae265d659b782e056634b435548b53c1e}{StrWindow}.Width += (\hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_XSize-8)*7;
1100     \hyperlink{winreq_8c_ae265d659b782e056634b435548b53c1e}{StrWindow}.Height += (\hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_YSize-8)*2; \textcolor{comment}{/* Titlebar + 1 row of gadgets */}
1101     \}
1102 
1103     \textcolor{comment}{/* This is the size screen we want to open, within reason... */}
1104 
1105     \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Width = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}( \hyperlink{mkmap_8c_a241aeeb764887ae5e3de58b98f04b16d}{WIDTH}, \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->
      \hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} );
1106     \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Height = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}( \hyperlink{windefs_8h_ae189e98d0ef9263c37869ce1ff3710a5}{SCREENHEIGHT}, 
      \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} );
1107     \{
1108     \textcolor{keyword}{static} \textcolor{keywordtype}{char} \hyperlink{dgn__yacc_8c_a6a2fc0c236288b07ce5bd1335ca89fa2}{fname}[18];
1109     sprintf(fname,\textcolor{stringliteral}{"NetHack %d.%d.%d"}, \hyperlink{patchlevel_8h_a1a53b724b6de666faa8a9e0d06d1055f}{VERSION\_MAJOR}, \hyperlink{patchlevel_8h_ae0cb52afb79b185b1bf82c7e235f682b}{VERSION\_MINOR}, 
      \hyperlink{patchlevel_8h_a0e36fabb240fb841cc1df19b076f45c9}{PATCHLEVEL});
1110     \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.DefaultTitle=\hyperlink{dgn__yacc_8c_a6a2fc0c236288b07ce5bd1335ca89fa2}{fname};
1111     \}
1112 \textcolor{preprocessor}{#if 0}
1113     \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.BlockPen = \hyperlink{windefs_8h_a22a9543e081938a146a8bce60a84200a}{C\_BLACK};
1114     \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.DetailPen = \hyperlink{windefs_8h_a67fead37547ff67ca0a269d712e87822}{C\_WHITE};
1115 \textcolor{preprocessor}{#endif}
1116 \textcolor{preprocessor}{#ifdef  INTUI\_NEW\_LOOK}
1117     \textcolor{keywordflow}{if}( IntuitionBase->LibNode.lib\_Version >= 37 )
1118     \{
1119         \textcolor{keywordtype}{int} i;
1120     \textcolor{keyword}{struct }DimensionInfo dims;
1121     DisplayInfoHandle handle;
1122     \textcolor{keyword}{struct }DisplayInfo disp;
1123     \hyperlink{def__os2_8h_af632da489ebc3708ec3ab6791ee53fa4}{ULONG} modeid = DEFAULT\_MONITOR\_ID|HIRES\_KEY;
1124 
1125     \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Width = STDSCREENWIDTH;
1126     \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Height = STDSCREENHEIGHT;
1127 
1128 \textcolor{preprocessor}{#ifdef HACKFONT}
1129     \textcolor{keywordflow}{if} (\hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}) \{
1130         \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Font = &\hyperlink{winext_8h_ae025c8071639e4d9dc591d74e997ed7d}{TextsFont13};
1131     \}
1132 \textcolor{preprocessor}{#endif}
1133 
1134     \textcolor{keywordflow}{if} ( \hyperlink{winext_8h_adb4cf3b576bf85b4faa561cc99b62e84}{amii\_scrnmode} == 0xffffffff ) \{
1135         \textcolor{keyword}{struct }ScreenModeRequester *SMR;
1136 \textcolor{preprocessor}{#ifdef \_\_GNUC\_\_}
1137         SM\_FilterHook.h\_Entry = (\textcolor{keywordtype}{void} *)&\hyperlink{winfuncs_8c_a49e0e4d194d63d3aadfdc40401701b06}{SM\_Filter};
1138 \textcolor{preprocessor}{#else}
1139         SM\_FilterHook.h\_Entry = (\hyperlink{def__os2_8h_af632da489ebc3708ec3ab6791ee53fa4}{ULONG}(*)())\hyperlink{winfuncs_8c_a49e0e4d194d63d3aadfdc40401701b06}{SM\_Filter};
1140 \textcolor{preprocessor}{#endif}
1141         SM\_FilterHook.h\_Data = 0;
1142         SM\_FilterHook.h\_SubEntry = 0;
1143         SMR = AllocAslRequest(ASL\_ScreenModeRequest,\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
1144         \textcolor{keywordflow}{if} (AslRequestTags(SMR,
1145                 ASLSM\_FilterFunc, (\hyperlink{def__os2_8h_af632da489ebc3708ec3ab6791ee53fa4}{ULONG})&SM\_FilterHook,
1146                 TAG\_END))
1147         \hyperlink{winext_8h_adb4cf3b576bf85b4faa561cc99b62e84}{amii\_scrnmode} = SMR->sm\_DisplayID;
1148         \textcolor{keywordflow}{else}
1149         \hyperlink{winext_8h_adb4cf3b576bf85b4faa561cc99b62e84}{amii\_scrnmode} = 0;
1150         FreeAslRequest(SMR);
1151     \}
1152 
1153     \textcolor{keywordflow}{if}( forcenobig == 0 )
1154     \{
1155         \textcolor{keywordflow}{if}( ( wbscr = LockPubScreen( \textcolor{stringliteral}{"Workbench"} ) ) != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} ||
1156         ( wbscr = LockPubScreen( \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} ) ) != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
1157         \{
1158         \textcolor{comment}{/* Get the default pub screen's size */}
1159         modeid = GetVPModeID( &wbscr->ViewPort );
1160         \textcolor{keywordflow}{if}( modeid == INVALID\_ID ||
1161             ModeNotAvailable( modeid ) ||
1162             ( handle = FindDisplayInfo( modeid ) ) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} ||
1163             GetDisplayInfoData( handle, (\textcolor{keywordtype}{char} *)&dims, \textcolor{keyword}{sizeof}( dims ),
1164             DTAG\_DIMS, modeid ) <= 0 ||
1165             GetDisplayInfoData( handle, (\textcolor{keywordtype}{char} *)&disp, \textcolor{keyword}{sizeof}( disp ),
1166             DTAG\_DISP, modeid ) <= 0 )
1167         \{
1168             modeid = DEFAULT\_MONITOR\_ID|HIRES\_KEY;
1169             \textcolor{comment}{/* If the display database seems to not work, use the screen}
1170 \textcolor{comment}{             * dimensions}
1171 \textcolor{comment}{             */}
1172             \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Height = wbscr->Height;
1173             \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Width = wbscr->Width;
1174         
1175             \textcolor{comment}{/*}
1176 \textcolor{comment}{             * Request LACE if it looks laced.  For 2.1/3.0, we will get}
1177 \textcolor{comment}{             * promoted to the users choice of modes (if promotion is allowed)}
1178 \textcolor{comment}{             * If the user is using a dragable screen, things will get hosed}
1179 \textcolor{comment}{             * but that is life...}
1180 \textcolor{comment}{             */}
1181             \textcolor{keywordflow}{if}( wbscr->ViewPort.Modes & LACE )
1182             \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.ViewModes |= LACE;
1183             modeid = -1;
1184         \}
1185         \textcolor{keywordflow}{else}
1186         \{
1187             \textcolor{comment}{/* Use the display database to get the correct information */}
1188             \textcolor{keywordflow}{if}( disp.PropertyFlags & DIPF\_IS\_LACE )
1189             \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.ViewModes |= LACE;
1190             \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Height = dims.StdOScan.MaxY+1;
1191             \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Width = dims.StdOScan.MaxX+1;
1192         \}
1193         \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.TopEdge = 0;
1194         \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.LeftEdge = 0;
1195 
1196         UnlockPubScreen( \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, wbscr );
1197         \}
1198     \}
1199 
1200     \textcolor{keywordflow}{for}( i = 0; \hyperlink{winfuncs_8c_a3196b72476cb71b37649e1b48a7470e4}{scrntags}[i].ti\_Tag != TAG\_DONE; ++i )
1201     \{
1202         \textcolor{keywordflow}{switch}( \hyperlink{winfuncs_8c_a3196b72476cb71b37649e1b48a7470e4}{scrntags}[i].ti\_Tag )
1203         \{
1204         \textcolor{keywordflow}{case} SA\_DisplayID:
1205             \textcolor{keywordflow}{if}( !\hyperlink{winext_8h_adb4cf3b576bf85b4faa561cc99b62e84}{amii\_scrnmode} || ModeNotAvailable( \hyperlink{winext_8h_adb4cf3b576bf85b4faa561cc99b62e84}{amii\_scrnmode} ) )
1206             \{
1207             \textcolor{keywordflow}{if}( ModeNotAvailable( modeid ) )
1208             \{
1209                 \hyperlink{winfuncs_8c_a3196b72476cb71b37649e1b48a7470e4}{scrntags}[i].ti\_Tag = TAG\_IGNORE;
1210                 \textcolor{keywordflow}{break};
1211             \}
1212             \textcolor{keywordflow}{else}
1213                 \hyperlink{winfuncs_8c_a3196b72476cb71b37649e1b48a7470e4}{scrntags}[i].ti\_Data = (long)modeid;
1214             \}
1215             \textcolor{keywordflow}{else}
1216             modeid = \hyperlink{winfuncs_8c_a3196b72476cb71b37649e1b48a7470e4}{scrntags}[i].ti\_Data = (long)\hyperlink{winext_8h_adb4cf3b576bf85b4faa561cc99b62e84}{amii\_scrnmode};
1217             \textcolor{keywordflow}{if}( ( handle = FindDisplayInfo( modeid ) ) != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
1218             GetDisplayInfoData( handle, (\textcolor{keywordtype}{char} *)&dims, \textcolor{keyword}{sizeof}( dims ),
1219                 DTAG\_DIMS, modeid ) > 0 &&
1220             GetDisplayInfoData( handle, (\textcolor{keywordtype}{char} *)&disp, \textcolor{keyword}{sizeof}( disp ),
1221                 DTAG\_DISP, modeid ) > 0 )
1222             \{
1223             \textcolor{keywordflow}{if}( disp.PropertyFlags & DIPF\_IS\_LACE )
1224                 \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.ViewModes |= LACE;
1225             \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Height = dims.StdOScan.MaxY+1;
1226             \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Width = dims.StdOScan.MaxX+1;
1227             \}
1228             \textcolor{keywordflow}{break};
1229 
1230         \textcolor{keywordflow}{case} SA\_Pens:
1231             \hyperlink{winfuncs_8c_a3196b72476cb71b37649e1b48a7470e4}{scrntags}[i].ti\_Data = (long)\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.amii\_dripens;
1232             \textcolor{keywordflow}{break};
1233         \}
1234     \}
1235     \}
1236 \textcolor{preprocessor}{#endif}
1237 
1238     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
1239     \hyperlink{winfuncs_8c_a3ddc62e44fb01a556d409b3082c78a7a}{amii\_bmhd} = \hyperlink{winchar_8c_a12a3108f5619672ce857bcbaec0fac12}{ReadTileImageFiles}( );
1240     \textcolor{keywordflow}{else}
1241     memcpy( \hyperlink{winext_8h_a1b12e8b2fa45f0d58b47b42d920c641c}{amii\_initmap}, \hyperlink{winext_8h_a46e6dbfbaf847bf2f317972ba86aaed3}{amii\_init\_map}, \textcolor{keyword}{sizeof}( 
      \hyperlink{winext_8h_a1b12e8b2fa45f0d58b47b42d920c641c}{amii\_initmap} ) );
1242     memcpy(\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.amii\_curmap,\hyperlink{winext_8h_a1b12e8b2fa45f0d58b47b42d920c641c}{amii\_initmap},\textcolor{keyword}{sizeof}(\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.amii\_curmap));
1243 
1244     \textcolor{comment}{/* Find out how deep the screen needs to be, 32 planes is enough! */}
1245     \textcolor{keywordflow}{for}( i = 0; i < 32; ++i )
1246     \{
1247     \textcolor{keywordflow}{if}( ( 1L << i ) >= \hyperlink{winext_8h_ae3cfaa8053fd2f089c9fe1ba90289e98}{amii\_numcolors} )
1248         \textcolor{keywordflow}{break};
1249     \}
1250 
1251     \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Depth = i;
1252 
1253     \textcolor{comment}{/* If for some reason Height/Width became smaller than the required,}
1254 \textcolor{comment}{    have the required one */}
1255     \textcolor{keywordflow}{if} (\hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Height < \hyperlink{windefs_8h_ae189e98d0ef9263c37869ce1ff3710a5}{SCREENHEIGHT})
1256     \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Height = \hyperlink{windefs_8h_ae189e98d0ef9263c37869ce1ff3710a5}{SCREENHEIGHT};
1257     \textcolor{keywordflow}{if} (\hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Width < \hyperlink{mkmap_8c_a241aeeb764887ae5e3de58b98f04b16d}{WIDTH})
1258     \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Width = \hyperlink{mkmap_8c_a241aeeb764887ae5e3de58b98f04b16d}{WIDTH};
1259 \textcolor{preprocessor}{#ifdef HACKFONT}
1260     i = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(\hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont}->tf\_XSize, \hyperlink{winext_8h_addd84e576afd1379e2aa7fa9921de0a5}{HackFont}->tf\_XSize);
1261     \textcolor{keywordflow}{if} (\hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Width < 80*i+4)
1262     \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Width = 80*i+4;
1263 \textcolor{preprocessor}{#endif}
1264 
1265     \textcolor{comment}{/* While openscreen fails try fewer colors to see if that is the problem. */}
1266     \textcolor{keywordflow}{while}( ( \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen} = OpenScreen( (\textcolor{keywordtype}{void} *)&\hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen} ) ) == 
      \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
1267     \{
1268 \textcolor{preprocessor}{#ifdef  TEXTCOLOR}
1269     \textcolor{keywordflow}{if}( --\hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Depth < 3 )
1270 \textcolor{preprocessor}{#else}
1271     \textcolor{keywordflow}{if}( --\hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Depth < 2 )
1272 \textcolor{preprocessor}{#endif}
1273         \hyperlink{amiwind_8c_acd807e8b552ad939e3ae2fcb45e14c46}{Abort}( AN\_OpenScreen & ~AT\_DeadEnd );
1274     \}
1275     \hyperlink{winext_8h_ae3cfaa8053fd2f089c9fe1ba90289e98}{amii\_numcolors} = 1L << \hyperlink{winext_8h_aa1d9d5d32edf678e70a63a35504983bd}{NewHackScreen}.Depth;
1276     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->Height > 300 && forcenobig == 0 )
1277     \hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} = 1;
1278     \textcolor{keywordflow}{else}
1279     \hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} = 0;
1280 
1281 \textcolor{preprocessor}{#ifdef  INTUI\_NEW\_LOOK}
1282     \textcolor{keywordflow}{if}( IntuitionBase->LibNode.lib\_Version >= 37 )
1283     PubScreenStatus( \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}, 0 );
1284 \textcolor{preprocessor}{#endif}
1285 
1286     \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->Height;
1287     \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->Width;
1288 
1289     LoadRGB4(&\hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->ViewPort, \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.amii\_curmap, 
      \hyperlink{winext_8h_ae3cfaa8053fd2f089c9fe1ba90289e98}{amii\_numcolors} );
1290 
1291     \hyperlink{winext_8h_a2600aa64e49452deedad3f3d1e2e7977}{VisualInfo} = GetVisualInfo(\hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}, TAG\_END);
1292     \hyperlink{winext_8h_a53bb7c231eb4b4a1df2f0a7e3b21786a}{MenuStrip} = CreateMenus(\hyperlink{amimenu_8c_acd7767411f6f7ed30ebd817e7180ebee}{GTHackMenu}, TAG\_END);
1293     LayoutMenus(\hyperlink{winext_8h_a53bb7c231eb4b4a1df2f0a7e3b21786a}{MenuStrip}, \hyperlink{winext_8h_a2600aa64e49452deedad3f3d1e2e7977}{VisualInfo}, GTMN\_NewLookMenus, 
      \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, TAG\_END);
1294 
1295     \textcolor{comment}{/* Display the copyright etc... */}
1296 
1297     \textcolor{keywordflow}{if}( \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE} == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} )
1298     \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE} = \hyperlink{winfuncs_8c_accd860a04364dbcccc55022ee713e9d4}{amii\_create\_nhwindow}( \hyperlink{macwin_8h_ab575e634e51462bf534b7ee541cefc46}{NHW\_BASE} );
1299     \hyperlink{winfuncs_8c_ac2b43ff5e6b6394438fd8fde2008d264}{amii\_clear\_nhwindow}( \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE} );
1300     \hyperlink{winproto_8h_a9fdbf76005ec3ae5b77b3002366c04d3}{amii\_putstr}( \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE}, 0, \textcolor{stringliteral}{""} );
1301     \hyperlink{winproto_8h_a9fdbf76005ec3ae5b77b3002366c04d3}{amii\_putstr}( \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE}, 0, \textcolor{stringliteral}{""} );
1302     \hyperlink{winproto_8h_a9fdbf76005ec3ae5b77b3002366c04d3}{amii\_putstr}( \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE}, 0, \textcolor{stringliteral}{""} );
1303     \hyperlink{winproto_8h_a9fdbf76005ec3ae5b77b3002366c04d3}{amii\_putstr}( \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE}, 0, \hyperlink{patchlevel_8h_a31bf6260dfee590f28735d5a27134912}{COPYRIGHT\_BANNER\_A});
1304     \hyperlink{winproto_8h_a9fdbf76005ec3ae5b77b3002366c04d3}{amii\_putstr}( \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE}, 0, \hyperlink{patchlevel_8h_a991809ab96e6f409bbf21d0d6e81d633}{COPYRIGHT\_BANNER\_B});
1305     \hyperlink{winproto_8h_a9fdbf76005ec3ae5b77b3002366c04d3}{amii\_putstr}( \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE}, 0, \hyperlink{patchlevel_8h_a4eb1b20c11643715355dbf210025037f}{COPYRIGHT\_BANNER\_C});
1306     \hyperlink{winproto_8h_a9fdbf76005ec3ae5b77b3002366c04d3}{amii\_putstr}( \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE}, 0, \textcolor{stringliteral}{""});
1307 
1308     \hyperlink{amidos_8c_a55b41cec1916f4628807321204d03d9f}{Initialized} = 1;
1309 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a9c8bfd055bcb4a11d7cb73477faf8811}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+loadlib@{amii\+\_\+loadlib}}
\index{amii\+\_\+loadlib@{amii\+\_\+loadlib}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+loadlib}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+loadlib (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a9c8bfd055bcb4a11d7cb73477faf8811}


Definition at line 932 of file amiwind.\+c.


\begin{DoxyCode}
933 \{
934 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ac8c0864548759176d8020d4f682eadf4}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+mark\+\_\+synch@{amii\+\_\+mark\+\_\+synch}}
\index{amii\+\_\+mark\+\_\+synch@{amii\+\_\+mark\+\_\+synch}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+mark\+\_\+synch}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+mark\+\_\+synch (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ac8c0864548759176d8020d4f682eadf4}


Definition at line 2206 of file winfuncs.\+c.



References ami\+I\+Display.


\begin{DoxyCode}
2207 \{
2208     \textcolor{keywordflow}{if}(!\hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay})
2209     fflush(stderr);
2210 \textcolor{comment}{/* anything else?  do we need this much? */}
2211 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a6a1482acb616e0e5300e1f7655ff1a31}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+msgborder@{amii\+\_\+msgborder}}
\index{amii\+\_\+msgborder@{amii\+\_\+msgborder}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+msgborder}]{\setlength{\rightskip}{0pt plus 5cm}int amii\+\_\+msgborder (
\begin{DoxyParamCaption}
\item[{struct Window $\ast$}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a6a1482acb616e0e5300e1f7655ff1a31}


Definition at line 324 of file winstr.\+c.



Referenced by amii\+\_\+addtopl(), amii\+\_\+putstr(), amii\+\_\+scrollmsg(), and outmore().


\begin{DoxyCode}
326 \{
327     \textcolor{keyword}{register} \textcolor{keywordtype}{int} bottom;
328 
329     \textcolor{comment}{/* There is a one pixel border at the borders, so subtract two */}
330     bottom = w->Height - w->BorderTop - w->BorderBottom - 2;
331     bottom /= w->RPort->TxHeight;
332     \textcolor{keywordflow}{if}( bottom > 0 )
333     --bottom;
334     \textcolor{keywordflow}{return}( bottom );
335 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a8a5e71a57c4b97bc82326de356d6e6f2}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+nh\+\_\+poskey@{amii\+\_\+nh\+\_\+poskey}}
\index{amii\+\_\+nh\+\_\+poskey@{amii\+\_\+nh\+\_\+poskey}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+nh\+\_\+poskey}]{\setlength{\rightskip}{0pt plus 5cm}int amii\+\_\+nh\+\_\+poskey (
\begin{DoxyParamCaption}
\item[{int $\ast$}]{x, }
\item[{int $\ast$}]{y, }
\item[{int $\ast$}]{mod}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a8a5e71a57c4b97bc82326de356d6e6f2}


Definition at line 9 of file winkey.\+c.



References amii\+\_\+wins, C\+L\+I\+C\+K\+\_\+1, cursor\+\_\+on(), amii\+\_\+\+Win\+Desc\+::disprows, F\+L\+M\+A\+P\+\_\+\+S\+K\+I\+P, F\+L\+M\+S\+G\+\_\+\+F\+I\+R\+S\+T, W\+E\+V\+E\+N\+T\+::key, lastevent, M\+A\+P\+F\+T\+B\+A\+S\+E\+L\+N, W\+E\+V\+E\+N\+T\+::mouse, mxsize, mysize, panic(), rp, scrollmsg, W\+E\+V\+E\+N\+T\+::type, type, W\+E\+V\+E\+N\+T\+::un, W\+E\+K\+E\+Y, W\+E\+M\+O\+U\+S\+E, W\+E\+U\+N\+K, amii\+\_\+\+Win\+Desc\+::wflags, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+M\+A\+P, W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E, and Window\+Getevent().


\begin{DoxyCode}
11 \{
12     \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
13     \hyperlink{winami_8h_a947974ed96ae99c292b698854e310ebe}{WETYPE} \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type};
14     \textcolor{keyword}{struct }RastPort *\hyperlink{amirip_8c_aa0639b6491ec144930d14703053f32a4}{rp};
15     \textcolor{keyword}{struct }Window *w;
16 
17     \textcolor{keywordflow}{if}( cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[\hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE}] )
18     \{
19     cw->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} &= ~\hyperlink{winami_8h_a20db85ff854e288c5f3b7c380e6ceb91}{FLMAP\_SKIP};
20     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a3b783f5f077454f156585be54b99746b}{scrollmsg} )
21         cw->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} |= \hyperlink{winami_8h_af95b04a23fff7c0980bd67ba40e706c3}{FLMSG\_FIRST};
22     cw->\hyperlink{structamii__WinDesc_ad73ea3210d2bf3840205b8a4b720f13d}{disprows} = 0;
23     \}
24 
25     \textcolor{keywordflow}{if}( \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && (cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} ]) && ( w = cw->
      \hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} ) )
26     \{
27     \hyperlink{winfuncs_8c_ae43c0ee78599c3fa7f2fe2fe4c2b71a1}{cursor\_on}( WIN\_MAP );
28     \}
29     \textcolor{keywordflow}{else}
30     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \textcolor{stringliteral}{"no MAP window opened for nh\_poskey\(\backslash\)n"} );
31 
32     rp = w->RPort;
33 
34     \textcolor{keywordflow}{while}( 1 )
35     \{
36     type = \hyperlink{winproto_8h_a0cf134f2e1ce65f95d4c673c8c03ab2d}{WindowGetevent}( );
37     \textcolor{keywordflow}{if}( type == \hyperlink{winami_8h_a947974ed96ae99c292b698854e310ebeaf0996b4496d062931ea8d4d9124f585f}{WEMOUSE} )
38     \{
39         *mod = \hyperlink{wintype_8h_acaefc3f142237be043fe21977bf19afe}{CLICK\_1};
40         \textcolor{keywordflow}{if}( \hyperlink{winext_8h_ad7aa01c8c967c217496fa16833727f6c}{lastevent}.\hyperlink{structWEVENT_aa1fde3395f49a17259c056ec58ffc1e9}{un}.\hyperlink{structWEVENT_a28753a26ccd665dcb9d2a253556911ef}{mouse}.qual )
41         *mod = 0;
42 
43         \textcolor{comment}{/* X coordinates are 1 based, Y are 1 based. */}
44         *x = ( (\hyperlink{winext_8h_ad7aa01c8c967c217496fa16833727f6c}{lastevent}.\hyperlink{structWEVENT_aa1fde3395f49a17259c056ec58ffc1e9}{un}.\hyperlink{structWEVENT_a28753a26ccd665dcb9d2a253556911ef}{mouse}.x - w->BorderLeft) / \hyperlink{winext_8h_afba9a8d2cd024c7010eae489091d11d6}{mxsize} ) + 1;
45         *y = ( ( \hyperlink{winext_8h_ad7aa01c8c967c217496fa16833727f6c}{lastevent}.\hyperlink{structWEVENT_aa1fde3395f49a17259c056ec58ffc1e9}{un}.\hyperlink{structWEVENT_a28753a26ccd665dcb9d2a253556911ef}{mouse}.y - w->BorderTop - 
      \hyperlink{windefs_8h_acc4b1cc60331df1087a0e27eaac426c7}{MAPFTBASELN} ) /
46             \hyperlink{winext_8h_a9703aea67c83633a25beaa737dad2b65}{mysize} ) + 1;
47 \textcolor{preprocessor}{#ifdef  CLIPPING}
48         \textcolor{keywordflow}{if}( clipping )
49         \{
50         *x += clipx;
51         *y += clipy;
52         \}
53 \textcolor{preprocessor}{#endif}
54         \textcolor{keywordflow}{return}( 0 );
55     \}
56     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( type == \hyperlink{winami_8h_a947974ed96ae99c292b698854e310ebea04eab5e241ff2fdc5893f123379e58ca}{WEKEY} )
57     \{
58         \hyperlink{winext_8h_ad7aa01c8c967c217496fa16833727f6c}{lastevent}.\hyperlink{structWEVENT_a218bdffc41cff7b53f666a9a1f0fd714}{type} = \hyperlink{winami_8h_a947974ed96ae99c292b698854e310ebea534664448b776dc2ec1e4cb468538d14}{WEUNK};
59         \textcolor{keywordflow}{return}( \hyperlink{winext_8h_ad7aa01c8c967c217496fa16833727f6c}{lastevent}.\hyperlink{structWEVENT_aa1fde3395f49a17259c056ec58ffc1e9}{un}.\hyperlink{structWEVENT_a33aabbd5a0f5cb005e24df8ccc93bf67}{key} );
60     \}
61     \}
62 \}
\end{DoxyCode}
\hypertarget{winproto_8h_afd65a0d6a2b0455f657812d7e3675b06}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+nhgetch@{amii\+\_\+nhgetch}}
\index{amii\+\_\+nhgetch@{amii\+\_\+nhgetch}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+nhgetch}]{\setlength{\rightskip}{0pt plus 5cm}int amii\+\_\+nhgetch (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_afd65a0d6a2b0455f657812d7e3675b06}


Definition at line 65 of file winkey.\+c.



References amii\+\_\+wins, cursor\+\_\+on(), F\+L\+M\+A\+P\+\_\+\+S\+K\+I\+P, amii\+\_\+\+Win\+Desc\+::wflags, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+M\+A\+P, W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E, and Window\+Getchar().


\begin{DoxyCode}
66 \{
67     \textcolor{keywordtype}{int} ch;
68     \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw=\hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[\hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE}];
69 
70     \textcolor{keywordflow}{if}( \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} ] )
71     \{
72     \hyperlink{winfuncs_8c_ae43c0ee78599c3fa7f2fe2fe4c2b71a1}{cursor\_on}( WIN\_MAP );
73     \}
74     \textcolor{keywordflow}{if}(cw)
75     cw->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} &= ~\hyperlink{winami_8h_a20db85ff854e288c5f3b7c380e6ceb91}{FLMAP\_SKIP};
76 
77     ch = \hyperlink{winproto_8h_a173d2dc6a888352bb65b7cacd4576308}{WindowGetchar}();
78     \textcolor{keywordflow}{return}( ch );
79 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a7ac539968f0a526e1a4dd733d88f4b53}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+number\+\_\+pad@{amii\+\_\+number\+\_\+pad}}
\index{amii\+\_\+number\+\_\+pad@{amii\+\_\+number\+\_\+pad}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+number\+\_\+pad}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+number\+\_\+pad (
\begin{DoxyParamCaption}
\item[{int}]{state}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a7ac539968f0a526e1a4dd733d88f4b53}
\hypertarget{winproto_8h_ad99322c107df2755cbeeb440e8991bb9}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+player\+\_\+selection@{amii\+\_\+player\+\_\+selection}}
\index{amii\+\_\+player\+\_\+selection@{amii\+\_\+player\+\_\+selection}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+player\+\_\+selection}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+player\+\_\+selection (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ad99322c107df2755cbeeb440e8991bb9}
\hypertarget{winproto_8h_ad2513d411f99ff1bb783473275fedd1a}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+print\+\_\+glyph@{amii\+\_\+print\+\_\+glyph}}
\index{amii\+\_\+print\+\_\+glyph@{amii\+\_\+print\+\_\+glyph}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+print\+\_\+glyph}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+print\+\_\+glyph (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{win, }
\item[{{\bf xchar}}]{x, }
\item[{{\bf xchar}}]{y, }
\item[{int}]{glyph}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ad2513d411f99ff1bb783473275fedd1a}


Definition at line 2039 of file winfuncs.\+c.



References amiga\+\_\+print\+\_\+glyph(), amii\+\_\+curs(), amii\+\_\+wins, amii\+\_\+\+Win\+Desc\+::curx, d\+\_\+level\+::dlevel, Is\+\_\+rogue\+\_\+level, mapglyph(), N\+H\+W\+\_\+\+M\+A\+P, N\+O\+\_\+\+C\+O\+L\+O\+R, N\+U\+L\+L, panic(), R\+E\+I\+N\+C\+A\+R\+N\+A\+T\+I\+O\+N, amii\+\_\+\+Win\+Desc\+::type, u, you\+::uz, W\+I\+N\+\_\+\+E\+R\+R, winpanicstr, and W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V.


\begin{DoxyCode}
2043 \{
2044     \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
2045     \hyperlink{config_8h_a65f85814a8290f9797005d3b28e7e5fc}{uchar}   ch;
2046     \textcolor{keywordtype}{int}     color, och;
2047     \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keywordtype}{int} zapcolors[];
2048     \textcolor{keywordtype}{unsigned} special;
2049 
2050     \textcolor{comment}{/* In order for the overview window to work, we can not clip here */}
2051     \textcolor{keywordflow}{if}( !\hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
2052     \{
2053 \textcolor{preprocessor}{#ifdef  CLIPPING}
2054     \textcolor{comment}{/* If point not in visible part of window just skip it */}
2055     \textcolor{keywordflow}{if}( clipping )
2056     \{
2057         \textcolor{keywordflow}{if}( x <= clipx || y < clipy || x >= clipxmax || y >= clipymax )
2058         \textcolor{keywordflow}{return};
2059     \}
2060 \textcolor{preprocessor}{#endif}
2061     \}
2062 
2063     \textcolor{keywordflow}{if}( \hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} || (cw=\hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}]) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || cw->
      \hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} != \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP})
2064     \{
2065     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\hyperlink{winext_8h_a4264157ee8930111caf21b62c212e08c}{winpanicstr},win,\textcolor{stringliteral}{"amii\_print\_glyph"});
2066     \}
2067 
2068 \textcolor{preprocessor}{#if 0}
2069 \{
2070 \textcolor{keyword}{static} \textcolor{keywordtype}{int} x=-1;
2071 \textcolor{keywordflow}{if}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}.\hyperlink{structd__level_a7878568dc81a7efd40bea0206dbd109d}{dlevel} != x)\{
2072  fprintf(stderr,\textcolor{stringliteral}{"lvlchg: %d (%d)\(\backslash\)n"},\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}.\hyperlink{structd__level_a7878568dc81a7efd40bea0206dbd109d}{dlevel},\hyperlink{dungeon_8h_a2732117523c8540638daf4315dda16b9}{Is\_rogue\_level}(&
      \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}));
2073  x = \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}.\hyperlink{structd__level_a7878568dc81a7efd40bea0206dbd109d}{dlevel};
2074 \}
2075 \}
2076 \textcolor{preprocessor}{#endif}
2077     \textcolor{keywordflow}{if}(
2078     \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV}
2079 #ifdef \hyperlink{config_8h_a6b9728c18024eafa560aaeb30159e47d}{REINCARNATION}
2080     && !\hyperlink{dungeon_8h_a2732117523c8540638daf4315dda16b9}{Is\_rogue\_level}(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz})
2081 #endif
2082     )
2083     \{
2084     \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}(win,x,y);
2085     \hyperlink{winproto_8h_a203b786b96fe4c8be21c63f474486d52}{amiga\_print\_glyph}(win,0,glyph);
2086     \}
2087     \textcolor{keywordflow}{else}        \textcolor{comment}{/* AMII, or Rogue level in either version */}
2088     \{
2089     \textcolor{comment}{/* map glyph to character and color */}
2090         \hyperlink{mapglyph_8c_a41586afa30d047782223d168f8912784}{mapglyph}(glyph, &och, &color, &special, x, y);
2091                 \textcolor{comment}{/* XXX next if should be ifdef REINCARNATION */}
2092     ch = (\hyperlink{config_8h_a65f85814a8290f9797005d3b28e7e5fc}{uchar})och;
2093     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )\{         \textcolor{comment}{/* implies Rogue level here */}
2094         \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}(win,x,y);
2095         \hyperlink{winproto_8h_a203b786b96fe4c8be21c63f474486d52}{amiga\_print\_glyph}(win,\hyperlink{color_8h_a69d859e537f858ca285d77a66755ded6}{NO\_COLOR},ch + 10000);
2096     \} \textcolor{keywordflow}{else} \{
2097         \textcolor{comment}{/* Move the cursor. */}
2098         \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}(win,x,y+2);
2099 
2100 \textcolor{preprocessor}{#ifdef TEXTCOLOR}
2101         \textcolor{comment}{/* Turn off color if rogue level. */}
2102 \textcolor{preprocessor}{# ifdef REINCARNATION}
2103         \textcolor{keywordflow}{if} (\hyperlink{dungeon_8h_a2732117523c8540638daf4315dda16b9}{Is\_rogue\_level}(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}))
2104         color = \hyperlink{color_8h_a69d859e537f858ca285d77a66755ded6}{NO\_COLOR};
2105 \textcolor{preprocessor}{#  endif}
2106 
2107         \hyperlink{winproto_8h_a203b786b96fe4c8be21c63f474486d52}{amiga\_print\_glyph}(win,color,ch);
2108 \textcolor{preprocessor}{#else}
2109         g\_putch(ch);    \textcolor{comment}{/* print the character */}
2110 \textcolor{preprocessor}{#endif}
2111         cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx}++;     \textcolor{comment}{/* one character over */}
2112     \}
2113     \}
2114 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a9fdbf76005ec3ae5b77b3002366c04d3}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+putstr@{amii\+\_\+putstr}}
\index{amii\+\_\+putstr@{amii\+\_\+putstr}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+putstr}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+putstr (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{window, }
\item[{int}]{attr, }
\item[{{\bf const} char $\ast$}]{str}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a9fdbf76005ec3ae5b77b3002366c04d3}


Definition at line 12 of file winstr.\+c.



References alloc(), amii\+\_\+cl\+\_\+end(), amii\+\_\+create\+\_\+nhwindow(), amii\+\_\+curs(), amii\+\_\+msgborder(), amii\+\_\+scrollmsg(), amii\+\_\+sethipens(), amii\+\_\+wins, ami\+I\+Display, flag\+::botlx, amii\+\_\+\+Win\+Desc\+::cols, Count\+Lines(), amii\+\_\+\+Win\+Desc\+::curx, amii\+\_\+\+Win\+Desc\+::cury, amii\+\_\+\+Win\+Desc\+::data, flags, F\+L\+M\+S\+G\+\_\+\+F\+I\+R\+S\+T, free(), iflags, amii\+\_\+\+Display\+Desc\+::lastwin, max, amii\+\_\+\+Win\+Desc\+::maxcol, amii\+\_\+\+Win\+Desc\+::maxrow, instance\+\_\+flags\+::msg\+\_\+history, Msg\+Scroll, N\+H\+W\+\_\+\+B\+A\+S\+E, N\+H\+W\+\_\+\+M\+A\+P, N\+H\+W\+\_\+\+M\+E\+N\+U, N\+H\+W\+\_\+\+M\+E\+S\+S\+A\+G\+E, N\+H\+W\+\_\+\+S\+T\+A\+T\+U\+S, N\+H\+W\+\_\+\+T\+E\+X\+T, N\+U\+L\+L, outmore(), outsubstr(), panic(), amii\+\_\+\+Win\+Desc\+::rows, scrollmsg, S\+E\+L\+\_\+\+I\+T\+E\+M, Set\+Prop\+Info(), S\+O\+F\+F, Strcpy, T\+B\+U\+F\+S\+Z, Text\+Spaces(), toplines, amii\+\_\+\+Win\+Desc\+::type, V\+A\+T\+T\+R, amii\+\_\+\+Win\+Desc\+::vwy, amii\+\_\+\+Win\+Desc\+::wflags, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+B\+A\+S\+E, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E, instance\+\_\+flags\+::window\+\_\+inited, winpanicstr, and W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V.



Referenced by amii\+\_\+add\+\_\+menu(), amii\+\_\+addtopl(), amii\+\_\+init\+\_\+nhwindows(), amii\+\_\+raw\+\_\+print(), amii\+\_\+raw\+\_\+print\+\_\+bold(), and amiv\+\_\+flush\+\_\+glyph\+\_\+buffer().


\begin{DoxyCode}
16 \{
17     \textcolor{keywordtype}{int} fudge;
18     \textcolor{keywordtype}{int} len;
19     \textcolor{keyword}{struct }Window *w;
20     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
21     \textcolor{keywordtype}{char} *ob;
22     \textcolor{keywordtype}{int} i, j, n0, bottom, totalvis, wheight;
23     \textcolor{keyword}{static} \textcolor{keywordtype}{int} wrapping = 0;
24 
25     \textcolor{comment}{/* Always try to avoid a panic when there is no window */}
26     \textcolor{keywordflow}{if}( window == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} )
27     \{
28     window = \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE};
29     \textcolor{keywordflow}{if}( window == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} )
30         window = \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE} = \hyperlink{winfuncs_8c_accd860a04364dbcccc55022ee713e9d4}{amii\_create\_nhwindow}( 
      \hyperlink{macwin_8h_ab575e634e51462bf534b7ee541cefc46}{NHW\_BASE} );
31     \}
32 
33     \textcolor{keywordflow}{if}( window == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} || ( cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[window] ) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
34     \{
35     \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_a2fc6c78c4c5f6e1d0027ac575135426f}{window\_inited}=0;
36     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\hyperlink{winext_8h_a4264157ee8930111caf21b62c212e08c}{winpanicstr},window, \textcolor{stringliteral}{"putstr"});
37     \}
38 
39     w = cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
40 
41     \textcolor{keywordflow}{if}(!str) \textcolor{keywordflow}{return};
42     \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a7cba815a57de07b72960832e3e454fb2}{lastwin} = window;    \textcolor{comment}{/* do we care??? */}
43 
44     \textcolor{comment}{/* NHW\_MENU windows are not opened immediately, so check if we}
45 \textcolor{comment}{     * have the window pointer yet}
46 \textcolor{comment}{     */}
47 
48     \textcolor{keywordflow}{if}( w )
49     \{
50     \textcolor{comment}{/* Set the drawing mode and pen colors */}
51     SetDrMd( w->RPort, JAM2 );
52     \hyperlink{winfuncs_8c_af3f6522f0bcc54d4a193d32ff11ec28b}{amii\_sethipens}( w, cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type}, attr );
53     \}
54     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} != \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU} && cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} != \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT} )
55     \{
56     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \textcolor{stringliteral}{"NULL window pointer in putstr 2: %d"}, window );
57     \}
58 
59     \textcolor{comment}{/* Okay now do the work for each type */}
60 
61     \textcolor{keywordflow}{switch}(cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type})
62     \{
63     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE}:
64     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
65         fudge = 2;
66     \textcolor{keywordflow}{else}
67     \{
68         \textcolor{comment}{/* 8 for --more--, 1 for preceeding sp, 1 for putstr pad */}
69         fudge = 10;
70     \}
71 
72         \textcolor{comment}{/* There is a one pixel border at the borders, so subtract two */}
73         bottom = \hyperlink{winstr_8c_afd2be902c5244111f384679cbc6e938a}{amii\_msgborder}( w );
74 
75     wheight = ( w->Height - w->BorderTop -
76                 w->BorderBottom - 3 ) / w->RPort->TxHeight;
77     
78     if (\hyperlink{winext_8h_a3b783f5f077454f156585be54b99746b}{scrollmsg} || wheight > 1)
79         fudge = 0;
80 
81     \hyperlink{winstr_8c_aead52ebe70c4c803280a76eb0f962239}{amii\_scrollmsg}( w, cw );
82 
83     \textcolor{keywordflow}{while} (isspace(*str)) str++;
84     strncpy( \hyperlink{decl_8h_a7d07429fa6ffa68fab837a5c9a0a3528}{toplines}, str, \hyperlink{global_8h_aa18046886c403e831e620d0bfb76bdc7}{TBUFSZ} );
85     \hyperlink{decl_8h_a7d07429fa6ffa68fab837a5c9a0a3528}{toplines}[ \hyperlink{global_8h_aa18046886c403e831e620d0bfb76bdc7}{TBUFSZ} - 1 ] = 0;
86 
87     \textcolor{comment}{/* For initial message to be visible, we need to explicitly position the}
88 \textcolor{comment}{     * cursor.  This flag, cw->curx == -1 is set elsewhere to force the}
89 \textcolor{comment}{     * cursor to be repositioned to the "bottom".}
90 \textcolor{comment}{     */}
91     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} == -1 )
92     \{
93         \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}( \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE}, 1, bottom );
94         cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} = 0;
95     \}
96 
97     \textcolor{comment}{/* If used all of history lines, move them down */}
98     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow} >= \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_adbf4e331046e9ace346e832fc8a59074}{msg\_history} )
99     \{
100         \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ 0 ] )
101         \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ 0 ] );
102         memcpy( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}, &cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ 1 ],
103         ( \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_adbf4e331046e9ace346e832fc8a59074}{msg\_history} - 1 ) * \textcolor{keyword}{sizeof}( \textcolor{keywordtype}{char} * ) );
104         cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_adbf4e331046e9ace346e832fc8a59074}{msg\_history} - 1 ] =
105                 (\textcolor{keywordtype}{char} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}( strlen( \hyperlink{decl_8h_a7d07429fa6ffa68fab837a5c9a0a3528}{toplines} ) + 5 );
106         strcpy( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ i = \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_adbf4e331046e9ace346e832fc8a59074}{msg\_history} - 1 ] +
107                 \hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF} + (\hyperlink{winext_8h_a3b783f5f077454f156585be54b99746b}{scrollmsg}!=0), \hyperlink{decl_8h_a7d07429fa6ffa68fab837a5c9a0a3528}{toplines} );
108     \}
109     \textcolor{keywordflow}{else}
110     \{
111         \textcolor{comment}{/* Otherwise, allocate a new one and copy the line in */}
112         cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow} ] = (\textcolor{keywordtype}{char} *)
113                     \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}( strlen( \hyperlink{decl_8h_a7d07429fa6ffa68fab837a5c9a0a3528}{toplines} ) + 5 );
114         strcpy( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ i = cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow}++ ] +
115                 \hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF} + (\hyperlink{winext_8h_a3b783f5f077454f156585be54b99746b}{scrollmsg}!=0), \hyperlink{decl_8h_a7d07429fa6ffa68fab837a5c9a0a3528}{toplines} );
116     \}
117     cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ i ][ \hyperlink{windefs_8h_a5840a65df04b15a5a319b3cae209fe18}{SEL\_ITEM} ] = 1;
118     cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ i ][ \hyperlink{windefs_8h_af0df26fe796d3771454cde6d3438a11b}{VATTR} ] = attr+1;
119 
120     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a3b783f5f077454f156585be54b99746b}{scrollmsg} )
121     \{
122         cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} = 0;
123         cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ i ][2] = (cw->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} & \hyperlink{winami_8h_af95b04a23fff7c0980bd67ba40e706c3}{FLMSG\_FIRST} ) ? \textcolor{charliteral}{'>'} : \textcolor{charliteral}{' '};
124     \}
125 
126     str = cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[i] + \hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF};
127     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} + strlen(str) >= (cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols}-fudge) )
128     \{
129         \textcolor{keywordtype}{int} i;
130         \textcolor{keywordtype}{char} *ostr = (\textcolor{keywordtype}{char} *)str;
131         \textcolor{keywordtype}{char} *p;
132 
133         \textcolor{keywordflow}{while}( cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} + strlen( str ) >= (cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols}-fudge) )
134         \{
135         \textcolor{keywordflow}{for}(p=((\textcolor{keywordtype}{char} *)&str[ cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols}-1 - cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} ])-fudge; !isspace(*p) && p > str;)
136             --p;
137         \textcolor{keywordflow}{if} (p < str) p = (\textcolor{keywordtype}{char} *)str;
138 
139         \textcolor{keywordflow}{if}( p == str ) \{
140         \textcolor{comment}{/*    p = (char *)&str[ cw->cols ]; */}
141             \hyperlink{winstr_8c_a55e9e9c33e29d3698d29ff252bf2aae8}{outmore}(cw);
142             \textcolor{keywordflow}{continue};
143         \}
144 
145         i = (long)p-(\textcolor{keywordtype}{long})str;
146         \hyperlink{winstr_8c_a93a76f6f311b1a6c5bf0b64a3904c462}{outsubstr}( cw, (\textcolor{keywordtype}{char} *)str, i, fudge );
147         cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} += i;
148 
149         \textcolor{keywordflow}{while}(isspace(*p)) p++;
150         str = p;
151 
152 \textcolor{preprocessor}{#if 0}
153         \textcolor{keywordflow}{if}( str != ostr ) \{
154             \hyperlink{winstr_8c_a93a76f6f311b1a6c5bf0b64a3904c462}{outsubstr}( cw, \textcolor{stringliteral}{"+"}, 1, fudge );
155             cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx}+=2;
156         \}
157 \textcolor{preprocessor}{#endif}
158         \textcolor{keywordflow}{if}(*str)
159             \hyperlink{winstr_8c_aead52ebe70c4c803280a76eb0f962239}{amii\_scrollmsg}( w, cw );
160         \hyperlink{winfuncs_8c_ace7ed7ac165d8e68bbc3df59a8ac5ec6}{amii\_cl\_end}( cw, cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} );
161         \}
162 
163         \textcolor{keywordflow}{if}( *str )
164         \{
165         \textcolor{keywordflow}{if}( str != ostr )
166         \{
167             \hyperlink{winstr_8c_a93a76f6f311b1a6c5bf0b64a3904c462}{outsubstr}( cw, \textcolor{stringliteral}{"+"}, 1, fudge );
168             cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx}+=2;
169         \}
170         \textcolor{keywordflow}{while} ( isspace( *str ) )
171             ++str;
172         \hyperlink{winstr_8c_a93a76f6f311b1a6c5bf0b64a3904c462}{outsubstr}( cw, (\textcolor{keywordtype}{char} *)str, i = strlen( (\textcolor{keywordtype}{char} *)str ), fudge );
173         cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} += i;
174         \hyperlink{winfuncs_8c_ace7ed7ac165d8e68bbc3df59a8ac5ec6}{amii\_cl\_end}( cw, cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} );
175         \}
176     \}
177     \textcolor{keywordflow}{else}
178     \{
179         \hyperlink{winstr_8c_a93a76f6f311b1a6c5bf0b64a3904c462}{outsubstr}( cw, (\textcolor{keywordtype}{char} *)str, i = strlen( (\textcolor{keywordtype}{char} *)str ), fudge );
180         cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} += i;
181         \hyperlink{winfuncs_8c_ace7ed7ac165d8e68bbc3df59a8ac5ec6}{amii\_cl\_end}( cw, cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} );
182     \}
183     cw->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} &= ~\hyperlink{winami_8h_af95b04a23fff7c0980bd67ba40e706c3}{FLMSG\_FIRST};
184     len = 0;
185     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a3b783f5f077454f156585be54b99746b}{scrollmsg} )
186     \{
187         totalvis = \hyperlink{sys_2amiga_2winmenu_8c_aab1d3a28e3b2dd6770eae7e837fa27dd}{CountLines}( window );
188         \hyperlink{sys_2amiga_2winmenu_8c_a28121fc0d5fc72d2292fa04d5bbf7d60}{SetPropInfo}( w, &\hyperlink{winext_8h_a7714cdb5ca9e060cae6bfc059f1973f4}{MsgScroll},
189           ( w->Height-w->BorderTop-w->BorderBottom ) / w->RPort->TxHeight,
190           totalvis, totalvis );
191     \}
192     i = strlen( \hyperlink{decl_8h_a7d07429fa6ffa68fab837a5c9a0a3528}{toplines} + \hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF} );
193     cw->\hyperlink{structamii__WinDesc_a7abaf7568c45c6f6efabdfdc13164a4c}{maxcol} = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}( cw->\hyperlink{structamii__WinDesc_a7abaf7568c45c6f6efabdfdc13164a4c}{maxcol}, i );
194     cw->\hyperlink{structamii__WinDesc_a55e0b7473323fe60385ad4750437b831}{vwy} = cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow};
195     \textcolor{keywordflow}{break};
196 
197     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a8ed5b99ab7f854ace5f67f89aaae5404}{NHW\_STATUS}:
198     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury} ] == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
199         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \textcolor{stringliteral}{"NULL pointer for status window"} );
200     ob = &cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury}][j = cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx}];
201     \textcolor{keywordflow}{if}(\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a4f41387168e1a58d95db3f635eec780e}{botlx}) *ob = 0;
202 
203         \textcolor{comment}{/* Display when beam at top to avoid flicker... */}
204     WaitTOF();
205     Text(w->RPort,(\textcolor{keywordtype}{char} *)str,strlen((\textcolor{keywordtype}{char} *)str));
206     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} > strlen( str ) )
207         \hyperlink{winstr_8c_a948e00a84111ca94231f9b411ed7ec42}{TextSpaces}( w->RPort, cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} - strlen( str ) );
208 
209     (void) strncpy(cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury}], str, cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} );
210     cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury}][cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols}-1] = \textcolor{charliteral}{'\(\backslash\)0'}; \textcolor{comment}{/* null terminate */}
211     cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury} = (cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury}+1) % 2;
212     cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} = 0;
213     \textcolor{keywordflow}{break};
214 
215     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP}:
216     \textcolor{keywordflow}{case} \hyperlink{macwin_8h_ab575e634e51462bf534b7ee541cefc46}{NHW\_BASE}:
217     \textcolor{keywordflow}{if} (cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{macwin_8h_ab575e634e51462bf534b7ee541cefc46}{NHW\_BASE} && wrapping) \{
218         \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}(window, cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx}+1, cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury});
219         \hyperlink{winstr_8c_a948e00a84111ca94231f9b411ed7ec42}{TextSpaces}(w->RPort, cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols});
220         \textcolor{keywordflow}{if} (cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury} < cw->\hyperlink{structamii__WinDesc_a465b4a9c04b3c325f2af2722aac9c5f3}{rows}) \{
221         \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}(window, cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx}+1, cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury}+1);
222         \hyperlink{winstr_8c_a948e00a84111ca94231f9b411ed7ec42}{TextSpaces}(w->RPort, cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols});
223         cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury}--;
224         \}
225     \}
226     \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}(window, cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx}+1, cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury});
227     Text(w->RPort,(\textcolor{keywordtype}{char} *)str,strlen((\textcolor{keywordtype}{char} *)str));
228     cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} = 0;
229         \textcolor{comment}{/* CR-LF is automatic in these windows */}
230     cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury}++;
231     \textcolor{keywordflow}{if} (cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{macwin_8h_ab575e634e51462bf534b7ee541cefc46}{NHW\_BASE} && cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury} >= cw->\hyperlink{structamii__WinDesc_a465b4a9c04b3c325f2af2722aac9c5f3}{rows}) \{
232         cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury} = 0;
233         wrapping = 1;
234     \}
235     \textcolor{keywordflow}{break};
236 
237     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU}:
238     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT}:
239 
240     \textcolor{comment}{/* always grows one at a time, but alloc 12 at a time */}
241 
242     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury} >= cw->\hyperlink{structamii__WinDesc_a465b4a9c04b3c325f2af2722aac9c5f3}{rows} || !cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data} )
243     \{
244         \textcolor{keywordtype}{char} **tmp;
245 
246         \textcolor{comment}{/* Allocate 12 more rows */}
247         cw->\hyperlink{structamii__WinDesc_a465b4a9c04b3c325f2af2722aac9c5f3}{rows} += 12;
248         tmp = (\textcolor{keywordtype}{char}**) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}*) * cw->\hyperlink{structamii__WinDesc_a465b4a9c04b3c325f2af2722aac9c5f3}{rows});
249 
250         \textcolor{comment}{/* Copy the old lines */}
251         \textcolor{keywordflow}{for}(i=0; i<cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury}; i++)
252         tmp[i] = cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[i];
253 
254         \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data} ) \{
255         \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data} );
256         cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
257         \}
258 
259         cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data} = tmp;
260 
261         \textcolor{comment}{/* Null out the unused entries. */}
262         \textcolor{keywordflow}{for}(i=cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury}; i<cw->\hyperlink{structamii__WinDesc_a465b4a9c04b3c325f2af2722aac9c5f3}{rows}; i++)
263         cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[i] = 0;
264     \}
265 
266     \textcolor{keywordflow}{if}( !cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data} )
267         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"no data storage"});
268 
269         \textcolor{comment}{/* Shouldn't need to do this, but... */}
270 
271     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data} && cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury}] ) \{
272         \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury}] );
273         cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury}] = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
274     \}
275 
276     n0 = strlen(str)+1;
277     cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury}] = (\textcolor{keywordtype}{char}*) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(n0+\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF});
278 
279         \textcolor{comment}{/* avoid nuls, for convenience */}
280     cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury}][\hyperlink{windefs_8h_af0df26fe796d3771454cde6d3438a11b}{VATTR}] = attr+1;
281     cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury}][\hyperlink{windefs_8h_a5840a65df04b15a5a319b3cae209fe18}{SEL\_ITEM}] = 0;
282     \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury}] + \hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}, str);
283 
284     \textcolor{keywordflow}{if}(n0 > cw->\hyperlink{structamii__WinDesc_a7abaf7568c45c6f6efabdfdc13164a4c}{maxcol}) cw->\hyperlink{structamii__WinDesc_a7abaf7568c45c6f6efabdfdc13164a4c}{maxcol} = n0;
285     \textcolor{keywordflow}{if}(++cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury} > cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow}) cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow} = cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury};
286     \textcolor{keywordflow}{break};
287 
288     \textcolor{keywordflow}{default}:
289     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"Invalid or unset window type in putstr()"});
290     \}
291 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a79bd8694c08f5692ceb222c0ff4f5336}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+putsym@{amii\+\_\+putsym}}
\index{amii\+\_\+putsym@{amii\+\_\+putsym}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+putsym}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+putsym (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{st, }
\item[{int}]{i, }
\item[{int}]{y, }
\item[{{\bf C\+H\+A\+R\+\_\+\+P}}]{c}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a79bd8694c08f5692ceb222c0ff4f5336}


Definition at line 409 of file winstr.\+c.



References amii\+\_\+curs(), and amii\+\_\+wins.



Referenced by amii\+\_\+addtopl().


\begin{DoxyCode}
413 \{
414     \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}( st, i, y );
415     Text(\hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[st]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}->RPort, &c, 1);
416 \}
\end{DoxyCode}
\hypertarget{winproto_8h_aab47181efcfda8c085c6739aca882b94}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+raw\+\_\+print@{amii\+\_\+raw\+\_\+print}}
\index{amii\+\_\+raw\+\_\+print@{amii\+\_\+raw\+\_\+print}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+raw\+\_\+print}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+raw\+\_\+print (
\begin{DoxyParamCaption}
\item[{{\bf const} char $\ast$}]{s}
\end{DoxyParamCaption}
)}}\label{winproto_8h_aab47181efcfda8c085c6739aca882b94}


Definition at line 2119 of file winfuncs.\+c.



References amii\+\_\+putstr(), amii\+\_\+rawprwin, amii\+\_\+wins, ami\+I\+Display, init\+\_\+nhwindows, Initialized, amii\+\_\+\+Display\+Desc\+::rawprint, stdout, W\+I\+N\+\_\+\+B\+A\+S\+E, W\+I\+N\+\_\+\+E\+R\+R, and W\+I\+N\+\_\+\+M\+A\+P.


\begin{DoxyCode}
2121 \{
2122     \textcolor{keywordtype}{int} argc = 0;
2123 
2124     \textcolor{keywordflow}{if}( !s )
2125     \textcolor{keywordflow}{return};
2126     \textcolor{keywordflow}{if}(\hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay})
2127     \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_aaee7b747d7620b0e53252edc0bfc5782}{rawprint}++;
2128 
2129     \textcolor{keywordflow}{if} (!\hyperlink{amidos_8c_a55b41cec1916f4628807321204d03d9f}{Initialized}) \{ \textcolor{comment}{/* Not yet screen open ... */}
2130         puts(s);
2131         fflush(\hyperlink{lev__lex_8h_a0c0ef221f95f64e8632451312fd18cc8}{stdout});
2132         \textcolor{keywordflow}{return};
2133     \}
2134 
2135     \textcolor{keywordflow}{if}( \hyperlink{amidos_8c_a55b41cec1916f4628807321204d03d9f}{Initialized} == 0 && \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE} == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} )
2136         \hyperlink{winprocs_8h_a613c5d847a2df7d7ddca4a1308014964}{init\_nhwindows}(&argc, (\textcolor{keywordtype}{char} **)0);
2137 
2138     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_adfe028fce2921a7a5f7713029ad51769}{amii\_rawprwin} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} )
2139     \hyperlink{winproto_8h_a9fdbf76005ec3ae5b77b3002366c04d3}{amii\_putstr}( \hyperlink{winext_8h_adfe028fce2921a7a5f7713029ad51769}{amii\_rawprwin}, 0, s );
2140     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} ] )
2141     \hyperlink{winproto_8h_a9fdbf76005ec3ae5b77b3002366c04d3}{amii\_putstr}( WIN\_MAP, 0, s );
2142     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE} ] )
2143     \hyperlink{winproto_8h_a9fdbf76005ec3ae5b77b3002366c04d3}{amii\_putstr}( WIN\_BASE, 0, s );
2144     \textcolor{keywordflow}{else}
2145     \{
2146     puts( s);
2147     fflush(\hyperlink{lev__lex_8h_a0c0ef221f95f64e8632451312fd18cc8}{stdout});
2148     \}
2149 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a7c303cbf1af1f00c78362eef85bbfa64}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+raw\+\_\+print\+\_\+bold@{amii\+\_\+raw\+\_\+print\+\_\+bold}}
\index{amii\+\_\+raw\+\_\+print\+\_\+bold@{amii\+\_\+raw\+\_\+print\+\_\+bold}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+raw\+\_\+print\+\_\+bold}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+raw\+\_\+print\+\_\+bold (
\begin{DoxyParamCaption}
\item[{{\bf const} char $\ast$}]{s}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a7c303cbf1af1f00c78362eef85bbfa64}


Definition at line 2156 of file winfuncs.\+c.



References amii\+\_\+putstr(), amii\+\_\+rawprwin, amii\+\_\+wins, ami\+I\+Display, init\+\_\+nhwindows, Initialized, printf, amii\+\_\+\+Display\+Desc\+::rawprint, stdout, W\+I\+N\+\_\+\+B\+A\+S\+E, W\+I\+N\+\_\+\+E\+R\+R, and W\+I\+N\+\_\+\+M\+A\+P.


\begin{DoxyCode}
2158 \{
2159     \textcolor{keywordtype}{int} argc = 0;
2160 
2161     \textcolor{keywordflow}{if}( !s )
2162     \textcolor{keywordflow}{return};
2163 
2164     \textcolor{keywordflow}{if}(\hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay})
2165     \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_aaee7b747d7620b0e53252edc0bfc5782}{rawprint}++;
2166 
2167     \textcolor{keywordflow}{if} (!\hyperlink{amidos_8c_a55b41cec1916f4628807321204d03d9f}{Initialized}) \{ \textcolor{comment}{/* Not yet screen open ... */}
2168         puts(s);
2169         fflush(\hyperlink{lev__lex_8h_a0c0ef221f95f64e8632451312fd18cc8}{stdout});
2170         \textcolor{keywordflow}{return};
2171     \}
2172 
2173     \textcolor{keywordflow}{if}( \hyperlink{amidos_8c_a55b41cec1916f4628807321204d03d9f}{Initialized} == 0 && \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE} == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} )
2174         \hyperlink{winprocs_8h_a613c5d847a2df7d7ddca4a1308014964}{init\_nhwindows}(&argc, (\textcolor{keywordtype}{char} **)0);
2175 
2176     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_adfe028fce2921a7a5f7713029ad51769}{amii\_rawprwin} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} )
2177     \hyperlink{winproto_8h_a9fdbf76005ec3ae5b77b3002366c04d3}{amii\_putstr}( \hyperlink{winext_8h_adfe028fce2921a7a5f7713029ad51769}{amii\_rawprwin}, 1, s );
2178     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} ] )
2179     \hyperlink{winproto_8h_a9fdbf76005ec3ae5b77b3002366c04d3}{amii\_putstr}( WIN\_MAP, 1, s );
2180     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{winami_8h_a5a32a2aaab2d6b517c4afde059621c35}{WIN\_BASE} ] )
2181     \hyperlink{winproto_8h_a9fdbf76005ec3ae5b77b3002366c04d3}{amii\_putstr}( WIN\_BASE, 1, s );
2182     \textcolor{keywordflow}{else}
2183     \{
2184     \hyperlink{sound_8c_a3cb9f0894fab1c8fbb0753c9c7c2a8d9}{printf}(\textcolor{stringliteral}{"\(\backslash\)33[1m%s\(\backslash\)33[0m\(\backslash\)n"},s);
2185     fflush(\hyperlink{lev__lex_8h_a0c0ef221f95f64e8632451312fd18cc8}{stdout});
2186     \}
2187 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a23cfeb0082243bfa986f1c2d865a382e}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+remember\+\_\+topl@{amii\+\_\+remember\+\_\+topl}}
\index{amii\+\_\+remember\+\_\+topl@{amii\+\_\+remember\+\_\+topl}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+remember\+\_\+topl}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+remember\+\_\+topl (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a23cfeb0082243bfa986f1c2d865a382e}


Definition at line 452 of file winstr.\+c.


\begin{DoxyCode}
453 \{
454     \textcolor{comment}{/* ignore for now.  I think this will be done automatically by}
455 \textcolor{comment}{     * the code writing to the message window, but I could be wrong.}
456 \textcolor{comment}{     */}
457 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a180248b0a811ed91cd8e861da3276c8b}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+resume\+\_\+nhwindows@{amii\+\_\+resume\+\_\+nhwindows}}
\index{amii\+\_\+resume\+\_\+nhwindows@{amii\+\_\+resume\+\_\+nhwindows}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+resume\+\_\+nhwindows}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+resume\+\_\+nhwindows (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a180248b0a811ed91cd8e861da3276c8b}


Definition at line 1994 of file winfuncs.\+c.



References Hack\+Screen.


\begin{DoxyCode}
1995 \{
1996     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen} )
1997     ScreenToFront( \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen} );
1998 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ab858da7b4bf790de1cdd61c1d1d27cfe}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+scrollmsg@{amii\+\_\+scrollmsg}}
\index{amii\+\_\+scrollmsg@{amii\+\_\+scrollmsg}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+scrollmsg}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+scrollmsg (
\begin{DoxyParamCaption}
\item[{{\bf register} struct Window $\ast$}]{w, }
\item[{{\bf register} struct {\bf amii\+\_\+\+Win\+Desc} $\ast$}]{cw}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ab858da7b4bf790de1cdd61c1d1d27cfe}
\hypertarget{winproto_8h_a519a5cd689b995154d319a65b3aca6a7}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+set\+\_\+text\+\_\+font@{amii\+\_\+set\+\_\+text\+\_\+font}}
\index{amii\+\_\+set\+\_\+text\+\_\+font@{amii\+\_\+set\+\_\+text\+\_\+font}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+set\+\_\+text\+\_\+font}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+set\+\_\+text\+\_\+font (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{font, }
\item[{int}]{size}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a519a5cd689b995154d319a65b3aca6a7}


Definition at line 1748 of file winfuncs.\+c.



References amii\+\_\+libvers, amii\+\_\+wins, bigscreen, Hack\+Screen, M\+A\+X\+W\+I\+N, N\+H\+W\+\_\+\+B\+A\+S\+E, N\+H\+W\+\_\+\+M\+A\+P, N\+H\+W\+\_\+\+M\+E\+S\+S\+A\+G\+E, N\+H\+W\+\_\+\+O\+V\+E\+R, N\+H\+W\+\_\+\+S\+T\+A\+T\+U\+S, N\+U\+L\+L, Texts\+Font, Texts\+Font13, amii\+\_\+\+Win\+Desc\+::type, and amii\+\_\+\+Win\+Desc\+::win.



Referenced by parse\+\_\+config\+\_\+line().


\begin{DoxyCode}
1751 \{
1752     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i;
1753     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
1754     \textcolor{keywordtype}{int} osize = \hyperlink{winext_8h_ae025c8071639e4d9dc591d74e997ed7d}{TextsFont13}.ta\_YSize;
1755     \textcolor{keyword}{static} \textcolor{keywordtype}{char} nname[ 100 ];
1756 
1757     strncpy( nname, \hyperlink{lev__main_8c_a8f8f80d37794cde9472343e4487ba3eb}{name}, \textcolor{keyword}{sizeof}( nname ) - 1 );
1758     nname[ \textcolor{keyword}{sizeof}( nname ) - 1 ] = 0;
1759 
1760     \hyperlink{winext_8h_ae025c8071639e4d9dc591d74e997ed7d}{TextsFont13}.ta\_Name = nname;
1761     \hyperlink{winext_8h_ae025c8071639e4d9dc591d74e997ed7d}{TextsFont13}.ta\_YSize = \hyperlink{structsize}{size};
1762 
1763     \textcolor{comment}{/* No alternate text font allowed for 640x269 or smaller */}
1764     \textcolor{keywordflow}{if}( !\hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen} || !\hyperlink{winext_8h_a686d780b14cde5aa754adc1baa2d6cfe}{bigscreen} )
1765     \textcolor{keywordflow}{return};
1766 
1767     \textcolor{comment}{/* Look for windows to set, and change them */}
1768 
1769     \textcolor{keywordflow}{if}( DiskfontBase =
1770         OpenLibrary( \textcolor{stringliteral}{"diskfont.library"}, \hyperlink{winfuncs_8c_a671ae6e85756b2cbd50580e85216e311}{amii\_libvers}  ) )
1771     \{
1772     \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} = OpenDiskFont( &\hyperlink{winext_8h_ae025c8071639e4d9dc591d74e997ed7d}{TextsFont13} );
1773     \textcolor{keywordflow}{for}( i = 0; \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} && i < \hyperlink{winami_8h_a0882b20213d1ebf14d860e611d06cf36}{MAXWIN}; ++i )
1774     \{
1775         \textcolor{keywordflow}{if}( (cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ i ]) && cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
1776         \{
1777             \textcolor{keywordflow}{switch}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} )
1778             \{
1779             \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a8ed5b99ab7f854ace5f67f89aaae5404}{NHW\_STATUS}:
1780             MoveWindow( cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}, 0, -( \hyperlink{structsize}{size} - osize ) * 2 );
1781             SizeWindow( cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}, 0, ( \hyperlink{structsize}{size} - osize ) * 2 );
1782             SetFont( cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}->RPort, \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} );
1783             \textcolor{keywordflow}{break};
1784             \textcolor{keywordflow}{case} \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE}:
1785             \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP}:
1786             \textcolor{keywordflow}{case} \hyperlink{macwin_8h_ab575e634e51462bf534b7ee541cefc46}{NHW\_BASE}:
1787             \textcolor{keywordflow}{case} \hyperlink{winami_8h_ade6ff25a1de12300d538d40c306f4b2a}{NHW\_OVER}:
1788             SetFont( cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}->RPort, \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} );
1789             \textcolor{keywordflow}{break};
1790             \}
1791         \}
1792     \}
1793     \}
1794     CloseLibrary(DiskfontBase);
1795     DiskfontBase = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
1796 \}
\end{DoxyCode}
\hypertarget{winproto_8h_aa4137ced6d879e2a02a6a746e566e659}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+setclipped@{amii\+\_\+setclipped}}
\index{amii\+\_\+setclipped@{amii\+\_\+setclipped}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+setclipped}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+setclipped (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_aa4137ced6d879e2a02a6a746e566e659}


Definition at line 2234 of file winfuncs.\+c.



References C\+O, L\+I, and T\+R\+U\+E.



Referenced by amii\+\_\+create\+\_\+nhwindow().


\begin{DoxyCode}
2235 \{
2236 \textcolor{preprocessor}{#ifdef  CLIPPING}
2237     clipping = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
2238     clipx=clipy=0;
2239     clipxmax=\hyperlink{winext_8h_abdcb66bae1fc240beb333f1932bdc30d}{CO};
2240     clipymax=\hyperlink{winext_8h_a4952935dee70ae06274495dcddf10856}{LI};
2241 \textcolor{comment}{/* some of this is now redundant with top of amii\_cliparound XXX */}
2242 \textcolor{preprocessor}{#endif}
2243 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a7e627c455ba61be81b8318b295b93f1b}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+setdrawpens@{amii\+\_\+setdrawpens}}
\index{amii\+\_\+setdrawpens@{amii\+\_\+setdrawpens}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+setdrawpens}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+setdrawpens (
\begin{DoxyParamCaption}
\item[{struct Window $\ast$}]{, }
\item[{int}]{type}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a7e627c455ba61be81b8318b295b93f1b}


Definition at line 1378 of file winfuncs.\+c.



References amii\+\_\+menu\+A\+Pen, amii\+\_\+menu\+B\+Pen, amii\+\_\+msg\+A\+Pen, amii\+\_\+msg\+B\+Pen, amii\+\_\+other\+A\+Pen, amii\+\_\+other\+B\+Pen, amii\+\_\+stat\+A\+Pen, amii\+\_\+stat\+B\+Pen, amii\+\_\+text\+A\+Pen, amii\+\_\+text\+B\+Pen, C\+\_\+\+B\+L\+A\+C\+K, C\+\_\+\+W\+H\+I\+T\+E, N\+H\+W\+\_\+\+B\+A\+S\+E, N\+H\+W\+\_\+\+M\+A\+P, N\+H\+W\+\_\+\+M\+E\+N\+U, N\+H\+W\+\_\+\+M\+E\+S\+S\+A\+G\+E, N\+H\+W\+\_\+\+O\+V\+E\+R, N\+H\+W\+\_\+\+S\+T\+A\+T\+U\+S, and N\+H\+W\+\_\+\+T\+E\+X\+T.



Referenced by amii\+\_\+doprev\+\_\+message().


\begin{DoxyCode}
1379 \{
1380     \textcolor{keywordflow}{switch}( \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} )
1381     \{
1382     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE}:
1383     SetAPen( w->RPort, \hyperlink{winfuncs_8c_acc9bd89041e1021df5e8d898dda9968c}{amii\_msgAPen} );
1384     SetBPen( w->RPort, \hyperlink{winfuncs_8c_ab8d29ceb31e5059cc2430e47bfba87c8}{amii\_msgBPen} );
1385     \textcolor{keywordflow}{break};
1386     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a8ed5b99ab7f854ace5f67f89aaae5404}{NHW\_STATUS}:
1387     SetAPen( w->RPort, \hyperlink{winfuncs_8c_abd477ff7ec6eba516c641ea5ae9af420}{amii\_statAPen} );
1388     SetBPen( w->RPort, \hyperlink{winfuncs_8c_aacd31bf4b410f0502df1519ddb6822ab}{amii\_statBPen} );
1389     \textcolor{keywordflow}{break};
1390     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU}:
1391     SetAPen( w->RPort, \hyperlink{winfuncs_8c_a14ab17c151206a4245022490c76255ec}{amii\_menuAPen} );
1392     SetBPen( w->RPort, \hyperlink{winfuncs_8c_a26ac45dc44f3d41edc95bc99e0b788d8}{amii\_menuBPen} );
1393     \textcolor{keywordflow}{break};
1394     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT}:
1395     SetAPen( w->RPort, \hyperlink{winfuncs_8c_a87c9b725a8d1a308419408002c9eed2d}{amii\_textAPen} );
1396     SetBPen( w->RPort, \hyperlink{winfuncs_8c_a9ba6c6ce5bc8ca526739e615566abde0}{amii\_textBPen} );
1397     \textcolor{keywordflow}{break};
1398     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP}:
1399     \textcolor{keywordflow}{case} \hyperlink{macwin_8h_ab575e634e51462bf534b7ee541cefc46}{NHW\_BASE}:
1400     \textcolor{keywordflow}{case} \hyperlink{winami_8h_ade6ff25a1de12300d538d40c306f4b2a}{NHW\_OVER}:
1401     SetAPen( w->RPort, \hyperlink{windefs_8h_a67fead37547ff67ca0a269d712e87822}{C\_WHITE} );
1402     SetBPen( w->RPort, \hyperlink{windefs_8h_a22a9543e081938a146a8bce60a84200a}{C\_BLACK} );
1403     \textcolor{keywordflow}{break};
1404     \textcolor{keywordflow}{default}:
1405     SetAPen( w->RPort, \hyperlink{winfuncs_8c_a0d0a78803f21bcbdb86d788acde92972}{amii\_otherAPen} );
1406     SetBPen( w->RPort, \hyperlink{winfuncs_8c_a111dca2a2ad69484b4c949424caa4ffa}{amii\_otherBPen} );
1407     \textcolor{keywordflow}{break};
1408     \}
1409 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ae5b985026bec913a04e00d1e0d742541}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+setfillpens@{amii\+\_\+setfillpens}}
\index{amii\+\_\+setfillpens@{amii\+\_\+setfillpens}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+setfillpens}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+setfillpens (
\begin{DoxyParamCaption}
\item[{struct Window $\ast$}]{, }
\item[{int}]{type}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ae5b985026bec913a04e00d1e0d742541}


Definition at line 1343 of file winfuncs.\+c.



References amii\+\_\+menu\+B\+Pen, amii\+\_\+msg\+B\+Pen, amii\+\_\+other\+B\+Pen, amii\+\_\+stat\+B\+Pen, amii\+\_\+text\+B\+Pen, C\+\_\+\+B\+L\+A\+C\+K, N\+H\+W\+\_\+\+B\+A\+S\+E, N\+H\+W\+\_\+\+M\+A\+P, N\+H\+W\+\_\+\+M\+E\+N\+U, N\+H\+W\+\_\+\+M\+E\+S\+S\+A\+G\+E, N\+H\+W\+\_\+\+O\+V\+E\+R, N\+H\+W\+\_\+\+S\+T\+A\+T\+U\+S, and N\+H\+W\+\_\+\+T\+E\+X\+T.



Referenced by amii\+\_\+clear\+\_\+nhwindow(), and Do\+Menu\+Scroll().


\begin{DoxyCode}
1344 \{
1345     \textcolor{keywordflow}{switch}( \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} )
1346     \{
1347     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE}:
1348     SetAPen( w->RPort, \hyperlink{winfuncs_8c_ab8d29ceb31e5059cc2430e47bfba87c8}{amii\_msgBPen} );
1349     SetBPen( w->RPort, \hyperlink{winfuncs_8c_ab8d29ceb31e5059cc2430e47bfba87c8}{amii\_msgBPen} );
1350     \textcolor{keywordflow}{break};
1351     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a8ed5b99ab7f854ace5f67f89aaae5404}{NHW\_STATUS}:
1352     SetAPen( w->RPort, \hyperlink{winfuncs_8c_aacd31bf4b410f0502df1519ddb6822ab}{amii\_statBPen} );
1353     SetBPen( w->RPort, \hyperlink{winfuncs_8c_aacd31bf4b410f0502df1519ddb6822ab}{amii\_statBPen} );
1354     \textcolor{keywordflow}{break};
1355     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU}:
1356     SetAPen( w->RPort, \hyperlink{winfuncs_8c_a26ac45dc44f3d41edc95bc99e0b788d8}{amii\_menuBPen} );
1357     SetBPen( w->RPort, \hyperlink{winfuncs_8c_a26ac45dc44f3d41edc95bc99e0b788d8}{amii\_menuBPen} );
1358     \textcolor{keywordflow}{break};
1359     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT}:
1360     SetAPen( w->RPort, \hyperlink{winfuncs_8c_a9ba6c6ce5bc8ca526739e615566abde0}{amii\_textBPen} );
1361     SetBPen( w->RPort, \hyperlink{winfuncs_8c_a9ba6c6ce5bc8ca526739e615566abde0}{amii\_textBPen} );
1362     \textcolor{keywordflow}{break};
1363     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP}:
1364     \textcolor{keywordflow}{case} \hyperlink{macwin_8h_ab575e634e51462bf534b7ee541cefc46}{NHW\_BASE}:
1365     \textcolor{keywordflow}{case} \hyperlink{winami_8h_ade6ff25a1de12300d538d40c306f4b2a}{NHW\_OVER}:
1366     \textcolor{keywordflow}{default}:
1367     SetAPen( w->RPort, \hyperlink{windefs_8h_a22a9543e081938a146a8bce60a84200a}{C\_BLACK} );
1368     SetBPen( w->RPort, \hyperlink{windefs_8h_a22a9543e081938a146a8bce60a84200a}{C\_BLACK} );
1369     \textcolor{keywordflow}{break};
1370     \textcolor{keywordflow}{case} -2:
1371     SetAPen( w->RPort, \hyperlink{winfuncs_8c_a111dca2a2ad69484b4c949424caa4ffa}{amii\_otherBPen} );
1372     SetBPen( w->RPort, \hyperlink{winfuncs_8c_a111dca2a2ad69484b4c949424caa4ffa}{amii\_otherBPen} );
1373     \textcolor{keywordflow}{break};
1374     \}
1375 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ab17ace282a2e397063b0f2ddeb94f324}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+sethipens@{amii\+\_\+sethipens}}
\index{amii\+\_\+sethipens@{amii\+\_\+sethipens}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+sethipens}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+sethipens (
\begin{DoxyParamCaption}
\item[{struct Window $\ast$}]{, }
\item[{int}]{type, }
\item[{int}]{attr}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ab17ace282a2e397063b0f2ddeb94f324}


Definition at line 1312 of file winfuncs.\+c.



References amii\+\_\+menu\+A\+Pen, amii\+\_\+menu\+B\+Pen, amii\+\_\+msg\+A\+Pen, amii\+\_\+msg\+B\+Pen, amii\+\_\+other\+A\+Pen, amii\+\_\+other\+B\+Pen, amii\+\_\+stat\+A\+Pen, amii\+\_\+stat\+B\+Pen, amii\+\_\+text\+A\+Pen, amii\+\_\+text\+B\+Pen, C\+\_\+\+B\+L\+A\+C\+K, C\+\_\+\+R\+E\+D, C\+\_\+\+W\+H\+I\+T\+E, N\+H\+W\+\_\+\+M\+E\+N\+U, N\+H\+W\+\_\+\+M\+E\+S\+S\+A\+G\+E, N\+H\+W\+\_\+\+S\+T\+A\+T\+U\+S, and N\+H\+W\+\_\+\+T\+E\+X\+T.



Referenced by amii\+\_\+putstr().


\begin{DoxyCode}
1313 \{
1314     \textcolor{keywordflow}{switch}( \hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} )
1315     \{
1316     \textcolor{keywordflow}{default}:
1317         SetAPen( w->RPort, attr ? \hyperlink{windefs_8h_a7adb9aaa1eed15caecd92e3837581b53}{C\_RED} : \hyperlink{winfuncs_8c_a0d0a78803f21bcbdb86d788acde92972}{amii\_otherAPen} );
1318         SetBPen( w->RPort, \hyperlink{windefs_8h_a22a9543e081938a146a8bce60a84200a}{C\_BLACK} );
1319         \textcolor{keywordflow}{break};
1320     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a8ed5b99ab7f854ace5f67f89aaae5404}{NHW\_STATUS}:
1321         SetAPen( w->RPort, attr ? \hyperlink{windefs_8h_a67fead37547ff67ca0a269d712e87822}{C\_WHITE} : \hyperlink{winfuncs_8c_abd477ff7ec6eba516c641ea5ae9af420}{amii\_statAPen} );
1322         SetBPen( w->RPort, \hyperlink{winfuncs_8c_aacd31bf4b410f0502df1519ddb6822ab}{amii\_statBPen} );
1323         \textcolor{keywordflow}{break};
1324     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE}:
1325         SetAPen( w->RPort, attr ? \hyperlink{windefs_8h_a67fead37547ff67ca0a269d712e87822}{C\_WHITE} : \hyperlink{winfuncs_8c_acc9bd89041e1021df5e8d898dda9968c}{amii\_msgAPen} );
1326         SetBPen( w->RPort, \hyperlink{winfuncs_8c_ab8d29ceb31e5059cc2430e47bfba87c8}{amii\_msgBPen} );
1327         \textcolor{keywordflow}{break};
1328     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU}:
1329         SetAPen( w->RPort, attr ? \hyperlink{windefs_8h_a22a9543e081938a146a8bce60a84200a}{C\_BLACK} : \hyperlink{winfuncs_8c_a14ab17c151206a4245022490c76255ec}{amii\_menuAPen} );
1330         SetBPen( w->RPort, \hyperlink{winfuncs_8c_a26ac45dc44f3d41edc95bc99e0b788d8}{amii\_menuBPen} );
1331         \textcolor{keywordflow}{break};
1332     \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT}:
1333         SetAPen( w->RPort, attr ? \hyperlink{windefs_8h_a22a9543e081938a146a8bce60a84200a}{C\_BLACK} : \hyperlink{winfuncs_8c_a87c9b725a8d1a308419408002c9eed2d}{amii\_textAPen} );
1334         SetBPen( w->RPort, \hyperlink{winfuncs_8c_a9ba6c6ce5bc8ca526739e615566abde0}{amii\_textBPen} );
1335     \textcolor{keywordflow}{case} -2:
1336         SetBPen( w->RPort, \hyperlink{winfuncs_8c_a111dca2a2ad69484b4c949424caa4ffa}{amii\_otherBPen} );
1337         SetAPen( w->RPort, attr ? \hyperlink{windefs_8h_a7adb9aaa1eed15caecd92e3837581b53}{C\_RED} : \hyperlink{winfuncs_8c_a0d0a78803f21bcbdb86d788acde92972}{amii\_otherAPen} );
1338         \textcolor{keywordflow}{break};
1339     \}
1340 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a230942d950e207d2a95a0eaf3bcdf345}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+start\+\_\+menu@{amii\+\_\+start\+\_\+menu}}
\index{amii\+\_\+start\+\_\+menu@{amii\+\_\+start\+\_\+menu}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+start\+\_\+menu}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+start\+\_\+menu (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{window}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a230942d950e207d2a95a0eaf3bcdf345}


Definition at line 11 of file winmenu.\+c.



References alwaysinvent, amii\+\_\+clear\+\_\+nhwindow(), amii\+\_\+wins, amii\+\_\+menu\+::chr, amii\+\_\+menu\+::count, menu\+::count, amii\+\_\+\+Win\+Desc\+::cury, amii\+\_\+\+Win\+Desc\+::data, free(), amii\+\_\+menu\+::items, amii\+\_\+\+Win\+Desc\+::maxcol, amii\+\_\+\+Win\+Desc\+::maxrow, amii\+\_\+\+Win\+Desc\+::menu, amii\+\_\+\+Win\+Desc\+::morestr, amii\+\_\+mi\+::next, N\+H\+W\+\_\+\+M\+E\+N\+U, N\+H\+W\+\_\+\+M\+E\+S\+S\+A\+G\+E, N\+H\+W\+\_\+\+T\+E\+X\+T, N\+U\+L\+L, panic(), amii\+\_\+\+Win\+Desc\+::rows, amii\+\_\+\+Win\+Desc\+::type, amii\+\_\+\+Win\+Desc\+::wasup, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+I\+N\+V\+E\+N, and winpanicstr.


\begin{DoxyCode}
13 \{
14     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i;
15     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
16     \textcolor{keyword}{register} \hyperlink{structamii__mi}{amii\_menu\_item} *mip;
17 
18     \textcolor{keywordflow}{if}(window == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} || (cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[window]) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || cw->
      \hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} != \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU})
19     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\hyperlink{winext_8h_a4264157ee8930111caf21b62c212e08c}{winpanicstr},window, \textcolor{stringliteral}{"start\_menu"});
20 
21     \hyperlink{winfuncs_8c_ac2b43ff5e6b6394438fd8fde2008d264}{amii\_clear\_nhwindow}(window);
22 
23     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data} && ( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} ||
24         cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU} || cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT} ) )
25     \{
26     \textcolor{keywordflow}{for}( i = 0; i < cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow}; ++i )
27     \{
28         \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ i ] )
29         \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ i ] );
30     \}
31     \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data} );
32     cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
33     \}
34 
35     \textcolor{keywordflow}{for}( mip = cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a01d8d53511bbcb518c8c721c42a1168d}{items}, i = 0; (mip = cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a01d8d53511bbcb518c8c721c42a1168d}{items}) && i < cw->
      \hyperlink{structmenu}{menu}.\hyperlink{structmenu_a3d6c8d06c1b134f60244b4449a094d16}{count}; ++i )
36     \{
37     cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a01d8d53511bbcb518c8c721c42a1168d}{items} = mip->\hyperlink{structamii__mi_a2046365b8a73513492596c98a5d30452}{next};
38         \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}( mip );
39     \}
40 
41     cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a01d8d53511bbcb518c8c721c42a1168d}{items} = 0;
42     cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a6498bbd7c8a254b78e3cf333f3ce3318}{count} = 0;
43     cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a8a21d4745ccbca398561a27079e4e5f8}{chr} = \textcolor{charliteral}{'a'};
44 
45     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a18f1ba88dadd6f00144ad9f0b16a2b20}{morestr} ) \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}( cw->\hyperlink{structamii__WinDesc_a18f1ba88dadd6f00144ad9f0b16a2b20}{morestr} );
46     cw->\hyperlink{structamii__WinDesc_a18f1ba88dadd6f00144ad9f0b16a2b20}{morestr} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
47 
48     \textcolor{keywordflow}{if}( window == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} && cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
49     \{
50     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a5f7057e3372d8abeddf1df4f99752979}{alwaysinvent} )
51         cw->\hyperlink{structamii__WinDesc_ab4e4bdac6ab87e8f1cf420814f09e876}{wasup} = 1;
52     \}
53     cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury} = cw->\hyperlink{structamii__WinDesc_a465b4a9c04b3c325f2af2722aac9c5f3}{rows} = cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow} = cw->\hyperlink{structamii__WinDesc_a7abaf7568c45c6f6efabdfdc13164a4c}{maxcol} = 0;
54     \textcolor{keywordflow}{return};
55 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a083c06f70e2b81552708b8bb812a69e6}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+suspend\+\_\+nhwindows@{amii\+\_\+suspend\+\_\+nhwindows}}
\index{amii\+\_\+suspend\+\_\+nhwindows@{amii\+\_\+suspend\+\_\+nhwindows}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+suspend\+\_\+nhwindows}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+suspend\+\_\+nhwindows (
\begin{DoxyParamCaption}
\item[{{\bf const} char $\ast$}]{str}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a083c06f70e2b81552708b8bb812a69e6}
\hypertarget{winproto_8h_a19156a1b85e94cc75203e825ee77e7c0}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+update\+\_\+inventory@{amii\+\_\+update\+\_\+inventory}}
\index{amii\+\_\+update\+\_\+inventory@{amii\+\_\+update\+\_\+inventory}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+update\+\_\+inventory}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+update\+\_\+inventory (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a19156a1b85e94cc75203e825ee77e7c0}


Definition at line 2192 of file winfuncs.\+c.



References amii\+\_\+wins, F\+A\+L\+S\+E, N\+H\+W\+\_\+\+M\+E\+N\+U, N\+U\+L\+L, amii\+\_\+\+Win\+Desc\+::type, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+E\+R\+R, and W\+I\+N\+\_\+\+I\+N\+V\+E\+N.


\begin{DoxyCode}
2193 \{
2194     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
2195 
2196     \textcolor{keywordflow}{if}( \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} && ( cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ 
      \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} ] ) &&
2197                 cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU} && cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} )
2198     \{
2199     display\_inventory( \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE} );
2200     \}
2201 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a179bd05e544d405029628d33886400e2}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+wait\+\_\+synch@{amii\+\_\+wait\+\_\+synch}}
\index{amii\+\_\+wait\+\_\+synch@{amii\+\_\+wait\+\_\+synch}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+wait\+\_\+synch}]{\setlength{\rightskip}{0pt plus 5cm}void amii\+\_\+wait\+\_\+synch (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a179bd05e544d405029628d33886400e2}


Definition at line 2217 of file winfuncs.\+c.



References amii\+\_\+wins, ami\+I\+Display, display\+\_\+nhwindow, flush\+\_\+glyph\+\_\+buffer(), amii\+\_\+\+Display\+Desc\+::rawprint, T\+R\+U\+E, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+E\+R\+R, and W\+I\+N\+\_\+\+M\+A\+P.


\begin{DoxyCode}
2218 \{
2219     \textcolor{keywordflow}{if}(!\hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay} || \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_aaee7b747d7620b0e53252edc0bfc5782}{rawprint})
2220     \{
2221     \textcolor{keywordflow}{if}(\hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}) \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_aaee7b747d7620b0e53252edc0bfc5782}{rawprint}=0;
2222     \}
2223     \textcolor{keywordflow}{else}
2224     \{
2225     \textcolor{keywordflow}{if}( \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} != \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} )
2226     \{
2227         \hyperlink{winprocs_8h_ac8e74d03fbb65b9f5651e63d79bebc60}{display\_nhwindow}(\hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP},\hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
2228         \hyperlink{winchar_8c_aedd7ad0350a58b8fca664bcbdc5f1f35}{flush\_glyph\_buffer}( \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} ]->
      \hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} );
2229     \}
2230     \}
2231 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ae89562752fc8144bd5514e7366b14dfa}{\index{winproto.\+h@{winproto.\+h}!amii\+\_\+yn\+\_\+function@{amii\+\_\+yn\+\_\+function}}
\index{amii\+\_\+yn\+\_\+function@{amii\+\_\+yn\+\_\+function}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amii\+\_\+yn\+\_\+function}]{\setlength{\rightskip}{0pt plus 5cm}char amii\+\_\+yn\+\_\+function (
\begin{DoxyParamCaption}
\item[{{\bf const} char $\ast$}]{prompt, }
\item[{{\bf const} char $\ast$}]{resp, }
\item[{char}]{def}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ae89562752fc8144bd5514e7366b14dfa}
\hypertarget{winproto_8h_ac506d1c2744895972ab13c3b19d702c3}{\index{winproto.\+h@{winproto.\+h}!amikbhit@{amikbhit}}
\index{amikbhit@{amikbhit}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amikbhit}]{\setlength{\rightskip}{0pt plus 5cm}int amikbhit (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ac506d1c2744895972ab13c3b19d702c3}


Referenced by kbhit().

\hypertarget{winproto_8h_a34202204b8a823ec191848d8210df54c}{\index{winproto.\+h@{winproto.\+h}!amiv\+\_\+loadlib@{amiv\+\_\+loadlib}}
\index{amiv\+\_\+loadlib@{amiv\+\_\+loadlib}!winproto.\+h@{winproto.\+h}}
\subsubsection[{amiv\+\_\+loadlib}]{\setlength{\rightskip}{0pt plus 5cm}void amiv\+\_\+loadlib (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a34202204b8a823ec191848d8210df54c}


Definition at line 927 of file amiwind.\+c.


\begin{DoxyCode}
928 \{
929 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a817969c4fe20a121e99fda658e88fbc7}{\index{winproto.\+h@{winproto.\+h}!basename@{basename}}
\index{basename@{basename}!winproto.\+h@{winproto.\+h}}
\subsubsection[{basename}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ basename (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{str}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a817969c4fe20a121e99fda658e88fbc7}


Definition at line 630 of file winreq.\+c.



Referenced by fqname(), and main().


\begin{DoxyCode}
632 \{
633     \textcolor{keywordtype}{char} *t;
634 
635     t = strrchr( str, \textcolor{charliteral}{'/'} );
636     \textcolor{keywordflow}{if}( !t )
637     t = strrchr( str, \textcolor{charliteral}{':'} );
638     \textcolor{keywordflow}{if}( !t )
639     t = str;
640     \textcolor{keywordflow}{else}
641     ++t;
642     \textcolor{keywordflow}{return}( t );
643 \}
\end{DoxyCode}
\hypertarget{winproto_8h_aa5da7dc4719848ae9157b977c1e1db71}{\index{winproto.\+h@{winproto.\+h}!bell@{bell}}
\index{bell@{bell}!winproto.\+h@{winproto.\+h}}
\subsubsection[{bell}]{\setlength{\rightskip}{0pt plus 5cm}void bell (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_aa5da7dc4719848ae9157b977c1e1db71}
\hypertarget{winproto_8h_a081d5cd1a7136b98c1621dfdec338098}{\index{winproto.\+h@{winproto.\+h}!Clean\+Up@{Clean\+Up}}
\index{Clean\+Up@{Clean\+Up}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Clean\+Up}]{\setlength{\rightskip}{0pt plus 5cm}void Clean\+Up (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a081d5cd1a7136b98c1621dfdec338098}


Definition at line 799 of file amiwind.\+c.



Referenced by nethack\+\_\+exit().


\begin{DoxyCode}
800 \{
801     \hyperlink{winproto_8h_aa0ab31344b2d7cf560f9c39c419139b7}{amii\_cleanup}();
802 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ae769e473e3e63c0b8f24ce0541c1901f}{\index{winproto.\+h@{winproto.\+h}!clear\+\_\+icon@{clear\+\_\+icon}}
\index{clear\+\_\+icon@{clear\+\_\+icon}!winproto.\+h@{winproto.\+h}}
\subsubsection[{clear\+\_\+icon}]{\setlength{\rightskip}{0pt plus 5cm}void clear\+\_\+icon (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ae769e473e3e63c0b8f24ce0541c1901f}
\hypertarget{winproto_8h_a343849f85cbb4ebc40f0977834cfc7be}{\index{winproto.\+h@{winproto.\+h}!Close\+Sh\+Window@{Close\+Sh\+Window}}
\index{Close\+Sh\+Window@{Close\+Sh\+Window}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Close\+Sh\+Window}]{\setlength{\rightskip}{0pt plus 5cm}void Close\+Sh\+Window (
\begin{DoxyParamCaption}
\item[{struct Window $\ast$}]{win}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a343849f85cbb4ebc40f0977834cfc7be}


Referenced by dismiss\+\_\+nhwindow().

\hypertarget{winproto_8h_a63bceb4935b25e00e97a8b1cf17719bb}{\index{winproto.\+h@{winproto.\+h}!Convert\+Key@{Convert\+Key}}
\index{Convert\+Key@{Convert\+Key}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Convert\+Key}]{\setlength{\rightskip}{0pt plus 5cm}int Convert\+Key (
\begin{DoxyParamCaption}
\item[{struct Intui\+Message $\ast$}]{message}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a63bceb4935b25e00e97a8b1cf17719bb}


Referenced by Do\+Menu\+Scroll().

\hypertarget{winproto_8h_ad3d1ca643965bdb9df28feb9f3a15b0a}{\index{winproto.\+h@{winproto.\+h}!Count\+Lines@{Count\+Lines}}
\index{Count\+Lines@{Count\+Lines}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Count\+Lines}]{\setlength{\rightskip}{0pt plus 5cm}long Count\+Lines (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ad3d1ca643965bdb9df28feb9f3a15b0a}


Definition at line 1277 of file winmenu.\+c.



References amii\+\_\+wins, amii\+\_\+\+Win\+Desc\+::cols, amii\+\_\+\+Win\+Desc\+::data, amii\+\_\+menu\+::items, amii\+\_\+\+Win\+Desc\+::maxrow, amii\+\_\+\+Win\+Desc\+::menu, N\+H\+W\+\_\+\+M\+E\+S\+S\+A\+G\+E, panic(), pictdata, S\+E\+L\+\_\+\+I\+T\+E\+M, S\+O\+F\+F, amii\+\_\+\+Win\+Desc\+::type, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+I\+N\+V\+E\+N, winpanicstr, W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V, and P\+D\+A\+T\+::xsize.



Referenced by amii\+\_\+putstr(), Do\+Menu\+Scroll(), and Re\+Display\+Data().


\begin{DoxyCode}
1279 \{
1280     \textcolor{keywordtype}{int} txwd;
1281     \hyperlink{structamii__mi}{amii\_menu\_item} *mip;
1282     \textcolor{keyword}{register} \textcolor{keywordtype}{char} *t;
1283     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
1284     \textcolor{keyword}{register} \textcolor{keyword}{struct }Window *w;
1285     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i, disprow, len;
1286     \textcolor{keywordtype}{int} col = -1;
1287 
1288     \textcolor{keywordflow}{if}( win == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} || !(cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[win]) || !( w = cw->
      \hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} ) )
1289     \{
1290     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \hyperlink{winext_8h_a4264157ee8930111caf21b62c212e08c}{winpanicstr}, win, \textcolor{stringliteral}{"No Window in CountLines"} );
1291     \}
1292 
1293     txwd = w->RPort->TxWidth;
1294     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
1295     \{
1296     \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
1297     \{
1298         cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft -
1299             w->BorderRight - 4 - \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_a957fade03cbfb4ce4de9df4e09be7fc7}{xsize} - 3) / txwd;
1300     \}
1301     \textcolor{keywordflow}{else}
1302         cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft - w->BorderRight - 4 ) / txwd;
1303     \}
1304     \textcolor{keywordflow}{else}
1305     \{
1306     cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft - w->BorderRight - 4 ) / txwd;
1307     \}
1308 
1309     disprow = cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow};
1310     mip = cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a01d8d53511bbcb518c8c721c42a1168d}{items};
1311     \textcolor{keywordflow}{for}( col = i = 0; i < cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow}; ++i )
1312     \{
1313     t = cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ i ] + \hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF};
1314     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} && cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ i ][ \hyperlink{windefs_8h_a5840a65df04b15a5a319b3cae209fe18}{SEL\_ITEM} ] < 0 )
1315         --disprow;
1316     \textcolor{keywordflow}{else}
1317         col = 0;
1318     \textcolor{keywordflow}{while}( *t )
1319     \{
1320         len = strlen( t );
1321         \textcolor{keywordflow}{if}( col + len > cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} )
1322         len = cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} - col;
1323         \textcolor{keywordflow}{while}( len > 0 )
1324         \{
1325             \textcolor{keywordflow}{if}( !t[len] || t[len] == \textcolor{charliteral}{' '} )
1326             \textcolor{keywordflow}{break};
1327             --len;
1328         \}
1329         \textcolor{keywordflow}{if}( len == 0 ) \{
1330         \textcolor{keywordflow}{while} ( *t && *t != \textcolor{charliteral}{' '}) \{
1331             t++; col++;
1332         \}
1333         \} \textcolor{keywordflow}{else} \{
1334         t += len;
1335         col += len;
1336         \}
1337         \textcolor{keywordflow}{if}( *t )
1338         \{
1339         \textcolor{keywordflow}{while}( *t == \textcolor{charliteral}{' '} )
1340             ++t;
1341         col = 0;
1342         ++disprow;
1343         \}
1344     \}
1345     \}
1346     \textcolor{keywordflow}{return}( disprow );
1347 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a21dcf06b1e3a62331c49092d9911f189}{\index{winproto.\+h@{winproto.\+h}!cursor\+\_\+off@{cursor\+\_\+off}}
\index{cursor\+\_\+off@{cursor\+\_\+off}!winproto.\+h@{winproto.\+h}}
\subsubsection[{cursor\+\_\+off}]{\setlength{\rightskip}{0pt plus 5cm}void cursor\+\_\+off (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{window}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a21dcf06b1e3a62331c49092d9911f189}


Definition at line 1836 of file winfuncs.\+c.



References amii\+\_\+wins, amii\+\_\+\+Win\+Desc\+::curs\+\_\+apen, amii\+\_\+\+Win\+Desc\+::curs\+\_\+bpen, C\+U\+R\+S\+O\+R\+\_\+\+C\+H\+A\+R, cursor\+\_\+common(), amii\+\_\+\+Win\+Desc\+::cursx, amii\+\_\+\+Win\+Desc\+::cursy, F\+L\+M\+A\+P\+\_\+\+C\+U\+R\+S\+U\+P, iflags, Is\+\_\+rogue\+\_\+level, N\+H\+W\+\_\+\+M\+A\+P, N\+U\+L\+L, panic(), rp, amii\+\_\+\+Win\+Desc\+::type, u, you\+::uz, amii\+\_\+\+Win\+Desc\+::wflags, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+E\+R\+R, instance\+\_\+flags\+::window\+\_\+inited, winpanicstr, and W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V.



Referenced by amii\+\_\+clear\+\_\+nhwindow(), amii\+\_\+cliparound(), amiv\+\_\+flush\+\_\+glyph\+\_\+buffer(), and cursor\+\_\+on().


\begin{DoxyCode}
1838 \{
1839     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
1840     \textcolor{keyword}{register} \textcolor{keyword}{struct }Window *w;
1841     \textcolor{keyword}{register} \textcolor{keyword}{struct }RastPort *\hyperlink{amirip_8c_aa0639b6491ec144930d14703053f32a4}{rp};
1842     \textcolor{keywordtype}{int} curx, cury;
1843     \textcolor{keywordtype}{int} x, y;
1844     \textcolor{keywordtype}{long} dmode;
1845     \textcolor{keywordtype}{short} apen, bpen;
1846     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} ch;
1847 
1848     \textcolor{keywordflow}{if}( window == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} || ( cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[window] ) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
1849     \{
1850     \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_a2fc6c78c4c5f6e1d0027ac575135426f}{window\_inited}=0;
1851     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\hyperlink{winext_8h_a4264157ee8930111caf21b62c212e08c}{winpanicstr},window, \textcolor{stringliteral}{"cursor\_off"});
1852     \}
1853 
1854     \textcolor{keywordflow}{if}( !(cw->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} & \hyperlink{winami_8h_a7273e3f6e628faf1db9b852fc1c56729}{FLMAP\_CURSUP} ) )
1855     \textcolor{keywordflow}{return};
1856 
1857     w = cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
1858 
1859     \textcolor{keywordflow}{if}( !w )
1860     \textcolor{keywordflow}{return};
1861 
1862     cw->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} &= ~\hyperlink{winami_8h_a7273e3f6e628faf1db9b852fc1c56729}{FLMAP\_CURSUP};
1863     rp = w->RPort;
1864 
1865     \textcolor{comment}{/* Save the current information */}
1866     curx = rp->cp\_x;
1867     cury = rp->cp\_y;
1868     x = cw->\hyperlink{structamii__WinDesc_ae9b81e1924a60034c9ca2f7dee3c97fd}{cursx};
1869     y = cw->\hyperlink{structamii__WinDesc_a25574bc64eeaecb522e78f5c636da887}{cursy};
1870     dmode = rp->DrawMode;
1871     apen = rp->FgPen;
1872     bpen = rp->BgPen;
1873     SetAPen( rp, cw->\hyperlink{structamii__WinDesc_a101774acf6a2657276007d298c36609d}{curs\_apen} );
1874     SetBPen( rp, cw->\hyperlink{structamii__WinDesc_a93ca00f32977372698256e74df4af3c4}{curs\_bpen} );
1875     SetDrMd( rp, COMPLEMENT );
1876 \textcolor{comment}{/*printf("CURSOR OFF: %d %d\(\backslash\)n",x,y);*/}
1877 
1878     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} && cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP})
1879     \{
1880     \hyperlink{winfuncs_8c_aa443a8fd869c4d68918b828581a2f025}{cursor\_common}(rp, x, y);
1881     \textcolor{keywordflow}{if}(\hyperlink{dungeon_8h_a2732117523c8540638daf4315dda16b9}{Is\_rogue\_level}(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}))
1882         Move(rp,curx,cury);
1883     \}
1884     \textcolor{keywordflow}{else}
1885     \{
1886     ch = \hyperlink{windefs_8h_ad7cfdf28b8c73d1c102426b71b5edfca}{CURSOR\_CHAR};
1887     Move( rp, x, y );
1888     Text( rp, &ch, 1 );
1889 
1890     \textcolor{comment}{/* Put back the other stuff */}
1891 
1892     Move( rp, curx, cury );
1893     \}
1894     SetDrMd( rp, dmode );
1895     SetAPen( rp, apen );
1896     SetBPen( rp, bpen );
1897 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ae43c0ee78599c3fa7f2fe2fe4c2b71a1}{\index{winproto.\+h@{winproto.\+h}!cursor\+\_\+on@{cursor\+\_\+on}}
\index{cursor\+\_\+on@{cursor\+\_\+on}!winproto.\+h@{winproto.\+h}}
\subsubsection[{cursor\+\_\+on}]{\setlength{\rightskip}{0pt plus 5cm}void cursor\+\_\+on (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{window}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ae43c0ee78599c3fa7f2fe2fe4c2b71a1}


Definition at line 1900 of file winfuncs.\+c.



References amii\+\_\+wins, amii\+\_\+\+Win\+Desc\+::curs\+\_\+apen, amii\+\_\+\+Win\+Desc\+::curs\+\_\+bpen, C\+U\+R\+S\+O\+R\+\_\+\+C\+H\+A\+R, cursor\+\_\+common(), cursor\+\_\+off(), amii\+\_\+\+Win\+Desc\+::cursx, amii\+\_\+\+Win\+Desc\+::cursy, F\+L\+M\+A\+P\+\_\+\+C\+U\+R\+S\+U\+P, iflags, Is\+\_\+rogue\+\_\+level, N\+H\+W\+\_\+\+M\+A\+P, N\+U\+L\+L, panic(), rp, amii\+\_\+\+Win\+Desc\+::type, u, you\+::uz, amii\+\_\+\+Win\+Desc\+::wflags, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+E\+R\+R, instance\+\_\+flags\+::window\+\_\+inited, winpanicstr, and W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V.



Referenced by amii\+\_\+nh\+\_\+poskey(), and amii\+\_\+nhgetch().


\begin{DoxyCode}
1902 \{
1903     \textcolor{keywordtype}{int} x, y;
1904     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
1905     \textcolor{keyword}{register} \textcolor{keyword}{struct }Window *w;
1906     \textcolor{keyword}{register} \textcolor{keyword}{struct }RastPort *\hyperlink{amirip_8c_aa0639b6491ec144930d14703053f32a4}{rp};
1907     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} ch;
1908     \textcolor{keywordtype}{long} dmode;
1909     \textcolor{keywordtype}{short} apen, bpen;
1910 
1911     \textcolor{keywordflow}{if}( window == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} || ( cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[window] ) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
1912     \{
1913     \textcolor{comment}{/* tty does this differently - is this OK? */}
1914     \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_a2fc6c78c4c5f6e1d0027ac575135426f}{window\_inited}=0;
1915     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\hyperlink{winext_8h_a4264157ee8930111caf21b62c212e08c}{winpanicstr},window, \textcolor{stringliteral}{"cursor\_on"});
1916     \}
1917 
1918 \textcolor{comment}{/*printf("CURSOR ON: %d %d\(\backslash\)n",cw->win->RPort->cp\_x, cw->win->RPort->cp\_y);*/}
1919     \textcolor{keywordflow}{if}( (cw->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} & \hyperlink{winami_8h_a7273e3f6e628faf1db9b852fc1c56729}{FLMAP\_CURSUP} ) )
1920     \hyperlink{winfuncs_8c_a21dcf06b1e3a62331c49092d9911f189}{cursor\_off}( window );
1921 
1922     w = cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
1923 
1924     \textcolor{keywordflow}{if}( !w )
1925     \textcolor{keywordflow}{return};
1926 
1927     cw->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} |= \hyperlink{winami_8h_a7273e3f6e628faf1db9b852fc1c56729}{FLMAP\_CURSUP};
1928     rp = w->RPort;
1929 
1930     \textcolor{comment}{/* Save the current information */}
1931 
1932 \textcolor{preprocessor}{#ifdef  DISPMAP}
1933     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} && cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP} && !
      \hyperlink{dungeon_8h_a2732117523c8540638daf4315dda16b9}{Is\_rogue\_level}(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}))
1934     x = cw->\hyperlink{structamii__WinDesc_ae9b81e1924a60034c9ca2f7dee3c97fd}{cursx} = (rp->cp\_x & -8) + 8;
1935     \textcolor{keywordflow}{else}
1936 \textcolor{preprocessor}{#endif}
1937     x = cw->\hyperlink{structamii__WinDesc_ae9b81e1924a60034c9ca2f7dee3c97fd}{cursx} = rp->cp\_x;
1938     y = cw->\hyperlink{structamii__WinDesc_a25574bc64eeaecb522e78f5c636da887}{cursy} = rp->cp\_y;
1939     apen = rp->FgPen;
1940     bpen = rp->BgPen;
1941     dmode = rp->DrawMode;
1942 
1943     \textcolor{comment}{/* Draw in complement mode. The cursor body will be C\_WHITE */}
1944 
1945     cw->\hyperlink{structamii__WinDesc_a101774acf6a2657276007d298c36609d}{curs\_apen} = 0xff; \textcolor{comment}{/* Last color/all planes, regardless of depth */}
1946     cw->\hyperlink{structamii__WinDesc_a93ca00f32977372698256e74df4af3c4}{curs\_bpen} = 0xff;
1947     SetAPen( rp, cw->\hyperlink{structamii__WinDesc_a101774acf6a2657276007d298c36609d}{curs\_apen} );
1948     SetBPen( rp, cw->\hyperlink{structamii__WinDesc_a93ca00f32977372698256e74df4af3c4}{curs\_bpen} );
1949     SetDrMd( rp, COMPLEMENT );
1950     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} && cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP})
1951     \{
1952     \hyperlink{winfuncs_8c_aa443a8fd869c4d68918b828581a2f025}{cursor\_common}(rp, x, y);
1953     \}
1954     \textcolor{keywordflow}{else}
1955     \{
1956     Move( rp, x, y );
1957     ch = \hyperlink{windefs_8h_ad7cfdf28b8c73d1c102426b71b5edfca}{CURSOR\_CHAR};
1958     Text( rp, &ch, 1 );
1959     Move( rp, x, y );
1960     \}
1961 
1962     SetDrMd( rp, dmode );
1963     SetAPen( rp, apen );
1964     SetBPen( rp, bpen );
1965 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ac27f2c6cf41fe0cd9d8e47c6e23e4c0a}{\index{winproto.\+h@{winproto.\+h}!dirname@{dirname}}
\index{dirname@{dirname}!winproto.\+h@{winproto.\+h}}
\subsubsection[{dirname}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ dirname (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{str}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ac27f2c6cf41fe0cd9d8e47c6e23e4c0a}


Definition at line 609 of file winreq.\+c.



Referenced by Edit\+Color().


\begin{DoxyCode}
611 \{
612     \textcolor{keywordtype}{char} *t, c;
613     \textcolor{keyword}{static} \textcolor{keywordtype}{char} dir[ 300 ];
614 
615     t = strrchr( str, \textcolor{charliteral}{'/'} );
616     \textcolor{keywordflow}{if}( !t )
617     t = strrchr( str, \textcolor{charliteral}{':'} );
618     \textcolor{keywordflow}{if}( !t )
619     t = str;
620     \textcolor{keywordflow}{else}
621     \{
622         c = *t;
623         *t = 0;
624         strcpy( dir, str );
625         *t = c;
626     \}
627     \textcolor{keywordflow}{return}( dir );
628 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ac946cc5b4c43a936e168ddc80b74c4bd}{\index{winproto.\+h@{winproto.\+h}!dismiss\+\_\+nhwindow@{dismiss\+\_\+nhwindow}}
\index{dismiss\+\_\+nhwindow@{dismiss\+\_\+nhwindow}!winproto.\+h@{winproto.\+h}}
\subsubsection[{dismiss\+\_\+nhwindow}]{\setlength{\rightskip}{0pt plus 5cm}void dismiss\+\_\+nhwindow (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{win}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ac946cc5b4c43a936e168ddc80b74c4bd}


Definition at line 1477 of file winfuncs.\+c.



References amii\+\_\+wins, Close\+Sh\+Window(), Free\+New\+Window(), amii\+\_\+\+Win\+Desc\+::newwin, N\+H\+W\+\_\+\+B\+A\+S\+E, N\+H\+W\+\_\+\+M\+A\+P, N\+H\+W\+\_\+\+M\+E\+S\+S\+A\+G\+E, N\+H\+W\+\_\+\+O\+V\+E\+R, N\+H\+W\+\_\+\+S\+T\+A\+T\+U\+S, N\+U\+L\+L, panic(), amii\+\_\+\+Win\+Desc\+::type, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+I\+N\+V\+E\+N, and winpanicstr.



Referenced by amii\+\_\+destroy\+\_\+nhwindow(), and amii\+\_\+select\+\_\+menu().


\begin{DoxyCode}
1479 \{
1480     \textcolor{keyword}{register} \textcolor{keyword}{struct }Window *w;
1481     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
1482 
1483     \textcolor{keywordflow}{if}( \hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} || ( cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}] ) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
1484     \{
1485     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\hyperlink{winext_8h_a4264157ee8930111caf21b62c212e08c}{winpanicstr},win, \textcolor{stringliteral}{"dismiss\_nhwindow"});
1486     \}
1487 
1488     w = cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
1489 
1490     \textcolor{keywordflow}{if}( w )
1491     \{
1492     \textcolor{comment}{/* All windows have this stuff attached to them. */}
1493     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a756172f2e22a3d287cfaf6bc771df606}{NHW\_MAP} ||
1494         cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{winami_8h_ade6ff25a1de12300d538d40c306f4b2a}{NHW\_OVER} ||
1495         cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{macwin_8h_ab575e634e51462bf534b7ee541cefc46}{NHW\_BASE} ||
1496         cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} ||
1497         cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a8ed5b99ab7f854ace5f67f89aaae5404}{NHW\_STATUS} )
1498     \{
1499         ClearMenuStrip( w );
1500     \}
1501 
1502     \textcolor{comment}{/* Save where user like inventory to appear */}
1503     \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
1504     \{
1505         lastinvent.MinX = w->LeftEdge;
1506         lastinvent.MinY = w->TopEdge;
1507         lastinvent.MaxX = w->Width;
1508         lastinvent.MaxY = w->Height;
1509     \}
1510 
1511     \textcolor{comment}{/* Close the window */}
1512     \hyperlink{winproto_8h_a343849f85cbb4ebc40f0977834cfc7be}{CloseShWindow}( w );
1513     cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
1514 
1515     \textcolor{comment}{/* Free copy of NewWindow structure for TEXT/MENU windows. */}
1516     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a96e2d1e26527cec8fe44903009a365a8}{newwin} )
1517         \hyperlink{winproto_8h_a81a885084baad168d6f5acbb40bfd42c}{FreeNewWindow}( (\textcolor{keywordtype}{void} *)cw->\hyperlink{structamii__WinDesc_a96e2d1e26527cec8fe44903009a365a8}{newwin} );
1518     cw->\hyperlink{structamii__WinDesc_a96e2d1e26527cec8fe44903009a365a8}{newwin} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
1519     \}
1520 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a11c44eb0694ea5e51081e54d8df22cd2}{\index{winproto.\+h@{winproto.\+h}!Disp\+Col@{Disp\+Col}}
\index{Disp\+Col@{Disp\+Col}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Disp\+Col}]{\setlength{\rightskip}{0pt plus 5cm}void Disp\+Col (
\begin{DoxyParamCaption}
\item[{struct Window $\ast$}]{w, }
\item[{int}]{idx, }
\item[{{\bf U\+W\+O\+R\+D} $\ast$}]{colors}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a11c44eb0694ea5e51081e54d8df22cd2}


Definition at line 844 of file winreq.\+c.



References amii\+\_\+other\+B\+Pen, buf, C\+\_\+\+R\+E\+D, Col\+\_\+\+Save, C\+O\+L\+D\+E\+F\+::defval, C\+O\+L\+D\+E\+F\+::name, and W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V.



Referenced by Draw\+Col(), and Edit\+Color().


\begin{DoxyCode}
848 \{
849     \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[ 50 ];
850     \textcolor{keywordtype}{char} *colname, *defval;
851 
852     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
853     \{
854     colname = \hyperlink{winreq_8c_a7e9a644e2ecc7e3b41612d65612e6d5e}{amiv\_colnames}[idx].\hyperlink{structCOLDEF_afc63d0b5e9aa00c71244da9788f0de7f}{name};
855     defval = \hyperlink{winreq_8c_a7e9a644e2ecc7e3b41612d65612e6d5e}{amiv\_colnames}[idx].\hyperlink{structCOLDEF_a43f4bfa44d303497856d5070f75128f0}{defval};
856     \}
857     \textcolor{keywordflow}{else}
858     \{
859     colname = \hyperlink{winreq_8c_ad3d523ee67e85337f3fc19e7676f0282}{amii\_colnames}[idx].\hyperlink{structCOLDEF_afc63d0b5e9aa00c71244da9788f0de7f}{name};
860     defval = \hyperlink{winreq_8c_ad3d523ee67e85337f3fc19e7676f0282}{amii\_colnames}[idx].\hyperlink{structCOLDEF_a43f4bfa44d303497856d5070f75128f0}{defval};
861     \}
862 
863     \textcolor{keywordflow}{if}( colname == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
864     \{
865     colname = \textcolor{stringliteral}{"unknown"};
866     defval = \textcolor{stringliteral}{"unknown"};
867     \}
868     Move( w->RPort, \hyperlink{colorwin_8c_a8e498afd53dcc9d53246ed1a343461e1}{Col\_Save}.LeftEdge,
869     \hyperlink{colorwin_8c_a8e498afd53dcc9d53246ed1a343461e1}{Col\_Save}.TopEdge - 7 );
870     sprintf( buf, \textcolor{stringliteral}{"%s=%03x default=%s%s"}, colname, colors[idx], defval,
871     \textcolor{stringliteral}{"              "}+strlen(colname)+1 );
872     SetAPen( w->RPort, \hyperlink{windefs_8h_a7adb9aaa1eed15caecd92e3837581b53}{C\_RED} );
873     SetBPen( w->RPort, \hyperlink{winext_8h_a111dca2a2ad69484b4c949424caa4ffa}{amii\_otherBPen} );
874     SetDrMd( w->RPort, JAM2 );
875     Text( w->RPort, buf, strlen( buf ) );
876 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a3b9f0aa6b0cb58acb709d87e44a3eb99}{\index{winproto.\+h@{winproto.\+h}!Display\+Data@{Display\+Data}}
\index{Display\+Data@{Display\+Data}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Display\+Data}]{\setlength{\rightskip}{0pt plus 5cm}void Display\+Data (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{win, }
\item[{int}]{start}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a3b9f0aa6b0cb58acb709d87e44a3eb99}


Definition at line 1350 of file winmenu.\+c.



References amiga\+\_\+print\+\_\+glyph(), amii\+\_\+cl\+\_\+end(), amii\+\_\+curs(), amii\+\_\+menu\+A\+Pen, amii\+\_\+menu\+B\+Pen, amii\+\_\+msg\+A\+Pen, amii\+\_\+msg\+B\+Pen, amii\+\_\+text\+A\+Pen, amii\+\_\+text\+B\+Pen, amii\+\_\+wins, C\+\_\+\+B\+L\+U\+E, C\+\_\+\+R\+E\+D, amii\+\_\+\+Win\+Desc\+::cols, amii\+\_\+\+Win\+Desc\+::data, Find\+Line(), amii\+\_\+mi\+::glyph, amii\+\_\+menu\+::items, max, amii\+\_\+\+Win\+Desc\+::maxrow, amii\+\_\+\+Win\+Desc\+::menu, amii\+\_\+mi\+::next, N\+H\+W\+\_\+\+M\+E\+N\+U, N\+H\+W\+\_\+\+M\+E\+S\+S\+A\+G\+E, N\+H\+W\+\_\+\+T\+E\+X\+T, N\+O\+\_\+\+G\+L\+Y\+P\+H, panic(), pictdata, amii\+\_\+\+Win\+Desc\+::rows, rp, S\+E\+L\+\_\+\+I\+T\+E\+M, amii\+\_\+mi\+::selected, S\+O\+F\+F, amii\+\_\+\+Win\+Desc\+::type, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+I\+N\+V\+E\+N, winpanicstr, W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V, P\+D\+A\+T\+::xsize, and P\+D\+A\+T\+::ysize.



Referenced by amii\+\_\+doprev\+\_\+message(), Do\+Menu\+Scroll(), and Re\+Display\+Data().


\begin{DoxyCode}
1353 \{
1354     \textcolor{keywordtype}{int} txwd;
1355     \hyperlink{structamii__mi}{amii\_menu\_item} *mip;
1356     \textcolor{keyword}{register} \textcolor{keywordtype}{char} *t;
1357     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
1358     \textcolor{keyword}{register} \textcolor{keyword}{struct }Window *w;
1359     \textcolor{keyword}{register} \textcolor{keyword}{struct }RastPort *\hyperlink{amirip_8c_aa0639b6491ec144930d14703053f32a4}{rp};
1360     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i, disprow, len, wheight;
1361     \textcolor{keywordtype}{int} whichcolor = -1;
1362     \textcolor{keywordtype}{int} col;
1363 
1364     \textcolor{keywordflow}{if}( win == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} || !(cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[win]) || !( w = cw->
      \hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} ) )
1365     \{
1366     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \hyperlink{winext_8h_a4264157ee8930111caf21b62c212e08c}{winpanicstr}, win, \textcolor{stringliteral}{"No Window in DisplayData"} );
1367     \}
1368 
1369     rp = w->RPort;
1370     SetDrMd( rp, JAM2 );
1371     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} && win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
1372     \{
1373     wheight = ( w->Height - w->BorderTop - w->BorderBottom - 2 ) /
1374             \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}( rp->TxHeight, \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_ad7ef994c367e747b85e09149fdccff1b}{ysize} + 3 );
1375     \}
1376     \textcolor{keywordflow}{else}
1377     \{
1378     wheight = ( w->Height - w->BorderTop - w->BorderBottom - 2 ) /
1379             rp->TxHeight;
1380     \}
1381 
1382     cw->\hyperlink{structamii__WinDesc_a465b4a9c04b3c325f2af2722aac9c5f3}{rows} = wheight;
1383     txwd = rp->TxWidth;
1384     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
1385     \{
1386     \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
1387     \{
1388         cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft -
1389             w->BorderRight - 4 - \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_a957fade03cbfb4ce4de9df4e09be7fc7}{xsize} - 3) / txwd;
1390     \}
1391     \textcolor{keywordflow}{else}
1392         cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft - w->BorderRight - 4 ) / txwd;
1393     \}
1394     \textcolor{keywordflow}{else}
1395     \{
1396     cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft - w->BorderRight - 4 ) / txwd;
1397     \}
1398 
1399     \textcolor{comment}{/* Get the real line to display at */}
1400     start = \hyperlink{sys_2amiga_2winmenu_8c_a5c10fb452bdd53064eb14c3f1a270b62}{FindLine}( win, start );
1401 
1402     mip = cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a01d8d53511bbcb518c8c721c42a1168d}{items};
1403     \textcolor{keywordflow}{for}( i = 0; mip && i < start; ++i )
1404     \{
1405     mip = mip->\hyperlink{structamii__mi_a2046365b8a73513492596c98a5d30452}{next};
1406     \}
1407 
1408     \textcolor{comment}{/* Skip any initial response to a previous line */}
1409     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} && mip && mip->\hyperlink{structamii__mi_a47a93b904054888bb7a94309a192f01a}{selected} < 0 )
1410     ++start;
1411     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} && cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} )
1412     SetAPen( rp, \hyperlink{winext_8h_acc9bd89041e1021df5e8d898dda9968c}{amii\_msgAPen} );
1413     
1414     \textcolor{keywordflow}{for}( disprow = i = start; disprow < wheight + start; i++ )
1415     \{
1416     \textcolor{comment}{/* Just erase unused lines in the window */}
1417         \textcolor{keywordflow}{if}( i >= cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow} )
1418         \{
1419         \textcolor{keywordflow}{if} (\hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} && win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN}) \{
1420         \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}( win, 0, disprow - start );
1421         \hyperlink{winproto_8h_a203b786b96fe4c8be21c63f474486d52}{amiga\_print\_glyph}( win, 0, \hyperlink{display_8h_ac36b9cc8436af3cf1f7f9919878d8354}{NO\_GLYPH});
1422         \}
1423         \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}( win, 1, disprow - start );
1424         \hyperlink{winfuncs_8c_ace7ed7ac165d8e68bbc3df59a8ac5ec6}{amii\_cl\_end}( cw, 0 );
1425         ++disprow;
1426         \textcolor{keywordflow}{continue};
1427         \}
1428 
1429     \textcolor{comment}{/* Any string with a highlighted attribute goes}
1430 \textcolor{comment}{     * onto the end of the current line in the message window.}
1431 \textcolor{comment}{     */}
1432     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} )
1433         SetAPen( rp, cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ i ][ \hyperlink{windefs_8h_a5840a65df04b15a5a319b3cae209fe18}{SEL\_ITEM} ] < 0 ? \hyperlink{windefs_8h_a7adb9aaa1eed15caecd92e3837581b53}{C\_RED} : 
      \hyperlink{winext_8h_acc9bd89041e1021df5e8d898dda9968c}{amii\_msgAPen} );
1434 
1435     \textcolor{comment}{/* Selected text in the message window goes onto the end of the current line */}
1436     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} != \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} || cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ i ][ \hyperlink{windefs_8h_a5840a65df04b15a5a319b3cae209fe18}{SEL\_ITEM} ] >= 0 )
1437     \{
1438         \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}( win, 1, disprow - start );
1439         \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} && win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
1440         \{
1441         \textcolor{keywordflow}{if}( mip )
1442             \hyperlink{winproto_8h_a203b786b96fe4c8be21c63f474486d52}{amiga\_print\_glyph}( win, 0, mip->\hyperlink{structamii__mi_a3e4c3c4ab75e4d6027c978bb75fffbce}{glyph} );
1443         \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}( win, 1, disprow - start );
1444         \}
1445         col = 0;
1446     \}
1447 
1448     \textcolor{comment}{/* If this entry is to be highlighted, do so */}
1449     \textcolor{keywordflow}{if}( mip && mip->\hyperlink{structamii__mi_a47a93b904054888bb7a94309a192f01a}{selected} != 0 )
1450     \{
1451         \textcolor{keywordflow}{if}( whichcolor != 1 )
1452         \{
1453         SetDrMd( rp, JAM2 );
1454         \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
1455         \{
1456             SetAPen( rp, \hyperlink{winext_8h_a26ac45dc44f3d41edc95bc99e0b788d8}{amii\_menuBPen} );
1457             SetBPen( rp, \hyperlink{windefs_8h_a2e4dd0b4af70107f36c2aa60b1195f01}{C\_BLUE} );
1458         \}
1459         \textcolor{keywordflow}{else}
1460         \{
1461             SetAPen( rp, \hyperlink{windefs_8h_a2e4dd0b4af70107f36c2aa60b1195f01}{C\_BLUE} );
1462             SetBPen( rp, \hyperlink{winext_8h_a14ab17c151206a4245022490c76255ec}{amii\_menuAPen} );
1463         \}
1464         whichcolor = 1;
1465         \}
1466     \}
1467     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( whichcolor != 2 )
1468     \{
1469         SetDrMd( rp, JAM2 );
1470         \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} )
1471         \{
1472         SetAPen( rp, \hyperlink{winext_8h_acc9bd89041e1021df5e8d898dda9968c}{amii\_msgAPen} );
1473         SetBPen( rp, \hyperlink{winext_8h_ab8d29ceb31e5059cc2430e47bfba87c8}{amii\_msgBPen} );
1474         \}
1475         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU} )
1476         \{
1477         SetAPen( rp, \hyperlink{winext_8h_a14ab17c151206a4245022490c76255ec}{amii\_menuAPen} );
1478         SetBPen( rp, \hyperlink{winext_8h_a26ac45dc44f3d41edc95bc99e0b788d8}{amii\_menuBPen} );
1479         \}
1480         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT} )
1481         \{
1482         SetAPen( rp, \hyperlink{winext_8h_a87c9b725a8d1a308419408002c9eed2d}{amii\_textAPen} );
1483         SetBPen( rp, \hyperlink{winext_8h_a9ba6c6ce5bc8ca526739e615566abde0}{amii\_textBPen} );
1484         \}
1485         whichcolor = 2;
1486     \}
1487 
1488     \textcolor{comment}{/* Next line out, wrap if too long */}
1489 
1490     t = cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ i ] + \hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF};
1491     ++disprow;
1492     col = 0;
1493     \textcolor{keywordflow}{while}( *t )
1494     \{
1495         len = strlen( t );
1496         \textcolor{keywordflow}{if}( len > (cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} - col) )
1497         len = cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} - col;
1498         \textcolor{keywordflow}{while}( len > 0 )
1499         \{
1500             \textcolor{keywordflow}{if}( !t[len] || t[len] == \textcolor{charliteral}{' '} )
1501             \textcolor{keywordflow}{break};
1502             --len;
1503         \}
1504         \textcolor{keywordflow}{if}( len == 0 ) \{
1505         Text( rp, t, cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} - col );
1506         \textcolor{keywordflow}{while} ( *t && *t != \textcolor{charliteral}{' '}) \{
1507             t++; col++;
1508         \}
1509         \} \textcolor{keywordflow}{else} \{
1510         Text( rp, t, len );
1511         t += len;
1512         col += len;
1513         \}
1514         \hyperlink{winfuncs_8c_ace7ed7ac165d8e68bbc3df59a8ac5ec6}{amii\_cl\_end}( cw, col );
1515         \textcolor{keywordflow}{if}( *t )
1516         \{
1517         ++disprow;
1518         \textcolor{comment}{/* Stop at the bottom of the window */}
1519         \textcolor{keywordflow}{if}( disprow > wheight + start )
1520             \textcolor{keywordflow}{break};
1521         \textcolor{keywordflow}{while}( *t == \textcolor{charliteral}{' '} )
1522             ++t;
1523         \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}( win, 1, disprow - start - 1 );
1524         \textcolor{keywordflow}{if}( mip && win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} && \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
1525         \{
1526             \textcolor{comment}{/* Erase any previous glyph drawn here. */}
1527             \hyperlink{winproto_8h_a203b786b96fe4c8be21c63f474486d52}{amiga\_print\_glyph}( win, 0, \hyperlink{display_8h_ac36b9cc8436af3cf1f7f9919878d8354}{NO\_GLYPH} );
1528             \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}( win, 1, disprow - start - 1 );
1529         \}
1530         Text( rp, \textcolor{stringliteral}{"+"}, 1 );
1531         col = 1;
1532         \}
1533     \}
1534 
1535     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_ab3d471e84a363992b5a483392d0b2389}{NHW\_MESSAGE} )
1536     \{
1537         SetAPen( rp, \hyperlink{winext_8h_ab8d29ceb31e5059cc2430e47bfba87c8}{amii\_msgBPen} );
1538         SetBPen( rp, \hyperlink{winext_8h_ab8d29ceb31e5059cc2430e47bfba87c8}{amii\_msgBPen} );
1539     \}
1540     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU} )
1541     \{
1542         SetAPen( rp, \hyperlink{winext_8h_a26ac45dc44f3d41edc95bc99e0b788d8}{amii\_menuBPen} );
1543         SetBPen( rp, \hyperlink{winext_8h_a26ac45dc44f3d41edc95bc99e0b788d8}{amii\_menuBPen} );
1544     \}
1545     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT} )
1546     \{
1547         SetAPen( rp, \hyperlink{winext_8h_a9ba6c6ce5bc8ca526739e615566abde0}{amii\_textBPen} );
1548         SetBPen( rp, \hyperlink{winext_8h_a9ba6c6ce5bc8ca526739e615566abde0}{amii\_textBPen} );
1549     \}
1550     \hyperlink{winfuncs_8c_ace7ed7ac165d8e68bbc3df59a8ac5ec6}{amii\_cl\_end}( cw, col );
1551     whichcolor = -1;
1552     \textcolor{keywordflow}{if}( mip ) mip = mip->\hyperlink{structamii__mi_a2046365b8a73513492596c98a5d30452}{next};
1553     \}
1554     RefreshWindowFrame(w);
1555     \textcolor{keywordflow}{return};
1556 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a1d40ce8115a542aa37cb76a586dfefee}{\index{winproto.\+h@{winproto.\+h}!Do\+Menu\+Scroll@{Do\+Menu\+Scroll}}
\index{Do\+Menu\+Scroll@{Do\+Menu\+Scroll}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Do\+Menu\+Scroll}]{\setlength{\rightskip}{0pt plus 5cm}int Do\+Menu\+Scroll (
\begin{DoxyParamCaption}
\item[{int}]{win, }
\item[{int}]{blocking, }
\item[{int}]{how, }
\item[{{\bf menu\+\_\+item} $\ast$$\ast$}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a1d40ce8115a542aa37cb76a586dfefee}


Definition at line 235 of file winmenu.\+c.



References alwaysinvent, amii\+\_\+getlin(), amii\+\_\+setfillpens(), amii\+\_\+wins, ami\+I\+Display, buf, B\+U\+F\+S\+Z, amii\+\_\+mi\+::canselect, amii\+\_\+\+Win\+Desc\+::cols, Convert\+Key(), amii\+\_\+mi\+::count, count, Count\+Lines(), C\+T\+R\+L, amii\+\_\+\+Win\+Desc\+::curx, Display\+Data(), Dup\+New\+Window(), F\+A\+L\+S\+E, find\+\_\+menu\+\_\+item(), amii\+\_\+mi\+::gselector, Hack\+Font, Hack\+Screen, amii\+\_\+menu\+::items, L\+A\+R\+G\+E\+S\+T\+\_\+\+I\+N\+T, lastmsg, make\+\_\+menu\+\_\+items(), map\+\_\+menu\+\_\+cmd(), max, amii\+\_\+\+Win\+Desc\+::maxcol, amii\+\_\+\+Win\+Desc\+::maxrow, amii\+\_\+\+Win\+Desc\+::menu, M\+E\+N\+U\+\_\+\+F\+I\+R\+S\+T\+\_\+\+P\+A\+G\+E, M\+E\+N\+U\+\_\+\+I\+N\+V\+E\+R\+T\+\_\+\+A\+L\+L, M\+E\+N\+U\+\_\+\+I\+N\+V\+E\+R\+T\+\_\+\+P\+A\+G\+E, M\+E\+N\+U\+\_\+\+L\+A\+S\+T\+\_\+\+P\+A\+G\+E, M\+E\+N\+U\+\_\+\+N\+E\+X\+T\+\_\+\+P\+A\+G\+E, M\+E\+N\+U\+\_\+\+P\+R\+E\+V\+I\+O\+U\+S\+\_\+\+P\+A\+G\+E, M\+E\+N\+U\+\_\+\+S\+E\+A\+R\+C\+H, M\+E\+N\+U\+\_\+\+S\+E\+L\+E\+C\+T\+\_\+\+A\+L\+L, M\+E\+N\+U\+\_\+\+S\+E\+L\+E\+C\+T\+\_\+\+P\+A\+G\+E, M\+E\+N\+U\+\_\+\+U\+N\+S\+E\+L\+E\+C\+T\+\_\+\+A\+L\+L, M\+E\+N\+U\+\_\+\+U\+N\+S\+E\+L\+E\+C\+T\+\_\+\+P\+A\+G\+E, Menu\+Scroll, min, morc, amii\+\_\+\+Win\+Desc\+::morestr, new\+\_\+wins, amii\+\_\+\+Win\+Desc\+::newwin, win\+\_\+setup\+::newwin, amii\+\_\+mi\+::next, N\+H\+W\+\_\+\+M\+E\+N\+U, N\+H\+W\+\_\+\+T\+E\+X\+T, N\+U\+L\+L, Open\+Sh\+Window(), panic(), P\+I\+C\+K\+\_\+\+A\+N\+Y, P\+I\+C\+K\+\_\+\+N\+O\+N\+E, P\+I\+C\+K\+\_\+\+O\+N\+E, pictdata, pl\+\_\+character, plname, Prop\+Scroll, amii\+\_\+mi\+::selected, amii\+\_\+mi\+::selector, Set\+Prop\+Info(), S\+O\+F\+F, amii\+\_\+mi\+::str, Texts\+Font, T\+R\+U\+E, txheight, txwidth, amii\+\_\+\+Win\+Desc\+::type, amii\+\_\+\+Win\+Desc\+::wasup, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+I\+N\+V\+E\+N, W\+I\+N\+\_\+\+M\+A\+P, W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E, W\+I\+N\+\_\+\+S\+T\+A\+T\+U\+S, winpanicstr, amii\+\_\+\+Win\+Desc\+::wintags, W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+I, W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V, amii\+\_\+\+Display\+Desc\+::xpix, xsize, P\+D\+A\+T\+::xsize, amii\+\_\+\+Display\+Desc\+::ypix, ysize, and P\+D\+A\+T\+::ysize.



Referenced by amii\+\_\+display\+\_\+nhwindow(), and amii\+\_\+select\+\_\+menu().


\begin{DoxyCode}
238 \{
239     \hyperlink{structamii__mi}{amii\_menu\_item} *amip;
240     \textcolor{keyword}{register} \textcolor{keyword}{struct }Window *w;
241     \textcolor{keyword}{register} \textcolor{keyword}{struct }NewWindow *nw;
242     \textcolor{keyword}{struct }PropInfo *pip;
243     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
244     \textcolor{keyword}{struct }IntuiMessage *imsg;
245     \textcolor{keyword}{struct }Gadget *gd;
246     \textcolor{keyword}{register} \textcolor{keywordtype}{int} wheight, \hyperlink{sp__lev_8c_a22122ed2c15d87f3ff9e3dad23423244}{xsize}, \hyperlink{sp__lev_8c_a17f6fa5b5051ab79afe70d9598576009}{ysize}, aredone = 0;
247     \textcolor{keyword}{register} \textcolor{keywordtype}{int} txwd, txh;
248     \textcolor{keywordtype}{long} mics, secs, \textcolor{keyword}{class}, code;
249     \textcolor{keywordtype}{long} oldmics = 0, oldsecs = 0;
250     \textcolor{keywordtype}{int} aidx, oidx, topidx, hidden;
251     \textcolor{keywordtype}{int} totalvis;
252     SHORT mx, my;
253     \textcolor{keyword}{static} \textcolor{keywordtype}{char} title[ 100 ];
254     \textcolor{keywordtype}{int} dosize = 1;
255     \textcolor{keyword}{struct }Screen *scrn = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen};
256     \textcolor{keywordtype}{int} x1,x2,y1,y2;
257     \textcolor{keywordtype}{long} counting = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count} = 0, reset\_counting = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
258     \textcolor{keywordtype}{char} countString[32];
259 
260     \textcolor{keywordflow}{if}( win == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} || ( cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ win ] ) == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
261     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\hyperlink{winext_8h_a4264157ee8930111caf21b62c212e08c}{winpanicstr},win,\textcolor{stringliteral}{"DoMenuScroll"});
262 
263     \textcolor{comment}{/*  Initial guess at window sizing values */}
264     txwd = \hyperlink{winext_8h_a017c6ef07f078c21f903ea8942bb43b3}{txwidth};
265     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
266     \{
267     \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
268         txh = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}( \hyperlink{winext_8h_afdf567214d70875e5c17efe40a02b53a}{txheight}, \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_ad7ef994c367e747b85e09149fdccff1b}{ysize} + 3 ); \textcolor{comment}{/* interline space */}
269     \textcolor{keywordflow}{else}
270         txh = \hyperlink{winext_8h_afdf567214d70875e5c17efe40a02b53a}{txheight}; \textcolor{comment}{/* interline space */}
271     \}
272     \textcolor{keywordflow}{else}
273     txh = \hyperlink{winext_8h_afdf567214d70875e5c17efe40a02b53a}{txheight}; \textcolor{comment}{/* interline space */}
274 
275     \textcolor{comment}{/* Check to see if we should open the window, should need to for}
276 \textcolor{comment}{     * TEXT and MENU but not MESSAGE.}
277 \textcolor{comment}{     */}
278 
279     w = cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
280     topidx = 0;
281 
282     \textcolor{keywordflow}{if}( w == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
283     \{
284 
285 \textcolor{preprocessor}{#ifdef  INTUI\_NEW\_LOOK}
286     \textcolor{keywordflow}{if}( IntuitionBase->LibNode.lib\_Version >= 37 )
287     \{
288         \hyperlink{winext_8h_ac03b382c1a8a8d6748fc7bfe920e0ec2}{PropScroll}.Flags |= PROPNEWLOOK;
289     \}
290 \textcolor{preprocessor}{#endif}
291     nw = (\textcolor{keywordtype}{void} *)\hyperlink{winproto_8h_ac3377d82ce911663e05ba9a63d464d90}{DupNewWindow}( (\textcolor{keywordtype}{void} *)(&\hyperlink{winext_8h_a2b4f8d028c6b8c047e86aa0c49348f36}{new\_wins}[ cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} ].
      \hyperlink{structwin__setup_a274eccbc444f827a7db33a83c4f4ec70}{newwin}) );
292     \textcolor{keywordflow}{if}( !\hyperlink{winext_8h_a5f7057e3372d8abeddf1df4f99752979}{alwaysinvent} || win != \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
293     \{
294         xsize = scrn->WBorLeft + scrn->WBorRight + \hyperlink{winext_8h_a0be771971036f589c1013474c1fcd264}{MenuScroll}.Width + 1 +
295                 (txwd * cw->\hyperlink{structamii__WinDesc_a7abaf7568c45c6f6efabdfdc13164a4c}{maxcol});
296         \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
297         \{
298         \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
299             xsize += \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_a957fade03cbfb4ce4de9df4e09be7fc7}{xsize} + 4;
300         \}
301         \textcolor{keywordflow}{if}( xsize > \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} )
302         xsize = \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix};
303 
304         \textcolor{comment}{/* If next row not off window, use it, else use the bottom */}
305 
306         ysize = ( txh * cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow} ) +              \textcolor{comment}{/* The text space */}
307             \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->WBorTop + \hyperlink{winext_8h_afdf567214d70875e5c17efe40a02b53a}{txheight} + 1 +  \textcolor{comment}{/* Top border */}
308             \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen}->WBorBottom + 3;         \textcolor{comment}{/* The bottom border */}
309         \textcolor{keywordflow}{if}( ysize > \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} )
310         ysize = \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix};
311 
312         \textcolor{comment}{/* Adjust the size of the menu scroll gadget */}
313 
314         nw->TopEdge = 0;
315         \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT} && ysize < amiIDisplay->ypix )
316         nw->TopEdge += ( \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} - \hyperlink{sp__lev_8c_a17f6fa5b5051ab79afe70d9598576009}{ysize} ) / 2;
317         nw->LeftEdge = \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} - \hyperlink{sp__lev_8c_a22122ed2c15d87f3ff9e3dad23423244}{xsize};
318         \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU} )
319         \{
320         \textcolor{keywordflow}{if}( nw->LeftEdge > 10 )
321             nw->LeftEdge -= 10;
322         \textcolor{keywordflow}{else}
323             nw->LeftEdge = 0;
324         \textcolor{keywordflow}{if}( \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} - nw->Height > 10 )
325             nw->TopEdge += 10;
326         \textcolor{keywordflow}{else}
327             nw->TopEdge = \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} - nw->Height - 1;
328         \}
329         \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT} && xsize < amiIDisplay->xpix )
330         nw->LeftEdge -= ( \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} - \hyperlink{sp__lev_8c_a22122ed2c15d87f3ff9e3dad23423244}{xsize} ) / 2;
331     \}
332     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
333     \{
334         \textcolor{keyword}{struct }Window *mw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
335         \textcolor{keyword}{struct }Window *sw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_ae0690a38fd295760409995ce03b88329}{WIN\_STATUS} ]->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
336 
337         xsize = scrn->WBorLeft + scrn->WBorRight + \hyperlink{winext_8h_a0be771971036f589c1013474c1fcd264}{MenuScroll}.Width + 1 +
338                 (txwd * cw->\hyperlink{structamii__WinDesc_a7abaf7568c45c6f6efabdfdc13164a4c}{maxcol});
339 
340         \textcolor{comment}{/* Make space for the glyph to appear at the left of the description */}
341         \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
342         xsize += \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_a957fade03cbfb4ce4de9df4e09be7fc7}{xsize} + 4;
343 
344         \textcolor{keywordflow}{if}( xsize > \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} )
345         xsize = \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix};
346 
347         \textcolor{comment}{/* If next row not off window, use it, else use the bottom */}
348 
349         ysize = sw->TopEdge - (mw->TopEdge + mw->Height) - 1;
350         \textcolor{keywordflow}{if}( ysize > \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} )
351         ysize = \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix};
352 
353         \textcolor{comment}{/* Adjust the size of the menu scroll gadget */}
354 
355         nw->TopEdge = mw->TopEdge + mw->Height;
356         nw->LeftEdge = 0;
357     \}
358     cw->\hyperlink{structamii__WinDesc_a96e2d1e26527cec8fe44903009a365a8}{newwin} = (\textcolor{keywordtype}{void} *)nw;
359     \textcolor{keywordflow}{if}( nw == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
360         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"No NewWindow Allocated"} );
361 
362     nw->Screen = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen};
363 
364     \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
365     \{
366         sprintf( title, \textcolor{stringliteral}{"%s the %s's Inventory"}, \hyperlink{decl_8h_a362b24d8378ea9e5a611cc50d66e354b}{plname}, \hyperlink{decl_8h_a053ad248bf641e54a6f7bfb6a8fb9e05}{pl\_character} );
367         nw->Title = title;
368         \textcolor{keywordflow}{if}( lastinvent.MaxX != 0 )
369         \{
370         nw->LeftEdge = lastinvent.MinX;
371         nw->TopEdge = lastinvent.MinY;
372         nw->Width = lastinvent.MaxX;
373         nw->Height = lastinvent.MaxY;
374         \}
375     \}
376     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a18f1ba88dadd6f00144ad9f0b16a2b20}{morestr} )
377         nw->Title = cw->\hyperlink{structamii__WinDesc_a18f1ba88dadd6f00144ad9f0b16a2b20}{morestr};
378 
379     \textcolor{comment}{/* Adjust the window coordinates and size now that we know}
380 \textcolor{comment}{     * how many items are to be displayed.}
381 \textcolor{comment}{     */}
382 
383     \textcolor{keywordflow}{if}( ( xsize > \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} - nw->LeftEdge ) &&
384         ( xsize < amiIDisplay->xpix ) )
385     \{
386         nw->LeftEdge = \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} - \hyperlink{sp__lev_8c_a22122ed2c15d87f3ff9e3dad23423244}{xsize};
387         nw->Width = \hyperlink{sp__lev_8c_a22122ed2c15d87f3ff9e3dad23423244}{xsize};
388     \}
389     \textcolor{keywordflow}{else}
390     \{
391         nw->Width = \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}( xsize, \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix} - nw->LeftEdge );
392     \}
393     nw->Height = \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}( ysize, \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} - nw->TopEdge );
394 
395     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} || \hyperlink{windefs_8h_adf1601afd1e2d6555110cd79bbbf4705}{WINVERS\_AMII} )
396     \{
397         \textcolor{comment}{/* Make sure we are using the correct hook structure */}
398         nw->Extension = cw->\hyperlink{structamii__WinDesc_a982df47148570e92162c13c1d158ef1b}{wintags};
399     \}
400 
401     \textcolor{comment}{/* Now, open the window */}
402     w = cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} = \hyperlink{winproto_8h_a4fbda1b274fbd7f990be789cfbb8fd52}{OpenShWindow}( (\textcolor{keywordtype}{void} *)nw );
403 
404     \textcolor{keywordflow}{if}( w == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
405     \{
406         \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[ 130 ];
407 
408         sprintf( buf, \textcolor{stringliteral}{"No Window Opened For Menu (%d,%d,%d-%d,%d-%d)"},
409         nw->LeftEdge, nw->TopEdge, nw->Width, \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_af95f6ae98ff1f0ccc96b06fdd296530e}{xpix},
410         nw->Height, \hyperlink{winami_8h_a0ecec29922f9b6272c2b5344ce40b283}{amiIDisplay}->\hyperlink{structamii__DisplayDesc_a24ab4ee31424d8d41235227d2d919b4e}{ypix} );
411         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( buf );
412     \}
413 
414 \textcolor{preprocessor}{#ifdef HACKFONT}
415     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} )
416         SetFont(w->RPort, \hyperlink{winext_8h_a5ba89c525a49d1190a1a5ecdf5f65aa6}{TextsFont} );
417     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \hyperlink{winext_8h_addd84e576afd1379e2aa7fa9921de0a5}{HackFont} )
418         SetFont(w->RPort, \hyperlink{winext_8h_addd84e576afd1379e2aa7fa9921de0a5}{HackFont} );
419 \textcolor{preprocessor}{#endif}
420     txwd = w->RPort->TxWidth;
421     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
422     \{
423         \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
424         txh = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}( w->RPort->TxHeight, \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_ad7ef994c367e747b85e09149fdccff1b}{ysize} + 3 ); \textcolor{comment}{/* interline space */}
425         \textcolor{keywordflow}{else}
426         txh = w->RPort->TxHeight; \textcolor{comment}{/* interline space */}
427     \}
428     \textcolor{keywordflow}{else}
429         txh = w->RPort->TxHeight; \textcolor{comment}{/* interline space */}
430 
431     \textcolor{comment}{/* subtract 2 to account for spacing away from border (1 on each side) */}
432     wheight = ( w->Height - w->BorderTop - w->BorderBottom - 2 ) / txh;
433     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
434     \{
435         \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
436         \{
437         cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft -
438                 w->BorderRight - 4 - \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_a957fade03cbfb4ce4de9df4e09be7fc7}{xsize} - 3 ) / txwd;
439         \}
440         \textcolor{keywordflow}{else}
441         \{
442         cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft - w->BorderRight - 4 ) / txwd;
443         \}
444     \}
445     \textcolor{keywordflow}{else}
446     \{
447         cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft - w->BorderRight - 4 ) / txwd;
448     \}
449     totalvis = \hyperlink{sys_2amiga_2winmenu_8c_aab1d3a28e3b2dd6770eae7e837fa27dd}{CountLines}( win );
450     \}
451     \textcolor{keywordflow}{else}
452     \{
453     txwd = w->RPort->TxWidth;
454     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
455     \{
456         \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
457         txh = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}( w->RPort->TxHeight, \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_ad7ef994c367e747b85e09149fdccff1b}{ysize} + 3 ); \textcolor{comment}{/* interline space */}
458         \textcolor{keywordflow}{else}
459         txh = w->RPort->TxHeight; \textcolor{comment}{/* interline space */}
460     \}
461     \textcolor{keywordflow}{else}
462     \{
463         txh = w->RPort->TxHeight; \textcolor{comment}{/* interline space */}
464     \}
465 
466     \textcolor{comment}{/* subtract 2 to account for spacing away from border (1 on each side) */}
467     wheight = ( w->Height - w->BorderTop - w->BorderBottom - 2 ) / txh;
468     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
469     \{
470         \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
471         \{
472         cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft -
473                 w->BorderRight - 4 - \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_a957fade03cbfb4ce4de9df4e09be7fc7}{xsize} - 3) / txwd;
474         \}
475         \textcolor{keywordflow}{else}
476         cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft - w->BorderRight - 4 ) / txwd;
477     \}
478     \textcolor{keywordflow}{else}
479     \{
480         cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft - w->BorderRight - 4 ) / txwd;
481     \}
482 
483     totalvis = \hyperlink{sys_2amiga_2winmenu_8c_aab1d3a28e3b2dd6770eae7e837fa27dd}{CountLines}( win );
484 
485     \textcolor{keywordflow}{for}( gd = w->FirstGadget; gd && gd->GadgetID != 1; )
486         gd = gd->NextGadget;
487 
488     \textcolor{keywordflow}{if}( gd )
489     \{
490         pip = (\textcolor{keyword}{struct }PropInfo *)gd->SpecialInfo;
491         hidden = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}( totalvis - wheight, 0 );
492         topidx = (((\hyperlink{def__os2_8h_af632da489ebc3708ec3ab6791ee53fa4}{ULONG})hidden * pip->VertPot) + (MAXPOT/2)) >> 16;
493     \}
494     \}
495 
496     \textcolor{keywordflow}{for}( gd = w->FirstGadget; gd && gd->GadgetID != 1; )
497     gd = gd->NextGadget;
498 
499     \textcolor{keywordflow}{if}( !gd ) \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"Can't find scroll gadget"} );
500 
501     \hyperlink{winami_8h_aba452ddfcafb21205b4a07d22dabc398}{morc} = 0;
502     oidx = -1;
503 
504 \textcolor{preprocessor}{#if 0}
505     \textcolor{comment}{/* Make sure there are no selections left over from last time. */}
506 \textcolor{comment}{/* XXX potential problem for preselection if this is really needed */}
507   \textcolor{keywordflow}{for}( amip = cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a01d8d53511bbcb518c8c721c42a1168d}{items}; amip; amip = amip->\hyperlink{structamii__mi_a2046365b8a73513492596c98a5d30452}{next} )
508     amip->\hyperlink{structamii__mi_a47a93b904054888bb7a94309a192f01a}{selected} = 0;
509 \textcolor{preprocessor}{#endif}
510 
511     \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}( win, topidx );
512 
513     \textcolor{comment}{/* Make the prop gadget the right size and place */}
514 
515     \hyperlink{sys_2amiga_2winmenu_8c_a28121fc0d5fc72d2292fa04d5bbf7d60}{SetPropInfo}( w, gd, wheight, totalvis, topidx );
516     oldsecs = oldmics = 0;
517 
518     \textcolor{comment}{/* If window already up, don't stop to process events */}
519     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_ab4e4bdac6ab87e8f1cf420814f09e876}{wasup} )
520     \{
521         aredone = 1;
522         cw->\hyperlink{structamii__WinDesc_ab4e4bdac6ab87e8f1cf420814f09e876}{wasup} = 0;
523     \}
524 
525     \textcolor{keywordflow}{while}( !aredone )
526     \{
527     \textcolor{comment}{/* Process window messages */}
528 
529     WaitPort( w->UserPort );
530     \textcolor{keywordflow}{while}( imsg = (\textcolor{keyword}{struct} IntuiMessage * ) GetMsg( w->UserPort ) )
531     \{
532         \textcolor{keyword}{class }= imsg->Class;
533         code = imsg->Code;
534         mics = imsg->Micros;
535         secs = imsg->Seconds;
536         gd = (\textcolor{keyword}{struct }Gadget *) imsg->IAddress;
537         mx = imsg->MouseX;
538         my = imsg->MouseY;
539 
540         \textcolor{comment}{/* Only do our window or VANILLAKEY from other windows */}
541 
542         \textcolor{keywordflow}{if}( imsg->IDCMPWindow != w && \textcolor{keyword}{class} != VANILLAKEY &&
543                             \textcolor{keyword}{class} != RAWKEY )
544         \{
545         ReplyMsg( (\textcolor{keyword}{struct} Message *) imsg );
546         \textcolor{keywordflow}{continue};
547         \}
548 
549         \textcolor{comment}{/* Do DeadKeyConvert() stuff if RAWKEY... */}
550         \textcolor{keywordflow}{if}( \textcolor{keyword}{class} == RAWKEY )
551         \{
552         \textcolor{keyword}{class }= VANILLAKEY;
553         code = \hyperlink{winproto_8h_a63bceb4935b25e00e97a8b1cf17719bb}{ConvertKey}( imsg );
554         \}
555         ReplyMsg( (\textcolor{keyword}{struct} Message *) imsg );
556 
557         \textcolor{keywordflow}{switch}( \textcolor{keyword}{class} )
558         \{
559         \textcolor{keywordflow}{case} NEWSIZE:
560 
561             \textcolor{comment}{/*}
562 \textcolor{comment}{             * Ignore every other newsize, no action needed,}
563 \textcolor{comment}{             * except RefreshWindowFrame() in case borders got overwritten}
564 \textcolor{comment}{             * for some reason. It should not happen, but ...}
565 \textcolor{comment}{             */}
566 
567             \textcolor{keywordflow}{if}( !dosize )
568             \{
569             RefreshWindowFrame(w);
570             dosize = 1;
571             \textcolor{keywordflow}{break};
572             \}
573 
574             \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
575             \{
576             lastinvent.MinX = w->LeftEdge;
577             lastinvent.MinY = w->TopEdge;
578             lastinvent.MaxX = w->Width;
579             lastinvent.MaxY = w->Height;
580             \}
581             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} )
582             \{
583             \hyperlink{winext_8h_a15fb087f5b07d7dbc0f859370ebe6151}{lastmsg}.MinX = w->LeftEdge;
584             \hyperlink{winext_8h_a15fb087f5b07d7dbc0f859370ebe6151}{lastmsg}.MinY = w->TopEdge;
585             \hyperlink{winext_8h_a15fb087f5b07d7dbc0f859370ebe6151}{lastmsg}.MaxX = w->Width;
586             \hyperlink{winext_8h_a15fb087f5b07d7dbc0f859370ebe6151}{lastmsg}.MaxY = w->Height;
587             \}
588 
589             \textcolor{comment}{/* Find the gadget */}
590 
591             \textcolor{keywordflow}{for}( gd = w->FirstGadget; gd && gd->GadgetID != 1; )
592             gd = gd->NextGadget;
593 
594             \textcolor{keywordflow}{if}( !gd )
595             \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"Can't find scroll gadget"} );
596 
597             totalvis = \hyperlink{sys_2amiga_2winmenu_8c_aab1d3a28e3b2dd6770eae7e837fa27dd}{CountLines}( win );
598             wheight = ( w->Height - w->BorderTop -
599                         w->BorderBottom - 2) / txh;
600             \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
601             \{
602             \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
603             \{
604                 cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft -
605                     w->BorderRight - 4 - \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_a957fade03cbfb4ce4de9df4e09be7fc7}{xsize} - 3) / txwd;
606             \}
607             \textcolor{keywordflow}{else}
608                 cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft - w->BorderRight - 4 ) / txwd;
609             \}
610             \textcolor{keywordflow}{else}
611             \{
612             cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft - w->BorderRight - 4 ) / txwd;
613             \}
614 
615             \textcolor{keywordflow}{if}( wheight < 2 )
616             wheight = 2;
617 
618             \textcolor{comment}{/*}
619 \textcolor{comment}{             * Clear the right side & bottom. Parts of letters are not erased by}
620 \textcolor{comment}{             * amii\_cl\_end if window shrinks and columns decrease.}
621 \textcolor{comment}{             */}
622 
623             \textcolor{keywordflow}{if} ( \hyperlink{windefs_8h_adf1601afd1e2d6555110cd79bbbf4705}{WINVERS\_AMII} || \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} ) \{
624             \hyperlink{winfuncs_8c_a4df453dcf15e61612e6e06b40279d5d8}{amii\_setfillpens}(w, cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type});
625             SetDrMd(w->RPort, JAM2);
626             x2 = w->Width - w->BorderRight;
627             y2 = w->Height - w->BorderBottom;
628             x1 = x2 - w->IFont->tf\_XSize - w->IFont->tf\_XSize;
629             y1 = w->BorderTop;
630             \textcolor{keywordflow}{if} (x1 < w->BorderLeft)
631                 x1 = w->BorderLeft;
632             RectFill(w->RPort, x1, y1, x2, y2);
633             x1 = w->BorderLeft;
634             y1 = y1 - w->IFont->tf\_YSize;
635             RectFill(w->RPort, x1, y1, x2, y2);
636             RefreshWindowFrame(w);
637             \}
638 
639             \textcolor{comment}{/* Make the prop gadget the right size and place */}
640 
641             \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}( win, topidx );
642             \hyperlink{sys_2amiga_2winmenu_8c_a28121fc0d5fc72d2292fa04d5bbf7d60}{SetPropInfo}( w, gd, wheight, totalvis, topidx );
643 
644             \textcolor{comment}{/* Force the window to a text line boundary <= to}
645 \textcolor{comment}{             * what the user dragged it to.  This eliminates}
646 \textcolor{comment}{             * having to clean things up on the bottom edge.}
647 \textcolor{comment}{             */}
648 
649             SizeWindow( w, 0, ( wheight * txh) +
650                 w->BorderTop + w->BorderBottom + 2 - w->Height );
651 
652             \textcolor{comment}{/* Don't do next NEWSIZE, we caused it */}
653             dosize = 0;
654             oldsecs = oldmics = 0;
655             \textcolor{keywordflow}{break};
656 
657         \textcolor{keywordflow}{case} VANILLAKEY:
658 \textcolor{preprocessor}{#define CTRL(x)     ((x)-'@')}
659             \hyperlink{winami_8h_aba452ddfcafb21205b4a07d22dabc398}{morc} = code = \hyperlink{options_8c_a12b336a1f1a4cec27361fc446f21ac01}{map\_menu\_cmd}(code);
660             \textcolor{keywordflow}{if} (code == \hyperlink{wintype_8h_a6c705d18a063df81d02997c09d14157f}{MENU\_SELECT\_ALL}) \{
661             \textcolor{keywordflow}{if} (how == \hyperlink{wintype_8h_a2bd6d317ee7338c416301da3d054dd9f}{PICK\_ANY}) \{
662                 amip = cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a01d8d53511bbcb518c8c721c42a1168d}{items};
663                 \textcolor{keywordflow}{while} (amip) \{
664                 \textcolor{keywordflow}{if} (amip->\hyperlink{structamii__mi_a68250523fd29eae87c3a438284fab1c0}{canselect} && amip->\hyperlink{structamii__mi_a77084785d6d5815d0e006ad4ff6dd0b9}{selector}) \{
665                 \textcolor{comment}{/*}
666 \textcolor{comment}{                 * Select those yet unselected}
667 \textcolor{comment}{                 * and apply count if necessary}
668 \textcolor{comment}{                 */}
669                     \textcolor{keywordflow}{if} (!amip->\hyperlink{structamii__mi_a47a93b904054888bb7a94309a192f01a}{selected}) \{
670                     amip->\hyperlink{structamii__mi_a47a93b904054888bb7a94309a192f01a}{selected} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
671                     \textcolor{keywordflow}{if} (counting) \{
672                         amip->\hyperlink{structamii__mi_a15c24390709412f24da5e5207808712b}{count} = \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
673                         reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
674                     \textcolor{comment}{/*}
675 \textcolor{comment}{                     * This makes the assumption that }
676 \textcolor{comment}{                     * the string is in format "X - foo"}
677 \textcolor{comment}{                     * with additional selecting and formatting}
678 \textcolor{comment}{                     * data in front (size SOFF)}
679 \textcolor{comment}{                     */}
680                         amip->\hyperlink{structamii__mi_a31791a6dba8c361ec8c8d5776bb82593}{str}[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'#'};
681                     \} \textcolor{keywordflow}{else} \{
682                         amip->\hyperlink{structamii__mi_a15c24390709412f24da5e5207808712b}{count} = -1;
683                         amip->\hyperlink{structamii__mi_a31791a6dba8c361ec8c8d5776bb82593}{str}[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'-'};
684                     \}
685                     \}
686                 \}
687                 amip=amip->\hyperlink{structamii__mi_a2046365b8a73513492596c98a5d30452}{next};
688                 \}
689                 \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}(win, topidx);
690             \}
691             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (code == \hyperlink{wintype_8h_a3a476dd165f2b9254ecc1ab3047238f8}{MENU\_UNSELECT\_ALL}) \{
692             \textcolor{keywordflow}{if} (how == \hyperlink{wintype_8h_a2bd6d317ee7338c416301da3d054dd9f}{PICK\_ANY}) \{
693                 amip = cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a01d8d53511bbcb518c8c721c42a1168d}{items};
694                 \textcolor{keywordflow}{while} (amip) \{
695                 \textcolor{keywordflow}{if} (amip->\hyperlink{structamii__mi_a47a93b904054888bb7a94309a192f01a}{selected}) \{
696                     amip->\hyperlink{structamii__mi_a47a93b904054888bb7a94309a192f01a}{selected} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
697                     amip->\hyperlink{structamii__mi_a15c24390709412f24da5e5207808712b}{count} = -1;
698                     amip->\hyperlink{structamii__mi_a31791a6dba8c361ec8c8d5776bb82593}{str}[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'-'};
699                 \}
700                 amip=amip->\hyperlink{structamii__mi_a2046365b8a73513492596c98a5d30452}{next};
701                 \}
702                 \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}(win, topidx);
703             \}
704             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (code == \hyperlink{wintype_8h_a7be1bf4583bee8feddb61ab15e634fd9}{MENU\_INVERT\_ALL}) \{
705             \textcolor{keywordflow}{if} (how == \hyperlink{wintype_8h_a2bd6d317ee7338c416301da3d054dd9f}{PICK\_ANY}) \{
706                 amip = cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a01d8d53511bbcb518c8c721c42a1168d}{items};
707                 \textcolor{keywordflow}{while} (amip) \{
708                 \textcolor{keywordflow}{if} (amip->\hyperlink{structamii__mi_a68250523fd29eae87c3a438284fab1c0}{canselect} && amip->\hyperlink{structamii__mi_a77084785d6d5815d0e006ad4ff6dd0b9}{selector}) \{
709                     amip->\hyperlink{structamii__mi_a47a93b904054888bb7a94309a192f01a}{selected} = !amip->\hyperlink{structamii__mi_a47a93b904054888bb7a94309a192f01a}{selected};
710                     \textcolor{keywordflow}{if} (counting && amip->\hyperlink{structamii__mi_a47a93b904054888bb7a94309a192f01a}{selected}) \{
711                     amip->\hyperlink{structamii__mi_a15c24390709412f24da5e5207808712b}{count} = \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
712                     amip->\hyperlink{structamii__mi_a31791a6dba8c361ec8c8d5776bb82593}{str}[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'#'};
713                     reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
714                     \} \textcolor{keywordflow}{else} \{
715                     amip->\hyperlink{structamii__mi_a15c24390709412f24da5e5207808712b}{count} = -1;
716                     amip->\hyperlink{structamii__mi_a31791a6dba8c361ec8c8d5776bb82593}{str}[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'-'};
717                     \}
718                 \}
719                 amip=amip->\hyperlink{structamii__mi_a2046365b8a73513492596c98a5d30452}{next};
720                 \}
721                 \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}(win, topidx);
722             \}
723             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (code == \hyperlink{wintype_8h_a8ee870b720cd0aab7743ba83f8fb0a1b}{MENU\_SELECT\_PAGE}) \{
724             \textcolor{keywordflow}{if} (how == \hyperlink{wintype_8h_a2bd6d317ee7338c416301da3d054dd9f}{PICK\_ANY}) \{
725                 \textcolor{keywordtype}{int} i = 0;
726                 amip = cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a01d8d53511bbcb518c8c721c42a1168d}{items};
727                 \textcolor{keywordflow}{while} (amip && i++ < topidx)
728                 amip = amip->\hyperlink{structamii__mi_a2046365b8a73513492596c98a5d30452}{next};
729                 \textcolor{keywordflow}{for} (i=0;i < wheight && amip; i++, amip=amip->\hyperlink{structamii__mi_a2046365b8a73513492596c98a5d30452}{next}) \{
730                 \textcolor{keywordflow}{if} (amip->canselect && amip->selector) \{
731                     \textcolor{keywordflow}{if} (!amip->selected) \{
732                     \textcolor{keywordflow}{if} (counting) \{
733                         amip->\hyperlink{structamii__mi_a15c24390709412f24da5e5207808712b}{count} = \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
734                         reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
735                         amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'#'};
736                     \} \textcolor{keywordflow}{else} \{
737                         amip->count = -1;
738                         amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'-'};
739                     \}
740                     \}
741                     amip->selected = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
742                 \}
743                 \}
744                 \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}(win, topidx);
745             \}
746             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (code == \hyperlink{wintype_8h_a18e91769b9181b3462efe03f534bd6e1}{MENU\_UNSELECT\_PAGE}) \{
747             \textcolor{keywordflow}{if} (how == \hyperlink{wintype_8h_a2bd6d317ee7338c416301da3d054dd9f}{PICK\_ANY}) \{
748                 \textcolor{keywordtype}{int} i = 0;
749                 amip = cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a01d8d53511bbcb518c8c721c42a1168d}{items};
750                 \textcolor{keywordflow}{while} (amip && i++ < topidx)
751                 amip = amip->\hyperlink{structamii__mi_a2046365b8a73513492596c98a5d30452}{next};
752                 \textcolor{keywordflow}{for} (i=0;i < wheight && amip; i++, amip=amip->next) \{
753                 \textcolor{keywordflow}{if} (amip->selected) \{
754                     amip->\hyperlink{structamii__mi_a47a93b904054888bb7a94309a192f01a}{selected} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
755                     amip->count = -1;
756                     amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'-'};
757                 \}
758                 \}
759                 \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}(win, topidx);
760             \}
761             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (code == \hyperlink{wintype_8h_ad3dbb023bb0ffc9ffdf822e36734cedc}{MENU\_INVERT\_PAGE}) \{
762             \textcolor{keywordflow}{if} (how == \hyperlink{wintype_8h_a2bd6d317ee7338c416301da3d054dd9f}{PICK\_ANY}) \{
763                 \textcolor{keywordtype}{int} i = 0;
764                 amip = cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a01d8d53511bbcb518c8c721c42a1168d}{items};
765                 \textcolor{keywordflow}{while} (amip && i++ < topidx)
766                 amip = amip->\hyperlink{structamii__mi_a2046365b8a73513492596c98a5d30452}{next};
767                 \textcolor{keywordflow}{for} (i=0;i < wheight && amip; i++, amip=amip->next) \{
768                 \textcolor{keywordflow}{if} (amip->canselect && amip->selector) \{
769                     amip->\hyperlink{structamii__mi_a47a93b904054888bb7a94309a192f01a}{selected} = !amip->selected;
770                     \textcolor{keywordflow}{if} (counting && amip->selected) \{
771                     amip->count = \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
772                     amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'#'};
773                     reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
774                     \} \textcolor{keywordflow}{else} \{
775                     amip->count = -1;
776                     amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'-'};
777                     \}
778                 \}
779                 \}
780                 \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}(win, topidx);
781             \}
782             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (code == \hyperlink{wintype_8h_a1c3201f2628d34d0880a40dbb566f316}{MENU\_SEARCH} && cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == 
      \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU}) \{
783             \textcolor{keywordflow}{if} (how == \hyperlink{wintype_8h_a53377e7b2fddfaf7cc2351dab3b2b139}{PICK\_ONE} || how == \hyperlink{wintype_8h_a2bd6d317ee7338c416301da3d054dd9f}{PICK\_ANY}) \{
784                 \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
785                 amip = cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a01d8d53511bbcb518c8c721c42a1168d}{items};
786                 \hyperlink{winproto_8h_af10d73c7abbeacb1dbf7c63fd6f50fab}{amii\_getlin}(\textcolor{stringliteral}{"Search for:"}, buf);
787                 \textcolor{keywordflow}{if} (!*buf || *buf == \textcolor{charliteral}{'\(\backslash\)033'})
788                 \textcolor{keywordflow}{break};
789                 \textcolor{keywordflow}{while} (amip) \{
790                 \textcolor{keywordflow}{if} (amip->canselect && amip->selector && amip->str &&
791                     strstri(&amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}], buf)) \{
792                     \textcolor{keywordflow}{if} (how == \hyperlink{wintype_8h_a53377e7b2fddfaf7cc2351dab3b2b139}{PICK\_ONE}) \{
793                     amip->selected = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
794                     aredone = 1;
795                     \textcolor{keywordflow}{break};
796                     \}
797                     amip->selected = !amip->selected;
798                     \textcolor{keywordflow}{if} (counting && amip->selected) \{
799                     amip->count = \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
800                     reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
801                     amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'#'};
802                     \} \textcolor{keywordflow}{else} \{
803                     amip->count = -1;
804                     reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
805                     amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'-'};
806                     \}
807                 \}
808                 amip = amip->next;
809                 \}
810             \}
811             \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}(win, topidx);
812             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (how == \hyperlink{wintype_8h_a2bd6d317ee7338c416301da3d054dd9f}{PICK\_ANY} && isdigit(code) &&
813                    (counting || (!counting && code !=\textcolor{charliteral}{'0'}))) \{
814             \textcolor{keywordflow}{if} (count < \hyperlink{global_8h_a7e80c139c01102183d2a57d61b5d2d8a}{LARGEST\_INT}) \{
815                 count = count*10 + (long)(code-\textcolor{charliteral}{'0'});
816                 \textcolor{keywordflow}{if} (count > \hyperlink{global_8h_a7e80c139c01102183d2a57d61b5d2d8a}{LARGEST\_INT})
817                 count = \hyperlink{global_8h_a7e80c139c01102183d2a57d61b5d2d8a}{LARGEST\_INT};
818                 \textcolor{keywordflow}{if} (count > 0) \{
819                 counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
820                 reset\_counting = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
821                 \} \textcolor{keywordflow}{else} \{
822                 reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
823                 \}
824                 sprintf(countString, \textcolor{stringliteral}{"Count: %d"}, count);
825                 pline(countString);
826             \}
827             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( code == \hyperlink{sys_2amiga_2winmenu_8c_ace6fa4719be9aafa2968680c5ef75ac5}{CTRL}(\textcolor{charliteral}{'D'}) || code == \hyperlink{sys_2amiga_2winmenu_8c_ace6fa4719be9aafa2968680c5ef75ac5}{CTRL}(\textcolor{charliteral}{'U'}) ||
828                    code == \hyperlink{wintype_8h_a38905328dea58bbf036f93b7b5a6a6ef}{MENU\_NEXT\_PAGE} || code == 
      \hyperlink{wintype_8h_a688fe5156d1b2c3cce5d71e50d62bfea}{MENU\_PREVIOUS\_PAGE} ||
829                    code == \hyperlink{wintype_8h_a3eed1da5a8a308f757ae0bc07dc185b3}{MENU\_FIRST\_PAGE} || code == 
      \hyperlink{wintype_8h_a0d14d3fa404cc391d604a8c990af0954}{MENU\_LAST\_PAGE} )
830             \{
831             \textcolor{keywordtype}{int} endcnt, i;
832 
833             \textcolor{keywordflow}{for}( gd = w->FirstGadget; gd && gd->GadgetID != 1; )
834                 gd = gd->NextGadget;
835 
836             \textcolor{keywordflow}{if}( !gd )
837                 \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"Can't find scroll gadget"} );
838 
839             endcnt = wheight; \textcolor{comment}{/* /2; */}
840             \textcolor{keywordflow}{if}( endcnt == 0 )
841                 endcnt = 1;
842 
843             \textcolor{keywordflow}{if} (code == \hyperlink{wintype_8h_a3eed1da5a8a308f757ae0bc07dc185b3}{MENU\_FIRST\_PAGE}) \{
844                 topidx = 0;
845             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (code == \hyperlink{wintype_8h_a0d14d3fa404cc391d604a8c990af0954}{MENU\_LAST\_PAGE}) \{
846                 topidx = cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow} - wheight;
847             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{for}( i = 0; i < endcnt; ++i )
848             \{
849                 \textcolor{keywordflow}{if} (code == \hyperlink{sys_2amiga_2winmenu_8c_ace6fa4719be9aafa2968680c5ef75ac5}{CTRL}(\textcolor{charliteral}{'D'}) || code == \hyperlink{wintype_8h_a38905328dea58bbf036f93b7b5a6a6ef}{MENU\_NEXT\_PAGE})
850                 \{
851                 \textcolor{keywordflow}{if}( topidx + wheight < cw->maxrow )
852                     ++topidx;
853                 \textcolor{keywordflow}{else}
854                     \textcolor{keywordflow}{break};
855                 \}
856                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (code = \hyperlink{sys_2amiga_2winmenu_8c_ace6fa4719be9aafa2968680c5ef75ac5}{CTRL}(\textcolor{charliteral}{'U'}) || code == \hyperlink{wintype_8h_a688fe5156d1b2c3cce5d71e50d62bfea}{MENU\_PREVIOUS\_PAGE})
857                 \{
858                 \textcolor{keywordflow}{if}( topidx > 0 )
859                     --topidx;
860                 \textcolor{keywordflow}{else}
861                     \textcolor{keywordflow}{break};
862                 \}
863             \}
864             \textcolor{comment}{/* Make prop gadget the right size and place */}
865 
866             \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}( win, topidx );
867             \hyperlink{sys_2amiga_2winmenu_8c_a28121fc0d5fc72d2292fa04d5bbf7d60}{SetPropInfo}( w,gd, wheight, totalvis, topidx );
868             oldsecs = oldmics = 0;
869             \}
870             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( code == \textcolor{charliteral}{'\(\backslash\)b'} )
871             \{
872             \textcolor{keywordflow}{for}( gd = w->FirstGadget; gd && gd->GadgetID != 1; )
873                 gd = gd->NextGadget;
874 
875             \textcolor{keywordflow}{if}( !gd )
876                 \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"Can't find scroll gadget"} );
877 
878             \textcolor{keywordflow}{if}( topidx - wheight - 2 < 0 )
879             \{
880                 topidx = 0;
881             \}
882             \textcolor{keywordflow}{else}
883             \{
884                 topidx -= wheight - 2;
885             \}
886             \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}( win, topidx );
887             \hyperlink{sys_2amiga_2winmenu_8c_a28121fc0d5fc72d2292fa04d5bbf7d60}{SetPropInfo}( w, gd, wheight, totalvis, topidx );
888             oldsecs = oldmics = 0;
889             \}
890             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( code == \textcolor{charliteral}{' '} )
891             \{
892             \textcolor{keywordflow}{for}( gd = w->FirstGadget; gd && gd->GadgetID != 1; )
893                 gd = gd->NextGadget;
894 
895             \textcolor{keywordflow}{if}( !gd )
896                 \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"Can't find scroll gadget"} );
897 
898             \textcolor{keywordflow}{if}( topidx + wheight >= cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow} )
899             \{
900                 \hyperlink{winami_8h_aba452ddfcafb21205b4a07d22dabc398}{morc} = 0;
901                 aredone = 1;
902             \}
903             \textcolor{keywordflow}{else}
904             \{
905                 \textcolor{comment}{/*  If there are still lines to be seen */}
906 
907                 \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow} > topidx + wheight )
908                 \{
909                 \textcolor{keywordflow}{if}( wheight > 2 )
910                     topidx += wheight - 2;
911                 \textcolor{keywordflow}{else}
912                     ++topidx;
913                 \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}( win, topidx );
914                 \hyperlink{sys_2amiga_2winmenu_8c_a28121fc0d5fc72d2292fa04d5bbf7d60}{SetPropInfo}( w, gd, wheight,
915                             totalvis, topidx );
916                 \}
917                 oldsecs = oldmics = 0;
918             \}
919             \}
920             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( code == \textcolor{charliteral}{'\(\backslash\)n'} || code == \textcolor{charliteral}{'\(\backslash\)r'} )
921             \{
922             \textcolor{keywordflow}{for}( gd = w->FirstGadget; gd && gd->GadgetID != 1; )
923                 gd = gd->NextGadget;
924 
925             \textcolor{keywordflow}{if}( !gd )
926                 \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"Can't find scroll gadget"} );
927 
928             \textcolor{comment}{/* If all line displayed, we are done */}
929 
930             \textcolor{keywordflow}{if}( topidx + wheight >= cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow} )
931             \{
932                 \hyperlink{winami_8h_aba452ddfcafb21205b4a07d22dabc398}{morc} = 0;
933                 aredone = 1;
934             \}
935             \textcolor{keywordflow}{else}
936             \{
937                 \textcolor{comment}{/*  If there are still lines to be seen */}
938 
939                 \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow} > topidx + 1 )
940                 \{
941                 ++topidx;
942                 \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}( win, topidx );
943                 \hyperlink{sys_2amiga_2winmenu_8c_a28121fc0d5fc72d2292fa04d5bbf7d60}{SetPropInfo}( w, gd, wheight,
944                             totalvis, topidx );
945                 \}
946                 oldsecs = oldmics = 0;
947             \}
948             \}
949             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( code == \textcolor{stringliteral}{'\(\backslash\)33'} )
950             \{
951             \textcolor{keywordflow}{if} (counting) \{
952                 reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
953             \} \textcolor{keywordflow}{else} \{
954                 aredone = 1;
955             \}
956             \}
957             \textcolor{keywordflow}{else}
958             \{
959             \textcolor{keywordtype}{int} selected = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
960             \textcolor{keywordflow}{for}( amip = cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a01d8d53511bbcb518c8c721c42a1168d}{items}; amip; amip = amip->\hyperlink{structamii__mi_a2046365b8a73513492596c98a5d30452}{next} )
961             \{
962                 \textcolor{keywordflow}{if}( amip->selector == code )
963                 \{
964                 \textcolor{keywordflow}{if}( how == \hyperlink{wintype_8h_a53377e7b2fddfaf7cc2351dab3b2b139}{PICK\_ONE} )
965                     aredone = 1;
966                 amip->selected = !amip->selected;
967                 \textcolor{keywordflow}{if} (counting && amip->selected) \{
968                     amip->count = \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
969                     reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
970                     amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'#'};
971                 \} \textcolor{keywordflow}{else} \{
972                     amip->count = -1;
973                     reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
974                     amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'-'};
975                 \}
976                 selected = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
977                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (amip->gselector == code )
978                 \{
979                 amip->selected = !amip->selected;
980                 \textcolor{keywordflow}{if} (counting) \{
981                     amip->count = \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
982                     reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
983                     amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'#'};
984                 \} \textcolor{keywordflow}{else} \{
985                     amip->count = -1;
986                     reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
987                     amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'-'};
988                 \}
989                 selected = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
990                 \}
991             \}
992             \textcolor{keywordflow}{if} (selected)
993                 \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}( win, topidx );
994             \}
995             \textcolor{keywordflow}{break};
996 
997         \textcolor{keywordflow}{case} CLOSEWINDOW:
998             \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
999             \{
1000             lastinvent.MinX = w->LeftEdge;
1001             lastinvent.MinY = w->TopEdge;
1002             lastinvent.MaxX = w->Width;
1003             lastinvent.MaxY = w->Height;
1004             \}
1005             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} )
1006             \{
1007             \hyperlink{winext_8h_a15fb087f5b07d7dbc0f859370ebe6151}{lastmsg}.MinX = w->LeftEdge;
1008             \hyperlink{winext_8h_a15fb087f5b07d7dbc0f859370ebe6151}{lastmsg}.MinY = w->TopEdge;
1009             \hyperlink{winext_8h_a15fb087f5b07d7dbc0f859370ebe6151}{lastmsg}.MaxX = w->Width;
1010             \hyperlink{winext_8h_a15fb087f5b07d7dbc0f859370ebe6151}{lastmsg}.MaxY = w->Height;
1011             \}
1012             aredone = 1;
1013             \hyperlink{winami_8h_aba452ddfcafb21205b4a07d22dabc398}{morc} = \textcolor{stringliteral}{'\(\backslash\)33'};
1014             \textcolor{keywordflow}{break};
1015 
1016         \textcolor{keywordflow}{case} GADGETUP:
1017             \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} )
1018             aredone = 1;
1019             \textcolor{keywordflow}{for}( gd = w->FirstGadget; gd && gd->GadgetID != 1; )
1020             gd = gd->NextGadget;
1021 
1022             pip = (\textcolor{keyword}{struct }PropInfo *)gd->SpecialInfo;
1023             totalvis = \hyperlink{sys_2amiga_2winmenu_8c_aab1d3a28e3b2dd6770eae7e837fa27dd}{CountLines}( win );
1024             hidden = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}( totalvis - wheight, 0 );
1025             aidx = (((\hyperlink{def__os2_8h_af632da489ebc3708ec3ab6791ee53fa4}{ULONG})hidden * pip->VertPot) + (MAXPOT/2)) >> 16;
1026             \textcolor{keywordflow}{if}( aidx != topidx )
1027             \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}( win, topidx = aidx );
1028             \textcolor{keywordflow}{break};
1029 
1030         \textcolor{keywordflow}{case} MOUSEMOVE:
1031             \textcolor{keywordflow}{for}( gd = w->FirstGadget; gd && gd->GadgetID != 1; )
1032             gd = gd->NextGadget;
1033 
1034             pip = (\textcolor{keyword}{struct }PropInfo *)gd->SpecialInfo;
1035             totalvis = \hyperlink{sys_2amiga_2winmenu_8c_aab1d3a28e3b2dd6770eae7e837fa27dd}{CountLines}( win );
1036             hidden = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}( totalvis - wheight, 0 );
1037             aidx = (((\hyperlink{def__os2_8h_af632da489ebc3708ec3ab6791ee53fa4}{ULONG})hidden * pip->VertPot) + (MAXPOT/2)) >> 16;
1038             \textcolor{keywordflow}{if}( aidx != topidx )
1039             \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}( win, topidx = aidx );
1040             \textcolor{keywordflow}{break};
1041 
1042         \textcolor{keywordflow}{case} INACTIVEWINDOW:
1043             \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} || ( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} && 
      \hyperlink{winext_8h_a5f7057e3372d8abeddf1df4f99752979}{alwaysinvent} ) )
1044             aredone = 1;
1045             \textcolor{keywordflow}{break};
1046 
1047         \textcolor{keywordflow}{case} MOUSEBUTTONS:
1048             \textcolor{keywordflow}{if}( ( code == SELECTUP || code == SELECTDOWN ) &&
1049                     cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} == \hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU} && how != \hyperlink{wintype_8h_a9e3d317126c3eacb6311e15fedaf717c}{PICK\_NONE} )
1050             \{
1051             \textcolor{comment}{/* Which one is the mouse pointing at? */}
1052 
1053             aidx = ( ( my - w->BorderTop - 1 ) / txh ) + topidx;
1054 
1055             \textcolor{comment}{/* If different lines, don't select double click */}
1056 
1057             \textcolor{keywordflow}{if}( aidx != oidx )
1058             \{
1059                 oldsecs = 0;
1060                 oldmics = 0;
1061             \}
1062 
1063             \textcolor{comment}{/* If releasing, check for double click */}
1064 
1065             \textcolor{keywordflow}{if}( code == SELECTUP )
1066             \{
1067                 amip = \hyperlink{sys_2amiga_2winmenu_8c_aa4cfb2336bbe67a2a34667bacfd6fd8b}{find\_menu\_item}( cw, aidx );
1068                 \textcolor{keywordflow}{if}( aidx == oidx )
1069                 \{
1070                 \textcolor{keywordflow}{if}( DoubleClick( oldsecs,
1071                             oldmics, secs, mics ) )
1072                 \{
1073                     aredone = 1;
1074                 \}
1075                 oldsecs = secs;
1076                 oldmics = mics;
1077                 \}
1078                 \textcolor{keywordflow}{else}
1079                 \{
1080                 amip = \hyperlink{sys_2amiga_2winmenu_8c_aa4cfb2336bbe67a2a34667bacfd6fd8b}{find\_menu\_item}( cw, oidx );
1081                 amip->selected = 0;
1082                 amip->count = -1;
1083                 reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1084                 \textcolor{keywordflow}{if} (amip->canselect && amip->selector)
1085                     amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'-'};
1086                 \}
1087                 \textcolor{keywordflow}{if} (counting && amip->selected && amip->canselect && amip->selector) \{
1088                 amip->count = \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
1089                 reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1090                 amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'#'};
1091                 \}
1092                 \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}( win, topidx );
1093             \}
1094             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( aidx - topidx < wheight &&
1095                 aidx < cw->maxrow && code == SELECTDOWN )
1096             \{
1097                 \textcolor{comment}{/* Remove old highlighting if visible */}
1098 
1099                 amip = \hyperlink{sys_2amiga_2winmenu_8c_aa4cfb2336bbe67a2a34667bacfd6fd8b}{find\_menu\_item}( cw, oidx );
1100                 \textcolor{keywordflow}{if}( amip && oidx != aidx &&
1101                     ( oidx > topidx && oidx - topidx < wheight ) )
1102                 \{
1103                 \textcolor{keywordflow}{if}( how != \hyperlink{wintype_8h_a2bd6d317ee7338c416301da3d054dd9f}{PICK\_ANY} ) \{
1104                     amip->selected = 0;
1105                     amip->count = -1;
1106                     reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1107                     \textcolor{keywordflow}{if} (amip->canselect && amip->selector)
1108                     amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'-'};
1109                 \}
1110                 oidx = -1;
1111                 \}
1112                 amip = \hyperlink{sys_2amiga_2winmenu_8c_aa4cfb2336bbe67a2a34667bacfd6fd8b}{find\_menu\_item}( cw, aidx );
1113 
1114                 \textcolor{keywordflow}{if}( amip && amip->canselect && amip->selector && how != 
      \hyperlink{wintype_8h_a9e3d317126c3eacb6311e15fedaf717c}{PICK\_NONE} )
1115                 \{
1116                 oidx = aidx;
1117                 \textcolor{keywordflow}{if}( !DoubleClick( oldsecs,
1118                             oldmics, secs, mics ) )
1119                 \{
1120                     amip->selected = !amip->selected;
1121                     \textcolor{keywordflow}{if} (counting && amip->selected) \{
1122                     amip->count = \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
1123                     reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1124                     amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'#'};
1125                     \} \textcolor{keywordflow}{else} \{
1126                     amip->count = -1;
1127                     reset\_counting = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1128                     \textcolor{keywordflow}{if} (amip->canselect && amip->selector)
1129                         amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'-'};
1130                     \}
1131                 \}
1132                 \}
1133                 \textcolor{keywordflow}{else}
1134                 \{
1135                 DisplayBeep( \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} );
1136                 oldsecs = 0;
1137                 oldmics = 0;
1138                 \}
1139                 \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}( win, topidx );
1140             \}
1141             \}
1142             \textcolor{keywordflow}{else}
1143             \{
1144             DisplayBeep( \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} );
1145             \}
1146             \textcolor{keywordflow}{break};
1147         \}
1148         \textcolor{keywordflow}{if} (!counting && \hyperlink{winami_8h_aba452ddfcafb21205b4a07d22dabc398}{morc} == \textcolor{stringliteral}{'\(\backslash\)33'}) \{
1149         amip = cw->\hyperlink{structamii__WinDesc_aeffe06ac39ddf1ea949990646a1bbf0d}{menu}.\hyperlink{structamii__menu_a01d8d53511bbcb518c8c721c42a1168d}{items};
1150         \textcolor{keywordflow}{while} (amip) \{
1151             \textcolor{keywordflow}{if} (amip->canselect && amip->selector) \{
1152             amip->\hyperlink{structamii__mi_a47a93b904054888bb7a94309a192f01a}{selected} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1153             amip->count = -1;
1154             amip->str[\hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF}+2] = \textcolor{charliteral}{'-'};
1155             \}
1156             amip=amip->next;
1157         \}
1158         \}
1159         \textcolor{keywordflow}{if} (reset\_counting) \{
1160         count = 0;
1161         \textcolor{keywordflow}{if} (counting)
1162             pline(\textcolor{stringliteral}{"Count: 0"});
1163         counting = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1164         \}
1165     \}
1166     \}
1167     \textcolor{comment}{/* Force a cursor reposition before next message output */}
1168     \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE} )
1169     cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} = -1;
1170     \textcolor{keywordflow}{return}( \hyperlink{sys_2amiga_2winmenu_8c_a9193caef076cb9de1fc1d4a77c34b869}{make\_menu\_items}( cw, retmip ) );
1171 \}
\end{DoxyCode}
\hypertarget{winproto_8h_aab86548f4b4be239a38c53e5bb10302a}{\index{winproto.\+h@{winproto.\+h}!Draw\+Col@{Draw\+Col}}
\index{Draw\+Col@{Draw\+Col}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Draw\+Col}]{\setlength{\rightskip}{0pt plus 5cm}void Draw\+Col (
\begin{DoxyParamCaption}
\item[{struct Window $\ast$}]{w, }
\item[{int}]{idx, }
\item[{{\bf U\+W\+O\+R\+D} $\ast$}]{colors}
\end{DoxyParamCaption}
)}}\label{winproto_8h_aab86548f4b4be239a38c53e5bb10302a}


Definition at line 754 of file winreq.\+c.



References amii\+\_\+numcolors, C\+\_\+\+B\+L\+A\+C\+K, Col\+\_\+\+Blue\+Pen, Col\+\_\+\+Green\+Pen, Col\+\_\+\+Okay, Col\+\_\+\+Red\+Pen, Disp\+Col(), flags, and txheight.



Referenced by Edit\+Color().


\begin{DoxyCode}
758 \{
759     \textcolor{keywordtype}{int} bxorx, bxory, bxxlen, bxylen;
760     \textcolor{keywordtype}{int} i, incx, incy, r, g, b;
761     \textcolor{keywordtype}{long} mflags;
762 
763     bxylen = \hyperlink{colorwin_8c_ab815dee1d7283dbb1b231460ac6374c5}{Col\_Okay}.TopEdge - ( \hyperlink{colorwin_8c_a16203e99df17e41a95652eb2f1bf4fcc}{Col\_BluePen}.TopEdge + 
      \hyperlink{colorwin_8c_a16203e99df17e41a95652eb2f1bf4fcc}{Col\_BluePen}.Height ) - 1
764         - \hyperlink{winext_8h_afdf567214d70875e5c17efe40a02b53a}{txheight} - 3;
765     bxxlen = \hyperlink{colorwin_8c_a16203e99df17e41a95652eb2f1bf4fcc}{Col\_BluePen}.Width - 2;
766     bxorx = \hyperlink{colorwin_8c_a16203e99df17e41a95652eb2f1bf4fcc}{Col\_BluePen}.LeftEdge + 1;
767     bxory = \hyperlink{colorwin_8c_a16203e99df17e41a95652eb2f1bf4fcc}{Col\_BluePen}.TopEdge + \hyperlink{colorwin_8c_a16203e99df17e41a95652eb2f1bf4fcc}{Col\_BluePen}.Height + 2;
768 
769     incx = bxxlen / \hyperlink{winext_8h_ae3cfaa8053fd2f089c9fe1ba90289e98}{amii\_numcolors};
770     incy = bxylen - 2;
771 
772     bxxlen /= incx;
773     bxxlen *= incx;
774     bxxlen += 2;
775 
776     \textcolor{keywordflow}{for}( i = 0; i < \hyperlink{winext_8h_ae3cfaa8053fd2f089c9fe1ba90289e98}{amii\_numcolors}; ++i )
777     \{
778     \textcolor{keywordtype}{int} x, y;
779     x = bxorx + 2 + (i*incx);
780     y = bxory + 2;
781 
782     \textcolor{keywordflow}{if}( i == idx )
783     \{
784         SetAPen( w->RPort, \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.amii\_dripens[ SHADOWPEN ] );
785         Move( w->RPort, x, y+bxylen-4 );
786         Draw( w->RPort, x, y );
787         Draw( w->RPort, x+incx-1, y );
788 
789         Move( w->RPort, x+1, y+bxylen-5 );
790         Draw( w->RPort, x+1, y+1 );
791         Draw( w->RPort, x+incx-2, y+1 );
792 
793         SetAPen( w->RPort, \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.amii\_dripens[ SHINEPEN ] );
794         Move( w->RPort, x+incx-1, y+1 );
795         Draw( w->RPort, x+incx-1, y+bxylen-4 );
796         Draw( w->RPort, x, y+bxylen-4 );
797 
798         Move( w->RPort, x+incx-2, y+2 );
799         Draw( w->RPort, x+incx-2, y+bxylen-5 );
800         Draw( w->RPort, x+1, y+bxylen-5 );
801     \}
802     \textcolor{keywordflow}{else}
803     \{
804         SetAPen( w->RPort, \hyperlink{windefs_8h_a22a9543e081938a146a8bce60a84200a}{C\_BLACK} );
805         Move( w->RPort, x, y );
806         Draw( w->RPort, x +incx-1, y );
807         Draw( w->RPort, x +incx-1, y +bxylen - 4 );
808         Draw( w->RPort, x, y + bxylen - 4 );
809         Draw( w->RPort, x, y );
810         SetAPen( w->RPort, \hyperlink{windefs_8h_a22a9543e081938a146a8bce60a84200a}{C\_BLACK} );
811         Move( w->RPort, x+1, y+1 );
812         Draw( w->RPort, x +incx-2, y+1 );
813         Draw( w->RPort, x +incx-2, y +bxylen - 6 );
814         Draw( w->RPort, x+1, y + bxylen - 6 );
815         Draw( w->RPort, x+1, y+1 );
816     \}
817 
818     SetAPen( w->RPort, i );
819     RectFill( w->RPort, x + 3, y + 3, x + incx - 4, y + bxylen - 6 );
820     \}
821 
822     \hyperlink{winreq_8c_a11c44eb0694ea5e51081e54d8df22cd2}{DispCol}( w, idx, colors );
823 
824     r = (colors[ idx ] & 0xf00) >> 8;
825     g = (colors[ idx ] & 0x0f0) >> 4;
826     b = colors[ idx ] & 0x00f;
827 
828     mflags = AUTOKNOB|FREEHORIZ;
829 \textcolor{preprocessor}{#ifdef  INTUI\_NEW\_LOOK}
830     \textcolor{keywordflow}{if}( IntuitionBase->LibNode.lib\_Version >= 37 )
831     \{
832     mflags |= PROPNEWLOOK;
833     \}
834 \textcolor{preprocessor}{#endif}
835     NewModifyProp( &\hyperlink{colorwin_8c_aa6c4fb052b19fc770d28bfd1b248a25e}{Col\_RedPen}, w, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, mflags, (r * MAXPOT ) / 15, 0,
836                                 MAXPOT/15, 0, 1 );
837     NewModifyProp( &\hyperlink{colorwin_8c_a005b7d9317bb8c0a0b044f8f3924acb7}{Col\_GreenPen}, w, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, mflags, (g * MAXPOT ) / 15, 0,
838                                 MAXPOT/15, 0, 1 );
839     NewModifyProp( &\hyperlink{colorwin_8c_a16203e99df17e41a95652eb2f1bf4fcc}{Col\_BluePen}, w, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, mflags, (b * MAXPOT ) / 15, 0,
840                                 MAXPOT/15, 0, 1 );
841 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ac3377d82ce911663e05ba9a63d464d90}{\index{winproto.\+h@{winproto.\+h}!Dup\+New\+Window@{Dup\+New\+Window}}
\index{Dup\+New\+Window@{Dup\+New\+Window}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Dup\+New\+Window}]{\setlength{\rightskip}{0pt plus 5cm}struct New\+Window$\ast$ Dup\+New\+Window (
\begin{DoxyParamCaption}
\item[{struct New\+Window $\ast$}]{win}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ac3377d82ce911663e05ba9a63d464d90}


Referenced by Do\+Menu\+Scroll().

\hypertarget{winproto_8h_a614ba0cf5df7db4e8e464ea269143a38}{\index{winproto.\+h@{winproto.\+h}!Edit\+Clipping@{Edit\+Clipping}}
\index{Edit\+Clipping@{Edit\+Clipping}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Edit\+Clipping}]{\setlength{\rightskip}{0pt plus 5cm}void Edit\+Clipping (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a614ba0cf5df7db4e8e464ea269143a38}


Definition at line 383 of file winreq.\+c.



References amii\+\_\+other\+B\+Pen, amii\+\_\+wins, buf, Clip\+Cancel, Clip\+New\+Window\+Structure1, Clip\+Okay, Clip\+X\+C\+L\+I\+P, Clip\+X\+S\+I\+Z\+E, Clip\+Y\+C\+L\+I\+P, Clip\+Y\+S\+I\+Z\+E, done, doredraw(), fillhook, flush\+\_\+glyph\+\_\+buffer(), G\+A\+D\+C\+A\+N\+C\+E\+L, G\+A\+D\+O\+K\+A\+Y, Hack\+Screen, Layer\+Fill\+Hook(), mxsize, mysize, okay(), reclip, Set\+Border(), Show\+Clip\+Values(), W\+I\+N\+\_\+\+M\+A\+P, wintags, W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+I, W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V, X\+C\+L\+I\+P, X\+S\+I\+Z\+E, Y\+C\+L\+I\+P, and Y\+S\+I\+Z\+E.


\begin{DoxyCode}
384 \{
385     \textcolor{keywordtype}{int} i;
386     \textcolor{keywordtype}{long} mflags;
387     \textcolor{keyword}{static} \textcolor{keywordtype}{int} sizes[] = \{ 8, 16, 20, 24, 28, 32, 36 \};
388     \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[ 40 ];
389     \textcolor{keywordtype}{int} \hyperlink{winX_8c_a032589f4f70300762622fd253db008d0}{done} = 0, \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} = 0;
390     \textcolor{keywordtype}{long} code, qual, \textcolor{keyword}{class};
391     \textcolor{keyword}{register} \textcolor{keyword}{struct }Gadget *gd, *dgad;
392     \textcolor{keyword}{register} \textcolor{keyword}{struct }Window *nw;
393     \textcolor{keyword}{register} \textcolor{keyword}{struct }IntuiMessage *imsg;
394     \textcolor{keyword}{register} \textcolor{keyword}{struct }PropInfo *pip;
395     \textcolor{keyword}{register} \textcolor{keyword}{struct }Screen *scrn;
396     \textcolor{keywordtype}{long} aidx;
397     \textcolor{keywordtype}{int} lmxsize = \hyperlink{winext_8h_afba9a8d2cd024c7010eae489091d11d6}{mxsize}, lmysize = \hyperlink{winext_8h_a9703aea67c83633a25beaa737dad2b65}{mysize};
398     \textcolor{keywordtype}{int} lxclipbord = xclipbord, lyclipbord = yclipbord;
399     \textcolor{keywordtype}{int} msx, msy;
400     \textcolor{keywordtype}{int} drag = 0;
401     \textcolor{keyword}{static} \textcolor{keywordtype}{int} once = 0;
402 
403     scrn = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen};
404 
405     \textcolor{keywordflow}{if}( !once )
406     \{
407     \hyperlink{winproto_8h_aaa6575d9ac823d93fcc4176f3b1341c3}{SetBorder}( &\hyperlink{clipwin_8c_ae0bd9b38d10d303ddeffb3caf09c3c51}{ClipOkay} );
408     \hyperlink{winproto_8h_aaa6575d9ac823d93fcc4176f3b1341c3}{SetBorder}( &\hyperlink{clipwin_8c_ab2b1b3ddf4f0918955e3f797a342773a}{ClipCancel} );
409     once = 1;
410     \}
411     \hyperlink{clipwin_8c_aedc33a3c2d584d5a90281d77fa57fda2}{ClipNewWindowStructure1}.Screen = scrn;
412 \textcolor{preprocessor}{#ifdef  INTUI\_NEW\_LOOK}
413     \textcolor{keywordflow}{if}( IntuitionBase->LibNode.lib\_Version >= 37 )
414     \{
415     ((\textcolor{keyword}{struct }PropInfo *)\hyperlink{clipwin_8c_a609bc92c46f5f92521e89e7b8b72467c}{ClipXSIZE}.SpecialInfo)->Flags |= PROPNEWLOOK;
416     ((\textcolor{keyword}{struct }PropInfo *)\hyperlink{clipwin_8c_ad850fe5cb595a6b29d392d26aa93821d}{ClipYSIZE}.SpecialInfo)->Flags |= PROPNEWLOOK;
417     ((\textcolor{keyword}{struct }PropInfo *)\hyperlink{clipwin_8c_a2bc81a92944f2445b844ca39c30b6bbc}{ClipXCLIP}.SpecialInfo)->Flags |= PROPNEWLOOK;
418     ((\textcolor{keyword}{struct }PropInfo *)\hyperlink{clipwin_8c_ae72e2013f01f9883a38d1223a0225041}{ClipYCLIP}.SpecialInfo)->Flags |= PROPNEWLOOK;
419     \}
420 \textcolor{preprocessor}{#endif}
421     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} || \hyperlink{windefs_8h_adf1601afd1e2d6555110cd79bbbf4705}{WINVERS\_AMII} )
422     \{
423 \textcolor{preprocessor}{# ifdef INTUI\_NEW\_LOOK}
424     \hyperlink{clipwin_8c_aedc33a3c2d584d5a90281d77fa57fda2}{ClipNewWindowStructure1}.Extension = \hyperlink{winext_8h_af89b1b4ca5e09b3b019caabfbf2243cd}{wintags};
425     \hyperlink{clipwin_8c_aedc33a3c2d584d5a90281d77fa57fda2}{ClipNewWindowStructure1}.Flags |= WFLG\_NW\_EXTENDED;
426 \textcolor{preprocessor}{#  ifdef \_\_GNUC\_\_}
427     \hyperlink{winext_8h_a6ff9485e071d0a750346503394100a89}{fillhook}.h\_Entry = (\textcolor{keywordtype}{void} *)&\hyperlink{winext_8h_a9e524533351c8e043ccc43941ad1055f}{LayerFillHook};
428 \textcolor{preprocessor}{#  else}
429     \hyperlink{winext_8h_a6ff9485e071d0a750346503394100a89}{fillhook}.h\_Entry = (\hyperlink{def__os2_8h_af632da489ebc3708ec3ab6791ee53fa4}{ULONG}(*)())\hyperlink{winext_8h_a9e524533351c8e043ccc43941ad1055f}{LayerFillHook};
430 \textcolor{preprocessor}{#  endif}
431     \hyperlink{winext_8h_a6ff9485e071d0a750346503394100a89}{fillhook}.h\_Data = (\textcolor{keywordtype}{void} *)-2;
432     \hyperlink{winext_8h_a6ff9485e071d0a750346503394100a89}{fillhook}.h\_SubEntry = 0;
433 \textcolor{preprocessor}{# endif}
434     \}
435 
436     nw = OpenWindow( (\textcolor{keywordtype}{void} *)&\hyperlink{clipwin_8c_aedc33a3c2d584d5a90281d77fa57fda2}{ClipNewWindowStructure1} );
437 
438     \textcolor{keywordflow}{if}( nw == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
439     \{
440     DisplayBeep( \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} );
441     \textcolor{keywordflow}{return};
442     \}
443 
444     \hyperlink{winreq_8c_adb2722a7928452baccc065924be79730}{ShowClipValues}( nw );
445     mflags = AUTOKNOB|FREEHORIZ;
446 \textcolor{preprocessor}{#ifdef  INTUI\_NEW\_LOOK}
447     \textcolor{keywordflow}{if}( IntuitionBase->LibNode.lib\_Version >= 37 )
448     \{
449     mflags |= PROPNEWLOOK;
450     \}
451 \textcolor{preprocessor}{#endif}
452 
453     \textcolor{keywordflow}{for}( i = 0; i < 7; ++i )
454     \{
455     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_afba9a8d2cd024c7010eae489091d11d6}{mxsize} <= sizes[ i ] )
456         \textcolor{keywordflow}{break};
457     \}
458     NewModifyProp( &\hyperlink{clipwin_8c_a609bc92c46f5f92521e89e7b8b72467c}{ClipXSIZE}, nw, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, mflags, (i * MAXPOT ) / 6, 0,
459                                 MAXPOT/6, 0, 1 );
460     \textcolor{keywordflow}{for}( i = 0; i < 7; ++i )
461     \{
462     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a9703aea67c83633a25beaa737dad2b65}{mysize} <= sizes[ i ] )
463         \textcolor{keywordflow}{break};
464     \}
465     NewModifyProp( &\hyperlink{clipwin_8c_ad850fe5cb595a6b29d392d26aa93821d}{ClipYSIZE}, nw, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, mflags, (i * MAXPOT ) / 6, 0,
466                                 MAXPOT/6, 0, 1 );
467 
468     NewModifyProp( &\hyperlink{clipwin_8c_a2bc81a92944f2445b844ca39c30b6bbc}{ClipXCLIP}, nw, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, mflags, ((xclipbord-2) * MAXPOT ) / 6, 0,
469                                 MAXPOT/6, 0, 1 );
470     NewModifyProp( &\hyperlink{clipwin_8c_ae72e2013f01f9883a38d1223a0225041}{ClipYCLIP}, nw, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, mflags, ((yclipbord-2) * MAXPOT ) / 6, 0,
471                                 MAXPOT/6, 0, 1 );
472 
473     \textcolor{keywordflow}{while}( !done )
474     \{
475     WaitPort( nw->UserPort );
476 
477     \textcolor{keywordflow}{while}( imsg = (\textcolor{keyword}{struct} IntuiMessage * )GetMsg( nw->UserPort ) )
478     \{
479         gd = (\textcolor{keyword}{struct }Gadget *)imsg->IAddress;
480         code = imsg->Code;
481         \textcolor{keyword}{class} = imsg->Class;
482         qual = imsg->Qualifier;
483         msx = imsg->MouseX;
484         msy = imsg->MouseY;
485 
486         ReplyMsg( (\textcolor{keyword}{struct} Message *)imsg );
487 
488         \textcolor{keywordflow}{switch}( \textcolor{keyword}{class} )
489         \{
490         \textcolor{keywordflow}{case} VANILLAKEY:
491         \textcolor{keywordflow}{if}( code == \textcolor{stringliteral}{'\(\backslash\)33'} )
492             \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} = 0, done = 1;
493         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( code == \textcolor{charliteral}{'v'} && qual == AMIGALEFT )
494             \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} = done = 1;
495         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( code == \textcolor{charliteral}{'b'} && qual == AMIGALEFT )
496             \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} = 0, done = 1;
497         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( code == \textcolor{charliteral}{'o'} || code == \textcolor{charliteral}{'O'} )
498             \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} = done = 1;
499         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( code == \textcolor{charliteral}{'c'} || code == \textcolor{charliteral}{'C'} )
500             \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} = 0, done = 1;
501         \textcolor{keywordflow}{break};
502 
503         \textcolor{keywordflow}{case} CLOSEWINDOW:
504         done = 1;
505         \textcolor{keywordflow}{break};
506 
507         \textcolor{keywordflow}{case} GADGETUP:
508         drag = 0;
509         \textcolor{keywordflow}{if}( gd->GadgetID == \hyperlink{winreq_8c_aa4e3cb2d54808a145ef60a0a53f593e2}{XSIZE} || gd->GadgetID == \hyperlink{winreq_8c_afaefa0d521156ca605f526c14d05e272}{YSIZE} ||
510             gd->GadgetID == \hyperlink{winreq_8c_a7c4db99b45d8d9e6d58397cf16b350cc}{XCLIP} || gd->GadgetID == \hyperlink{winreq_8c_a16e8a7080fc512b675a1c7260659308d}{YCLIP} )
511         \{
512             pip = (\textcolor{keyword}{struct }PropInfo *)gd->SpecialInfo;
513             aidx = pip->HorizPot / (MAXPOT/6);
514             \textcolor{keywordflow}{if}( gd->GadgetID == \hyperlink{winreq_8c_aa4e3cb2d54808a145ef60a0a53f593e2}{XSIZE} )
515             \{
516             \hyperlink{winext_8h_afba9a8d2cd024c7010eae489091d11d6}{mxsize} = sizes[ aidx ];
517             \}
518             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( gd->GadgetID == \hyperlink{winreq_8c_afaefa0d521156ca605f526c14d05e272}{YSIZE} )
519             \{
520             \hyperlink{winext_8h_a9703aea67c83633a25beaa737dad2b65}{mysize} = sizes[ aidx ];
521             \}
522             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( gd->GadgetID == \hyperlink{winreq_8c_a7c4db99b45d8d9e6d58397cf16b350cc}{XCLIP} )
523             \{
524             xclipbord = aidx + 2;
525             \}
526             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( gd->GadgetID == \hyperlink{winreq_8c_a16e8a7080fc512b675a1c7260659308d}{YCLIP} )
527             \{
528             yclipbord = aidx + 2;
529             \}
530             \hyperlink{winreq_8c_adb2722a7928452baccc065924be79730}{ShowClipValues}( nw );
531 \textcolor{preprocessor}{#ifdef OPT\_DISPMAP}
532             dispmap\_sanity();
533 \textcolor{preprocessor}{#endif}
534         \}
535         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( gd->GadgetID == \hyperlink{winreq_8c_a0258d189f5e75c01d285f0c64fd75cf3}{GADOKAY} )
536         \{
537             done = 1;
538             \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} = 1;
539         \}
540         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( gd->GadgetID == \hyperlink{winreq_8c_a9220cda432f9aaaee986619df2f9c167}{GADCANCEL} )
541         \{
542             done = 1;
543             \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} = 0;
544         \}
545         ReportMouse( 0, nw );
546         \hyperlink{winchar_8c_abaef652f2ecc14cf7257f91b8f5f0527}{reclip} = 2;
547         \hyperlink{display_8c_abf432a93fec9c94db8570f8a2c01468e}{doredraw}();
548         \hyperlink{winchar_8c_aedd7ad0350a58b8fca664bcbdc5f1f35}{flush\_glyph\_buffer}( \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ \hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP} ]->win );
549         \hyperlink{winchar_8c_abaef652f2ecc14cf7257f91b8f5f0527}{reclip} = 0;
550         \textcolor{keywordflow}{break};
551 
552         \textcolor{keywordflow}{case} GADGETDOWN:
553         drag = 1;
554         dgad = gd;
555         ReportMouse( 1, nw );
556         \textcolor{keywordflow}{break};
557 
558         \textcolor{keywordflow}{case} MOUSEMOVE:
559         \textcolor{keywordflow}{if}( !drag )
560             \textcolor{keywordflow}{break};
561         pip = (\textcolor{keyword}{struct }PropInfo *)dgad->SpecialInfo;
562         aidx = pip->HorizPot / (MAXPOT/6);
563         Move( nw->RPort, dgad->LeftEdge + (nw->Width + dgad->Width) + 8,
564                 dgad->TopEdge + nw->RPort->TxBaseline );
565         \textcolor{keywordflow}{if}( dgad->GadgetID == \hyperlink{winreq_8c_aa4e3cb2d54808a145ef60a0a53f593e2}{XSIZE} )
566         \{
567             \hyperlink{winext_8h_afba9a8d2cd024c7010eae489091d11d6}{mxsize} = sizes[ aidx ];
568             sprintf( buf, \textcolor{stringliteral}{"%d "},lmxsize );
569         \}
570         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( dgad->GadgetID == \hyperlink{winreq_8c_afaefa0d521156ca605f526c14d05e272}{YSIZE} )
571         \{
572             \hyperlink{winext_8h_a9703aea67c83633a25beaa737dad2b65}{mysize} = sizes[ aidx ];
573             sprintf( buf, \textcolor{stringliteral}{"%d "}, \hyperlink{winext_8h_a9703aea67c83633a25beaa737dad2b65}{mysize} );
574         \}
575         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( dgad->GadgetID == \hyperlink{winreq_8c_a7c4db99b45d8d9e6d58397cf16b350cc}{XCLIP} )
576         \{
577             xclipbord = aidx + 2;
578             sprintf( buf, \textcolor{stringliteral}{"%d "}, xclipbord );
579         \}
580         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( dgad->GadgetID == \hyperlink{winreq_8c_a16e8a7080fc512b675a1c7260659308d}{YCLIP} )
581         \{
582             yclipbord = aidx + 2;
583             sprintf( buf, \textcolor{stringliteral}{"%d "}, yclipbord );
584         \}
585         SetAPen( nw->RPort, 5 );
586         SetBPen( nw->RPort, \hyperlink{winext_8h_a111dca2a2ad69484b4c949424caa4ffa}{amii\_otherBPen} );
587         SetDrMd( nw->RPort, JAM2 );
588         Text( nw->RPort, buf, strlen( buf ) );
589 \textcolor{preprocessor}{#ifdef OPT\_DISPMAP}
590          dispmap\_sanity();
591 \textcolor{preprocessor}{#endif}
592         \textcolor{keywordflow}{break};
593         \}
594     \}
595     \}
596 
597     CloseWindow( nw );
598 
599     \textcolor{comment}{/* Restore oldvalues if cancelled. */}
600     \textcolor{keywordflow}{if}( !\hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} )
601     \{
602     \hyperlink{winext_8h_afba9a8d2cd024c7010eae489091d11d6}{mxsize} = lmxsize;
603     \hyperlink{winext_8h_a9703aea67c83633a25beaa737dad2b65}{mysize} = lmysize;
604     xclipbord = lxclipbord;
605     yclipbord = lyclipbord;
606     \}
607 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a8b8c3f2cb3b8247c9610be0bb0d23f3e}{\index{winproto.\+h@{winproto.\+h}!Edit\+Color@{Edit\+Color}}
\index{Edit\+Color@{Edit\+Color}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Edit\+Color}]{\setlength{\rightskip}{0pt plus 5cm}void Edit\+Color (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a8b8c3f2cb3b8247c9610be0bb0d23f3e}


Definition at line 58 of file winreq.\+c.



References A\+M\+I\+I\+\_\+\+M\+A\+X\+C\+O\+L\+O\+R\+S, amii\+\_\+numcolors, buf, Clear\+Col(), Col\+\_\+\+Blue\+Pen, Col\+\_\+\+Cancel, Col\+\_\+\+Green\+Pen, Col\+\_\+\+Intui\+Text\+List1, Col\+\_\+\+New\+Window\+Structure1, Col\+\_\+\+Okay, Col\+\_\+\+Red\+Pen, Col\+\_\+\+Save, configfile, dirname(), Disp\+Col(), done, Draw\+Col(), filecopy(), fillhook, flags, fp, G\+A\+D\+B\+L\+U\+E\+P\+E\+N, G\+A\+D\+C\+O\+L\+C\+A\+N\+C\+E\+L, G\+A\+D\+C\+O\+L\+O\+K\+A\+Y, G\+A\+D\+C\+O\+L\+S\+A\+V\+E, G\+A\+D\+G\+R\+E\+E\+N\+P\+E\+N, G\+A\+D\+R\+E\+D\+P\+E\+N, Hack\+Screen, Layer\+Fill\+Hook(), okay(), Set\+Border(), unlink(), U\+W\+O\+R\+D, wintags, W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+I, and W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V.


\begin{DoxyCode}
59 \{
60     \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\hyperlink{decl_8h_a1abd7c1fc746ce34b6e11baaf7370173}{configfile};
61     \textcolor{keywordtype}{int} i, \hyperlink{winX_8c_a032589f4f70300762622fd253db008d0}{done} = 0, \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} = 0;
62     \textcolor{keywordtype}{long} code, qual, \textcolor{keyword}{class};
63     \textcolor{keyword}{register} \textcolor{keyword}{struct }Gadget *gd, *dgad;
64     \textcolor{keyword}{register} \textcolor{keyword}{struct }Window *nw;
65     \textcolor{keyword}{register} \textcolor{keyword}{struct }IntuiMessage *imsg;
66     \textcolor{keyword}{register} \textcolor{keyword}{struct }PropInfo *pip;
67     \textcolor{keyword}{register} \textcolor{keyword}{struct }Screen *scrn;
68     \textcolor{keywordtype}{long} aidx;
69     \textcolor{keywordtype}{int} msx, msy;
70     \textcolor{keywordtype}{int} curcol = 0, drag = 0;
71     \textcolor{keywordtype}{int} bxorx, bxory, bxxlen, bxylen;
72     \textcolor{keyword}{static} \hyperlink{bitmfile_8h_a0428171499a4ab7aebc2bf058ae337df}{UWORD} colors[ \hyperlink{amiconf_8h_a551015331d3f91ae1ca3cb425e24e5ea}{AMII\_MAXCOLORS} ];
73     \textcolor{keyword}{static} \hyperlink{bitmfile_8h_a0428171499a4ab7aebc2bf058ae337df}{UWORD} svcolors[ \hyperlink{amiconf_8h_a551015331d3f91ae1ca3cb425e24e5ea}{AMII\_MAXCOLORS} ];
74     \textcolor{keyword}{static} \textcolor{keywordtype}{int} once = 0;
75     scrn = \hyperlink{winext_8h_ad92207d95deab9f96588451c7ed34419}{HackScreen};
76 
77     \textcolor{keywordflow}{if}( !once )
78     \{
79         \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
80         \{
81             \hyperlink{colorwin_8c_ae1405181d537e52ac2e7f7998aca0c90}{Col\_NewWindowStructure1}.Width += 300;
82             \hyperlink{colorwin_8c_ae1405181d537e52ac2e7f7998aca0c90}{Col\_NewWindowStructure1}.Height += 20;
83             \hyperlink{colorwin_8c_ae1405181d537e52ac2e7f7998aca0c90}{Col\_NewWindowStructure1}.LeftEdge -= 150;
84             \hyperlink{colorwin_8c_a16203e99df17e41a95652eb2f1bf4fcc}{Col\_BluePen}.Width += 300;
85             \hyperlink{colorwin_8c_aa6c4fb052b19fc770d28bfd1b248a25e}{Col\_RedPen}.Width += 300;
86             \hyperlink{colorwin_8c_a005b7d9317bb8c0a0b044f8f3924acb7}{Col\_GreenPen}.Width += 300;
87             \hyperlink{colorwin_8c_a22ab65608290c12900959e71039d3485}{Col\_Cancel}.LeftEdge += 300;
88             \hyperlink{colorwin_8c_ab815dee1d7283dbb1b231460ac6374c5}{Col\_Okay}.LeftEdge += 150;
89             \hyperlink{colorwin_8c_a22ab65608290c12900959e71039d3485}{Col\_Cancel}.TopEdge += 20;
90             \hyperlink{colorwin_8c_a8e498afd53dcc9d53246ed1a343461e1}{Col\_Save}.TopEdge += 20;
91             \hyperlink{colorwin_8c_ab815dee1d7283dbb1b231460ac6374c5}{Col\_Okay}.TopEdge += 20;
92         \}
93         \hyperlink{winproto_8h_aaa6575d9ac823d93fcc4176f3b1341c3}{SetBorder}( &\hyperlink{colorwin_8c_ab815dee1d7283dbb1b231460ac6374c5}{Col\_Okay} );
94         \hyperlink{winproto_8h_aaa6575d9ac823d93fcc4176f3b1341c3}{SetBorder}( &\hyperlink{colorwin_8c_a22ab65608290c12900959e71039d3485}{Col\_Cancel} );
95         \hyperlink{winproto_8h_aaa6575d9ac823d93fcc4176f3b1341c3}{SetBorder}( &\hyperlink{colorwin_8c_a8e498afd53dcc9d53246ed1a343461e1}{Col\_Save} );
96         once = 1;
97     \}
98 
99     bxylen = \hyperlink{colorwin_8c_ae1405181d537e52ac2e7f7998aca0c90}{Col\_NewWindowStructure1}.Height -
100                 ( \hyperlink{colorwin_8c_a16203e99df17e41a95652eb2f1bf4fcc}{Col\_BluePen}.TopEdge + \hyperlink{colorwin_8c_a16203e99df17e41a95652eb2f1bf4fcc}{Col\_BluePen}.Height + 6 );
101     bxxlen = \hyperlink{colorwin_8c_a16203e99df17e41a95652eb2f1bf4fcc}{Col\_BluePen}.Width;
102     bxorx = \hyperlink{colorwin_8c_a16203e99df17e41a95652eb2f1bf4fcc}{Col\_BluePen}.LeftEdge;
103     bxory = \hyperlink{colorwin_8c_a16203e99df17e41a95652eb2f1bf4fcc}{Col\_BluePen}.TopEdge + \hyperlink{colorwin_8c_a16203e99df17e41a95652eb2f1bf4fcc}{Col\_BluePen}.Height + 2;
104 
105     \textcolor{comment}{/* Save the current colors */}
106     \textcolor{keywordflow}{for}( i = 0; i < \hyperlink{winext_8h_ae3cfaa8053fd2f089c9fe1ba90289e98}{amii\_numcolors}; ++i )
107         svcolors[ i ] = colors[ i ] = GetRGB4( scrn->ViewPort.ColorMap, i );
108 
109     \hyperlink{colorwin_8c_ae1405181d537e52ac2e7f7998aca0c90}{Col\_NewWindowStructure1}.Screen = scrn;
110 \textcolor{preprocessor}{#ifdef  INTUI\_NEW\_LOOK}
111     \textcolor{keywordflow}{if}( IntuitionBase->LibNode.lib\_Version >= 37 )
112     \{
113         ((\textcolor{keyword}{struct }PropInfo *)\hyperlink{colorwin_8c_a16203e99df17e41a95652eb2f1bf4fcc}{Col\_BluePen}.SpecialInfo)->Flags |= PROPNEWLOOK;
114         ((\textcolor{keyword}{struct }PropInfo *)\hyperlink{colorwin_8c_aa6c4fb052b19fc770d28bfd1b248a25e}{Col\_RedPen}.SpecialInfo)->Flags |=  PROPNEWLOOK;
115         ((\textcolor{keyword}{struct }PropInfo *)\hyperlink{colorwin_8c_a005b7d9317bb8c0a0b044f8f3924acb7}{Col\_GreenPen}.SpecialInfo)->Flags |= PROPNEWLOOK;
116     \}
117 \textcolor{preprocessor}{#endif}
118     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} || \hyperlink{windefs_8h_adf1601afd1e2d6555110cd79bbbf4705}{WINVERS\_AMII} )
119     \{
120 \textcolor{preprocessor}{#ifdef  INTUI\_NEW\_LOOK}
121         \hyperlink{colorwin_8c_ae1405181d537e52ac2e7f7998aca0c90}{Col\_NewWindowStructure1}.Extension = \hyperlink{winext_8h_af89b1b4ca5e09b3b019caabfbf2243cd}{wintags};
122         \hyperlink{colorwin_8c_ae1405181d537e52ac2e7f7998aca0c90}{Col\_NewWindowStructure1}.Flags |= WFLG\_NW\_EXTENDED;
123 \textcolor{preprocessor}{# ifdef \_\_GNUC\_\_}
124         \hyperlink{winext_8h_a6ff9485e071d0a750346503394100a89}{fillhook}.h\_Entry = (\textcolor{keywordtype}{void} *)&\hyperlink{winext_8h_a9e524533351c8e043ccc43941ad1055f}{LayerFillHook};
125 \textcolor{preprocessor}{# else}
126         \hyperlink{winext_8h_a6ff9485e071d0a750346503394100a89}{fillhook}.h\_Entry = (\hyperlink{def__os2_8h_af632da489ebc3708ec3ab6791ee53fa4}{ULONG}(*)())\hyperlink{winext_8h_a9e524533351c8e043ccc43941ad1055f}{LayerFillHook};
127 \textcolor{preprocessor}{# endif}
128         \hyperlink{winext_8h_a6ff9485e071d0a750346503394100a89}{fillhook}.h\_Data = (\textcolor{keywordtype}{void} *)-2;
129         \hyperlink{winext_8h_a6ff9485e071d0a750346503394100a89}{fillhook}.h\_SubEntry = 0;
130 \textcolor{preprocessor}{#endif}
131     \}
132 
133     nw = OpenWindow( (\textcolor{keywordtype}{void} *)&\hyperlink{colorwin_8c_ae1405181d537e52ac2e7f7998aca0c90}{Col\_NewWindowStructure1} );
134 
135     \textcolor{keywordflow}{if}( nw == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
136     \{
137     DisplayBeep( \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} );
138     \textcolor{keywordflow}{return};
139     \}
140 
141     PrintIText( nw->RPort, &\hyperlink{colorwin_8c_a2c00b357234922029432053b86cefff7}{Col\_IntuiTextList1}, 0, 0 );
142 
143     \hyperlink{winreq_8c_a6d1201141039ce25fd7bc323639b7507}{ClearCol}( nw );
144     \hyperlink{winreq_8c_aab86548f4b4be239a38c53e5bb10302a}{DrawCol}( nw, curcol, colors );
145     \textcolor{keywordflow}{while}( !done )
146     \{
147     WaitPort( nw->UserPort );
148 
149     \textcolor{keywordflow}{while}( imsg = (\textcolor{keyword}{struct} IntuiMessage * )GetMsg( nw->UserPort ) )
150     \{
151         gd = (\textcolor{keyword}{struct }Gadget *)imsg->IAddress;
152         code = imsg->Code;
153         \textcolor{keyword}{class} = imsg->Class;
154         qual = imsg->Qualifier;
155         msx = imsg->MouseX;
156         msy = imsg->MouseY;
157 
158         ReplyMsg( (\textcolor{keyword}{struct} Message *)imsg );
159 
160         \textcolor{keywordflow}{switch}( \textcolor{keyword}{class} )
161         \{
162         \textcolor{keywordflow}{case} VANILLAKEY:
163         \textcolor{keywordflow}{if}( code == \textcolor{charliteral}{'v'} && qual == AMIGALEFT )
164             \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} = done = 1;
165         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( code == \textcolor{charliteral}{'b'} && qual == AMIGALEFT )
166             \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} = 0, done = 1;
167         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( code == \textcolor{charliteral}{'o'} || code == \textcolor{charliteral}{'O'} )
168             \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} = done = 1;
169         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( code == \textcolor{charliteral}{'c'} || code == \textcolor{charliteral}{'C'} )
170             \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} = 0, done = 1;
171         \textcolor{keywordflow}{break};
172 
173         \textcolor{keywordflow}{case} CLOSEWINDOW:
174         done = 1;
175         \textcolor{keywordflow}{break};
176 
177         \textcolor{keywordflow}{case} GADGETUP:
178         drag = 0;
179         \textcolor{keywordflow}{if}( gd->GadgetID == \hyperlink{winreq_8c_a76d331061bccaf012df3e26894ef4348}{GADREDPEN} ||
180                     gd->GadgetID == \hyperlink{winreq_8c_aa33cf60e4cdbcb694ee95a81f4c5d862}{GADBLUEPEN} ||
181                     gd->GadgetID == \hyperlink{winreq_8c_a095a4b2b6109d27802e763c76d1d7f48}{GADGREENPEN} )
182         \{
183             pip = (\textcolor{keyword}{struct }PropInfo *)gd->SpecialInfo;
184             aidx = pip->HorizPot / (MAXPOT/15);
185             \textcolor{keywordflow}{if}( gd->GadgetID == \hyperlink{winreq_8c_a76d331061bccaf012df3e26894ef4348}{GADREDPEN} )
186             \{
187             colors[ curcol ] =
188                 ( colors[ curcol ] & ~0xf00 ) | (aidx << 8);
189             LoadRGB4( &scrn->ViewPort, colors, amii\_numcolors );
190             \}
191             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( gd->GadgetID == \hyperlink{winreq_8c_aa33cf60e4cdbcb694ee95a81f4c5d862}{GADBLUEPEN} )
192             \{
193             colors[ curcol ] =
194                 ( colors[ curcol ] & ~0xf ) | aidx;
195             LoadRGB4( &scrn->ViewPort, colors, amii\_numcolors );
196             \}
197             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( gd->GadgetID == \hyperlink{winreq_8c_a095a4b2b6109d27802e763c76d1d7f48}{GADGREENPEN} )
198             \{
199             colors[ curcol ] = ( colors[ curcol ] & ~0x0f0 ) | (aidx << 4);
200             LoadRGB4( &scrn->ViewPort, colors, amii\_numcolors );
201             \}
202             \hyperlink{winreq_8c_a11c44eb0694ea5e51081e54d8df22cd2}{DispCol}( nw, curcol, colors );
203         \}
204         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( gd->GadgetID == \hyperlink{winreq_8c_aa063aa3287f28db151f7d92b6cf8d989}{GADCOLOKAY} )
205         \{
206             done = 1;
207             \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} = 1;
208         \}
209         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( gd->GadgetID == \hyperlink{winreq_8c_a7172d4fe1c4b1b1d9f913dc52266fc2d}{GADCOLSAVE} )
210         \{
211             FILE *\hyperlink{tile2img_8c_aa065f30aa9f5f9a42132c82c787ee70b}{fp}, *nfp;
212             \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[ 300 ], nname[ 300 ], oname[ 300 ];
213             \textcolor{keywordtype}{int} once = 0;
214 
215             fp = fopen( configfile, \textcolor{stringliteral}{"r"} );
216             \textcolor{keywordflow}{if}( !fp )
217             \{
218             pline( \textcolor{stringliteral}{"can't find NetHack.cnf"} );
219             \textcolor{keywordflow}{break};
220             \}
221 
222             strcpy( oname, \hyperlink{winreq_8c_ac27f2c6cf41fe0cd9d8e47c6e23e4c0a}{dirname}( (\textcolor{keywordtype}{char} *)configfile ) );
223             \textcolor{keywordflow}{if}( oname[ strlen(oname)-1 ] != \textcolor{charliteral}{':'} )
224             \{
225             sprintf( nname, \textcolor{stringliteral}{"%s/New\_NetHack.cnf"}, oname );
226             strcat( oname, \textcolor{stringliteral}{"/"} );
227             strcat( oname, \textcolor{stringliteral}{"Old\_NetHack.cnf"} );
228             \}
229             \textcolor{keywordflow}{else}
230             \{
231             sprintf( nname, \textcolor{stringliteral}{"%sNew\_NetHack.cnf"}, oname );
232             strcat( oname, \textcolor{stringliteral}{"Old\_NetHack.cnf"} );
233             \}
234 
235             nfp = fopen( nname, \textcolor{stringliteral}{"w"} );
236             \textcolor{keywordflow}{if}( !nfp )
237             \{
238             pline( \textcolor{stringliteral}{"can't write to New\_NetHack.cnf"} );
239             fclose( fp );
240             \textcolor{keywordflow}{break};
241             \}
242             \textcolor{keywordflow}{while}( fgets( buf, \textcolor{keyword}{sizeof}( buf ), fp ) )
243             \{
244             \textcolor{keywordflow}{if}( strncmp( buf, \textcolor{stringliteral}{"PENS="}, 5 ) == 0 )
245             \{
246                 once = 1;
247                 fputs( \textcolor{stringliteral}{"PENS="}, nfp );
248                 \textcolor{keywordflow}{for}( i = 0; i < \hyperlink{winext_8h_ae3cfaa8053fd2f089c9fe1ba90289e98}{amii\_numcolors}; ++i )
249                 \{
250                 fprintf( nfp, \textcolor{stringliteral}{"%03x"}, colors[i] );
251                 \textcolor{keywordflow}{if}(( i + 1 ) < amii\_numcolors)
252                     putc( \textcolor{charliteral}{'/'}, nfp );
253                 \}
254                 putc( \textcolor{charliteral}{'\(\backslash\)n'}, nfp );
255             \}
256             \textcolor{keywordflow}{else}
257             \{
258                 fputs( buf, nfp );
259             \}
260             \}
261 
262             \textcolor{comment}{/* If none in the file yet, now write it */}
263             \textcolor{keywordflow}{if}( !once )
264             \{
265             fputs( \textcolor{stringliteral}{"PENS="}, nfp );
266             \textcolor{keywordflow}{for}( i = 0; i < \hyperlink{winext_8h_ae3cfaa8053fd2f089c9fe1ba90289e98}{amii\_numcolors}; ++i )
267             \{
268                 fprintf( nfp, \textcolor{stringliteral}{"%03x"}, colors[i] );
269                 \textcolor{keywordflow}{if}(( i + 1 ) < amii\_numcolors)
270                 putc( \textcolor{charliteral}{','}, nfp );
271             \}
272                 putc( \textcolor{charliteral}{'\(\backslash\)n'}, nfp );
273             \}
274             fclose( fp );
275             fclose( nfp );
276             \hyperlink{wceconf_8h_aaa6f9697fa5339b751a4394678403892}{unlink}( oname );
277             \textcolor{keywordflow}{if}( \hyperlink{winreq_8c_a6e11e88b3d9d387b9a008c79a3b8fb0c}{filecopy}( (\textcolor{keywordtype}{char} *)configfile, oname ) == 0 )
278             \textcolor{keywordflow}{if}( \hyperlink{winreq_8c_a6e11e88b3d9d387b9a008c79a3b8fb0c}{filecopy}( nname, (\textcolor{keywordtype}{char} *)configfile ) == 0 )
279                 \hyperlink{wceconf_8h_aaa6f9697fa5339b751a4394678403892}{unlink}( nname );
280             done = 1;
281             \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} = 1;
282         \}
283         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( gd->GadgetID == \hyperlink{winreq_8c_aa4be93b3b6299698f4909de039117dae}{GADCOLCANCEL} )
284         \{
285             done = 1;
286             \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} = 0;
287         \}
288         \textcolor{keywordflow}{break};
289 
290         \textcolor{keywordflow}{case} GADGETDOWN:
291         drag = 1;
292         dgad = gd;
293         \textcolor{keywordflow}{break};
294 
295         \textcolor{keywordflow}{case} MOUSEMOVE:
296         \textcolor{keywordflow}{if}( !drag )
297             \textcolor{keywordflow}{break};
298         pip = (\textcolor{keyword}{struct }PropInfo *)dgad->SpecialInfo;
299         aidx = pip->HorizPot / (MAXPOT/15);
300         \textcolor{keywordflow}{if}( dgad->GadgetID == \hyperlink{winreq_8c_a76d331061bccaf012df3e26894ef4348}{GADREDPEN} )
301         \{
302             colors[ curcol ] =
303                 ( colors[ curcol ] & ~0xf00 ) | (aidx << 8);
304             LoadRGB4( &scrn->ViewPort, colors, amii\_numcolors );
305         \}
306         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( dgad->GadgetID == \hyperlink{winreq_8c_aa33cf60e4cdbcb694ee95a81f4c5d862}{GADBLUEPEN} )
307         \{
308             colors[ curcol ] = ( colors[ curcol ] & ~0xf ) | aidx;
309             LoadRGB4( &scrn->ViewPort, colors, amii\_numcolors );
310         \}
311         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( dgad->GadgetID == \hyperlink{winreq_8c_a095a4b2b6109d27802e763c76d1d7f48}{GADGREENPEN} )
312         \{
313             colors[ curcol ] =
314                 ( colors[ curcol ] & ~0x0f0 ) | (aidx << 4);
315             LoadRGB4( &scrn->ViewPort, colors, amii\_numcolors );
316         \}
317         \hyperlink{winreq_8c_a11c44eb0694ea5e51081e54d8df22cd2}{DispCol}( nw, curcol, colors );
318         \textcolor{keywordflow}{break};
319 
320         \textcolor{keywordflow}{case} MOUSEBUTTONS:
321         \textcolor{keywordflow}{if}( code == SELECTDOWN )
322         \{
323             \textcolor{keywordflow}{if}( msy > bxory && msy < bxory + bxylen - 1 &&
324                 msx > bxorx && msx < bxorx + bxxlen - 1 )
325             \{
326             curcol = ( msx - bxorx )/(bxxlen / amii\_numcolors);
327             \textcolor{keywordflow}{if}( curcol >= 0 && curcol < amii\_numcolors )
328             \hyperlink{winreq_8c_aab86548f4b4be239a38c53e5bb10302a}{DrawCol}( nw, curcol, colors );
329             \}
330         \}
331         \textcolor{keywordflow}{break};
332         \}
333     \}
334     \}
335 
336     \textcolor{keywordflow}{if}( \hyperlink{mkmaze_8c_a1f4a6bd3eb1c632fadaf884b976842a8}{okay} )
337     \{
338     \textcolor{keywordflow}{for}( i = 0; i < ( \hyperlink{winext_8h_ae3cfaa8053fd2f089c9fe1ba90289e98}{amii\_numcolors} ); ++i )
339         \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.amii\_curmap[ i ] = colors[ i ];
340     LoadRGB4( &scrn->ViewPort, \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.amii\_curmap, amii\_numcolors );
341     \}
342     \textcolor{keywordflow}{else}
343     LoadRGB4( &scrn->ViewPort, svcolors, amii\_numcolors );
344     CloseWindow( nw );
345 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a011cab3eb1bd78d60817aa2d9cc1ee57}{\index{winproto.\+h@{winproto.\+h}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!winproto.\+h@{winproto.\+h}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf amii\+\_\+add\+\_\+menu}}]{, }
\item[{({\bf winid}, int, {\bf const} {\bf anything} $\ast$, {\bf C\+H\+A\+R\+\_\+\+P}, {\bf C\+H\+A\+R\+\_\+\+P}, int, {\bf const} char $\ast$, {\bf B\+O\+O\+L\+E\+A\+N\+\_\+\+P})}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a011cab3eb1bd78d60817aa2d9cc1ee57}
\hypertarget{winproto_8h_a3dd266d4ff629b4065bfbca2d52b4461}{\index{winproto.\+h@{winproto.\+h}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!winproto.\+h@{winproto.\+h}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf amii\+\_\+end\+\_\+menu}}]{, }
\item[{({\bf winid}, {\bf const} char $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a3dd266d4ff629b4065bfbca2d52b4461}
\hypertarget{winproto_8h_a21c78ad3e4eef4d3f0e2e9f7db1c1f55}{\index{winproto.\+h@{winproto.\+h}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!winproto.\+h@{winproto.\+h}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}int F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf amii\+\_\+select\+\_\+menu}}]{, }
\item[{({\bf winid}, int, {\bf menu\+\_\+item} $\ast$$\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a21c78ad3e4eef4d3f0e2e9f7db1c1f55}
\hypertarget{winproto_8h_a74e68fe571f43e494e70d9616e4961c3}{\index{winproto.\+h@{winproto.\+h}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!winproto.\+h@{winproto.\+h}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{amii\+\_\+outrip}]{, }
\item[{({\bf winid} tmpwin, int how)}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a74e68fe571f43e494e70d9616e4961c3}
\hypertarget{winproto_8h_a790ffd3ec24be06476653119a754050b}{\index{winproto.\+h@{winproto.\+h}!filecopy@{filecopy}}
\index{filecopy@{filecopy}!winproto.\+h@{winproto.\+h}}
\subsubsection[{filecopy}]{\setlength{\rightskip}{0pt plus 5cm}int filecopy (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{from, }
\item[{char $\ast$}]{to}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a790ffd3ec24be06476653119a754050b}


Definition at line 645 of file winreq.\+c.



References alloc(), buf, and free().



Referenced by Edit\+Color().


\begin{DoxyCode}
647 \{
648     \textcolor{keywordtype}{char} *\hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf};
649     \textcolor{keywordtype}{int} i = 0;
650 
651     buf = (\textcolor{keywordtype}{char} *)\hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}( strlen(to) + strlen(from) + 20 );
652     \textcolor{keywordflow}{if}( buf )
653     \{
654         sprintf( buf, \textcolor{stringliteral}{"c:copy \(\backslash\)"%s\(\backslash\)" \(\backslash\)"%s\(\backslash\)" clone"}, from, to );
655 
656         \textcolor{comment}{/* Check SysBase instead?  Shouldn't matter  */}
657 \textcolor{preprocessor}{#ifdef  INTUI\_NEW\_LOOK}
658     \textcolor{keywordflow}{if}( IntuitionBase->LibNode.lib\_Version >= 37 )
659         i = System( buf, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} );
660     \textcolor{keywordflow}{else}
661 \textcolor{preprocessor}{#endif}
662         Execute( buf, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} );
663         \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}( buf );
664     \}
665     \textcolor{keywordflow}{else}
666     \{
667         \textcolor{keywordflow}{return}( -1 );
668     \}
669     \textcolor{keywordflow}{return}( i );
670 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a4d4ea82c540cd06c8a9808a448599df9}{\index{winproto.\+h@{winproto.\+h}!Find\+Line@{Find\+Line}}
\index{Find\+Line@{Find\+Line}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Find\+Line}]{\setlength{\rightskip}{0pt plus 5cm}long Find\+Line (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{, }
\item[{int}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a4d4ea82c540cd06c8a9808a448599df9}


Definition at line 1204 of file winmenu.\+c.



References amii\+\_\+wins, amii\+\_\+\+Win\+Desc\+::cols, amii\+\_\+\+Win\+Desc\+::data, amii\+\_\+\+Win\+Desc\+::maxrow, panic(), pictdata, S\+O\+F\+F, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+E\+R\+R, W\+I\+N\+\_\+\+I\+N\+V\+E\+N, winpanicstr, W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V, and P\+D\+A\+T\+::xsize.



Referenced by Display\+Data().


\begin{DoxyCode}
1207 \{
1208     \textcolor{keywordtype}{int} txwd;
1209     \textcolor{keyword}{register} \textcolor{keywordtype}{char} *t;
1210     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
1211     \textcolor{keyword}{register} \textcolor{keyword}{struct }Window *w;
1212     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i, disprow, len;
1213     \textcolor{keywordtype}{int} col = -1;
1214 
1215     \textcolor{keywordflow}{if}( win == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} || !(cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[win]) || !( w = cw->
      \hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} ) )
1216     \{
1217     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}( \hyperlink{winext_8h_a4264157ee8930111caf21b62c212e08c}{winpanicstr}, win, \textcolor{stringliteral}{"No Window in FindLine"} );
1218     \}
1219     txwd = w->RPort->TxWidth;
1220     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
1221     \{
1222     \textcolor{keywordflow}{if}( win == \hyperlink{decl_8h_aabd3637304d093f7077c788661a0a5fd}{WIN\_INVEN} )
1223     \{
1224         cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft -
1225             w->BorderRight - 4 - \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_a957fade03cbfb4ce4de9df4e09be7fc7}{xsize} - 3) / txwd;
1226     \}
1227     \textcolor{keywordflow}{else}
1228         cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft - w->BorderRight - 4 ) / txwd;
1229     \}
1230     \textcolor{keywordflow}{else}
1231     \{
1232     cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} = ( w->Width - w->BorderLeft - w->BorderRight - 4 ) / txwd;
1233     \}
1234 
1235     disprow = 0;
1236     \textcolor{keywordflow}{for}( col = i = 0; line > disprow && i < cw->\hyperlink{structamii__WinDesc_a1ca7af4b595bf7bb077ed78546548670}{maxrow}; ++i )
1237     \{
1238     t = cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[ i ] + \hyperlink{windefs_8h_a18a002ccef5ceab145570860644dfc74}{SOFF};
1239     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a1be96ba5842aef93cb36e73173277ad6}{data}[i][1] >= 0 )
1240     \{
1241         ++disprow;
1242         col = 0;
1243     \}
1244 
1245     \textcolor{keywordflow}{while}( *t )
1246     \{
1247         len = strlen( t );
1248         \textcolor{keywordflow}{if}( col + len > cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} )
1249         len = cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} - col;
1250         \textcolor{keywordflow}{while}( len > 0 )
1251         \{
1252             \textcolor{keywordflow}{if}( !t[len] || t[len] == \textcolor{charliteral}{' '} )
1253             \textcolor{keywordflow}{break};
1254             --len;
1255         \}
1256         \textcolor{keywordflow}{if}( len == 0 ) \{
1257         \textcolor{keywordflow}{while} ( *t && *t != \textcolor{charliteral}{' '}) \{
1258             t++; col++;
1259         \}
1260         \} \textcolor{keywordflow}{else} \{
1261         t += len;
1262         col += len;
1263         \}
1264         \textcolor{keywordflow}{if}( *t )
1265         \{
1266         \textcolor{keywordflow}{while}( *t == \textcolor{charliteral}{' '} )
1267             ++t;
1268         col = 0;
1269         ++disprow;
1270         \}
1271     \}
1272     \}
1273     \textcolor{keywordflow}{return}( i );
1274 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a5ca4d00a20e9469642bb87e62cdf4be2}{\index{winproto.\+h@{winproto.\+h}!flush\+\_\+glyph\+\_\+buffer@{flush\+\_\+glyph\+\_\+buffer}}
\index{flush\+\_\+glyph\+\_\+buffer@{flush\+\_\+glyph\+\_\+buffer}!winproto.\+h@{winproto.\+h}}
\subsubsection[{flush\+\_\+glyph\+\_\+buffer}]{\setlength{\rightskip}{0pt plus 5cm}void flush\+\_\+glyph\+\_\+buffer (
\begin{DoxyParamCaption}
\item[{struct Window $\ast$}]{w}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a5ca4d00a20e9469642bb87e62cdf4be2}


Definition at line 484 of file winchar.\+c.



References amii\+\_\+flush\+\_\+glyph\+\_\+buffer(), amiv\+\_\+flush\+\_\+glyph\+\_\+buffer(), and W\+I\+N\+V\+E\+R\+S\+\_\+\+A\+M\+I\+V.



Referenced by amii\+\_\+cliparound(), amii\+\_\+curs(), amii\+\_\+display\+\_\+nhwindow(), amii\+\_\+wait\+\_\+synch(), and Edit\+Clipping().


\begin{DoxyCode}
486 \{
487     \textcolor{keywordflow}{if}( \hyperlink{windefs_8h_aa0b90aaeb74b2488a95f0902cef09cbf}{WINVERS\_AMIV} )
488     \hyperlink{winchar_8c_a2bbd4f73bca99f6855764467ea83a3d0}{amiv\_flush\_glyph\_buffer} ( vw );
489     \textcolor{keywordflow}{else}
490     \hyperlink{winchar_8c_a1b2926265ddfa6efb6c368906efa69e7}{amii\_flush\_glyph\_buffer} ( vw );
491 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a918f50a64d9c2b87014897c5ec05ffc1}{\index{winproto.\+h@{winproto.\+h}!flush\+I\+D\+C\+M\+P@{flush\+I\+D\+C\+M\+P}}
\index{flush\+I\+D\+C\+M\+P@{flush\+I\+D\+C\+M\+P}!winproto.\+h@{winproto.\+h}}
\subsubsection[{flush\+I\+D\+C\+M\+P}]{\setlength{\rightskip}{0pt plus 5cm}void flush\+I\+D\+C\+M\+P (
\begin{DoxyParamCaption}
\item[{struct Msg\+Port $\ast$}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a918f50a64d9c2b87014897c5ec05ffc1}


Definition at line 2445 of file winfuncs.\+c.



Referenced by outmore().


\begin{DoxyCode}
2447 \{
2448     \textcolor{keyword}{struct }Message *msg;
2449     \textcolor{keywordflow}{while}( msg = GetMsg( port ) )
2450         ReplyMsg( msg );
2451 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{\index{winproto.\+h@{winproto.\+h}!free@{free}}
\index{free@{free}!winproto.\+h@{winproto.\+h}}
\subsubsection[{free}]{\setlength{\rightskip}{0pt plus 5cm}void free (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{q}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a4bbec68d324de17b99fecede64b383ba}


Referenced by add\+\_\+line(), add\+\_\+mon\+\_\+to\+\_\+reg(), add\+\_\+rect\+\_\+to\+\_\+reg(), add\+\_\+region(), amii\+\_\+destroy\+\_\+nhwindow(), amii\+\_\+putstr(), amii\+\_\+start\+\_\+menu(), append\+\_\+text\+\_\+buffer(), bitmap\+\_\+to\+\_\+img(), choose\+\_\+classes\+\_\+menu(), clear\+\_\+id\+\_\+mapping(), clear\+\_\+regions(), convert(), create\+\_\+engraving(), delete\+\_\+dirty\+\_\+rect(), depack\+\_\+img(), destroy\+\_\+fancy\+\_\+status(), destroy\+\_\+map\+\_\+window(), destroy\+\_\+menu\+\_\+window(), destroy\+\_\+message\+\_\+window(), destroy\+\_\+status\+\_\+window(), destroy\+\_\+text\+\_\+window(), doset(), dospellmenu(), fclose\+\_\+gif\+\_\+file(), fclose\+\_\+ppm\+\_\+file(), filecopy(), fixup\+\_\+special(), free\+\_\+menu(), free\+\_\+region(), free\+\_\+saved\+\_\+games(), free\+\_\+text\+\_\+buffer(), freedynamicdata(), Gem\+\_\+start\+\_\+menu(), Gem\+\_\+yn\+\_\+function(), gnome\+\_\+display\+\_\+file(), gnome\+\_\+player\+\_\+selection(), half\+\_\+img(), help\+\_\+menu(), in\+\_\+or\+\_\+out\+\_\+menu(), init\+\_\+extended\+\_\+commands\+\_\+popup(), init\+\_\+tiles(), main(), Main\+Wnd\+Proc(), make\+\_\+menu(), Map\+Wnd\+Proc(), mar\+\_\+destroy\+\_\+nhwindow(), menu\+\_\+loot(), Menu\+Wnd\+Proc(), mkmap(), mswin\+\_\+display\+\_\+splash\+\_\+window(), mswin\+\_\+free\+\_\+text\+\_\+buffer(), mswin\+\_\+render\+\_\+text(), mswin\+\_\+yn\+\_\+function(), mv\+\_\+bubble(), My\+Free\+Bit\+Map(), new\+\_\+dirty\+\_\+rect(), next\+\_\+opt(), nhcmdlayout\+\_\+destroy(), nhcmdset\+\_\+destroy(), N\+H\+Command\+Wnd\+Proc(), N\+H\+Message\+Wnd\+Proc(), N\+H\+R\+I\+P\+Wnd\+Proc(), N\+H\+Text\+Wnd\+Proc(), on\+M\+S\+N\+H\+Command(), parseoptions(), pickup(), prompt\+\_\+for\+\_\+player\+\_\+selection(), restdamage(), save\+\_\+oracles(), savedamage(), savelevchn(), savenames(), set\+\_\+circle\+\_\+buf(), set\+\_\+duplicate\+\_\+opt\+\_\+detection(), special\+\_\+handling(), Status\+Wnd\+Proc(), Text\+Wnd\+Proc(), tmp\+\_\+at(), unload\+\_\+qtlist(), unsetup\+\_\+waterlevel(), wc\+\_\+set\+\_\+font\+\_\+name(), wc\+\_\+set\+\_\+window\+\_\+colors(), Win\+Main(), X11\+\_\+display\+\_\+file(), X11\+\_\+display\+\_\+nhwindow(), X11\+\_\+player\+\_\+selection(), and yy\+\_\+flex\+\_\+free().

\hypertarget{winproto_8h_ab678d4f6f0bc71028253ad299999b95e}{\index{winproto.\+h@{winproto.\+h}!Free\+Image\+Files@{Free\+Image\+Files}}
\index{Free\+Image\+Files@{Free\+Image\+Files}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Free\+Image\+Files}]{\setlength{\rightskip}{0pt plus 5cm}void Free\+Image\+Files (
\begin{DoxyParamCaption}
\item[{char $\ast$$\ast$}]{, }
\item[{struct Bit\+Map $\ast$$\ast$}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ab678d4f6f0bc71028253ad299999b95e}


Definition at line 453 of file winchar.\+c.



References ifftimg, My\+Free\+Bit\+Map(), and tile.



Referenced by Free\+Tile\+Image\+Files(), and Read\+Image\+Files().


\begin{DoxyCode}
454 \{
455     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i;
456 
457     \textcolor{keywordflow}{for}( i = 0; filenames[i]; ++i )
458     \{
459     \textcolor{keywordflow}{if}( img[ i ] )
460         \hyperlink{winchar_8c_a826909fe5d305f7890c89e58753ec212}{MyFreeBitMap}( img[ i ] );
461     \}
462 
463     \textcolor{comment}{/* REALLY ugly hack alert! */}
464     \textcolor{keywordflow}{if}( \hyperlink{winchar_8c_a2dc2eddd592675f7a53c3de0084ab83b}{tile} && img==\hyperlink{winchar_8c_a59e1af99e18ff54c06c0a9a5d736fa0f}{ifftimg})
465     \hyperlink{winchar_8c_a826909fe5d305f7890c89e58753ec212}{MyFreeBitMap}( \hyperlink{winchar_8c_a2dc2eddd592675f7a53c3de0084ab83b}{tile} );
466 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a81a885084baad168d6f5acbb40bfd42c}{\index{winproto.\+h@{winproto.\+h}!Free\+New\+Window@{Free\+New\+Window}}
\index{Free\+New\+Window@{Free\+New\+Window}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Free\+New\+Window}]{\setlength{\rightskip}{0pt plus 5cm}void Free\+New\+Window (
\begin{DoxyParamCaption}
\item[{struct New\+Window $\ast$}]{win}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a81a885084baad168d6f5acbb40bfd42c}


Referenced by dismiss\+\_\+nhwindow().

\hypertarget{winproto_8h_a52004e01e897470f11cc048fc78f4649}{\index{winproto.\+h@{winproto.\+h}!Free\+Tile\+Image\+Files@{Free\+Tile\+Image\+Files}}
\index{Free\+Tile\+Image\+Files@{Free\+Tile\+Image\+Files}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Free\+Tile\+Image\+Files}]{\setlength{\rightskip}{0pt plus 5cm}void Free\+Tile\+Image\+Files (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a52004e01e897470f11cc048fc78f4649}


Definition at line 448 of file winchar.\+c.



References Free\+Image\+Files(), ifftimg, and tileimages.



Referenced by amii\+\_\+exit\+\_\+nhwindows().


\begin{DoxyCode}
448                     \{
449     \hyperlink{winchar_8c_ab678d4f6f0bc71028253ad299999b95e}{FreeImageFiles}(\hyperlink{winchar_8c_a0190588bb20fccf5d0c424f0d9a88c62}{tileimages},\hyperlink{winchar_8c_a59e1af99e18ff54c06c0a9a5d736fa0f}{ifftimg});
450 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ac9afe077a992b95425c7d8a549c4e5ba}{\index{winproto.\+h@{winproto.\+h}!getlind@{getlind}}
\index{getlind@{getlind}!winproto.\+h@{winproto.\+h}}
\subsubsection[{getlind}]{\setlength{\rightskip}{0pt plus 5cm}void getlind (
\begin{DoxyParamCaption}
\item[{{\bf const} char $\ast$}]{prompt, }
\item[{char $\ast$}]{bufp, }
\item[{{\bf const} char $\ast$}]{dflt}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ac9afe077a992b95425c7d8a549c4e5ba}
\hypertarget{winproto_8h_aa96d3ccb91f8e74506caca1d75112644}{\index{winproto.\+h@{winproto.\+h}!Glyph\+To\+Icon@{Glyph\+To\+Icon}}
\index{Glyph\+To\+Icon@{Glyph\+To\+Icon}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Glyph\+To\+Icon}]{\setlength{\rightskip}{0pt plus 5cm}int Glyph\+To\+Icon (
\begin{DoxyParamCaption}
\item[{int}]{glyph}
\end{DoxyParamCaption}
)}}\label{winproto_8h_aa96d3ccb91f8e74506caca1d75112644}


Definition at line 937 of file winchar.\+c.



References glyph2tile.



Referenced by amiv\+\_\+lprint\+\_\+glyph().


\begin{DoxyCode}
938 \{
939     \textcolor{keywordflow}{if}(glyph>10000)\textcolor{keywordflow}{return} glyph;
940     \textcolor{keywordflow}{return}( \hyperlink{sys_2wince_2mhmap_8c_a4d61aa736dae8287d97c3a68a3a917c5}{glyph2tile}[glyph] );
941 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a97e9b1fe8d4c010474637a654aad6566}{\index{winproto.\+h@{winproto.\+h}!kbhit@{kbhit}}
\index{kbhit@{kbhit}!winproto.\+h@{winproto.\+h}}
\subsubsection[{kbhit}]{\setlength{\rightskip}{0pt plus 5cm}int kbhit (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a97e9b1fe8d4c010474637a654aad6566}


Definition at line 544 of file amiwind.\+c.



References amii\+\_\+procs, amikbhit(), and windowprocs.


\begin{DoxyCode}
545 \{
546     \textcolor{keywordtype}{int} c;
547 \textcolor{preprocessor}{# ifdef TTY\_GRAPHICS}
548         \textcolor{comment}{/* a kludge to defuse the mess in allmain.c */}
549         \textcolor{comment}{/* I hope this is the right approach */}
550     \textcolor{keywordflow}{if}(\hyperlink{winprocs_8h_a166c17ce426a1c495296575938a60f9c}{windowprocs}.win\_init\_nhwindows==\hyperlink{amidos_8c_a15de23af499d6c155c1ba39cec0e1cb2}{amii\_procs}.win\_init\_nhwindows)\textcolor{keywordflow}{return} 0;
551 \textcolor{preprocessor}{# endif}
552     c = \hyperlink{winproto_8h_ac506d1c2744895972ab13c3b19d702c3}{amikbhit}();
553     \textcolor{keywordflow}{if}( c <= 0 )
554         \textcolor{keywordflow}{return}( 0 );
555     \textcolor{keywordflow}{return}( c );
556 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a72b5bc3695faa88e00240b100758f23a}{\index{winproto.\+h@{winproto.\+h}!kill\+\_\+nhwindows@{kill\+\_\+nhwindows}}
\index{kill\+\_\+nhwindows@{kill\+\_\+nhwindows}!winproto.\+h@{winproto.\+h}}
\subsubsection[{kill\+\_\+nhwindows}]{\setlength{\rightskip}{0pt plus 5cm}void kill\+\_\+nhwindows (
\begin{DoxyParamCaption}
\item[{int}]{all}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a72b5bc3695faa88e00240b100758f23a}


Definition at line 1799 of file winfuncs.\+c.



References amii\+\_\+destroy\+\_\+nhwindow(), amii\+\_\+wins, M\+A\+X\+W\+I\+N, N\+H\+W\+\_\+\+B\+A\+S\+E, and amii\+\_\+\+Win\+Desc\+::type.



Referenced by amii\+\_\+exit\+\_\+nhwindows().


\begin{DoxyCode}
1801 \{
1802     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i;
1803     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
1804 
1805     \textcolor{comment}{/* Foreach open window in all of amii\_wins[], CloseShWindow, free memory */}
1806 
1807     \textcolor{keywordflow}{for}( i = 0; i < \hyperlink{winami_8h_a0882b20213d1ebf14d860e611d06cf36}{MAXWIN}; ++i )
1808     \{
1809     \textcolor{keywordflow}{if}( (cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[ i ]) && (cw->\hyperlink{structamii__WinDesc_ab90130f7f09b474842877b2f71d708e0}{type} != \hyperlink{macwin_8h_ab575e634e51462bf534b7ee541cefc46}{NHW\_BASE} || all) )
1810     \{
1811         \hyperlink{winfuncs_8c_aa650954bd0e8c4a5ef3b283050cd646c}{amii\_destroy\_nhwindow}( i );
1812     \}
1813     \}
1814 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ab028c02ac00afc0c1d3c568ccad68869}{\index{winproto.\+h@{winproto.\+h}!malloc@{malloc}}
\index{malloc@{malloc}!winproto.\+h@{winproto.\+h}}
\subsubsection[{malloc}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ malloc (
\begin{DoxyParamCaption}
\item[{{\bf register} unsigned}]{size}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ab028c02ac00afc0c1d3c568ccad68869}


Referenced by alloc(), bitmap\+\_\+to\+\_\+img(), fopen\+\_\+xpm\+\_\+file(), m\+\_\+alloc(), main(), Main\+Wnd\+Proc(), Menu\+Wnd\+Proc(), mswin\+\_\+display\+\_\+splash\+\_\+window(), mswin\+\_\+init\+\_\+\+R\+I\+P\+\_\+window(), mswin\+\_\+init\+\_\+status\+\_\+window(), mswin\+\_\+init\+\_\+text\+\_\+buffer(), mswin\+\_\+init\+\_\+text\+\_\+window(), mswin\+\_\+menu\+\_\+window\+\_\+select\+\_\+menu(), nhcmdlayout\+\_\+create(), nhcmdset\+\_\+create(), on\+Create(), on\+M\+S\+N\+H\+Command(), Read\+Image\+Files(), and V\+D\+E\+C\+L().

\hypertarget{winproto_8h_a4fbda1b274fbd7f990be789cfbb8fd52}{\index{winproto.\+h@{winproto.\+h}!Open\+Sh\+Window@{Open\+Sh\+Window}}
\index{Open\+Sh\+Window@{Open\+Sh\+Window}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Open\+Sh\+Window}]{\setlength{\rightskip}{0pt plus 5cm}struct Window$\ast$ Open\+Sh\+Window (
\begin{DoxyParamCaption}
\item[{struct New\+Window $\ast$}]{nw}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a4fbda1b274fbd7f990be789cfbb8fd52}


Referenced by amii\+\_\+create\+\_\+nhwindow(), and Do\+Menu\+Scroll().

\hypertarget{winproto_8h_a55e9e9c33e29d3698d29ff252bf2aae8}{\index{winproto.\+h@{winproto.\+h}!outmore@{outmore}}
\index{outmore@{outmore}!winproto.\+h@{winproto.\+h}}
\subsubsection[{outmore}]{\setlength{\rightskip}{0pt plus 5cm}void outmore (
\begin{DoxyParamCaption}
\item[{struct {\bf amii\+\_\+\+Win\+Desc} $\ast$}]{cw}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a55e9e9c33e29d3698d29ff252bf2aae8}


Definition at line 338 of file winstr.\+c.



References amii\+\_\+cl\+\_\+end(), amii\+\_\+curs(), amii\+\_\+msgborder(), F\+L\+M\+A\+P\+\_\+\+S\+K\+I\+P, flush\+I\+D\+C\+M\+P(), Hack\+Port, W\+E\+V\+E\+N\+T\+::key, lastevent, scrollmsg, W\+E\+V\+E\+N\+T\+::type, W\+E\+V\+E\+N\+T\+::un, W\+E\+K\+E\+Y, amii\+\_\+\+Win\+Desc\+::win, W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E, and Window\+Getchar().



Referenced by amii\+\_\+display\+\_\+nhwindow(), amii\+\_\+putstr(), amii\+\_\+scrollmsg(), and outsubstr().


\begin{DoxyCode}
340 \{
341     \textcolor{keyword}{struct }Window *w = cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
342 
343     \textcolor{keywordflow}{if}((cw->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} & \hyperlink{winami_8h_a20db85ff854e288c5f3b7c380e6ceb91}{FLMAP\_SKIP}) == 0)
344     \{
345     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_a3b783f5f077454f156585be54b99746b}{scrollmsg} )
346     \{
347         \textcolor{keywordtype}{int} bottom;
348 
349         bottom = \hyperlink{winstr_8c_afd2be902c5244111f384679cbc6e938a}{amii\_msgborder}( w );
350 
351         ScrollRaster( w->RPort, 0, w->RPort->TxHeight,
352             w->BorderLeft, w->BorderTop+1,
353             w->Width - w->BorderRight-1,
354             w->Height - w->BorderBottom - 1 );
355         \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}( \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE}, 1, bottom ); \textcolor{comment}{/* -1 for inner border */}
356         Text( w->RPort, \textcolor{stringliteral}{"--more--"}, 8 );
357     \}
358     \textcolor{keywordflow}{else}
359         Text( w->RPort, \textcolor{stringliteral}{" --more--"}, 9 );
360 
361     \textcolor{comment}{/* Make sure there are no events in the queue */}
362     \hyperlink{winfuncs_8c_ae8d6b32a14e062f051d36de0fab26495}{flushIDCMP}( \hyperlink{winext_8h_a392c49118e04b9257df71fca005829e0}{HackPort} );
363 
364     \textcolor{comment}{/* Allow mouse clicks to clear --more-- */}
365     \hyperlink{winproto_8h_a173d2dc6a888352bb65b7cacd4576308}{WindowGetchar}();
366     \textcolor{keywordflow}{if}( \hyperlink{winext_8h_ad7aa01c8c967c217496fa16833727f6c}{lastevent}.\hyperlink{structWEVENT_a218bdffc41cff7b53f666a9a1f0fd714}{type} == \hyperlink{winami_8h_a947974ed96ae99c292b698854e310ebea04eab5e241ff2fdc5893f123379e58ca}{WEKEY} && \hyperlink{winext_8h_ad7aa01c8c967c217496fa16833727f6c}{lastevent}.\hyperlink{structWEVENT_aa1fde3395f49a17259c056ec58ffc1e9}{un}.\hyperlink{structWEVENT_a33aabbd5a0f5cb005e24df8ccc93bf67}{key} == \textcolor{stringliteral}{'\(\backslash\)33'} )
367         cw->\hyperlink{structamii__WinDesc_a4400afb6488c6a7b1f70f27ee0371963}{wflags} |= \hyperlink{winami_8h_a20db85ff854e288c5f3b7c380e6ceb91}{FLMAP\_SKIP};
368     \}
369     \textcolor{keywordflow}{if}( !\hyperlink{winext_8h_a3b783f5f077454f156585be54b99746b}{scrollmsg} )
370     \{
371     \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}( \hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE}, 1, 0 );
372     \hyperlink{winfuncs_8c_ace7ed7ac165d8e68bbc3df59a8ac5ec6}{amii\_cl\_end}( cw, cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} );
373     \}
374 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a93a76f6f311b1a6c5bf0b64a3904c462}{\index{winproto.\+h@{winproto.\+h}!outsubstr@{outsubstr}}
\index{outsubstr@{outsubstr}!winproto.\+h@{winproto.\+h}}
\subsubsection[{outsubstr}]{\setlength{\rightskip}{0pt plus 5cm}void outsubstr (
\begin{DoxyParamCaption}
\item[{struct {\bf amii\+\_\+\+Win\+Desc} $\ast$}]{cw, }
\item[{char $\ast$}]{str, }
\item[{int}]{len, }
\item[{int}]{fudge}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a93a76f6f311b1a6c5bf0b64a3904c462}


Definition at line 377 of file winstr.\+c.



References outmore(), scrollmsg, spaces, and amii\+\_\+\+Win\+Desc\+::win.



Referenced by amii\+\_\+putstr().


\begin{DoxyCode}
382 \{
383     \textcolor{keyword}{struct }Window *w = cw->\hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win};
384 
385     \textcolor{keywordflow}{if}( cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} )
386     \{
387     \textcolor{comment}{/* Check if this string and --more-- fit, if not,}
388 \textcolor{comment}{     * then put out --more-- and wait for a key.}
389 \textcolor{comment}{     */}
390     \textcolor{keywordflow}{if}( (len + fudge ) + cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} >= cw->\hyperlink{structamii__WinDesc_a8ef9da0197015f48920307f3692f2a54}{cols} )
391     \{
392         \textcolor{keywordflow}{if}( !\hyperlink{winext_8h_a3b783f5f077454f156585be54b99746b}{scrollmsg} )
393         \hyperlink{winstr_8c_a55e9e9c33e29d3698d29ff252bf2aae8}{outmore}( cw );
394     \}
395     \textcolor{keywordflow}{else}
396     \{
397         \textcolor{comment}{/* Otherwise, move and put out a blank separator */}
398         Text( w->RPort, \hyperlink{winext_8h_aa3ba0c07a0e95c967d350590b6aaef7a}{spaces}, 1 );
399         cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} += 1;
400     \}
401     \}
402 
403     Text(w->RPort,str,len);
404 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a168bbce4413e8e2551bf7ce24fc59506}{\index{winproto.\+h@{winproto.\+h}!port\+\_\+help@{port\+\_\+help}}
\index{port\+\_\+help@{port\+\_\+help}!winproto.\+h@{winproto.\+h}}
\subsubsection[{port\+\_\+help}]{\setlength{\rightskip}{0pt plus 5cm}void port\+\_\+help (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a168bbce4413e8e2551bf7ce24fc59506}


Definition at line 2555 of file macwin.\+c.



References display\+\_\+file, P\+O\+R\+T\+\_\+\+H\+E\+L\+P, and T\+R\+U\+E.



Referenced by dohelp().


\begin{DoxyCode}
2555              \{
2556     \hyperlink{winprocs_8h_a9a2d6fa35e52cd43166e411ec33926ef}{display\_file} (\hyperlink{amiconf_8h_adea5f27d2fa7b84c0d6458e64f551724}{PORT\_HELP}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
2557 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a97c825c2d0c70743706367f421c8aaa1}{\index{winproto.\+h@{winproto.\+h}!preserve\+\_\+icon@{preserve\+\_\+icon}}
\index{preserve\+\_\+icon@{preserve\+\_\+icon}!winproto.\+h@{winproto.\+h}}
\subsubsection[{preserve\+\_\+icon}]{\setlength{\rightskip}{0pt plus 5cm}void preserve\+\_\+icon (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a97c825c2d0c70743706367f421c8aaa1}
\hypertarget{winproto_8h_ade500df920f0504bb2bb7668cd0130fe}{\index{winproto.\+h@{winproto.\+h}!Random\+Window@{Random\+Window}}
\index{Random\+Window@{Random\+Window}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Random\+Window}]{\setlength{\rightskip}{0pt plus 5cm}void Random\+Window (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{name}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ade500df920f0504bb2bb7668cd0130fe}
\hypertarget{winproto_8h_a38dff02b63465e90aac84581f2076a40}{\index{winproto.\+h@{winproto.\+h}!Read\+Image\+Files@{Read\+Image\+Files}}
\index{Read\+Image\+Files@{Read\+Image\+Files}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Read\+Image\+Files}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Bit\+Map\+Header} Read\+Image\+Files (
\begin{DoxyParamCaption}
\item[{char $\ast$$\ast$}]{, }
\item[{struct Bit\+Map $\ast$$\ast$}]{, }
\item[{char $\ast$$\ast$}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a38dff02b63465e90aac84581f2076a40}


Definition at line 205 of file winchar.\+c.



References amii\+\_\+extraplanes, amii\+\_\+initmap, amiv\+\_\+init\+\_\+map, buf, Close, cmap, errno, Free\+Image\+Files(), Bit\+Map\+Header\+::h, I\+D\+\_\+\+B\+M\+A\+P, I\+D\+\_\+\+B\+M\+H\+D, I\+D\+\_\+\+C\+A\+M\+G, I\+D\+\_\+\+C\+M\+A\+P, I\+D\+\_\+\+P\+D\+A\+T, I\+D\+\_\+\+P\+L\+N\+E, I\+F\+F\+Parse\+Base, malloc(), My\+Alloc\+Bit\+Map(), Bit\+Map\+Header\+::n\+Planes, P\+D\+A\+T\+::nplanes, N\+U\+L\+L, pictdata, tile, Bit\+Map\+Header\+::w, P\+D\+A\+T\+::xsize, and P\+D\+A\+T\+::ysize.



Referenced by Read\+Tile\+Image\+Files().


\begin{DoxyCode}
206 \{
207     \hyperlink{structBitMapHeader}{BitMapHeader} *bmhd = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, bmhds;
208     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *\hyperlink{txt2iff_8c_a7320deca12e5c03a0bcea6f55bd37c43}{cmap};
209     \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \hyperlink{files_8c_ad65a8842cc674e3ddf69355898c0ecbf}{errno};
210     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i, j;
211     \textcolor{keyword}{struct }IFFHandle *iff;
212     \textcolor{keyword}{struct }StoredProperty *\hyperlink{structprop}{prop};
213 
214     \hyperlink{txt2iff_8c_af2bba7dce1b50891392273cdeca76353}{IFFParseBase} = OpenLibrary( \textcolor{stringliteral}{"iffparse.library"}, 0L );
215     \textcolor{keywordflow}{if}( !\hyperlink{txt2iff_8c_af2bba7dce1b50891392273cdeca76353}{IFFParseBase} )
216     \{
217     *errstrp = \textcolor{stringliteral}{"No iffparse.library"};
218     \textcolor{keywordflow}{return} bmhds;
219     \}
220 
221 \textcolor{comment}{/*}
222 \textcolor{comment}{    for( i = 0; filenames[i]; ++i )}
223 \textcolor{comment}{    memset( iffimg[i], 0, sizeof( struct BitMap ) );}
224 \textcolor{comment}{*/}
225     \textcolor{keywordflow}{for}( i = 0; filenames[i]; ++i )
226     \{
227     iff = AllocIFF();
228     \textcolor{keywordflow}{if}( !iff )
229     \{
230         \hyperlink{winchar_8c_ab678d4f6f0bc71028253ad299999b95e}{FreeImageFiles}(filenames, iffimg );
231         *errstrp = \textcolor{stringliteral}{"can't start IFF processing"};
232         \textcolor{keywordflow}{return} bmhds;
233     \}
234     iff->iff\_Stream = Open( filenames[i], MODE\_OLDFILE );
235     \textcolor{keywordflow}{if}( iff->iff\_Stream == 0 )
236     \{
237         \textcolor{keywordtype}{char} *\hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf} = \hyperlink{winproto_8h_ab028c02ac00afc0c1d3c568ccad68869}{malloc}(100+strlen(filenames[i]));
238         \hyperlink{winchar_8c_ab678d4f6f0bc71028253ad299999b95e}{FreeImageFiles}( filenames, iffimg );
239         sprintf(buf, \textcolor{stringliteral}{"Can't open %s: %s"}, filenames[i], strerror( errno ));
240         *errstrp = \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf};
241         \textcolor{keywordflow}{return} bmhds;
242     \}
243     InitIFFasDOS( iff );
244     OpenIFF( iff, IFFF\_READ );
245     PropChunk( iff, \hyperlink{winchar_8c_a77f5e837562d84543cd22f767a581c33}{ID\_BMAP}, \hyperlink{winchar_8c_abcd1dcd9c8074c20b650110c487ec826}{ID\_BMHD} );
246     PropChunk( iff, \hyperlink{winchar_8c_a77f5e837562d84543cd22f767a581c33}{ID\_BMAP}, \hyperlink{winchar_8c_adbfe39990b0b760a79f0192db7961bd8}{ID\_CMAP} );
247     PropChunk( iff, \hyperlink{winchar_8c_a77f5e837562d84543cd22f767a581c33}{ID\_BMAP}, \hyperlink{winchar_8c_a83e89c32c825101821f40b21289218a9}{ID\_CAMG} );
248     PropChunk( iff, \hyperlink{winchar_8c_a77f5e837562d84543cd22f767a581c33}{ID\_BMAP}, \hyperlink{winchar_8c_a70bc68c6e36e5d00879130c8d8ba3c3b}{ID\_PDAT} );
249     StopChunk( iff, \hyperlink{winchar_8c_a77f5e837562d84543cd22f767a581c33}{ID\_BMAP}, \hyperlink{winchar_8c_af25d25b688b21e610cab14b3774cc3fb}{ID\_PLNE} );
250     \textcolor{keywordflow}{if}( ( j = ParseIFF( iff, IFFPARSE\_SCAN ) ) != 0 )
251     \{
252         \textcolor{keywordtype}{char} *buf = \hyperlink{winproto_8h_ab028c02ac00afc0c1d3c568ccad68869}{malloc}(100);
253         \hyperlink{winchar_8c_ab678d4f6f0bc71028253ad299999b95e}{FreeImageFiles}( filenames, iffimg );
254         sprintf(buf,\textcolor{stringliteral}{"ParseIFF failed for image %d, failure code: %d"},i,j);
255         *errstrp = \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf};
256         \textcolor{keywordflow}{return} bmhds;
257     \}
258 
259     \textcolor{keywordflow}{if}( prop = FindProp( iff, \hyperlink{winchar_8c_a77f5e837562d84543cd22f767a581c33}{ID\_BMAP}, \hyperlink{winchar_8c_abcd1dcd9c8074c20b650110c487ec826}{ID\_BMHD} ) )
260     \{
261         bmhd = (\hyperlink{structBitMapHeader}{BitMapHeader} *)prop->sp\_Data;
262     \}
263     \textcolor{keywordflow}{else}
264     \{
265         \hyperlink{winchar_8c_ab678d4f6f0bc71028253ad299999b95e}{FreeImageFiles}(filenames, iffimg);
266         CloseIFF( iff );
267         \hyperlink{recover_8c_aeb4c27181b0a078da15c91a44e51e1d5}{Close}( iff->iff\_Stream );
268         FreeIFF( iff );
269         *errstrp = \textcolor{stringliteral}{"No BMHD CHUNK in file"};
270         \textcolor{keywordflow}{return} bmhds;
271     \}
272 
273     \textcolor{keywordflow}{if}( prop = FindProp( iff, \hyperlink{winchar_8c_a77f5e837562d84543cd22f767a581c33}{ID\_BMAP}, \hyperlink{winchar_8c_adbfe39990b0b760a79f0192db7961bd8}{ID\_CMAP} ) )
274     \{
275         cmap = prop->sp\_Data;
276         \textcolor{keywordflow}{for}( j = 0; j < (1L << bmhd->\hyperlink{structBitMapHeader_af1b1ea355b635d40198d9d97989bc733}{nPlanes})*3; j+=3 )
277         \{
278 \textcolor{preprocessor}{#if 0}
279         \textcolor{comment}{/* Some day we will want to use the larger palette}
280 \textcolor{comment}{         * resolution available under v39 and later.  i.e.}
281 \textcolor{comment}{         * 32 instead of 12 bits of color.  Ususally this}
282 \textcolor{comment}{         * just means shifting the color left by 16-20 bits}
283 \textcolor{comment}{         * depending on what intensity looks best.  Experience}
284 \textcolor{comment}{         * says that the higher values are better intensities.}
285 \textcolor{comment}{         *}
286 \textcolor{comment}{         * For now though we won't do this. The color table}
287 \textcolor{comment}{         * structure is incompatible with earlier versions of}
288 \textcolor{comment}{         * intuition.  We would have to do some funny things}
289 \textcolor{comment}{         * to make 3*AMII\_MAXCOLORS longs work like 3*AMII\_MAXCOLORS}
290 \textcolor{comment}{         * UWORD's at run time...  A union would help, but...}
291 \textcolor{comment}{         */}
292         \textcolor{keywordflow}{if}( IntuitionBase->LibNode.lib\_Version >= 39 )
293         \{
294             \textcolor{comment}{/* 8 bits of color, so shift to left end. */}
295             \hyperlink{winext_8h_af758a476f0474858372e67facd78c5c4}{amiv\_init\_map}[ j+0 ] = cmap[j+0]<<24;
296             \hyperlink{winext_8h_af758a476f0474858372e67facd78c5c4}{amiv\_init\_map}[ j+1 ] = cmap[j+1]<<24;
297             \hyperlink{winext_8h_af758a476f0474858372e67facd78c5c4}{amiv\_init\_map}[ j+2 ] = cmap[j+2]<<24;
298         \}
299         \textcolor{keywordflow}{else}
300 \textcolor{preprocessor}{#endif}
301         \{
302             \textcolor{comment}{/* We can only use 4 bits of the 8 that are stored in the}
303 \textcolor{comment}{             * cmap, so mask them and then shift them into position}
304 \textcolor{comment}{             * for the UWORD value to store.}
305 \textcolor{comment}{             */}
306 \textcolor{preprocessor}{#ifndef TESTING}
307             \hyperlink{winext_8h_a1b12e8b2fa45f0d58b47b42d920c641c}{amii\_initmap}[ j/3 ] = 
308             \hyperlink{winext_8h_af758a476f0474858372e67facd78c5c4}{amiv\_init\_map}[ j/3 ] =
309                     ((cmap[j+0]>>4)<<8)|
310                     ((cmap[j+1]>>4)<<4)|
311                     (cmap[j+2]>>4);
312 \textcolor{preprocessor}{#endif}
313         \}
314         \}
315     \}
316     \textcolor{keywordflow}{else}
317     \{
318         \hyperlink{winchar_8c_ab678d4f6f0bc71028253ad299999b95e}{FreeImageFiles}(filenames, iffimg);
319         CloseIFF( iff );
320         \hyperlink{recover_8c_aeb4c27181b0a078da15c91a44e51e1d5}{Close}( iff->iff\_Stream );
321         FreeIFF( iff );
322         *errstrp = \textcolor{stringliteral}{"No CMAP CHUNK in file"};
323         \textcolor{keywordflow}{return} bmhds;
324     \}
325 
326     \textcolor{keywordflow}{if}( prop = FindProp( iff, \hyperlink{winchar_8c_a77f5e837562d84543cd22f767a581c33}{ID\_BMAP}, \hyperlink{winchar_8c_a70bc68c6e36e5d00879130c8d8ba3c3b}{ID\_PDAT} ) )
327     \{
328         \textcolor{keyword}{struct }\hyperlink{structPDAT}{PDAT} *pp;
329 
330         pp = (\textcolor{keyword}{struct }\hyperlink{structPDAT}{PDAT} *)prop->sp\_Data;
331         \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata} = *pp;
332     \}
333     \textcolor{keywordflow}{else}
334     \{
335         \hyperlink{winchar_8c_ab678d4f6f0bc71028253ad299999b95e}{FreeImageFiles}(filenames, iffimg);
336         CloseIFF( iff );
337         \hyperlink{recover_8c_aeb4c27181b0a078da15c91a44e51e1d5}{Close}( iff->iff\_Stream );
338         FreeIFF( iff );
339         *errstrp = \textcolor{stringliteral}{"No PDAT CHUNK in file"};
340         \textcolor{keywordflow}{return} bmhds;
341     \}
342 
343     iffimg[ i ] = \hyperlink{winchar_8c_a5054ef363db2f8b757a97c991b667bfd}{MyAllocBitMap}( bmhd->\hyperlink{structBitMapHeader_addb60a981d49eed2185521b722fda07a}{w}, bmhd->\hyperlink{structBitMapHeader_a207123a0ebb6f3ac8803fb486184347d}{h},
344         \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_a65023668c3da18118ec0f30379454fa0}{nplanes} + \hyperlink{winchar_8c_ad56d04d7c6298cb19b1b7c538608bb12}{amii\_extraplanes}, MEMF\_CHIP|MEMF\_CLEAR );
345     \textcolor{keywordflow}{if}( iffimg[ i ] == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
346     \{
347         \textcolor{keywordtype}{char} *buf = \hyperlink{winproto_8h_ab028c02ac00afc0c1d3c568ccad68869}{malloc}(80);
348         \hyperlink{winchar_8c_ab678d4f6f0bc71028253ad299999b95e}{FreeImageFiles}(filenames, iffimg);
349         sprintf(buf, \textcolor{stringliteral}{"Can't allocate bitmap for image %d\(\backslash\)n"}, i );
350         *errstrp = \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf};
351         \textcolor{keywordflow}{return} bmhds;
352     \}
353     \textcolor{keywordflow}{for}( j = 0; j < \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_a65023668c3da18118ec0f30379454fa0}{nplanes} + \hyperlink{winchar_8c_ad56d04d7c6298cb19b1b7c538608bb12}{amii\_extraplanes}; ++j )
354     \{
355         ReadChunkBytes( iff, iffimg[i]->Planes[j], RASSIZE( bmhd->\hyperlink{structBitMapHeader_addb60a981d49eed2185521b722fda07a}{w}, bmhd->\hyperlink{structBitMapHeader_a207123a0ebb6f3ac8803fb486184347d}{h} ) );
356     \}
357     bmhds = *bmhd;
358     CloseIFF( iff );
359     \hyperlink{recover_8c_aeb4c27181b0a078da15c91a44e51e1d5}{Close}( iff->iff\_Stream );
360     FreeIFF( iff );
361     \}
362     CloseLibrary( \hyperlink{txt2iff_8c_af2bba7dce1b50891392273cdeca76353}{IFFParseBase} );
363 
364     \hyperlink{winchar_8c_a2dc2eddd592675f7a53c3de0084ab83b}{tile} = \hyperlink{winchar_8c_a5054ef363db2f8b757a97c991b667bfd}{MyAllocBitMap}( \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_a957fade03cbfb4ce4de9df4e09be7fc7}{xsize}, \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.
      \hyperlink{structPDAT_ad7ef994c367e747b85e09149fdccff1b}{ysize},
365         \hyperlink{winchar_8c_a00763f280fa207a0cf085c6d52246c8c}{pictdata}.\hyperlink{structPDAT_a65023668c3da18118ec0f30379454fa0}{nplanes} + \hyperlink{winchar_8c_ad56d04d7c6298cb19b1b7c538608bb12}{amii\_extraplanes}, MEMF\_CHIP|MEMF\_CLEAR );
366     \textcolor{keywordflow}{if}( \hyperlink{winchar_8c_a2dc2eddd592675f7a53c3de0084ab83b}{tile} == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
367     \{
368     \hyperlink{winchar_8c_ab678d4f6f0bc71028253ad299999b95e}{FreeImageFiles}(filenames, iffimg);
369     *errstrp = \textcolor{stringliteral}{"Can't allocate tile bitmap for scaling"};
370     \}
371     \textcolor{keywordflow}{return}( bmhds );
372 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a317e860ba7c5cb6bc220926f5571046b}{\index{winproto.\+h@{winproto.\+h}!Read\+Tile\+Image\+Files@{Read\+Tile\+Image\+Files}}
\index{Read\+Tile\+Image\+Files@{Read\+Tile\+Image\+Files}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Read\+Tile\+Image\+Files}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Bit\+Map\+Header} Read\+Tile\+Image\+Files (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a317e860ba7c5cb6bc220926f5571046b}


Definition at line 195 of file winchar.\+c.



References ifftimg, N\+U\+L\+L, panic(), Read\+Image\+Files(), and tileimages.



Referenced by amii\+\_\+init\+\_\+nhwindows().


\begin{DoxyCode}
195                     \{
196     \textcolor{keywordtype}{char} *errstr = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
197     \hyperlink{structBitMapHeader}{BitMapHeader} ret = \hyperlink{winchar_8c_a9926a7f5254f16e05a0ec9419d4a29fa}{ReadImageFiles}(\hyperlink{winchar_8c_a0190588bb20fccf5d0c424f0d9a88c62}{tileimages}, 
      \hyperlink{winchar_8c_a59e1af99e18ff54c06c0a9a5d736fa0f}{ifftimg}, &errstr);
198     \textcolor{keywordflow}{if}(errstr)\{
199     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(errstr);
200     \}
201     \textcolor{keywordflow}{return} ret;
202 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a0d631bd0422a752b9471cd23834a863d}{\index{winproto.\+h@{winproto.\+h}!Re\+Display\+Data@{Re\+Display\+Data}}
\index{Re\+Display\+Data@{Re\+Display\+Data}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Re\+Display\+Data}]{\setlength{\rightskip}{0pt plus 5cm}void Re\+Display\+Data (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{win}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a0d631bd0422a752b9471cd23834a863d}


Definition at line 1174 of file winmenu.\+c.



References amii\+\_\+wins, clear\+\_\+nhwindow, Count\+Lines(), Display\+Data(), max, amii\+\_\+\+Win\+Desc\+::win, and W\+I\+N\+\_\+\+E\+R\+R.


\begin{DoxyCode}
1176 \{
1177     \textcolor{keywordtype}{int} totalvis;
1178     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw;
1179     \textcolor{keyword}{register} \textcolor{keyword}{struct }Window *w;
1180     \textcolor{keyword}{register} \textcolor{keyword}{struct }Gadget *gd;
1181     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} hidden, aidx, wheight;
1182     \textcolor{keyword}{struct }PropInfo *pip;
1183     
1184     \textcolor{keywordflow}{if}( win == \hyperlink{wintype_8h_a56d1f4f2e517a4e81be0b7593e35e681}{WIN\_ERR} || !(cw = \hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[win]) || !( w = cw->
      \hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win} ) )
1185     \textcolor{keywordflow}{return};
1186 
1187     \textcolor{keywordflow}{for}( gd = w->FirstGadget; gd && gd->GadgetID != 1; )
1188     gd = gd->NextGadget;
1189 
1190     \textcolor{keywordflow}{if}( !gd )
1191     \textcolor{keywordflow}{return};
1192 
1193     wheight = (w->Height - w->BorderTop - w->BorderBottom-2)/w->RPort->TxHeight;
1194 
1195     pip = (\textcolor{keyword}{struct} PropInfo *)gd->SpecialInfo;
1196     totalvis = \hyperlink{sys_2amiga_2winmenu_8c_aab1d3a28e3b2dd6770eae7e837fa27dd}{CountLines}( win );
1197     hidden = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}( totalvis - wheight, 0 );
1198     aidx = (((\hyperlink{def__os2_8h_af632da489ebc3708ec3ab6791ee53fa4}{ULONG})hidden * pip->VertPot) + (MAXPOT/2)) >> 16;
1199     \hyperlink{winprocs_8h_a177c23e23d7dafb484ad58f01ae1d063}{clear\_nhwindow}( win );
1200     \hyperlink{sys_2amiga_2winmenu_8c_a3b9f0aa6b0cb58acb709d87e44a3eb99}{DisplayData}( win, aidx );
1201 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a286a3e794d3dba209062e7862565e70f}{\index{winproto.\+h@{winproto.\+h}!removetopl@{removetopl}}
\index{removetopl@{removetopl}!winproto.\+h@{winproto.\+h}}
\subsubsection[{removetopl}]{\setlength{\rightskip}{0pt plus 5cm}void removetopl (
\begin{DoxyParamCaption}
\item[{int}]{cnt}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a286a3e794d3dba209062e7862565e70f}


Definition at line 2006 of file winfuncs.\+c.



References amii\+\_\+cl\+\_\+end(), amii\+\_\+curs(), amii\+\_\+wins, amii\+\_\+\+Win\+Desc\+::curx, amii\+\_\+\+Win\+Desc\+::cury, and W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E.


\begin{DoxyCode}
2008 \{
2009     \textcolor{keyword}{struct }\hyperlink{structamii__WinDesc}{amii\_WinDesc} *cw=\hyperlink{winami_8h_a84358fe75628f255a0687acb6e8499de}{amii\_wins}[\hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE}];
2010                     \textcolor{comment}{/* NB - this is sufficient for}
2011 \textcolor{comment}{                     * yn\_function, but that's it}
2012 \textcolor{comment}{                     */}
2013     \textcolor{keywordflow}{if}(cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} < cnt)cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx}=0;
2014     \textcolor{keywordflow}{else} cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx} -= cnt;
2015 
2016     \hyperlink{winfuncs_8c_ad16d76372b2790f7b6926dc6174e4111}{amii\_curs}(\hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE}, cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx}+1, cw->\hyperlink{structamii__WinDesc_aee07cf405ea0e78eb6b82c339360a0f8}{cury});
2017     \hyperlink{winfuncs_8c_ace7ed7ac165d8e68bbc3df59a8ac5ec6}{amii\_cl\_end}(cw, cw->\hyperlink{structamii__WinDesc_a4ae862475cf0a2f6aed98394d3ac12bd}{curx});
2018 \}
\end{DoxyCode}
\hypertarget{winproto_8h_aaa6575d9ac823d93fcc4176f3b1341c3}{\index{winproto.\+h@{winproto.\+h}!Set\+Border@{Set\+Border}}
\index{Set\+Border@{Set\+Border}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Set\+Border}]{\setlength{\rightskip}{0pt plus 5cm}void Set\+Border (
\begin{DoxyParamCaption}
\item[{struct Gadget $\ast$}]{gd}
\end{DoxyParamCaption}
)}}\label{winproto_8h_aaa6575d9ac823d93fcc4176f3b1341c3}


Referenced by Edit\+Clipping(), and Edit\+Color().

\hypertarget{winproto_8h_a3eaca7a39bb270379315c3d079fd0202}{\index{winproto.\+h@{winproto.\+h}!Set\+Maze\+Type@{Set\+Maze\+Type}}
\index{Set\+Maze\+Type@{Set\+Maze\+Type}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Set\+Maze\+Type}]{\setlength{\rightskip}{0pt plus 5cm}void Set\+Maze\+Type (
\begin{DoxyParamCaption}
\item[{{\bf Maze\+Type}}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a3eaca7a39bb270379315c3d079fd0202}


Definition at line 932 of file winchar.\+c.



References maze\+\_\+type.


\begin{DoxyCode}
933 \{
934     \hyperlink{winchar_8c_a176761744efb78c887927c4ebef2b574}{maze\_type}=t;
935 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a28121fc0d5fc72d2292fa04d5bbf7d60}{\index{winproto.\+h@{winproto.\+h}!Set\+Prop\+Info@{Set\+Prop\+Info}}
\index{Set\+Prop\+Info@{Set\+Prop\+Info}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Set\+Prop\+Info}]{\setlength{\rightskip}{0pt plus 5cm}void Set\+Prop\+Info (
\begin{DoxyParamCaption}
\item[{struct Window $\ast$}]{win, }
\item[{struct Gadget $\ast$}]{gad, }
\item[{long}]{vis, }
\item[{long}]{total, }
\item[{long}]{top}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a28121fc0d5fc72d2292fa04d5bbf7d60}


Definition at line 1558 of file winmenu.\+c.



References max, and N\+U\+L\+L.



Referenced by amii\+\_\+doprev\+\_\+message(), amii\+\_\+putstr(), and Do\+Menu\+Scroll().


\begin{DoxyCode}
1562 \{
1563     \textcolor{keywordtype}{long} mflags;
1564     \textcolor{keyword}{register} \textcolor{keywordtype}{long} hidden;
1565     \textcolor{keyword}{register} \textcolor{keywordtype}{int} body, pot;
1566 
1567     hidden = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}( total-vis, 0 );
1568 
1569     \textcolor{comment}{/* Force the last section to be just to the bottom */}
1570 
1571     \textcolor{keywordflow}{if}( top > hidden )
1572     top = hidden;
1573 
1574     \textcolor{comment}{/* Scale the body position. */}
1575     \textcolor{comment}{/* 2 lines overlap */}
1576 
1577     \textcolor{keywordflow}{if}( hidden > 0 && total > 2)
1578     body = (\hyperlink{def__os2_8h_af632da489ebc3708ec3ab6791ee53fa4}{ULONG}) ((vis - 2) * MAXBODY) / (total - 2);
1579     \textcolor{keywordflow}{else}
1580     body = MAXBODY;
1581 
1582     \textcolor{keywordflow}{if}( hidden > 0 )
1583     pot = (\hyperlink{def__os2_8h_af632da489ebc3708ec3ab6791ee53fa4}{ULONG}) (top * MAXPOT) / hidden;
1584     \textcolor{keywordflow}{else}
1585     pot = 0;
1586 
1587     mflags = AUTOKNOB|FREEVERT;
1588 \textcolor{preprocessor}{#ifdef  INTUI\_NEW\_LOOK}
1589     \textcolor{keywordflow}{if}( IntuitionBase->LibNode.lib\_Version >= 37 )
1590     \{
1591     mflags |= PROPNEWLOOK;
1592     \}
1593 \textcolor{preprocessor}{#endif}
1594 
1595     NewModifyProp( gad, \hyperlink{structamii__WinDesc_a9835faa4d66643cd889203e26edee8ae}{win}, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL},
1596                 mflags, 0, pot, MAXBODY, body, 1 );
1597 \}
\end{DoxyCode}
\hypertarget{winproto_8h_ad39162b44919dddfdd5add508daa3877}{\index{winproto.\+h@{winproto.\+h}!start\+\_\+glyphout@{start\+\_\+glyphout}}
\index{start\+\_\+glyphout@{start\+\_\+glyphout}!winproto.\+h@{winproto.\+h}}
\subsubsection[{start\+\_\+glyphout}]{\setlength{\rightskip}{0pt plus 5cm}void start\+\_\+glyphout (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{window}
\end{DoxyParamCaption}
)}}\label{winproto_8h_ad39162b44919dddfdd5add508daa3877}
\hypertarget{winproto_8h_a948e00a84111ca94231f9b411ed7ec42}{\index{winproto.\+h@{winproto.\+h}!Text\+Spaces@{Text\+Spaces}}
\index{Text\+Spaces@{Text\+Spaces}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Text\+Spaces}]{\setlength{\rightskip}{0pt plus 5cm}void Text\+Spaces (
\begin{DoxyParamCaption}
\item[{struct Rast\+Port $\ast$}]{rp, }
\item[{int}]{nr}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a948e00a84111ca94231f9b411ed7ec42}


Definition at line 435 of file winstr.\+c.



References spaces.



Referenced by amii\+\_\+cl\+\_\+end(), amii\+\_\+clear\+\_\+nhwindow(), and amii\+\_\+putstr().


\begin{DoxyCode}
438 \{
439     \textcolor{keywordflow}{if}( nr < 1 )
440     \textcolor{keywordflow}{return};
441 
442     \textcolor{keywordflow}{while} (nr > \textcolor{keyword}{sizeof}(\hyperlink{winext_8h_aa3ba0c07a0e95c967d350590b6aaef7a}{spaces}) - 1)
443     \{
444     Text(\hyperlink{amirip_8c_aa0639b6491ec144930d14703053f32a4}{rp}, \hyperlink{winext_8h_aa3ba0c07a0e95c967d350590b6aaef7a}{spaces}, (\textcolor{keywordtype}{long})\textcolor{keyword}{sizeof}(\hyperlink{winext_8h_aa3ba0c07a0e95c967d350590b6aaef7a}{spaces}) - 1);
445     nr -= \textcolor{keyword}{sizeof}(\hyperlink{winext_8h_aa3ba0c07a0e95c967d350590b6aaef7a}{spaces}) - 1;
446     \}
447     \textcolor{keywordflow}{if} (nr > 0)
448     Text(\hyperlink{amirip_8c_aa0639b6491ec144930d14703053f32a4}{rp}, \hyperlink{winext_8h_aa3ba0c07a0e95c967d350590b6aaef7a}{spaces}, (\textcolor{keywordtype}{long})nr);
449 \}
\end{DoxyCode}
\hypertarget{winproto_8h_a173d2dc6a888352bb65b7cacd4576308}{\index{winproto.\+h@{winproto.\+h}!Window\+Getchar@{Window\+Getchar}}
\index{Window\+Getchar@{Window\+Getchar}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Window\+Getchar}]{\setlength{\rightskip}{0pt plus 5cm}int Window\+Getchar (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a173d2dc6a888352bb65b7cacd4576308}


Referenced by amii\+\_\+getret(), amii\+\_\+nhgetch(), and outmore().

\hypertarget{winproto_8h_a0cf134f2e1ce65f95d4c673c8c03ab2d}{\index{winproto.\+h@{winproto.\+h}!Window\+Getevent@{Window\+Getevent}}
\index{Window\+Getevent@{Window\+Getevent}!winproto.\+h@{winproto.\+h}}
\subsubsection[{Window\+Getevent}]{\setlength{\rightskip}{0pt plus 5cm}{\bf W\+E\+T\+Y\+P\+E} Window\+Getevent (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{winproto_8h_a0cf134f2e1ce65f95d4c673c8c03ab2d}


Referenced by amii\+\_\+nh\+\_\+poskey().

