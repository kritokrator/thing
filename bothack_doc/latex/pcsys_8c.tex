\hypertarget{pcsys_8c}{\section{nethack/sys/share/pcsys.c File Reference}
\label{pcsys_8c}\index{nethack/sys/share/pcsys.\+c@{nethack/sys/share/pcsys.\+c}}
}
{\ttfamily \#include \char`\"{}hack.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}wintty.\+h\char`\"{}}\\*
{\ttfamily \#include $<$ctype.\+h$>$}\\*
{\ttfamily \#include $<$fcntl.\+h$>$}\\*
{\ttfamily \#include $<$process.\+h$>$}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{pcsys_8c_ae0cbc95d7e612f32d35c1fa270f7445e}{N\+E\+E\+D\+\_\+\+V\+A\+R\+A\+R\+G\+S}
\item 
\#define \hyperlink{pcsys_8c_ab463831cccd212b4e87e67ee3e8de2d5}{nethack\+\_\+exit}~\hyperlink{sys_2wince_2winhack_8c_a26248234a12f5d74cede4c5c9968454b}{exit}
\item 
\#define \hyperlink{pcsys_8c_add147d27dd39c3119dfd2d2e7868a66b}{P\+A\+T\+H\+S\+E\+P}~';'
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{pcsys_8c_af6108da9b0444f7ee38a6c0ace4f448a}{N\+D\+E\+C\+L} (msexit)
\item 
void \hyperlink{pcsys_8c_a4b6e1f672cf36868b04539762e206898}{append\+\_\+slash} (char $\ast$\hyperlink{lev__main_8c_a8f8f80d37794cde9472343e4487ba3eb}{name})
\item 
void \hyperlink{pcsys_8c_a20ef83195361fae908e70c2967bae399}{getreturn} (char $\ast$str) \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const}
\item 
void \hyperlink{mttymain_8c_a1859cf0f0e1405ba6e3a0d4f9abe9386}{msmsg} \hyperlink{pcsys_8c_a2f4564f995c110bc970ad24a19a956be}{V\+A\+\_\+\+D\+E\+C\+L} (\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$, V\+A\+\_\+\+I\+N\+I\+T(fmt)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{pcsys_8c_ae0cbc95d7e612f32d35c1fa270f7445e}{\index{pcsys.\+c@{pcsys.\+c}!N\+E\+E\+D\+\_\+\+V\+A\+R\+A\+R\+G\+S@{N\+E\+E\+D\+\_\+\+V\+A\+R\+A\+R\+G\+S}}
\index{N\+E\+E\+D\+\_\+\+V\+A\+R\+A\+R\+G\+S@{N\+E\+E\+D\+\_\+\+V\+A\+R\+A\+R\+G\+S}!pcsys.\+c@{pcsys.\+c}}
\subsubsection[{N\+E\+E\+D\+\_\+\+V\+A\+R\+A\+R\+G\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\+E\+E\+D\+\_\+\+V\+A\+R\+A\+R\+G\+S}}\label{pcsys_8c_ae0cbc95d7e612f32d35c1fa270f7445e}


Definition at line 8 of file pcsys.\+c.

\hypertarget{pcsys_8c_ab463831cccd212b4e87e67ee3e8de2d5}{\index{pcsys.\+c@{pcsys.\+c}!nethack\+\_\+exit@{nethack\+\_\+exit}}
\index{nethack\+\_\+exit@{nethack\+\_\+exit}!pcsys.\+c@{pcsys.\+c}}
\subsubsection[{nethack\+\_\+exit}]{\setlength{\rightskip}{0pt plus 5cm}\#define nethack\+\_\+exit~{\bf exit}}}\label{pcsys_8c_ab463831cccd212b4e87e67ee3e8de2d5}


Definition at line 34 of file pcsys.\+c.

\hypertarget{pcsys_8c_add147d27dd39c3119dfd2d2e7868a66b}{\index{pcsys.\+c@{pcsys.\+c}!P\+A\+T\+H\+S\+E\+P@{P\+A\+T\+H\+S\+E\+P}}
\index{P\+A\+T\+H\+S\+E\+P@{P\+A\+T\+H\+S\+E\+P}!pcsys.\+c@{pcsys.\+c}}
\subsubsection[{P\+A\+T\+H\+S\+E\+P}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+A\+T\+H\+S\+E\+P~';'}}\label{pcsys_8c_add147d27dd39c3119dfd2d2e7868a66b}


\subsection{Function Documentation}
\hypertarget{pcsys_8c_a4b6e1f672cf36868b04539762e206898}{\index{pcsys.\+c@{pcsys.\+c}!append\+\_\+slash@{append\+\_\+slash}}
\index{append\+\_\+slash@{append\+\_\+slash}!pcsys.\+c@{pcsys.\+c}}
\subsubsection[{append\+\_\+slash}]{\setlength{\rightskip}{0pt plus 5cm}void append\+\_\+slash (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{name}
\end{DoxyParamCaption}
)}}\label{pcsys_8c_a4b6e1f672cf36868b04539762e206898}


Definition at line 376 of file pcsys.\+c.



Referenced by check\+\_\+recordfile(), and parse\+\_\+config\+\_\+line().


\begin{DoxyCode}
378 \{
379     \textcolor{keywordtype}{char} *ptr;
380 
381     \textcolor{keywordflow}{if} (!*\hyperlink{lev__main_8c_a8f8f80d37794cde9472343e4487ba3eb}{name})
382         \textcolor{keywordflow}{return};
383     ptr = \hyperlink{lev__main_8c_a8f8f80d37794cde9472343e4487ba3eb}{name} + (strlen(\hyperlink{lev__main_8c_a8f8f80d37794cde9472343e4487ba3eb}{name}) - 1);
384     \textcolor{keywordflow}{if} (*ptr != \textcolor{charliteral}{'\(\backslash\)\(\backslash\)'} && *ptr != \textcolor{charliteral}{'/'} && *ptr != \textcolor{charliteral}{':'}) \{
385         *++ptr = \textcolor{charliteral}{'\(\backslash\)\(\backslash\)'};
386         *++ptr = \textcolor{charliteral}{'\(\backslash\)0'};
387     \}
388     \textcolor{keywordflow}{return};
389 \}
\end{DoxyCode}
\hypertarget{pcsys_8c_a20ef83195361fae908e70c2967bae399}{\index{pcsys.\+c@{pcsys.\+c}!getreturn@{getreturn}}
\index{getreturn@{getreturn}!pcsys.\+c@{pcsys.\+c}}
\subsubsection[{getreturn}]{\setlength{\rightskip}{0pt plus 5cm}void getreturn (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{str}
\end{DoxyParamCaption}
) const}}\label{pcsys_8c_a20ef83195361fae908e70c2967bae399}


Definition at line 396 of file pcsys.\+c.



References Getchar, and msmsg().


\begin{DoxyCode}
398 \{
399 \textcolor{preprocessor}{#ifdef WIN32}
400     \textcolor{keywordflow}{if} (!getreturn\_enabled) \textcolor{keywordflow}{return};
401 \textcolor{preprocessor}{#endif}
402 \textcolor{preprocessor}{#ifdef TOS}
403     \hyperlink{mttymain_8c_a1859cf0f0e1405ba6e3a0d4f9abe9386}{msmsg}(\textcolor{stringliteral}{"Hit <Return> %s."}, str);
404 \textcolor{preprocessor}{#else}
405     \hyperlink{mttymain_8c_a1859cf0f0e1405ba6e3a0d4f9abe9386}{msmsg}(\textcolor{stringliteral}{"Hit <Enter> %s."}, str);
406 \textcolor{preprocessor}{#endif}
407     \textcolor{keywordflow}{while} (\hyperlink{ntconf_8h_a170ba621790aed204239f4d92e2231c9}{Getchar}() != \textcolor{charliteral}{'\(\backslash\)n'}) ;
408     \textcolor{keywordflow}{return};
409 \}
\end{DoxyCode}
\hypertarget{pcsys_8c_af6108da9b0444f7ee38a6c0ace4f448a}{\index{pcsys.\+c@{pcsys.\+c}!N\+D\+E\+C\+L@{N\+D\+E\+C\+L}}
\index{N\+D\+E\+C\+L@{N\+D\+E\+C\+L}!pcsys.\+c@{pcsys.\+c}}
\subsubsection[{N\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}static void N\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{msexit}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{pcsys_8c_af6108da9b0444f7ee38a6c0ace4f448a}
\hypertarget{pcsys_8c_a2f4564f995c110bc970ad24a19a956be}{\index{pcsys.\+c@{pcsys.\+c}!V\+A\+\_\+\+D\+E\+C\+L@{V\+A\+\_\+\+D\+E\+C\+L}}
\index{V\+A\+\_\+\+D\+E\+C\+L@{V\+A\+\_\+\+D\+E\+C\+L}!pcsys.\+c@{pcsys.\+c}}
\subsubsection[{V\+A\+\_\+\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf msmsg} V\+A\+\_\+\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf const} char $\ast$}]{, }
\item[{V\+A\+\_\+\+I\+N\+I\+T(}]{fmt}
\end{DoxyParamCaption}
)}}\label{pcsys_8c_a2f4564f995c110bc970ad24a19a956be}


Definition at line 413 of file pcsys.\+c.


\begin{DoxyCode}
432                  :\textcolor{stringliteral}{'}
433 \textcolor{stringliteral}{# else}
434 \textcolor{stringliteral}{#define PATHSEP '},\textcolor{stringliteral}{'}
435 \textcolor{stringliteral}{# endif}
436 \textcolor{stringliteral}{#else}
437 \textcolor{stringliteral}{#define PATHSEP '};\textcolor{stringliteral}{'}
438 \textcolor{stringliteral}{#endif}
439 \textcolor{stringliteral}{}
440 \textcolor{stringliteral}{FILE *}
441 \textcolor{stringliteral}{fopenp(name, mode)}
442 \textcolor{stringliteral}{const char *name, *mode;}
443 \textcolor{stringliteral}{\{}
444 \textcolor{stringliteral}{    char buf[BUFSIZ], *bp, *pp, lastch = 0;}
445 \textcolor{stringliteral}{    FILE *fp;}
446 \textcolor{stringliteral}{}
447 \textcolor{stringliteral}{    /* Try the default directory first.  Then look along PATH.}
448 \textcolor{stringliteral}{     */}
449 \textcolor{stringliteral}{    (void) strncpy(buf, name, BUFSIZ - 1);}
450 \textcolor{stringliteral}{    buf[BUFSIZ-1] = '}\(\backslash\)0\textcolor{stringliteral}{';}
451 \textcolor{stringliteral}{    if ((fp = fopen(buf, mode)))}
452 \textcolor{stringliteral}{        return fp;}
453 \textcolor{stringliteral}{    else \{}
454 \textcolor{stringliteral}{        int ccnt = 0;}
455 \textcolor{stringliteral}{        pp = getenv("PATH");}
456 \textcolor{stringliteral}{        while (pp && *pp) \{}
457 \textcolor{stringliteral}{            bp = buf;}
458 \textcolor{stringliteral}{            while (*pp && *pp != PATHSEP) \{}
459 \textcolor{stringliteral}{                lastch = *bp++ = *pp++;}
460 \textcolor{stringliteral}{                ccnt++;}
461 \textcolor{stringliteral}{            \}}
462 \textcolor{stringliteral}{            if (lastch != '}\(\backslash\)\(\backslash\)\textcolor{stringliteral}{' && lastch != '}/\textcolor{stringliteral}{') \{}
463 \textcolor{stringliteral}{                *bp++ = '}\(\backslash\)\(\backslash\)\textcolor{stringliteral}{';}
464 \textcolor{stringliteral}{                ccnt++;}
465 \textcolor{stringliteral}{            \}}
466 \textcolor{stringliteral}{            (void) strncpy(bp, name, (BUFSIZ - ccnt) - 2);}
467 \textcolor{stringliteral}{            bp[BUFSIZ - ccnt - 1] = '}\(\backslash\)0\textcolor{stringliteral}{';}
468 \textcolor{stringliteral}{            if ((fp = fopen(buf, mode)))}
469 \textcolor{stringliteral}{                return fp;}
470 \textcolor{stringliteral}{            if (*pp)}
471 \textcolor{stringliteral}{                pp++;}
472 \textcolor{stringliteral}{        \}}
473 \textcolor{stringliteral}{    \}}
474 \textcolor{stringliteral}{#ifdef OS2\_CODEVIEW /* one more try for hackdir */}
475 \textcolor{stringliteral}{    (void) strncpy(buf, hackdir, BUFSZ);}
476 \textcolor{stringliteral}{    buf[BUFSZ-1] = '}\(\backslash\)0\textcolor{stringliteral}{';}
477 \textcolor{stringliteral}{    if ((strlen(name) + 1 + strlen(buf)) < BUFSZ - 1) \{}
478 \textcolor{stringliteral}{        append\_slash(buf);}
479 \textcolor{stringliteral}{        Strcat(buf,name);}
480 \textcolor{stringliteral}{    \} else }
481 \textcolor{stringliteral}{        impossible("fopenp() buffer too small for complete filename!");}
482 \textcolor{stringliteral}{    if(fp = fopen(buf,mode))}
483 \textcolor{stringliteral}{        return fp;}
484 \textcolor{stringliteral}{#endif}
485 \textcolor{stringliteral}{    return (FILE *)0;}
486 \textcolor{stringliteral}{\}}
\end{DoxyCode}
