\hypertarget{pickup_8c}{\section{nethack/src/pickup.c File Reference}
\label{pickup_8c}\index{nethack/src/pickup.\+c@{nethack/src/pickup.\+c}}
}
{\ttfamily \#include \char`\"{}hack.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{pickup_8c_ad9881e8c0343df60fbfd87242384fc87}{F\+O\+L\+L\+O\+W}(curr, \hyperlink{decl_8c_a997133526e0c6bed44ebc0116a48b50a}{flags})~(((\hyperlink{decl_8c_a997133526e0c6bed44ebc0116a48b50a}{flags}) \& \hyperlink{hack_8h_a399a7fd555c25420d580a1a05df5d082}{B\+Y\+\_\+\+N\+E\+X\+T\+H\+E\+R\+E}) ? (curr)-\/$>$\hyperlink{obj_8h_a48857f39d27ea25589dd447836c1d50b}{nexthere} \+: (curr)-\/$>$\hyperlink{lev__main_8c_a2ab61a372270bf9e1fb46f02f1fb8e0a}{nobj})
\item 
\#define \hyperlink{pickup_8c_aa2d05ce931b1549c62cd76e2bfcfe84e}{D\+E\+L\+T\+A\+\_\+\+C\+W\+T}(cont, \hyperlink{structobj}{obj})
\item 
\#define \hyperlink{pickup_8c_afbfc857d93577b5d4da51fc660872f38}{G\+O\+L\+D\+\_\+\+W\+T}(n)~(((n) + 50\+L) / 100\+L)
\item 
\#define \hyperlink{pickup_8c_aa22e190bbd8fa281f694657c0f161f3e}{G\+O\+L\+D\+\_\+\+C\+A\+P\+A\+C\+I\+T\+Y}(w, n)~(((w) $\ast$ -\/100\+L) -\/ ((n) + 50\+L) -\/ 1\+L)
\item 
\#define \hyperlink{pickup_8c_a03ae3a6955e4b11872783e4350243305}{Icebox}~(\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\+\_\+container}-\/$>$otyp == I\+C\+E\+\_\+\+B\+O\+X)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{pickup_8c_a9c6a606ae174d0b8480f4bfbe2274728}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_a2d57788c7582f93a86e16f80b91ec4b9}{simple\+\_\+look},(struct \hyperlink{structobj}{obj} $\ast$, \hyperlink{wingem1_8c_aa2723cc3af18a5199ab4ce7cca84d82b}{B\+O\+O\+L\+E\+A\+N\+\_\+\+P}))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{pickup_8c_aa19af8d41f34d334fbb493a319908c0c}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_a4f84d70771d90362fe0ee76b5dde91f5}{query\+\_\+classes},(char $\ast$, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} $\ast$, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} $\ast$, \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$, struct \hyperlink{structobj}{obj} $\ast$, \hyperlink{wingem1_8c_aa2723cc3af18a5199ab4ce7cca84d82b}{B\+O\+O\+L\+E\+A\+N\+\_\+\+P}, \hyperlink{wingem1_8c_aa2723cc3af18a5199ab4ce7cca84d82b}{B\+O\+O\+L\+E\+A\+N\+\_\+\+P}, int $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{pickup_8c_a3057552a80506a990c4af609a0164caa}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_aaa2596751167ec82657450be8202f869}{check\+\_\+here},(\hyperlink{wingem1_8c_aa2723cc3af18a5199ab4ce7cca84d82b}{B\+O\+O\+L\+E\+A\+N\+\_\+\+P}))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{pickup_8c_a8bebeba5a73dc074034cfe581c6e333d}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_a7d2f7740acfb2d86e93801c0a6639b28}{n\+\_\+or\+\_\+more},(struct \hyperlink{structobj}{obj} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{pickup_8c_a10d938c4e3a5270e9e6363a2072e0495}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_ae59fc67ba82b0dbaca24bc6cd133511f}{all\+\_\+but\+\_\+uchain},(struct \hyperlink{structobj}{obj} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int \hyperlink{pickup_8c_ad13167bc13c399e1f4fe3bb3633c6888}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_a001d10b037df91814111609abd49ddb7}{autopick},(struct \hyperlink{structobj}{obj} $\ast$, int, \hyperlink{wintype_8h_aaef709f77068fd7ba62812589327f08f}{menu\+\_\+item} $\ast$$\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int \hyperlink{pickup_8c_ae89ff2187b96d3605de4925cc0b90b46}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_af32126808aff7b5b4031513023beb462}{count\+\_\+categories},(struct \hyperlink{structobj}{obj} $\ast$, int))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} long \hyperlink{pickup_8c_a9d65a12813ff433c2307a60c4894ff58}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_adff898a6bd9216fda62bee05b410ef1c}{carry\+\_\+count},(struct \hyperlink{structobj}{obj} $\ast$, struct \hyperlink{structobj}{obj} $\ast$, long, \hyperlink{wingem1_8c_aa2723cc3af18a5199ab4ce7cca84d82b}{B\+O\+O\+L\+E\+A\+N\+\_\+\+P}, int $\ast$, int $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int \hyperlink{pickup_8c_a29defa5be61f9babb28073eae85c3e77}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_afc20ba70668bc135322317c55743f068}{lift\+\_\+object},(struct \hyperlink{structobj}{obj} $\ast$, struct \hyperlink{structobj}{obj} $\ast$, long $\ast$, \hyperlink{wingem1_8c_aa2723cc3af18a5199ab4ce7cca84d82b}{B\+O\+O\+L\+E\+A\+N\+\_\+\+P}))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{pickup_8c_ab965b71b37608a3ceccfb71c87ef5dc8}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_a80e990e904b2e1279e053d82311f0900}{mbag\+\_\+explodes},(struct \hyperlink{structobj}{obj} $\ast$, int))
\item 
\hyperlink{hack_8h_ac0f6cfba4138e5e6a773d15a80ea82ff}{S\+T\+A\+T\+I\+C\+\_\+\+P\+T\+R} int \hyperlink{pickup_8c_ae617f9b13161d43769f1bf943b6141d4}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_a8344ebfadcf90f594ad92856f5a1467d}{in\+\_\+container},(struct \hyperlink{structobj}{obj} $\ast$))
\item 
\hyperlink{hack_8h_ac0f6cfba4138e5e6a773d15a80ea82ff}{S\+T\+A\+T\+I\+C\+\_\+\+P\+T\+R} int \hyperlink{pickup_8c_aaac875371dc984c0754a0bd61e8ca695}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_afb34b00ade44133f5eca3d852b4a0a6d}{ck\+\_\+bag},(struct \hyperlink{structobj}{obj} $\ast$))
\item 
\hyperlink{hack_8h_ac0f6cfba4138e5e6a773d15a80ea82ff}{S\+T\+A\+T\+I\+C\+\_\+\+P\+T\+R} int \hyperlink{pickup_8c_a61a660352b106d4d5af7880180dbfb1e}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_a874288ec8fc650fcaac88c1fa2d2b74e}{out\+\_\+container},(struct \hyperlink{structobj}{obj} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} long \hyperlink{pickup_8c_a83a1fb5f2be62d32e22fb257601653ae}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_ab1de57e2933948819d5dc58d696d18e0}{mbag\+\_\+item\+\_\+gone},(int, struct \hyperlink{structobj}{obj} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{pickup_8c_a5b91c3ec3ab0433734af32e474513b90}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_a47dbe7403194a564273bc82e20f4b1af}{observe\+\_\+quantum\+\_\+cat},(struct \hyperlink{structobj}{obj} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int \hyperlink{pickup_8c_a26e29ed722746e24ae30b12fa78f4371}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_a8ca8f01ed38aee3209b6742d7fd4638f}{menu\+\_\+loot},(int, struct \hyperlink{structobj}{obj} $\ast$, \hyperlink{wingem1_8c_aa2723cc3af18a5199ab4ce7cca84d82b}{B\+O\+O\+L\+E\+A\+N\+\_\+\+P}))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int \hyperlink{pickup_8c_ad65b64ed7d041d5c56ee0951f6a5ebdf}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_a129d64e6943eb249b60f861442aad5e0}{in\+\_\+or\+\_\+out\+\_\+menu},(\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$, struct \hyperlink{structobj}{obj} $\ast$, \hyperlink{wingem1_8c_aa2723cc3af18a5199ab4ce7cca84d82b}{B\+O\+O\+L\+E\+A\+N\+\_\+\+P}, \hyperlink{wingem1_8c_aa2723cc3af18a5199ab4ce7cca84d82b}{B\+O\+O\+L\+E\+A\+N\+\_\+\+P}))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int \hyperlink{pickup_8c_a4fca29e81857a14274f9f1aca18a9c88}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_a060256bdbd95b33a4806cf58d95cdb25}{container\+\_\+at},(int, int, \hyperlink{wingem1_8c_aa2723cc3af18a5199ab4ce7cca84d82b}{B\+O\+O\+L\+E\+A\+N\+\_\+\+P}))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{pickup_8c_a96fa8f337828283d6d95912e4d1dfdab}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_a2e933b08bbfff4e0622e654db78283e3}{able\+\_\+to\+\_\+loot},(int, int))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{pickup_8c_a64b6434e90a167497ee5731349ae7d8a}{F\+D\+E\+C\+L} (\hyperlink{pickup_8c_a58b59552076730fea752be5055c7d1b7}{mon\+\_\+beside},(int, int))
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{pickup_8c_a2d57788c7582f93a86e16f80b91ec4b9}{simple\+\_\+look} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp}, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} here)
\item 
int \hyperlink{pickup_8c_a77b7485059911d3dd89bc5893dc7c1ea}{collect\+\_\+obj\+\_\+classes} (ilets, struct \hyperlink{structobj}{obj} $\ast$\hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp}, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} here, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} incl\+\_\+gold, filter, int $\ast$itemcount)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{pickup_8c_a4f84d70771d90362fe0ee76b5dde91f5}{query\+\_\+classes} (oclasses, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} $\ast$one\+\_\+at\+\_\+a\+\_\+time, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} $\ast$everything, \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$action, struct \hyperlink{structobj}{obj} $\ast$objs, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} here, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} incl\+\_\+gold, int $\ast$menu\+\_\+on\+\_\+demand)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{pickup_8c_aaa2596751167ec82657450be8202f869}{check\+\_\+here} (\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} picked\+\_\+some)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{pickup_8c_a7d2f7740acfb2d86e93801c0a6639b28}{n\+\_\+or\+\_\+more} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj})
\item 
void \hyperlink{pickup_8c_a3a3907f1a05bd3d2eacfd77cd041536c}{add\+\_\+valid\+\_\+menu\+\_\+class} (int c)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{pickup_8c_ae59fc67ba82b0dbaca24bc6cd133511f}{all\+\_\+but\+\_\+uchain} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj})
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{pickup_8c_a68e173dd97659afd09dd9e8a85e8d819}{allow\+\_\+all} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj})
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{pickup_8c_a0f79e2cd14f388a93269666fcb2d22ca}{allow\+\_\+category} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj})
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{pickup_8c_a818a4690d3e1e2dacdba758181ff7228}{is\+\_\+worn\+\_\+by\+\_\+type} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp})
\item 
int \hyperlink{pickup_8c_ab9fd1f5835d6d35507a05e910e86d862}{pickup} (int \hyperlink{detect_8c_a951a98f1e2d69ca61adcd53c0f8faca3}{what})
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int \hyperlink{pickup_8c_a001d10b037df91814111609abd49ddb7}{autopick} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{lev__yacc_8c_a33f9fd742e948f0c40d8661f76a0d250}{olist}, int follow, \hyperlink{wintype_8h_aaef709f77068fd7ba62812589327f08f}{menu\+\_\+item} $\ast$$\ast$pick\+\_\+list)
\item 
int \hyperlink{pickup_8c_a40f3b140b744aff03e62fec624f927d0}{query\+\_\+objlist} (char $\ast$qstr, struct \hyperlink{structobj}{obj} $\ast$\hyperlink{lev__yacc_8c_a33f9fd742e948f0c40d8661f76a0d250}{olist}, int qflags, \hyperlink{wintype_8h_aaef709f77068fd7ba62812589327f08f}{menu\+\_\+item} $\ast$$\ast$pick\+\_\+list, int how, allow) \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const}
\item 
int \hyperlink{pickup_8c_a728a862fbc9e9cbf54e8663c8b1dc0fd}{query\+\_\+category} (char $\ast$qstr, struct \hyperlink{structobj}{obj} $\ast$\hyperlink{lev__yacc_8c_a33f9fd742e948f0c40d8661f76a0d250}{olist}, int qflags, \hyperlink{wintype_8h_aaef709f77068fd7ba62812589327f08f}{menu\+\_\+item} $\ast$$\ast$pick\+\_\+list, int how) \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const}
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int \hyperlink{pickup_8c_af32126808aff7b5b4031513023beb462}{count\+\_\+categories} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{lev__yacc_8c_a33f9fd742e948f0c40d8661f76a0d250}{olist}, int qflags)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} long \hyperlink{pickup_8c_adff898a6bd9216fda62bee05b410ef1c}{carry\+\_\+count} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj}, struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structcontainer}{container}, long \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} telekinesis, int $\ast$wt\+\_\+before, int $\ast$wt\+\_\+after)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int \hyperlink{pickup_8c_afc20ba70668bc135322317c55743f068}{lift\+\_\+object} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj}, struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structcontainer}{container}, long $\ast$cnt\+\_\+p, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} telekinesis)
\item 
\hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$ \hyperlink{pickup_8c_adeadb81e8a48333beb5ca21a69f49edc}{safe\+\_\+qbuf} (char $\ast$qbuf, unsigned padlength, char $\ast$plan\+A, char $\ast$plan\+B, char $\ast$last\+\_\+resort) \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const}
\item 
int \hyperlink{pickup_8c_a766962d5f6ecef8bf6d2d20d470e9630}{pickup\+\_\+object} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj}, long \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} telekinesis)
\item 
struct \hyperlink{structobj}{obj} $\ast$ \hyperlink{pickup_8c_aa9b25e3f7e59ea0f9951b9760553c30b}{pick\+\_\+obj} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp})
\item 
int \hyperlink{pickup_8c_aed29b02f27db47b69b5ef129bf56e102}{encumber\+\_\+msg} ()
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int \hyperlink{pickup_8c_a060256bdbd95b33a4806cf58d95cdb25}{container\+\_\+at} (int x, int y, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} countem)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{pickup_8c_a2e933b08bbfff4e0622e654db78283e3}{able\+\_\+to\+\_\+loot} (int x, int y)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{pickup_8c_a58b59552076730fea752be5055c7d1b7}{mon\+\_\+beside} (int x, int y)
\item 
int \hyperlink{pickup_8c_a65511fe8ae0c40b10e0c5824343bac74}{doloot} ()
\item 
int \hyperlink{pickup_8c_af864ece40ccded6527e66267c718e375}{loot\+\_\+mon} (struct \hyperlink{structmonst}{monst} $\ast$mtmp, int $\ast$passed\+\_\+info, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} $\ast$prev\+\_\+loot)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{pickup_8c_a80e990e904b2e1279e053d82311f0900}{mbag\+\_\+explodes} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj}, int depthin)
\item 
\hyperlink{hack_8h_ac0f6cfba4138e5e6a773d15a80ea82ff}{S\+T\+A\+T\+I\+C\+\_\+\+P\+T\+R} int \hyperlink{pickup_8c_a8344ebfadcf90f594ad92856f5a1467d}{in\+\_\+container} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj})
\item 
\hyperlink{hack_8h_ac0f6cfba4138e5e6a773d15a80ea82ff}{S\+T\+A\+T\+I\+C\+\_\+\+P\+T\+R} int \hyperlink{pickup_8c_afb34b00ade44133f5eca3d852b4a0a6d}{ck\+\_\+bag} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj})
\item 
\hyperlink{hack_8h_ac0f6cfba4138e5e6a773d15a80ea82ff}{S\+T\+A\+T\+I\+C\+\_\+\+P\+T\+R} int \hyperlink{pickup_8c_a874288ec8fc650fcaac88c1fa2d2b74e}{out\+\_\+container} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj})
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} long \hyperlink{pickup_8c_ab1de57e2933948819d5dc58d696d18e0}{mbag\+\_\+item\+\_\+gone} (int held, struct \hyperlink{structobj}{obj} $\ast$item)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{pickup_8c_a47dbe7403194a564273bc82e20f4b1af}{observe\+\_\+quantum\+\_\+cat} (struct \hyperlink{structobj}{obj} $\ast$box)
\item 
int \hyperlink{pickup_8c_a3b46d13409ed1c58c848d17176c119dd}{use\+\_\+container} (struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj}, int held)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int \hyperlink{pickup_8c_a8ca8f01ed38aee3209b6742d7fd4638f}{menu\+\_\+loot} (int retry, struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structcontainer}{container}, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} put\+\_\+in)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int \hyperlink{pickup_8c_a129d64e6943eb249b60f861442aad5e0}{in\+\_\+or\+\_\+out\+\_\+menu} (char $\ast$prompt, struct \hyperlink{structobj}{obj} $\ast$\hyperlink{structobj}{obj}, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} outokay, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} inokay) \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const}
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char \hyperlink{pickup_8c_a46ed6db9f3f1bd6fbc51981cc1c3b6ce}{moderateloadmsg} \mbox{[}$\,$\mbox{]} = \char`\"{}You have a little trouble lifting\char`\"{}
\item 
static \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char \hyperlink{pickup_8c_a74c9304356d6e805b16fb8cd0ad4de59}{nearloadmsg} \mbox{[}$\,$\mbox{]} = \char`\"{}You have much trouble lifting\char`\"{}
\item 
static \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char \hyperlink{pickup_8c_ac720afce691f17f08514b51d99c8e933}{overloadmsg} \mbox{[}$\,$\mbox{]} = \char`\"{}You have extreme difficulty lifting\char`\"{}
\item 
static long \hyperlink{pickup_8c_a0bd193462382b9374db52932708de0c3}{val\+\_\+for\+\_\+n\+\_\+or\+\_\+more}
\item 
static char \hyperlink{pickup_8c_a35ecb0af10e36ef86e7a32d62e771d5c}{valid\+\_\+menu\+\_\+classes} \mbox{[}\hyperlink{objclass_8h_af51133138bfb718b55aaa7f29711a10a}{M\+A\+X\+O\+C\+L\+A\+S\+S\+E\+S}+2\mbox{]}
\item 
static \hyperlink{config1_8h_a9987bf629301f5fe76ddd96aa2717ca1}{N\+E\+A\+R\+D\+A\+T\+A} struct \hyperlink{structobj}{obj} $\ast$ \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\+\_\+container}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{pickup_8c_aa2d05ce931b1549c62cd76e2bfcfe84e}{\index{pickup.\+c@{pickup.\+c}!D\+E\+L\+T\+A\+\_\+\+C\+W\+T@{D\+E\+L\+T\+A\+\_\+\+C\+W\+T}}
\index{D\+E\+L\+T\+A\+\_\+\+C\+W\+T@{D\+E\+L\+T\+A\+\_\+\+C\+W\+T}!pickup.\+c@{pickup.\+c}}
\subsubsection[{D\+E\+L\+T\+A\+\_\+\+C\+W\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+E\+L\+T\+A\+\_\+\+C\+W\+T(
\begin{DoxyParamCaption}
\item[{}]{cont, }
\item[{}]{{\bf obj}}
\end{DoxyParamCaption}
)}}\label{pickup_8c_aa2d05ce931b1549c62cd76e2bfcfe84e}
{\bfseries Value\+:}
\begin{DoxyCode}
((cont)->cursed ? (\hyperlink{structobj}{obj})->owt * 2 :   \(\backslash\)
              1 + ((\hyperlink{structobj}{obj})->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt} / ((cont)->blessed ? 4 : 2)))
\end{DoxyCode}


Definition at line 51 of file pickup.\+c.



Referenced by carry\+\_\+count().

\hypertarget{pickup_8c_ad9881e8c0343df60fbfd87242384fc87}{\index{pickup.\+c@{pickup.\+c}!F\+O\+L\+L\+O\+W@{F\+O\+L\+L\+O\+W}}
\index{F\+O\+L\+L\+O\+W@{F\+O\+L\+L\+O\+W}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+O\+L\+L\+O\+W}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\+O\+L\+L\+O\+W(
\begin{DoxyParamCaption}
\item[{}]{curr, }
\item[{}]{{\bf flags}}
\end{DoxyParamCaption}
)~((({\bf flags}) \& {\bf B\+Y\+\_\+\+N\+E\+X\+T\+H\+E\+R\+E}) ? (curr)-\/$>${\bf nexthere} \+: (curr)-\/$>${\bf nobj})}}\label{pickup_8c_ad9881e8c0343df60fbfd87242384fc87}


Definition at line 43 of file pickup.\+c.



Referenced by autopick(), count\+\_\+categories(), query\+\_\+category(), and query\+\_\+objlist().

\hypertarget{pickup_8c_aa22e190bbd8fa281f694657c0f161f3e}{\index{pickup.\+c@{pickup.\+c}!G\+O\+L\+D\+\_\+\+C\+A\+P\+A\+C\+I\+T\+Y@{G\+O\+L\+D\+\_\+\+C\+A\+P\+A\+C\+I\+T\+Y}}
\index{G\+O\+L\+D\+\_\+\+C\+A\+P\+A\+C\+I\+T\+Y@{G\+O\+L\+D\+\_\+\+C\+A\+P\+A\+C\+I\+T\+Y}!pickup.\+c@{pickup.\+c}}
\subsubsection[{G\+O\+L\+D\+\_\+\+C\+A\+P\+A\+C\+I\+T\+Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define G\+O\+L\+D\+\_\+\+C\+A\+P\+A\+C\+I\+T\+Y(
\begin{DoxyParamCaption}
\item[{}]{w, }
\item[{}]{n}
\end{DoxyParamCaption}
)~(((w) $\ast$ -\/100\+L) -\/ ((n) + 50\+L) -\/ 1\+L)}}\label{pickup_8c_aa22e190bbd8fa281f694657c0f161f3e}


Definition at line 56 of file pickup.\+c.



Referenced by carry\+\_\+count(), and pickup\+\_\+object().

\hypertarget{pickup_8c_afbfc857d93577b5d4da51fc660872f38}{\index{pickup.\+c@{pickup.\+c}!G\+O\+L\+D\+\_\+\+W\+T@{G\+O\+L\+D\+\_\+\+W\+T}}
\index{G\+O\+L\+D\+\_\+\+W\+T@{G\+O\+L\+D\+\_\+\+W\+T}!pickup.\+c@{pickup.\+c}}
\subsubsection[{G\+O\+L\+D\+\_\+\+W\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define G\+O\+L\+D\+\_\+\+W\+T(
\begin{DoxyParamCaption}
\item[{}]{n}
\end{DoxyParamCaption}
)~(((n) + 50\+L) / 100\+L)}}\label{pickup_8c_afbfc857d93577b5d4da51fc660872f38}


Definition at line 54 of file pickup.\+c.



Referenced by carry\+\_\+count(), and pickup\+\_\+object().

\hypertarget{pickup_8c_a03ae3a6955e4b11872783e4350243305}{\index{pickup.\+c@{pickup.\+c}!Icebox@{Icebox}}
\index{Icebox@{Icebox}!pickup.\+c@{pickup.\+c}}
\subsubsection[{Icebox}]{\setlength{\rightskip}{0pt plus 5cm}\#define Icebox~({\bf current\+\_\+container}-\/$>$otyp == I\+C\+E\+\_\+\+B\+O\+X)}}\label{pickup_8c_a03ae3a6955e4b11872783e4350243305}


Definition at line 1765 of file pickup.\+c.



Referenced by in\+\_\+container(), and out\+\_\+container().



\subsection{Function Documentation}
\hypertarget{pickup_8c_a2e933b08bbfff4e0622e654db78283e3}{\index{pickup.\+c@{pickup.\+c}!able\+\_\+to\+\_\+loot@{able\+\_\+to\+\_\+loot}}
\index{able\+\_\+to\+\_\+loot@{able\+\_\+to\+\_\+loot}!pickup.\+c@{pickup.\+c}}
\subsubsection[{able\+\_\+to\+\_\+loot}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} able\+\_\+to\+\_\+loot (
\begin{DoxyParamCaption}
\item[{int}]{x, }
\item[{int}]{y}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a2e933b08bbfff4e0622e654db78283e3}


Definition at line 1463 of file pickup.\+c.



References monst\+::data, F\+A\+L\+S\+E, H\+A\+N\+D, nolimbs, P\+\_\+\+B\+A\+S\+I\+C, P\+\_\+\+S\+K\+I\+L\+L, T\+R\+U\+E, u, and youmonst.



Referenced by doloot().


\begin{DoxyCode}
1465 \{
1466     \textcolor{keywordflow}{if} (!can\_reach\_floor()) \{
1467 \textcolor{preprocessor}{#ifdef STEED}
1468         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.usteed && \hyperlink{skills_8h_a778eff14f7209290967e1627b0b737ea}{P\_SKILL}(P\_RIDING) < \hyperlink{skills_8h_af8c105b3dff5dd8b7e1444bb63e1492c}{P\_BASIC})
1469             rider\_cant\_reach(); \textcolor{comment}{/* not skilled enough to reach */}
1470         \textcolor{keywordflow}{else}
1471 \textcolor{preprocessor}{#endif}
1472             You(\textcolor{stringliteral}{"cannot reach the %s."}, surface(x, y));
1473         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1474     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (is\_pool(x, y) || is\_lava(x, y)) \{
1475         \textcolor{comment}{/* at present, can't loot in water even when Underwater */}
1476         You(\textcolor{stringliteral}{"cannot loot things that are deep in the %s."},
1477             is\_lava(x, y) ? \textcolor{stringliteral}{"lava"} : \textcolor{stringliteral}{"water"});
1478         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1479     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a9e529fc9e93948358711f5420caee8fa}{nolimbs}(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})) \{
1480         pline(\textcolor{stringliteral}{"Without limbs, you cannot loot anything."});
1481         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1482     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!freehand()) \{
1483         pline(\textcolor{stringliteral}{"Without a free %s, you cannot loot anything."},
1484             body\_part(\hyperlink{hack_8h_a701f28a9a2b5334b58333f06e27ad91f}{HAND}));
1485         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1486     \}
1487     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1488 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a3a3907f1a05bd3d2eacfd77cd041536c}{\index{pickup.\+c@{pickup.\+c}!add\+\_\+valid\+\_\+menu\+\_\+class@{add\+\_\+valid\+\_\+menu\+\_\+class}}
\index{add\+\_\+valid\+\_\+menu\+\_\+class@{add\+\_\+valid\+\_\+menu\+\_\+class}!pickup.\+c@{pickup.\+c}}
\subsubsection[{add\+\_\+valid\+\_\+menu\+\_\+class}]{\setlength{\rightskip}{0pt plus 5cm}void add\+\_\+valid\+\_\+menu\+\_\+class (
\begin{DoxyParamCaption}
\item[{int}]{c}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a3a3907f1a05bd3d2eacfd77cd041536c}


Definition at line 294 of file pickup.\+c.



Referenced by menu\+\_\+loot(), pickup(), query\+\_\+classes(), and use\+\_\+container().


\begin{DoxyCode}
296 \{
297     \textcolor{keyword}{static} \textcolor{keywordtype}{int} vmc\_count = 0;
298 
299     \textcolor{keywordflow}{if} (c == 0)  \textcolor{comment}{/* reset */}
300       vmc\_count = 0;
301     \textcolor{keywordflow}{else}
302       \hyperlink{pickup_8c_a35ecb0af10e36ef86e7a32d62e771d5c}{valid\_menu\_classes}[vmc\_count++] = (char)c;
303     \hyperlink{pickup_8c_a35ecb0af10e36ef86e7a32d62e771d5c}{valid\_menu\_classes}[vmc\_count] = \textcolor{charliteral}{'\(\backslash\)0'};
304 \}
\end{DoxyCode}
\hypertarget{pickup_8c_ae59fc67ba82b0dbaca24bc6cd133511f}{\index{pickup.\+c@{pickup.\+c}!all\+\_\+but\+\_\+uchain@{all\+\_\+but\+\_\+uchain}}
\index{all\+\_\+but\+\_\+uchain@{all\+\_\+but\+\_\+uchain}!pickup.\+c@{pickup.\+c}}
\subsubsection[{all\+\_\+but\+\_\+uchain}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} all\+\_\+but\+\_\+uchain (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{obj}
\end{DoxyParamCaption}
)}}\label{pickup_8c_ae59fc67ba82b0dbaca24bc6cd133511f}


Definition at line 308 of file pickup.\+c.



References uchain.



Referenced by pickup().


\begin{DoxyCode}
310 \{
311     \textcolor{keywordflow}{return} (obj != \hyperlink{decl_8h_ac83f46f409b88c6d6109ed04938ad52a}{uchain});
312 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a68e173dd97659afd09dd9e8a85e8d819}{\index{pickup.\+c@{pickup.\+c}!allow\+\_\+all@{allow\+\_\+all}}
\index{allow\+\_\+all@{allow\+\_\+all}!pickup.\+c@{pickup.\+c}}
\subsubsection[{allow\+\_\+all}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} allow\+\_\+all (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{obj}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a68e173dd97659afd09dd9e8a85e8d819}


Definition at line 317 of file pickup.\+c.



References T\+R\+U\+E.



Referenced by menu\+\_\+loot(), and pickup().


\begin{DoxyCode}
319 \{
320     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
321 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a0f79e2cd14f388a93269666fcb2d22ca}{\index{pickup.\+c@{pickup.\+c}!allow\+\_\+category@{allow\+\_\+category}}
\index{allow\+\_\+category@{allow\+\_\+category}!pickup.\+c@{pickup.\+c}}
\subsubsection[{allow\+\_\+category}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} allow\+\_\+category (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{obj}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a0f79e2cd14f388a93269666fcb2d22ca}


Definition at line 324 of file pickup.\+c.



References C\+O\+I\+N\+\_\+\+C\+L\+A\+S\+S, F\+A\+L\+S\+E, index(), Role\+\_\+if, and T\+R\+U\+E.



Referenced by menu\+\_\+loot(), and pickup().


\begin{DoxyCode}
326 \{
327     \textcolor{keywordflow}{if} (\hyperlink{you_8h_a6087f5b8605964c19078b777da740258}{Role\_if}(PM\_PRIEST)) obj->bknown = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
328     \textcolor{keywordflow}{if} (((\hyperlink{uudecode_8c_ac82f3cc16110a05458f2b2483236afb7}{index}(\hyperlink{pickup_8c_a35ecb0af10e36ef86e7a32d62e771d5c}{valid\_menu\_classes},\textcolor{charliteral}{'u'}) != (\textcolor{keywordtype}{char} *)0) && obj->unpaid) ||
329     (\hyperlink{uudecode_8c_ac82f3cc16110a05458f2b2483236afb7}{index}(\hyperlink{pickup_8c_a35ecb0af10e36ef86e7a32d62e771d5c}{valid\_menu\_classes}, obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass}) != (\textcolor{keywordtype}{char} *)0))
330     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
331     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (((\hyperlink{uudecode_8c_ac82f3cc16110a05458f2b2483236afb7}{index}(\hyperlink{pickup_8c_a35ecb0af10e36ef86e7a32d62e771d5c}{valid\_menu\_classes},\textcolor{charliteral}{'U'}) != (\textcolor{keywordtype}{char} *)0) &&
332     (obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} != \hyperlink{objclass_8h_a2999621925083659147349e261e4cb3d}{COIN\_CLASS} && obj->bknown && !obj->blessed && !obj->cursed)))
333     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
334     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (((\hyperlink{uudecode_8c_ac82f3cc16110a05458f2b2483236afb7}{index}(\hyperlink{pickup_8c_a35ecb0af10e36ef86e7a32d62e771d5c}{valid\_menu\_classes},\textcolor{charliteral}{'B'}) != (\textcolor{keywordtype}{char} *)0) &&
335     (obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} != \hyperlink{objclass_8h_a2999621925083659147349e261e4cb3d}{COIN\_CLASS} && obj->bknown && obj->blessed)))
336     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
337     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (((\hyperlink{uudecode_8c_ac82f3cc16110a05458f2b2483236afb7}{index}(\hyperlink{pickup_8c_a35ecb0af10e36ef86e7a32d62e771d5c}{valid\_menu\_classes},\textcolor{charliteral}{'C'}) != (\textcolor{keywordtype}{char} *)0) &&
338     (obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} != \hyperlink{objclass_8h_a2999621925083659147349e261e4cb3d}{COIN\_CLASS} && obj->bknown && obj->cursed)))
339     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
340     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (((\hyperlink{uudecode_8c_ac82f3cc16110a05458f2b2483236afb7}{index}(\hyperlink{pickup_8c_a35ecb0af10e36ef86e7a32d62e771d5c}{valid\_menu\_classes},\textcolor{charliteral}{'X'}) != (\textcolor{keywordtype}{char} *)0) &&
341     (obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} != \hyperlink{objclass_8h_a2999621925083659147349e261e4cb3d}{COIN\_CLASS} && !obj->bknown)))
342     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
343     \textcolor{keywordflow}{else}
344     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
345 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a001d10b037df91814111609abd49ddb7}{\index{pickup.\+c@{pickup.\+c}!autopick@{autopick}}
\index{autopick@{autopick}!pickup.\+c@{pickup.\+c}}
\subsubsection[{autopick}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int autopick (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{olist, }
\item[{int}]{follow, }
\item[{{\bf menu\+\_\+item} $\ast$$\ast$}]{pick\+\_\+list}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a001d10b037df91814111609abd49ddb7}


Definition at line 627 of file pickup.\+c.



References any\+::a\+\_\+obj, alloc(), A\+U\+T\+O\+P\+I\+C\+K\+U\+P\+\_\+\+E\+X\+C\+E\+P\+T\+I\+O\+N\+S, mi\+::count, F\+A\+L\+S\+E, flags, F\+O\+L\+L\+O\+W, index(), mi\+::item, obj\+::oclass, flag\+::pickup\+\_\+types, obj\+::quan, and T\+R\+U\+E.



Referenced by pickup().


\begin{DoxyCode}
631 \{
632     \hyperlink{structmi}{menu\_item} *pi; \textcolor{comment}{/* pick item */}
633     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *curr;
634     \textcolor{keywordtype}{int} n;
635     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *otypes = \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a9f5bdc61a0cc269e6631f79e19fced46}{pickup\_types};
636 
637     \textcolor{comment}{/* first count the number of eligible items */}
638     \textcolor{keywordflow}{for} (n = 0, curr = olist; curr; curr = \hyperlink{pickup_8c_ad9881e8c0343df60fbfd87242384fc87}{FOLLOW}(curr, follow))
639 
640 
641 #ifndef \hyperlink{wceconf_8h_a5196d997856fdfe4d135031c0b7331e4}{AUTOPICKUP\_EXCEPTIONS}
642         \textcolor{keywordflow}{if} (!*otypes || \hyperlink{uudecode_8c_ac82f3cc16110a05458f2b2483236afb7}{index}(otypes, curr->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass}))
643 #\textcolor{keywordflow}{else}
644         \textcolor{keywordflow}{if} ((!*otypes || \hyperlink{uudecode_8c_ac82f3cc16110a05458f2b2483236afb7}{index}(otypes, curr->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass}) ||
645          is\_autopickup\_exception(curr, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE})) &&
646              !is\_autopickup\_exception(curr, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}))
647 #endif
648         n++;
649 
650     \textcolor{keywordflow}{if} (n) \{
651         *pick\_list = pi = (\hyperlink{structmi}{menu\_item} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(\textcolor{keyword}{sizeof}(\hyperlink{structmi}{menu\_item}) * n);
652         \textcolor{keywordflow}{for} (n = 0, curr = olist; curr; curr = \hyperlink{pickup_8c_ad9881e8c0343df60fbfd87242384fc87}{FOLLOW}(curr, follow))
653 #ifndef \hyperlink{wceconf_8h_a5196d997856fdfe4d135031c0b7331e4}{AUTOPICKUP\_EXCEPTIONS}
654         \textcolor{keywordflow}{if} (!*otypes || \hyperlink{uudecode_8c_ac82f3cc16110a05458f2b2483236afb7}{index}(otypes, curr->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass})) \{
655 \textcolor{preprocessor}{#else}
656         \textcolor{keywordflow}{if} ((!*otypes || \hyperlink{uudecode_8c_ac82f3cc16110a05458f2b2483236afb7}{index}(otypes, curr->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass}) ||
657          is\_autopickup\_exception(curr, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE})) &&
658              !is\_autopickup\_exception(curr, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE})) \{
659 \textcolor{preprocessor}{#endif}
660             pi[n].\hyperlink{structmi_a24f26cd1b01d3cf3ed16b1fd020d3a08}{item}.\hyperlink{unionany_a0b581808e661444ae19a63a5ccdbf367}{a\_obj} = curr;
661             pi[n].\hyperlink{structmi_a008e5c33aa571223ec592e0725c5fb73}{count} = curr->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan};
662             n++;
663         \}
664     \}
665     \textcolor{keywordflow}{return} n;
666 \}
\end{DoxyCode}
\hypertarget{pickup_8c_adff898a6bd9216fda62bee05b410ef1c}{\index{pickup.\+c@{pickup.\+c}!carry\+\_\+count@{carry\+\_\+count}}
\index{carry\+\_\+count@{carry\+\_\+count}!pickup.\+c@{pickup.\+c}}
\subsubsection[{carry\+\_\+count}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} long carry\+\_\+count (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{obj, }
\item[{struct {\bf obj} $\ast$}]{container, }
\item[{long}]{count, }
\item[{{\bf boolean}}]{telekinesis, }
\item[{int $\ast$}]{wt\+\_\+before, }
\item[{int $\ast$}]{wt\+\_\+after}
\end{DoxyParamCaption}
)}}\label{pickup_8c_adff898a6bd9216fda62bee05b410ef1c}


Definition at line 978 of file pickup.\+c.



References B\+U\+F\+S\+Z, carried, C\+O\+I\+N\+\_\+\+C\+L\+A\+S\+S, count, D\+E\+L\+T\+A\+\_\+\+C\+W\+T, G\+O\+L\+D\+\_\+\+C\+A\+P\+A\+C\+I\+T\+Y, G\+O\+L\+D\+\_\+\+W\+T, invent, obj\+::quan, Sprintf, S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L, Strcpy, u, you\+::ugold, and where.



Referenced by lift\+\_\+object().


\begin{DoxyCode}
983 \{
984     \textcolor{keywordtype}{boolean} adjust\_wt = container && \hyperlink{obj_8h_a4adde9a5428fde9b6faf64253a1507e8}{carried}(container),
985         is\_gold = obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == \hyperlink{objclass_8h_a2999621925083659147349e261e4cb3d}{COIN\_CLASS};
986     \textcolor{keywordtype}{int} wt, iw, ow, oow;
987     \textcolor{keywordtype}{long} qq, savequan;
988 \textcolor{preprocessor}{#ifdef GOLDOBJ}
989     \textcolor{keywordtype}{long} umoney = money\_cnt(\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent});
990 \textcolor{preprocessor}{#endif}
991     \textcolor{keywordtype}{unsigned} saveowt;
992     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *verb, *prefx1, *prefx2, *suffx;
993     \textcolor{keywordtype}{char} obj\_nambuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}], \hyperlink{detect_8c_a8201fc0bfa35306851be2a25ab2d6263}{where}[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
994 
995     savequan = obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan};
996     saveowt = obj->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt};
997 
998     iw = max\_capacity();
999 
1000     \textcolor{keywordflow}{if} (\hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count} != savequan) \{
1001     obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} = \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
1002     obj->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt} = (unsigned)weight(obj);
1003     \}
1004     wt = iw + (int)obj->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt};
1005     if (adjust\_wt)
1006     wt -= (container->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == BAG\_OF\_HOLDING) ?
1007         (\textcolor{keywordtype}{int})\hyperlink{pickup_8c_aa2d05ce931b1549c62cd76e2bfcfe84e}{DELTA\_CWT}(container, obj) : (int)obj->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt};
1008 \textcolor{preprocessor}{#ifndef GOLDOBJ}
1009     \textcolor{keywordflow}{if} (is\_gold)    \textcolor{comment}{/* merged gold might affect cumulative weight */}
1010     wt -= (\hyperlink{pickup_8c_afbfc857d93577b5d4da51fc660872f38}{GOLD\_WT}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold}) + \hyperlink{pickup_8c_afbfc857d93577b5d4da51fc660872f38}{GOLD\_WT}(\hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}) - \hyperlink{pickup_8c_afbfc857d93577b5d4da51fc660872f38}{GOLD\_WT}(
      \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold} + \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}));
1011 \textcolor{preprocessor}{#else}
1012     \textcolor{comment}{/* This will go with silver+copper & new gold weight */}
1013     \textcolor{keywordflow}{if} (is\_gold)    \textcolor{comment}{/* merged gold might affect cumulative weight */}
1014     wt -= (\hyperlink{pickup_8c_afbfc857d93577b5d4da51fc660872f38}{GOLD\_WT}(umoney) + \hyperlink{pickup_8c_afbfc857d93577b5d4da51fc660872f38}{GOLD\_WT}(\hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}) - \hyperlink{pickup_8c_afbfc857d93577b5d4da51fc660872f38}{GOLD\_WT}(umoney + 
      \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}));
1015 \textcolor{preprocessor}{#endif}
1016     \textcolor{keywordflow}{if} (\hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count} != savequan) \{
1017     obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} = savequan;
1018     obj->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt} = saveowt;
1019     \}
1020     *wt\_before = iw;
1021     *wt\_after  = wt;
1022 
1023     \textcolor{keywordflow}{if} (wt < 0)
1024     \textcolor{keywordflow}{return} \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
1025 
1026     \textcolor{comment}{/* see how many we can lift */}
1027     \textcolor{keywordflow}{if} (is\_gold) \{
1028 \textcolor{preprocessor}{#ifndef GOLDOBJ}
1029     iw -= (int)\hyperlink{pickup_8c_afbfc857d93577b5d4da51fc660872f38}{GOLD\_WT}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold});
1030     \textcolor{keywordflow}{if} (!adjust\_wt) \{
1031         qq = \hyperlink{pickup_8c_aa22e190bbd8fa281f694657c0f161f3e}{GOLD\_CAPACITY}((\textcolor{keywordtype}{long})iw, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold});
1032     \} \textcolor{keywordflow}{else} \{
1033         oow = 0;
1034         qq = 50L - (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold} % 100L) - 1L;
1035 \textcolor{preprocessor}{#else}
1036     iw -= (int)\hyperlink{pickup_8c_afbfc857d93577b5d4da51fc660872f38}{GOLD\_WT}(umoney);
1037     \textcolor{keywordflow}{if} (!adjust\_wt) \{
1038         qq = \hyperlink{pickup_8c_aa22e190bbd8fa281f694657c0f161f3e}{GOLD\_CAPACITY}((\textcolor{keywordtype}{long})iw, umoney);
1039     \} \textcolor{keywordflow}{else} \{
1040         oow = 0;
1041         qq = 50L - (umoney % 100L) - 1L;
1042 \textcolor{preprocessor}{#endif}
1043         \textcolor{keywordflow}{if} (qq < 0L) qq += 100L;
1044         \textcolor{keywordflow}{for} ( ; qq <= \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}; qq += 100L) \{
1045         obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} = qq;
1046         obj->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt} = (unsigned)\hyperlink{pickup_8c_afbfc857d93577b5d4da51fc660872f38}{GOLD\_WT}(qq);
1047 \textcolor{preprocessor}{#ifndef GOLDOBJ}
1048         ow = (int)\hyperlink{pickup_8c_afbfc857d93577b5d4da51fc660872f38}{GOLD\_WT}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold} + qq);
1049 \textcolor{preprocessor}{#else}
1050         ow = (int)\hyperlink{pickup_8c_afbfc857d93577b5d4da51fc660872f38}{GOLD\_WT}(umoney + qq);
1051 \textcolor{preprocessor}{#endif}
1052         ow -= (container->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == BAG\_OF\_HOLDING) ?
1053             (\textcolor{keywordtype}{int})\hyperlink{pickup_8c_aa2d05ce931b1549c62cd76e2bfcfe84e}{DELTA\_CWT}(container, obj) : (int)obj->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt};
1054         \textcolor{keywordflow}{if} (iw + ow >= 0) \textcolor{keywordflow}{break};
1055         oow = ow;
1056         \}
1057         iw -= oow;
1058         qq -= 100L;
1059     \}
1060     \textcolor{keywordflow}{if} (qq < 0L) qq = 0L;
1061     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (qq > \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}) qq = \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
1062 \textcolor{preprocessor}{#ifndef GOLDOBJ}
1063     wt = iw + (int)\hyperlink{pickup_8c_afbfc857d93577b5d4da51fc660872f38}{GOLD\_WT}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold} + qq);
1064 \textcolor{preprocessor}{#else}
1065     wt = iw + (int)\hyperlink{pickup_8c_afbfc857d93577b5d4da51fc660872f38}{GOLD\_WT}(umoney + qq);
1066 \textcolor{preprocessor}{#endif}
1067     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count} > 1 || count < obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan}) \{
1068     \textcolor{comment}{/*}
1069 \textcolor{comment}{     * Ugh. Calc num to lift by changing the quan of of the}
1070 \textcolor{comment}{     * object and calling weight.}
1071 \textcolor{comment}{     *}
1072 \textcolor{comment}{     * This works for containers only because containers}
1073 \textcolor{comment}{     * don't merge.     -dean}
1074 \textcolor{comment}{     */}
1075     \textcolor{keywordflow}{for} (qq = 1L; qq <= \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}; qq++) \{
1076         obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} = qq;
1077         obj->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt} = (unsigned)(ow = weight(obj));
1078         \textcolor{keywordflow}{if} (adjust\_wt)
1079         ow -= (container->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == BAG\_OF\_HOLDING) ?
1080             (\textcolor{keywordtype}{int})\hyperlink{pickup_8c_aa2d05ce931b1549c62cd76e2bfcfe84e}{DELTA\_CWT}(container, obj) : (int)obj->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt};
1081         \textcolor{keywordflow}{if} (iw + ow >= 0)
1082         \textcolor{keywordflow}{break};
1083         wt = iw + ow;
1084     \}
1085     --qq;
1086     \} \textcolor{keywordflow}{else} \{
1087     \textcolor{comment}{/* there's only one, and we can't lift it */}
1088     qq = 0L;
1089     \}
1090     obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} = savequan;
1091     obj->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt} = saveowt;
1092 
1093     \textcolor{keywordflow}{if} (qq < \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}) \{
1094     \textcolor{comment}{/* some message will be given */}
1095     \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(obj\_nambuf, doname(obj));
1096     \textcolor{keywordflow}{if} (container) \{
1097         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(where, \textcolor{stringliteral}{"in %s"}, the(xname(container)));
1098         verb = \textcolor{stringliteral}{"carry"};
1099     \} \textcolor{keywordflow}{else} \{
1100         \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(where, \textcolor{stringliteral}{"lying here"});
1101         verb = telekinesis ? \textcolor{stringliteral}{"acquire"} : \textcolor{stringliteral}{"lift"};
1102     \}
1103     \} \textcolor{keywordflow}{else} \{
1104     \textcolor{comment}{/* lint supppression */}
1105     *obj\_nambuf = *where = \textcolor{charliteral}{'\(\backslash\)0'};
1106     verb = \textcolor{stringliteral}{""};
1107     \}
1108     \textcolor{comment}{/* we can carry qq of them */}
1109     \textcolor{keywordflow}{if} (qq > 0) \{
1110     \textcolor{keywordflow}{if} (qq < \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count})
1111         You(\textcolor{stringliteral}{"can only %s %s of the %s %s."},
1112         verb, (qq == 1L) ? \textcolor{stringliteral}{"one"} : \textcolor{stringliteral}{"some"}, obj\_nambuf, where);
1113     *wt\_after = wt;
1114     \textcolor{keywordflow}{return} qq;
1115     \}
1116 
1117     \textcolor{keywordflow}{if} (!container) \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(where, \textcolor{stringliteral}{"here"});  \textcolor{comment}{/* slightly shorter form */}
1118 \textcolor{preprocessor}{#ifndef GOLDOBJ}
1119     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent} || \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold}) \{
1120 \textcolor{preprocessor}{#else}
1121     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent} || umoney) \{
1122 \textcolor{preprocessor}{#endif}
1123     prefx1 = \textcolor{stringliteral}{"you cannot "};
1124     prefx2 = \textcolor{stringliteral}{""};
1125     suffx  = \textcolor{stringliteral}{" any more"};
1126     \} \textcolor{keywordflow}{else} \{
1127     prefx1 = (obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} == 1L) ? \textcolor{stringliteral}{"it "} : \textcolor{stringliteral}{"even one "};
1128     prefx2 = \textcolor{stringliteral}{"is too heavy for you to "};
1129     suffx  = \textcolor{stringliteral}{""};
1130     \}
1131     There(\textcolor{stringliteral}{"%s %s %s, but %s%s%s%s."},
1132       otense(obj, \textcolor{stringliteral}{"are"}), obj\_nambuf, where,
1133       prefx1, prefx2, verb, suffx);
1134 
1135  \textcolor{comment}{/* *wt\_after = iw; */}
1136     \textcolor{keywordflow}{return} 0L;
1137 \}
\end{DoxyCode}
\hypertarget{pickup_8c_aaa2596751167ec82657450be8202f869}{\index{pickup.\+c@{pickup.\+c}!check\+\_\+here@{check\+\_\+here}}
\index{check\+\_\+here@{check\+\_\+here}!pickup.\+c@{pickup.\+c}}
\subsubsection[{check\+\_\+here}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void check\+\_\+here (
\begin{DoxyParamCaption}
\item[{{\bf boolean}}]{picked\+\_\+some}
\end{DoxyParamCaption}
)}}\label{pickup_8c_aaa2596751167ec82657450be8202f869}


Definition at line 256 of file pickup.\+c.



References flags, flush\+\_\+screen(), level, dlevel\+\_\+t\+::objects, flag\+::run, u, uchain, you\+::ux, and you\+::uy.



Referenced by pickup().


\begin{DoxyCode}
258 \{
259     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{structobj}{obj};
260     \textcolor{keyword}{register} \textcolor{keywordtype}{int} ct = 0;
261 
262     \textcolor{comment}{/* count the objects here */}
263     \textcolor{keywordflow}{for} (obj = \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ac128f805d01d7746b499596dd3b92a53}{objects}[\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}][\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}]; obj; obj = obj->nexthere) \{
264         \textcolor{keywordflow}{if} (obj != \hyperlink{decl_8h_ac83f46f409b88c6d6109ed04938ad52a}{uchain})
265         ct++;
266     \}
267 
268     \textcolor{comment}{/* If there are objects here, take a look. */}
269     \textcolor{keywordflow}{if} (ct) \{
270         \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a75d9c7e384cce1696f2c2d1b2881d162}{run}) nomul(0);
271         \hyperlink{display_8c_a47cdbc8092c02ed856defd22a0952aeb}{flush\_screen}(1);
272         (void) look\_here(ct, picked\_some);
273     \} \textcolor{keywordflow}{else} \{
274         read\_engr\_at(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux},\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy});
275     \}
276 \}
\end{DoxyCode}
\hypertarget{pickup_8c_afb34b00ade44133f5eca3d852b4a0a6d}{\index{pickup.\+c@{pickup.\+c}!ck\+\_\+bag@{ck\+\_\+bag}}
\index{ck\+\_\+bag@{ck\+\_\+bag}!pickup.\+c@{pickup.\+c}}
\subsubsection[{ck\+\_\+bag}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+P\+T\+R} int ck\+\_\+bag (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{obj}
\end{DoxyParamCaption}
)}}\label{pickup_8c_afb34b00ade44133f5eca3d852b4a0a6d}


Definition at line 1919 of file pickup.\+c.



References current\+\_\+container.



Referenced by use\+\_\+container().


\begin{DoxyCode}
1921 \{
1922     \textcolor{keywordflow}{return} \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container} && obj != \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container};
1923 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a77b7485059911d3dd89bc5893dc7c1ea}{\index{pickup.\+c@{pickup.\+c}!collect\+\_\+obj\+\_\+classes@{collect\+\_\+obj\+\_\+classes}}
\index{collect\+\_\+obj\+\_\+classes@{collect\+\_\+obj\+\_\+classes}!pickup.\+c@{pickup.\+c}}
\subsubsection[{collect\+\_\+obj\+\_\+classes}]{\setlength{\rightskip}{0pt plus 5cm}int collect\+\_\+obj\+\_\+classes (
\begin{DoxyParamCaption}
\item[{ilets}]{, }
\item[{struct {\bf obj} $\ast$}]{otmp, }
\item[{{\bf boolean}}]{here, }
\item[{{\bf boolean}}]{incl\+\_\+gold, }
\item[{filter}]{, }
\item[{int $\ast$}]{itemcount}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a77b7485059911d3dd89bc5893dc7c1ea}


Definition at line 92 of file pickup.\+c.



References C\+O\+I\+N\+\_\+\+C\+L\+A\+S\+S, def\+\_\+oc\+\_\+syms, index(), and otmp.



Referenced by query\+\_\+classes().


\begin{DoxyCode}
107 \{
108     \textcolor{keyword}{register} \textcolor{keywordtype}{int} iletct = 0;
109     \textcolor{keyword}{register} \textcolor{keywordtype}{char} c;
110 
111     *itemcount = 0;
112 \textcolor{preprocessor}{#ifndef GOLDOBJ}
113     \textcolor{keywordflow}{if} (incl\_gold)
114         ilets[iletct++] = \hyperlink{decl_8h_ab2de6953c2db763f00d7f3baf830fe50}{def\_oc\_syms}[\hyperlink{objclass_8h_a2999621925083659147349e261e4cb3d}{COIN\_CLASS}];
115 \textcolor{preprocessor}{#endif}
116     ilets[iletct] = \textcolor{charliteral}{'\(\backslash\)0'}; \textcolor{comment}{/* terminate ilets so that index() will work */}
117     \textcolor{keywordflow}{while} (otmp) \{
118         c = \hyperlink{decl_8h_ab2de6953c2db763f00d7f3baf830fe50}{def\_oc\_syms}[(int)otmp->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass}];
119         if (!\hyperlink{uudecode_8c_ac82f3cc16110a05458f2b2483236afb7}{index}(ilets, c) && (!filter || (*filter)(\hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp})))
120         ilets[iletct++] = c,  ilets[iletct] = \textcolor{charliteral}{'\(\backslash\)0'};
121         *itemcount += 1;
122         otmp = here ? otmp->nexthere : otmp->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj};
123     \}
124 
125     \textcolor{keywordflow}{return} iletct;
126 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a060256bdbd95b33a4806cf58d95cdb25}{\index{pickup.\+c@{pickup.\+c}!container\+\_\+at@{container\+\_\+at}}
\index{container\+\_\+at@{container\+\_\+at}!pickup.\+c@{pickup.\+c}}
\subsubsection[{container\+\_\+at}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int container\+\_\+at (
\begin{DoxyParamCaption}
\item[{int}]{x, }
\item[{int}]{y, }
\item[{{\bf boolean}}]{countem}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a060256bdbd95b33a4806cf58d95cdb25}


Definition at line 1445 of file pickup.\+c.



References obj\+::cobj, Is\+\_\+container, level, nobj, and dlevel\+\_\+t\+::objects.



Referenced by doloot().


\begin{DoxyCode}
1448 \{
1449     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{structobj_aa7bed832c417657c964b6f5893737586}{cobj}, *\hyperlink{lev__yacc_8c_a2ab61a372270bf9e1fb46f02f1fb8e0a}{nobj};
1450     \textcolor{keywordtype}{int} container\_count = 0;
1451     
1452     \textcolor{keywordflow}{for}(cobj = \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ac128f805d01d7746b499596dd3b92a53}{objects}[x][y]; cobj; cobj = nobj) \{
1453         nobj = cobj->nexthere;
1454         \textcolor{keywordflow}{if}(\hyperlink{obj_8h_a588d9420d81612a88940b1522e279527}{Is\_container}(cobj)) \{
1455             container\_count++;
1456             \textcolor{keywordflow}{if} (!countem) \textcolor{keywordflow}{break};
1457         \}
1458     \}
1459     \textcolor{keywordflow}{return} container\_count;
1460 \}
\end{DoxyCode}
\hypertarget{pickup_8c_af32126808aff7b5b4031513023beb462}{\index{pickup.\+c@{pickup.\+c}!count\+\_\+categories@{count\+\_\+categories}}
\index{count\+\_\+categories@{count\+\_\+categories}!pickup.\+c@{pickup.\+c}}
\subsubsection[{count\+\_\+categories}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int count\+\_\+categories (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{olist, }
\item[{int}]{qflags}
\end{DoxyParamCaption}
)}}\label{pickup_8c_af32126808aff7b5b4031513023beb462}


Definition at line 947 of file pickup.\+c.



References F\+A\+L\+S\+E, flags, F\+O\+L\+L\+O\+W, flag\+::inv\+\_\+order, obj\+::oclass, obj\+::owornmask, T\+R\+U\+E, W\+\_\+\+A\+M\+U\+L, W\+\_\+\+A\+R\+M\+O\+R, W\+\_\+\+Q\+U\+I\+V\+E\+R, W\+\_\+\+R\+I\+N\+G, W\+\_\+\+S\+W\+A\+P\+W\+E\+P, W\+\_\+\+T\+O\+O\+L, W\+\_\+\+W\+E\+P, and W\+O\+R\+N\+\_\+\+T\+Y\+P\+E\+S.



Referenced by query\+\_\+category().


\begin{DoxyCode}
950 \{
951     \textcolor{keywordtype}{char} *pack;
952     \textcolor{keywordtype}{boolean} counted\_category;
953     \textcolor{keywordtype}{int} ccount = 0;
954     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *curr;
955 
956     pack = \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_afbbdabb7b1593b8ff0036a5c67ece86f}{inv\_order};
957     \textcolor{keywordflow}{do} \{
958         counted\_category = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
959         \textcolor{keywordflow}{for} (curr = olist; curr; curr = \hyperlink{pickup_8c_ad9881e8c0343df60fbfd87242384fc87}{FOLLOW}(curr, qflags)) \{
960         \textcolor{keywordflow}{if} (curr->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == *pack) \{
961            \textcolor{keywordflow}{if} ((qflags & \hyperlink{hack_8h_adfd4db58219bfc2b13b62daac9e14ee3}{WORN\_TYPES}) &&
962                 !(curr->\hyperlink{structobj_a7906e045755ba4099705764a4eb076c6}{owornmask} & (\hyperlink{prop_8h_afb4c914cfecbde6972d893bc33e10aa9}{W\_ARMOR} | \hyperlink{prop_8h_a855614df1627862ffc73bf31e283b7b9}{W\_RING} | 
      \hyperlink{prop_8h_a1a4f9d6f31538cc9d677e617b49597d2}{W\_AMUL} | \hyperlink{prop_8h_ac2c824bec7fcb9f986b9e905d1f5ee8a}{W\_TOOL} |
963                 \hyperlink{prop_8h_abd75a55f67b13523ef4377d4eb6fb6ad}{W\_WEP} | \hyperlink{prop_8h_a4571f54e71d38d81a610eaf77e5fecd9}{W\_SWAPWEP} | \hyperlink{prop_8h_a9b95d7c6e22f325a5bc0326d7673a4f4}{W\_QUIVER})))
964              \textcolor{keywordflow}{continue};
965            \textcolor{keywordflow}{if} (!counted\_category) \{
966             ccount++;
967             counted\_category = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
968            \}
969         \}
970         \}
971         pack++;
972     \} \textcolor{keywordflow}{while} (*pack);
973     \textcolor{keywordflow}{return} ccount;
974 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a65511fe8ae0c40b10e0c5824343bac74}{\index{pickup.\+c@{pickup.\+c}!doloot@{doloot}}
\index{doloot@{doloot}!pickup.\+c@{pickup.\+c}}
\subsubsection[{doloot}]{\setlength{\rightskip}{0pt plus 5cm}int doloot (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a65511fe8ae0c40b10e0c5824343bac74}


Definition at line 1506 of file pickup.\+c.



References able\+\_\+to\+\_\+loot(), B\+U\+F\+S\+Z, obj\+::cobj, C\+O\+I\+N\+\_\+\+C\+L\+A\+S\+S, Confusion, container\+\_\+at(), monst\+::data, F\+A\+L\+S\+E, fobj, Half\+\_\+physical\+\_\+damage, invent, Is\+\_\+container, I\+S\+\_\+\+T\+H\+R\+O\+N\+E, K\+I\+L\+L\+E\+D\+\_\+\+B\+Y\+\_\+\+A\+N, L\+A\+R\+G\+E\+S\+T\+\_\+\+I\+N\+T, level, levl, makeknown, monst\+::mgold, min, multi, N\+O\+\_\+\+M\+M\+\_\+\+F\+L\+A\+G\+S, obj\+::nobj, nobj, nohands, dlevel\+\_\+t\+::objects, obj\+::oclass, obj\+::otyp, obj\+::owt, obj\+::quan, safe\+\_\+qbuf(), obj\+::spe, Sprintf, T\+R\+U\+E, u, you\+::ugold, use\+\_\+container(), you\+::ux, you\+::uy, coord\+::x, coord\+::y, ynq, and youmonst.


\begin{DoxyCode}
1507 \{
1508     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{structobj_aa7bed832c417657c964b6f5893737586}{cobj}, *\hyperlink{lev__yacc_8c_a2ab61a372270bf9e1fb46f02f1fb8e0a}{nobj};
1509     \textcolor{keyword}{register} \textcolor{keywordtype}{int} c = -1;
1510     \textcolor{keywordtype}{int} timepassed = 0;
1511     \hyperlink{structcoord}{coord} cc;
1512     \textcolor{keywordtype}{boolean} underfoot = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1513     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *dont\_find\_anything = \textcolor{stringliteral}{"don't find anything"};
1514     \textcolor{keyword}{struct }\hyperlink{structmonst}{monst} *mtmp;
1515     \textcolor{keywordtype}{char} qbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
1516     \textcolor{keywordtype}{int} prev\_inquiry = 0;
1517     \textcolor{keywordtype}{boolean} prev\_loot = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1518 
1519     \textcolor{keywordflow}{if} (check\_capacity((\textcolor{keywordtype}{char} *)0)) \{
1520     \textcolor{comment}{/* "Can't do that while carrying so much stuff." */}
1521     \textcolor{keywordflow}{return} 0;
1522     \}
1523     \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_ae13d4a4d0a9842348cffbb5dae990771}{nohands}(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})) \{
1524     You(\textcolor{stringliteral}{"have no hands!"});  \textcolor{comment}{/* not `body\_part(HAND)' */}
1525     \textcolor{keywordflow}{return} 0;
1526     \}
1527     cc.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x} = \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}; cc.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y} = \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy};
1528 
1529 lootcont:
1530 
1531     \textcolor{keywordflow}{if} (\hyperlink{pickup_8c_a060256bdbd95b33a4806cf58d95cdb25}{container\_at}(cc.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}, cc.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE})) \{
1532     \textcolor{keywordtype}{boolean} \hyperlink{unionany}{any} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1533 
1534     \textcolor{keywordflow}{if} (!\hyperlink{pickup_8c_a2e933b08bbfff4e0622e654db78283e3}{able\_to\_loot}(cc.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}, cc.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y})) \textcolor{keywordflow}{return} 0;
1535     \textcolor{keywordflow}{for} (cobj = \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ac128f805d01d7746b499596dd3b92a53}{objects}[cc.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}][cc.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}]; cobj; cobj = nobj) \{
1536         nobj = cobj->nexthere;
1537 
1538         \textcolor{keywordflow}{if} (\hyperlink{obj_8h_a588d9420d81612a88940b1522e279527}{Is\_container}(cobj)) \{
1539         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(qbuf, \textcolor{stringliteral}{"There is %s here, loot it?"},
1540             \hyperlink{pickup_8c_adeadb81e8a48333beb5ca21a69f49edc}{safe\_qbuf}(\textcolor{stringliteral}{""}, \textcolor{keyword}{sizeof}(\textcolor{stringliteral}{"There is  here, loot it?"}),
1541                  doname(cobj), an(simple\_typename(cobj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp})),
1542                  \textcolor{stringliteral}{"a container"}));
1543         c = \hyperlink{hack_8h_a104792d619a60e73407115c00499745e}{ynq}(qbuf);
1544         \textcolor{keywordflow}{if} (c == \textcolor{charliteral}{'q'}) \textcolor{keywordflow}{return} (timepassed);
1545         \textcolor{keywordflow}{if} (c == \textcolor{charliteral}{'n'}) \textcolor{keywordflow}{continue};
1546         any = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1547 
1548         \textcolor{keywordflow}{if} (cobj->olocked) \{
1549             pline(\textcolor{stringliteral}{"Hmmm, it seems to be locked."});
1550             \textcolor{keywordflow}{continue};
1551         \}
1552         \textcolor{keywordflow}{if} (cobj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == BAG\_OF\_TRICKS) \{
1553             \textcolor{keywordtype}{int} tmp;
1554             You(\textcolor{stringliteral}{"carefully open the bag..."});
1555             pline(\textcolor{stringliteral}{"It develops a huge set of teeth and bites you!"});
1556             tmp = rnd(10);
1557             \textcolor{keywordflow}{if} (\hyperlink{youprop_8h_a5fc206bd0d8714595b57ebade21d4757}{Half\_physical\_damage}) tmp = (tmp+1) / 2;
1558             losehp(tmp, \textcolor{stringliteral}{"carnivorous bag"}, \hyperlink{decl_8h_af4e54910b730baa32b2dfbe4dd2942c1}{KILLED\_BY\_AN});
1559             \hyperlink{hack_8h_afbd3607e7cef2f888f4190d40d058011}{makeknown}(BAG\_OF\_TRICKS);
1560             timepassed = 1;
1561             \textcolor{keywordflow}{continue};
1562         \}
1563 
1564         You(\textcolor{stringliteral}{"carefully open %s..."}, the(xname(cobj)));
1565         timepassed |= \hyperlink{pickup_8c_a3b46d13409ed1c58c848d17176c119dd}{use\_container}(cobj, 0);
1566         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a498406921f71695627a7107240f3ed7a}{multi} < 0) \textcolor{keywordflow}{return} 1;       \textcolor{comment}{/* chest trap */}
1567         \}
1568     \}
1569     \textcolor{keywordflow}{if} (any) c = \textcolor{charliteral}{'y'};
1570     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{youprop_8h_a85174462efda5cc2dc2a49a0249801bb}{Confusion}) \{
1571 \textcolor{preprocessor}{#ifndef GOLDOBJ}
1572     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold})\{
1573         \textcolor{keywordtype}{long} contribution = rnd((\textcolor{keywordtype}{int})\hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a7e80c139c01102183d2a57d61b5d2d8a}{LARGEST\_INT},\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold}));
1574         \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *goldob = mkgoldobj(contribution);
1575 \textcolor{preprocessor}{#else}
1576     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *goldob;
1577     \textcolor{comment}{/* Find a money object to mess with */}
1578     \textcolor{keywordflow}{for} (goldob = \hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent}; goldob; goldob = goldob->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj}) \{
1579         \textcolor{keywordflow}{if} (goldob->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == \hyperlink{objclass_8h_a2999621925083659147349e261e4cb3d}{COIN\_CLASS}) \textcolor{keywordflow}{break};
1580     \}
1581     \textcolor{keywordflow}{if} (goldob)\{
1582         \textcolor{keywordtype}{long} contribution = rnd((\textcolor{keywordtype}{int})\hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(\hyperlink{global_8h_a7e80c139c01102183d2a57d61b5d2d8a}{LARGEST\_INT}, goldob->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan}));
1583         \textcolor{keywordflow}{if} (contribution < goldob->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan})
1584         goldob = splitobj(goldob, contribution);
1585         freeinv(goldob);
1586 \textcolor{preprocessor}{#endif}
1587         \textcolor{keywordflow}{if} (\hyperlink{rm_8h_a54ef8a46ccbe911f27cf886dfb9f5f25}{IS\_THRONE}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}][\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}].typ))\{
1588         \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *coffers;
1589         \textcolor{keywordtype}{int} pass;
1590         \textcolor{comment}{/* find the original coffers chest, or any chest */}
1591         \textcolor{keywordflow}{for} (pass = 2; pass > -1; pass -= 2)
1592             \textcolor{keywordflow}{for} (coffers = \hyperlink{rm_8h_a4d2866bf9ebea1c08c26174b5c8cfbb7}{fobj}; coffers; coffers = coffers->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj})
1593             \textcolor{keywordflow}{if} (coffers->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == CHEST && coffers->\hyperlink{structobj_a14fc8dc59e9073bfbf1e170875a98448}{spe} == pass)
1594                 \textcolor{keywordflow}{goto} gotit; \textcolor{comment}{/* two level break */}
1595 gotit:
1596         \textcolor{keywordflow}{if} (coffers) \{
1597         verbalize(\textcolor{stringliteral}{"Thank you for your contribution to reduce the debt."});
1598             (void) add\_to\_container(coffers, goldob);
1599             coffers->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt} = weight(coffers);
1600         \} \textcolor{keywordflow}{else} \{
1601             \textcolor{keyword}{struct }\hyperlink{structmonst}{monst} *mon = makemon(courtmon(),
1602                         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}, \hyperlink{hack_8h_ae449582f467baa0da531a6ea116a18f2}{NO\_MM\_FLAGS});
1603             \textcolor{keywordflow}{if} (mon) \{
1604 \textcolor{preprocessor}{#ifndef GOLDOBJ}
1605             mon->\hyperlink{structmonst_a06dbdd0ca7ee096216aa10f86beed533}{mgold} += goldob->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan};
1606             delobj(goldob);
1607             pline(\textcolor{stringliteral}{"The exchequer accepts your contribution."});
1608             \} \textcolor{keywordflow}{else} \{
1609             dropx(goldob);
1610             \}
1611         \}
1612         \} \textcolor{keywordflow}{else} \{
1613         dropx(goldob);
1614 \textcolor{preprocessor}{#else}
1615             add\_to\_minv(mon, goldob);
1616             pline(\textcolor{stringliteral}{"The exchequer accepts your contribution."});
1617             \} \textcolor{keywordflow}{else} \{
1618             dropy(goldob);
1619             \}
1620         \}
1621         \} \textcolor{keywordflow}{else} \{
1622         dropy(goldob);
1623 \textcolor{preprocessor}{#endif}
1624         pline(\textcolor{stringliteral}{"Ok, now there is loot here."});
1625         \}
1626     \}
1627     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{rm_8h_afbd588a43f63eed969dba4f111301538}{IS\_GRAVE}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[cc.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}][cc.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}].typ)) \{
1628     You(\textcolor{stringliteral}{"need to dig up the grave to effectively loot it..."});
1629     \}
1630     \textcolor{comment}{/*}
1631 \textcolor{comment}{     * 3.3.1 introduced directional looting for some things.}
1632 \textcolor{comment}{     */}
1633     \textcolor{keywordflow}{if} (c != \textcolor{charliteral}{'y'} && \hyperlink{pickup_8c_a58b59552076730fea752be5055c7d1b7}{mon\_beside}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy})) \{
1634     \textcolor{keywordflow}{if} (!get\_adjacent\_loc(\textcolor{stringliteral}{"Loot in what direction?"}, \textcolor{stringliteral}{"Invalid loot location"},
1635             \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}, &cc)) \textcolor{keywordflow}{return} 0;
1636     \textcolor{keywordflow}{if} (cc.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x} == \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux} && cc.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y} == \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}) \{
1637         underfoot = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1638         \textcolor{keywordflow}{if} (\hyperlink{pickup_8c_a060256bdbd95b33a4806cf58d95cdb25}{container\_at}(cc.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}, cc.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}))
1639         \textcolor{keywordflow}{goto} lootcont;
1640     \} \textcolor{keywordflow}{else}
1641         underfoot = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1642     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a3fa7dbf98dab7ca2c40195268174c45f}{dz} < 0) \{
1643         You(\textcolor{stringliteral}{"%s to loot on the %s."}, dont\_find\_anything,
1644         ceiling(cc.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}, cc.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}));
1645         timepassed = 1;
1646         \textcolor{keywordflow}{return} timepassed;
1647     \}
1648     mtmp = \hyperlink{rm_8h_a4d8dddf3df3fad65478980d2c8cbf53c}{m\_at}(cc.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}, cc.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y});
1649     \textcolor{keywordflow}{if} (mtmp) timepassed = \hyperlink{pickup_8c_af864ece40ccded6527e66267c718e375}{loot\_mon}(mtmp, &prev\_inquiry, &prev\_loot);
1650 
1651     \textcolor{comment}{/* Preserve pre-3.3.1 behaviour for containers.}
1652 \textcolor{comment}{     * Adjust this if-block to allow container looting}
1653 \textcolor{comment}{     * from one square away to change that in the future.}
1654 \textcolor{comment}{     */}
1655     \textcolor{keywordflow}{if} (!underfoot) \{
1656         \textcolor{keywordflow}{if} (\hyperlink{pickup_8c_a060256bdbd95b33a4806cf58d95cdb25}{container\_at}(cc.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}, cc.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE})) \{
1657         \textcolor{keywordflow}{if} (mtmp) \{
1658             You\_cant(\textcolor{stringliteral}{"loot anything %sthere with %s in the way."},
1659                 prev\_inquiry ? \textcolor{stringliteral}{"else "} : \textcolor{stringliteral}{""}, mon\_nam(mtmp));
1660             \textcolor{keywordflow}{return} timepassed;
1661         \} \textcolor{keywordflow}{else} \{
1662             You(\textcolor{stringliteral}{"have to be at a container to loot it."});
1663         \}
1664         \} \textcolor{keywordflow}{else} \{
1665         You(\textcolor{stringliteral}{"%s %sthere to loot."}, dont\_find\_anything,
1666             (prev\_inquiry || prev\_loot) ? \textcolor{stringliteral}{"else "} : \textcolor{stringliteral}{""});
1667         \textcolor{keywordflow}{return} timepassed;
1668         \}
1669     \}
1670     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (c != \textcolor{charliteral}{'y'} && c != \textcolor{charliteral}{'n'}) \{
1671     You(\textcolor{stringliteral}{"%s %s to loot."}, dont\_find\_anything,
1672             underfoot ? \textcolor{stringliteral}{"here"} : \textcolor{stringliteral}{"there"});
1673     \}
1674     \textcolor{keywordflow}{return} (timepassed);
1675 \}
\end{DoxyCode}
\hypertarget{pickup_8c_aed29b02f27db47b69b5ef129bf56e102}{\index{pickup.\+c@{pickup.\+c}!encumber\+\_\+msg@{encumber\+\_\+msg}}
\index{encumber\+\_\+msg@{encumber\+\_\+msg}!pickup.\+c@{pickup.\+c}}
\subsubsection[{encumber\+\_\+msg}]{\setlength{\rightskip}{0pt plus 5cm}int encumber\+\_\+msg (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_aed29b02f27db47b69b5ef129bf56e102}


Definition at line 1405 of file pickup.\+c.



References flag\+::botl, monst\+::data, flags, U\+N\+E\+N\+C\+U\+M\+B\+E\+R\+E\+D, and youmonst.



Referenced by fix\+\_\+worst\+\_\+trouble(), thitmonst(), and throwit().


\begin{DoxyCode}
1406 \{
1407     \textcolor{keyword}{static} \textcolor{keywordtype}{int} oldcap = \hyperlink{hack_8h_a10ca5b6266edcafafcefcbe4b08182cd}{UNENCUMBERED};
1408     \textcolor{keywordtype}{int} newcap = near\_capacity();
1409 
1410     \textcolor{keywordflow}{if}(oldcap < newcap) \{
1411     \textcolor{keywordflow}{switch}(newcap) \{
1412     \textcolor{keywordflow}{case} 1: Your(\textcolor{stringliteral}{"movements are slowed slightly because of your load."});
1413         \textcolor{keywordflow}{break};
1414     \textcolor{keywordflow}{case} 2: You(\textcolor{stringliteral}{"rebalance your load.  Movement is difficult."});
1415         \textcolor{keywordflow}{break};
1416     \textcolor{keywordflow}{case} 3: You(\textcolor{stringliteral}{"%s under your heavy load.  Movement is very hard."},
1417             stagger(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}, \textcolor{stringliteral}{"stagger"}));
1418         \textcolor{keywordflow}{break};
1419     \textcolor{keywordflow}{default}: You(\textcolor{stringliteral}{"%s move a handspan with this load!"},
1420              newcap == 4 ? \textcolor{stringliteral}{"can barely"} : \textcolor{stringliteral}{"can't even"});
1421         \textcolor{keywordflow}{break};
1422     \}
1423     \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a51f16d01a910b52fdf0c05a44739f7d8}{botl} = 1;
1424     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(oldcap > newcap) \{
1425     \textcolor{keywordflow}{switch}(newcap) \{
1426     \textcolor{keywordflow}{case} 0: Your(\textcolor{stringliteral}{"movements are now unencumbered."});
1427         \textcolor{keywordflow}{break};
1428     \textcolor{keywordflow}{case} 1: Your(\textcolor{stringliteral}{"movements are only slowed slightly by your load."});
1429         \textcolor{keywordflow}{break};
1430     \textcolor{keywordflow}{case} 2: You(\textcolor{stringliteral}{"rebalance your load.  Movement is still difficult."});
1431         \textcolor{keywordflow}{break};
1432     \textcolor{keywordflow}{case} 3: You(\textcolor{stringliteral}{"%s under your load.  Movement is still very hard."},
1433             stagger(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}, \textcolor{stringliteral}{"stagger"}));
1434         \textcolor{keywordflow}{break};
1435     \}
1436     \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a51f16d01a910b52fdf0c05a44739f7d8}{botl} = 1;
1437     \}
1438 
1439     oldcap = newcap;
1440     \textcolor{keywordflow}{return} (newcap);
1441 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a9c6a606ae174d0b8480f4bfbe2274728}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf simple\+\_\+look}}]{, }
\item[{(struct {\bf obj} $\ast$, {\bf B\+O\+O\+L\+E\+A\+N\+\_\+\+P})}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a9c6a606ae174d0b8480f4bfbe2274728}


Referenced by query\+\_\+classes(), and use\+\_\+container().

\hypertarget{pickup_8c_aa19af8d41f34d334fbb493a319908c0c}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf query\+\_\+classes}}]{, }
\item[{(char $\ast$, {\bf boolean} $\ast$, {\bf boolean} $\ast$, {\bf const} char $\ast$, struct {\bf obj} $\ast$, {\bf B\+O\+O\+L\+E\+A\+N\+\_\+\+P}, {\bf B\+O\+O\+L\+E\+A\+N\+\_\+\+P}, int $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_aa19af8d41f34d334fbb493a319908c0c}
\hypertarget{pickup_8c_a3057552a80506a990c4af609a0164caa}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf check\+\_\+here}}]{, }
\item[{({\bf B\+O\+O\+L\+E\+A\+N\+\_\+\+P})}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a3057552a80506a990c4af609a0164caa}
\hypertarget{pickup_8c_a8bebeba5a73dc074034cfe581c6e333d}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf n\+\_\+or\+\_\+more}}]{, }
\item[{(struct {\bf obj} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a8bebeba5a73dc074034cfe581c6e333d}
\hypertarget{pickup_8c_a10d938c4e3a5270e9e6363a2072e0495}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf all\+\_\+but\+\_\+uchain}}]{, }
\item[{(struct {\bf obj} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a10d938c4e3a5270e9e6363a2072e0495}
\hypertarget{pickup_8c_ad13167bc13c399e1f4fe3bb3633c6888}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf autopick}}]{, }
\item[{(struct {\bf obj} $\ast$, int, {\bf menu\+\_\+item} $\ast$$\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_ad13167bc13c399e1f4fe3bb3633c6888}
\hypertarget{pickup_8c_ae89ff2187b96d3605de4925cc0b90b46}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf count\+\_\+categories}}]{, }
\item[{(struct {\bf obj} $\ast$, int)}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_ae89ff2187b96d3605de4925cc0b90b46}
\hypertarget{pickup_8c_a9d65a12813ff433c2307a60c4894ff58}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} long F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf carry\+\_\+count}}]{, }
\item[{(struct {\bf obj} $\ast$, struct {\bf obj} $\ast$, long, {\bf B\+O\+O\+L\+E\+A\+N\+\_\+\+P}, int $\ast$, int $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a9d65a12813ff433c2307a60c4894ff58}
\hypertarget{pickup_8c_a29defa5be61f9babb28073eae85c3e77}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf lift\+\_\+object}}]{, }
\item[{(struct {\bf obj} $\ast$, struct {\bf obj} $\ast$, long $\ast$, {\bf B\+O\+O\+L\+E\+A\+N\+\_\+\+P})}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a29defa5be61f9babb28073eae85c3e77}
\hypertarget{pickup_8c_ab965b71b37608a3ceccfb71c87ef5dc8}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf mbag\+\_\+explodes}}]{, }
\item[{(struct {\bf obj} $\ast$, int)}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_ab965b71b37608a3ceccfb71c87ef5dc8}
\hypertarget{pickup_8c_ae617f9b13161d43769f1bf943b6141d4}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+P\+T\+R} int F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf in\+\_\+container}}]{, }
\item[{(struct {\bf obj} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_ae617f9b13161d43769f1bf943b6141d4}
\hypertarget{pickup_8c_aaac875371dc984c0754a0bd61e8ca695}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+P\+T\+R} int F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf ck\+\_\+bag}}]{, }
\item[{(struct {\bf obj} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_aaac875371dc984c0754a0bd61e8ca695}
\hypertarget{pickup_8c_a61a660352b106d4d5af7880180dbfb1e}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+P\+T\+R} int F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf out\+\_\+container}}]{, }
\item[{(struct {\bf obj} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a61a660352b106d4d5af7880180dbfb1e}
\hypertarget{pickup_8c_a83a1fb5f2be62d32e22fb257601653ae}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} long F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf mbag\+\_\+item\+\_\+gone}}]{, }
\item[{(int, struct {\bf obj} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a83a1fb5f2be62d32e22fb257601653ae}
\hypertarget{pickup_8c_a5b91c3ec3ab0433734af32e474513b90}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf observe\+\_\+quantum\+\_\+cat}}]{, }
\item[{(struct {\bf obj} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a5b91c3ec3ab0433734af32e474513b90}
\hypertarget{pickup_8c_a26e29ed722746e24ae30b12fa78f4371}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf menu\+\_\+loot}}]{, }
\item[{(int, struct {\bf obj} $\ast$, {\bf B\+O\+O\+L\+E\+A\+N\+\_\+\+P})}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a26e29ed722746e24ae30b12fa78f4371}
\hypertarget{pickup_8c_ad65b64ed7d041d5c56ee0951f6a5ebdf}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf in\+\_\+or\+\_\+out\+\_\+menu}}]{, }
\item[{({\bf const} char $\ast$, struct {\bf obj} $\ast$, {\bf B\+O\+O\+L\+E\+A\+N\+\_\+\+P}, {\bf B\+O\+O\+L\+E\+A\+N\+\_\+\+P})}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_ad65b64ed7d041d5c56ee0951f6a5ebdf}
\hypertarget{pickup_8c_a4fca29e81857a14274f9f1aca18a9c88}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf container\+\_\+at}}]{, }
\item[{(int, int, {\bf B\+O\+O\+L\+E\+A\+N\+\_\+\+P})}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a4fca29e81857a14274f9f1aca18a9c88}
\hypertarget{pickup_8c_a96fa8f337828283d6d95912e4d1dfdab}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf able\+\_\+to\+\_\+loot}}]{, }
\item[{(int, int)}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a96fa8f337828283d6d95912e4d1dfdab}
\hypertarget{pickup_8c_a64b6434e90a167497ee5731349ae7d8a}{\index{pickup.\+c@{pickup.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!pickup.\+c@{pickup.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf mon\+\_\+beside}}]{, }
\item[{(int, int)}]{}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a64b6434e90a167497ee5731349ae7d8a}
\hypertarget{pickup_8c_a8344ebfadcf90f594ad92856f5a1467d}{\index{pickup.\+c@{pickup.\+c}!in\+\_\+container@{in\+\_\+container}}
\index{in\+\_\+container@{in\+\_\+container}!pickup.\+c@{pickup.\+c}}
\subsubsection[{in\+\_\+container}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+P\+T\+R} int in\+\_\+container (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{obj}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a8344ebfadcf90f594ad92856f5a1467d}


Definition at line 1769 of file pickup.\+c.



References age\+\_\+is\+\_\+relative, bigmonst, buf, B\+U\+F\+S\+Z, carried, C\+O\+I\+N\+\_\+\+C\+L\+A\+S\+S, monst\+::data, display\+\_\+nhwindow, F\+A\+L\+S\+E, Icebox, Is\+\_\+box, Is\+\_\+mbag, K\+I\+L\+L\+E\+D\+\_\+\+B\+Y\+\_\+\+A\+N, mbag\+\_\+explodes(), mons, monstermoves, obj\+::owt, obj\+::ox, obj\+::oy, panic(), plur, obj\+::quan, R\+E\+V\+I\+V\+E\+\_\+\+M\+O\+N, R\+O\+T\+\_\+\+C\+O\+R\+P\+S\+E, S\+E\+L\+L\+\_\+\+D\+E\+L\+I\+B\+E\+R\+A\+T\+E, S\+E\+L\+L\+\_\+\+N\+O\+R\+M\+A\+L, setuqwep(), setuswapwep(), setuwep(), something, Stone\+\_\+resistance, Strcpy, touch\+\_\+petrifies, T\+R\+U\+E, u, uarmg, uball, uchain, uquiver, uswapwep, uwep, you\+::ux, you\+::uy, W\+\_\+\+A\+M\+U\+L, W\+\_\+\+A\+R\+M\+O\+R, W\+\_\+\+R\+I\+N\+G, W\+\_\+\+T\+O\+O\+L, welded(), weldmsg(), W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E, and youmonst.



Referenced by menu\+\_\+loot(), and use\+\_\+container().


\begin{DoxyCode}
1771 \{
1772     \textcolor{keywordtype}{boolean} floor\_container = !\hyperlink{obj_8h_a4adde9a5428fde9b6faf64253a1507e8}{carried}(\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container});
1773     \textcolor{keywordtype}{boolean} was\_unpaid = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1774     \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
1775 
1776     \textcolor{keywordflow}{if} (!\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}) \{
1777         impossible(\textcolor{stringliteral}{"<in> no current\_container?"});
1778         \textcolor{keywordflow}{return} 0;
1779     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj == \hyperlink{decl_8h_a043dece512e3c566986d7cfabc52d05e}{uball} || obj == \hyperlink{decl_8h_ac83f46f409b88c6d6109ed04938ad52a}{uchain}) \{
1780         You(\textcolor{stringliteral}{"must be kidding."});
1781         \textcolor{keywordflow}{return} 0;
1782     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj == \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}) \{
1783         pline(\textcolor{stringliteral}{"That would be an interesting topological exercise."});
1784         \textcolor{keywordflow}{return} 0;
1785     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a7906e045755ba4099705764a4eb076c6}{owornmask} & (\hyperlink{prop_8h_afb4c914cfecbde6972d893bc33e10aa9}{W\_ARMOR} | \hyperlink{prop_8h_a855614df1627862ffc73bf31e283b7b9}{W\_RING} | \hyperlink{prop_8h_a1a4f9d6f31538cc9d677e617b49597d2}{W\_AMUL} | 
      \hyperlink{prop_8h_ac2c824bec7fcb9f986b9e905d1f5ee8a}{W\_TOOL})) \{
1786         Norep(\textcolor{stringliteral}{"You cannot %s %s you are wearing."},
1787             \hyperlink{pickup_8c_a03ae3a6955e4b11872783e4350243305}{Icebox} ? \textcolor{stringliteral}{"refrigerate"} : \textcolor{stringliteral}{"stash"}, \hyperlink{decl_8h_aa5c50bde0d16d15a08d32d8df49a80ae}{something});
1788         \textcolor{keywordflow}{return} 0;
1789     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == LOADSTONE) && obj->cursed) \{
1790         obj->bknown = 1;
1791           pline\_The(\textcolor{stringliteral}{"stone%s won't leave your person."}, \hyperlink{hack_8h_a6ed0ab51b12ebf31e060e3dd26394db0}{plur}(obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan}));
1792         \textcolor{keywordflow}{return} 0;
1793     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == AMULET\_OF\_YENDOR ||
1794            obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == CANDELABRUM\_OF\_INVOCATION ||
1795            obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == BELL\_OF\_OPENING ||
1796            obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == SPE\_BOOK\_OF\_THE\_DEAD) \{
1797     \textcolor{comment}{/* Prohibit Amulets in containers; if you allow it, monsters can't}
1798 \textcolor{comment}{     * steal them.  It also becomes a pain to check to see if someone}
1799 \textcolor{comment}{     * has the Amulet.  Ditto for the Candelabrum, the Bell and the Book.}
1800 \textcolor{comment}{     */}
1801         pline(\textcolor{stringliteral}{"%s cannot be confined in such trappings."}, The(xname(obj)));
1802         \textcolor{keywordflow}{return} 0;
1803     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == LEASH && obj->leashmon != 0) \{
1804         pline(\textcolor{stringliteral}{"%s attached to your pet."}, Tobjnam(obj, \textcolor{stringliteral}{"are"}));
1805         \textcolor{keywordflow}{return} 0;
1806     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj == \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}) \{
1807         \textcolor{keywordflow}{if} (\hyperlink{wield_8c_ade2321e11c702d69c6fd7b261ae62040}{welded}(obj)) \{
1808             \hyperlink{wield_8c_acf3b9dae627bf80b5565774296f5b9a9}{weldmsg}(obj);
1809             \textcolor{keywordflow}{return} 0;
1810         \}
1811         \hyperlink{wield_8c_adc7f46a6707f98835bb3c181d7ae1821}{setuwep}((\textcolor{keyword}{struct} obj *) 0);
1812         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}) \textcolor{keywordflow}{return} 0; \textcolor{comment}{/* unwielded, died, rewielded */}
1813     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj == \hyperlink{decl_8h_ab2586a729017fc01f4612808c80c1945}{uswapwep}) \{
1814         \hyperlink{wield_8c_a88ffb17424a5f0e8fb61b20d02811959}{setuswapwep}((\textcolor{keyword}{struct} obj *) 0);
1815         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_ab2586a729017fc01f4612808c80c1945}{uswapwep}) \textcolor{keywordflow}{return} 0;     \textcolor{comment}{/* unwielded, died, rewielded */}
1816     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj == \hyperlink{decl_8h_a7544f9c7591e79476549f321400d269b}{uquiver}) \{
1817         \hyperlink{wield_8c_a6004112a6fc3b435bb2cff99c8b884d3}{setuqwep}((\textcolor{keyword}{struct} obj *) 0);
1818         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a7544f9c7591e79476549f321400d269b}{uquiver}) \textcolor{keywordflow}{return} 0;     \textcolor{comment}{/* unwielded, died, rewielded */}
1819     \}
1820 
1821     \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == CORPSE) \{
1822         \textcolor{keywordflow}{if} ( (\hyperlink{mondata_8h_ad1e85e493d27cdfdbe94c43710c4b191}{touch\_petrifies}(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[obj->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm}])) && !
      \hyperlink{decl_8h_a374ab5e4582cfafa2d4ef57211f53293}{uarmg}
1823          && !\hyperlink{youprop_8h_a90b638323d50e1f8d52d4a9576d90551}{Stone\_resistance}) \{
1824         \textcolor{keywordflow}{if} (poly\_when\_stoned(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) && polymon(PM\_STONE\_GOLEM))
1825             \hyperlink{winprocs_8h_ac8e74d03fbb65b9f5651e63d79bebc60}{display\_nhwindow}(\hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1826         \textcolor{keywordflow}{else} \{
1827             \textcolor{keywordtype}{char} kbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
1828 
1829             \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(kbuf, an(corpse\_xname(obj, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE})));
1830             pline(\textcolor{stringliteral}{"Touching %s is a fatal mistake."}, kbuf);
1831             instapetrify(kbuf);
1832             \textcolor{keywordflow}{return} -1;
1833         \}
1834         \}
1835     \}
1836 
1837     \textcolor{comment}{/* boxes, boulders, and big statues can't fit into any container */}
1838     \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == ICE\_BOX || \hyperlink{obj_8h_a670bbe6ea7092fc0194149cc57131af9}{Is\_box}(obj) || obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == BOULDER ||
1839         (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == STATUE && \hyperlink{mondata_8h_a28750a402487965f08dcce597c8af6be}{bigmonst}(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[obj->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm}]))) \{
1840         \textcolor{comment}{/*}
1841 \textcolor{comment}{         *  xname() uses a static result array.  Save obj's name}
1842 \textcolor{comment}{         *  before current\_container's name is computed.  Don't}
1843 \textcolor{comment}{         *  use the result of strcpy() within You() --- the order}
1844 \textcolor{comment}{         *  of evaluation of the parameters is undefined.}
1845 \textcolor{comment}{         */}
1846         \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(buf, the(xname(obj)));
1847         You(\textcolor{stringliteral}{"cannot fit %s into %s."}, buf,
1848             the(xname(\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container})));
1849         \textcolor{keywordflow}{return} 0;
1850     \}
1851 
1852     freeinv(obj);
1853 
1854     \textcolor{keywordflow}{if} (obj\_is\_burning(obj))    \textcolor{comment}{/* this used to be part of freeinv() */}
1855         (void) snuff\_lit(obj);
1856 
1857     \textcolor{keywordflow}{if} (floor\_container && costly\_spot(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy})) \{
1858         \textcolor{keywordflow}{if} (\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}->no\_charge && !obj->unpaid) \{
1859         \textcolor{comment}{/* don't sell when putting the item into your own container */}
1860         obj->no\_charge = 1;
1861         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} != \hyperlink{objclass_8h_a2999621925083659147349e261e4cb3d}{COIN\_CLASS}) \{
1862         \textcolor{comment}{/* sellobj() will take an unpaid item off the shop bill}
1863 \textcolor{comment}{         * note: coins are handled later */}
1864         was\_unpaid = obj->unpaid ? \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} : \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1865         sellobj\_state(\hyperlink{hack_8h_adad95ebfac63f6d0f5de05d085dad5d0}{SELL\_DELIBERATE});
1866         sellobj(obj, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy});
1867         sellobj\_state(\hyperlink{hack_8h_a3f1fa6b635439b52479ed0c4fb09cd98}{SELL\_NORMAL});
1868         \}
1869     \}
1870     \textcolor{keywordflow}{if} (\hyperlink{pickup_8c_a03ae3a6955e4b11872783e4350243305}{Icebox} && !\hyperlink{obj_8h_aab158d4d170eadd4e9307f92834eaa32}{age\_is\_relative}(obj)) \{
1871         obj->\hyperlink{structobj_a3dd6f7cf99f6a946d0ca406cfca5c23d}{age} = \hyperlink{decl_8h_a75c1f008487d95630d0d789a79bb5c74}{monstermoves} - obj->\hyperlink{structobj_a3dd6f7cf99f6a946d0ca406cfca5c23d}{age}; \textcolor{comment}{/* actual age */}
1872         \textcolor{comment}{/* stop any corpse timeouts when frozen */}
1873         \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == CORPSE && obj->\hyperlink{structobj_a1606b78f4b7e85536033e77348551f5f}{timed}) \{
1874             \textcolor{keywordtype}{long} rot\_alarm = stop\_timer(\hyperlink{timeout_8h_a006aabd2b0d9c11823e3c80ea196cb2b}{ROT\_CORPSE}, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})obj);
1875             (void) stop\_timer(\hyperlink{timeout_8h_aa4f4a657985f1ca1f8fcdc6d271b3b0c}{REVIVE\_MON}, (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})obj);
1876             \textcolor{comment}{/* mark a non-reviving corpse as such */}
1877             \textcolor{keywordflow}{if} (rot\_alarm) obj->norevive = 1;
1878         \}
1879     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{obj_8h_a65c82dd474ed0d93e446ac4870fd3c35}{Is\_mbag}(\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}) && 
      \hyperlink{pickup_8c_a80e990e904b2e1279e053d82311f0900}{mbag\_explodes}(obj, 0)) \{
1880         \textcolor{comment}{/* explicitly mention what item is triggering the explosion */}
1881         pline(
1882           \textcolor{stringliteral}{"As you put %s inside, you are blasted by a magical explosion!"},
1883               doname(obj));
1884         \textcolor{comment}{/* did not actually insert obj yet */}
1885         \textcolor{keywordflow}{if} (was\_unpaid) addtobill(obj, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
1886         obfree(obj, (\textcolor{keyword}{struct} obj *)0);
1887         delete\_contents(\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container});
1888         \textcolor{keywordflow}{if} (!floor\_container)
1889             useup(\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container});
1890         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj\_here(\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}))
1891             useupf(\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}, obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan});
1892         \textcolor{keywordflow}{else}
1893             \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"in\_container:  bag not found."});
1894 
1895         losehp(d(6,6),\textcolor{stringliteral}{"magical explosion"}, \hyperlink{decl_8h_af4e54910b730baa32b2dfbe4dd2942c1}{KILLED\_BY\_AN});
1896         \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container} = 0; \textcolor{comment}{/* baggone = TRUE; */}
1897     \}
1898 
1899     \textcolor{keywordflow}{if} (\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}) \{
1900         \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(buf, the(xname(\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container})));
1901         You(\textcolor{stringliteral}{"put %s into %s."}, doname(obj), buf);
1902 
1903         \textcolor{comment}{/* gold in container always needs to be added to credit */}
1904         \textcolor{keywordflow}{if} (floor\_container && obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == \hyperlink{objclass_8h_a2999621925083659147349e261e4cb3d}{COIN\_CLASS})
1905         sellobj(obj, \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}->\hyperlink{structobj_aac936c7da6b4f1eca0a94f75c242e5cc}{ox}, \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}->
      \hyperlink{structobj_a72dace5e678b56ae42c3fb19292e5839}{oy});
1906         (void) add\_to\_container(\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}, obj);
1907         \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt} = weight(\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container});
1908     \}
1909     \textcolor{comment}{/* gold needs this, and freeinv() many lines above may cause}
1910 \textcolor{comment}{     * the encumbrance to disappear from the status, so just always}
1911 \textcolor{comment}{     * update status immediately.}
1912 \textcolor{comment}{     */}
1913     bot();
1914 
1915     \textcolor{keywordflow}{return}(\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container} ? 1 : -1);
1916 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a129d64e6943eb249b60f861442aad5e0}{\index{pickup.\+c@{pickup.\+c}!in\+\_\+or\+\_\+out\+\_\+menu@{in\+\_\+or\+\_\+out\+\_\+menu}}
\index{in\+\_\+or\+\_\+out\+\_\+menu@{in\+\_\+or\+\_\+out\+\_\+menu}!pickup.\+c@{pickup.\+c}}
\subsubsection[{in\+\_\+or\+\_\+out\+\_\+menu}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int in\+\_\+or\+\_\+out\+\_\+menu (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{prompt, }
\item[{struct {\bf obj} $\ast$}]{obj, }
\item[{{\bf boolean}}]{outokay, }
\item[{{\bf boolean}}]{inokay}
\end{DoxyParamCaption}
) const}}\label{pickup_8c_a129d64e6943eb249b60f861442aad5e0}


Definition at line 2374 of file pickup.\+c.



References any\+::a\+\_\+int, any\+::a\+\_\+void, add\+\_\+menu, A\+T\+R\+\_\+\+N\+O\+N\+E, buf, B\+U\+F\+S\+Z, create\+\_\+nhwindow, destroy\+\_\+nhwindow, end\+\_\+menu, free(), iflags, mi\+::item, instance\+\_\+flags\+::lootabc, M\+E\+N\+U\+\_\+\+U\+N\+S\+E\+L\+E\+C\+T\+E\+D, N\+H\+W\+\_\+\+M\+E\+N\+U, N\+O\+\_\+\+G\+L\+Y\+P\+H, P\+I\+C\+K\+\_\+\+O\+N\+E, select\+\_\+menu, something, Sprintf, and start\+\_\+menu.



Referenced by use\+\_\+container().


\begin{DoxyCode}
2378 \{
2379     \hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} win;
2380     \hyperlink{unionany}{anything} \hyperlink{unionany}{any};
2381     \hyperlink{structmi}{menu\_item} *pick\_list;
2382     \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
2383     \textcolor{keywordtype}{int} n;
2384     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *menuselector = \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_a4e7bf81f6c7abf2059b03f6cb3287690}{lootabc} ? \textcolor{stringliteral}{"abc"} : \textcolor{stringliteral}{"oib"};
2385 
2386     any.\hyperlink{unionany_a570c320f6790aab4b51733abc54827d7}{a\_void} = 0;
2387     win = \hyperlink{winprocs_8h_aa13fb35379049d1836397492d10b6b0c}{create\_nhwindow}(\hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU});
2388     \hyperlink{winprocs_8h_a466fbda9d8533b050350184f5a095617}{start\_menu}(win);
2389     \textcolor{keywordflow}{if} (outokay) \{
2390     any.\hyperlink{unionany_aae9fa40e12da390154868ea24a96c561}{a\_int} = 1;
2391     \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(buf,\textcolor{stringliteral}{"Take %s out of %s"}, \hyperlink{decl_8h_aa5c50bde0d16d15a08d32d8df49a80ae}{something}, the(xname(obj)));
2392     \hyperlink{winprocs_8h_a67d909f9e2dbdf82e7af48ed950c0e07}{add\_menu}(win, \hyperlink{display_8h_ac36b9cc8436af3cf1f7f9919878d8354}{NO\_GLYPH}, &any, *menuselector, 0, \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE},
2393             buf, \hyperlink{hack_8h_a1b4cfefbc89386fb8977794f02b0a13c}{MENU\_UNSELECTED});
2394     \}
2395     menuselector++;
2396     \textcolor{keywordflow}{if} (inokay) \{
2397     any.\hyperlink{unionany_aae9fa40e12da390154868ea24a96c561}{a\_int} = 2;
2398     \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(buf,\textcolor{stringliteral}{"Put %s into %s"}, \hyperlink{decl_8h_aa5c50bde0d16d15a08d32d8df49a80ae}{something}, the(xname(obj)));
2399     \hyperlink{winprocs_8h_a67d909f9e2dbdf82e7af48ed950c0e07}{add\_menu}(win, \hyperlink{display_8h_ac36b9cc8436af3cf1f7f9919878d8354}{NO\_GLYPH}, &any, *menuselector, 0, \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE}, buf, 
      \hyperlink{hack_8h_a1b4cfefbc89386fb8977794f02b0a13c}{MENU\_UNSELECTED});
2400     \}
2401     menuselector++;
2402     \textcolor{keywordflow}{if} (outokay && inokay) \{
2403     any.\hyperlink{unionany_aae9fa40e12da390154868ea24a96c561}{a\_int} = 3;
2404     \hyperlink{winprocs_8h_a67d909f9e2dbdf82e7af48ed950c0e07}{add\_menu}(win, \hyperlink{display_8h_ac36b9cc8436af3cf1f7f9919878d8354}{NO\_GLYPH}, &any, *menuselector, 0, \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE},
2405             \textcolor{stringliteral}{"Both of the above"}, \hyperlink{hack_8h_a1b4cfefbc89386fb8977794f02b0a13c}{MENU\_UNSELECTED});
2406     \}
2407     \hyperlink{winprocs_8h_a26f49f5dfc880f4a810f61b5beae4a71}{end\_menu}(win, prompt);
2408     n = \hyperlink{winprocs_8h_afdaac8ee2b6bdd0a0045b81a0cfbe1fc}{select\_menu}(win, \hyperlink{wintype_8h_a53377e7b2fddfaf7cc2351dab3b2b139}{PICK\_ONE}, &pick\_list);
2409     \hyperlink{winprocs_8h_a77ac4f50de0eedeaead791812762c6a0}{destroy\_nhwindow}(win);
2410     \textcolor{keywordflow}{if} (n > 0) \{
2411     n = pick\_list[0].\hyperlink{structmi_a24f26cd1b01d3cf3ed16b1fd020d3a08}{item}.\hyperlink{unionany_aae9fa40e12da390154868ea24a96c561}{a\_int};
2412     \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) pick\_list);
2413     \}
2414     \textcolor{keywordflow}{return} n;
2415 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a818a4690d3e1e2dacdba758181ff7228}{\index{pickup.\+c@{pickup.\+c}!is\+\_\+worn\+\_\+by\+\_\+type@{is\+\_\+worn\+\_\+by\+\_\+type}}
\index{is\+\_\+worn\+\_\+by\+\_\+type@{is\+\_\+worn\+\_\+by\+\_\+type}!pickup.\+c@{pickup.\+c}}
\subsubsection[{is\+\_\+worn\+\_\+by\+\_\+type}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} is\+\_\+worn\+\_\+by\+\_\+type (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{otmp}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a818a4690d3e1e2dacdba758181ff7228}


Definition at line 364 of file pickup.\+c.



References index(), W\+\_\+\+A\+M\+U\+L, W\+\_\+\+A\+R\+M\+O\+R, W\+\_\+\+Q\+U\+I\+V\+E\+R, W\+\_\+\+R\+I\+N\+G, W\+\_\+\+S\+W\+A\+P\+W\+E\+P, W\+\_\+\+T\+O\+O\+L, and W\+\_\+\+W\+E\+P.


\begin{DoxyCode}
366 \{
367     \textcolor{keywordflow}{return}((\textcolor{keywordtype}{boolean})(!!(otmp->\hyperlink{structobj_a7906e045755ba4099705764a4eb076c6}{owornmask} &
368             (\hyperlink{prop_8h_afb4c914cfecbde6972d893bc33e10aa9}{W\_ARMOR} | \hyperlink{prop_8h_a855614df1627862ffc73bf31e283b7b9}{W\_RING} | \hyperlink{prop_8h_a1a4f9d6f31538cc9d677e617b49597d2}{W\_AMUL} | \hyperlink{prop_8h_ac2c824bec7fcb9f986b9e905d1f5ee8a}{W\_TOOL} | \hyperlink{prop_8h_abd75a55f67b13523ef4377d4eb6fb6ad}{W\_WEP} | 
      \hyperlink{prop_8h_a4571f54e71d38d81a610eaf77e5fecd9}{W\_SWAPWEP} | \hyperlink{prop_8h_a9b95d7c6e22f325a5bc0326d7673a4f4}{W\_QUIVER})))
369             && (\hyperlink{uudecode_8c_ac82f3cc16110a05458f2b2483236afb7}{index}(\hyperlink{pickup_8c_a35ecb0af10e36ef86e7a32d62e771d5c}{valid\_menu\_classes}, otmp->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass}) != (\textcolor{keywordtype}{char} *)0));
370 \}
\end{DoxyCode}
\hypertarget{pickup_8c_afc20ba70668bc135322317c55743f068}{\index{pickup.\+c@{pickup.\+c}!lift\+\_\+object@{lift\+\_\+object}}
\index{lift\+\_\+object@{lift\+\_\+object}!pickup.\+c@{pickup.\+c}}
\subsubsection[{lift\+\_\+object}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int lift\+\_\+object (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{obj, }
\item[{struct {\bf obj} $\ast$}]{container, }
\item[{long $\ast$}]{cnt\+\_\+p, }
\item[{{\bf boolean}}]{telekinesis}
\end{DoxyParamCaption}
)}}\label{pickup_8c_afc20ba70668bc135322317c55743f068}


Definition at line 1142 of file pickup.\+c.



References B\+U\+F\+S\+Z, carry\+\_\+count(), clear\+\_\+nhwindow, C\+O\+I\+N\+\_\+\+C\+L\+A\+S\+S, monst\+::data, eos(), flags, H\+A\+N\+D, H\+V\+Y\+\_\+\+E\+N\+C\+U\+M\+B\+E\+R, In\+\_\+sokoban, invent, M\+O\+D\+\_\+\+E\+N\+C\+U\+M\+B\+E\+R, flag\+::pickup\+\_\+burden, safe\+\_\+qbuf(), Sprintf, Strcpy, throws\+\_\+rocks, u, you\+::uz, W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E, ynq, and youmonst.



Referenced by out\+\_\+container(), and pickup\+\_\+object().


\begin{DoxyCode}
1146 \{
1147     \textcolor{keywordtype}{int} result, old\_wt, new\_wt, prev\_encumbr, next\_encumbr;
1148 
1149     \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == BOULDER && \hyperlink{dungeon_8h_ad19541d30218e5f3834c01d42bb381e2}{In\_sokoban}(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz})) \{
1150     You(\textcolor{stringliteral}{"cannot get your %s around this %s."},
1151             body\_part(\hyperlink{hack_8h_a701f28a9a2b5334b58333f06e27ad91f}{HAND}), xname(obj));
1152     \textcolor{keywordflow}{return} -1;
1153     \}
1154     \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == LOADSTONE ||
1155         (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == BOULDER && \hyperlink{mondata_8h_af1c84d35ae8812186eaf635bc27b37c0}{throws\_rocks}(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.
      \hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})))
1156     \textcolor{keywordflow}{return} 1;       \textcolor{comment}{/* lift regardless of current situation */}
1157 
1158     *cnt\_p = \hyperlink{pickup_8c_adff898a6bd9216fda62bee05b410ef1c}{carry\_count}(obj, container, *cnt\_p, telekinesis, &old\_wt, &new\_wt);
1159     \textcolor{keywordflow}{if} (*cnt\_p < 1L) \{
1160     result = -1;    \textcolor{comment}{/* nothing lifted */}
1161 \textcolor{preprocessor}{#ifndef GOLDOBJ}
1162     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} != \hyperlink{objclass_8h_a2999621925083659147349e261e4cb3d}{COIN\_CLASS} && inv\_cnt() >= 52 &&
1163         !merge\_choice(\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent}, obj)) \{
1164 \textcolor{preprocessor}{#else}
1165     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (inv\_cnt() >= 52 && !merge\_choice(\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent}, obj)) \{
1166 \textcolor{preprocessor}{#endif}
1167     Your(\textcolor{stringliteral}{"knapsack cannot accommodate any more items."});
1168     result = -1;    \textcolor{comment}{/* nothing lifted */}
1169     \} \textcolor{keywordflow}{else} \{
1170     result = 1;
1171     prev\_encumbr = near\_capacity();
1172     \textcolor{keywordflow}{if} (prev\_encumbr < \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_aa9b137c717124f991e9db76dea705a7d}{pickup\_burden})
1173         prev\_encumbr = \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_aa9b137c717124f991e9db76dea705a7d}{pickup\_burden};
1174     next\_encumbr = calc\_capacity(new\_wt - old\_wt);
1175     \textcolor{keywordflow}{if} (next\_encumbr > prev\_encumbr) \{
1176         \textcolor{keywordflow}{if} (telekinesis) \{
1177         result = 0; \textcolor{comment}{/* don't lift */}
1178         \} \textcolor{keywordflow}{else} \{
1179         \textcolor{keywordtype}{char} qbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
1180         \textcolor{keywordtype}{long} savequan = obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan};
1181 
1182         obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} = *cnt\_p;
1183         \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(qbuf,
1184             (next\_encumbr > \hyperlink{hack_8h_a3c8f959355dee01b09fa53cc6caf3651}{HVY\_ENCUMBER}) ? \hyperlink{pickup_8c_ac720afce691f17f08514b51d99c8e933}{overloadmsg} :
1185             (next\_encumbr > \hyperlink{hack_8h_a3c3899e355380d08f5d23828908c3679}{MOD\_ENCUMBER}) ? \hyperlink{pickup_8c_a74c9304356d6e805b16fb8cd0ad4de59}{nearloadmsg} :
1186             \hyperlink{pickup_8c_a46ed6db9f3f1bd6fbc51981cc1c3b6ce}{moderateloadmsg});
1187         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(\hyperlink{makedefs_8c_a72563303ed4b67f2a7dd9f2d15a01558}{eos}(qbuf), \textcolor{stringliteral}{" %s. Continue?"},
1188             \hyperlink{pickup_8c_adeadb81e8a48333beb5ca21a69f49edc}{safe\_qbuf}(qbuf, \textcolor{keyword}{sizeof}(\textcolor{stringliteral}{" . Continue?"}),
1189                 doname(obj), an(simple\_typename(obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp})), \textcolor{stringliteral}{"something"}));
1190         obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} = savequan;
1191         \textcolor{keywordflow}{switch} (\hyperlink{hack_8h_a104792d619a60e73407115c00499745e}{ynq}(qbuf)) \{
1192         \textcolor{keywordflow}{case} \textcolor{charliteral}{'q'}:  result = -1; \textcolor{keywordflow}{break};
1193         \textcolor{keywordflow}{case} \textcolor{charliteral}{'n'}:  result =  0; \textcolor{keywordflow}{break};
1194         \textcolor{keywordflow}{default}:   \textcolor{keywordflow}{break};   \textcolor{comment}{/* 'y' => result == 1 */}
1195         \}
1196         \hyperlink{winprocs_8h_a177c23e23d7dafb484ad58f01ae1d063}{clear\_nhwindow}(\hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE});
1197         \}
1198     \}
1199     \}
1200 
1201     \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == SCR\_SCARE\_MONSTER && result <= 0 && !container)
1202     obj->\hyperlink{structobj_a14fc8dc59e9073bfbf1e170875a98448}{spe} = 0;
1203     \textcolor{keywordflow}{return} result;
1204 \}
\end{DoxyCode}
\hypertarget{pickup_8c_af864ece40ccded6527e66267c718e375}{\index{pickup.\+c@{pickup.\+c}!loot\+\_\+mon@{loot\+\_\+mon}}
\index{loot\+\_\+mon@{loot\+\_\+mon}!pickup.\+c@{pickup.\+c}}
\subsubsection[{loot\+\_\+mon}]{\setlength{\rightskip}{0pt plus 5cm}int loot\+\_\+mon (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mtmp, }
\item[{int $\ast$}]{passed\+\_\+info, }
\item[{{\bf boolean} $\ast$}]{prev\+\_\+loot}
\end{DoxyParamCaption}
)}}\label{pickup_8c_af864ece40ccded6527e66267c718e375}


Definition at line 1680 of file pickup.\+c.



References A\+R\+T\+I\+C\+L\+E\+\_\+\+T\+H\+E, monst\+::data, F\+A\+L\+S\+E, nolimbs, otmp, obj\+::owornmask, pickup(), Q\+B\+U\+F\+S\+Z, Sprintf, S\+U\+P\+P\+R\+E\+S\+S\+\_\+\+S\+A\+D\+D\+L\+E, T\+R\+U\+E, u, update\+\_\+mon\+\_\+intrinsics(), which\+\_\+armor(), ynqchars, and youmonst.


\begin{DoxyCode}
1684 \{
1685     \textcolor{keywordtype}{int} c = -1;
1686     \textcolor{keywordtype}{int} timepassed = 0;
1687 \textcolor{preprocessor}{#ifdef STEED}
1688     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp};
1689     \textcolor{keywordtype}{char} qbuf[\hyperlink{global_8h_a1bb6bf3db7bf52ca1e9fa8fbcd6e9630}{QBUFSZ}];
1690 
1691     \textcolor{comment}{/* 3.3.1 introduced the ability to remove saddle from a steed             */}
1692     \textcolor{comment}{/*  *passed\_info is set to TRUE if a loot query was given.               */}
1693     \textcolor{comment}{/*  *prev\_loot is set to TRUE if something was actually acquired in here. */}
1694     \textcolor{keywordflow}{if} (mtmp && mtmp != \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.usteed && (otmp = \hyperlink{worn_8c_a260cadb0c77a7032f8e53716072e6cd7}{which\_armor}(mtmp, W\_SADDLE))) \{
1695     \textcolor{keywordtype}{long} unwornmask;
1696     \textcolor{keywordflow}{if} (passed\_info) *passed\_info = 1;
1697     \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(qbuf, \textcolor{stringliteral}{"Do you want to remove the saddle from %s?"},
1698         x\_monnam(mtmp, \hyperlink{decl_8h_aaded63563b8a938d1c68b3d404168c67}{ARTICLE\_THE}, (\textcolor{keywordtype}{char} *)0, \hyperlink{decl_8h_a252ac785b1ff056f716aee17a60a1c57}{SUPPRESS\_SADDLE}, 
      \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}));
1699     \textcolor{keywordflow}{if} ((c = yn\_function(qbuf, \hyperlink{decl_8h_a435ebb3887b48075c97ff301b972ba1b}{ynqchars}, \textcolor{charliteral}{'n'})) == \textcolor{charliteral}{'y'}) \{
1700         \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a9e529fc9e93948358711f5420caee8fa}{nolimbs}(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})) \{
1701             You\_cant(\textcolor{stringliteral}{"do that without limbs."}); \textcolor{comment}{/* not body\_part(HAND) */}
1702             \textcolor{keywordflow}{return} (0);
1703         \}
1704         \textcolor{keywordflow}{if} (otmp->cursed) \{
1705             You(\textcolor{stringliteral}{"can't. The saddle seems to be stuck to %s."},
1706             x\_monnam(mtmp, \hyperlink{decl_8h_aaded63563b8a938d1c68b3d404168c67}{ARTICLE\_THE}, (\textcolor{keywordtype}{char} *)0,
1707                 \hyperlink{decl_8h_a252ac785b1ff056f716aee17a60a1c57}{SUPPRESS\_SADDLE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}));
1708                 
1709             \textcolor{comment}{/* the attempt costs you time */}
1710             \textcolor{keywordflow}{return} (1);
1711         \}
1712         obj\_extract\_self(otmp);
1713         \textcolor{keywordflow}{if} ((unwornmask = otmp->\hyperlink{structobj_a7906e045755ba4099705764a4eb076c6}{owornmask}) != 0L) \{
1714             mtmp->\hyperlink{structmonst_afc2bd39e2f3e797e15bea20ac7f69788}{misc\_worn\_check} &= ~unwornmask;
1715             otmp->\hyperlink{structobj_a7906e045755ba4099705764a4eb076c6}{owornmask} = 0L;
1716             \hyperlink{worn_8c_af698b30adfe86cacfe152fa4010d46c8}{update\_mon\_intrinsics}(mtmp, otmp, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1717         \}
1718         otmp = hold\_another\_object(otmp, \textcolor{stringliteral}{"You drop %s!"}, doname(otmp),
1719                     (\textcolor{keyword}{const} \textcolor{keywordtype}{char} *)0);
1720         timepassed = rnd(3);
1721         \textcolor{keywordflow}{if} (prev\_loot) *prev\_loot = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1722     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (c == \textcolor{charliteral}{'q'}) \{
1723         \textcolor{keywordflow}{return} (0);
1724     \}
1725     \}
1726 \textcolor{preprocessor}{#endif  }\textcolor{comment}{/* STEED */}\textcolor{preprocessor}{}
1727     \textcolor{comment}{/* 3.4.0 introduced the ability to pick things up from within swallower's stomach */}
1728     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uswallow) \{
1729     \textcolor{keywordtype}{int} \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count} = passed\_info ? *passed\_info : 0;
1730     timepassed = \hyperlink{pickup_8c_ab9fd1f5835d6d35507a05e910e86d862}{pickup}(count);
1731     \}
1732     \textcolor{keywordflow}{return} timepassed;
1733 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a80e990e904b2e1279e053d82311f0900}{\index{pickup.\+c@{pickup.\+c}!mbag\+\_\+explodes@{mbag\+\_\+explodes}}
\index{mbag\+\_\+explodes@{mbag\+\_\+explodes}!pickup.\+c@{pickup.\+c}}
\subsubsection[{mbag\+\_\+explodes}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} mbag\+\_\+explodes (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{obj, }
\item[{int}]{depthin}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a80e990e904b2e1279e053d82311f0900}


Definition at line 1740 of file pickup.\+c.



References obj\+::cobj, F\+A\+L\+S\+E, Has\+\_\+contents, Is\+\_\+mbag, obj\+::nobj, otmp, and T\+R\+U\+E.



Referenced by in\+\_\+container().


\begin{DoxyCode}
1743 \{
1744     \textcolor{comment}{/* these won't cause an explosion when they're empty */}
1745     \textcolor{keywordflow}{if} ((obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == WAN\_CANCELLATION || obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == BAG\_OF\_TRICKS) &&
1746         obj->\hyperlink{structobj_a14fc8dc59e9073bfbf1e170875a98448}{spe} <= 0)
1747     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1748 
1749     \textcolor{comment}{/* odds: 1/1, 2/2, 3/4, 4/8, 5/16, 6/32, 7/64, 8/128, 9/128, 10/128,... */}
1750     \textcolor{keywordflow}{if} ((\hyperlink{obj_8h_a65c82dd474ed0d93e446ac4870fd3c35}{Is\_mbag}(obj) || obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == WAN\_CANCELLATION) &&
1751     (rn2(1 << (depthin > 7 ? 7 : depthin)) <= depthin))
1752     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1753     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{obj_8h_ae2e47c7280efe98de2333e8078f8ce71}{Has\_contents}(obj)) \{
1754     \textcolor{keyword}{struct }obj *\hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp};
1755 
1756     \textcolor{keywordflow}{for} (otmp = obj->\hyperlink{structobj_aa7bed832c417657c964b6f5893737586}{cobj}; otmp; otmp = otmp->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj})
1757         \textcolor{keywordflow}{if} (\hyperlink{pickup_8c_a80e990e904b2e1279e053d82311f0900}{mbag\_explodes}(otmp, depthin+1)) \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1758     \}
1759     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1760 \}
\end{DoxyCode}
\hypertarget{pickup_8c_ab1de57e2933948819d5dc58d696d18e0}{\index{pickup.\+c@{pickup.\+c}!mbag\+\_\+item\+\_\+gone@{mbag\+\_\+item\+\_\+gone}}
\index{mbag\+\_\+item\+\_\+gone@{mbag\+\_\+item\+\_\+gone}!pickup.\+c@{pickup.\+c}}
\subsubsection[{mbag\+\_\+item\+\_\+gone}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} long mbag\+\_\+item\+\_\+gone (
\begin{DoxyParamCaption}
\item[{int}]{held, }
\item[{struct {\bf obj} $\ast$}]{item}
\end{DoxyParamCaption}
)}}\label{pickup_8c_ab1de57e2933948819d5dc58d696d18e0}


Definition at line 2006 of file pickup.\+c.



References Blind, T\+R\+U\+E, u, you\+::ushops, you\+::ux, and you\+::uy.



Referenced by use\+\_\+container().


\begin{DoxyCode}
2009 \{
2010     \textcolor{keyword}{struct }\hyperlink{structmonst}{monst} *shkp;
2011     \textcolor{keywordtype}{long} loss = 0L;
2012 
2013     \textcolor{keywordflow}{if} (item->dknown)
2014     pline(\textcolor{stringliteral}{"%s %s vanished!"}, Doname2(item), otense(item, \textcolor{stringliteral}{"have"}));
2015     \textcolor{keywordflow}{else}
2016     You(\textcolor{stringliteral}{"%s %s disappear!"}, \hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind} ? \textcolor{stringliteral}{"notice"} : \textcolor{stringliteral}{"see"}, doname(item));
2017 
2018     \textcolor{keywordflow}{if} (*\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a1bc3b5ca1e5d9957ab3a7f451c069f47}{ushops} && (shkp = shop\_keeper(*\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a1bc3b5ca1e5d9957ab3a7f451c069f47}{ushops})) != 0) \{
2019     \textcolor{keywordflow}{if} (held ? (\textcolor{keywordtype}{boolean}) item->unpaid : costly\_spot(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}))
2020         loss = stolen\_value(item, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy},
2021                 (\textcolor{keywordtype}{boolean})shkp->mpeaceful, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
2022     \}
2023     obfree(item, (\textcolor{keyword}{struct} \hyperlink{structobj}{obj} *) 0);
2024     \textcolor{keywordflow}{return} loss;
2025 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a8ca8f01ed38aee3209b6742d7fd4638f}{\index{pickup.\+c@{pickup.\+c}!menu\+\_\+loot@{menu\+\_\+loot}}
\index{menu\+\_\+loot@{menu\+\_\+loot}!pickup.\+c@{pickup.\+c}}
\subsubsection[{menu\+\_\+loot}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int menu\+\_\+loot (
\begin{DoxyParamCaption}
\item[{int}]{retry, }
\item[{struct {\bf obj} $\ast$}]{container, }
\item[{{\bf boolean}}]{put\+\_\+in}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a8ca8f01ed38aee3209b6742d7fd4638f}


Definition at line 2301 of file pickup.\+c.



References any\+::a\+\_\+obj, add\+\_\+valid\+\_\+menu\+\_\+class(), A\+L\+L\+\_\+\+T\+Y\+P\+E\+S, A\+L\+L\+\_\+\+T\+Y\+P\+E\+S\+\_\+\+S\+E\+L\+E\+C\+T\+E\+D, allow\+\_\+all(), allow\+\_\+category(), B\+U\+C\+\_\+\+A\+L\+L\+B\+K\+N\+O\+W\+N, B\+U\+C\+\_\+\+U\+N\+K\+N\+O\+W\+N, buf, B\+U\+F\+S\+Z, C\+H\+O\+O\+S\+E\+\_\+\+A\+L\+L, obj\+::cobj, mi\+::count, count, F\+A\+L\+S\+E, flags, free(), in\+\_\+container(), invent, flag\+::invlet\+\_\+constant, I\+N\+V\+O\+R\+D\+E\+R\+\_\+\+S\+O\+R\+T, mi\+::item, M\+E\+N\+U\+\_\+\+F\+U\+L\+L, flag\+::menu\+\_\+style, obj\+::nobj, otmp, out\+\_\+container(), P\+I\+C\+K\+\_\+\+A\+N\+Y, query\+\_\+category(), query\+\_\+objlist(), Sprintf, T\+R\+U\+E, and U\+S\+E\+\_\+\+I\+N\+V\+L\+E\+T.



Referenced by use\+\_\+container().


\begin{DoxyCode}
2305 \{
2306     \textcolor{keywordtype}{int} n, i, n\_looted = 0;
2307     \textcolor{keywordtype}{boolean} all\_categories = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, loot\_everything = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2308     \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
2309     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *takeout = \textcolor{stringliteral}{"Take out"}, *putin = \textcolor{stringliteral}{"Put in"};
2310     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp}, *otmp2;
2311     \hyperlink{structmi}{menu\_item} *pick\_list;
2312     \textcolor{keywordtype}{int} mflags, res;
2313     \textcolor{keywordtype}{long} \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
2314 
2315     \textcolor{keywordflow}{if} (retry) \{
2316     all\_categories = (retry == -2);
2317     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a4c7aac17ec6b0121796b28803d94547c}{menu\_style} == \hyperlink{hack_8h_a38cbdbdd38a533335c4fd24f3550a395}{MENU\_FULL}) \{
2318     all\_categories = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2319     \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(buf,\textcolor{stringliteral}{"%s what type of objects?"}, put\_in ? putin : takeout);
2320     mflags = put\_in ? \hyperlink{hack_8h_affe70acbccd9ee8ce30b7699adfc3070}{ALL\_TYPES} | \hyperlink{hack_8h_ae59a156fb69de53502f1f975f98c6767}{BUC\_ALLBKNOWN} | 
      \hyperlink{hack_8h_a2cd13c4a158f4955dc658f4badb3c138}{BUC\_UNKNOWN} :
2321                   \hyperlink{hack_8h_affe70acbccd9ee8ce30b7699adfc3070}{ALL\_TYPES} | \hyperlink{hack_8h_a486d7929be45b366cf2c8c15f27e39b6}{CHOOSE\_ALL} | \hyperlink{hack_8h_ae59a156fb69de53502f1f975f98c6767}{BUC\_ALLBKNOWN} | 
      \hyperlink{hack_8h_a2cd13c4a158f4955dc658f4badb3c138}{BUC\_UNKNOWN};
2322     n = \hyperlink{pickup_8c_a728a862fbc9e9cbf54e8663c8b1dc0fd}{query\_category}(buf, put\_in ? \hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent} : container->
      \hyperlink{structobj_aa7bed832c417657c964b6f5893737586}{cobj},
2323                mflags, &pick\_list, \hyperlink{wintype_8h_a2bd6d317ee7338c416301da3d054dd9f}{PICK\_ANY});
2324     \textcolor{keywordflow}{if} (!n) \textcolor{keywordflow}{return} 0;
2325     \textcolor{keywordflow}{for} (i = 0; i < n; i++) \{
2326         \textcolor{keywordflow}{if} (pick\_list[i].item.a\_int == \textcolor{charliteral}{'A'})
2327         loot\_everything = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
2328         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (pick\_list[i].item.a\_int == \hyperlink{hack_8h_a0dd263622e82f8ca92192bda0b95e72d}{ALL\_TYPES\_SELECTED})
2329         all\_categories = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
2330         \textcolor{keywordflow}{else}
2331         \hyperlink{pickup_8c_a3a3907f1a05bd3d2eacfd77cd041536c}{add\_valid\_menu\_class}(pick\_list[i].item.a\_int);
2332     \}
2333     \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) pick\_list);
2334     \}
2335 
2336     \textcolor{keywordflow}{if} (loot\_everything) \{
2337     \textcolor{keywordflow}{for} (otmp = container->\hyperlink{structobj_aa7bed832c417657c964b6f5893737586}{cobj}; otmp; otmp = otmp2) \{
2338         otmp2 = otmp->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj};
2339         res = \hyperlink{pickup_8c_a874288ec8fc650fcaac88c1fa2d2b74e}{out\_container}(otmp);
2340         \textcolor{keywordflow}{if} (res < 0) \textcolor{keywordflow}{break};
2341     \}
2342     \} \textcolor{keywordflow}{else} \{
2343     mflags = \hyperlink{hack_8h_a12e95bdc93dbdbfed5b2a6070f194a0a}{INVORDER\_SORT};
2344     \textcolor{keywordflow}{if} (put\_in && \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a9e7b11296fcd0fd17d6621651ed24ab6}{invlet\_constant}) mflags |= 
      \hyperlink{hack_8h_a5c4787c4b2479514f4f204ab8eeda6f5}{USE\_INVLET};
2345     \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(buf,\textcolor{stringliteral}{"%s what?"}, put\_in ? putin : takeout);
2346     n = \hyperlink{pickup_8c_a40f3b140b744aff03e62fec624f927d0}{query\_objlist}(buf, put\_in ? \hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent} : container->\hyperlink{structobj_aa7bed832c417657c964b6f5893737586}{cobj},
2347               mflags, &pick\_list, \hyperlink{wintype_8h_a2bd6d317ee7338c416301da3d054dd9f}{PICK\_ANY},
2348               all\_categories ? \hyperlink{pickup_8c_a68e173dd97659afd09dd9e8a85e8d819}{allow\_all} : \hyperlink{pickup_8c_a0f79e2cd14f388a93269666fcb2d22ca}{allow\_category});
2349     \textcolor{keywordflow}{if} (n) \{
2350         n\_looted = n;
2351         \textcolor{keywordflow}{for} (i = 0; i < n; i++) \{
2352             otmp = pick\_list[i].\hyperlink{structmi_a24f26cd1b01d3cf3ed16b1fd020d3a08}{item}.\hyperlink{unionany_a0b581808e661444ae19a63a5ccdbf367}{a\_obj};
2353             count = pick\_list[i].\hyperlink{structmi_a008e5c33aa571223ec592e0725c5fb73}{count};
2354             \textcolor{keywordflow}{if} (count > 0 && count < otmp->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan}) \{
2355             otmp = splitobj(otmp, count);
2356             \textcolor{comment}{/* special split case also handled by askchain() */}
2357             \}
2358             res = put\_in ? \hyperlink{pickup_8c_a8344ebfadcf90f594ad92856f5a1467d}{in\_container}(otmp) : \hyperlink{pickup_8c_a874288ec8fc650fcaac88c1fa2d2b74e}{out\_container}(otmp);
2359             \textcolor{keywordflow}{if} (res < 0) \{
2360             \textcolor{keywordflow}{if} (otmp != pick\_list[i].item.a\_obj) \{
2361                 \textcolor{comment}{/* split occurred, merge again */}
2362                 (void) merged(&pick\_list[i].item.a\_obj, &otmp);
2363             \}
2364             \textcolor{keywordflow}{break};
2365             \}
2366         \}
2367         \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})pick\_list);
2368     \}
2369     \}
2370     \textcolor{keywordflow}{return} n\_looted;
2371 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a58b59552076730fea752be5055c7d1b7}{\index{pickup.\+c@{pickup.\+c}!mon\+\_\+beside@{mon\+\_\+beside}}
\index{mon\+\_\+beside@{mon\+\_\+beside}!pickup.\+c@{pickup.\+c}}
\subsubsection[{mon\+\_\+beside}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} mon\+\_\+beside (
\begin{DoxyParamCaption}
\item[{int}]{x, }
\item[{int}]{y}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a58b59552076730fea752be5055c7d1b7}


Definition at line 1491 of file pickup.\+c.



References F\+A\+L\+S\+E, M\+O\+N\+\_\+\+A\+T, and T\+R\+U\+E.


\begin{DoxyCode}
1493 \{
1494     \textcolor{keywordtype}{int} i,j,nx,ny;
1495     \textcolor{keywordflow}{for}(i = -1; i <= 1; i++)
1496         \textcolor{keywordflow}{for}(j = -1; j <= 1; j++) \{
1497             nx = x + i;
1498             ny = y + j;
1499         \textcolor{keywordflow}{if}(isok(nx, ny) && \hyperlink{rm_8h_a17ef631151b987fd582fca76a429c08a}{MON\_AT}(nx, ny))
1500             \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1501         \}
1502     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1503 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a7d2f7740acfb2d86e93801c0a6639b28}{\index{pickup.\+c@{pickup.\+c}!n\+\_\+or\+\_\+more@{n\+\_\+or\+\_\+more}}
\index{n\+\_\+or\+\_\+more@{n\+\_\+or\+\_\+more}!pickup.\+c@{pickup.\+c}}
\subsubsection[{n\+\_\+or\+\_\+more}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} n\+\_\+or\+\_\+more (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{obj}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a7d2f7740acfb2d86e93801c0a6639b28}


Definition at line 283 of file pickup.\+c.



References F\+A\+L\+S\+E, and uchain.



Referenced by pickup().


\begin{DoxyCode}
285 \{
286     \textcolor{keywordflow}{if} (obj == \hyperlink{decl_8h_ac83f46f409b88c6d6109ed04938ad52a}{uchain}) \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
287     \textcolor{keywordflow}{return} (obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} >= \hyperlink{pickup_8c_a0bd193462382b9374db52932708de0c3}{val\_for\_n\_or\_more});
288 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a47dbe7403194a564273bc82e20f4b1af}{\index{pickup.\+c@{pickup.\+c}!observe\+\_\+quantum\+\_\+cat@{observe\+\_\+quantum\+\_\+cat}}
\index{observe\+\_\+quantum\+\_\+cat@{observe\+\_\+quantum\+\_\+cat}!pickup.\+c@{pickup.\+c}}
\subsubsection[{observe\+\_\+quantum\+\_\+cat}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void observe\+\_\+quantum\+\_\+cat (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{box}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a47dbe7403194a564273bc82e20f4b1af}


Definition at line 2028 of file pickup.\+c.



References canspotmon, F\+O\+O\+T, Hallucination, mons, N\+E\+A\+R\+D\+A\+T\+A, N\+O\+\_\+\+M\+I\+N\+V\+E\+N\+T, and something.



Referenced by use\+\_\+container().


\begin{DoxyCode}
2030 \{
2031     \textcolor{keyword}{static} \hyperlink{config1_8h_a9987bf629301f5fe76ddd96aa2717ca1}{NEARDATA} \textcolor{keyword}{const} \textcolor{keywordtype}{char} sc[] = \textcolor{stringliteral}{"Schroedinger's Cat"};
2032     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *deadcat;
2033     \textcolor{keyword}{struct }\hyperlink{structmonst}{monst} *livecat;
2034     \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} ox, oy;
2035 
2036     box->\hyperlink{structobj_a14fc8dc59e9073bfbf1e170875a98448}{spe} = 0;        \textcolor{comment}{/* box->owt will be updated below */}
2037     \textcolor{keywordflow}{if} (get\_obj\_location(box, &ox, &oy, 0))
2038     box->\hyperlink{structobj_aac936c7da6b4f1eca0a94f75c242e5cc}{ox} = ox, box->\hyperlink{structobj_a72dace5e678b56ae42c3fb19292e5839}{oy} = oy; \textcolor{comment}{/* in case it's being carried */}
2039 
2040     \textcolor{comment}{/* this isn't really right, since any form of observation}
2041 \textcolor{comment}{       (telepathic or monster/object/food detection) ought to}
2042 \textcolor{comment}{       force the determination of alive vs dead state; but basing}
2043 \textcolor{comment}{       it just on opening the box is much simpler to cope with */}
2044     livecat = rn2(2) ? makemon(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_HOUSECAT],
2045                    box->\hyperlink{structobj_aac936c7da6b4f1eca0a94f75c242e5cc}{ox}, box->\hyperlink{structobj_a72dace5e678b56ae42c3fb19292e5839}{oy}, \hyperlink{hack_8h_ab9abb3d58903e1c125446f40f6984095}{NO\_MINVENT}) : 0;
2046     \textcolor{keywordflow}{if} (livecat) \{
2047     livecat->mpeaceful = 1;
2048     set\_malign(livecat);
2049     \textcolor{keywordflow}{if} (!\hyperlink{display_8h_a13f0a7cac1ceb73885a59b8598de1648}{canspotmon}(livecat))
2050         You(\textcolor{stringliteral}{"think %s brushed your %s."}, \hyperlink{decl_8h_aa5c50bde0d16d15a08d32d8df49a80ae}{something}, body\_part(\hyperlink{hack_8h_a9b1eabef4c7711550544eaeaa8f41fa1}{FOOT}));
2051     \textcolor{keywordflow}{else}
2052         pline(\textcolor{stringliteral}{"%s inside the box is still alive!"}, Monnam(livecat));
2053     (void) christen\_monst(livecat, sc);
2054     \} \textcolor{keywordflow}{else} \{
2055     deadcat = mk\_named\_object(CORPSE, &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_HOUSECAT],
2056                   box->\hyperlink{structobj_aac936c7da6b4f1eca0a94f75c242e5cc}{ox}, box->\hyperlink{structobj_a72dace5e678b56ae42c3fb19292e5839}{oy}, sc);
2057     \textcolor{keywordflow}{if} (deadcat) \{
2058         obj\_extract\_self(deadcat);
2059         (void) add\_to\_container(box, deadcat);
2060     \}
2061     pline\_The(\textcolor{stringliteral}{"%s inside the box is dead!"},
2062         \hyperlink{youprop_8h_aa873f7ea0a3d096ef94ff651907f7a76}{Hallucination} ? rndmonnam() : \textcolor{stringliteral}{"housecat"});
2063     \}
2064     box->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt} = weight(box);
2065     \textcolor{keywordflow}{return};
2066 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a874288ec8fc650fcaac88c1fa2d2b74e}{\index{pickup.\+c@{pickup.\+c}!out\+\_\+container@{out\+\_\+container}}
\index{out\+\_\+container@{out\+\_\+container}!pickup.\+c@{pickup.\+c}}
\subsubsection[{out\+\_\+container}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+P\+T\+R} int out\+\_\+container (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{obj}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a874288ec8fc650fcaac88c1fa2d2b74e}


Definition at line 1927 of file pickup.\+c.



References age\+\_\+is\+\_\+relative, B\+U\+F\+S\+Z, carried, C\+O\+I\+N\+\_\+\+C\+L\+A\+S\+S, count, monst\+::data, display\+\_\+nhwindow, F\+A\+L\+S\+E, Icebox, is\+\_\+pick, lift\+\_\+object(), M\+O\+D\+\_\+\+E\+N\+C\+U\+M\+B\+E\+R, mons, monstermoves, otmp, obj\+::owt, obj\+::ox, obj\+::oy, Stone\+\_\+resistance, Strcpy, touch\+\_\+petrifies, T\+R\+U\+E, u, uarmg, you\+::ushops, W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E, and youmonst.



Referenced by menu\+\_\+loot(), and use\+\_\+container().


\begin{DoxyCode}
1929 \{
1930     \textcolor{keyword}{register} \textcolor{keyword}{struct }obj *\hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp};
1931     \textcolor{keywordtype}{boolean} is\_gold = (obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == \hyperlink{objclass_8h_a2999621925083659147349e261e4cb3d}{COIN\_CLASS});
1932     \textcolor{keywordtype}{int} res, loadlev;
1933     \textcolor{keywordtype}{long} \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
1934 
1935     \textcolor{keywordflow}{if} (!\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}) \{
1936         impossible(\textcolor{stringliteral}{"<out> no current\_container?"});
1937         \textcolor{keywordflow}{return} -1;
1938     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (is\_gold) \{
1939         obj->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt} = weight(obj);
1940     \}
1941 
1942     \textcolor{keywordflow}{if}(obj->\hyperlink{structobj_af03ce8a6a0ca51e8d8954fb1a1a31fbe}{oartifact} && !touch\_artifact(obj,&\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst})) \textcolor{keywordflow}{return} 0;
1943 
1944     \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == CORPSE) \{
1945         \textcolor{keywordflow}{if} ( (\hyperlink{mondata_8h_ad1e85e493d27cdfdbe94c43710c4b191}{touch\_petrifies}(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[obj->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm}])) && !
      \hyperlink{decl_8h_a374ab5e4582cfafa2d4ef57211f53293}{uarmg}
1946          && !\hyperlink{youprop_8h_a90b638323d50e1f8d52d4a9576d90551}{Stone\_resistance}) \{
1947         \textcolor{keywordflow}{if} (poly\_when\_stoned(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) && polymon(PM\_STONE\_GOLEM))
1948             \hyperlink{winprocs_8h_ac8e74d03fbb65b9f5651e63d79bebc60}{display\_nhwindow}(\hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1949         \textcolor{keywordflow}{else} \{
1950             \textcolor{keywordtype}{char} kbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
1951 
1952             \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(kbuf, an(corpse\_xname(obj, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE})));
1953             pline(\textcolor{stringliteral}{"Touching %s is a fatal mistake."}, kbuf);
1954             instapetrify(kbuf);
1955             \textcolor{keywordflow}{return} -1;
1956         \}
1957         \}
1958     \}
1959 
1960     count = obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan};
1961     \textcolor{keywordflow}{if} ((res = \hyperlink{pickup_8c_afc20ba70668bc135322317c55743f068}{lift\_object}(obj, \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}, &count, 
      \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE})) <= 0)
1962         \textcolor{keywordflow}{return} res;
1963 
1964     \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} != count && obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} != LOADSTONE)
1965         obj = splitobj(obj, count);
1966 
1967     \textcolor{comment}{/* Remove the object from the list. */}
1968     obj\_extract\_self(obj);
1969     \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt} = weight(\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container});
1970 
1971     \textcolor{keywordflow}{if} (\hyperlink{pickup_8c_a03ae3a6955e4b11872783e4350243305}{Icebox} && !\hyperlink{obj_8h_aab158d4d170eadd4e9307f92834eaa32}{age\_is\_relative}(obj)) \{
1972         obj->\hyperlink{structobj_a3dd6f7cf99f6a946d0ca406cfca5c23d}{age} = \hyperlink{decl_8h_a75c1f008487d95630d0d789a79bb5c74}{monstermoves} - obj->\hyperlink{structobj_a3dd6f7cf99f6a946d0ca406cfca5c23d}{age}; \textcolor{comment}{/* actual age */}
1973         \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == CORPSE)
1974             start\_corpse\_timeout(obj);
1975     \}
1976     \textcolor{comment}{/* simulated point of time */}
1977 
1978     \textcolor{keywordflow}{if}(!obj->unpaid && !\hyperlink{obj_8h_a4adde9a5428fde9b6faf64253a1507e8}{carried}(\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}) &&
1979          costly\_spot(\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}->\hyperlink{structobj_aac936c7da6b4f1eca0a94f75c242e5cc}{ox}, \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}->
      \hyperlink{structobj_a72dace5e678b56ae42c3fb19292e5839}{oy})) \{
1980         obj->\hyperlink{structobj_aac936c7da6b4f1eca0a94f75c242e5cc}{ox} = \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}->\hyperlink{structobj_aac936c7da6b4f1eca0a94f75c242e5cc}{ox};
1981         obj->\hyperlink{structobj_a72dace5e678b56ae42c3fb19292e5839}{oy} = \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}->\hyperlink{structobj_a72dace5e678b56ae42c3fb19292e5839}{oy};
1982         addtobill(obj, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1983     \}
1984     \textcolor{keywordflow}{if} (\hyperlink{obj_8h_a260a5afdeeb55f7207d5db68ae939e21}{is\_pick}(obj) && !obj->unpaid && *\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a1bc3b5ca1e5d9957ab3a7f451c069f47}{ushops} && shop\_keeper(*
      \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a1bc3b5ca1e5d9957ab3a7f451c069f47}{ushops}))
1985         verbalize(\textcolor{stringliteral}{"You sneaky cad! Get out of here with that pick!"});
1986 
1987     otmp = addinv(obj);
1988     loadlev = near\_capacity();
1989     prinv(loadlev ?
1990           (loadlev < \hyperlink{hack_8h_a3c3899e355380d08f5d23828908c3679}{MOD\_ENCUMBER} ?
1991            \textcolor{stringliteral}{"You have a little trouble removing"} :
1992            \textcolor{stringliteral}{"You have much trouble removing"}) : (\textcolor{keywordtype}{char} *)0,
1993           otmp, count);
1994 
1995     \textcolor{keywordflow}{if} (is\_gold) \{
1996 \textcolor{preprocessor}{#ifndef GOLDOBJ}
1997         dealloc\_obj(obj);
1998 \textcolor{preprocessor}{#endif}
1999         bot();  \textcolor{comment}{/* update character's gold piece count immediately */}
2000     \}
2001     \textcolor{keywordflow}{return} 1;
2002 \}
\end{DoxyCode}
\hypertarget{pickup_8c_aa9b25e3f7e59ea0f9951b9760553c30b}{\index{pickup.\+c@{pickup.\+c}!pick\+\_\+obj@{pick\+\_\+obj}}
\index{pick\+\_\+obj@{pick\+\_\+obj}!pickup.\+c@{pickup.\+c}}
\subsubsection[{pick\+\_\+obj}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf obj}$\ast$ pick\+\_\+obj (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{otmp}
\end{DoxyParamCaption}
)}}\label{pickup_8c_aa9b25e3f7e59ea0f9951b9760553c30b}


Definition at line 1373 of file pickup.\+c.



References F\+A\+L\+S\+E, index(), newsym(), S\+H\+O\+P\+B\+A\+S\+E, Strcpy, T\+R\+U\+E, u, uball, and you\+::ushops.



Referenced by pickup\+\_\+object().


\begin{DoxyCode}
1375 \{
1376     obj\_extract\_self(otmp);
1377     \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uswallow && otmp != \hyperlink{decl_8h_a043dece512e3c566986d7cfabc52d05e}{uball} && costly\_spot(otmp->\hyperlink{structobj_aac936c7da6b4f1eca0a94f75c242e5cc}{ox}, otmp->\hyperlink{structobj_a72dace5e678b56ae42c3fb19292e5839}{oy})) \{
1378         \textcolor{keywordtype}{char} saveushops[5], fakeshop[2];
1379 
1380         \textcolor{comment}{/* addtobill cares about your location rather than the object's;}
1381 \textcolor{comment}{           usually they'll be the same, but not when using telekinesis}
1382 \textcolor{comment}{           (if ever implemented) or a grappling hook */}
1383         \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(saveushops, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a1bc3b5ca1e5d9957ab3a7f451c069f47}{ushops});
1384         fakeshop[0] = *in\_rooms(otmp->\hyperlink{structobj_aac936c7da6b4f1eca0a94f75c242e5cc}{ox}, otmp->\hyperlink{structobj_a72dace5e678b56ae42c3fb19292e5839}{oy}, \hyperlink{mkroom_8h_a925701a88c7ed0db502cfac9d8fbcf9e}{SHOPBASE});
1385         fakeshop[1] = \textcolor{charliteral}{'\(\backslash\)0'};
1386         \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a1bc3b5ca1e5d9957ab3a7f451c069f47}{ushops}, fakeshop);
1387         \textcolor{comment}{/* sets obj->unpaid if necessary */}
1388         addtobill(otmp, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1389         \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a1bc3b5ca1e5d9957ab3a7f451c069f47}{ushops}, saveushops);
1390         \textcolor{comment}{/* if you're outside the shop, make shk notice */}
1391         \textcolor{keywordflow}{if} (!\hyperlink{uudecode_8c_ac82f3cc16110a05458f2b2483236afb7}{index}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a1bc3b5ca1e5d9957ab3a7f451c069f47}{ushops}, *fakeshop))
1392         remote\_burglary(otmp->\hyperlink{structobj_aac936c7da6b4f1eca0a94f75c242e5cc}{ox}, otmp->\hyperlink{structobj_a72dace5e678b56ae42c3fb19292e5839}{oy});
1393     \}
1394     \textcolor{keywordflow}{if} (otmp->no\_charge)    \textcolor{comment}{/* only applies to objects outside invent */}
1395         otmp->no\_charge = 0;
1396     \hyperlink{display_8c_a185c6ad6e4c5a6be26a371b9aa17c32e}{newsym}(otmp->\hyperlink{structobj_aac936c7da6b4f1eca0a94f75c242e5cc}{ox}, otmp->\hyperlink{structobj_a72dace5e678b56ae42c3fb19292e5839}{oy});
1397     \textcolor{keywordflow}{return} addinv(otmp);    \textcolor{comment}{/* might merge it with other objects */}
1398 \}
\end{DoxyCode}
\hypertarget{pickup_8c_ab9fd1f5835d6d35507a05e910e86d862}{\index{pickup.\+c@{pickup.\+c}!pickup@{pickup}}
\index{pickup@{pickup}!pickup.\+c@{pickup.\+c}}
\subsubsection[{pickup}]{\setlength{\rightskip}{0pt plus 5cm}int pickup (
\begin{DoxyParamCaption}
\item[{int}]{what}
\end{DoxyParamCaption}
)}}\label{pickup_8c_ab9fd1f5835d6d35507a05e910e86d862}


Definition at line 385 of file pickup.\+c.



References add\+\_\+valid\+\_\+menu\+\_\+class(), all\+\_\+but\+\_\+uchain(), allow\+\_\+all(), allow\+\_\+category(), autopick(), A\+U\+T\+O\+S\+E\+L\+E\+C\+T\+\_\+\+S\+I\+N\+G\+L\+E, buf, B\+U\+F\+S\+Z, B\+Y\+\_\+\+N\+E\+X\+T\+H\+E\+R\+E, check\+\_\+here(), mi\+::count, count, monst\+::data, F\+A\+L\+S\+E, F\+E\+E\+L\+\_\+\+C\+O\+C\+K\+A\+T\+R\+I\+C\+E, flags, free(), iflags, index(), I\+N\+V\+O\+R\+D\+E\+R\+\_\+\+S\+O\+R\+T, level, M\+A\+X\+O\+C\+L\+A\+S\+S\+E\+S, instance\+\_\+flags\+::menu\+\_\+requested, flag\+::menu\+\_\+style, M\+E\+N\+U\+\_\+\+T\+R\+A\+D\+I\+T\+I\+O\+N\+A\+L, min, monst\+::minvent, multi, n\+\_\+or\+\_\+more(), newsym(), obj\+::nobj, flag\+::nopick, notake, O\+B\+J\+\_\+\+A\+T, dlevel\+\_\+t\+::objects, obj\+::oclass, obj\+::otyp, P\+I\+C\+K\+\_\+\+A\+N\+Y, P\+I\+C\+K\+\_\+\+O\+N\+E, flag\+::pickup, pickup\+\_\+object(), P\+I\+T, Q\+B\+U\+F\+S\+Z, obj\+::quan, query\+\_\+classes(), query\+\_\+objlist(), flag\+::run, safe\+\_\+qbuf(), S\+P\+I\+K\+E\+D\+\_\+\+P\+I\+T, Sprintf, T\+R\+U\+E, T\+T\+\_\+\+P\+I\+T, u, Underwater, you\+::ustuck, you\+::utrap, you\+::utraptype, you\+::ux, you\+::uy, what, yn\+\_\+number, ynaq, yn\+Naq, and youmonst.



Referenced by loot\+\_\+mon(), M\+A\+I\+N(), and main().


\begin{DoxyCode}
387 \{
388     \textcolor{keywordtype}{int} i, n, res, \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}, n\_tried = 0, n\_picked = 0;
389     \hyperlink{structmi}{menu\_item} *pick\_list = (\hyperlink{structmi}{menu\_item} *) 0;
390     \textcolor{keywordtype}{boolean} autopickup = \hyperlink{detect_8c_a951a98f1e2d69ca61adcd53c0f8faca3}{what} > 0;
391     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *objchain;
392     \textcolor{keywordtype}{int} traverse\_how;
393 
394     \textcolor{keywordflow}{if} (\hyperlink{detect_8c_a951a98f1e2d69ca61adcd53c0f8faca3}{what} < 0)       \textcolor{comment}{/* pick N of something */}
395         count = -\hyperlink{detect_8c_a951a98f1e2d69ca61adcd53c0f8faca3}{what};
396     \textcolor{keywordflow}{else}            \textcolor{comment}{/* pick anything */}
397         count = 0;
398 
399     \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uswallow) \{
400         \textcolor{keyword}{struct }\hyperlink{structtrap}{trap} *ttmp = t\_at(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy});
401         \textcolor{comment}{/* no auto-pick if no-pick move, nothing there, or in a pool */}
402         \textcolor{keywordflow}{if} (autopickup && (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_aa4b99330f9e778677955c013004aef15}{nopick} || !\hyperlink{rm_8h_a8c5e05f917fa75d3b54c8c5045d6665b}{OBJ\_AT}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.
      \hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}) ||
403             (is\_pool(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}) && !\hyperlink{youprop_8h_a2eb59bdcba2c368fefd253bfcdaa3673}{Underwater}) || is\_lava(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.
      \hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}))) \{
404             read\_engr\_at(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy});
405             \textcolor{keywordflow}{return} (0);
406         \}
407 
408         \textcolor{comment}{/* no pickup if levitating & not on air or water level */}
409         \textcolor{keywordflow}{if} (!can\_reach\_floor()) \{
410             \textcolor{keywordflow}{if} ((\hyperlink{decl_8h_a498406921f71695627a7107240f3ed7a}{multi} && !\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a75d9c7e384cce1696f2c2d1b2881d162}{run}) || (autopickup && !\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.
      \hyperlink{structflag_a78d01402f1561986cbae615d8a62bd25}{pickup}))
411             read\_engr\_at(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy});
412             \textcolor{keywordflow}{return} (0);
413         \}
414         \textcolor{keywordflow}{if} (ttmp && ttmp->tseen) \{
415             \textcolor{comment}{/* Allow pickup from holes and trap doors that you escaped}
416 \textcolor{comment}{             * from because that stuff is teetering on the edge just}
417 \textcolor{comment}{             * like you, but not pits, because there is an elevation}
418 \textcolor{comment}{             * discrepancy with stuff in pits.}
419 \textcolor{comment}{             */}
420             \textcolor{keywordflow}{if} ((ttmp->ttyp == \hyperlink{trap_8h_af181c9e6602b6432a0bf1a9243808968}{PIT} || ttmp->ttyp == \hyperlink{trap_8h_a813fa80e09de5d455e2af3743a95bad9}{SPIKED\_PIT}) &&
421             (!\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a7250d3b13a54b76d846b754a2a6f3fa6}{utrap} || (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a7250d3b13a54b76d846b754a2a6f3fa6}{utrap} && \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a1753632ed4b3b8dea40466c1c92fce19}{utraptype} != \hyperlink{you_8h_aea6a4ea47e82cae080755cd9c3ed8b9a}{TT\_PIT}))) \{
422             read\_engr\_at(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy});
423             \textcolor{keywordflow}{return}(0);
424             \}
425         \}
426         \textcolor{comment}{/* multi && !flags.run means they are in the middle of some other}
427 \textcolor{comment}{         * action, or possibly paralyzed, sleeping, etc.... and they just}
428 \textcolor{comment}{         * teleported onto the object.  They shouldn't pick it up.}
429 \textcolor{comment}{         */}
430         \textcolor{keywordflow}{if} ((\hyperlink{decl_8h_a498406921f71695627a7107240f3ed7a}{multi} && !\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a75d9c7e384cce1696f2c2d1b2881d162}{run}) || (autopickup && !\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.
      \hyperlink{structflag_a78d01402f1561986cbae615d8a62bd25}{pickup})) \{
431             \hyperlink{pickup_8c_aaa2596751167ec82657450be8202f869}{check\_here}(\hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
432             \textcolor{keywordflow}{return} (0);
433         \}
434         \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_ae0efcbbbb687279e0ad93ffd19797c4a}{notake}(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})) \{
435             \textcolor{keywordflow}{if} (!autopickup)
436             You(\textcolor{stringliteral}{"are physically incapable of picking anything up."});
437             \textcolor{keywordflow}{else}
438             \hyperlink{pickup_8c_aaa2596751167ec82657450be8202f869}{check\_here}(\hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
439             \textcolor{keywordflow}{return} (0);
440         \}
441 
442         \textcolor{comment}{/* if there's anything here, stop running */}
443         \textcolor{keywordflow}{if} (\hyperlink{rm_8h_a8c5e05f917fa75d3b54c8c5045d6665b}{OBJ\_AT}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux},\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}) && \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a75d9c7e384cce1696f2c2d1b2881d162}{run} && \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a75d9c7e384cce1696f2c2d1b2881d162}{run} != 8 && !
      \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_aa4b99330f9e778677955c013004aef15}{nopick}) nomul(0);
444     \}
445 
446     \hyperlink{pickup_8c_a3a3907f1a05bd3d2eacfd77cd041536c}{add\_valid\_menu\_class}(0);    \textcolor{comment}{/* reset */}
447     \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uswallow) \{
448         objchain = \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ac128f805d01d7746b499596dd3b92a53}{objects}[\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}][\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}];
449         traverse\_how = \hyperlink{hack_8h_a399a7fd555c25420d580a1a05df5d082}{BY\_NEXTHERE};
450     \} \textcolor{keywordflow}{else} \{
451         objchain = \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a774d4dad2da130ec9ed1d2e6c5e0fa80}{ustuck}->\hyperlink{structmonst_a480856d6a5db5610593c9816e525a978}{minvent};
452         traverse\_how = 0;   \textcolor{comment}{/* nobj */}
453     \}
454     \textcolor{comment}{/*}
455 \textcolor{comment}{     * Start the actual pickup process.  This is split into two main}
456 \textcolor{comment}{     * sections, the newer menu and the older "traditional" methods.}
457 \textcolor{comment}{     * Automatic pickup has been split into its own menu-style routine}
458 \textcolor{comment}{     * to make things less confusing.}
459 \textcolor{comment}{     */}
460     \textcolor{keywordflow}{if} (autopickup) \{
461         n = \hyperlink{pickup_8c_a001d10b037df91814111609abd49ddb7}{autopick}(objchain, traverse\_how, &pick\_list);
462         \textcolor{keywordflow}{goto} menu\_pickup;
463     \}
464 
465     \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a4c7aac17ec6b0121796b28803d94547c}{menu\_style} != \hyperlink{hack_8h_a3722a16e7d256c5426734217dd050099}{MENU\_TRADITIONAL} || 
      \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_acf15f814fa4282e40cd0a8798a59b0b2}{menu\_requested}) \{
466 
467         \textcolor{comment}{/* use menus exclusively */}
468         \textcolor{keywordflow}{if} (count) \{    \textcolor{comment}{/* looking for N of something */}
469         \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[\hyperlink{global_8h_a1bb6bf3db7bf52ca1e9fa8fbcd6e9630}{QBUFSZ}];
470         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(buf, \textcolor{stringliteral}{"Pick %d of what?"}, count);
471         \hyperlink{pickup_8c_a0bd193462382b9374db52932708de0c3}{val\_for\_n\_or\_more} = \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};    \textcolor{comment}{/* set up callback selector */}
472         n = \hyperlink{pickup_8c_a40f3b140b744aff03e62fec624f927d0}{query\_objlist}(buf, objchain,
473                 traverse\_how|\hyperlink{hack_8h_ab96b626ee7ebe8d40ee77f2c093fca67}{AUTOSELECT\_SINGLE}|\hyperlink{hack_8h_a12e95bdc93dbdbfed5b2a6070f194a0a}{INVORDER\_SORT},
474                 &pick\_list, \hyperlink{wintype_8h_a53377e7b2fddfaf7cc2351dab3b2b139}{PICK\_ONE}, \hyperlink{pickup_8c_a7d2f7740acfb2d86e93801c0a6639b28}{n\_or\_more});
475         \textcolor{comment}{/* correct counts, if any given */}
476         \textcolor{keywordflow}{for} (i = 0; i < n; i++)
477             pick\_list[i].count = count;
478         \} \textcolor{keywordflow}{else} \{
479         n = \hyperlink{pickup_8c_a40f3b140b744aff03e62fec624f927d0}{query\_objlist}(\textcolor{stringliteral}{"Pick up what?"}, objchain,
480             traverse\_how|\hyperlink{hack_8h_ab96b626ee7ebe8d40ee77f2c093fca67}{AUTOSELECT\_SINGLE}|\hyperlink{hack_8h_a12e95bdc93dbdbfed5b2a6070f194a0a}{INVORDER\_SORT}|
      \hyperlink{hack_8h_a7b6ddd41983a53e638638f0e7bb115cd}{FEEL\_COCKATRICE},
481             &pick\_list, \hyperlink{wintype_8h_a2bd6d317ee7338c416301da3d054dd9f}{PICK\_ANY}, \hyperlink{pickup_8c_ae59fc67ba82b0dbaca24bc6cd133511f}{all\_but\_uchain});
482         \}
483 menu\_pickup:
484         n\_tried = n;
485         \textcolor{keywordflow}{for} (n\_picked = i = 0 ; i < n; i++) \{
486         res = \hyperlink{pickup_8c_a766962d5f6ecef8bf6d2d20d470e9630}{pickup\_object}(pick\_list[i].item.a\_obj,pick\_list[i].
      \hyperlink{structmi_a008e5c33aa571223ec592e0725c5fb73}{count},
487                     \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
488         \textcolor{keywordflow}{if} (res < 0) \textcolor{keywordflow}{break}; \textcolor{comment}{/* can't continue */}
489         n\_picked += res;
490         \}
491         \textcolor{keywordflow}{if} (pick\_list) \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})pick\_list);
492 
493     \} \textcolor{keywordflow}{else} \{
494         \textcolor{comment}{/* old style interface */}
495         \textcolor{keywordtype}{int} ct = 0;
496         \textcolor{keywordtype}{long} lcount;
497         \textcolor{keywordtype}{boolean} all\_of\_a\_type, selective;
498         \textcolor{keywordtype}{char} oclasses[\hyperlink{objclass_8h_af51133138bfb718b55aaa7f29711a10a}{MAXOCLASSES}];
499         \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{structobj}{obj}, *obj2;
500 
501         oclasses[0] = \textcolor{charliteral}{'\(\backslash\)0'};     \textcolor{comment}{/* types to consider (empty for all) */}
502         all\_of\_a\_type = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};   \textcolor{comment}{/* take all of considered types */}
503         selective = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};     \textcolor{comment}{/* ask for each item */}
504 
505         \textcolor{comment}{/* check for more than one object */}
506         \textcolor{keywordflow}{for} (obj = objchain;
507           obj; obj = (traverse\_how == \hyperlink{hack_8h_a399a7fd555c25420d580a1a05df5d082}{BY\_NEXTHERE}) ? obj->nexthere : obj->
      \hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj})
508         ct++;
509 
510         \textcolor{keywordflow}{if} (ct == 1 && count) \{
511         \textcolor{comment}{/* if only one thing, then pick it */}
512         obj = objchain;
513         lcount = \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan}, (\textcolor{keywordtype}{long})count);
514         n\_tried++;
515         \textcolor{keywordflow}{if} (\hyperlink{pickup_8c_a766962d5f6ecef8bf6d2d20d470e9630}{pickup\_object}(obj, lcount, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}) > 0)
516             n\_picked++; \textcolor{comment}{/* picked something */}
517         \textcolor{keywordflow}{goto} end\_query;
518 
519         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ct >= 2) \{
520         \textcolor{keywordtype}{int} via\_menu = 0;
521 
522         There(\textcolor{stringliteral}{"are %s objects here."},
523               (ct <= 10) ? \textcolor{stringliteral}{"several"} : \textcolor{stringliteral}{"many"});
524         \textcolor{keywordflow}{if} (!\hyperlink{pickup_8c_a4f84d70771d90362fe0ee76b5dde91f5}{query\_classes}(oclasses, &selective, &all\_of\_a\_type,
525                    \textcolor{stringliteral}{"pick up"}, objchain,
526                    traverse\_how == \hyperlink{hack_8h_a399a7fd555c25420d580a1a05df5d082}{BY\_NEXTHERE},
527 #ifndef GOLDOBJ
528                    \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE},
529 #endif
530                    &via\_menu)) \{
531             \textcolor{keywordflow}{if} (!via\_menu) \textcolor{keywordflow}{return} (0);
532             n = \hyperlink{pickup_8c_a40f3b140b744aff03e62fec624f927d0}{query\_objlist}(\textcolor{stringliteral}{"Pick up what?"},
533                   objchain,
534                   traverse\_how|(selective ? 0 : \hyperlink{hack_8h_a12e95bdc93dbdbfed5b2a6070f194a0a}{INVORDER\_SORT}),
535                   &pick\_list, \hyperlink{wintype_8h_a2bd6d317ee7338c416301da3d054dd9f}{PICK\_ANY},
536                   via\_menu == -2 ? \hyperlink{pickup_8c_a68e173dd97659afd09dd9e8a85e8d819}{allow\_all} : \hyperlink{pickup_8c_a0f79e2cd14f388a93269666fcb2d22ca}{allow\_category});
537             \textcolor{keywordflow}{goto} menu\_pickup;
538         \}
539         \}
540 
541         \textcolor{keywordflow}{for} (obj = objchain; obj; obj = obj2) \{
542         \textcolor{keywordflow}{if} (traverse\_how == \hyperlink{hack_8h_a399a7fd555c25420d580a1a05df5d082}{BY\_NEXTHERE})
543             obj2 = obj->nexthere;   \textcolor{comment}{/* perhaps obj will be picked up */}
544         \textcolor{keywordflow}{else}
545             obj2 = obj->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj};
546         lcount = -1L;
547 
548         \textcolor{keywordflow}{if} (!selective && oclasses[0] && !\hyperlink{uudecode_8c_ac82f3cc16110a05458f2b2483236afb7}{index}(oclasses,obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass}))
549             \textcolor{keywordflow}{continue};
550 
551         \textcolor{keywordflow}{if} (!all\_of\_a\_type) \{
552             \textcolor{keywordtype}{char} qbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
553             \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(qbuf, \textcolor{stringliteral}{"Pick up %s?"},
554             \hyperlink{pickup_8c_adeadb81e8a48333beb5ca21a69f49edc}{safe\_qbuf}(\textcolor{stringliteral}{""}, \textcolor{keyword}{sizeof}(\textcolor{stringliteral}{"Pick up ?"}), doname(obj),
555                     an(simple\_typename(obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp})), \textcolor{stringliteral}{"something"}));
556             \textcolor{keywordflow}{switch} ((obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} < 2L) ? \hyperlink{hack_8h_a898ef54f58a1789bb39562562591d543}{ynaq}(qbuf) : \hyperlink{hack_8h_a658824c8a4f800fdf424f8b4a56e2641}{ynNaq}(qbuf)) \{
557             \textcolor{keywordflow}{case} \textcolor{charliteral}{'q'}: \textcolor{keywordflow}{goto} end\_query;   \textcolor{comment}{/* out 2 levels */}
558             \textcolor{keywordflow}{case} \textcolor{charliteral}{'n'}: \textcolor{keywordflow}{continue};
559             \textcolor{keywordflow}{case} \textcolor{charliteral}{'a'}:
560             all\_of\_a\_type = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
561             \textcolor{keywordflow}{if} (selective) \{
562                 selective = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
563                 oclasses[0] = obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass};
564                 oclasses[1] = \textcolor{charliteral}{'\(\backslash\)0'};
565             \}
566             \textcolor{keywordflow}{break};
567             \textcolor{keywordflow}{case} \textcolor{charliteral}{'#'}:   \textcolor{comment}{/* count was entered */}
568             \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_a8d0d181363445ec14b97df39150532e9}{yn\_number}) \textcolor{keywordflow}{continue}; \textcolor{comment}{/* 0 count => No */}
569             lcount = (long) \hyperlink{decl_8h_a8d0d181363445ec14b97df39150532e9}{yn\_number};
570             \textcolor{keywordflow}{if} (lcount > obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan}) lcount = obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan};
571             \textcolor{comment}{/* fall thru */}
572             \textcolor{keywordflow}{default}:    \textcolor{comment}{/* 'y' */}
573             \textcolor{keywordflow}{break};
574             \}
575         \}
576         \textcolor{keywordflow}{if} (lcount == -1L) lcount = obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan};
577 
578         n\_tried++;
579         \textcolor{keywordflow}{if} ((res = \hyperlink{pickup_8c_a766962d5f6ecef8bf6d2d20d470e9630}{pickup\_object}(obj, lcount, FALSE)) < 0) \textcolor{keywordflow}{break};
580         n\_picked += res;
581         \}
582 end\_query:
583         ;   \textcolor{comment}{/* semicolon needed by brain-damaged compilers */}
584     \}
585 
586     \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uswallow) \{
587         \textcolor{keywordflow}{if} (!\hyperlink{rm_8h_a8c5e05f917fa75d3b54c8c5045d6665b}{OBJ\_AT}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux},\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy})) \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.uundetected = 0;
588 
589         \textcolor{comment}{/* position may need updating (invisible hero) */}
590         if (n\_picked) \hyperlink{display_8c_a185c6ad6e4c5a6be26a371b9aa17c32e}{newsym}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux},\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy});
591 
592         \textcolor{comment}{/* see whether there's anything else here, after auto-pickup is done */}
593         \textcolor{keywordflow}{if} (autopickup) \hyperlink{pickup_8c_aaa2596751167ec82657450be8202f869}{check\_here}(n\_picked > 0);
594     \}
595     \textcolor{keywordflow}{return} (n\_tried > 0);
596 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a766962d5f6ecef8bf6d2d20d470e9630}{\index{pickup.\+c@{pickup.\+c}!pickup\+\_\+object@{pickup\+\_\+object}}
\index{pickup\+\_\+object@{pickup\+\_\+object}!pickup.\+c@{pickup.\+c}}
\subsubsection[{pickup\+\_\+object}]{\setlength{\rightskip}{0pt plus 5cm}int pickup\+\_\+object (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{obj, }
\item[{long}]{count, }
\item[{{\bf boolean}}]{telekinesis}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a766962d5f6ecef8bf6d2d20d470e9630}


Definition at line 1238 of file pickup.\+c.



References A\+\_\+\+W\+I\+S, Blind, flag\+::botl, B\+U\+F\+S\+Z, C\+O\+I\+N\+\_\+\+C\+L\+A\+S\+S, count, monst\+::data, display\+\_\+nhwindow, F\+A\+L\+S\+E, flags, G\+O\+L\+D\+\_\+\+C\+A\+P\+A\+C\+I\+T\+Y, G\+O\+L\+D\+\_\+\+W\+T, is\+\_\+rider, lift\+\_\+object(), M\+O\+D\+\_\+\+E\+N\+C\+U\+M\+B\+E\+R, mons, mrg\+\_\+to\+\_\+wielded, objects, pick\+\_\+obj(), plur, flag\+::run, See\+\_\+invisible, S\+L\+T\+\_\+\+E\+N\+C\+U\+M\+B\+E\+R, Stone\+\_\+resistance, Strcpy, touch\+\_\+petrifies, T\+R\+U\+E, u, uarmg, uchain, you\+::ugold, uwep, you\+::ux, you\+::uy, W\+I\+N\+\_\+\+M\+E\+S\+S\+A\+G\+E, and youmonst.



Referenced by pickup().


\begin{DoxyCode}
1242 \{
1243     \textcolor{keywordtype}{int} res, nearload;
1244 \textcolor{preprocessor}{#ifndef GOLDOBJ}
1245     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\hyperlink{detect_8c_a8201fc0bfa35306851be2a25ab2d6263}{where} = (obj->\hyperlink{structobj_aac936c7da6b4f1eca0a94f75c242e5cc}{ox} == \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux} && obj->\hyperlink{structobj_a72dace5e678b56ae42c3fb19292e5839}{oy} == \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}) ?
1246                 \textcolor{stringliteral}{"here"} : \textcolor{stringliteral}{"there"};
1247 \textcolor{preprocessor}{#endif}
1248 
1249     \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} < \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}) \{
1250         impossible(\textcolor{stringliteral}{"pickup\_object: count %ld > quan %ld?"},
1251         \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}, obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan});
1252         \textcolor{keywordflow}{return} 0;
1253     \}
1254 
1255     \textcolor{comment}{/* In case of auto-pickup, where we haven't had a chance}
1256 \textcolor{comment}{       to look at it yet; affects docall(SCR\_SCARE\_MONSTER). */}
1257     \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind})
1258 \textcolor{preprocessor}{#ifdef INVISIBLE\_OBJECTS}
1259         \textcolor{keywordflow}{if} (!obj->oinvis || \hyperlink{youprop_8h_ae00ea7702fa1870643d604364b0640c7}{See\_invisible})
1260 \textcolor{preprocessor}{#endif}
1261         obj->dknown = 1;
1262 
1263     \textcolor{keywordflow}{if} (obj == \hyperlink{decl_8h_ac83f46f409b88c6d6109ed04938ad52a}{uchain}) \{    \textcolor{comment}{/* do not pick up attached chain */}
1264         \textcolor{keywordflow}{return} 0;
1265     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_af03ce8a6a0ca51e8d8954fb1a1a31fbe}{oartifact} && !touch\_artifact(obj,&\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst})) \{
1266         \textcolor{keywordflow}{return} 0;
1267 \textcolor{preprocessor}{#ifndef GOLDOBJ}
1268     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == \hyperlink{objclass_8h_a2999621925083659147349e261e4cb3d}{COIN\_CLASS}) \{
1269         \textcolor{comment}{/* Special consideration for gold pieces... */}
1270         \textcolor{keywordtype}{long} iw = (long)max\_capacity() - \hyperlink{pickup_8c_afbfc857d93577b5d4da51fc660872f38}{GOLD\_WT}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold});
1271         \textcolor{keywordtype}{long} gold\_capacity = \hyperlink{pickup_8c_aa22e190bbd8fa281f694657c0f161f3e}{GOLD\_CAPACITY}(iw, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold});
1272 
1273         \textcolor{keywordflow}{if} (gold\_capacity <= 0L) \{
1274         pline(
1275            \textcolor{stringliteral}{"There %s %ld gold piece%s %s, but you cannot carry any more."},
1276               otense(obj, \textcolor{stringliteral}{"are"}),
1277               obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan}, \hyperlink{hack_8h_a6ed0ab51b12ebf31e060e3dd26394db0}{plur}(obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan}), where);
1278         \textcolor{keywordflow}{return} 0;
1279         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (gold\_capacity < \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}) \{
1280         You(\textcolor{stringliteral}{"can only %s %s of the %ld gold pieces lying %s."},
1281             telekinesis ? \textcolor{stringliteral}{"acquire"} : \textcolor{stringliteral}{"carry"},
1282             gold\_capacity == 1L ? \textcolor{stringliteral}{"one"} : \textcolor{stringliteral}{"some"}, obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan}, where);
1283         pline(\textcolor{stringliteral}{"%s %ld gold piece%s."},
1284             \hyperlink{pickup_8c_a74c9304356d6e805b16fb8cd0ad4de59}{nearloadmsg}, gold\_capacity, \hyperlink{hack_8h_a6ed0ab51b12ebf31e060e3dd26394db0}{plur}(gold\_capacity));
1285         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold} += gold\_capacity;
1286         obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} -= gold\_capacity;
1287         costly\_gold(obj->\hyperlink{structobj_aac936c7da6b4f1eca0a94f75c242e5cc}{ox}, obj->\hyperlink{structobj_a72dace5e678b56ae42c3fb19292e5839}{oy}, gold\_capacity);
1288         \} \textcolor{keywordflow}{else} \{
1289         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold} += \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
1290         \textcolor{keywordflow}{if} ((nearload = near\_capacity()) != 0)
1291             pline(\textcolor{stringliteral}{"%s %ld gold piece%s."},
1292               nearload < \hyperlink{hack_8h_a3c3899e355380d08f5d23828908c3679}{MOD\_ENCUMBER} ?
1293               \hyperlink{pickup_8c_a46ed6db9f3f1bd6fbc51981cc1c3b6ce}{moderateloadmsg} : \hyperlink{pickup_8c_a74c9304356d6e805b16fb8cd0ad4de59}{nearloadmsg},
1294               \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}, \hyperlink{hack_8h_a6ed0ab51b12ebf31e060e3dd26394db0}{plur}(\hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}));
1295         \textcolor{keywordflow}{else}
1296             prinv((\textcolor{keywordtype}{char} *) 0, obj, \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count});
1297         costly\_gold(obj->\hyperlink{structobj_aac936c7da6b4f1eca0a94f75c242e5cc}{ox}, obj->\hyperlink{structobj_a72dace5e678b56ae42c3fb19292e5839}{oy}, \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count});
1298         \textcolor{keywordflow}{if} (\hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count} == obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan})
1299             delobj(obj);
1300         \textcolor{keywordflow}{else}
1301             obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} -= \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
1302         \}
1303         \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a51f16d01a910b52fdf0c05a44739f7d8}{botl} = 1;
1304         \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a75d9c7e384cce1696f2c2d1b2881d162}{run}) nomul(0);
1305         \textcolor{keywordflow}{return} 1;
1306 \textcolor{preprocessor}{#endif}
1307     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == CORPSE) \{
1308         \textcolor{keywordflow}{if} ( (\hyperlink{mondata_8h_ad1e85e493d27cdfdbe94c43710c4b191}{touch\_petrifies}(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[obj->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm}])) && !
      \hyperlink{decl_8h_a374ab5e4582cfafa2d4ef57211f53293}{uarmg}
1309                 && !\hyperlink{youprop_8h_a90b638323d50e1f8d52d4a9576d90551}{Stone\_resistance} && !telekinesis) \{
1310         \textcolor{keywordflow}{if} (poly\_when\_stoned(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) && polymon(PM\_STONE\_GOLEM))
1311             \hyperlink{winprocs_8h_ac8e74d03fbb65b9f5651e63d79bebc60}{display\_nhwindow}(\hyperlink{decl_8h_a4a1cc9e693dbdfad3ea32b10ce19f337}{WIN\_MESSAGE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1312         \textcolor{keywordflow}{else} \{
1313             \textcolor{keywordtype}{char} kbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
1314 
1315             \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(kbuf, an(corpse\_xname(obj, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE})));
1316             pline(\textcolor{stringliteral}{"Touching %s is a fatal mistake."}, kbuf);
1317             instapetrify(kbuf);
1318             \textcolor{keywordflow}{return} -1;
1319         \}
1320         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_ae65c0c7b92cbe7cb6e8550523ef4f175}{is\_rider}(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[obj->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm}])) \{
1321         pline(\textcolor{stringliteral}{"At your %s, the corpse suddenly moves..."},
1322             telekinesis ? \textcolor{stringliteral}{"attempted acquisition"} : \textcolor{stringliteral}{"touch"});
1323         (void) revive\_corpse(obj);
1324         exercise(\hyperlink{attrib_8h_a4206d6431732a698ede8a237d5c17142}{A\_WIS}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1325         \textcolor{keywordflow}{return} -1;
1326         \}
1327     \} \textcolor{keywordflow}{else}  \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == SCR\_SCARE\_MONSTER) \{
1328         \textcolor{keywordflow}{if} (obj->blessed) obj->blessed = 0;
1329         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!obj->\hyperlink{structobj_a14fc8dc59e9073bfbf1e170875a98448}{spe} && !obj->cursed) obj->\hyperlink{structobj_a14fc8dc59e9073bfbf1e170875a98448}{spe} = 1;
1330         \textcolor{keywordflow}{else} \{
1331         pline\_The(\textcolor{stringliteral}{"scroll%s %s to dust as you %s %s up."},
1332             \hyperlink{hack_8h_a6ed0ab51b12ebf31e060e3dd26394db0}{plur}(obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan}), otense(obj, \textcolor{stringliteral}{"turn"}),
1333             telekinesis ? \textcolor{stringliteral}{"raise"} : \textcolor{stringliteral}{"pick"},
1334             (obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} == 1L) ? \textcolor{stringliteral}{"it"} : \textcolor{stringliteral}{"them"});
1335         \textcolor{keywordflow}{if} (!(\hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[SCR\_SCARE\_MONSTER].oc\_name\_known) &&
1336                     !(\hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[SCR\_SCARE\_MONSTER].oc\_uname))
1337             docall(obj);
1338         useupf(obj, obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan});
1339         \textcolor{keywordflow}{return} 1;   \textcolor{comment}{/* tried to pick something up and failed, but}
1340 \textcolor{comment}{                   don't want to terminate pickup loop yet   */}
1341         \}
1342     \}
1343 
1344     \textcolor{keywordflow}{if} ((res = \hyperlink{pickup_8c_afc20ba70668bc135322317c55743f068}{lift\_object}(obj, (\textcolor{keyword}{struct} obj *)0, &\hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count}, telekinesis)) <= 0)
1345         \textcolor{keywordflow}{return} res;
1346 
1347 \textcolor{preprocessor}{#ifdef GOLDOBJ}
1348         \textcolor{comment}{/* Whats left of the special case for gold :-) */}
1349     \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == \hyperlink{objclass_8h_a2999621925083659147349e261e4cb3d}{COIN\_CLASS}) \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a51f16d01a910b52fdf0c05a44739f7d8}{botl} = 1;
1350 \textcolor{preprocessor}{#endif}
1351     \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan} != \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count} && obj->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} != LOADSTONE)
1352         obj = splitobj(obj, \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count});
1353 
1354     obj = \hyperlink{pickup_8c_aa9b25e3f7e59ea0f9951b9760553c30b}{pick\_obj}(obj);
1355 
1356     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} && \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} == obj) \hyperlink{decl_8h_ab20988d94d4cb4984394d2f17c1083e1}{mrg\_to\_wielded} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1357     nearload = near\_capacity();
1358     prinv(nearload == \hyperlink{hack_8h_ade4c50a25545e7ca7eba7d45383be984}{SLT\_ENCUMBER} ? \hyperlink{pickup_8c_a46ed6db9f3f1bd6fbc51981cc1c3b6ce}{moderateloadmsg} : (\textcolor{keywordtype}{char} *) 0,
1359           obj, \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count});
1360     \hyperlink{decl_8h_ab20988d94d4cb4984394d2f17c1083e1}{mrg\_to\_wielded} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1361     \textcolor{keywordflow}{return} 1;
1362 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a728a862fbc9e9cbf54e8663c8b1dc0fd}{\index{pickup.\+c@{pickup.\+c}!query\+\_\+category@{query\+\_\+category}}
\index{query\+\_\+category@{query\+\_\+category}!pickup.\+c@{pickup.\+c}}
\subsubsection[{query\+\_\+category}]{\setlength{\rightskip}{0pt plus 5cm}int query\+\_\+category (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{qstr, }
\item[{struct {\bf obj} $\ast$}]{olist, }
\item[{int}]{qflags, }
\item[{{\bf menu\+\_\+item} $\ast$$\ast$}]{pick\+\_\+list, }
\item[{int}]{how}
\end{DoxyParamCaption}
) const}}\label{pickup_8c_a728a862fbc9e9cbf54e8663c8b1dc0fd}


Definition at line 784 of file pickup.\+c.



References any\+::a\+\_\+int, any\+::a\+\_\+void, add\+\_\+menu, A\+L\+L\+\_\+\+T\+Y\+P\+E\+S, A\+L\+L\+\_\+\+T\+Y\+P\+E\+S\+\_\+\+S\+E\+L\+E\+C\+T\+E\+D, alloc(), A\+T\+R\+\_\+\+N\+O\+N\+E, B\+I\+L\+L\+E\+D\+\_\+\+T\+Y\+P\+E\+S, B\+U\+C\+\_\+\+B\+L\+E\+S\+S\+E\+D, B\+U\+C\+\_\+\+C\+U\+R\+S\+E\+D, B\+U\+C\+\_\+\+U\+N\+C\+U\+R\+S\+E\+D, B\+U\+C\+\_\+\+U\+N\+K\+N\+O\+W\+N, C\+H\+O\+O\+S\+E\+\_\+\+A\+L\+L, count\+\_\+categories(), create\+\_\+nhwindow, def\+\_\+oc\+\_\+syms, destroy\+\_\+nhwindow, end\+\_\+menu, F\+A\+L\+S\+E, flags, F\+O\+L\+L\+O\+W, flag\+::inv\+\_\+order, obj\+::invlet, M\+E\+N\+U\+\_\+\+U\+N\+S\+E\+L\+E\+C\+T\+E\+D, N\+H\+W\+\_\+\+M\+E\+N\+U, N\+O\+\_\+\+G\+L\+Y\+P\+H, objects, objclass\+::oc\+\_\+class, obj\+::oclass, obj\+::otyp, obj\+::owornmask, select\+\_\+menu, start\+\_\+menu, T\+R\+U\+E, U\+N\+P\+A\+I\+D\+\_\+\+T\+Y\+P\+E\+S, W\+\_\+\+A\+M\+U\+L, W\+\_\+\+A\+R\+M\+O\+R, W\+\_\+\+Q\+U\+I\+V\+E\+R, W\+\_\+\+R\+I\+N\+G, W\+\_\+\+S\+W\+A\+P\+W\+E\+P, W\+\_\+\+T\+O\+O\+L, W\+\_\+\+W\+E\+P, and W\+O\+R\+N\+\_\+\+T\+Y\+P\+E\+S.



Referenced by menu\+\_\+loot().


\begin{DoxyCode}
790 \{
791     \textcolor{keywordtype}{int} n;
792     \hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} win;
793     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *curr;
794     \textcolor{keywordtype}{char} *pack;
795     \hyperlink{unionany}{anything} \hyperlink{unionany}{any};
796     \textcolor{keywordtype}{boolean} collected\_type\_name;
797     \textcolor{keywordtype}{char} \hyperlink{structobj_a15d874124e5aacf167531decaca972b8}{invlet};
798     \textcolor{keywordtype}{int} ccount;
799     \textcolor{keywordtype}{boolean} do\_unpaid = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
800     \textcolor{keywordtype}{boolean} do\_blessed = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, do\_cursed = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, do\_uncursed = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE},
801         do\_buc\_unknown = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
802     \textcolor{keywordtype}{int} num\_buc\_types = 0;
803 
804     *pick\_list = (\hyperlink{structmi}{menu\_item} *) 0;
805     \textcolor{keywordflow}{if} (!olist) \textcolor{keywordflow}{return} 0;
806     \textcolor{keywordflow}{if} ((qflags & \hyperlink{hack_8h_a874b4164e2fec0110f08b877fffc4678}{UNPAID\_TYPES}) && count\_unpaid(olist)) do\_unpaid = 
      \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
807     \textcolor{keywordflow}{if} ((qflags & \hyperlink{hack_8h_a28cfc0465126c3957df3f0756e237bf8}{BUC\_BLESSED}) && count\_buc(olist, BUC\_BLESSED)) \{
808         do\_blessed = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
809         num\_buc\_types++;
810     \}
811     \textcolor{keywordflow}{if} ((qflags & \hyperlink{hack_8h_a948c469209e20c15df98beee48514a64}{BUC\_CURSED}) && count\_buc(olist, BUC\_CURSED)) \{
812         do\_cursed = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
813         num\_buc\_types++;
814     \}
815     \textcolor{keywordflow}{if} ((qflags & \hyperlink{hack_8h_ace47c6b9fd9594fc2885792f9041529f}{BUC\_UNCURSED}) && count\_buc(olist, BUC\_UNCURSED)) \{
816         do\_uncursed = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
817         num\_buc\_types++;
818     \}
819     \textcolor{keywordflow}{if} ((qflags & \hyperlink{hack_8h_a2cd13c4a158f4955dc658f4badb3c138}{BUC\_UNKNOWN}) && count\_buc(olist, BUC\_UNKNOWN)) \{
820         do\_buc\_unknown = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
821         num\_buc\_types++;
822     \}
823 
824     ccount = \hyperlink{pickup_8c_af32126808aff7b5b4031513023beb462}{count\_categories}(olist, qflags);
825     \textcolor{comment}{/* no point in actually showing a menu for a single category */}
826     \textcolor{keywordflow}{if} (ccount == 1 && !do\_unpaid && num\_buc\_types <= 1 && !(qflags & 
      \hyperlink{hack_8h_a40ae5c01cefa8ee0a353726a168a649f}{BILLED\_TYPES})) \{
827         \textcolor{keywordflow}{for} (curr = olist; curr; curr = \hyperlink{pickup_8c_ad9881e8c0343df60fbfd87242384fc87}{FOLLOW}(curr, qflags)) \{
828         \textcolor{keywordflow}{if} ((qflags & \hyperlink{hack_8h_adfd4db58219bfc2b13b62daac9e14ee3}{WORN\_TYPES}) &&
829             !(curr->\hyperlink{structobj_a7906e045755ba4099705764a4eb076c6}{owornmask} & (\hyperlink{prop_8h_afb4c914cfecbde6972d893bc33e10aa9}{W\_ARMOR}|\hyperlink{prop_8h_a855614df1627862ffc73bf31e283b7b9}{W\_RING}|\hyperlink{prop_8h_a1a4f9d6f31538cc9d677e617b49597d2}{W\_AMUL}|
      \hyperlink{prop_8h_ac2c824bec7fcb9f986b9e905d1f5ee8a}{W\_TOOL}|\hyperlink{prop_8h_abd75a55f67b13523ef4377d4eb6fb6ad}{W\_WEP}|\hyperlink{prop_8h_a4571f54e71d38d81a610eaf77e5fecd9}{W\_SWAPWEP}|\hyperlink{prop_8h_a9b95d7c6e22f325a5bc0326d7673a4f4}{W\_QUIVER})))
830             \textcolor{keywordflow}{continue};
831         \textcolor{keywordflow}{break};
832         \}
833         \textcolor{keywordflow}{if} (curr) \{
834         *pick\_list = (\hyperlink{structmi}{menu\_item} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(\textcolor{keyword}{sizeof}(\hyperlink{structmi}{menu\_item}));
835         (*pick\_list)->item.a\_int = curr->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass};
836         \textcolor{keywordflow}{return} 1;
837         \} \textcolor{keywordflow}{else} \{
838 \textcolor{preprocessor}{#ifdef DEBUG}
839         impossible(\textcolor{stringliteral}{"query\_category: no single object match"});
840 \textcolor{preprocessor}{#endif}
841         \}
842         \textcolor{keywordflow}{return} 0;
843     \}
844 
845     win = \hyperlink{winprocs_8h_aa13fb35379049d1836397492d10b6b0c}{create\_nhwindow}(\hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU});
846     \hyperlink{winprocs_8h_a466fbda9d8533b050350184f5a095617}{start\_menu}(win);
847     pack = \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_afbbdabb7b1593b8ff0036a5c67ece86f}{inv\_order};
848     \textcolor{keywordflow}{if} ((qflags & \hyperlink{hack_8h_affe70acbccd9ee8ce30b7699adfc3070}{ALL\_TYPES}) && (ccount > 1)) \{
849         invlet = \textcolor{charliteral}{'a'};
850         any.\hyperlink{unionany_a570c320f6790aab4b51733abc54827d7}{a\_void} = 0;
851         any.\hyperlink{unionany_aae9fa40e12da390154868ea24a96c561}{a\_int} = \hyperlink{hack_8h_a0dd263622e82f8ca92192bda0b95e72d}{ALL\_TYPES\_SELECTED};
852         \hyperlink{winprocs_8h_a67d909f9e2dbdf82e7af48ed950c0e07}{add\_menu}(win, \hyperlink{display_8h_ac36b9cc8436af3cf1f7f9919878d8354}{NO\_GLYPH}, &any, invlet, 0, \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE},
853                (qflags & \hyperlink{hack_8h_adfd4db58219bfc2b13b62daac9e14ee3}{WORN\_TYPES}) ? \textcolor{stringliteral}{"All worn types"} : \textcolor{stringliteral}{"All types"},
854             \hyperlink{hack_8h_a1b4cfefbc89386fb8977794f02b0a13c}{MENU\_UNSELECTED});
855         invlet = \textcolor{charliteral}{'b'};
856     \} \textcolor{keywordflow}{else}
857         invlet = \textcolor{charliteral}{'a'};
858     \textcolor{keywordflow}{do} \{
859         collected\_type\_name = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
860         \textcolor{keywordflow}{for} (curr = olist; curr; curr = \hyperlink{pickup_8c_ad9881e8c0343df60fbfd87242384fc87}{FOLLOW}(curr, qflags)) \{
861         \textcolor{keywordflow}{if} (curr->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == *pack) \{
862            \textcolor{keywordflow}{if} ((qflags & \hyperlink{hack_8h_adfd4db58219bfc2b13b62daac9e14ee3}{WORN\_TYPES}) &&
863                 !(curr->\hyperlink{structobj_a7906e045755ba4099705764a4eb076c6}{owornmask} & (\hyperlink{prop_8h_afb4c914cfecbde6972d893bc33e10aa9}{W\_ARMOR} | \hyperlink{prop_8h_a855614df1627862ffc73bf31e283b7b9}{W\_RING} | 
      \hyperlink{prop_8h_a1a4f9d6f31538cc9d677e617b49597d2}{W\_AMUL} | \hyperlink{prop_8h_ac2c824bec7fcb9f986b9e905d1f5ee8a}{W\_TOOL} |
864                 \hyperlink{prop_8h_abd75a55f67b13523ef4377d4eb6fb6ad}{W\_WEP} | \hyperlink{prop_8h_a4571f54e71d38d81a610eaf77e5fecd9}{W\_SWAPWEP} | \hyperlink{prop_8h_a9b95d7c6e22f325a5bc0326d7673a4f4}{W\_QUIVER})))
865              \textcolor{keywordflow}{continue};
866            \textcolor{keywordflow}{if} (!collected\_type\_name) \{
867             any.\hyperlink{unionany_a570c320f6790aab4b51733abc54827d7}{a\_void} = 0;
868             any.\hyperlink{unionany_aae9fa40e12da390154868ea24a96c561}{a\_int} = curr->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass};
869             \hyperlink{winprocs_8h_a67d909f9e2dbdf82e7af48ed950c0e07}{add\_menu}(win, \hyperlink{display_8h_ac36b9cc8436af3cf1f7f9919878d8354}{NO\_GLYPH}, &any, invlet++,
870                 \hyperlink{decl_8h_ab2de6953c2db763f00d7f3baf830fe50}{def\_oc\_syms}[(\textcolor{keywordtype}{int})\hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[curr->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp}].
      \hyperlink{structobjclass_ae589e91e556e204c84f05597da510559}{oc\_class}],
871                 \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE}, let\_to\_name(*pack, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}),
872                 \hyperlink{hack_8h_a1b4cfefbc89386fb8977794f02b0a13c}{MENU\_UNSELECTED});
873             collected\_type\_name = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
874            \}
875         \}
876         \}
877         pack++;
878         \textcolor{keywordflow}{if} (invlet >= \textcolor{charliteral}{'u'}) \{
879         impossible(\textcolor{stringliteral}{"query\_category: too many categories"});
880         \textcolor{keywordflow}{return} 0;
881         \}
882     \} \textcolor{keywordflow}{while} (*pack);
883     \textcolor{comment}{/* unpaid items if there are any */}
884     \textcolor{keywordflow}{if} (do\_unpaid) \{
885         invlet = \textcolor{charliteral}{'u'};
886         any.\hyperlink{unionany_a570c320f6790aab4b51733abc54827d7}{a\_void} = 0;
887         any.\hyperlink{unionany_aae9fa40e12da390154868ea24a96c561}{a\_int} = \textcolor{charliteral}{'u'};
888         \hyperlink{winprocs_8h_a67d909f9e2dbdf82e7af48ed950c0e07}{add\_menu}(win, \hyperlink{display_8h_ac36b9cc8436af3cf1f7f9919878d8354}{NO\_GLYPH}, &any, invlet, 0, \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE},
889             \textcolor{stringliteral}{"Unpaid items"}, \hyperlink{hack_8h_a1b4cfefbc89386fb8977794f02b0a13c}{MENU\_UNSELECTED});
890     \}
891     \textcolor{comment}{/* billed items: checked by caller, so always include if BILLED\_TYPES */}
892     \textcolor{keywordflow}{if} (qflags & BILLED\_TYPES) \{
893         invlet = \textcolor{charliteral}{'x'};
894         any.\hyperlink{unionany_a570c320f6790aab4b51733abc54827d7}{a\_void} = 0;
895         any.\hyperlink{unionany_aae9fa40e12da390154868ea24a96c561}{a\_int} = \textcolor{charliteral}{'x'};
896         \hyperlink{winprocs_8h_a67d909f9e2dbdf82e7af48ed950c0e07}{add\_menu}(win, \hyperlink{display_8h_ac36b9cc8436af3cf1f7f9919878d8354}{NO\_GLYPH}, &any, invlet, 0, \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE},
897              \textcolor{stringliteral}{"Unpaid items already used up"}, \hyperlink{hack_8h_a1b4cfefbc89386fb8977794f02b0a13c}{MENU\_UNSELECTED});
898     \}
899     \textcolor{keywordflow}{if} (qflags & \hyperlink{hack_8h_a486d7929be45b366cf2c8c15f27e39b6}{CHOOSE\_ALL}) \{
900         invlet = \textcolor{charliteral}{'A'};
901         any.\hyperlink{unionany_a570c320f6790aab4b51733abc54827d7}{a\_void} = 0;
902         any.\hyperlink{unionany_aae9fa40e12da390154868ea24a96c561}{a\_int} = \textcolor{charliteral}{'A'};
903         \hyperlink{winprocs_8h_a67d909f9e2dbdf82e7af48ed950c0e07}{add\_menu}(win, \hyperlink{display_8h_ac36b9cc8436af3cf1f7f9919878d8354}{NO\_GLYPH}, &any, invlet, 0, \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE},
904             (qflags & WORN\_TYPES) ?
905             \textcolor{stringliteral}{"Auto-select every item being worn"} :
906             \textcolor{stringliteral}{"Auto-select every item"}, \hyperlink{hack_8h_a1b4cfefbc89386fb8977794f02b0a13c}{MENU\_UNSELECTED});
907     \}
908     \textcolor{comment}{/* items with b/u/c/unknown if there are any */}
909     \textcolor{keywordflow}{if} (do\_blessed) \{
910         invlet = \textcolor{charliteral}{'B'};
911         any.\hyperlink{unionany_a570c320f6790aab4b51733abc54827d7}{a\_void} = 0;
912         any.\hyperlink{unionany_aae9fa40e12da390154868ea24a96c561}{a\_int} = \textcolor{charliteral}{'B'};
913         \hyperlink{winprocs_8h_a67d909f9e2dbdf82e7af48ed950c0e07}{add\_menu}(win, \hyperlink{display_8h_ac36b9cc8436af3cf1f7f9919878d8354}{NO\_GLYPH}, &any, invlet, 0, \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE},
914             \textcolor{stringliteral}{"Items known to be Blessed"}, \hyperlink{hack_8h_a1b4cfefbc89386fb8977794f02b0a13c}{MENU\_UNSELECTED});
915     \}
916     \textcolor{keywordflow}{if} (do\_cursed) \{
917         invlet = \textcolor{charliteral}{'C'};
918         any.\hyperlink{unionany_a570c320f6790aab4b51733abc54827d7}{a\_void} = 0;
919         any.\hyperlink{unionany_aae9fa40e12da390154868ea24a96c561}{a\_int} = \textcolor{charliteral}{'C'};
920         \hyperlink{winprocs_8h_a67d909f9e2dbdf82e7af48ed950c0e07}{add\_menu}(win, \hyperlink{display_8h_ac36b9cc8436af3cf1f7f9919878d8354}{NO\_GLYPH}, &any, invlet, 0, \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE},
921             \textcolor{stringliteral}{"Items known to be Cursed"}, \hyperlink{hack_8h_a1b4cfefbc89386fb8977794f02b0a13c}{MENU\_UNSELECTED});
922     \}
923     \textcolor{keywordflow}{if} (do\_uncursed) \{
924         invlet = \textcolor{charliteral}{'U'};
925         any.\hyperlink{unionany_a570c320f6790aab4b51733abc54827d7}{a\_void} = 0;
926         any.\hyperlink{unionany_aae9fa40e12da390154868ea24a96c561}{a\_int} = \textcolor{charliteral}{'U'};
927         \hyperlink{winprocs_8h_a67d909f9e2dbdf82e7af48ed950c0e07}{add\_menu}(win, \hyperlink{display_8h_ac36b9cc8436af3cf1f7f9919878d8354}{NO\_GLYPH}, &any, invlet, 0, \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE},
928             \textcolor{stringliteral}{"Items known to be Uncursed"}, \hyperlink{hack_8h_a1b4cfefbc89386fb8977794f02b0a13c}{MENU\_UNSELECTED});
929     \}
930     \textcolor{keywordflow}{if} (do\_buc\_unknown) \{
931         invlet = \textcolor{charliteral}{'X'};
932         any.\hyperlink{unionany_a570c320f6790aab4b51733abc54827d7}{a\_void} = 0;
933         any.\hyperlink{unionany_aae9fa40e12da390154868ea24a96c561}{a\_int} = \textcolor{charliteral}{'X'};
934         \hyperlink{winprocs_8h_a67d909f9e2dbdf82e7af48ed950c0e07}{add\_menu}(win, \hyperlink{display_8h_ac36b9cc8436af3cf1f7f9919878d8354}{NO\_GLYPH}, &any, invlet, 0, \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE},
935             \textcolor{stringliteral}{"Items of unknown B/C/U status"},
936             \hyperlink{hack_8h_a1b4cfefbc89386fb8977794f02b0a13c}{MENU\_UNSELECTED});
937     \}
938     \hyperlink{winprocs_8h_a26f49f5dfc880f4a810f61b5beae4a71}{end\_menu}(win, qstr);
939     n = \hyperlink{winprocs_8h_afdaac8ee2b6bdd0a0045b81a0cfbe1fc}{select\_menu}(win, how, pick\_list);
940     \hyperlink{winprocs_8h_a77ac4f50de0eedeaead791812762c6a0}{destroy\_nhwindow}(win);
941     \textcolor{keywordflow}{if} (n < 0)
942         n = 0;  \textcolor{comment}{/* caller's don't expect -1 */}
943     \textcolor{keywordflow}{return} n;
944 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a4f84d70771d90362fe0ee76b5dde91f5}{\index{pickup.\+c@{pickup.\+c}!query\+\_\+classes@{query\+\_\+classes}}
\index{query\+\_\+classes@{query\+\_\+classes}!pickup.\+c@{pickup.\+c}}
\subsubsection[{query\+\_\+classes}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} query\+\_\+classes (
\begin{DoxyParamCaption}
\item[{oclasses}]{, }
\item[{{\bf boolean} $\ast$}]{one\+\_\+at\+\_\+a\+\_\+time, }
\item[{{\bf boolean} $\ast$}]{everything, }
\item[{{\bf const} char $\ast$}]{action, }
\item[{struct {\bf obj} $\ast$}]{objs, }
\item[{{\bf boolean}}]{here, }
\item[{{\bf boolean}}]{incl\+\_\+gold, }
\item[{int $\ast$}]{menu\+\_\+on\+\_\+demand}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a4f84d70771d90362fe0ee76b5dde91f5}


Definition at line 142 of file pickup.\+c.



References add\+\_\+valid\+\_\+menu\+\_\+class(), B\+U\+F\+S\+Z, collect\+\_\+obj\+\_\+classes(), def\+\_\+char\+\_\+to\+\_\+objclass(), F\+A\+L\+S\+E, F\+D\+E\+C\+L(), getlin, inbuf, index(), invent, Q\+B\+U\+F\+S\+Z, simple\+\_\+look(), Sprintf, T\+R\+U\+E, and where.



Referenced by pickup(), and use\+\_\+container().


\begin{DoxyCode}
161 \{
162     \textcolor{keywordtype}{char} ilets[20], \hyperlink{winmap_8c_a0c678a8351750fc7e2221f2431974581}{inbuf}[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
163     \textcolor{keywordtype}{int} iletct, oclassct;
164     \textcolor{keywordtype}{boolean} not\_everything;
165     \textcolor{keywordtype}{char} qbuf[\hyperlink{global_8h_a1bb6bf3db7bf52ca1e9fa8fbcd6e9630}{QBUFSZ}];
166     \textcolor{keywordtype}{boolean} m\_seen;
167     \textcolor{keywordtype}{int} itemcount;
168 
169     oclasses[oclassct = 0] = \textcolor{charliteral}{'\(\backslash\)0'};
170     *one\_at\_a\_time = *everything = m\_seen = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
171     iletct = \hyperlink{pickup_8c_a77b7485059911d3dd89bc5893dc7c1ea}{collect\_obj\_classes}(ilets, objs, here,
172 #ifndef GOLDOBJ
173                      incl\_gold,
174 #endif
175                      (\textcolor{keywordtype}{boolean} \hyperlink{pickup_8c_a9c6a606ae174d0b8480f4bfbe2274728}{FDECL}((*),(\hyperlink{global_8h_a0b35ac15910ff1522ede7503fd6afe1c}{OBJ\_P}))) 0, &itemcount);
176     \textcolor{keywordflow}{if} (iletct == 0) \{
177         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
178     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (iletct == 1) \{
179         oclasses[0] = \hyperlink{drawing_8c_a590c649cc5a0ec129bc65368e7202b55}{def\_char\_to\_objclass}(ilets[0]);
180         oclasses[1] = \textcolor{charliteral}{'\(\backslash\)0'};
181         \textcolor{keywordflow}{if} (itemcount && menu\_on\_demand) \{
182             ilets[iletct++] = \textcolor{charliteral}{'m'};
183             *menu\_on\_demand = 0;
184             ilets[iletct] = \textcolor{charliteral}{'\(\backslash\)0'};
185         \}
186     \} \textcolor{keywordflow}{else}  \{   \textcolor{comment}{/* more than one choice available */}
187         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\hyperlink{detect_8c_a8201fc0bfa35306851be2a25ab2d6263}{where} = 0;
188         \textcolor{keyword}{register} \textcolor{keywordtype}{char} sym, oc\_of\_sym, *p;
189         \textcolor{comment}{/* additional choices */}
190         ilets[iletct++] = \textcolor{charliteral}{' '};
191         ilets[iletct++] = \textcolor{charliteral}{'a'};
192         ilets[iletct++] = \textcolor{charliteral}{'A'};
193         ilets[iletct++] = (objs == \hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent} ? \textcolor{charliteral}{'i'} : \textcolor{charliteral}{':'});
194         \textcolor{keywordflow}{if} (menu\_on\_demand) \{
195             ilets[iletct++] = \textcolor{charliteral}{'m'};
196             *menu\_on\_demand = 0;
197         \}
198         ilets[iletct] = \textcolor{charliteral}{'\(\backslash\)0'};
199 ask\_again:
200         oclasses[oclassct = 0] = \textcolor{charliteral}{'\(\backslash\)0'};
201         *one\_at\_a\_time = *everything = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
202         not\_everything = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
203         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(qbuf,\textcolor{stringliteral}{"What kinds of thing do you want to %s? [%s]"},
204             action, ilets);
205         \hyperlink{winprocs_8h_ab09682cb017e224c23b0c4e7989a81a7}{getlin}(qbuf,inbuf);
206         \textcolor{keywordflow}{if} (*inbuf == \textcolor{charliteral}{'\(\backslash\)033'}) \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
207 
208         \textcolor{keywordflow}{for} (p = inbuf; (sym = *p++); ) \{
209             \textcolor{comment}{/* new A function (selective all) added by GAN 01/09/87 */}
210             \textcolor{keywordflow}{if} (sym == \textcolor{charliteral}{' '}) \textcolor{keywordflow}{continue};
211             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sym == \textcolor{charliteral}{'A'}) *one\_at\_a\_time = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
212             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sym == \textcolor{charliteral}{'a'}) *everything = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
213             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sym == \textcolor{charliteral}{':'}) \{
214             \hyperlink{pickup_8c_a2d57788c7582f93a86e16f80b91ec4b9}{simple\_look}(objs, here);  \textcolor{comment}{/* dumb if objs==invent */}
215             \textcolor{keywordflow}{goto} ask\_again;
216             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sym == \textcolor{charliteral}{'i'}) \{
217             (void) display\_inventory((\textcolor{keywordtype}{char} *)0, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
218             \textcolor{keywordflow}{goto} ask\_again;
219             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sym == \textcolor{charliteral}{'m'}) \{
220             m\_seen = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
221             \} \textcolor{keywordflow}{else} \{
222             oc\_of\_sym = \hyperlink{drawing_8c_a590c649cc5a0ec129bc65368e7202b55}{def\_char\_to\_objclass}(sym);
223             \textcolor{keywordflow}{if} (\hyperlink{uudecode_8c_ac82f3cc16110a05458f2b2483236afb7}{index}(ilets,sym)) \{
224                 \hyperlink{pickup_8c_a3a3907f1a05bd3d2eacfd77cd041536c}{add\_valid\_menu\_class}(oc\_of\_sym);
225                 oclasses[oclassct++] = oc\_of\_sym;
226                 oclasses[oclassct] = \textcolor{charliteral}{'\(\backslash\)0'};
227             \} \textcolor{keywordflow}{else} \{
228                 \textcolor{keywordflow}{if} (!where)
229                 where = !strcmp(action,\textcolor{stringliteral}{"pick up"})  ? \textcolor{stringliteral}{"here"} :
230                     !strcmp(action,\textcolor{stringliteral}{"take out"}) ?
231                                 \textcolor{stringliteral}{"inside"} : \textcolor{stringliteral}{""};
232                 \textcolor{keywordflow}{if} (*where)
233                 There(\textcolor{stringliteral}{"are no %c's %s."}, sym, where);
234                 \textcolor{keywordflow}{else}
235                 You(\textcolor{stringliteral}{"have no %c's."}, sym);
236                 not\_everything = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
237             \}
238             \}
239         \}
240         \textcolor{keywordflow}{if} (m\_seen && menu\_on\_demand) \{
241             *menu\_on\_demand = (*everything || !oclassct) ? -2 : -3;
242             \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
243         \}
244         \textcolor{keywordflow}{if} (!oclassct && (!*everything || not\_everything)) \{
245             \textcolor{comment}{/* didn't pick anything,}
246 \textcolor{comment}{               or tried to pick something that's not present */}
247             *one\_at\_a\_time = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};  \textcolor{comment}{/* force 'A' */}
248             *everything = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};   \textcolor{comment}{/* inhibit 'a' */}
249         \}
250     \}
251     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
252 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a40f3b140b744aff03e62fec624f927d0}{\index{pickup.\+c@{pickup.\+c}!query\+\_\+objlist@{query\+\_\+objlist}}
\index{query\+\_\+objlist@{query\+\_\+objlist}!pickup.\+c@{pickup.\+c}}
\subsubsection[{query\+\_\+objlist}]{\setlength{\rightskip}{0pt plus 5cm}int query\+\_\+objlist (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{qstr, }
\item[{struct {\bf obj} $\ast$}]{olist, }
\item[{int}]{qflags, }
\item[{{\bf menu\+\_\+item} $\ast$$\ast$}]{pick\+\_\+list, }
\item[{int}]{how, }
\item[{allow}]{}
\end{DoxyParamCaption}
) const}}\label{pickup_8c_a40f3b140b744aff03e62fec624f927d0}


Definition at line 685 of file pickup.\+c.



References any\+::a\+\_\+obj, add\+\_\+menu, alloc(), A\+T\+R\+\_\+\+N\+O\+N\+E, A\+U\+T\+O\+S\+E\+L\+E\+C\+T\+\_\+\+S\+I\+N\+G\+L\+E, mi\+::count, create\+\_\+nhwindow, def\+\_\+oc\+\_\+syms, destroy\+\_\+nhwindow, end\+\_\+menu, F\+A\+L\+S\+E, F\+E\+E\+L\+\_\+\+C\+O\+C\+K\+A\+T\+R\+I\+C\+E, flags, F\+O\+L\+L\+O\+W, iflags, flag\+::inv\+\_\+order, obj\+::invlet, I\+N\+V\+O\+R\+D\+E\+R\+\_\+\+S\+O\+R\+T, mi\+::item, instance\+\_\+flags\+::menu\+\_\+headings, M\+E\+N\+U\+\_\+\+U\+N\+S\+E\+L\+E\+C\+T\+E\+D, N\+H\+W\+\_\+\+M\+E\+N\+U, N\+O\+\_\+\+G\+L\+Y\+P\+H, obj\+\_\+to\+\_\+glyph, objects, objclass\+::oc\+\_\+class, obj\+::oclass, obj\+::otyp, obj\+::quan, select\+\_\+menu, S\+I\+G\+N\+A\+L\+\_\+\+N\+O\+M\+E\+N\+U, start\+\_\+menu, T\+R\+U\+E, and U\+S\+E\+\_\+\+I\+N\+V\+L\+E\+T.



Referenced by menu\+\_\+loot(), and pickup().


\begin{DoxyCode}
692 \{
693     \textcolor{keywordtype}{int} n;
694     \hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} win;
695     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *curr, *last;
696     \textcolor{keywordtype}{char} *pack;
697     \hyperlink{unionany}{anything} \hyperlink{unionany}{any};
698     \textcolor{keywordtype}{boolean} printed\_type\_name;
699 
700     *pick\_list = (\hyperlink{structmi}{menu\_item} *) 0;
701     \textcolor{keywordflow}{if} (!olist) \textcolor{keywordflow}{return} 0;
702 
703     \textcolor{comment}{/* count the number of items allowed */}
704     \textcolor{keywordflow}{for} (n = 0, last = 0, curr = olist; curr; curr = \hyperlink{pickup_8c_ad9881e8c0343df60fbfd87242384fc87}{FOLLOW}(curr, qflags))
705         \textcolor{keywordflow}{if} ((*allow)(curr)) \{
706         last = curr;
707         n++;
708         \}
709 
710     \textcolor{keywordflow}{if} (n == 0) \textcolor{comment}{/* nothing to pick here */}
711         \textcolor{keywordflow}{return} (qflags & \hyperlink{hack_8h_a55ac4a24a290aa856a2f2544cf26aab7}{SIGNAL\_NOMENU}) ? -1 : 0;
712 
713     \textcolor{keywordflow}{if} (n == 1 && (qflags & \hyperlink{hack_8h_ab96b626ee7ebe8d40ee77f2c093fca67}{AUTOSELECT\_SINGLE})) \{
714         *pick\_list = (\hyperlink{structmi}{menu\_item} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(\textcolor{keyword}{sizeof}(\hyperlink{structmi}{menu\_item}));
715         (*pick\_list)->item.a\_obj = last;
716         (*pick\_list)->count = last->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan};
717         \textcolor{keywordflow}{return} 1;
718     \}
719 
720     win = \hyperlink{winprocs_8h_aa13fb35379049d1836397492d10b6b0c}{create\_nhwindow}(\hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU});
721     \hyperlink{winprocs_8h_a466fbda9d8533b050350184f5a095617}{start\_menu}(win);
722     any.\hyperlink{unionany_a0b581808e661444ae19a63a5ccdbf367}{a\_obj} = (\textcolor{keyword}{struct }\hyperlink{structobj}{obj} *) 0;
723 
724     \textcolor{comment}{/*}
725 \textcolor{comment}{     * Run through the list and add the objects to the menu.  If}
726 \textcolor{comment}{     * INVORDER\_SORT is set, we'll run through the list once for}
727 \textcolor{comment}{     * each type so we can group them.  The allow function will only}
728 \textcolor{comment}{     * be called once per object in the list.}
729 \textcolor{comment}{     */}
730     pack = \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_afbbdabb7b1593b8ff0036a5c67ece86f}{inv\_order};
731     \textcolor{keywordflow}{do} \{
732         printed\_type\_name = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
733         \textcolor{keywordflow}{for} (curr = olist; curr; curr = \hyperlink{pickup_8c_ad9881e8c0343df60fbfd87242384fc87}{FOLLOW}(curr, qflags)) \{
734         \textcolor{keywordflow}{if} ((qflags & \hyperlink{hack_8h_a7b6ddd41983a53e638638f0e7bb115cd}{FEEL\_COCKATRICE}) && curr->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == CORPSE &&
735              will\_feel\_cockatrice(curr, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE})) \{
736             \hyperlink{winprocs_8h_a77ac4f50de0eedeaead791812762c6a0}{destroy\_nhwindow}(win);  \textcolor{comment}{/* stop the menu and revert */}
737             (void) look\_here(0, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
738             \textcolor{keywordflow}{return} 0;
739         \}
740         \textcolor{keywordflow}{if} ((!(qflags & \hyperlink{hack_8h_a12e95bdc93dbdbfed5b2a6070f194a0a}{INVORDER\_SORT}) || curr->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == *pack)
741                             && (*allow)(curr)) \{
742 
743             \textcolor{comment}{/* if sorting, print type name (once only) */}
744             \textcolor{keywordflow}{if} (qflags & INVORDER\_SORT && !printed\_type\_name) \{
745             any.\hyperlink{unionany_a0b581808e661444ae19a63a5ccdbf367}{a\_obj} = (\textcolor{keyword}{struct }\hyperlink{structobj}{obj} *) 0;
746             \hyperlink{winprocs_8h_a67d909f9e2dbdf82e7af48ed950c0e07}{add\_menu}(win, \hyperlink{display_8h_ac36b9cc8436af3cf1f7f9919878d8354}{NO\_GLYPH}, &any, 0, 0, \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.
      \hyperlink{structinstance__flags_a1640b6b04fb84038cf353a42d268b9be}{menu\_headings},
747                     let\_to\_name(*pack, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}), \hyperlink{hack_8h_a1b4cfefbc89386fb8977794f02b0a13c}{MENU\_UNSELECTED});
748             printed\_type\_name = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
749             \}
750 
751             any.\hyperlink{unionany_a0b581808e661444ae19a63a5ccdbf367}{a\_obj} = curr;
752             \hyperlink{winprocs_8h_a67d909f9e2dbdf82e7af48ed950c0e07}{add\_menu}(win, \hyperlink{display_8h_a14ef77de0b1bfde06713088d7d9f53e8}{obj\_to\_glyph}(curr), &any,
753                 qflags & \hyperlink{hack_8h_a5c4787c4b2479514f4f204ab8eeda6f5}{USE\_INVLET} ? curr->\hyperlink{structobj_a15d874124e5aacf167531decaca972b8}{invlet} : 0,
754                 \hyperlink{decl_8h_ab2de6953c2db763f00d7f3baf830fe50}{def\_oc\_syms}[(\textcolor{keywordtype}{int})\hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[curr->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp}].
      \hyperlink{structobjclass_ae589e91e556e204c84f05597da510559}{oc\_class}],
755                 \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE}, doname(curr), \hyperlink{hack_8h_a1b4cfefbc89386fb8977794f02b0a13c}{MENU\_UNSELECTED});
756         \}
757         \}
758         pack++;
759     \} \textcolor{keywordflow}{while} (qflags & INVORDER\_SORT && *pack);
760 
761     \hyperlink{winprocs_8h_a26f49f5dfc880f4a810f61b5beae4a71}{end\_menu}(win, qstr);
762     n = \hyperlink{winprocs_8h_afdaac8ee2b6bdd0a0045b81a0cfbe1fc}{select\_menu}(win, how, pick\_list);
763     \hyperlink{winprocs_8h_a77ac4f50de0eedeaead791812762c6a0}{destroy\_nhwindow}(win);
764 
765     \textcolor{keywordflow}{if} (n > 0) \{
766         \hyperlink{structmi}{menu\_item} *\hyperlink{structmi}{mi};
767         \textcolor{keywordtype}{int} i;
768 
769         \textcolor{comment}{/* fix up counts:  -1 means no count used => pick all */}
770         \textcolor{keywordflow}{for} (i = 0, mi = *pick\_list; i < n; i++, mi++)
771         \textcolor{keywordflow}{if} (mi->\hyperlink{structmi_a008e5c33aa571223ec592e0725c5fb73}{count} == -1L || mi->\hyperlink{structmi_a008e5c33aa571223ec592e0725c5fb73}{count} > mi->\hyperlink{structmi_a24f26cd1b01d3cf3ed16b1fd020d3a08}{item}.\hyperlink{unionany_a0b581808e661444ae19a63a5ccdbf367}{a\_obj}->
      \hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan})
772             mi->\hyperlink{structmi_a008e5c33aa571223ec592e0725c5fb73}{count} = mi->\hyperlink{structmi_a24f26cd1b01d3cf3ed16b1fd020d3a08}{item}.\hyperlink{unionany_a0b581808e661444ae19a63a5ccdbf367}{a\_obj}->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan};
773     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (n < 0) \{
774         n = 0;  \textcolor{comment}{/* caller's don't expect -1 */}
775     \}
776     \textcolor{keywordflow}{return} n;
777 \}
\end{DoxyCode}
\hypertarget{pickup_8c_adeadb81e8a48333beb5ca21a69f49edc}{\index{pickup.\+c@{pickup.\+c}!safe\+\_\+qbuf@{safe\+\_\+qbuf}}
\index{safe\+\_\+qbuf@{safe\+\_\+qbuf}!pickup.\+c@{pickup.\+c}}
\subsubsection[{safe\+\_\+qbuf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf const} char$\ast$ safe\+\_\+qbuf (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{qbuf, }
\item[{unsigned}]{padlength, }
\item[{char $\ast$}]{plan\+A, }
\item[{char $\ast$}]{plan\+B, }
\item[{char $\ast$}]{last\+\_\+resort}
\end{DoxyParamCaption}
) const}}\label{pickup_8c_adeadb81e8a48333beb5ca21a69f49edc}


Definition at line 1212 of file pickup.\+c.



References Q\+B\+U\+F\+S\+Z.



Referenced by doloot(), lift\+\_\+object(), pickup(), and use\+\_\+container().


\begin{DoxyCode}
1215 \{
1216     \textcolor{comment}{/* convert size\_t (or int for ancient systems) to ordinary unsigned */}
1217     \textcolor{keywordtype}{unsigned} len\_qbuf = (unsigned)strlen(qbuf),
1218              len\_planA = (unsigned)strlen(planA),
1219              len\_planB = (unsigned)strlen(planB),
1220              len\_lastR = (unsigned)strlen(last\_resort);
1221     \textcolor{keywordtype}{unsigned} textleft = \hyperlink{global_8h_a1bb6bf3db7bf52ca1e9fa8fbcd6e9630}{QBUFSZ} - (len\_qbuf + padlength);
1222 
1223     \textcolor{keywordflow}{if} (len\_lastR >= textleft) \{
1224         impossible(\textcolor{stringliteral}{"safe\_qbuf: last\_resort too large at %u characters."},
1225                len\_lastR);
1226         \textcolor{keywordflow}{return} \textcolor{stringliteral}{""};
1227     \}
1228     \textcolor{keywordflow}{return} (len\_planA < textleft) ? planA :
1229             (len\_planB < textleft) ? planB : last\_resort;
1230 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a2d57788c7582f93a86e16f80b91ec4b9}{\index{pickup.\+c@{pickup.\+c}!simple\+\_\+look@{simple\+\_\+look}}
\index{simple\+\_\+look@{simple\+\_\+look}!pickup.\+c@{pickup.\+c}}
\subsubsection[{simple\+\_\+look}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void simple\+\_\+look (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{otmp, }
\item[{{\bf boolean}}]{here}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a2d57788c7582f93a86e16f80b91ec4b9}


Definition at line 66 of file pickup.\+c.



References create\+\_\+nhwindow, destroy\+\_\+nhwindow, display\+\_\+nhwindow, N\+H\+W\+\_\+\+M\+E\+N\+U, putstr, and T\+R\+U\+E.



Referenced by query\+\_\+classes().


\begin{DoxyCode}
69 \{
70     \textcolor{comment}{/* Neither of the first two cases is expected to happen, since}
71 \textcolor{comment}{     * we're only called after multiple classes of objects have been}
72 \textcolor{comment}{     * detected, hence multiple objects must be present.}
73 \textcolor{comment}{     */}
74     \textcolor{keywordflow}{if} (!otmp) \{
75         impossible(\textcolor{stringliteral}{"simple\_look(null)"});
76     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!(here ? otmp->nexthere : otmp->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj})) \{
77         pline(\textcolor{stringliteral}{"%s"}, doname(otmp));
78     \} \textcolor{keywordflow}{else} \{
79         \hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} tmpwin = \hyperlink{winprocs_8h_aa13fb35379049d1836397492d10b6b0c}{create\_nhwindow}(\hyperlink{wintype_8h_a60a03e50aaeef35cd7cd3bf6f790791c}{NHW\_MENU});
80         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(tmpwin, 0, \textcolor{stringliteral}{""});
81         \textcolor{keywordflow}{do} \{
82         \hyperlink{winprocs_8h_a2ab348888957358569f859127c0bc474}{putstr}(tmpwin, 0, doname(otmp));
83         otmp = here ? otmp->nexthere : otmp->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj};
84         \} \textcolor{keywordflow}{while} (otmp);
85         \hyperlink{winprocs_8h_ac8e74d03fbb65b9f5651e63d79bebc60}{display\_nhwindow}(tmpwin, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
86         \hyperlink{winprocs_8h_a77ac4f50de0eedeaead791812762c6a0}{destroy\_nhwindow}(tmpwin);
87     \}
88 \}
\end{DoxyCode}
\hypertarget{pickup_8c_a3b46d13409ed1c58c848d17176c119dd}{\index{pickup.\+c@{pickup.\+c}!use\+\_\+container@{use\+\_\+container}}
\index{use\+\_\+container@{use\+\_\+container}!pickup.\+c@{pickup.\+c}}
\subsubsection[{use\+\_\+container}]{\setlength{\rightskip}{0pt plus 5cm}int use\+\_\+container (
\begin{DoxyParamCaption}
\item[{struct {\bf obj} $\ast$}]{obj, }
\item[{int}]{held}
\end{DoxyParamCaption}
)}}\label{pickup_8c_a3b46d13409ed1c58c848d17176c119dd}


Definition at line 2071 of file pickup.\+c.



References add\+\_\+valid\+\_\+menu\+\_\+class(), B\+U\+F\+S\+Z, ck\+\_\+bag(), obj\+::cobj, C\+O\+I\+N\+\_\+\+C\+L\+A\+S\+S, container\+\_\+contents(), monst\+::data, eos(), F\+A\+L\+S\+E, F\+D\+E\+C\+L(), flags, H\+A\+N\+D, in\+\_\+container(), in\+\_\+or\+\_\+out\+\_\+menu(), invent, Is\+\_\+mbag, M\+A\+X\+O\+C\+L\+A\+S\+S\+E\+S, mbag\+\_\+item\+\_\+gone(), M\+E\+N\+U\+\_\+\+F\+U\+L\+L, menu\+\_\+loot(), flag\+::menu\+\_\+style, M\+E\+N\+U\+\_\+\+T\+R\+A\+D\+I\+T\+I\+O\+N\+A\+L, multi, obj\+::nobj, nohands, nomovemsg, observe\+\_\+quantum\+\_\+cat(), obj\+::oclass, otmp, out\+\_\+container(), Q\+B\+U\+F\+S\+Z, obj\+::quan, query\+\_\+classes(), safe\+\_\+qbuf(), something, Sprintf, S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L, Strcat, Strcpy, T\+R\+U\+E, u, you\+::ugold, ynqchars, and youmonst.



Referenced by doloot().


\begin{DoxyCode}
2074 \{
2075     \textcolor{keyword}{struct }obj *curr, *\hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp};
2076 \textcolor{preprocessor}{#ifndef GOLDOBJ}
2077     \textcolor{keyword}{struct }obj *u\_gold = (\textcolor{keyword}{struct }obj *)0;
2078 \textcolor{preprocessor}{#endif}
2079     \textcolor{keywordtype}{boolean} one\_by\_one, allflag, quantum\_cat = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE},
2080         loot\_out = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, loot\_in = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2081     \textcolor{keywordtype}{char} select[\hyperlink{objclass_8h_af51133138bfb718b55aaa7f29711a10a}{MAXOCLASSES}+1];
2082     \textcolor{keywordtype}{char} qbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}], emptymsg[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}], pbuf[\hyperlink{global_8h_a1bb6bf3db7bf52ca1e9fa8fbcd6e9630}{QBUFSZ}];
2083     \textcolor{keywordtype}{long} loss = 0L;
2084     \textcolor{keywordtype}{int} cnt = 0, used = 0,
2085         menu\_on\_request;
2086 
2087     emptymsg[0] = \textcolor{charliteral}{'\(\backslash\)0'};
2088     \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_ae13d4a4d0a9842348cffbb5dae990771}{nohands}(\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data})) \{
2089         You(\textcolor{stringliteral}{"have no hands!"});  \textcolor{comment}{/* not `body\_part(HAND)' */}
2090         \textcolor{keywordflow}{return} 0;
2091     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!freehand()) \{
2092         You(\textcolor{stringliteral}{"have no free %s."}, body\_part(\hyperlink{hack_8h_a701f28a9a2b5334b58333f06e27ad91f}{HAND}));
2093         \textcolor{keywordflow}{return} 0;
2094     \}
2095     \textcolor{keywordflow}{if} (obj->olocked) \{
2096         pline(\textcolor{stringliteral}{"%s to be locked."}, Tobjnam(obj, \textcolor{stringliteral}{"seem"}));
2097         \textcolor{keywordflow}{if} (held) You(\textcolor{stringliteral}{"must put it down to unlock."});
2098         \textcolor{keywordflow}{return} 0;
2099     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (obj->otrapped) \{
2100         \textcolor{keywordflow}{if} (held) You(\textcolor{stringliteral}{"open %s..."}, the(xname(obj)));
2101         (void) chest\_trap(obj, \hyperlink{hack_8h_a701f28a9a2b5334b58333f06e27ad91f}{HAND}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
2102         \textcolor{comment}{/* even if the trap fails, you've used up this turn */}
2103         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a498406921f71695627a7107240f3ed7a}{multi} >= 0) \{  \textcolor{comment}{/* in case we didn't become paralyzed */}
2104         nomul(-1);
2105         \hyperlink{decl_8h_a03b001040702c25afae477b18b1692c3}{nomovemsg} = \textcolor{stringliteral}{""};
2106         \}
2107         \textcolor{keywordflow}{return} 1;
2108     \}
2109     \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container} = obj;   \textcolor{comment}{/* for use by in/out\_container */}
2110 
2111     \textcolor{keywordflow}{if} (obj->\hyperlink{structobj_a14fc8dc59e9073bfbf1e170875a98448}{spe} == 1) \{
2112         \hyperlink{pickup_8c_a47dbe7403194a564273bc82e20f4b1af}{observe\_quantum\_cat}(obj);
2113         used = 1;
2114         quantum\_cat = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}; \textcolor{comment}{/* for adjusting "it's empty" message */}
2115     \}
2116     \textcolor{comment}{/* Count the number of contained objects. Sometimes toss objects if */}
2117     \textcolor{comment}{/* a cursed magic bag.                          */}
2118     \textcolor{keywordflow}{for} (curr = obj->\hyperlink{structobj_aa7bed832c417657c964b6f5893737586}{cobj}; curr; curr = otmp) \{
2119         otmp = curr->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj};
2120         \textcolor{keywordflow}{if} (\hyperlink{obj_8h_a65c82dd474ed0d93e446ac4870fd3c35}{Is\_mbag}(obj) && obj->cursed && !rn2(13)) \{
2121         obj\_extract\_self(curr);
2122         loss += \hyperlink{pickup_8c_ab1de57e2933948819d5dc58d696d18e0}{mbag\_item\_gone}(held, curr);
2123         used = 1;
2124         \} \textcolor{keywordflow}{else} \{
2125         cnt++;
2126         \}
2127     \}
2128 
2129     \textcolor{keywordflow}{if} (loss)   \textcolor{comment}{/* magic bag lost some shop goods */}
2130         You(\textcolor{stringliteral}{"owe %ld %s for lost merchandise."}, loss, currency(loss));
2131     obj->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt} = weight(obj);  \textcolor{comment}{/* in case any items were lost */}
2132 
2133     \textcolor{keywordflow}{if} (!cnt)
2134         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(emptymsg, \textcolor{stringliteral}{"%s is %sempty."}, Yname2(obj),
2135             quantum\_cat ? \textcolor{stringliteral}{"now "} : \textcolor{stringliteral}{""});
2136 
2137     \textcolor{keywordflow}{if} (cnt || \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a4c7aac17ec6b0121796b28803d94547c}{menu\_style} == \hyperlink{hack_8h_a38cbdbdd38a533335c4fd24f3550a395}{MENU\_FULL}) \{
2138         \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(qbuf, \textcolor{stringliteral}{"Do you want to take something out of "});
2139         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(\hyperlink{makedefs_8c_a72563303ed4b67f2a7dd9f2d15a01558}{eos}(qbuf), \textcolor{stringliteral}{"%s?"},
2140             \hyperlink{pickup_8c_adeadb81e8a48333beb5ca21a69f49edc}{safe\_qbuf}(qbuf, 1, yname(obj), ysimple\_name(obj), \textcolor{stringliteral}{"it"}));
2141         \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a4c7aac17ec6b0121796b28803d94547c}{menu\_style} != \hyperlink{hack_8h_a3722a16e7d256c5426734217dd050099}{MENU\_TRADITIONAL}) \{
2142         \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a4c7aac17ec6b0121796b28803d94547c}{menu\_style} == \hyperlink{hack_8h_a38cbdbdd38a533335c4fd24f3550a395}{MENU\_FULL}) \{
2143             \textcolor{keywordtype}{int} t;
2144             \textcolor{keywordtype}{char} menuprompt[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
2145             \textcolor{keywordtype}{boolean} outokay = (cnt != 0);
2146 \textcolor{preprocessor}{#ifndef GOLDOBJ}
2147             \textcolor{keywordtype}{boolean} inokay = (\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent} != 0) || (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold} != 0);
2148 \textcolor{preprocessor}{#else}
2149             \textcolor{keywordtype}{boolean} inokay = (\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent} != 0);
2150 \textcolor{preprocessor}{#endif}
2151             \textcolor{keywordflow}{if} (!outokay && !inokay) \{
2152             pline(\textcolor{stringliteral}{"%s"}, emptymsg);
2153             You(\textcolor{stringliteral}{"don't have anything to put in."});
2154             \textcolor{keywordflow}{return} used;
2155             \}
2156             menuprompt[0] = \textcolor{charliteral}{'\(\backslash\)0'};
2157             \textcolor{keywordflow}{if} (!cnt) \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(menuprompt, \textcolor{stringliteral}{"%s "}, emptymsg);
2158             \hyperlink{global_8h_a6d985a6c569a61be75fcacf7623f0988}{Strcat}(menuprompt, \textcolor{stringliteral}{"Do what?"});
2159             t = \hyperlink{pickup_8c_a129d64e6943eb249b60f861442aad5e0}{in\_or\_out\_menu}(menuprompt, \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}, outokay, 
      inokay);
2160             \textcolor{keywordflow}{if} (t <= 0) \textcolor{keywordflow}{return} 0;
2161             loot\_out = (t & 0x01) != 0;
2162             loot\_in  = (t & 0x02) != 0;
2163         \} \textcolor{keywordflow}{else} \{    \textcolor{comment}{/* MENU\_COMBINATION or MENU\_PARTIAL */}
2164             loot\_out = (yn\_function(qbuf, \textcolor{stringliteral}{"ynq"}, \textcolor{charliteral}{'n'}) == \textcolor{charliteral}{'y'});
2165         \}
2166         \textcolor{keywordflow}{if} (loot\_out) \{
2167             \hyperlink{pickup_8c_a3a3907f1a05bd3d2eacfd77cd041536c}{add\_valid\_menu\_class}(0);    \textcolor{comment}{/* reset */}
2168             used |= \hyperlink{pickup_8c_a8ca8f01ed38aee3209b6742d7fd4638f}{menu\_loot}(0, \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}, 
      \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}) > 0;
2169         \}
2170         \} \textcolor{keywordflow}{else} \{
2171         \textcolor{comment}{/* traditional code */}
2172 ask\_again2:
2173         menu\_on\_request = 0;
2174         \hyperlink{pickup_8c_a3a3907f1a05bd3d2eacfd77cd041536c}{add\_valid\_menu\_class}(0);    \textcolor{comment}{/* reset */}
2175         \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(pbuf, \textcolor{stringliteral}{":ynq"});
2176         \textcolor{keywordflow}{if} (cnt) \hyperlink{global_8h_a6d985a6c569a61be75fcacf7623f0988}{Strcat}(pbuf, \textcolor{stringliteral}{"m"});
2177         \textcolor{keywordflow}{switch} (yn\_function(qbuf, pbuf, \textcolor{charliteral}{'n'})) \{
2178         \textcolor{keywordflow}{case} \textcolor{charliteral}{':'}:
2179             \hyperlink{end_8c_a5781bf7ca572bd7d9200623207423afa}{container\_contents}(\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}, 
      \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
2180             \textcolor{keywordflow}{goto} ask\_again2;
2181         \textcolor{keywordflow}{case} \textcolor{charliteral}{'y'}:
2182             \textcolor{keywordflow}{if} (\hyperlink{pickup_8c_a4f84d70771d90362fe0ee76b5dde91f5}{query\_classes}(select, &one\_by\_one, &allflag,
2183                       \textcolor{stringliteral}{"take out"}, \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}->\hyperlink{structobj_aa7bed832c417657c964b6f5893737586}{cobj},
2184                       \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE},
2185 #ifndef GOLDOBJ
2186                       \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE},
2187 #endif
2188                       &menu\_on\_request)) \{
2189             \textcolor{keywordflow}{if} (askchain((\textcolor{keyword}{struct} obj **)&\hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}->
      \hyperlink{structobj_aa7bed832c417657c964b6f5893737586}{cobj},
2190                      (one\_by\_one ? (\textcolor{keywordtype}{char} *)0 : select),
2191                      allflag, \hyperlink{pickup_8c_a874288ec8fc650fcaac88c1fa2d2b74e}{out\_container},
2192                      (\textcolor{keywordtype}{int} \hyperlink{pickup_8c_a9c6a606ae174d0b8480f4bfbe2274728}{FDECL}((*),(\hyperlink{global_8h_a0b35ac15910ff1522ede7503fd6afe1c}{OBJ\_P})))0,
2193                      0, \textcolor{stringliteral}{"nodot"}))
2194                 used = 1;
2195             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (menu\_on\_request < 0) \{
2196             used |= \hyperlink{pickup_8c_a8ca8f01ed38aee3209b6742d7fd4638f}{menu\_loot}(menu\_on\_request,
2197                       \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}, FALSE) > 0;
2198             \}
2199             \textcolor{comment}{/*FALLTHRU*/}
2200         \textcolor{keywordflow}{case} \textcolor{charliteral}{'n'}:
2201             \textcolor{keywordflow}{break};
2202         \textcolor{keywordflow}{case} \textcolor{charliteral}{'m'}:
2203             menu\_on\_request = -2; \textcolor{comment}{/* triggers ALL\_CLASSES */}
2204             used |= \hyperlink{pickup_8c_a8ca8f01ed38aee3209b6742d7fd4638f}{menu\_loot}(menu\_on\_request, \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}, FALSE) > 0;
2205             \textcolor{keywordflow}{break};
2206         \textcolor{keywordflow}{case} \textcolor{charliteral}{'q'}:
2207         \textcolor{keywordflow}{default}:
2208             \textcolor{keywordflow}{return} used;
2209         \}
2210         \}
2211     \} \textcolor{keywordflow}{else} \{
2212         pline(\textcolor{stringliteral}{"%s"}, emptymsg);      \textcolor{comment}{/* <whatever> is empty. */}
2213     \}
2214 
2215 \textcolor{preprocessor}{#ifndef GOLDOBJ}
2216     \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent} && \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold} == 0) \{
2217 \textcolor{preprocessor}{#else}
2218     \textcolor{keywordflow}{if} (!\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent}) \{
2219 \textcolor{preprocessor}{#endif}
2220         \textcolor{comment}{/* nothing to put in, but some feedback is necessary */}
2221         You(\textcolor{stringliteral}{"don't have anything to put in."});
2222         \textcolor{keywordflow}{return} used;
2223     \}
2224     \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a4c7aac17ec6b0121796b28803d94547c}{menu\_style} != \hyperlink{hack_8h_a38cbdbdd38a533335c4fd24f3550a395}{MENU\_FULL}) \{
2225         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(qbuf, \textcolor{stringliteral}{"Do you wish to put %s in?"}, \hyperlink{decl_8h_aa5c50bde0d16d15a08d32d8df49a80ae}{something});
2226         \hyperlink{global_8h_add22f733d1f2c380499f495068e42b7c}{Strcpy}(pbuf, \hyperlink{decl_8h_a435ebb3887b48075c97ff301b972ba1b}{ynqchars});
2227         \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a4c7aac17ec6b0121796b28803d94547c}{menu\_style} == \hyperlink{hack_8h_a3722a16e7d256c5426734217dd050099}{MENU\_TRADITIONAL} && 
      \hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent} && inv\_cnt() > 0)
2228         \hyperlink{global_8h_a6d985a6c569a61be75fcacf7623f0988}{Strcat}(pbuf, \textcolor{stringliteral}{"m"});
2229         \textcolor{keywordflow}{switch} (yn\_function(qbuf, pbuf, \textcolor{charliteral}{'n'})) \{
2230         \textcolor{keywordflow}{case} \textcolor{charliteral}{'y'}:
2231             loot\_in = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
2232             \textcolor{keywordflow}{break};
2233         \textcolor{keywordflow}{case} \textcolor{charliteral}{'n'}:
2234             \textcolor{keywordflow}{break};
2235         \textcolor{keywordflow}{case} \textcolor{charliteral}{'m'}:
2236             \hyperlink{pickup_8c_a3a3907f1a05bd3d2eacfd77cd041536c}{add\_valid\_menu\_class}(0);      \textcolor{comment}{/* reset */}
2237             menu\_on\_request = -2; \textcolor{comment}{/* triggers ALL\_CLASSES */}
2238             used |= \hyperlink{pickup_8c_a8ca8f01ed38aee3209b6742d7fd4638f}{menu\_loot}(menu\_on\_request, \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}, 
      \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}) > 0;
2239             \textcolor{keywordflow}{break};
2240         \textcolor{keywordflow}{case} \textcolor{charliteral}{'q'}:
2241         \textcolor{keywordflow}{default}:
2242             \textcolor{keywordflow}{return} used;
2243         \}
2244     \}
2245     \textcolor{comment}{/*}
2246 \textcolor{comment}{     * Gone: being nice about only selecting food if we know we are}
2247 \textcolor{comment}{     * putting things in an ice chest.}
2248 \textcolor{comment}{     */}
2249     \textcolor{keywordflow}{if} (loot\_in) \{
2250 \textcolor{preprocessor}{#ifndef GOLDOBJ}
2251         \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold}) \{
2252         \textcolor{comment}{/*}
2253 \textcolor{comment}{         * Hack: gold is not in the inventory, so make a gold object}
2254 \textcolor{comment}{         * and put it at the head of the inventory list.}
2255 \textcolor{comment}{         */}
2256         u\_gold = mkgoldobj(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold});  \textcolor{comment}{/* removes from u.ugold */}
2257         u\_gold->in\_use = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
2258         \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold} = u\_gold->\hyperlink{structobj_ad08c0ed1a746fbb52377ecd7e4220578}{quan};       \textcolor{comment}{/* put the gold back */}
2259         assigninvlet(u\_gold);       \textcolor{comment}{/* might end up as NOINVSYM */}
2260         u\_gold->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj} = \hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent};
2261         \hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent} = u\_gold;
2262         \}
2263 \textcolor{preprocessor}{#endif}
2264         \hyperlink{pickup_8c_a3a3907f1a05bd3d2eacfd77cd041536c}{add\_valid\_menu\_class}(0);      \textcolor{comment}{/* reset */}
2265         \textcolor{keywordflow}{if} (\hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a4c7aac17ec6b0121796b28803d94547c}{menu\_style} != \hyperlink{hack_8h_a3722a16e7d256c5426734217dd050099}{MENU\_TRADITIONAL}) \{
2266         used |= \hyperlink{pickup_8c_a8ca8f01ed38aee3209b6742d7fd4638f}{menu\_loot}(0, \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}) > 0;
2267         \} \textcolor{keywordflow}{else} \{
2268         \textcolor{comment}{/* traditional code */}
2269         menu\_on\_request = 0;
2270         \textcolor{keywordflow}{if} (\hyperlink{pickup_8c_a4f84d70771d90362fe0ee76b5dde91f5}{query\_classes}(select, &one\_by\_one, &allflag, \textcolor{stringliteral}{"put in"},
2271                    \hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent}, FALSE,
2272 #ifndef GOLDOBJ
2273                    (\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold} != 0L),
2274 #endif
2275                    &menu\_on\_request)) \{
2276             (void) askchain((\textcolor{keyword}{struct} obj **)&\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent},
2277                     (one\_by\_one ? (\textcolor{keywordtype}{char} *)0 : select), allflag,
2278                     \hyperlink{pickup_8c_a8344ebfadcf90f594ad92856f5a1467d}{in\_container}, \hyperlink{pickup_8c_afb34b00ade44133f5eca3d852b4a0a6d}{ck\_bag}, 0, \textcolor{stringliteral}{"nodot"});
2279             used = 1;
2280         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (menu\_on\_request < 0) \{
2281             used |= \hyperlink{pickup_8c_a8ca8f01ed38aee3209b6742d7fd4638f}{menu\_loot}(menu\_on\_request,
2282                       \hyperlink{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{current\_container}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}) > 0;
2283         \}
2284         \}
2285     \}
2286 
2287 \textcolor{preprocessor}{#ifndef GOLDOBJ}
2288     \textcolor{keywordflow}{if} (u\_gold && \hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent} && \hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent}->\hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} == \hyperlink{objclass_8h_a2999621925083659147349e261e4cb3d}{COIN\_CLASS}) \{
2289         \textcolor{comment}{/* didn't stash [all of] it */}
2290         u\_gold = \hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent};
2291         \hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent} = u\_gold->\hyperlink{structobj_ad1c5d790528ee1d8349ef302994789d8}{nobj};
2292         u\_gold->in\_use = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2293         dealloc\_obj(u\_gold);
2294     \}
2295 \textcolor{preprocessor}{#endif}
2296     \textcolor{keywordflow}{return} used;
2297 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}{\index{pickup.\+c@{pickup.\+c}!current\+\_\+container@{current\+\_\+container}}
\index{current\+\_\+container@{current\+\_\+container}!pickup.\+c@{pickup.\+c}}
\subsubsection[{current\+\_\+container}]{\setlength{\rightskip}{0pt plus 5cm}{\bf N\+E\+A\+R\+D\+A\+T\+A} struct {\bf obj}$\ast$ current\+\_\+container\hspace{0.3cm}{\ttfamily [static]}}}\label{pickup_8c_a32f1e459e0dbfe52695095effe5a3d90}


Definition at line 1764 of file pickup.\+c.



Referenced by ck\+\_\+bag().

\hypertarget{pickup_8c_a46ed6db9f3f1bd6fbc51981cc1c3b6ce}{\index{pickup.\+c@{pickup.\+c}!moderateloadmsg@{moderateloadmsg}}
\index{moderateloadmsg@{moderateloadmsg}!pickup.\+c@{pickup.\+c}}
\subsubsection[{moderateloadmsg}]{\setlength{\rightskip}{0pt plus 5cm}{\bf const} char moderateloadmsg\mbox{[}$\,$\mbox{]} = \char`\"{}You have a little trouble lifting\char`\"{}\hspace{0.3cm}{\ttfamily [static]}}}\label{pickup_8c_a46ed6db9f3f1bd6fbc51981cc1c3b6ce}


Definition at line 58 of file pickup.\+c.

\hypertarget{pickup_8c_a74c9304356d6e805b16fb8cd0ad4de59}{\index{pickup.\+c@{pickup.\+c}!nearloadmsg@{nearloadmsg}}
\index{nearloadmsg@{nearloadmsg}!pickup.\+c@{pickup.\+c}}
\subsubsection[{nearloadmsg}]{\setlength{\rightskip}{0pt plus 5cm}{\bf const} char nearloadmsg\mbox{[}$\,$\mbox{]} = \char`\"{}You have much trouble lifting\char`\"{}\hspace{0.3cm}{\ttfamily [static]}}}\label{pickup_8c_a74c9304356d6e805b16fb8cd0ad4de59}


Definition at line 59 of file pickup.\+c.

\hypertarget{pickup_8c_ac720afce691f17f08514b51d99c8e933}{\index{pickup.\+c@{pickup.\+c}!overloadmsg@{overloadmsg}}
\index{overloadmsg@{overloadmsg}!pickup.\+c@{pickup.\+c}}
\subsubsection[{overloadmsg}]{\setlength{\rightskip}{0pt plus 5cm}{\bf const} char overloadmsg\mbox{[}$\,$\mbox{]} = \char`\"{}You have extreme difficulty lifting\char`\"{}\hspace{0.3cm}{\ttfamily [static]}}}\label{pickup_8c_ac720afce691f17f08514b51d99c8e933}


Definition at line 60 of file pickup.\+c.

\hypertarget{pickup_8c_a0bd193462382b9374db52932708de0c3}{\index{pickup.\+c@{pickup.\+c}!val\+\_\+for\+\_\+n\+\_\+or\+\_\+more@{val\+\_\+for\+\_\+n\+\_\+or\+\_\+more}}
\index{val\+\_\+for\+\_\+n\+\_\+or\+\_\+more@{val\+\_\+for\+\_\+n\+\_\+or\+\_\+more}!pickup.\+c@{pickup.\+c}}
\subsubsection[{val\+\_\+for\+\_\+n\+\_\+or\+\_\+more}]{\setlength{\rightskip}{0pt plus 5cm}long val\+\_\+for\+\_\+n\+\_\+or\+\_\+more\hspace{0.3cm}{\ttfamily [static]}}}\label{pickup_8c_a0bd193462382b9374db52932708de0c3}


Definition at line 279 of file pickup.\+c.

\hypertarget{pickup_8c_a35ecb0af10e36ef86e7a32d62e771d5c}{\index{pickup.\+c@{pickup.\+c}!valid\+\_\+menu\+\_\+classes@{valid\+\_\+menu\+\_\+classes}}
\index{valid\+\_\+menu\+\_\+classes@{valid\+\_\+menu\+\_\+classes}!pickup.\+c@{pickup.\+c}}
\subsubsection[{valid\+\_\+menu\+\_\+classes}]{\setlength{\rightskip}{0pt plus 5cm}char valid\+\_\+menu\+\_\+classes\mbox{[}{\bf M\+A\+X\+O\+C\+L\+A\+S\+S\+E\+S}+2\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}}\label{pickup_8c_a35ecb0af10e36ef86e7a32d62e771d5c}


Definition at line 291 of file pickup.\+c.

