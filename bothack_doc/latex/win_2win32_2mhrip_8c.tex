\hypertarget{win_2win32_2mhrip_8c}{\section{nethack/win/win32/mhrip.c File Reference}
\label{win_2win32_2mhrip_8c}\index{nethack/win/win32/mhrip.\+c@{nethack/win/win32/mhrip.\+c}}
}
{\ttfamily \#include \char`\"{}win\+M\+S.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}resource.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhrip.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhmsg.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhfont.\+h\char`\"{}}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structmswin__nethack__text__window}{mswin\+\_\+nethack\+\_\+text\+\_\+window}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{win_2win32_2mhrip_8c_a9b87cf9fb615ffbf9aa86fa48bc3ff6d}{R\+I\+P\+\_\+\+W\+I\+D\+T\+H}~400
\item 
\#define \hyperlink{win_2win32_2mhrip_8c_a6ce6a8de1604de65c455a423df27ff0e}{R\+I\+P\+\_\+\+H\+E\+I\+G\+H\+T}~200
\item 
\#define \hyperlink{win_2win32_2mhrip_8c_a923aa3070bcc77dc9adacc12ebccb61d}{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+H\+E\+I\+G\+H\+T}~120
\item 
\#define \hyperlink{win_2win32_2mhrip_8c_a3e02df90f4dad515343515679174ec8f}{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+W\+I\+D\+T\+H}~115
\item 
\#define \hyperlink{win_2win32_2mhrip_8c_a3c15b052999f03df1f1c781524fb5b26}{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+X}~90
\item 
\#define \hyperlink{win_2win32_2mhrip_8c_a1679dddf4125018ddd690af71a501786}{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+Y}~60
\item 
\#define \hyperlink{win_2win32_2mhrip_8c_a1a209193162defd4970232b1eb865d4d}{R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X}~10
\item 
\#define \hyperlink{win_2win32_2mhrip_8c_a3ac5c0e930bcfd96aa2f687d131bd814}{R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y}~10
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \\*
\hyperlink{structmswin__nethack__text__window}{mswin\+\_\+nethack\+\_\+text\+\_\+window} \hyperlink{win_2win32_2mhrip_8c_a80eb1a3d31372a9896a07b3bcc765a26}{N\+H\+R\+I\+P\+Window}
\item 
typedef struct \\*
\hyperlink{structmswin__nethack__text__window}{mswin\+\_\+nethack\+\_\+text\+\_\+window} $\ast$ \hyperlink{win_2win32_2mhrip_8c_a29ddf298cfa5653018ec499f6c1162dc}{P\+N\+H\+R\+I\+P\+Window}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{sys_2wince_2winMS_8h_a78ff8ed1e05072662719865d12608e75}{P\+N\+H\+Win\+App} \hyperlink{win_2win32_2mhrip_8c_afa11eb8c832e838349416cf3bbdd29fe}{Get\+N\+H\+App} (void)
\item 
B\+O\+O\+L C\+A\+L\+L\+B\+A\+C\+K \hyperlink{win_2win32_2mhrip_8c_a819b19643f38c7c2674ad766c593d23e}{N\+H\+R\+I\+P\+Wnd\+Proc} (H\+W\+N\+D, \hyperlink{def__os2_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{U\+I\+N\+T}, W\+P\+A\+R\+A\+M, L\+P\+A\+R\+A\+M)
\item 
static void \hyperlink{win_2win32_2mhrip_8c_ab1f0aceef05a1dec643246c7cbf5353c}{on\+M\+S\+N\+H\+Command} (H\+W\+N\+D h\+Wnd, W\+P\+A\+R\+A\+M w\+Param, L\+P\+A\+R\+A\+M l\+Param)
\item 
H\+W\+N\+D \hyperlink{win_2win32_2mhrip_8c_a873a3a9b144d63c71b5ea5b64474b964}{mswin\+\_\+init\+\_\+\+R\+I\+P\+\_\+window} ()
\item 
void \hyperlink{win_2win32_2mhrip_8c_aadbdb5deceb926c391714cf64d3c18bd}{mswin\+\_\+display\+\_\+\+R\+I\+P\+\_\+window} (H\+W\+N\+D h\+Wnd)
\item 
void \hyperlink{win_2win32_2mhrip_8c_a72251ef22173d55bc970420a4849d11f}{mswin\+\_\+finish\+\_\+rip\+\_\+text} (\hyperlink{wintype_8h_adc2de956a3f084b1691cf080e1d1412b}{winid} wid)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{win_2win32_2mhrip_8c_a923aa3070bcc77dc9adacc12ebccb61d}{\index{win/win32/mhrip.\+c@{win/win32/mhrip.\+c}!R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+H\+E\+I\+G\+H\+T@{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+H\+E\+I\+G\+H\+T}}
\index{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+H\+E\+I\+G\+H\+T@{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+H\+E\+I\+G\+H\+T}!win/win32/mhrip.\+c@{win/win32/mhrip.\+c}}
\subsubsection[{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+H\+E\+I\+G\+H\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+H\+E\+I\+G\+H\+T~120}}\label{win_2win32_2mhrip_8c_a923aa3070bcc77dc9adacc12ebccb61d}


Definition at line 13 of file mhrip.\+c.



Referenced by N\+H\+R\+I\+P\+Wnd\+Proc().

\hypertarget{win_2win32_2mhrip_8c_a3e02df90f4dad515343515679174ec8f}{\index{win/win32/mhrip.\+c@{win/win32/mhrip.\+c}!R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+W\+I\+D\+T\+H@{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+W\+I\+D\+T\+H}}
\index{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+W\+I\+D\+T\+H@{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+W\+I\+D\+T\+H}!win/win32/mhrip.\+c@{win/win32/mhrip.\+c}}
\subsubsection[{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+W\+I\+D\+T\+H}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+W\+I\+D\+T\+H~115}}\label{win_2win32_2mhrip_8c_a3e02df90f4dad515343515679174ec8f}


Definition at line 14 of file mhrip.\+c.



Referenced by N\+H\+R\+I\+P\+Wnd\+Proc().

\hypertarget{win_2win32_2mhrip_8c_a3c15b052999f03df1f1c781524fb5b26}{\index{win/win32/mhrip.\+c@{win/win32/mhrip.\+c}!R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+X@{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+X}}
\index{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+X@{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+X}!win/win32/mhrip.\+c@{win/win32/mhrip.\+c}}
\subsubsection[{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+X}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+X~90}}\label{win_2win32_2mhrip_8c_a3c15b052999f03df1f1c781524fb5b26}


Definition at line 15 of file mhrip.\+c.



Referenced by N\+H\+R\+I\+P\+Wnd\+Proc().

\hypertarget{win_2win32_2mhrip_8c_a1679dddf4125018ddd690af71a501786}{\index{win/win32/mhrip.\+c@{win/win32/mhrip.\+c}!R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+Y@{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+Y}}
\index{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+Y@{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+Y}!win/win32/mhrip.\+c@{win/win32/mhrip.\+c}}
\subsubsection[{R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+Y~60}}\label{win_2win32_2mhrip_8c_a1679dddf4125018ddd690af71a501786}


Definition at line 16 of file mhrip.\+c.



Referenced by N\+H\+R\+I\+P\+Wnd\+Proc().

\hypertarget{win_2win32_2mhrip_8c_a6ce6a8de1604de65c455a423df27ff0e}{\index{win/win32/mhrip.\+c@{win/win32/mhrip.\+c}!R\+I\+P\+\_\+\+H\+E\+I\+G\+H\+T@{R\+I\+P\+\_\+\+H\+E\+I\+G\+H\+T}}
\index{R\+I\+P\+\_\+\+H\+E\+I\+G\+H\+T@{R\+I\+P\+\_\+\+H\+E\+I\+G\+H\+T}!win/win32/mhrip.\+c@{win/win32/mhrip.\+c}}
\subsubsection[{R\+I\+P\+\_\+\+H\+E\+I\+G\+H\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+I\+P\+\_\+\+H\+E\+I\+G\+H\+T~200}}\label{win_2win32_2mhrip_8c_a6ce6a8de1604de65c455a423df27ff0e}


Definition at line 11 of file mhrip.\+c.



Referenced by mswin\+\_\+display\+\_\+\+R\+I\+P\+\_\+window(), and N\+H\+R\+I\+P\+Wnd\+Proc().

\hypertarget{win_2win32_2mhrip_8c_a1a209193162defd4970232b1eb865d4d}{\index{win/win32/mhrip.\+c@{win/win32/mhrip.\+c}!R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X@{R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X}}
\index{R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X@{R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X}!win/win32/mhrip.\+c@{win/win32/mhrip.\+c}}
\subsubsection[{R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X~10}}\label{win_2win32_2mhrip_8c_a1a209193162defd4970232b1eb865d4d}


Definition at line 18 of file mhrip.\+c.



Referenced by mswin\+\_\+display\+\_\+\+R\+I\+P\+\_\+window(), and N\+H\+R\+I\+P\+Wnd\+Proc().

\hypertarget{win_2win32_2mhrip_8c_a3ac5c0e930bcfd96aa2f687d131bd814}{\index{win/win32/mhrip.\+c@{win/win32/mhrip.\+c}!R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y@{R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y}}
\index{R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y@{R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y}!win/win32/mhrip.\+c@{win/win32/mhrip.\+c}}
\subsubsection[{R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y~10}}\label{win_2win32_2mhrip_8c_a3ac5c0e930bcfd96aa2f687d131bd814}


Definition at line 19 of file mhrip.\+c.



Referenced by mswin\+\_\+display\+\_\+\+R\+I\+P\+\_\+window(), and N\+H\+R\+I\+P\+Wnd\+Proc().

\hypertarget{win_2win32_2mhrip_8c_a9b87cf9fb615ffbf9aa86fa48bc3ff6d}{\index{win/win32/mhrip.\+c@{win/win32/mhrip.\+c}!R\+I\+P\+\_\+\+W\+I\+D\+T\+H@{R\+I\+P\+\_\+\+W\+I\+D\+T\+H}}
\index{R\+I\+P\+\_\+\+W\+I\+D\+T\+H@{R\+I\+P\+\_\+\+W\+I\+D\+T\+H}!win/win32/mhrip.\+c@{win/win32/mhrip.\+c}}
\subsubsection[{R\+I\+P\+\_\+\+W\+I\+D\+T\+H}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+I\+P\+\_\+\+W\+I\+D\+T\+H~400}}\label{win_2win32_2mhrip_8c_a9b87cf9fb615ffbf9aa86fa48bc3ff6d}


Definition at line 10 of file mhrip.\+c.



Referenced by mswin\+\_\+display\+\_\+\+R\+I\+P\+\_\+window(), and N\+H\+R\+I\+P\+Wnd\+Proc().



\subsection{Typedef Documentation}
\hypertarget{win_2win32_2mhrip_8c_a80eb1a3d31372a9896a07b3bcc765a26}{\index{win/win32/mhrip.\+c@{win/win32/mhrip.\+c}!N\+H\+R\+I\+P\+Window@{N\+H\+R\+I\+P\+Window}}
\index{N\+H\+R\+I\+P\+Window@{N\+H\+R\+I\+P\+Window}!win/win32/mhrip.\+c@{win/win32/mhrip.\+c}}
\subsubsection[{N\+H\+R\+I\+P\+Window}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf mswin\+\_\+nethack\+\_\+text\+\_\+window}  {\bf N\+H\+R\+I\+P\+Window}}}\label{win_2win32_2mhrip_8c_a80eb1a3d31372a9896a07b3bcc765a26}
\hypertarget{win_2win32_2mhrip_8c_a29ddf298cfa5653018ec499f6c1162dc}{\index{win/win32/mhrip.\+c@{win/win32/mhrip.\+c}!P\+N\+H\+R\+I\+P\+Window@{P\+N\+H\+R\+I\+P\+Window}}
\index{P\+N\+H\+R\+I\+P\+Window@{P\+N\+H\+R\+I\+P\+Window}!win/win32/mhrip.\+c@{win/win32/mhrip.\+c}}
\subsubsection[{P\+N\+H\+R\+I\+P\+Window}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf mswin\+\_\+nethack\+\_\+text\+\_\+window} $\ast$ {\bf P\+N\+H\+R\+I\+P\+Window}}}\label{win_2win32_2mhrip_8c_a29ddf298cfa5653018ec499f6c1162dc}


\subsection{Function Documentation}
\hypertarget{win_2win32_2mhrip_8c_afa11eb8c832e838349416cf3bbdd29fe}{\index{win/win32/mhrip.\+c@{win/win32/mhrip.\+c}!Get\+N\+H\+App@{Get\+N\+H\+App}}
\index{Get\+N\+H\+App@{Get\+N\+H\+App}!win/win32/mhrip.\+c@{win/win32/mhrip.\+c}}
\subsubsection[{Get\+N\+H\+App}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\+N\+H\+Win\+App} Get\+N\+H\+App (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{win_2win32_2mhrip_8c_afa11eb8c832e838349416cf3bbdd29fe}


Definition at line 154 of file winhack.\+c.



Referenced by mswin\+\_\+display\+\_\+\+R\+I\+P\+\_\+window(), mswin\+\_\+init\+\_\+\+R\+I\+P\+\_\+window(), and N\+H\+R\+I\+P\+Wnd\+Proc().


\begin{DoxyCode}
155 \{
156     \textcolor{keywordflow}{return} &\hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app};
157 \}
\end{DoxyCode}
\hypertarget{win_2win32_2mhrip_8c_aadbdb5deceb926c391714cf64d3c18bd}{\index{win/win32/mhrip.\+c@{win/win32/mhrip.\+c}!mswin\+\_\+display\+\_\+\+R\+I\+P\+\_\+window@{mswin\+\_\+display\+\_\+\+R\+I\+P\+\_\+window}}
\index{mswin\+\_\+display\+\_\+\+R\+I\+P\+\_\+window@{mswin\+\_\+display\+\_\+\+R\+I\+P\+\_\+window}!win/win32/mhrip.\+c@{win/win32/mhrip.\+c}}
\subsubsection[{mswin\+\_\+display\+\_\+\+R\+I\+P\+\_\+window}]{\setlength{\rightskip}{0pt plus 5cm}void mswin\+\_\+display\+\_\+\+R\+I\+P\+\_\+window (
\begin{DoxyParamCaption}
\item[{H\+W\+N\+D}]{h\+Wnd}
\end{DoxyParamCaption}
)}}\label{win_2win32_2mhrip_8c_aadbdb5deceb926c391714cf64d3c18bd}


Definition at line 52 of file mhrip.\+c.



References F\+A\+L\+S\+E, Get\+N\+H\+App(), mswin\+\_\+nhwindow\+\_\+app\+::h\+Main\+Wnd, mswin\+\_\+nhwindow\+\_\+app\+::h\+Popup\+Wnd, mswin\+\_\+display\+\_\+text\+\_\+window(), mswin\+\_\+get\+\_\+font(), mswin\+\_\+hwnd\+\_\+from\+\_\+winid(), N\+H\+W\+\_\+\+T\+E\+X\+T, N\+U\+L\+L, R\+I\+P\+\_\+\+H\+E\+I\+G\+H\+T, R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X, R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y, R\+I\+P\+\_\+\+W\+I\+D\+T\+H, T\+R\+U\+E, W\+I\+N\+\_\+\+M\+A\+P, and mswin\+\_\+nethack\+\_\+text\+\_\+window\+::window\+\_\+text.


\begin{DoxyCode}
53 \{
54     MSG msg;
55     RECT rt;
56     \hyperlink{structmswin__nethack__text__window}{PNHRIPWindow} data;
57     HWND mapWnd;
58     RECT riprt;
59     RECT clientrect;
60     RECT textrect;
61     HDC hdc;
62     HFONT OldFont;
63 
64     data = (\hyperlink{win_2win32_2mhrip_8c_a29ddf298cfa5653018ec499f6c1162dc}{PNHRIPWindow})GetWindowLong(hWnd, GWL\_USERDATA);
65 
66     \hyperlink{win_2win32_2mhrip_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_a92e7b581dd0fad9d1af8364e5bcfe395}{hPopupWnd} = hWnd;
67     mapWnd = \hyperlink{sys_2wince_2mswproc_8c_a0890d6b16657f7ad53aebadc8818f147}{mswin\_hwnd\_from\_winid}(\hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP});
68     \textcolor{keywordflow}{if}( !IsWindow(mapWnd) ) mapWnd = \hyperlink{win_2win32_2mhrip_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_ada318d77e9dd51678af5d9a3ce6ef03a}{hMainWnd};
69     GetWindowRect(mapWnd, &rt);
70     GetWindowRect(hWnd, &riprt);
71     GetClientRect (hWnd, &clientrect);
72     textrect = clientrect;
73     textrect.top += \hyperlink{win_2win32_2mhrip_8c_a3ac5c0e930bcfd96aa2f687d131bd814}{RIP\_OFFSET\_Y};
74     textrect.left += \hyperlink{win_2win32_2mhrip_8c_a1a209193162defd4970232b1eb865d4d}{RIP\_OFFSET\_X};
75     textrect.right -= \hyperlink{win_2win32_2mhrip_8c_a1a209193162defd4970232b1eb865d4d}{RIP\_OFFSET\_X};
76     \textcolor{keywordflow}{if} (data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text})
77     \{
78         hdc = GetDC (hWnd);
79         OldFont = SelectObject (hdc, \hyperlink{sys_2wince_2mhfont_8c_a480013e685b85460be07910c65a1ef51}{mswin\_get\_font}(\hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT}, 0, hdc, 
      \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}));
80         DrawText (hdc, data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text}, strlen(data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text}), &textrect,
81         DT\_LEFT | DT\_NOPREFIX | DT\_CALCRECT);
82         SelectObject (hdc, OldFont);
83         ReleaseDC(hWnd, hdc);
84     \}
85     \textcolor{keywordflow}{if} (textrect.right - textrect.left > \hyperlink{win_2win32_2mhrip_8c_a9b87cf9fb615ffbf9aa86fa48bc3ff6d}{RIP\_WIDTH})
86         clientrect.right = textrect.right + \hyperlink{win_2win32_2mhrip_8c_a1a209193162defd4970232b1eb865d4d}{RIP\_OFFSET\_X} - clientrect.right;
87     \textcolor{keywordflow}{else}
88         clientrect.right = textrect.left + 2 * \hyperlink{win_2win32_2mhrip_8c_a1a209193162defd4970232b1eb865d4d}{RIP\_OFFSET\_X} + 
      \hyperlink{win_2win32_2mhrip_8c_a9b87cf9fb615ffbf9aa86fa48bc3ff6d}{RIP\_WIDTH} - clientrect.right;
89     clientrect.bottom = textrect.bottom + \hyperlink{win_2win32_2mhrip_8c_a6ce6a8de1604de65c455a423df27ff0e}{RIP\_HEIGHT} + \hyperlink{win_2win32_2mhrip_8c_a3ac5c0e930bcfd96aa2f687d131bd814}{RIP\_OFFSET\_Y} - clientrect.
      bottom;
90     GetWindowRect (GetDlgItem(hWnd, IDOK), &textrect);
91     textrect.right -= textrect.left;
92     textrect.bottom -= textrect.top;
93     clientrect.bottom += textrect.bottom + \hyperlink{win_2win32_2mhrip_8c_a3ac5c0e930bcfd96aa2f687d131bd814}{RIP\_OFFSET\_Y};
94     riprt.right -= riprt.left;
95     riprt.bottom -= riprt.top;
96     riprt.right += clientrect.right;
97     riprt.bottom += clientrect.bottom;
98     rt.left += (rt.right - rt.left - riprt.right) / 2;
99     rt.top += (rt.bottom - rt.top - riprt.bottom) / 2;
100 
101     MoveWindow(hWnd, rt.left, rt.top, riprt.right, riprt.bottom, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
102     GetClientRect (hWnd, &clientrect);
103     MoveWindow (GetDlgItem(hWnd, IDOK),
104         (clientrect.right - clientrect.left - textrect.right) / 2,
105         clientrect.bottom - textrect.bottom - \hyperlink{win_2win32_2mhrip_8c_a3ac5c0e930bcfd96aa2f687d131bd814}{RIP\_OFFSET\_Y}, textrect.right, textrect.bottom, 
      \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
106     ShowWindow(hWnd, SW\_SHOW);
107 
108     \textcolor{keywordflow}{while}( IsWindow(hWnd) &&
109            GetMessage(&msg, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 0, 0)!=0 ) \{
110         \textcolor{keywordflow}{if}( !IsDialogMessage(hWnd, &msg) ) \{
111             TranslateMessage(&msg);
112             DispatchMessage(&msg);
113         \}
114     \}
115 
116     \hyperlink{win_2win32_2mhrip_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_a92e7b581dd0fad9d1af8364e5bcfe395}{hPopupWnd} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
117 \}
\end{DoxyCode}
\hypertarget{win_2win32_2mhrip_8c_a72251ef22173d55bc970420a4849d11f}{\index{win/win32/mhrip.\+c@{win/win32/mhrip.\+c}!mswin\+\_\+finish\+\_\+rip\+\_\+text@{mswin\+\_\+finish\+\_\+rip\+\_\+text}}
\index{mswin\+\_\+finish\+\_\+rip\+\_\+text@{mswin\+\_\+finish\+\_\+rip\+\_\+text}!win/win32/mhrip.\+c@{win/win32/mhrip.\+c}}
\subsubsection[{mswin\+\_\+finish\+\_\+rip\+\_\+text}]{\setlength{\rightskip}{0pt plus 5cm}void mswin\+\_\+finish\+\_\+rip\+\_\+text (
\begin{DoxyParamCaption}
\item[{{\bf winid}}]{wid}
\end{DoxyParamCaption}
)}}\label{win_2win32_2mhrip_8c_a72251ef22173d55bc970420a4849d11f}


Definition at line 262 of file mhrip.\+c.



References M\+S\+N\+H\+\_\+\+M\+S\+G\+\_\+\+D\+I\+E\+D, mswin\+\_\+hwnd\+\_\+from\+\_\+winid(), and W\+M\+\_\+\+M\+S\+N\+H\+\_\+\+C\+O\+M\+M\+A\+N\+D.



Referenced by mswin\+\_\+outrip().


\begin{DoxyCode}
263 \{
264     SendMessage (\hyperlink{sys_2wince_2mswproc_8c_a0890d6b16657f7ad53aebadc8818f147}{mswin\_hwnd\_from\_winid}(wid), 
      \hyperlink{sys_2wince_2mhmsg_8h_a55eac656fabe0d462816201ac756eab6}{WM\_MSNH\_COMMAND},  \hyperlink{win_2win32_2mhmsg_8h_a96c8cb192c47d4b8b1cb97505dd1b8b7}{MSNH\_MSG\_DIED}, 0);
265 \}
\end{DoxyCode}
\hypertarget{win_2win32_2mhrip_8c_a873a3a9b144d63c71b5ea5b64474b964}{\index{win/win32/mhrip.\+c@{win/win32/mhrip.\+c}!mswin\+\_\+init\+\_\+\+R\+I\+P\+\_\+window@{mswin\+\_\+init\+\_\+\+R\+I\+P\+\_\+window}}
\index{mswin\+\_\+init\+\_\+\+R\+I\+P\+\_\+window@{mswin\+\_\+init\+\_\+\+R\+I\+P\+\_\+window}!win/win32/mhrip.\+c@{win/win32/mhrip.\+c}}
\subsubsection[{mswin\+\_\+init\+\_\+\+R\+I\+P\+\_\+window}]{\setlength{\rightskip}{0pt plus 5cm}H\+W\+N\+D mswin\+\_\+init\+\_\+\+R\+I\+P\+\_\+window (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{win_2win32_2mhrip_8c_a873a3a9b144d63c71b5ea5b64474b964}


Definition at line 32 of file mhrip.\+c.



References Create\+Dialog(), Get\+N\+H\+App(), I\+D\+D\+\_\+\+N\+H\+R\+I\+P, malloc(), mswin\+\_\+init\+\_\+text\+\_\+window(), N\+H\+R\+I\+P\+Wnd\+Proc(), and panic().


\begin{DoxyCode}
32                               \{
33     HWND ret;
34     \hyperlink{structmswin__nethack__text__window}{PNHRIPWindow} data;
35 
36     ret = \hyperlink{dialogs_8c_aaf356545a4c5797e317091864c988de0}{CreateDialog}(
37             \hyperlink{win_2win32_2mhrip_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->hApp,
38             MAKEINTRESOURCE(\hyperlink{win_2win32_2resource_8h_afda3043b36cede648894e1de7f2dd75a}{IDD\_NHRIP}),
39             \hyperlink{win_2win32_2mhrip_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->hMainWnd,
40             \hyperlink{win_2win32_2mhrip_8c_a819b19643f38c7c2674ad766c593d23e}{NHRIPWndProc}
41     );
42     \textcolor{keywordflow}{if}( !ret ) \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"Cannot create rip window"});
43 
44     data = (\hyperlink{win_2win32_2mhrip_8c_a29ddf298cfa5653018ec499f6c1162dc}{PNHRIPWindow})\hyperlink{winproto_8h_ab028c02ac00afc0c1d3c568ccad68869}{malloc}(\textcolor{keyword}{sizeof}(\hyperlink{structmswin__nethack__text__window}{NHRIPWindow}));
45     \textcolor{keywordflow}{if}( !data ) \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"out of memory"});
46 
47     ZeroMemory(data, \textcolor{keyword}{sizeof}(\hyperlink{structmswin__nethack__text__window}{NHRIPWindow}));
48     SetWindowLong(ret, GWL\_USERDATA, (LONG)data);
49     \textcolor{keywordflow}{return} ret;
50 \}
\end{DoxyCode}
\hypertarget{win_2win32_2mhrip_8c_a819b19643f38c7c2674ad766c593d23e}{\index{win/win32/mhrip.\+c@{win/win32/mhrip.\+c}!N\+H\+R\+I\+P\+Wnd\+Proc@{N\+H\+R\+I\+P\+Wnd\+Proc}}
\index{N\+H\+R\+I\+P\+Wnd\+Proc@{N\+H\+R\+I\+P\+Wnd\+Proc}!win/win32/mhrip.\+c@{win/win32/mhrip.\+c}}
\subsubsection[{N\+H\+R\+I\+P\+Wnd\+Proc}]{\setlength{\rightskip}{0pt plus 5cm}B\+O\+O\+L C\+A\+L\+L\+B\+A\+C\+K N\+H\+R\+I\+P\+Wnd\+Proc (
\begin{DoxyParamCaption}
\item[{H\+W\+N\+D}]{h\+Wnd, }
\item[{{\bf U\+I\+N\+T}}]{message, }
\item[{W\+P\+A\+R\+A\+M}]{w\+Param, }
\item[{L\+P\+A\+R\+A\+M}]{l\+Param}
\end{DoxyParamCaption}
)}}\label{win_2win32_2mhrip_8c_a819b19643f38c7c2674ad766c593d23e}


Definition at line 119 of file mhrip.\+c.



References A\+T\+R\+\_\+\+N\+O\+N\+E, F\+A\+L\+S\+E, free(), Get\+N\+H\+App(), mswin\+\_\+nhwindow\+\_\+app\+::h\+Main\+Wnd, mswin\+\_\+get\+\_\+font(), mswin\+\_\+window\+\_\+mark\+\_\+dead(), mswin\+\_\+winid\+\_\+from\+\_\+handle(), N\+H\+W\+\_\+\+T\+E\+X\+T, N\+U\+L\+L, on\+M\+S\+N\+H\+Command(), program\+\_\+state, mswin\+\_\+nethack\+\_\+text\+\_\+window\+::rip\+\_\+bmp, R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+H\+E\+I\+G\+H\+T, R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+W\+I\+D\+T\+H, R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+X, R\+I\+P\+\_\+\+G\+R\+A\+V\+E\+\_\+\+Y, R\+I\+P\+\_\+\+H\+E\+I\+G\+H\+T, R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X, R\+I\+P\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y, mswin\+\_\+nethack\+\_\+text\+\_\+window\+::rip\+\_\+text, R\+I\+P\+\_\+\+W\+I\+D\+T\+H, sinfo\+::stopprint, T\+R\+U\+E, mswin\+\_\+nethack\+\_\+text\+\_\+window\+::window\+\_\+text, and W\+M\+\_\+\+M\+S\+N\+H\+\_\+\+C\+O\+M\+M\+A\+N\+D.



Referenced by mswin\+\_\+init\+\_\+\+R\+I\+P\+\_\+window().


\begin{DoxyCode}
120 \{
121     HDC hdc;
122     \hyperlink{structmswin__nethack__text__window}{PNHRIPWindow} data;
123 
124     data = (\hyperlink{win_2win32_2mhrip_8c_a29ddf298cfa5653018ec499f6c1162dc}{PNHRIPWindow})GetWindowLong(hWnd, GWL\_USERDATA);
125     \textcolor{keywordflow}{switch} (message)
126     \{
127     \textcolor{keywordflow}{case} WM\_INITDIALOG:
128         \textcolor{comment}{/* set text control font */}
129         hdc = GetDC(hWnd);
130         SendMessage(hWnd, WM\_SETFONT,
131             (WPARAM)\hyperlink{sys_2wince_2mhfont_8c_a480013e685b85460be07910c65a1ef51}{mswin\_get\_font}(\hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT}, \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE}, hdc, 
      \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}), 0);
132         ReleaseDC(hWnd, hdc);
133 
134         SetFocus(GetDlgItem(hWnd, IDOK));
135     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
136 
137     \textcolor{keywordflow}{case} \hyperlink{sys_2wince_2mhmsg_8h_a55eac656fabe0d462816201ac756eab6}{WM\_MSNH\_COMMAND}:
138         \hyperlink{win_2win32_2mhrip_8c_ab1f0aceef05a1dec643246c7cbf5353c}{onMSNHCommand}(hWnd, wParam, lParam);
139     \textcolor{keywordflow}{break};
140 
141     \textcolor{keywordflow}{case} WM\_PAINT:
142     \{
143         \textcolor{keywordtype}{int} bitmap\_offset;
144         RECT clientrect;
145         RECT textrect;
146         HDC hdcBitmap;
147         HANDLE OldBitmap;
148         PAINTSTRUCT ps;
149         HFONT OldFont;
150 
151         hdc = BeginPaint (hWnd, &ps);
152         OldFont = SelectObject (hdc, \hyperlink{sys_2wince_2mhfont_8c_a480013e685b85460be07910c65a1ef51}{mswin\_get\_font}(\hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT}, 0, hdc, 
      \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}));
153         hdcBitmap = CreateCompatibleDC(hdc);
154         SetBkMode (hdc, TRANSPARENT);
155         GetClientRect (hWnd, &clientrect);
156         textrect = clientrect;
157         textrect.top += \hyperlink{win_2win32_2mhrip_8c_a3ac5c0e930bcfd96aa2f687d131bd814}{RIP\_OFFSET\_Y};
158         textrect.left += \hyperlink{win_2win32_2mhrip_8c_a1a209193162defd4970232b1eb865d4d}{RIP\_OFFSET\_X};
159         textrect.right -= \hyperlink{win_2win32_2mhrip_8c_a1a209193162defd4970232b1eb865d4d}{RIP\_OFFSET\_X};
160         \textcolor{keywordflow}{if} (data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text})
161         \{
162             DrawText (hdc, data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text}, strlen(data->
      \hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text}), &textrect,
163                 DT\_LEFT | DT\_NOPREFIX | DT\_CALCRECT);
164             DrawText (hdc, data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text}, strlen(data->
      \hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text}), &textrect,
165                 DT\_LEFT | DT\_NOPREFIX);
166         \}
167         OldBitmap = SelectObject(hdcBitmap, \hyperlink{win_2win32_2mhrip_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->bmpRip);
168         SetBkMode (hdc, OPAQUE);
169         bitmap\_offset = (textrect.right - textrect.left - \hyperlink{win_2win32_2mhrip_8c_a9b87cf9fb615ffbf9aa86fa48bc3ff6d}{RIP\_WIDTH}) / 2;
170         BitBlt (hdc, textrect.left + bitmap\_offset, textrect.bottom, \hyperlink{win_2win32_2mhrip_8c_a9b87cf9fb615ffbf9aa86fa48bc3ff6d}{RIP\_WIDTH},
171             \hyperlink{win_2win32_2mhrip_8c_a6ce6a8de1604de65c455a423df27ff0e}{RIP\_HEIGHT}, hdcBitmap, 0, 0, SRCCOPY);
172         SetBkMode (hdc, TRANSPARENT);
173         \textcolor{keywordflow}{if} (data->\hyperlink{structmswin__nethack__text__window_af374dae4520a7ffae334d26ea9d86bce}{rip\_text})
174         \{
175             textrect.left += \hyperlink{win_2win32_2mhrip_8c_a3c15b052999f03df1f1c781524fb5b26}{RIP\_GRAVE\_X} + bitmap\_offset;
176             textrect.top = textrect.bottom + \hyperlink{win_2win32_2mhrip_8c_a1679dddf4125018ddd690af71a501786}{RIP\_GRAVE\_Y};
177             textrect.right = textrect.left + \hyperlink{win_2win32_2mhrip_8c_a3e02df90f4dad515343515679174ec8f}{RIP\_GRAVE\_WIDTH};
178             textrect.bottom = textrect.top + \hyperlink{win_2win32_2mhrip_8c_a923aa3070bcc77dc9adacc12ebccb61d}{RIP\_GRAVE\_HEIGHT};
179             DrawText (hdc, data->\hyperlink{structmswin__nethack__text__window_af374dae4520a7ffae334d26ea9d86bce}{rip\_text}, strlen(data->\hyperlink{structmswin__nethack__text__window_af374dae4520a7ffae334d26ea9d86bce}{rip\_text}), &textrect,
180                 DT\_CENTER | DT\_VCENTER | DT\_NOPREFIX | DT\_WORDBREAK);
181         \}
182         SelectObject (hdcBitmap, OldBitmap);
183         SelectObject (hdc, OldFont);
184         DeleteDC (hdcBitmap);
185         EndPaint (hWnd, &ps);
186     \}
187     \textcolor{keywordflow}{break};
188 
189     \textcolor{keywordflow}{case} WM\_COMMAND:
190         \textcolor{keywordflow}{switch} (LOWORD(wParam))
191         \{
192           \textcolor{keywordflow}{case} IDOK:
193             \hyperlink{sys_2wince_2mswproc_8c_a2dd95f399fc771e39649d2962c6b04f6}{mswin\_window\_mark\_dead}(\hyperlink{sys_2wince_2mswproc_8c_ab8710fc5a763a885ff66eb7e01215fd0}{mswin\_winid\_from\_handle}(
      hWnd));
194             \textcolor{keywordflow}{if}( \hyperlink{win_2win32_2mhrip_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->hMainWnd==hWnd )
195                 \hyperlink{win_2win32_2mhrip_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_ada318d77e9dd51678af5d9a3ce6ef03a}{hMainWnd}=\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
196             DestroyWindow(hWnd);
197             SetFocus(\hyperlink{win_2win32_2mhrip_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->hMainWnd);
198             \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
199         \}
200     \textcolor{keywordflow}{break};
201 
202     \textcolor{keywordflow}{case} WM\_CLOSE:
203         \textcolor{comment}{/* if we get this here, we saved the bones so we can just force a quit */}
204 
205         \hyperlink{sys_2wince_2mswproc_8c_a2dd95f399fc771e39649d2962c6b04f6}{mswin\_window\_mark\_dead}(\hyperlink{sys_2wince_2mswproc_8c_ab8710fc5a763a885ff66eb7e01215fd0}{mswin\_winid\_from\_handle}(hWnd));
206         \textcolor{keywordflow}{if}( \hyperlink{win_2win32_2mhrip_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->hMainWnd==hWnd )
207         \hyperlink{win_2win32_2mhrip_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_ada318d77e9dd51678af5d9a3ce6ef03a}{hMainWnd}=\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
208         DestroyWindow(hWnd);
209         SetFocus(\hyperlink{win_2win32_2mhrip_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->hMainWnd);
210         \hyperlink{decl_8h_a91c51d44f2b6e70f8a5d42a5b5218dcd}{program\_state}.\hyperlink{structsinfo_a722956debc5ac939d455ba63e60fd963}{stopprint}++;
211         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
212 
213     \textcolor{keywordflow}{case} WM\_DESTROY:
214         \textcolor{keywordflow}{if}( data ) \{
215             \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text} ) \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}(data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text});
216             \textcolor{keywordflow}{if}( data->\hyperlink{structmswin__nethack__text__window_af374dae4520a7ffae334d26ea9d86bce}{rip\_text} ) \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}(data->\hyperlink{structmswin__nethack__text__window_af374dae4520a7ffae334d26ea9d86bce}{rip\_text});
217             \textcolor{keywordflow}{if} (data->\hyperlink{structmswin__nethack__text__window_a036fad5d1b1b14381da83f420e320ab2}{rip\_bmp} != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}) DeleteObject(data->\hyperlink{structmswin__nethack__text__window_a036fad5d1b1b14381da83f420e320ab2}{rip\_bmp});
218             \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}(data);
219             SetWindowLong(hWnd, GWL\_USERDATA, (LONG)0);
220         \}
221     \textcolor{keywordflow}{break};
222 
223     \}
224     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
225 \}
\end{DoxyCode}
\hypertarget{win_2win32_2mhrip_8c_ab1f0aceef05a1dec643246c7cbf5353c}{\index{win/win32/mhrip.\+c@{win/win32/mhrip.\+c}!on\+M\+S\+N\+H\+Command@{on\+M\+S\+N\+H\+Command}}
\index{on\+M\+S\+N\+H\+Command@{on\+M\+S\+N\+H\+Command}!win/win32/mhrip.\+c@{win/win32/mhrip.\+c}}
\subsubsection[{on\+M\+S\+N\+H\+Command}]{\setlength{\rightskip}{0pt plus 5cm}void on\+M\+S\+N\+H\+Command (
\begin{DoxyParamCaption}
\item[{H\+W\+N\+D}]{h\+Wnd, }
\item[{W\+P\+A\+R\+A\+M}]{w\+Param, }
\item[{L\+P\+A\+R\+A\+M}]{l\+Param}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{win_2win32_2mhrip_8c_ab1f0aceef05a1dec643246c7cbf5353c}


Definition at line 227 of file mhrip.\+c.



References B\+U\+F\+S\+Z, malloc(), M\+S\+N\+H\+\_\+\+M\+S\+G\+\_\+\+D\+I\+E\+D, M\+S\+N\+H\+\_\+\+M\+S\+G\+\_\+\+P\+U\+T\+S\+T\+R, N\+H\+\_\+\+A2\+W, N\+U\+L\+L, mswin\+\_\+nethack\+\_\+text\+\_\+window\+::rip\+\_\+text, mswin\+\_\+nhmsg\+\_\+putstr\+::text, and mswin\+\_\+nethack\+\_\+text\+\_\+window\+::window\+\_\+text.



Referenced by N\+H\+R\+I\+P\+Wnd\+Proc().


\begin{DoxyCode}
228 \{
229     \hyperlink{structmswin__nethack__text__window}{PNHRIPWindow} data;
230     \textcolor{keyword}{static} \textcolor{keywordtype}{int} InRipText = 1;
231     data = (\hyperlink{win_2win32_2mhrip_8c_a29ddf298cfa5653018ec499f6c1162dc}{PNHRIPWindow})GetWindowLong(hWnd, GWL\_USERDATA);
232     \textcolor{keywordflow}{switch}( wParam ) \{
233         \textcolor{keywordflow}{case} \hyperlink{sys_2wince_2mhmsg_8h_a483b8d3a386f1c5d76da1dff6ed549a8}{MSNH\_MSG\_PUTSTR}: \{
234             \hyperlink{structmswin__nhmsg__putstr}{PMSNHMsgPutstr} msg\_data = (\hyperlink{sys_2wince_2mhmsg_8h_ad6db1f0e39180f07f00581a93dbdd846}{PMSNHMsgPutstr})lParam;
235             TCHAR   wbuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
236             \textcolor{keywordtype}{size\_t} text\_size;
237 
238             \textcolor{keywordflow}{if}( !data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text} ) \{
239                 text\_size = strlen(msg\_data->\hyperlink{structmswin__nhmsg__putstr_a27f09d7286c01fe17c1289761b63502e}{text}) + 4;
240                 data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text} = (TCHAR*)\hyperlink{winproto_8h_ab028c02ac00afc0c1d3c568ccad68869}{malloc}(text\_size*\textcolor{keyword}{sizeof}(data->
      \hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text}[0]));
241                 ZeroMemory(data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text}, text\_size*\textcolor{keyword}{sizeof}(data->
      \hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text}[0]));
242             \} \textcolor{keywordflow}{else} \{
243                 text\_size = \_tcslen(data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text}) + strlen(msg\_data->
      \hyperlink{structmswin__nhmsg__putstr_a27f09d7286c01fe17c1289761b63502e}{text}) + 4;
244                 data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text} = (TCHAR*)realloc(data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text}, text\_size*\textcolor{keyword}{
      sizeof}(data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text}[0]));
245             \}
246             \textcolor{keywordflow}{if}( !data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text} ) \textcolor{keywordflow}{break};
247 
248             \_tcscat(data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text}, \hyperlink{wceconf_8h_a2ed36c9ee770dfe5f2d0e3088a62adad}{NH\_A2W}(msg\_data->\hyperlink{structmswin__nhmsg__putstr_a27f09d7286c01fe17c1289761b63502e}{text}, wbuf, 
      \hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}));
249             \_tcscat(data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text}, TEXT(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}));
250             \textcolor{keywordflow}{break};
251         \}
252         \textcolor{keywordflow}{case} \hyperlink{win_2win32_2mhmsg_8h_a96c8cb192c47d4b8b1cb97505dd1b8b7}{MSNH\_MSG\_DIED}:
253         \{
254             data->\hyperlink{structmswin__nethack__text__window_af374dae4520a7ffae334d26ea9d86bce}{rip\_text} = data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text};
255             data->\hyperlink{structmswin__nethack__text__window_a103624299b7831b14459a3a7b47c0271}{window\_text} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
256             \textcolor{keywordflow}{break};
257         \}
258 
259     \}
260 \}
\end{DoxyCode}
