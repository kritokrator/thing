\hypertarget{gnmenu_8c}{\section{nethack/win/gnome/gnmenu.c File Reference}
\label{gnmenu_8c}\index{nethack/win/gnome/gnmenu.\+c@{nethack/win/gnome/gnmenu.\+c}}
}
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include $<$gtk/gtk.\+h$>$}\\*
{\ttfamily \#include $<$gnome.\+h$>$}\\*
{\ttfamily \#include \char`\"{}gnmenu.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}gnmain.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}gnbind.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}func\+\_\+tab.\+h\char`\"{}}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structmenuItem}{menu\+Item}
\item 
struct \hyperlink{structextMenu}{ext\+Menu}
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37}{Menu\+Win\+Type} \{ \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a6fdebbfd72352b7e497d50d4aa69d590}{Menu\+Unknown} = 0, 
\hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a7f6a971ae217b86c9bc8d8e181d8d9ad}{Menu\+Text}, 
\hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a1706f25014518b450a907744ad45664c}{Menu\+Menu}
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{gnmenu_8c_aae897ed8ef60d7ff902c443777ebb792}{ghack\+\_\+menu\+\_\+window\+\_\+key} (Gtk\+Widget $\ast$menu\+Win, Gdk\+Event\+Key $\ast$event, gpointer data)
\item 
static void \hyperlink{gnmenu_8c_a26babfcc4b66e690814fcbdeab70d41c}{ghack\+\_\+menu\+\_\+row\+\_\+selected} (Gtk\+C\+List $\ast$\hyperlink{gnplayer_8c_aaacfa1e004c6c39fcee7664eb1b0ae9d}{clist}, int row, int col, Gdk\+Event $\ast$event)
\item 
void \hyperlink{gnmenu_8c_a0fba62bb73f3f7ea3977c07f1e69cf5d}{ghack\+\_\+menu\+\_\+window\+\_\+clear} (Gtk\+Widget $\ast$menu\+Win, gpointer data)
\item 
void \hyperlink{gnmenu_8c_a922cfcfbcff01189d8c0a65a7176ae67}{ghack\+\_\+menu\+\_\+window\+\_\+display} (Gtk\+Widget $\ast$menu\+Win, gboolean blocking, gpointer data)
\item 
gint \hyperlink{gnmenu_8c_aed91f6a5b091ea3c830fd07fc56e7c7e}{ghack\+\_\+menu\+\_\+hide} (Gtk\+Widget $\ast$menu\+Win, Gdk\+Event $\ast$event, gpointer data)
\item 
void \hyperlink{gnmenu_8c_acd7828ea775c2382417cd6973d4acbdd}{ghack\+\_\+menu\+\_\+window\+\_\+start\+\_\+menu} (Gtk\+Widget $\ast$menu\+Win, gpointer data)
\item 
int \hyperlink{gnmenu_8c_adae68cf5b7a99ed2a8da9823f741e84c}{ghack\+\_\+menu\+\_\+window\+\_\+select\+\_\+menu} (Gtk\+Widget $\ast$menu\+Win, \hyperlink{wintype_8h_a56b56557611b7f64f4e6585a1b78c8f9}{M\+E\+N\+U\+\_\+\+I\+T\+E\+M\+\_\+\+P} $\ast$$\ast$\+\_\+selected, gint how)
\item 
void \hyperlink{gnmenu_8c_ad19a7a944e97cef3323bf8a31b3d0072}{ghack\+\_\+menu\+\_\+window\+\_\+add\+\_\+menu} (Gtk\+Widget $\ast$menu\+Win, gpointer \hyperlink{wintype_8h_aaef709f77068fd7ba62812589327f08f}{menu\+\_\+item}, gpointer data)
\item 
void \hyperlink{gnmenu_8c_a6c2d4defda60c1486bd901bfcda5ede1}{ghack\+\_\+menu\+\_\+window\+\_\+end\+\_\+menu} (Gtk\+Widget $\ast$menu\+Win, gpointer data)
\item 
void \hyperlink{gnmenu_8c_a7a38dcdd6e1dd1670d352e53536e05eb}{ghack\+\_\+menu\+\_\+window\+\_\+put\+\_\+string} (Gtk\+Widget $\ast$menu\+Win, int attr, \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$text, gpointer data)
\item 
void \hyperlink{gnmenu_8c_a8cf6f7bb40a67afab5ca00ae44fed56a}{ghack\+\_\+menu\+\_\+destroy} (Gtk\+Widget $\ast$menu\+Win, gpointer data)
\item 
Gtk\+Widget $\ast$ \hyperlink{gnmenu_8c_ab66946ab422888fce0f0c9fb3670b335}{ghack\+\_\+init\+\_\+menu\+\_\+window} (void)
\item 
static void \hyperlink{gnmenu_8c_aa368f6ca667ccacbfb06ac5f98aa2821}{ghack\+\_\+ext\+\_\+key\+\_\+hit} (Gtk\+Widget $\ast$menu\+Win, Gdk\+Event\+Key $\ast$event, gpointer data)
\item 
int \hyperlink{gnmenu_8c_af55fb0471f01d81db97a6743d96f49cd}{ghack\+\_\+menu\+\_\+ext\+\_\+cmd} (void)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static Gdk\+Color \hyperlink{gnmenu_8c_aefd4a6b43d479ce169e4657927505d7f}{color\+\_\+blue} = \{ 0, 0, 0, 0xffff \}
\end{DoxyCompactItemize}


\subsection{Enumeration Type Documentation}
\hypertarget{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37}{\index{gnmenu.\+c@{gnmenu.\+c}!Menu\+Win\+Type@{Menu\+Win\+Type}}
\index{Menu\+Win\+Type@{Menu\+Win\+Type}!gnmenu.\+c@{gnmenu.\+c}}
\subsubsection[{Menu\+Win\+Type}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf Menu\+Win\+Type}}}\label{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{Menu\+Unknown@{Menu\+Unknown}!gnmenu.\+c@{gnmenu.\+c}}\index{gnmenu.\+c@{gnmenu.\+c}!Menu\+Unknown@{Menu\+Unknown}}\item[{\em 
\hypertarget{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a6fdebbfd72352b7e497d50d4aa69d590}{Menu\+Unknown}\label{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a6fdebbfd72352b7e497d50d4aa69d590}
}]\index{Menu\+Text@{Menu\+Text}!gnmenu.\+c@{gnmenu.\+c}}\index{gnmenu.\+c@{gnmenu.\+c}!Menu\+Text@{Menu\+Text}}\item[{\em 
\hypertarget{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a7f6a971ae217b86c9bc8d8e181d8d9ad}{Menu\+Text}\label{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a7f6a971ae217b86c9bc8d8e181d8d9ad}
}]\index{Menu\+Menu@{Menu\+Menu}!gnmenu.\+c@{gnmenu.\+c}}\index{gnmenu.\+c@{gnmenu.\+c}!Menu\+Menu@{Menu\+Menu}}\item[{\em 
\hypertarget{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a1706f25014518b450a907744ad45664c}{Menu\+Menu}\label{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a1706f25014518b450a907744ad45664c}
}]\end{description}
\end{Desc}


Definition at line 13 of file gnmenu.\+c.


\begin{DoxyCode}
13              \{
14     \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a6fdebbfd72352b7e497d50d4aa69d590}{MenuUnknown} = 0,
15     \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a7f6a971ae217b86c9bc8d8e181d8d9ad}{MenuText},
16     \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a1706f25014518b450a907744ad45664c}{MenuMenu}
17 \} \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37}{MenuWinType};
\end{DoxyCode}


\subsection{Function Documentation}
\hypertarget{gnmenu_8c_aa368f6ca667ccacbfb06ac5f98aa2821}{\index{gnmenu.\+c@{gnmenu.\+c}!ghack\+\_\+ext\+\_\+key\+\_\+hit@{ghack\+\_\+ext\+\_\+key\+\_\+hit}}
\index{ghack\+\_\+ext\+\_\+key\+\_\+hit@{ghack\+\_\+ext\+\_\+key\+\_\+hit}!gnmenu.\+c@{gnmenu.\+c}}
\subsubsection[{ghack\+\_\+ext\+\_\+key\+\_\+hit}]{\setlength{\rightskip}{0pt plus 5cm}static void ghack\+\_\+ext\+\_\+key\+\_\+hit (
\begin{DoxyParamCaption}
\item[{Gtk\+Widget $\ast$}]{menu\+Win, }
\item[{Gdk\+Event\+Key $\ast$}]{event, }
\item[{gpointer}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{gnmenu_8c_aa368f6ca667ccacbfb06ac5f98aa2821}


Definition at line 636 of file gnmenu.\+c.



References ext\+Menu\+::char\+Idx, clist, ext\+Menu\+::cur\+Item, ext\+\_\+func\+\_\+tab\+::ef\+\_\+txt, extcmdlist, ext\+Menu\+::last\+Time, N\+U\+L\+L, and ext\+Menu\+::num\+Rows.



Referenced by ghack\+\_\+menu\+\_\+ext\+\_\+cmd().


\begin{DoxyCode}
637 \{
638     GtkWidget* \hyperlink{gnopts_8c_aaacfa1e004c6c39fcee7664eb1b0ae9d}{clist};
639     \hyperlink{structextMenu}{extMenu}* info = (\hyperlink{structextMenu}{extMenu}*) data;
640     \textcolor{keywordtype}{int} i;
641     \textcolor{keywordtype}{char} c = \textcolor{keyword}{event}->string[0];
642 
643     clist = GTK\_WIDGET(gtk\_object\_get\_data(GTK\_OBJECT(menuWin), \textcolor{stringliteral}{"clist"}));
644     g\_assert(clist != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
645 
646     \textcolor{comment}{/* if too long between keystrokes, reset to initial state */}
647     \textcolor{keywordflow}{if} (event->time - info->\hyperlink{structextMenu_a66b8a9fd7a18cf439b0a82d0712d540c}{lastTime} > 500) \textcolor{keywordflow}{goto} init\_state;
648 
649     \textcolor{comment}{/* see if current item continue to match */}
650     \textcolor{keywordflow}{if} (info->\hyperlink{structextMenu_a56587827e174f902da38f5569e8b9c25}{charIdx} > 0) \{
651     \textcolor{keywordflow}{if} (\hyperlink{func__tab_8h_af3a00fc8e4e157bae08471bcc66d46d9}{extcmdlist}[info->\hyperlink{structextMenu_aaa686aca39f89627044b163edf1db00e}{curItem}].\hyperlink{structext__func__tab_a1c6b81a9ba3a70826ea2f1c2eacc089e}{ef\_txt}[info->\hyperlink{structextMenu_a56587827e174f902da38f5569e8b9c25}{charIdx}] == c) \{
652         ++info->\hyperlink{structextMenu_a56587827e174f902da38f5569e8b9c25}{charIdx};
653         \textcolor{keywordflow}{goto} found;
654     \}
655     \}
656 
657     \textcolor{comment}{/* see if the prefix matches a later command in the list */}
658     \textcolor{keywordflow}{if} (info->\hyperlink{structextMenu_aaa686aca39f89627044b163edf1db00e}{curItem} >= 0) \{
659     \textcolor{keywordflow}{for} (i = info->\hyperlink{structextMenu_aaa686aca39f89627044b163edf1db00e}{curItem} + 1; i < info->numRows; ++i) \{
660         \textcolor{keywordflow}{if} (!strncmp(\hyperlink{func__tab_8h_af3a00fc8e4e157bae08471bcc66d46d9}{extcmdlist}[info->\hyperlink{structextMenu_aaa686aca39f89627044b163edf1db00e}{curItem}].\hyperlink{structext__func__tab_a1c6b81a9ba3a70826ea2f1c2eacc089e}{ef\_txt},
661              \hyperlink{func__tab_8h_af3a00fc8e4e157bae08471bcc66d46d9}{extcmdlist}[i].\hyperlink{structext__func__tab_a1c6b81a9ba3a70826ea2f1c2eacc089e}{ef\_txt}, info->\hyperlink{structextMenu_a56587827e174f902da38f5569e8b9c25}{charIdx})) \{
662         \textcolor{keywordflow}{if} (\hyperlink{func__tab_8h_af3a00fc8e4e157bae08471bcc66d46d9}{extcmdlist}[i].ef\_txt[info->\hyperlink{structextMenu_a56587827e174f902da38f5569e8b9c25}{charIdx}] == c) \{
663             ++info->\hyperlink{structextMenu_a56587827e174f902da38f5569e8b9c25}{charIdx};
664             info->\hyperlink{structextMenu_aaa686aca39f89627044b163edf1db00e}{curItem} = i;
665             \textcolor{keywordflow}{goto} found;
666         \}
667         \}
668     \}
669     \}
670         
671 init\_state:
672     \textcolor{comment}{/* reset to initial state, look for matching 1st character */}
673     \textcolor{keywordflow}{for} (i = 0; i < info->\hyperlink{structextMenu_ac90ebf8746d53b094060b505a0c4dc4b}{numRows}; ++i) \{
674     \textcolor{keywordflow}{if} (\hyperlink{func__tab_8h_af3a00fc8e4e157bae08471bcc66d46d9}{extcmdlist}[i].ef\_txt[0] == c) \{
675         info->\hyperlink{structextMenu_a56587827e174f902da38f5569e8b9c25}{charIdx} = 1;
676         info->\hyperlink{structextMenu_aaa686aca39f89627044b163edf1db00e}{curItem} = i;
677         \textcolor{keywordflow}{goto} found;
678     \}
679     \}
680 
681     \textcolor{comment}{/* no match: leave prior, if any selection in place */}
682     \textcolor{keywordflow}{return};
683 
684 found:
685     info->\hyperlink{structextMenu_a66b8a9fd7a18cf439b0a82d0712d540c}{lastTime} = \textcolor{keyword}{event}->time;
686     gtk\_clist\_select\_row(GTK\_CLIST(clist), info->\hyperlink{structextMenu_aaa686aca39f89627044b163edf1db00e}{curItem}, 0);
687     \textcolor{keywordflow}{if} (gtk\_clist\_row\_is\_visible(GTK\_CLIST(clist),
688                  info->\hyperlink{structextMenu_aaa686aca39f89627044b163edf1db00e}{curItem}) != GTK\_VISIBILITY\_FULL)
689     gtk\_clist\_moveto(GTK\_CLIST(clist), info->\hyperlink{structextMenu_aaa686aca39f89627044b163edf1db00e}{curItem}, 0, 0.5, 0);
690 \}
\end{DoxyCode}
\hypertarget{gnmenu_8c_ab66946ab422888fce0f0c9fb3670b335}{\index{gnmenu.\+c@{gnmenu.\+c}!ghack\+\_\+init\+\_\+menu\+\_\+window@{ghack\+\_\+init\+\_\+menu\+\_\+window}}
\index{ghack\+\_\+init\+\_\+menu\+\_\+window@{ghack\+\_\+init\+\_\+menu\+\_\+window}!gnmenu.\+c@{gnmenu.\+c}}
\subsubsection[{ghack\+\_\+init\+\_\+menu\+\_\+window}]{\setlength{\rightskip}{0pt plus 5cm}Gtk\+Widget$\ast$ ghack\+\_\+init\+\_\+menu\+\_\+window (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{gnmenu_8c_ab66946ab422888fce0f0c9fb3670b335}


Definition at line 576 of file gnmenu.\+c.



References ghack\+\_\+get\+\_\+main\+\_\+window(), ghack\+\_\+menu\+\_\+destroy(), ghack\+\_\+menu\+\_\+hide(), ghack\+\_\+menu\+\_\+window\+\_\+add\+\_\+menu(), ghack\+\_\+menu\+\_\+window\+\_\+clear(), ghack\+\_\+menu\+\_\+window\+\_\+display(), ghack\+\_\+menu\+\_\+window\+\_\+end\+\_\+menu(), ghack\+\_\+menu\+\_\+window\+\_\+key(), ghack\+\_\+menu\+\_\+window\+\_\+put\+\_\+string(), ghack\+\_\+menu\+\_\+window\+\_\+select\+\_\+menu(), ghack\+\_\+menu\+\_\+window\+\_\+start\+\_\+menu(), and N\+U\+L\+L.



Referenced by gnome\+\_\+create\+\_\+nhwindow\+\_\+by\+\_\+id().


\begin{DoxyCode}
577 \{
578     GtkWidget *menuWin = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
579     GtkWidget *parent = \hyperlink{gnmain_8c_a103200f2f57b9258dfa18159191ea650}{ghack\_get\_main\_window} ();
580 
581     menuWin = gnome\_dialog\_new(\textcolor{stringliteral}{"GnomeHack"}, GNOME\_STOCK\_BUTTON\_OK, 
582             GNOME\_STOCK\_BUTTON\_CANCEL, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
583     
584     gnome\_dialog\_set\_default( GNOME\_DIALOG(menuWin), 0);
585     gtk\_signal\_connect(GTK\_OBJECT(menuWin), \textcolor{stringliteral}{"destroy"},
586             GTK\_SIGNAL\_FUNC(\hyperlink{gnmenu_8c_a8cf6f7bb40a67afab5ca00ae44fed56a}{ghack\_menu\_destroy}),
587             \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
588 
589     gtk\_signal\_connect (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"delete\_event"},
590             GTK\_SIGNAL\_FUNC (\hyperlink{gnmenu_8c_aed91f6a5b091ea3c830fd07fc56e7c7e}{ghack\_menu\_hide}),
591             \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
592           
593     gtk\_signal\_connect(GTK\_OBJECT(menuWin), \textcolor{stringliteral}{"ghack\_clear"},
594             GTK\_SIGNAL\_FUNC(\hyperlink{gnmenu_8c_a0fba62bb73f3f7ea3977c07f1e69cf5d}{ghack\_menu\_window\_clear}),
595             \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
596 
597     gtk\_signal\_connect(GTK\_OBJECT(menuWin), \textcolor{stringliteral}{"ghack\_display"},
598                        GTK\_SIGNAL\_FUNC(\hyperlink{gnmenu_8c_a922cfcfbcff01189d8c0a65a7176ae67}{ghack\_menu\_window\_display}),
599                        \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
600 
601     gtk\_signal\_connect(GTK\_OBJECT(menuWin), \textcolor{stringliteral}{"ghack\_start\_menu"},
602                        GTK\_SIGNAL\_FUNC(\hyperlink{gnmenu_8c_acd7828ea775c2382417cd6973d4acbdd}{ghack\_menu\_window\_start\_menu}),
603                        \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
604 
605     gtk\_signal\_connect(GTK\_OBJECT(menuWin), \textcolor{stringliteral}{"ghack\_add\_menu"},
606                        GTK\_SIGNAL\_FUNC(\hyperlink{gnmenu_8c_ad19a7a944e97cef3323bf8a31b3d0072}{ghack\_menu\_window\_add\_menu}),
607                        \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
608 
609     gtk\_signal\_connect(GTK\_OBJECT(menuWin), \textcolor{stringliteral}{"ghack\_end\_menu"},
610                        GTK\_SIGNAL\_FUNC(\hyperlink{gnmenu_8c_a6c2d4defda60c1486bd901bfcda5ede1}{ghack\_menu\_window\_end\_menu}),
611                        \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
612 
613     gtk\_signal\_connect(GTK\_OBJECT(menuWin), \textcolor{stringliteral}{"ghack\_select\_menu"},
614                        GTK\_SIGNAL\_FUNC(\hyperlink{gnmenu_8c_adae68cf5b7a99ed2a8da9823f741e84c}{ghack\_menu\_window\_select\_menu}),
615                        \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
616 
617     gtk\_signal\_connect(GTK\_OBJECT(menuWin), \textcolor{stringliteral}{"ghack\_putstr"},
618                        GTK\_SIGNAL\_FUNC(\hyperlink{gnmenu_8c_a7a38dcdd6e1dd1670d352e53536e05eb}{ghack\_menu\_window\_put\_string}),
619                        \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
620 
621     gtk\_signal\_connect(GTK\_OBJECT(menuWin), \textcolor{stringliteral}{"key\_press\_event"},
622                        GTK\_SIGNAL\_FUNC(\hyperlink{gnmenu_8c_aae897ed8ef60d7ff902c443777ebb792}{ghack\_menu\_window\_key}),
623                        \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
624 
625     \textcolor{comment}{/* Center the dialog over parent */}
626     g\_assert (parent != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
627     g\_assert (menuWin != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
628     g\_assert (GTK\_IS\_WINDOW (parent));
629     g\_assert (GNOME\_IS\_DIALOG (menuWin));
630     gnome\_dialog\_set\_parent (GNOME\_DIALOG (menuWin), GTK\_WINDOW (parent));
631     
632     \textcolor{keywordflow}{return} menuWin;
633 \}
\end{DoxyCode}
\hypertarget{gnmenu_8c_a8cf6f7bb40a67afab5ca00ae44fed56a}{\index{gnmenu.\+c@{gnmenu.\+c}!ghack\+\_\+menu\+\_\+destroy@{ghack\+\_\+menu\+\_\+destroy}}
\index{ghack\+\_\+menu\+\_\+destroy@{ghack\+\_\+menu\+\_\+destroy}!gnmenu.\+c@{gnmenu.\+c}}
\subsubsection[{ghack\+\_\+menu\+\_\+destroy}]{\setlength{\rightskip}{0pt plus 5cm}void ghack\+\_\+menu\+\_\+destroy (
\begin{DoxyParamCaption}
\item[{Gtk\+Widget $\ast$}]{menu\+Win, }
\item[{gpointer}]{data}
\end{DoxyParamCaption}
)}}\label{gnmenu_8c_a8cf6f7bb40a67afab5ca00ae44fed56a}


Definition at line 520 of file gnmenu.\+c.



References clist, gless, gnome\+\_\+delete\+\_\+nhwindow\+\_\+by\+\_\+reference(), Menu\+Menu, Menu\+Text, and N\+U\+L\+L.



Referenced by ghack\+\_\+init\+\_\+menu\+\_\+window().


\begin{DoxyCode}
521 \{
522     \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37}{MenuWinType} isMenu;
523 
524     isMenu = (\hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37}{MenuWinType}) GPOINTER\_TO\_INT
525         (gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"isMenu"}));
526 
527     \textcolor{keywordflow}{if} (isMenu == \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a7f6a971ae217b86c9bc8d8e181d8d9ad}{MenuText}) \{
528       GnomeLess *\hyperlink{gntext_8c_a6fada5e9e468ba9d7d2d0b24c2a84ca5}{gless};
529 
530       gless = GNOME\_LESS (gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"gless"}));
531       g\_assert (gless != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
532       g\_assert (gless->text != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
533       g\_assert (GTK\_IS\_TEXT (gless->text));
534       gtk\_widget\_destroy(GTK\_WIDGET(gless));
535     \}
536 
537     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (isMenu == \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a1706f25014518b450a907744ad45664c}{MenuMenu}) \{
538       GtkWidget *frame1, *swin, *\hyperlink{gnopts_8c_aaacfa1e004c6c39fcee7664eb1b0ae9d}{clist}; 
539 
540       \textcolor{comment}{/* destroy existing menu data, if any */}
541       clist = gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"clist"});
542       \textcolor{keywordflow}{if} (clist) \{
543     \textcolor{comment}{/* destroy all the row\_data we stored in the clist */}
544     \textcolor{keywordtype}{int} i, numRows;
545     \hyperlink{structmenuItem}{menuItem}* item;
546     numRows = GPOINTER\_TO\_INT( gtk\_object\_get\_data(
547             GTK\_OBJECT(clist), \textcolor{stringliteral}{"numRows"}) );
548     \textcolor{keywordflow}{for}( i=0; i<numRows; i++) \{
549         item = (\hyperlink{structmenuItem}{menuItem}*) gtk\_clist\_get\_row\_data( 
550             GTK\_CLIST (clist), i);
551         \textcolor{keywordflow}{if} (item != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}) \{
552         g\_free( item);
553         gtk\_clist\_set\_row\_data (GTK\_CLIST (clist), i, 
554             (gpointer) \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
555         \}
556     \}
557 
558     gtk\_object\_set\_data (GTK\_OBJECT (clist), \textcolor{stringliteral}{"numItems"},
559                 GINT\_TO\_POINTER (-1));
560     gtk\_widget\_destroy (clist);
561       \}
562       swin = gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"swin"});
563       \textcolor{keywordflow}{if} (swin) \{
564     gtk\_widget\_destroy (swin);
565       \}
566       frame1 = gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"frame1"});
567       \textcolor{keywordflow}{if} (frame1) \{
568     gtk\_widget\_destroy (frame1);
569       \}
570     \}
571     \hyperlink{gnbind_8c_a58a5c3bc25593158814bfb239ee6bb20}{gnome\_delete\_nhwindow\_by\_reference} (menuWin);    
572 \}
\end{DoxyCode}
\hypertarget{gnmenu_8c_af55fb0471f01d81db97a6743d96f49cd}{\index{gnmenu.\+c@{gnmenu.\+c}!ghack\+\_\+menu\+\_\+ext\+\_\+cmd@{ghack\+\_\+menu\+\_\+ext\+\_\+cmd}}
\index{ghack\+\_\+menu\+\_\+ext\+\_\+cmd@{ghack\+\_\+menu\+\_\+ext\+\_\+cmd}!gnmenu.\+c@{gnmenu.\+c}}
\subsubsection[{ghack\+\_\+menu\+\_\+ext\+\_\+cmd}]{\setlength{\rightskip}{0pt plus 5cm}int ghack\+\_\+menu\+\_\+ext\+\_\+cmd (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{gnmenu_8c_af55fb0471f01d81db97a6743d96f49cd}


Definition at line 693 of file gnmenu.\+c.



References ext\+Menu\+::char\+Idx, clist, ext\+Menu\+::cur\+Item, ext\+\_\+func\+\_\+tab\+::ef\+\_\+desc, ext\+\_\+func\+\_\+tab\+::ef\+\_\+txt, extcmdlist, F\+A\+L\+S\+E, ghack\+\_\+ext\+\_\+key\+\_\+hit(), ghack\+\_\+get\+\_\+main\+\_\+window(), ghack\+\_\+menu\+\_\+row\+\_\+selected(), ext\+Menu\+::last\+Time, N\+U\+L\+L, ext\+Menu\+::num\+Rows, and T\+R\+U\+E.



Referenced by gnome\+\_\+get\+\_\+ext\+\_\+cmd().


\begin{DoxyCode}
694 \{
695     \textcolor{keywordtype}{int} n;
696     GtkWidget* dialog;
697     GtkWidget* swin;
698     GtkWidget* frame1;
699     GtkWidget* \hyperlink{gnopts_8c_aaacfa1e004c6c39fcee7664eb1b0ae9d}{clist};
700     \hyperlink{structextMenu}{extMenu} info;
701 
702     dialog = gnome\_dialog\_new(\textcolor{stringliteral}{"Extended Commands"},
703                   GNOME\_STOCK\_BUTTON\_OK,
704                   GNOME\_STOCK\_BUTTON\_CANCEL,
705                   \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
706     gnome\_dialog\_close\_hides(GNOME\_DIALOG(dialog), \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
707     gtk\_signal\_connect(GTK\_OBJECT(dialog), \textcolor{stringliteral}{"key\_press\_event"},
708                GTK\_SIGNAL\_FUNC(\hyperlink{gnmenu_8c_aa368f6ca667ccacbfb06ac5f98aa2821}{ghack\_ext\_key\_hit}), &info);
709 
710     frame1 = gtk\_frame\_new(\textcolor{stringliteral}{"Make your selection"});
711     gtk\_object\_set\_data(GTK\_OBJECT(dialog), \textcolor{stringliteral}{"frame1"}, frame1);
712     gtk\_widget\_show(frame1);
713     gtk\_container\_border\_width(GTK\_CONTAINER(frame1), 3);
714 
715     swin = gtk\_scrolled\_window\_new(\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
716     clist = gtk\_clist\_new(2);
717     gtk\_object\_set\_data(GTK\_OBJECT(dialog), \textcolor{stringliteral}{"clist"}, clist);
718     gtk\_widget\_set\_usize(clist, 500, 400);
719     gtk\_container\_add(GTK\_CONTAINER(swin), clist);
720     gtk\_scrolled\_window\_set\_policy(GTK\_SCROLLED\_WINDOW(swin),
721                    GTK\_POLICY\_AUTOMATIC, GTK\_POLICY\_AUTOMATIC);
722 
723     gtk\_signal\_connect(GTK\_OBJECT(clist), \textcolor{stringliteral}{"select\_row"},
724                GTK\_SIGNAL\_FUNC(\hyperlink{gnmenu_8c_a26babfcc4b66e690814fcbdeab70d41c}{ghack\_menu\_row\_selected}), 
      \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
725 
726     gtk\_container\_add(GTK\_CONTAINER(frame1), swin);
727     gtk\_box\_pack\_start\_defaults(GTK\_BOX(GNOME\_DIALOG(dialog)->vbox), frame1);
728 
729     \textcolor{comment}{/* Add the extended commands into the list here... */}
730     \textcolor{keywordflow}{for} (n = 0; \hyperlink{func__tab_8h_af3a00fc8e4e157bae08471bcc66d46d9}{extcmdlist}[n].\hyperlink{structext__func__tab_a1c6b81a9ba3a70826ea2f1c2eacc089e}{ef\_txt}; ++n) \{
731     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *text[3]=\{\hyperlink{func__tab_8h_af3a00fc8e4e157bae08471bcc66d46d9}{extcmdlist}[n].\hyperlink{structext__func__tab_a1c6b81a9ba3a70826ea2f1c2eacc089e}{ef\_txt},\hyperlink{func__tab_8h_af3a00fc8e4e157bae08471bcc66d46d9}{extcmdlist}[n].
      \hyperlink{structext__func__tab_ae97246b7cf51ab18cd3b612c05e2b7c1}{ef\_desc},\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}\};
732     gtk\_clist\_insert(GTK\_CLIST(clist), n, (\textcolor{keywordtype}{char}**) text);
733     \}
734 
735     \textcolor{comment}{/* fill in starting info fields */}
736     info.\hyperlink{structextMenu_aaa686aca39f89627044b163edf1db00e}{curItem} = -1;
737     info.\hyperlink{structextMenu_ac90ebf8746d53b094060b505a0c4dc4b}{numRows} = n;
738     info.\hyperlink{structextMenu_a56587827e174f902da38f5569e8b9c25}{charIdx} = 0;
739     info.\hyperlink{structextMenu_a66b8a9fd7a18cf439b0a82d0712d540c}{lastTime} = 0;
740 
741     gtk\_clist\_columns\_autosize(GTK\_CLIST(clist));
742     gtk\_widget\_show\_all(swin);
743 
744     \textcolor{comment}{/* Center the dialog over over parent */}
745     gnome\_dialog\_set\_default(GNOME\_DIALOG(dialog), 0);
746     gtk\_window\_set\_modal(GTK\_WINDOW(dialog), \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
747     gnome\_dialog\_set\_parent(GNOME\_DIALOG(dialog),
748                 GTK\_WINDOW(\hyperlink{gnmain_8c_a103200f2f57b9258dfa18159191ea650}{ghack\_get\_main\_window}()));
749 
750     \textcolor{comment}{/* Run the dialog -- returning whichever button was pressed */}
751     n = gnome\_dialog\_run\_and\_close(GNOME\_DIALOG(dialog));
752 
753     \textcolor{comment}{/* Quit on button 2 or error */}
754     \textcolor{keywordflow}{return} (n != 0) ? -1 : info.\hyperlink{structextMenu_aaa686aca39f89627044b163edf1db00e}{curItem};
755 \}
\end{DoxyCode}
\hypertarget{gnmenu_8c_aed91f6a5b091ea3c830fd07fc56e7c7e}{\index{gnmenu.\+c@{gnmenu.\+c}!ghack\+\_\+menu\+\_\+hide@{ghack\+\_\+menu\+\_\+hide}}
\index{ghack\+\_\+menu\+\_\+hide@{ghack\+\_\+menu\+\_\+hide}!gnmenu.\+c@{gnmenu.\+c}}
\subsubsection[{ghack\+\_\+menu\+\_\+hide}]{\setlength{\rightskip}{0pt plus 5cm}gint ghack\+\_\+menu\+\_\+hide (
\begin{DoxyParamCaption}
\item[{Gtk\+Widget $\ast$}]{menu\+Win, }
\item[{Gdk\+Event $\ast$}]{event, }
\item[{gpointer}]{data}
\end{DoxyParamCaption}
)}}\label{gnmenu_8c_aed91f6a5b091ea3c830fd07fc56e7c7e}


Definition at line 152 of file gnmenu.\+c.



References F\+A\+L\+S\+E.



Referenced by ghack\+\_\+init\+\_\+menu\+\_\+window().


\begin{DoxyCode}
153 \{
154     gtk\_widget\_hide (menuWin);
155     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}; \textcolor{comment}{/* FIXME: what is correct result here? */}
156 \}
\end{DoxyCode}
\hypertarget{gnmenu_8c_a26babfcc4b66e690814fcbdeab70d41c}{\index{gnmenu.\+c@{gnmenu.\+c}!ghack\+\_\+menu\+\_\+row\+\_\+selected@{ghack\+\_\+menu\+\_\+row\+\_\+selected}}
\index{ghack\+\_\+menu\+\_\+row\+\_\+selected@{ghack\+\_\+menu\+\_\+row\+\_\+selected}!gnmenu.\+c@{gnmenu.\+c}}
\subsubsection[{ghack\+\_\+menu\+\_\+row\+\_\+selected}]{\setlength{\rightskip}{0pt plus 5cm}static void ghack\+\_\+menu\+\_\+row\+\_\+selected (
\begin{DoxyParamCaption}
\item[{Gtk\+C\+List $\ast$}]{clist, }
\item[{int}]{row, }
\item[{int}]{col, }
\item[{Gdk\+Event $\ast$}]{event}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{gnmenu_8c_a26babfcc4b66e690814fcbdeab70d41c}


Definition at line 84 of file gnmenu.\+c.



Referenced by ghack\+\_\+menu\+\_\+ext\+\_\+cmd(), and ghack\+\_\+menu\+\_\+window\+\_\+start\+\_\+menu().


\begin{DoxyCode}
85 \{
86     \textcolor{comment}{/* FIXME: Do something */}
87 \}
\end{DoxyCode}
\hypertarget{gnmenu_8c_ad19a7a944e97cef3323bf8a31b3d0072}{\index{gnmenu.\+c@{gnmenu.\+c}!ghack\+\_\+menu\+\_\+window\+\_\+add\+\_\+menu@{ghack\+\_\+menu\+\_\+window\+\_\+add\+\_\+menu}}
\index{ghack\+\_\+menu\+\_\+window\+\_\+add\+\_\+menu@{ghack\+\_\+menu\+\_\+window\+\_\+add\+\_\+menu}!gnmenu.\+c@{gnmenu.\+c}}
\subsubsection[{ghack\+\_\+menu\+\_\+window\+\_\+add\+\_\+menu}]{\setlength{\rightskip}{0pt plus 5cm}void ghack\+\_\+menu\+\_\+window\+\_\+add\+\_\+menu (
\begin{DoxyParamCaption}
\item[{Gtk\+Widget $\ast$}]{menu\+Win, }
\item[{gpointer}]{menu\+\_\+item, }
\item[{gpointer}]{data}
\end{DoxyParamCaption}
)}}\label{gnmenu_8c_ad19a7a944e97cef3323bf8a31b3d0072}


Definition at line 274 of file gnmenu.\+c.



References \+\_\+\+G\+Hack\+Menu\+Item\+::accelerator, menu\+Item\+::accelerator, A\+T\+R\+\_\+\+B\+L\+I\+N\+K, A\+T\+R\+\_\+\+B\+O\+L\+D, A\+T\+R\+\_\+\+I\+N\+V\+E\+R\+S\+E, A\+T\+R\+\_\+\+U\+L\+I\+N\+E, \+\_\+\+G\+Hack\+Menu\+Item\+::attr, big\+Style, buf, B\+U\+F\+S\+Z, clist, color\+\_\+blue, F\+A\+L\+S\+E, ghack\+\_\+image\+\_\+from\+\_\+glyph(), \+\_\+\+G\+Hack\+Menu\+Item\+::glyph, \+\_\+\+G\+Hack\+Menu\+Item\+::group\+\_\+accel, \+\_\+\+G\+Hack\+Menu\+Item\+::identifier, menu\+Item\+::identifier, image, menu\+Item\+::item\+Number, N\+O\+\_\+\+G\+L\+Y\+P\+H, N\+U\+L\+L, \+\_\+\+G\+Hack\+Menu\+Item\+::presel, menu\+Item\+::selected, \+\_\+\+G\+Hack\+Menu\+Item\+::str, and T\+R\+U\+E.



Referenced by ghack\+\_\+init\+\_\+menu\+\_\+window().


\begin{DoxyCode}
276 \{
277     \hyperlink{struct__GHackMenuItem}{GHackMenuItem}*  item;
278     GtkWidget       *\hyperlink{gnopts_8c_aaacfa1e004c6c39fcee7664eb1b0ae9d}{clist};
279     gchar \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}]=\textcolor{stringliteral}{""}, accelBuf[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}]=\textcolor{stringliteral}{""};
280     gchar *pbuf;
281     \textcolor{keywordtype}{char} *text[4] = \{ \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, NULL \};
282     gint nCurrentRow = -1, numItems = -1;
283     \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37}{MenuWinType} isMenu;
284     GtkStyle *\hyperlink{gnstatus_8c_a2a29c5b35af0126b4a78468eb6446355}{bigStyle} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
285     gboolean item\_selectable;
286     GdkImlibImage* \hyperlink{gifread_8c_a2d8da73d47fd8a1304cbacafde81f61d}{image};
287     \textcolor{keyword}{static} gboolean special;
288 
289     g\_assert (\hyperlink{structmi}{menu\_item} != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
290     item = (\hyperlink{struct__GHackMenuItem}{GHackMenuItem}*) \hyperlink{structmi}{menu\_item};
291     item\_selectable = ( item->\hyperlink{struct__GHackMenuItem_a79a3cfa67a108ba6055d4fa6bd081f79}{identifier}->a\_int == 0)? \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE} : 
      \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
292     isMenu = (\hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37}{MenuWinType}) GPOINTER\_TO\_INT
293         (gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"isMenu"}));
294 
295     clist = GTK\_WIDGET (gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"clist"}));
296     g\_assert (clist != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
297     \textcolor{comment}{/* This is a special kludge to make the special hidden help menu item work as designed */} 
298     \textcolor{keywordflow}{if} ( special==\hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} ) \{
299     special=\hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
300     item\_selectable=\hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
301     \}
302     \textcolor{keywordflow}{if} ( ! strcmp( item->\hyperlink{struct__GHackMenuItem_a338f49c097ab2101d16b3acb300ebf41}{str}, \textcolor{stringliteral}{"The NetHack license."})) \{
303     special=\hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
304     \}
305     
306     \textcolor{keywordflow}{if} (item->\hyperlink{struct__GHackMenuItem_a338f49c097ab2101d16b3acb300ebf41}{str}) \{
307 
308     \textcolor{comment}{/* First, make a new blank entry in the clist */}
309     nCurrentRow = gtk\_clist\_append (GTK\_CLIST (clist), text);
310 
311     \textcolor{keywordflow}{if} (item->\hyperlink{struct__GHackMenuItem_acfcd2d3604cfa6ff4083472b493cbfb0}{glyph} != \hyperlink{display_8h_ac36b9cc8436af3cf1f7f9919878d8354}{NO\_GLYPH}) \{
312         image = \hyperlink{gnglyph_8c_a5aa4ed8940364d99bdf5a7545db02a28}{ghack\_image\_from\_glyph}( item->\hyperlink{struct__GHackMenuItem_acfcd2d3604cfa6ff4083472b493cbfb0}{glyph}, 
      \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
313         \textcolor{keywordflow}{if} (image==\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || image->pixmap==\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}) \{
314         g\_warning(\textcolor{stringliteral}{"Bummer -- having to force rendering for glyph %d!"}, item->
      \hyperlink{struct__GHackMenuItem_acfcd2d3604cfa6ff4083472b493cbfb0}{glyph});
315         \textcolor{comment}{/* wierd -- pixmap is NULL so retry rendering it */}
316         image = \hyperlink{gnglyph_8c_a5aa4ed8940364d99bdf5a7545db02a28}{ghack\_image\_from\_glyph}( item->\hyperlink{struct__GHackMenuItem_acfcd2d3604cfa6ff4083472b493cbfb0}{glyph}, 
      \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
317         \}
318         \textcolor{keywordflow}{if} (image==\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || image->pixmap==\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}) \{
319             g\_error(\textcolor{stringliteral}{"Aiiee! glyph is still NULL for item\(\backslash\)n\(\backslash\)"%s\(\backslash\)""}, 
320                 item->\hyperlink{struct__GHackMenuItem_a338f49c097ab2101d16b3acb300ebf41}{str});
321         \}
322         \textcolor{keywordflow}{else} 
323         gtk\_clist\_set\_pixmap (GTK\_CLIST (clist), 
324             nCurrentRow, 1, 
325             gdk\_imlib\_move\_image( image), 
326             gdk\_imlib\_move\_mask( image));
327     \}
328     \textcolor{keywordflow}{if} (item->\hyperlink{struct__GHackMenuItem_ab600d7cf5d77e6edfcdb55446defd2e7}{accelerator}) \{
329         \textcolor{comment}{/* FIXME: handle accelerator, */}
330         g\_snprintf(accelBuf, \textcolor{keyword}{sizeof}(accelBuf), \textcolor{stringliteral}{"%c "}, item->\hyperlink{struct__GHackMenuItem_ab600d7cf5d77e6edfcdb55446defd2e7}{accelerator});
331         gtk\_clist\_set\_text (GTK\_CLIST (clist), nCurrentRow, 0, accelBuf);
332         g\_snprintf(buf, \textcolor{keyword}{sizeof}(buf), \textcolor{stringliteral}{"%s"}, item->\hyperlink{struct__GHackMenuItem_a338f49c097ab2101d16b3acb300ebf41}{str});
333         gtk\_clist\_set\_text (GTK\_CLIST (clist), nCurrentRow, 2, buf);
334     \} \textcolor{keywordflow}{else} \{
335         \textcolor{keywordflow}{if} (item->\hyperlink{struct__GHackMenuItem_a3d933471459a6fa6e6ed39a630081b3c}{group\_accel}) \{
336         \textcolor{comment}{/* FIXME: maybe some day I should try to handle }
337 \textcolor{comment}{         * group accelerators... */}
338         \}
339         \textcolor{keywordflow}{if} (( (item->\hyperlink{struct__GHackMenuItem_a3200e3f2ba0798dc63e0f7abe98652bd}{attr} == 0) && (item->\hyperlink{struct__GHackMenuItem_a79a3cfa67a108ba6055d4fa6bd081f79}{identifier}->a\_int != 0)) || (special ==
      \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}) ) \{
340         numItems = GPOINTER\_TO\_INT( gtk\_object\_get\_data(
341                 GTK\_OBJECT(clist), \textcolor{stringliteral}{"numItems"}) )+1;
342 
343         \textcolor{comment}{/* Ok, now invent a unique accelerator */}
344         \textcolor{keywordflow}{if} (  (\textcolor{charliteral}{'a'}+numItems) <= \textcolor{charliteral}{'z'} ) \{
345             g\_snprintf(accelBuf, \textcolor{keyword}{sizeof}(accelBuf), \textcolor{stringliteral}{"%c "}, \textcolor{charliteral}{'a'}+numItems);
346             gtk\_clist\_set\_text(GTK\_CLIST(clist), nCurrentRow, 0, accelBuf);
347         \}
348         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (\textcolor{charliteral}{'A'}+numItems-26)<=\textcolor{charliteral}{'Z'}) \{
349             g\_snprintf(accelBuf, \textcolor{keyword}{sizeof}(accelBuf), \textcolor{stringliteral}{"%c "}, \textcolor{charliteral}{'A'}+numItems-26); 
350             gtk\_clist\_set\_text(GTK\_CLIST(clist), nCurrentRow, 0, accelBuf);
351         \} \textcolor{keywordflow}{else} \{
352             accelBuf[0] = buf[0] = 0;
353         \}
354         g\_snprintf(buf, \textcolor{keyword}{sizeof}(buf), \textcolor{stringliteral}{"%s"}, item->\hyperlink{struct__GHackMenuItem_a338f49c097ab2101d16b3acb300ebf41}{str});
355         gtk\_clist\_set\_text (GTK\_CLIST (clist), nCurrentRow, 2, buf);
356         gtk\_object\_set\_data (GTK\_OBJECT (clist), \textcolor{stringliteral}{"numItems"},
357                     GINT\_TO\_POINTER (numItems));
358 
359         \textcolor{comment}{/* This junk is to specially handle the options menu */}
360         pbuf = strstr( buf, \textcolor{stringliteral}{" ["});
361         \textcolor{keywordflow}{if} (pbuf == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}) \{
362             pbuf = strstr( buf, \textcolor{stringliteral}{"\(\backslash\)t["});
363         \}
364         \textcolor{keywordflow}{if} (pbuf != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}) \{
365             *pbuf=0;
366             pbuf++;
367             gtk\_clist\_set\_text (GTK\_CLIST (clist), nCurrentRow, 3, pbuf);
368         \}
369         \}
370         \textcolor{comment}{/* FIXME: handle more than 26*2 accelerators (but how?}
371 \textcolor{comment}{         * since I only have so many keys to work with???)}
372 \textcolor{comment}{        else}
373 \textcolor{comment}{        \{}
374 \textcolor{comment}{        foo();}
375 \textcolor{comment}{        \}}
376 \textcolor{comment}{        */}
377         \textcolor{keywordflow}{else} \{
378         g\_snprintf(buf, \textcolor{keyword}{sizeof}(buf), \textcolor{stringliteral}{"%s"}, item->\hyperlink{struct__GHackMenuItem_a338f49c097ab2101d16b3acb300ebf41}{str});
379         pbuf = strstr( buf, \textcolor{stringliteral}{" ["});
380         \textcolor{keywordflow}{if} (pbuf == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}) \{
381             pbuf = strstr( buf, \textcolor{stringliteral}{"\(\backslash\)t["});
382         \}
383         \textcolor{keywordflow}{if} (pbuf != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}) \{
384             *pbuf=0;
385             pbuf++;
386             gtk\_clist\_set\_text (GTK\_CLIST (clist), nCurrentRow, 3, pbuf);
387         \}
388         gtk\_clist\_set\_text (GTK\_CLIST (clist), nCurrentRow, 2, buf);
389         
390         \}
391     \}
392 
393     \textcolor{keywordflow}{if} (item->\hyperlink{struct__GHackMenuItem_a3200e3f2ba0798dc63e0f7abe98652bd}{attr}) \{
394         \textcolor{keywordflow}{switch}(item->\hyperlink{struct__GHackMenuItem_a3200e3f2ba0798dc63e0f7abe98652bd}{attr}) \{
395         \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a9825a0f34fbbf473f8495b785fe54f7c}{ATR\_ULINE}:
396         \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a3bdd83c2b946e860e76de6aac6a4edfe}{ATR\_BOLD}:
397         \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a9d66a94b42076440893a6250fe72a8a8}{ATR\_BLINK}:
398         \textcolor{keywordflow}{case} \hyperlink{wintype_8h_a043c5fd85034778be335623e273d0777}{ATR\_INVERSE}:
399             bigStyle = gtk\_style\_copy (GTK\_WIDGET (clist)->style);
400             g\_assert (bigStyle != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
401             gdk\_font\_unref (bigStyle->font);
402             bigStyle->font = gdk\_font\_load (
403                 \textcolor{stringliteral}{"-misc-fixed-*-*-*-*-20-*-*-*-*-*-*-*"});
404             bigStyle->fg[GTK\_STATE\_NORMAL] = \hyperlink{gnmenu_8c_aefd4a6b43d479ce169e4657927505d7f}{color\_blue};
405             gtk\_clist\_set\_cell\_style (GTK\_CLIST (clist), 
406                 nCurrentRow, 2, bigStyle);
407             item\_selectable = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
408         \}
409     \}
410 
411 
412     g\_assert (nCurrentRow >= 0);
413     gtk\_clist\_set\_selectable (GTK\_CLIST (clist), nCurrentRow,
414                   item\_selectable);
415 
416     \textcolor{keywordflow}{if} ( item\_selectable==\hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} && item->\hyperlink{struct__GHackMenuItem_a0b6f9304a066862ccf1cf77632e4936c}{presel}== \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}) \{
417         \textcolor{comment}{/* pre-select this item */}
418         gtk\_clist\_select\_row( GTK\_CLIST (clist), nCurrentRow, 0);
419     \}
420     
421     gtk\_object\_set\_data (GTK\_OBJECT (clist), \textcolor{stringliteral}{"numRows"},
422                         GINT\_TO\_POINTER (nCurrentRow));
423         
424     \textcolor{comment}{/* We have to allocate memory here, since the menu\_item currently}
425 \textcolor{comment}{     * lives on the stack, and will otherwise go to the great bit bucket }
426 \textcolor{comment}{     * in the sky as soon as this function exits, which would leave a }
427 \textcolor{comment}{     * pointer to crap in the row\_data.  Use g\_memdup to make a private, }
428 \textcolor{comment}{     * persistant copy of the item identifier.}
429 \textcolor{comment}{     *}
430 \textcolor{comment}{     * We need to arrange to blow away this memory somewhere (like }
431 \textcolor{comment}{     * ghack\_menu\_destroy and ghack\_menu\_window\_clear for example).}
432 \textcolor{comment}{     *}
433 \textcolor{comment}{     *  -Erik}
434 \textcolor{comment}{     */}
435     \{
436         \hyperlink{structmenuItem}{menuItem} newItem;
437         \hyperlink{structmenuItem}{menuItem} *pNewItem;
438         
439         newItem.\hyperlink{structmenuItem_a51df9eca851d9d5801f6e7a8088016d6}{identifier} = *item->\hyperlink{struct__GHackMenuItem_a79a3cfa67a108ba6055d4fa6bd081f79}{identifier};
440         newItem.\hyperlink{structmenuItem_a110b1866aeaf1a16e0cd29e1088333a8}{itemNumber}=nCurrentRow;
441         newItem.\hyperlink{structmenuItem_a96b0d07f0e7ee05c3e1824c0a3665ddb}{selected}=\hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
442         newItem.\hyperlink{structmenuItem_af83f532960744d4bad0e9ae62e03c896}{accelerator}[0]=0;
443         \textcolor{comment}{/* only copy 1 char, since accel keys are by definition 1 char */}
444         \textcolor{keywordflow}{if} (accelBuf[0]) \{
445         strncpy(newItem.\hyperlink{structmenuItem_af83f532960744d4bad0e9ae62e03c896}{accelerator}, accelBuf, 1);
446         \}
447         newItem.\hyperlink{structmenuItem_af83f532960744d4bad0e9ae62e03c896}{accelerator}[1]=0;
448 
449         pNewItem = g\_memdup(&newItem, \textcolor{keyword}{sizeof}( \hyperlink{structmenuItem}{menuItem}));
450         gtk\_clist\_set\_row\_data (GTK\_CLIST (clist), nCurrentRow,
451                     (gpointer) pNewItem);
452     \}
453     \}
454     \textcolor{comment}{/* Now adjust the column widths to match the contents */}
455     gtk\_clist\_columns\_autosize (GTK\_CLIST (clist));
456 \}
\end{DoxyCode}
\hypertarget{gnmenu_8c_a0fba62bb73f3f7ea3977c07f1e69cf5d}{\index{gnmenu.\+c@{gnmenu.\+c}!ghack\+\_\+menu\+\_\+window\+\_\+clear@{ghack\+\_\+menu\+\_\+window\+\_\+clear}}
\index{ghack\+\_\+menu\+\_\+window\+\_\+clear@{ghack\+\_\+menu\+\_\+window\+\_\+clear}!gnmenu.\+c@{gnmenu.\+c}}
\subsubsection[{ghack\+\_\+menu\+\_\+window\+\_\+clear}]{\setlength{\rightskip}{0pt plus 5cm}void ghack\+\_\+menu\+\_\+window\+\_\+clear (
\begin{DoxyParamCaption}
\item[{Gtk\+Widget $\ast$}]{menu\+Win, }
\item[{gpointer}]{data}
\end{DoxyParamCaption}
)}}\label{gnmenu_8c_a0fba62bb73f3f7ea3977c07f1e69cf5d}


Definition at line 91 of file gnmenu.\+c.



References clist, gless, Menu\+Menu, Menu\+Text, and N\+U\+L\+L.



Referenced by ghack\+\_\+init\+\_\+menu\+\_\+window().


\begin{DoxyCode}
92 \{
93     \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37}{MenuWinType} isMenu;
94     \textcolor{keywordtype}{int} i, numRows;
95     \hyperlink{structmenuItem}{menuItem}* item;
96 
97     isMenu = (\hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37}{MenuWinType}) GPOINTER\_TO\_INT
98         (gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"isMenu"}));
99 
100     \textcolor{keywordflow}{if} (isMenu == \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a1706f25014518b450a907744ad45664c}{MenuMenu}) \{
101       GtkWidget *\hyperlink{gnopts_8c_aaacfa1e004c6c39fcee7664eb1b0ae9d}{clist};
102 
103       clist = GTK\_WIDGET (gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"clist"}));
104       g\_assert (clist != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
105 
106       \textcolor{comment}{/* destroy existing menu data, if any */}
107       \textcolor{keywordflow}{if} (clist) \{
108     \textcolor{comment}{/* destroy all the row\_data we stored in the clist */}
109     numRows = GPOINTER\_TO\_INT( gtk\_object\_get\_data(
110             GTK\_OBJECT(clist), \textcolor{stringliteral}{"numRows"}) );
111     \textcolor{keywordflow}{for}( i=0; i<numRows; i++) \{
112         item = (\hyperlink{structmenuItem}{menuItem}*) gtk\_clist\_get\_row\_data( 
113             GTK\_CLIST (clist), i);
114         \textcolor{keywordflow}{if} (item != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}) \{
115         g\_free( item);
116         gtk\_clist\_set\_row\_data (GTK\_CLIST (clist), i, 
117             (gpointer) \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
118         \}
119     \}
120     gtk\_object\_set\_data (GTK\_OBJECT (clist), \textcolor{stringliteral}{"numItems"},
121                 GINT\_TO\_POINTER (-1));
122     gtk\_clist\_clear (GTK\_CLIST (clist));
123       \}
124     \}
125     
126     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (isMenu == \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a7f6a971ae217b86c9bc8d8e181d8d9ad}{MenuText}) \{
127       GnomeLess *\hyperlink{gntext_8c_a6fada5e9e468ba9d7d2d0b24c2a84ca5}{gless};
128 
129       gless = GNOME\_LESS (gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"gless"}));
130       g\_assert (gless != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
131 
132       gtk\_editable\_delete\_text (GTK\_EDITABLE (gless->text), 0, 0);
133     \}
134 
135 \}
\end{DoxyCode}
\hypertarget{gnmenu_8c_a922cfcfbcff01189d8c0a65a7176ae67}{\index{gnmenu.\+c@{gnmenu.\+c}!ghack\+\_\+menu\+\_\+window\+\_\+display@{ghack\+\_\+menu\+\_\+window\+\_\+display}}
\index{ghack\+\_\+menu\+\_\+window\+\_\+display@{ghack\+\_\+menu\+\_\+window\+\_\+display}!gnmenu.\+c@{gnmenu.\+c}}
\subsubsection[{ghack\+\_\+menu\+\_\+window\+\_\+display}]{\setlength{\rightskip}{0pt plus 5cm}void ghack\+\_\+menu\+\_\+window\+\_\+display (
\begin{DoxyParamCaption}
\item[{Gtk\+Widget $\ast$}]{menu\+Win, }
\item[{gboolean}]{blocking, }
\item[{gpointer}]{data}
\end{DoxyParamCaption}
)}}\label{gnmenu_8c_a922cfcfbcff01189d8c0a65a7176ae67}


Definition at line 138 of file gnmenu.\+c.



References T\+R\+U\+E.



Referenced by ghack\+\_\+init\+\_\+menu\+\_\+window().


\begin{DoxyCode}
140 \{
141     \textcolor{comment}{//if(blocking) \{}
142         gnome\_dialog\_close\_hides (GNOME\_DIALOG (menuWin), \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
143     gnome\_dialog\_set\_close (GNOME\_DIALOG (menuWin), \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
144     gnome\_dialog\_run\_and\_close(GNOME\_DIALOG (menuWin));
145     \textcolor{comment}{//\}}
146     \textcolor{comment}{//else \{}
147         \textcolor{comment}{//gtk\_widget\_show(menuWin);}
148     \textcolor{comment}{//\}}
149 \}
\end{DoxyCode}
\hypertarget{gnmenu_8c_a6c2d4defda60c1486bd901bfcda5ede1}{\index{gnmenu.\+c@{gnmenu.\+c}!ghack\+\_\+menu\+\_\+window\+\_\+end\+\_\+menu@{ghack\+\_\+menu\+\_\+window\+\_\+end\+\_\+menu}}
\index{ghack\+\_\+menu\+\_\+window\+\_\+end\+\_\+menu@{ghack\+\_\+menu\+\_\+window\+\_\+end\+\_\+menu}!gnmenu.\+c@{gnmenu.\+c}}
\subsubsection[{ghack\+\_\+menu\+\_\+window\+\_\+end\+\_\+menu}]{\setlength{\rightskip}{0pt plus 5cm}void ghack\+\_\+menu\+\_\+window\+\_\+end\+\_\+menu (
\begin{DoxyParamCaption}
\item[{Gtk\+Widget $\ast$}]{menu\+Win, }
\item[{gpointer}]{data}
\end{DoxyParamCaption}
)}}\label{gnmenu_8c_a6c2d4defda60c1486bd901bfcda5ede1}


Definition at line 459 of file gnmenu.\+c.



References N\+U\+L\+L.



Referenced by ghack\+\_\+init\+\_\+menu\+\_\+window().


\begin{DoxyCode}
460 \{
461   \textcolor{keyword}{const} \textcolor{keywordtype}{char}* p = (\textcolor{keyword}{const} \textcolor{keywordtype}{char}*) data;
462 
463   \textcolor{keywordflow}{if} ((p) && (*p)) \{
464     GtkWidget *frame1 = gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"frame1"});
465     g\_assert (frame1 != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
466 
467     gtk\_frame\_set\_label (GTK\_FRAME(frame1), p);
468   \}
469 
470 \}
\end{DoxyCode}
\hypertarget{gnmenu_8c_aae897ed8ef60d7ff902c443777ebb792}{\index{gnmenu.\+c@{gnmenu.\+c}!ghack\+\_\+menu\+\_\+window\+\_\+key@{ghack\+\_\+menu\+\_\+window\+\_\+key}}
\index{ghack\+\_\+menu\+\_\+window\+\_\+key@{ghack\+\_\+menu\+\_\+window\+\_\+key}!gnmenu.\+c@{gnmenu.\+c}}
\subsubsection[{ghack\+\_\+menu\+\_\+window\+\_\+key}]{\setlength{\rightskip}{0pt plus 5cm}static void ghack\+\_\+menu\+\_\+window\+\_\+key (
\begin{DoxyParamCaption}
\item[{Gtk\+Widget $\ast$}]{menu\+Win, }
\item[{Gdk\+Event\+Key $\ast$}]{event, }
\item[{gpointer}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{gnmenu_8c_aae897ed8ef60d7ff902c443777ebb792}


Definition at line 37 of file gnmenu.\+c.



References menu\+Item\+::accelerator, clist, F\+A\+L\+S\+E, menu\+Item\+::item\+Number, Menu\+Menu, N\+U\+L\+L, menu\+Item\+::selected, and T\+R\+U\+E.



Referenced by ghack\+\_\+init\+\_\+menu\+\_\+window().


\begin{DoxyCode}
38 \{
39     \textcolor{keywordtype}{int} i, numRows;
40     \hyperlink{structmenuItem}{menuItem}* item;
41     \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37}{MenuWinType} isMenu;
42 
43     isMenu = (\hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37}{MenuWinType}) GPOINTER\_TO\_INT
44     (gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"isMenu"}));
45 
46     \textcolor{keywordflow}{if} (isMenu == \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a1706f25014518b450a907744ad45664c}{MenuMenu}) \{
47     GtkWidget *\hyperlink{gnopts_8c_aaacfa1e004c6c39fcee7664eb1b0ae9d}{clist};
48     gint selection\_mode;
49 
50     clist = GTK\_WIDGET(gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"clist"}));
51     g\_assert (clist != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
52     numRows = GPOINTER\_TO\_INT
53         (gtk\_object\_get\_data(GTK\_OBJECT(clist), \textcolor{stringliteral}{"numRows"}));
54     selection\_mode = GPOINTER\_TO\_INT
55         (gtk\_object\_get\_data (GTK\_OBJECT(clist), \textcolor{stringliteral}{"selection\_mode"}));
56     \textcolor{keywordflow}{for} (i = 0; i <= numRows; ++i) \{
57         item = (\hyperlink{structmenuItem}{menuItem}*) gtk\_clist\_get\_row\_data(GTK\_CLIST(clist), i);
58         \textcolor{keywordflow}{if} (item == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}) \textcolor{keywordflow}{continue};
59         \textcolor{keywordflow}{if} (!strcmp(item->\hyperlink{structmenuItem_af83f532960744d4bad0e9ae62e03c896}{accelerator}, \textcolor{stringliteral}{""})) \textcolor{keywordflow}{continue};
60 
61         \textcolor{keywordflow}{if} ((!strcmp(item->\hyperlink{structmenuItem_af83f532960744d4bad0e9ae62e03c896}{accelerator}, event->string)) ||
62         ((selection\_mode == GTK\_SELECTION\_MULTIPLE) &&
63          (event->keyval == \textcolor{charliteral}{','}))) \{
64         \textcolor{keywordflow}{if} (item->\hyperlink{structmenuItem_a96b0d07f0e7ee05c3e1824c0a3665ddb}{selected}) \{
65             gtk\_clist\_unselect\_row( GTK\_CLIST (clist),
66                         item->\hyperlink{structmenuItem_a110b1866aeaf1a16e0cd29e1088333a8}{itemNumber}, 0);
67             item->\hyperlink{structmenuItem_a96b0d07f0e7ee05c3e1824c0a3665ddb}{selected} = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
68         \} \textcolor{keywordflow}{else} \{
69             gtk\_clist\_select\_row(GTK\_CLIST (clist),
70                      item->\hyperlink{structmenuItem_a110b1866aeaf1a16e0cd29e1088333a8}{itemNumber}, 0);
71             \textcolor{keywordflow}{if} (gtk\_clist\_row\_is\_visible(GTK\_CLIST(clist),
72                 item->\hyperlink{structmenuItem_a110b1866aeaf1a16e0cd29e1088333a8}{itemNumber}) != GTK\_VISIBILITY\_FULL)
73             gtk\_clist\_moveto(GTK\_CLIST(clist),
74                      item->\hyperlink{structmenuItem_a110b1866aeaf1a16e0cd29e1088333a8}{itemNumber}, 0, 0.5, 0);
75             item->\hyperlink{structmenuItem_a96b0d07f0e7ee05c3e1824c0a3665ddb}{selected} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
76         \}
77         \}
78     \}
79     \}
80 \}
\end{DoxyCode}
\hypertarget{gnmenu_8c_a7a38dcdd6e1dd1670d352e53536e05eb}{\index{gnmenu.\+c@{gnmenu.\+c}!ghack\+\_\+menu\+\_\+window\+\_\+put\+\_\+string@{ghack\+\_\+menu\+\_\+window\+\_\+put\+\_\+string}}
\index{ghack\+\_\+menu\+\_\+window\+\_\+put\+\_\+string@{ghack\+\_\+menu\+\_\+window\+\_\+put\+\_\+string}!gnmenu.\+c@{gnmenu.\+c}}
\subsubsection[{ghack\+\_\+menu\+\_\+window\+\_\+put\+\_\+string}]{\setlength{\rightskip}{0pt plus 5cm}void ghack\+\_\+menu\+\_\+window\+\_\+put\+\_\+string (
\begin{DoxyParamCaption}
\item[{Gtk\+Widget $\ast$}]{menu\+Win, }
\item[{int}]{attr, }
\item[{{\bf const} char $\ast$}]{text, }
\item[{gpointer}]{data}
\end{DoxyParamCaption}
)}}\label{gnmenu_8c_a7a38dcdd6e1dd1670d352e53536e05eb}


Definition at line 473 of file gnmenu.\+c.



References F\+A\+L\+S\+E, gless, Menu\+Text, Menu\+Unknown, N\+U\+L\+L, and T\+R\+U\+E.



Referenced by ghack\+\_\+init\+\_\+menu\+\_\+window().


\begin{DoxyCode}
475 \{
476     GnomeLess *\hyperlink{gntext_8c_a6fada5e9e468ba9d7d2d0b24c2a84ca5}{gless};
477     \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37}{MenuWinType} isMenu;
478 
479     \textcolor{keywordflow}{if} (text == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
480         \textcolor{keywordflow}{return};
481     
482     isMenu = (\hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37}{MenuWinType}) GPOINTER\_TO\_INT
483         (gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"isMenu"}));
484 
485     \textcolor{keywordflow}{if} (isMenu == \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a7f6a971ae217b86c9bc8d8e181d8d9ad}{MenuText}) \{
486       gless = GNOME\_LESS (gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"gless"}));
487       g\_assert (gless != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
488       g\_assert (gless->text != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
489       g\_assert (GTK\_IS\_TEXT (gless->text));
490 
491       \textcolor{comment}{/* Don't bother with attributes yet */}
492       gtk\_text\_insert (GTK\_TEXT (gless->text), \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, text, -1);
493       gtk\_text\_insert (GTK\_TEXT (gless->text), \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \textcolor{stringliteral}{"\(\backslash\)n"}, -1);
494 
495     \}
496 
497     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (isMenu == \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a6fdebbfd72352b7e497d50d4aa69d590}{MenuUnknown}) \{
498       isMenu = \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a7f6a971ae217b86c9bc8d8e181d8d9ad}{MenuText};
499       gtk\_object\_set\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"isMenu"},
500                    GINT\_TO\_POINTER (isMenu));
501 
502       gtk\_widget\_set\_usize (GTK\_WIDGET (menuWin), 500, 400);
503       gtk\_window\_set\_policy (GTK\_WINDOW (menuWin), \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
504     
505       gless = GNOME\_LESS (gnome\_less\_new ());
506       g\_assert (gless != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
507       gtk\_object\_set\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"gless"}, gless);
508       gtk\_widget\_show (GTK\_WIDGET (gless));
509 
510       gnome\_less\_show\_string (gless, text);
511       gtk\_text\_insert (GTK\_TEXT (gless->text), \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \textcolor{stringliteral}{"\(\backslash\)n"}, -1);
512 
513       gtk\_box\_pack\_start (GTK\_BOX (GNOME\_DIALOG (menuWin)->vbox),
514                   GTK\_WIDGET (gless), \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, 0);
515     \}
516 \}
\end{DoxyCode}
\hypertarget{gnmenu_8c_adae68cf5b7a99ed2a8da9823f741e84c}{\index{gnmenu.\+c@{gnmenu.\+c}!ghack\+\_\+menu\+\_\+window\+\_\+select\+\_\+menu@{ghack\+\_\+menu\+\_\+window\+\_\+select\+\_\+menu}}
\index{ghack\+\_\+menu\+\_\+window\+\_\+select\+\_\+menu@{ghack\+\_\+menu\+\_\+window\+\_\+select\+\_\+menu}!gnmenu.\+c@{gnmenu.\+c}}
\subsubsection[{ghack\+\_\+menu\+\_\+window\+\_\+select\+\_\+menu}]{\setlength{\rightskip}{0pt plus 5cm}int ghack\+\_\+menu\+\_\+window\+\_\+select\+\_\+menu (
\begin{DoxyParamCaption}
\item[{Gtk\+Widget $\ast$}]{menu\+Win, }
\item[{{\bf M\+E\+N\+U\+\_\+\+I\+T\+E\+M\+\_\+\+P} $\ast$$\ast$}]{\+\_\+selected, }
\item[{gint}]{how}
\end{DoxyParamCaption}
)}}\label{gnmenu_8c_adae68cf5b7a99ed2a8da9823f741e84c}


Definition at line 211 of file gnmenu.\+c.



References clist, menu\+Item\+::identifier, M\+E\+N\+U\+\_\+\+I\+T\+E\+M\+\_\+\+P, N\+U\+L\+L, P\+I\+C\+K\+\_\+\+A\+N\+Y, P\+I\+C\+K\+\_\+\+N\+O\+N\+E, and T\+R\+U\+E.



Referenced by ghack\+\_\+init\+\_\+menu\+\_\+window(), and gnome\+\_\+select\+\_\+menu().


\begin{DoxyCode}
213 \{
214    gint rc;
215    guint num\_sel, i, idx;
216    GtkWidget *\hyperlink{gnopts_8c_aaacfa1e004c6c39fcee7664eb1b0ae9d}{clist};
217    GList *cur;
218    \hyperlink{wintype_8h_a56b56557611b7f64f4e6585a1b78c8f9}{MENU\_ITEM\_P} *selected = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
219    \hyperlink{structmenuItem}{menuItem}*    item;
220 
221    g\_assert (\_selected != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
222    *\_selected = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
223 
224 
225    \textcolor{keywordflow}{if} (how == \hyperlink{wintype_8h_a9e3d317126c3eacb6311e15fedaf717c}{PICK\_NONE}) \{
226      gnome\_dialog\_close\_hides (GNOME\_DIALOG (menuWin), \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
227      rc = gnome\_dialog\_run\_and\_close (GNOME\_DIALOG (menuWin));
228      \textcolor{keywordflow}{return}( rc == 1 ? -1 : 0);
229    \}
230 
231    clist = GTK\_WIDGET (gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"clist"}));
232    g\_assert (clist != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
233 
234    gtk\_object\_set\_data (GTK\_OBJECT (clist), \textcolor{stringliteral}{"selection\_mode"},
235                    GINT\_TO\_POINTER ((how == \hyperlink{wintype_8h_a2bd6d317ee7338c416301da3d054dd9f}{PICK\_ANY})? 
236                GTK\_SELECTION\_MULTIPLE : GTK\_SELECTION\_SINGLE));
237    gtk\_clist\_set\_selection\_mode (GTK\_CLIST (clist), 
238        (how == \hyperlink{wintype_8h_a2bd6d317ee7338c416301da3d054dd9f}{PICK\_ANY})? GTK\_SELECTION\_MULTIPLE : GTK\_SELECTION\_SINGLE);
239    gnome\_dialog\_close\_hides (GNOME\_DIALOG (menuWin), \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
240    rc = gnome\_dialog\_run\_and\_close (GNOME\_DIALOG (menuWin));
241    \textcolor{keywordflow}{if} ((rc == 1) || (GTK\_CLIST (clist)->selection == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})) \{
242      \textcolor{keywordflow}{return}(-1);
243    \}
244 
245    num\_sel = g\_list\_length (GTK\_CLIST (clist)->selection);
246    \textcolor{keywordflow}{if} (num\_sel < 1) \{
247      \textcolor{keywordflow}{return}(-1);
248    \}
249 
250    \textcolor{comment}{/* fill in array with selections from clist */}
251    selected =  g\_new0( \hyperlink{wintype_8h_a56b56557611b7f64f4e6585a1b78c8f9}{MENU\_ITEM\_P}, num\_sel);
252    g\_assert (selected != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
253    cur = GTK\_CLIST (clist)->selection;
254    i = 0;
255    \textcolor{keywordflow}{while} (cur) \{
256      g\_assert (i < num\_sel);
257 
258      \textcolor{comment}{/* grab row number from clist selection list */}
259      idx = GPOINTER\_TO\_INT (cur->data);
260 
261      item = (\hyperlink{structmenuItem}{menuItem}*) gtk\_clist\_get\_row\_data( GTK\_CLIST (clist), idx);
262      selected[i].item = item->\hyperlink{structmenuItem_a51df9eca851d9d5801f6e7a8088016d6}{identifier};
263      selected[i].count = -1;
264      cur = g\_list\_next(cur);
265      i++;
266    \}
267 
268    *\_selected = selected;
269 
270    \textcolor{keywordflow}{return}( (\textcolor{keywordtype}{int}) num\_sel);
271 \}    
\end{DoxyCode}
\hypertarget{gnmenu_8c_acd7828ea775c2382417cd6973d4acbdd}{\index{gnmenu.\+c@{gnmenu.\+c}!ghack\+\_\+menu\+\_\+window\+\_\+start\+\_\+menu@{ghack\+\_\+menu\+\_\+window\+\_\+start\+\_\+menu}}
\index{ghack\+\_\+menu\+\_\+window\+\_\+start\+\_\+menu@{ghack\+\_\+menu\+\_\+window\+\_\+start\+\_\+menu}!gnmenu.\+c@{gnmenu.\+c}}
\subsubsection[{ghack\+\_\+menu\+\_\+window\+\_\+start\+\_\+menu}]{\setlength{\rightskip}{0pt plus 5cm}void ghack\+\_\+menu\+\_\+window\+\_\+start\+\_\+menu (
\begin{DoxyParamCaption}
\item[{Gtk\+Widget $\ast$}]{menu\+Win, }
\item[{gpointer}]{data}
\end{DoxyParamCaption}
)}}\label{gnmenu_8c_acd7828ea775c2382417cd6973d4acbdd}


Definition at line 160 of file gnmenu.\+c.



References clist, F\+A\+L\+S\+E, ghack\+\_\+menu\+\_\+row\+\_\+selected(), Menu\+Menu, N\+U\+L\+L, and T\+R\+U\+E.



Referenced by ghack\+\_\+init\+\_\+menu\+\_\+window().


\begin{DoxyCode}
161 \{
162     GtkWidget *frame1, *swin, *\hyperlink{gnopts_8c_aaacfa1e004c6c39fcee7664eb1b0ae9d}{clist};
163     \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37}{MenuWinType} isMenu;
164     
165     g\_assert (menuWin != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
166     g\_assert (data == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
167 
168     \textcolor{comment}{/* destroy existing menu data, if any */}
169     frame1 = gtk\_object\_get\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"frame1"});
170     \textcolor{keywordflow}{if} (frame1)
171       gtk\_widget\_destroy (frame1);
172  
173     isMenu = \hyperlink{gnmenu_8c_aea18c0b07b32481dc35a56685cb9ea37a1706f25014518b450a907744ad45664c}{MenuMenu};
174     gtk\_object\_set\_data (GTK\_OBJECT (menuWin), \textcolor{stringliteral}{"isMenu"},
175                  GINT\_TO\_POINTER (isMenu));
176 
177     gtk\_widget\_set\_usize (GTK\_WIDGET (menuWin), 500, 400);
178     gtk\_window\_set\_policy (GTK\_WINDOW (menuWin), \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
179 
180     frame1 = gtk\_frame\_new (\textcolor{stringliteral}{"Make your selection"});
181     g\_assert (frame1 != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
182     gtk\_object\_set\_data (GTK\_OBJECT(menuWin), \textcolor{stringliteral}{"frame1"}, frame1);
183     gtk\_widget\_show (GTK\_WIDGET (frame1));
184     gtk\_container\_set\_border\_width (GTK\_CONTAINER (frame1), 5);
185     gtk\_box\_pack\_start (GTK\_BOX (GNOME\_DIALOG(menuWin)->vbox), frame1,
186                         \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, 0);
187     
188     swin = gtk\_scrolled\_window\_new (\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
189     g\_assert (swin != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
190     gtk\_object\_set\_data (GTK\_OBJECT(menuWin), \textcolor{stringliteral}{"swin"}, swin);
191     gtk\_widget\_show (GTK\_WIDGET (swin));
192     gtk\_container\_add (GTK\_CONTAINER (frame1), swin);
193 
194     clist = gtk\_clist\_new (4);
195     g\_assert (clist != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
196     gtk\_object\_set\_data (GTK\_OBJECT(menuWin), \textcolor{stringliteral}{"clist"}, clist);
197     gtk\_widget\_show (GTK\_WIDGET (clist));
198     gtk\_container\_add (GTK\_CONTAINER (swin), clist);
199 
200     gtk\_scrolled\_window\_set\_policy (GTK\_SCROLLED\_WINDOW (swin),
201         GTK\_POLICY\_AUTOMATIC, GTK\_POLICY\_AUTOMATIC);
202 
203     gtk\_signal\_connect (GTK\_OBJECT (clist), \textcolor{stringliteral}{"select\_row"},
204         GTK\_SIGNAL\_FUNC (\hyperlink{gnmenu_8c_a26babfcc4b66e690814fcbdeab70d41c}{ghack\_menu\_row\_selected}), \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
205     gtk\_object\_set\_data (GTK\_OBJECT (clist), \textcolor{stringliteral}{"numItems"},
206                 GINT\_TO\_POINTER (-1));
207 \}    
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{gnmenu_8c_aefd4a6b43d479ce169e4657927505d7f}{\index{gnmenu.\+c@{gnmenu.\+c}!color\+\_\+blue@{color\+\_\+blue}}
\index{color\+\_\+blue@{color\+\_\+blue}!gnmenu.\+c@{gnmenu.\+c}}
\subsubsection[{color\+\_\+blue}]{\setlength{\rightskip}{0pt plus 5cm}Gdk\+Color color\+\_\+blue = \{ 0, 0, 0, 0xffff \}\hspace{0.3cm}{\ttfamily [static]}}}\label{gnmenu_8c_aefd4a6b43d479ce169e4657927505d7f}


Definition at line 33 of file gnmenu.\+c.



Referenced by ghack\+\_\+menu\+\_\+window\+\_\+add\+\_\+menu().

