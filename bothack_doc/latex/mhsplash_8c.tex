\hypertarget{mhsplash_8c}{\section{nethack/win/win32/mhsplash.c File Reference}
\label{mhsplash_8c}\index{nethack/win/win32/mhsplash.\+c@{nethack/win/win32/mhsplash.\+c}}
}
{\ttfamily \#include \char`\"{}win\+M\+S.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}resource.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhsplash.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhmsg.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}mhfont.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}patchlevel.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}dlb.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{mhsplash_8c_a4dbdeec6f3fa43f11b22a95cd6fe2172}{L\+L\+E\+N}~128
\item 
\#define \hyperlink{mhsplash_8c_a300803638e66cb9428c1ab04712c70a6}{S\+P\+L\+A\+S\+H\+\_\+\+W\+I\+D\+T\+H}~440
\item 
\#define \hyperlink{mhsplash_8c_a0751a8420b717eb073eab7b05a9954dd}{S\+P\+L\+A\+S\+H\+\_\+\+H\+E\+I\+G\+H\+T}~322
\item 
\#define \hyperlink{mhsplash_8c_a5983b488db6db2e49f9f269447ecd37c}{S\+P\+L\+A\+S\+H\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+X}~290
\item 
\#define \hyperlink{mhsplash_8c_a39af57681e914b71a83b892d305fe811}{S\+P\+L\+A\+S\+H\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+Y}~10
\item 
\#define \hyperlink{mhsplash_8c_a624203c05ab9c5f804b76ce242e263f6}{S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X}~10
\item 
\#define \hyperlink{mhsplash_8c_a1355d767efd48c02587f8da09eaac59b}{S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y}~10
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{sys_2wince_2winMS_8h_a78ff8ed1e05072662719865d12608e75}{P\+N\+H\+Win\+App} \hyperlink{mhsplash_8c_afa11eb8c832e838349416cf3bbdd29fe}{Get\+N\+H\+App} (void)
\item 
B\+O\+O\+L C\+A\+L\+L\+B\+A\+C\+K \hyperlink{mhsplash_8c_a0372fe93797522215d9094c2b5bef07a}{N\+H\+Splash\+Wnd\+Proc} (H\+W\+N\+D, \hyperlink{def__os2_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{U\+I\+N\+T}, W\+P\+A\+R\+A\+M, L\+P\+A\+R\+A\+M)
\item 
void \hyperlink{mhsplash_8c_a7d8bea41be39bac45e43d5289c52626d}{mswin\+\_\+display\+\_\+splash\+\_\+window} (B\+O\+O\+L show\+\_\+ver)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
H\+F\+O\+N\+T \hyperlink{mhsplash_8c_a0d004a3aaea8816abf5163eb27c1c246}{version\+\_\+splash\+\_\+font}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{mhsplash_8c_a4dbdeec6f3fa43f11b22a95cd6fe2172}{\index{mhsplash.\+c@{mhsplash.\+c}!L\+L\+E\+N@{L\+L\+E\+N}}
\index{L\+L\+E\+N@{L\+L\+E\+N}!mhsplash.\+c@{mhsplash.\+c}}
\subsubsection[{L\+L\+E\+N}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\+L\+E\+N~128}}\label{mhsplash_8c_a4dbdeec6f3fa43f11b22a95cd6fe2172}


Definition at line 12 of file mhsplash.\+c.



Referenced by mswin\+\_\+display\+\_\+splash\+\_\+window().

\hypertarget{mhsplash_8c_a0751a8420b717eb073eab7b05a9954dd}{\index{mhsplash.\+c@{mhsplash.\+c}!S\+P\+L\+A\+S\+H\+\_\+\+H\+E\+I\+G\+H\+T@{S\+P\+L\+A\+S\+H\+\_\+\+H\+E\+I\+G\+H\+T}}
\index{S\+P\+L\+A\+S\+H\+\_\+\+H\+E\+I\+G\+H\+T@{S\+P\+L\+A\+S\+H\+\_\+\+H\+E\+I\+G\+H\+T}!mhsplash.\+c@{mhsplash.\+c}}
\subsubsection[{S\+P\+L\+A\+S\+H\+\_\+\+H\+E\+I\+G\+H\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+P\+L\+A\+S\+H\+\_\+\+H\+E\+I\+G\+H\+T~322}}\label{mhsplash_8c_a0751a8420b717eb073eab7b05a9954dd}


Definition at line 19 of file mhsplash.\+c.



Referenced by mswin\+\_\+display\+\_\+splash\+\_\+window(), and N\+H\+Splash\+Wnd\+Proc().

\hypertarget{mhsplash_8c_a624203c05ab9c5f804b76ce242e263f6}{\index{mhsplash.\+c@{mhsplash.\+c}!S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X@{S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X}}
\index{S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X@{S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X}!mhsplash.\+c@{mhsplash.\+c}}
\subsubsection[{S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X~10}}\label{mhsplash_8c_a624203c05ab9c5f804b76ce242e263f6}


Definition at line 22 of file mhsplash.\+c.



Referenced by mswin\+\_\+display\+\_\+splash\+\_\+window(), and N\+H\+Splash\+Wnd\+Proc().

\hypertarget{mhsplash_8c_a1355d767efd48c02587f8da09eaac59b}{\index{mhsplash.\+c@{mhsplash.\+c}!S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y@{S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y}}
\index{S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y@{S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y}!mhsplash.\+c@{mhsplash.\+c}}
\subsubsection[{S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y~10}}\label{mhsplash_8c_a1355d767efd48c02587f8da09eaac59b}


Definition at line 23 of file mhsplash.\+c.



Referenced by mswin\+\_\+display\+\_\+splash\+\_\+window(), and N\+H\+Splash\+Wnd\+Proc().

\hypertarget{mhsplash_8c_a5983b488db6db2e49f9f269447ecd37c}{\index{mhsplash.\+c@{mhsplash.\+c}!S\+P\+L\+A\+S\+H\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+X@{S\+P\+L\+A\+S\+H\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+X}}
\index{S\+P\+L\+A\+S\+H\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+X@{S\+P\+L\+A\+S\+H\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+X}!mhsplash.\+c@{mhsplash.\+c}}
\subsubsection[{S\+P\+L\+A\+S\+H\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+X}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+P\+L\+A\+S\+H\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+X~290}}\label{mhsplash_8c_a5983b488db6db2e49f9f269447ecd37c}


Definition at line 20 of file mhsplash.\+c.



Referenced by N\+H\+Splash\+Wnd\+Proc().

\hypertarget{mhsplash_8c_a39af57681e914b71a83b892d305fe811}{\index{mhsplash.\+c@{mhsplash.\+c}!S\+P\+L\+A\+S\+H\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+Y@{S\+P\+L\+A\+S\+H\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+Y}}
\index{S\+P\+L\+A\+S\+H\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+Y@{S\+P\+L\+A\+S\+H\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+Y}!mhsplash.\+c@{mhsplash.\+c}}
\subsubsection[{S\+P\+L\+A\+S\+H\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+P\+L\+A\+S\+H\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+Y~10}}\label{mhsplash_8c_a39af57681e914b71a83b892d305fe811}


Definition at line 21 of file mhsplash.\+c.



Referenced by N\+H\+Splash\+Wnd\+Proc().

\hypertarget{mhsplash_8c_a300803638e66cb9428c1ab04712c70a6}{\index{mhsplash.\+c@{mhsplash.\+c}!S\+P\+L\+A\+S\+H\+\_\+\+W\+I\+D\+T\+H@{S\+P\+L\+A\+S\+H\+\_\+\+W\+I\+D\+T\+H}}
\index{S\+P\+L\+A\+S\+H\+\_\+\+W\+I\+D\+T\+H@{S\+P\+L\+A\+S\+H\+\_\+\+W\+I\+D\+T\+H}!mhsplash.\+c@{mhsplash.\+c}}
\subsubsection[{S\+P\+L\+A\+S\+H\+\_\+\+W\+I\+D\+T\+H}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+P\+L\+A\+S\+H\+\_\+\+W\+I\+D\+T\+H~440}}\label{mhsplash_8c_a300803638e66cb9428c1ab04712c70a6}


Definition at line 18 of file mhsplash.\+c.



Referenced by mswin\+\_\+display\+\_\+splash\+\_\+window(), and N\+H\+Splash\+Wnd\+Proc().



\subsection{Function Documentation}
\hypertarget{mhsplash_8c_afa11eb8c832e838349416cf3bbdd29fe}{\index{mhsplash.\+c@{mhsplash.\+c}!Get\+N\+H\+App@{Get\+N\+H\+App}}
\index{Get\+N\+H\+App@{Get\+N\+H\+App}!mhsplash.\+c@{mhsplash.\+c}}
\subsubsection[{Get\+N\+H\+App}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\+N\+H\+Win\+App} Get\+N\+H\+App (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{mhsplash_8c_afa11eb8c832e838349416cf3bbdd29fe}


Definition at line 154 of file winhack.\+c.



Referenced by mswin\+\_\+display\+\_\+splash\+\_\+window(), and N\+H\+Splash\+Wnd\+Proc().


\begin{DoxyCode}
155 \{
156     \textcolor{keywordflow}{return} &\hyperlink{sys_2wince_2winhack_8c_a5014ab92020eefd70dfd7b93937850f3}{\_nethack\_app};
157 \}
\end{DoxyCode}
\hypertarget{mhsplash_8c_a7d8bea41be39bac45e43d5289c52626d}{\index{mhsplash.\+c@{mhsplash.\+c}!mswin\+\_\+display\+\_\+splash\+\_\+window@{mswin\+\_\+display\+\_\+splash\+\_\+window}}
\index{mswin\+\_\+display\+\_\+splash\+\_\+window@{mswin\+\_\+display\+\_\+splash\+\_\+window}!mhsplash.\+c@{mhsplash.\+c}}
\subsubsection[{mswin\+\_\+display\+\_\+splash\+\_\+window}]{\setlength{\rightskip}{0pt plus 5cm}void mswin\+\_\+display\+\_\+splash\+\_\+window (
\begin{DoxyParamCaption}
\item[{B\+O\+O\+L}]{show\+\_\+ver}
\end{DoxyParamCaption}
)}}\label{mhsplash_8c_a7d8bea41be39bac45e43d5289c52626d}


Definition at line 27 of file mhsplash.\+c.



References buf, B\+U\+F\+S\+Z, C\+O\+P\+Y\+R\+I\+G\+H\+T\+\_\+\+B\+A\+N\+N\+E\+R\+\_\+\+A, C\+O\+P\+Y\+R\+I\+G\+H\+T\+\_\+\+B\+A\+N\+N\+E\+R\+\_\+\+B, C\+O\+P\+Y\+R\+I\+G\+H\+T\+\_\+\+B\+A\+N\+N\+E\+R\+\_\+\+C, Create\+Dialog(), dlb, dlb\+\_\+fclose, dlb\+\_\+fgets, dlb\+\_\+fopen, free(), Get\+N\+H\+App(), getversionstring(), mswin\+\_\+nhwindow\+\_\+app\+::h\+Main\+Wnd, mswin\+\_\+nhwindow\+\_\+app\+::h\+Popup\+Wnd, I\+D\+C\+\_\+\+E\+X\+T\+R\+A\+I\+N\+F\+O, I\+D\+D\+\_\+\+S\+P\+L\+A\+S\+H, iflags, L\+L\+E\+N, malloc(), mswin\+\_\+destroy\+\_\+splashfonts(), mswin\+\_\+hwnd\+\_\+from\+\_\+winid(), mswin\+\_\+init\+\_\+splashfonts(), N\+E\+W\+S, instance\+\_\+flags\+::news, N\+H\+Splash\+Wnd\+Proc(), N\+U\+L\+L, O\+P\+T\+I\+O\+N\+S\+\_\+\+U\+S\+E\+D, panic(), R\+D\+T\+M\+O\+D\+E, S\+P\+L\+A\+S\+H\+\_\+\+H\+E\+I\+G\+H\+T, S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X, S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y, S\+P\+L\+A\+S\+H\+\_\+\+W\+I\+D\+T\+H, Sprintf, T\+R\+U\+E, and W\+I\+N\+\_\+\+M\+A\+P.



Referenced by mswin\+\_\+init\+\_\+nhwindows(), and on\+W\+M\+Command().


\begin{DoxyCode}
28 \{
29     MSG msg;
30     HWND mapWnd;
31     \textcolor{keywordtype}{int} left, top;
32     RECT splashrt;
33     RECT clientrt;
34     RECT controlrt;
35     HWND hWnd;
36     \textcolor{keywordtype}{int} buttop;
37     \textcolor{keywordtype}{int} strsize = 0;
38     \textcolor{keywordtype}{int} bufsize = \hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ};
39 
40     \textcolor{keywordtype}{char} *\hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf} = \hyperlink{winproto_8h_ab028c02ac00afc0c1d3c568ccad68869}{malloc}(bufsize);
41     \textcolor{keywordflow}{if} (buf == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
42         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"out of memory"});
43     buf[0] = \textcolor{charliteral}{'\(\backslash\)0'};
44 
45     hWnd = \hyperlink{dialogs_8c_aaf356545a4c5797e317091864c988de0}{CreateDialog}(\hyperlink{mhsplash_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->hApp, MAKEINTRESOURCE(
      \hyperlink{win_2win32_2resource_8h_ab710128630d3f574b291ea98049e5d64}{IDD\_SPLASH}),
46         \hyperlink{mhsplash_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->hMainWnd, \hyperlink{mhsplash_8c_a0372fe93797522215d9094c2b5bef07a}{NHSplashWndProc});
47     \textcolor{keywordflow}{if}( !hWnd ) \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"Cannot create Splash window"});
48     \hyperlink{win_2win32_2mhfont_8c_af183ec81747c907c779d089ba1556ad2}{mswin\_init\_splashfonts}(hWnd);
49     \hyperlink{mhsplash_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_a92e7b581dd0fad9d1af8364e5bcfe395}{hPopupWnd} = hWnd;
50     mapWnd = \hyperlink{sys_2wince_2mswproc_8c_a0890d6b16657f7ad53aebadc8818f147}{mswin\_hwnd\_from\_winid}(\hyperlink{decl_8h_afa1f7dd312c4c1b72afe3d2c8c2af691}{WIN\_MAP});
51     \textcolor{keywordflow}{if}( !IsWindow(mapWnd) ) mapWnd = \hyperlink{mhsplash_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_ada318d77e9dd51678af5d9a3ce6ef03a}{hMainWnd};
52     \textcolor{comment}{/* Get control size */}
53     GetWindowRect (GetDlgItem(hWnd, IDOK), &controlrt);
54     controlrt.right -= controlrt.left;
55     controlrt.bottom -= controlrt.top;
56     \textcolor{comment}{/* Get current client area */}
57     GetClientRect (hWnd, &clientrt);
58     \textcolor{comment}{/* Get window size */}
59     GetWindowRect(hWnd, &splashrt);
60     splashrt.right -= splashrt.left;
61     splashrt.bottom -= splashrt.top;
62     \textcolor{comment}{/* Get difference between requested client area and current value */}
63     splashrt.right += \hyperlink{mhsplash_8c_a300803638e66cb9428c1ab04712c70a6}{SPLASH\_WIDTH} + \hyperlink{mhsplash_8c_a624203c05ab9c5f804b76ce242e263f6}{SPLASH\_OFFSET\_X} * 2 - clientrt.right;
64     splashrt.bottom += \hyperlink{mhsplash_8c_a0751a8420b717eb073eab7b05a9954dd}{SPLASH\_HEIGHT} + controlrt.bottom + 
      \hyperlink{mhsplash_8c_a1355d767efd48c02587f8da09eaac59b}{SPLASH\_OFFSET\_Y} * 3 - clientrt.bottom;
65     \textcolor{comment}{/* Place the window centered */}
66     \textcolor{comment}{/* On the screen, not on the parent window */}
67     left = (GetSystemMetrics(SM\_CXSCREEN) - splashrt.right) / 2;
68     top = (GetSystemMetrics(SM\_CYSCREEN) - splashrt.bottom) / 2;
69     MoveWindow(hWnd, left, top, splashrt.right, splashrt.bottom, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
70     \textcolor{comment}{/* Place the OK control */}
71     GetClientRect (hWnd, &clientrt);
72     MoveWindow (GetDlgItem(hWnd, IDOK),
73         (clientrt.right - clientrt.left - controlrt.right) / 2,
74         clientrt.bottom - controlrt.bottom - \hyperlink{mhsplash_8c_a1355d767efd48c02587f8da09eaac59b}{SPLASH\_OFFSET\_Y},
75         controlrt.right, controlrt.bottom, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
76     buttop = clientrt.bottom - controlrt.bottom - \hyperlink{mhsplash_8c_a1355d767efd48c02587f8da09eaac59b}{SPLASH\_OFFSET\_Y};
77     \textcolor{comment}{/* Place the text control */}
78     GetWindowRect (GetDlgItem(hWnd, \hyperlink{win_2win32_2resource_8h_a98b8cea2ce7bcdbe2f2bcd52288843a3}{IDC\_EXTRAINFO}), &controlrt);
79     controlrt.right -= controlrt.left;
80     controlrt.bottom -= controlrt.top;
81     GetClientRect (hWnd, &clientrt);
82     MoveWindow (GetDlgItem(hWnd, \hyperlink{win_2win32_2resource_8h_a98b8cea2ce7bcdbe2f2bcd52288843a3}{IDC\_EXTRAINFO}),
83         clientrt.left + \hyperlink{mhsplash_8c_a624203c05ab9c5f804b76ce242e263f6}{SPLASH\_OFFSET\_X},
84         buttop - controlrt.bottom - \hyperlink{mhsplash_8c_a1355d767efd48c02587f8da09eaac59b}{SPLASH\_OFFSET\_Y},
85         clientrt.right - 2 * \hyperlink{mhsplash_8c_a624203c05ab9c5f804b76ce242e263f6}{SPLASH\_OFFSET\_X}, controlrt.bottom, 
      \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
86     \textcolor{comment}{/* Fill the text control */}
87     \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf}(buf, \textcolor{stringliteral}{"%s\(\backslash\)r\(\backslash\)n%s\(\backslash\)r\(\backslash\)n%s\(\backslash\)r\(\backslash\)n\(\backslash\)r\(\backslash\)n"}, \hyperlink{patchlevel_8h_a31bf6260dfee590f28735d5a27134912}{COPYRIGHT\_BANNER\_A}, 
      \hyperlink{patchlevel_8h_a991809ab96e6f409bbf21d0d6e81d633}{COPYRIGHT\_BANNER\_B},
88         \hyperlink{patchlevel_8h_a4eb1b20c11643715355dbf210025037f}{COPYRIGHT\_BANNER\_C});
89     strsize = strlen(buf);
90     
91     \textcolor{keywordflow}{if} (show\_ver) \{
92         \textcolor{comment}{/* Show complete version information */}
93         \hyperlink{dlb_8h_a2c91af84569791b69abdf2b4644b0ddd}{dlb} *f;
94 
95         \hyperlink{version_8c_a431d9e78249b81eccfcaf792ebe5ff9b}{getversionstring}(buf + strsize);
96         strcat(buf, \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n\(\backslash\)r\(\backslash\)n"});
97         strsize = strlen(buf);
98 
99         \textcolor{comment}{/* Add compile options */}
100         f = \hyperlink{dlb_8h_a46a9ab27d1ae601750baeacc2c0a8d44}{dlb\_fopen}(\hyperlink{global_8h_a5c59035788bda63bfeb375f55b31b733}{OPTIONS\_USED}, \hyperlink{dlb_8h_a52b55e796a44079bc56afab59e8c0c89}{RDTMODE});
101         \textcolor{keywordflow}{if} (f) \{
102         \textcolor{keywordtype}{char} line[\hyperlink{mhsplash_8c_a4dbdeec6f3fa43f11b22a95cd6fe2172}{LLEN} + 1];
103         
104         \textcolor{keywordflow}{while} (\hyperlink{dlb_8h_a0c5a17bfc873332e8ef26262d8527e91}{dlb\_fgets}(line, \hyperlink{mhsplash_8c_a4dbdeec6f3fa43f11b22a95cd6fe2172}{LLEN}, f)) \{
105             \textcolor{keywordtype}{size\_t} len;
106             len = strlen(line);
107             \textcolor{keywordflow}{if} (len > 0 && line[len - 1] == \textcolor{charliteral}{'\(\backslash\)n'}) \{
108             line[len - 1] = \textcolor{charliteral}{'\(\backslash\)r'};
109             line[len] = \textcolor{charliteral}{'\(\backslash\)n'};
110             line[len + 1] = \textcolor{charliteral}{'\(\backslash\)0'};
111             len++;
112             \}
113             \textcolor{keywordflow}{if} (strsize + (\textcolor{keywordtype}{int})len + 1 > bufsize)
114             \{
115             bufsize += \hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ};
116             buf = realloc(buf, bufsize);
117             \textcolor{keywordflow}{if} (buf == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
118                 \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"out of memory"});
119             \}
120             strcat(buf, line);
121             strsize += len;
122         \}
123         (void) \hyperlink{dlb_8h_a882e4d8dcdf2cd3d9eee2b94debe38e1}{dlb\_fclose}(f);
124         \}
125     \} \textcolor{keywordflow}{else} \{
126         \textcolor{comment}{/* Show news, if any */}
127         \textcolor{keywordflow}{if} (\hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_a65a361ffd2534ddff433ba62f3dfb579}{news}) \{        
128         FILE *nf;
129         
130         \hyperlink{flag_8h_ae9cd54937dcb00432131e49e5e324075}{iflags}.\hyperlink{structinstance__flags_a65a361ffd2534ddff433ba62f3dfb579}{news} = 0; \textcolor{comment}{/* prevent newgame() from re-displaying news */}
131         nf = fopen(\hyperlink{config_8h_adfcdf96482b20ff90defa8fd75b84a7c}{NEWS}, \textcolor{stringliteral}{"r"});
132         \textcolor{keywordflow}{if} (nf != \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}) \{
133             \textcolor{keywordtype}{char} line[\hyperlink{mhsplash_8c_a4dbdeec6f3fa43f11b22a95cd6fe2172}{LLEN} + 1];
134             
135             \textcolor{keywordflow}{while} (fgets(line, \hyperlink{mhsplash_8c_a4dbdeec6f3fa43f11b22a95cd6fe2172}{LLEN}, nf)) \{
136             \textcolor{keywordtype}{size\_t} len;
137             len = strlen(line);
138             \textcolor{keywordflow}{if} (len > 0 && line[len - 1] == \textcolor{charliteral}{'\(\backslash\)n'}) \{
139                 line[len - 1] = \textcolor{charliteral}{'\(\backslash\)r'};
140                 line[len] = \textcolor{charliteral}{'\(\backslash\)n'};
141                 line[len + 1] = \textcolor{charliteral}{'\(\backslash\)0'};
142                 len++;
143             \}
144             \textcolor{keywordflow}{if} (strsize + (\textcolor{keywordtype}{int})len + 1 > bufsize)
145             \{
146                 bufsize += \hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ};
147                 buf = realloc(buf, bufsize);
148                 \textcolor{keywordflow}{if} (buf == \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
149                 \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"out of memory"});
150             \}
151             strcat(buf, line);
152             strsize += len;
153             \}
154             (void) fclose(nf);
155         \} 
156         \textcolor{keywordflow}{else}
157         \{
158             strcat(buf, \textcolor{stringliteral}{"No news."});
159         \}
160         \}
161     \}
162     SetWindowText(GetDlgItem(hWnd, \hyperlink{win_2win32_2resource_8h_a98b8cea2ce7bcdbe2f2bcd52288843a3}{IDC\_EXTRAINFO}), buf);
163     \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}(buf);
164     ShowWindow(hWnd, SW\_SHOW);
165     
166     \textcolor{keywordflow}{while}( IsWindow(hWnd) &&
167         GetMessage(&msg, \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 0, 0)!=0 ) \{
168         \textcolor{keywordflow}{if}( !IsDialogMessage(hWnd, &msg) ) \{
169         TranslateMessage(&msg);
170         DispatchMessage(&msg);
171         \}
172     \}
173     
174     \hyperlink{mhsplash_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_a92e7b581dd0fad9d1af8364e5bcfe395}{hPopupWnd} = \hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
175     \hyperlink{win_2win32_2mhfont_8c_aedda99a174cadffcb558af5d5c29c0cd}{mswin\_destroy\_splashfonts}();
176 \}
\end{DoxyCode}
\hypertarget{mhsplash_8c_a0372fe93797522215d9094c2b5bef07a}{\index{mhsplash.\+c@{mhsplash.\+c}!N\+H\+Splash\+Wnd\+Proc@{N\+H\+Splash\+Wnd\+Proc}}
\index{N\+H\+Splash\+Wnd\+Proc@{N\+H\+Splash\+Wnd\+Proc}!mhsplash.\+c@{mhsplash.\+c}}
\subsubsection[{N\+H\+Splash\+Wnd\+Proc}]{\setlength{\rightskip}{0pt plus 5cm}B\+O\+O\+L C\+A\+L\+L\+B\+A\+C\+K N\+H\+Splash\+Wnd\+Proc (
\begin{DoxyParamCaption}
\item[{H\+W\+N\+D}]{h\+Wnd, }
\item[{{\bf U\+I\+N\+T}}]{message, }
\item[{W\+P\+A\+R\+A\+M}]{w\+Param, }
\item[{L\+P\+A\+R\+A\+M}]{l\+Param}
\end{DoxyParamCaption}
)}}\label{mhsplash_8c_a0372fe93797522215d9094c2b5bef07a}


Definition at line 178 of file mhsplash.\+c.



References A\+T\+R\+\_\+\+N\+O\+N\+E, B\+U\+F\+S\+Z, F\+A\+L\+S\+E, Get\+N\+H\+App(), mswin\+\_\+nhwindow\+\_\+app\+::h\+Main\+Wnd, mswin\+\_\+get\+\_\+font(), mswin\+\_\+window\+\_\+mark\+\_\+dead(), mswin\+\_\+winid\+\_\+from\+\_\+handle(), nhapply\+\_\+image\+\_\+transparent(), N\+H\+W\+\_\+\+T\+E\+X\+T, N\+U\+L\+L, P\+A\+T\+C\+H\+L\+E\+V\+E\+L, R\+G\+B, S\+P\+L\+A\+S\+H\+\_\+\+H\+E\+I\+G\+H\+T, S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+X, S\+P\+L\+A\+S\+H\+\_\+\+O\+F\+F\+S\+E\+T\+\_\+\+Y, S\+P\+L\+A\+S\+H\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+X, S\+P\+L\+A\+S\+H\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+Y, S\+P\+L\+A\+S\+H\+\_\+\+W\+I\+D\+T\+H, Sprintf, T\+I\+L\+E\+\_\+\+B\+K\+\_\+\+C\+O\+L\+O\+R, T\+R\+U\+E, V\+E\+R\+S\+I\+O\+N\+\_\+\+M\+A\+J\+O\+R, V\+E\+R\+S\+I\+O\+N\+\_\+\+M\+I\+N\+O\+R, and version\+\_\+splash\+\_\+font.



Referenced by mswin\+\_\+display\+\_\+splash\+\_\+window().


\begin{DoxyCode}
179 \{
180     HDC hdc;
181     \textcolor{keywordflow}{switch} (message)
182     \{
183     \textcolor{keywordflow}{case} WM\_INITDIALOG:
184         \textcolor{comment}{/* set text control font */}
185         hdc = GetDC(hWnd);
186         SendMessage(hWnd, WM\_SETFONT,
187             (WPARAM)\hyperlink{sys_2wince_2mhfont_8c_a480013e685b85460be07910c65a1ef51}{mswin\_get\_font}(\hyperlink{wintype_8h_a7e2bcc8531c4c62e8d8f1c5279c5789b}{NHW\_TEXT}, \hyperlink{wintype_8h_a20a20b74e8cf84ecfbf3c8665c059636}{ATR\_NONE}, hdc, 
      \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}), 0);
188         ReleaseDC(hWnd, hdc);
189 
190         SetFocus(GetDlgItem(hWnd, IDOK));
191     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
192 
193     \textcolor{keywordflow}{case} WM\_PAINT:
194     \{
195         \textcolor{keywordtype}{char} VersionString[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
196         RECT rt;
197         HDC hdcBitmap;
198         HANDLE OldBitmap;
199         HANDLE OldFont;
200         PAINTSTRUCT ps;
201 
202         hdc = BeginPaint (hWnd, &ps);
203         \textcolor{comment}{/* Show splash graphic */}
204 
205         hdcBitmap = CreateCompatibleDC(hdc);
206         SetBkMode (hdc, OPAQUE);
207         OldBitmap = SelectObject(hdcBitmap, \hyperlink{mhsplash_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->bmpSplash);
208         \hyperlink{sys_2wince_2mhmap_8c_afb458d94567c267343944df598e6f1e9}{nhapply\_image\_transparent}(hdc, \hyperlink{mhsplash_8c_a624203c05ab9c5f804b76ce242e263f6}{SPLASH\_OFFSET\_X}, 
      \hyperlink{mhsplash_8c_a1355d767efd48c02587f8da09eaac59b}{SPLASH\_OFFSET\_Y},
209             \hyperlink{mhsplash_8c_a300803638e66cb9428c1ab04712c70a6}{SPLASH\_WIDTH}, \hyperlink{mhsplash_8c_a0751a8420b717eb073eab7b05a9954dd}{SPLASH\_HEIGHT}, 
210             hdcBitmap, 0, 0, \hyperlink{mhsplash_8c_a300803638e66cb9428c1ab04712c70a6}{SPLASH\_WIDTH}, \hyperlink{mhsplash_8c_a0751a8420b717eb073eab7b05a9954dd}{SPLASH\_HEIGHT}, 
211             \hyperlink{sys_2wince_2winMS_8h_a43f48db3369313aac6df5acfab57a642}{TILE\_BK\_COLOR});
212 
213         SelectObject (hdcBitmap, OldBitmap);
214         DeleteDC (hdcBitmap);
215 
216         SetBkMode (hdc, TRANSPARENT);
217         \textcolor{comment}{/* Print version number */}
218 
219         SetTextColor (hdc, \hyperlink{bitmfile_8c_af08f42f04fcb2073807ade62eef86121a30447e9f6efa4afdd251f9afc1d5fb44}{RGB}(0, 0, 0));
220         rt.right = rt.left = \hyperlink{mhsplash_8c_a5983b488db6db2e49f9f269447ecd37c}{SPLASH\_VERSION\_X};
221         rt.bottom = rt.top = \hyperlink{mhsplash_8c_a39af57681e914b71a83b892d305fe811}{SPLASH\_VERSION\_Y};
222         \hyperlink{global_8h_aa55ba8f4e3c82fe00035e6b51d6c7dee}{Sprintf} (VersionString, \textcolor{stringliteral}{"%d.%d.%d"}, \hyperlink{patchlevel_8h_a1a53b724b6de666faa8a9e0d06d1055f}{VERSION\_MAJOR}, 
      \hyperlink{patchlevel_8h_ae0cb52afb79b185b1bf82c7e235f682b}{VERSION\_MINOR},
223             \hyperlink{patchlevel_8h_a0e36fabb240fb841cc1df19b076f45c9}{PATCHLEVEL});
224         OldFont = SelectObject(hdc, \hyperlink{mhsplash_8c_a0d004a3aaea8816abf5163eb27c1c246}{version\_splash\_font});
225         DrawText (hdc, VersionString, strlen(VersionString), &rt,
226             DT\_LEFT | DT\_NOPREFIX | DT\_CALCRECT);
227         DrawText (hdc, VersionString, strlen(VersionString), &rt,
228             DT\_LEFT | DT\_NOPREFIX);
229 
230         EndPaint (hWnd, &ps);
231     \}
232     \textcolor{keywordflow}{break};
233 
234     \textcolor{keywordflow}{case} WM\_COMMAND:
235     \textcolor{keywordflow}{switch} (LOWORD(wParam))
236         \{
237         \textcolor{keywordflow}{case} IDOK:
238             \hyperlink{sys_2wince_2mswproc_8c_a2dd95f399fc771e39649d2962c6b04f6}{mswin\_window\_mark\_dead}(\hyperlink{sys_2wince_2mswproc_8c_ab8710fc5a763a885ff66eb7e01215fd0}{mswin\_winid\_from\_handle}(
      hWnd));
239             \textcolor{keywordflow}{if}( \hyperlink{mhsplash_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->hMainWnd==hWnd )
240                 \hyperlink{mhsplash_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->\hyperlink{structmswin__nhwindow__app_ada318d77e9dd51678af5d9a3ce6ef03a}{hMainWnd}=\hyperlink{windefs_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
241             DestroyWindow(hWnd);
242             SetFocus(\hyperlink{mhsplash_8c_afa11eb8c832e838349416cf3bbdd29fe}{GetNHApp}()->hMainWnd);
243             \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
244         \}
245     \textcolor{keywordflow}{break};
246     \}
247     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
248 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{mhsplash_8c_a0d004a3aaea8816abf5163eb27c1c246}{\index{mhsplash.\+c@{mhsplash.\+c}!version\+\_\+splash\+\_\+font@{version\+\_\+splash\+\_\+font}}
\index{version\+\_\+splash\+\_\+font@{version\+\_\+splash\+\_\+font}!mhsplash.\+c@{mhsplash.\+c}}
\subsubsection[{version\+\_\+splash\+\_\+font}]{\setlength{\rightskip}{0pt plus 5cm}H\+F\+O\+N\+T version\+\_\+splash\+\_\+font}}\label{mhsplash_8c_a0d004a3aaea8816abf5163eb27c1c246}


Definition at line 16 of file mhfont.\+c.



Referenced by mswin\+\_\+destroy\+\_\+splashfonts(), mswin\+\_\+init\+\_\+splashfonts(), and N\+H\+Splash\+Wnd\+Proc().

