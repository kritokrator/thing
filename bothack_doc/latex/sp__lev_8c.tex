\hypertarget{sp__lev_8c}{\section{nethack/src/sp\+\_\+lev.c File Reference}
\label{sp__lev_8c}\index{nethack/src/sp\+\_\+lev.\+c@{nethack/src/sp\+\_\+lev.\+c}}
}
{\ttfamily \#include \char`\"{}hack.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}dlb.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}sp\+\_\+lev.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}rect.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{sp__lev_8c_a437ef08681e7210d6678427030446a54}{L\+E\+F\+T}~1
\item 
\#define \hyperlink{sp__lev_8c_af6b40fe268805d81d6a5d448873f910e}{H\+\_\+\+L\+E\+F\+T}~2
\item 
\#define \hyperlink{sp__lev_8c_a824fea1f256659e11e6cd8c82cb13338}{C\+E\+N\+T\+E\+R}~3
\item 
\#define \hyperlink{sp__lev_8c_ab3d394d63fa2de33a942bd63775c45e5}{H\+\_\+\+R\+I\+G\+H\+T}~4
\item 
\#define \hyperlink{sp__lev_8c_a80fb826a684cf3f0d306b22aa100ddac}{R\+I\+G\+H\+T}~5
\item 
\#define \hyperlink{sp__lev_8c_afc0eef637f1016e8786e45e106a4881e}{T\+O\+P}~1
\item 
\#define \hyperlink{sp__lev_8c_ae420caa0af9cbdf102ed255034e27c5b}{B\+O\+T\+T\+O\+M}~5
\item 
\#define \hyperlink{sp__lev_8c_ae7616788b30810a219d9cdee95904ba4}{sq}(x)~((x)$\ast$(x))
\item 
\#define \hyperlink{sp__lev_8c_a075f60def9a4c6c70532cc1c6e91ecd7}{X\+L\+I\+M}~4
\item 
\#define \hyperlink{sp__lev_8c_a628ce4849b164cf89c658ef72eb6ac08}{Y\+L\+I\+M}~3
\item 
\#define \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}~(void)\hyperlink{dlb_8h_af592eddf34d2c61fface3d1bd8fae80a}{dlb\+\_\+fread}
\item 
\#define \hyperlink{sp__lev_8c_a98383dc3546cc8c17cd5c8e4d593d1ac}{Fgetc}~(\hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar})\hyperlink{dlb_8h_a3cdf5051464d45b39f1849210754e933}{dlb\+\_\+fgetc}
\item 
\#define \hyperlink{sp__lev_8c_a8e58aceccc995a7b883ede5dd60dbad5}{New}(\hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type})~(\hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} $\ast$) \hyperlink{xpm2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(sizeof(\hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type}))
\item 
\#define \hyperlink{sp__lev_8c_a6b5f263b8333bc27300bf010f774ccd3}{New\+Tab}(\hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type}, \hyperlink{structsize}{size})~(\hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} $\ast$$\ast$) \hyperlink{xpm2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(sizeof(\hyperlink{lev__main_8c_ac765329451135abec74c45e1897abf26}{type} $\ast$) $\ast$ (unsigned)\hyperlink{structsize}{size})
\item 
\#define \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(ptr)~if(ptr) \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\+\_\+t}) (ptr))
\item 
\#define \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{D\+R\+Y}~0x1
\item 
\#define \hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{W\+E\+T}~0x2
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{sp__lev_8c_a2d5b9784df809d6fc8a8140a5c75681d}{F\+D\+E\+C\+L} (\hyperlink{mkmap_8c_a76e9a8db64f065a236c615f278f5b98e}{mkmap},(\hyperlink{structlev__init}{lev\+\_\+init} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_ab27bba6681014a5e0a104549dec640e6}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a7000c03207527bca2d559ff449c49c9b}{get\+\_\+room\+\_\+loc},(\hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} $\ast$, \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} $\ast$, struct \hyperlink{structmkroom}{mkroom} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_aa134c8dc3ef531ffc27f74cc133b02a6}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_aeb5a8f471c788d7ca454e56c9a7d97c9}{get\+\_\+free\+\_\+room\+\_\+loc},(\hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} $\ast$, \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} $\ast$, struct \hyperlink{structmkroom}{mkroom} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_ada8f0d4594745e0607f6a242c5c9c039}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_ab040037bf30273b3fe8e9ceb90eacebe}{create\+\_\+trap},(\hyperlink{structtrap}{trap} $\ast$, struct \hyperlink{structmkroom}{mkroom} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int \hyperlink{sp__lev_8c_a1832ae3f1089c0e10ee7e9bf0f65f1d4}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a6f4731127240a202064d8a77defa7c0b}{noncoalignment},(\hyperlink{wingem1_8c_ad68001b04240583f6667841a186ef26a}{A\+L\+I\+G\+N\+T\+Y\+P\+\_\+\+P}))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_a2aff51222d55bb9b4310de7dbbdc7be0}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_ac4ba802065a2fdec996f8401dddc89f7}{create\+\_\+monster},(\hyperlink{structmonster}{monster} $\ast$, struct \hyperlink{structmkroom}{mkroom} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_aa1532287463014f24bfc19946d533693}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a98e854541b8194eb7b6337417e4b76fc}{create\+\_\+object},(\hyperlink{structobject}{object} $\ast$, struct \hyperlink{structmkroom}{mkroom} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_aecda703fe2709555bba95f3689a1515e}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_aa6f18cdee6178a2d1935e54bf7615479}{create\+\_\+engraving},(\hyperlink{structengraving}{engraving} $\ast$, struct \hyperlink{structmkroom}{mkroom} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_a68fb399d62e0918b73d7b79de74f93c9}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_ae26ceffab26c8763a1133119bf206b09}{create\+\_\+stairs},(\hyperlink{structstair}{stair} $\ast$, struct \hyperlink{structmkroom}{mkroom} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_ab2ed548f4e63e6c8becdc46157bda834}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a561caa9102927221bda21ed9eb0a848e}{create\+\_\+altar},(\hyperlink{structaltar}{altar} $\ast$, struct \hyperlink{structmkroom}{mkroom} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_aeb48140100ec7aac74afd11766565b9f}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a0f75fda68777d83b6cab992aa7778bf2}{create\+\_\+gold},(\hyperlink{structgold}{gold} $\ast$, struct \hyperlink{structmkroom}{mkroom} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_ac2227dead796ccebbe714bb2f8da3323}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_ad7f4c8a0d48ccd9bc4ed7126aa6a1ca5}{create\+\_\+feature},(int, int, struct \hyperlink{structmkroom}{mkroom} $\ast$, int))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{sp__lev_8c_a120ae854d74721a56c056845e81d7641}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a3fa0973072ab41da6a8908299ad70f7c}{search\+\_\+door},(struct \hyperlink{structmkroom}{mkroom} $\ast$, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} $\ast$, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} $\ast$, \hyperlink{wingem1_8c_abea04566e20888dd08f477de5f4b9289}{X\+C\+H\+A\+R\+\_\+\+P}, int))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_acb5f9f6f1d638792de4bf47cf91791df}{N\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_afc958f5b0e8196b52466832cb751275e}{fix\+\_\+stair\+\_\+rooms})
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_ac03e51065071dc400c81917e961fce9f}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a6f7499b11516d8034a446d06dba5b6df}{create\+\_\+corridor},(\hyperlink{structcorridor}{corridor} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{sp__lev_8c_a3d67add9a022d4017f7bbc4a23e6ee8d}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a4bfada15bb3d2f87bdc72619b076bbcb}{create\+\_\+subroom},(struct \hyperlink{structmkroom}{mkroom} $\ast$, \hyperlink{wingem1_8c_abea04566e20888dd08f477de5f4b9289}{X\+C\+H\+A\+R\+\_\+\+P}, \hyperlink{wingem1_8c_abea04566e20888dd08f477de5f4b9289}{X\+C\+H\+A\+R\+\_\+\+P}, \hyperlink{wingem1_8c_abea04566e20888dd08f477de5f4b9289}{X\+C\+H\+A\+R\+\_\+\+P}, \hyperlink{wingem1_8c_abea04566e20888dd08f477de5f4b9289}{X\+C\+H\+A\+R\+\_\+\+P}, \hyperlink{wingem1_8c_abea04566e20888dd08f477de5f4b9289}{X\+C\+H\+A\+R\+\_\+\+P}, \hyperlink{wingem1_8c_abea04566e20888dd08f477de5f4b9289}{X\+C\+H\+A\+R\+\_\+\+P}))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_ab12d2b1ca020e6a293d44819114e4e99}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_ac3e80e7bc7afed094c7af15df57677fd}{set\+\_\+wall\+\_\+property},(\hyperlink{wingem1_8c_abea04566e20888dd08f477de5f4b9289}{X\+C\+H\+A\+R\+\_\+\+P}, \hyperlink{wingem1_8c_abea04566e20888dd08f477de5f4b9289}{X\+C\+H\+A\+R\+\_\+\+P}, \hyperlink{wingem1_8c_abea04566e20888dd08f477de5f4b9289}{X\+C\+H\+A\+R\+\_\+\+P}, \hyperlink{wingem1_8c_abea04566e20888dd08f477de5f4b9289}{X\+C\+H\+A\+R\+\_\+\+P}, int))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int \hyperlink{sp__lev_8c_aba392794b4c61e2b96fbc2b4d6218cbd}{N\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a4afc679d2766b5aac3e3d2d9c3737efe}{rnddoor})
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int \hyperlink{sp__lev_8c_a2aee9c25fdc340cd3fb629c776e9c561}{N\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a08d42781cf218d72107acf7696461a90}{rndtrap})
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_a71276e5f88020beb8ef02f6979b0aa91}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\+\_\+location},(\hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} $\ast$, \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} $\ast$, int))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_a382ef45465cf2ca4e1b28969db6a4d92}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a319f933b60e9c45af293065eeb52bde8}{sp\+\_\+lev\+\_\+shuffle},(char $\ast$, char $\ast$, int))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_a5c29b4d2ab4c7f8c7c0433ab1563b8da}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a90554aa410a51a4252d734f0d3815685}{light\+\_\+region},(\hyperlink{structregion}{region} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_a6ded9a0dcc3a5c646e7271a2300f90e6}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a1de2e47ec9b5c68d80af96a35ec54c61}{load\+\_\+common\+\_\+data},(\hyperlink{dlb_8h_a2c91af84569791b69abdf2b4644b0ddd}{dlb} $\ast$, int))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_aba631a0aa31e412c50fafb261cb8de6e}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a2ee0bfc55edf1c28cb206147c4b4d886}{load\+\_\+one\+\_\+monster},(\hyperlink{dlb_8h_a2c91af84569791b69abdf2b4644b0ddd}{dlb} $\ast$, \hyperlink{structmonster}{monster} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_ac6f90697248ea43ec5f664a680ff4dcc}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a403b9be0b0da32cd8f0feb1a6e5bcf5c}{load\+\_\+one\+\_\+object},(\hyperlink{dlb_8h_a2c91af84569791b69abdf2b4644b0ddd}{dlb} $\ast$, \hyperlink{structobject}{object} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_af7fb72bc52142b0e52afa3c828f7a878}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a6edfc47664388d12901339007cd83aee}{load\+\_\+one\+\_\+engraving},(\hyperlink{dlb_8h_a2c91af84569791b69abdf2b4644b0ddd}{dlb} $\ast$, \hyperlink{structengraving}{engraving} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{sp__lev_8c_afaa56e03f326b148fde8deb7bb2c4d45}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a9542cf195f5f0ccc13693d734d30c749}{load\+\_\+rooms},(\hyperlink{dlb_8h_a2c91af84569791b69abdf2b4644b0ddd}{dlb} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_aa0d53ef4a321857d2447fc724b41cd14}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_ad64df5bd43c6e3845f5df184fa4df0d3}{maze1xy},(\hyperlink{structcoord}{coord} $\ast$, int))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{sp__lev_8c_aa80988326caedcd5c250b9c09127bb3d}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_ad577bf12221d2cd39282480d8e138391}{load\+\_\+maze},(\hyperlink{dlb_8h_a2c91af84569791b69abdf2b4644b0ddd}{dlb} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_a89dee6ee65fd3edfdcb95748751f7c9d}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_ab37a25624368a78df18cdfd45c70bf35}{create\+\_\+door},(\hyperlink{structroom__door}{room\+\_\+door} $\ast$, struct \hyperlink{structmkroom}{mkroom} $\ast$))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_a712bad5bd950db520ea42a81a91f5d8d}{F\+D\+E\+C\+L} (\hyperlink{lev__main_8c_a46f28b77c96aef8ab23a52760993a920}{free\+\_\+rooms},(\hyperlink{sp__lev_8h_a92a4ee12d286276ed17c9feda3bc4e42}{room} $\ast$$\ast$, int))
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void \hyperlink{sp__lev_8c_a038a4de09e7ddce685c6dea04b3c41bd}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a9c5babd949d6728c669aa10a8f95a563}{build\+\_\+room},(\hyperlink{sp__lev_8h_a92a4ee12d286276ed17c9feda3bc4e42}{room} $\ast$, \hyperlink{sp__lev_8h_a92a4ee12d286276ed17c9feda3bc4e42}{room} $\ast$))
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_ac3e80e7bc7afed094c7af15df57677fd}{set\+\_\+wall\+\_\+property} (\hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} x1, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} y1, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} x2, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} y2, int \hyperlink{structprop}{prop})
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int \hyperlink{sp__lev_8c_a4afc679d2766b5aac3e3d2d9c3737efe}{rnddoor} ()
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int \hyperlink{sp__lev_8c_a08d42781cf218d72107acf7696461a90}{rndtrap} ()
\item 
\hyperlink{hack_8h_a0c2ce0eef98596c51b3a10e50a29dd5e}{S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{sp__lev_8c_aeb31176a58328bca5f9be6d7df92a478}{F\+D\+E\+C\+L} (\hyperlink{sp__lev_8c_a3aed0a0dffcf9b69d63541ae4131b8ae}{is\+\_\+ok\+\_\+location},(\hyperlink{wingem1_8c_aee989e2c39503870922ec51a2267f345}{S\+C\+H\+A\+R\+\_\+\+P}, \hyperlink{wingem1_8c_aee989e2c39503870922ec51a2267f345}{S\+C\+H\+A\+R\+\_\+\+P}, int))
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\+\_\+location} (\hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} $\ast$x, \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} $\ast$y, int humidity)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{sp__lev_8c_a3aed0a0dffcf9b69d63541ae4131b8ae}{is\+\_\+ok\+\_\+location} (\hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} x, \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} y, int humidity)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_a319f933b60e9c45af293065eeb52bde8}{sp\+\_\+lev\+\_\+shuffle} (list1, list2, int n)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_a7000c03207527bca2d559ff449c49c9b}{get\+\_\+room\+\_\+loc} (\hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} $\ast$x, \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} $\ast$y, struct \hyperlink{structmkroom}{mkroom} $\ast$croom)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_aeb5a8f471c788d7ca454e56c9a7d97c9}{get\+\_\+free\+\_\+room\+\_\+loc} (\hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} $\ast$x, \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} $\ast$y, struct \hyperlink{structmkroom}{mkroom} $\ast$croom)
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{sp__lev_8c_a82e8922c853831487f6f175225a5ea46}{check\+\_\+room} (\hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} $\ast$lowx, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} $\ast$ddx, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} $\ast$lowy, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} $\ast$ddy, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} vault)
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{sp__lev_8c_aed0bf1587841aa8f663dfde599226f82}{create\+\_\+room} (\hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} x, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} y, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} w, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} h, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} xal, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} yal, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} rtype, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} rlit)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{sp__lev_8c_a4bfada15bb3d2f87bdc72619b076bbcb}{create\+\_\+subroom} (struct \hyperlink{structmkroom}{mkroom} $\ast$proom, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} x, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} y, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} w, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} h, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} rtype, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} rlit)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_ab37a25624368a78df18cdfd45c70bf35}{create\+\_\+door} (\hyperlink{structroom__door}{room\+\_\+door} $\ast$\hyperlink{celib_8c_af93f6b4995f5a7949cf616339b3a62b1}{dd}, struct \hyperlink{structmkroom}{mkroom} $\ast$broom)
\item 
void \hyperlink{sp__lev_8c_a8fdba0dd9aca405c0bfa964c90b3f4d4}{create\+\_\+secret\+\_\+door} (struct \hyperlink{structmkroom}{mkroom} $\ast$croom, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} walls)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_ab040037bf30273b3fe8e9ceb90eacebe}{create\+\_\+trap} (\hyperlink{structtrap}{trap} $\ast$t, struct \hyperlink{structmkroom}{mkroom} $\ast$croom)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int \hyperlink{sp__lev_8c_a6f4731127240a202064d8a77defa7c0b}{noncoalignment} (\hyperlink{align_8h_a3e17b7a656899892e425fc89481aa2ab}{aligntyp} alignment)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_ac4ba802065a2fdec996f8401dddc89f7}{create\+\_\+monster} (\hyperlink{structmonster}{monster} $\ast$\hyperlink{muse_8c_a3ff7db235f25673e1fe2b7b1d66d305d}{m}, struct \hyperlink{structmkroom}{mkroom} $\ast$croom)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_a98e854541b8194eb7b6337417e4b76fc}{create\+\_\+object} (\hyperlink{structobject}{object} $\ast$o, struct \hyperlink{structmkroom}{mkroom} $\ast$croom)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_aa6f18cdee6178a2d1935e54bf7615479}{create\+\_\+engraving} (\hyperlink{structengraving}{engraving} $\ast$e, struct \hyperlink{structmkroom}{mkroom} $\ast$croom)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_ae26ceffab26c8763a1133119bf206b09}{create\+\_\+stairs} (\hyperlink{structstair}{stair} $\ast$s, struct \hyperlink{structmkroom}{mkroom} $\ast$croom)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_a561caa9102927221bda21ed9eb0a848e}{create\+\_\+altar} (\hyperlink{structaltar}{altar} $\ast$a, struct \hyperlink{structmkroom}{mkroom} $\ast$croom)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_a0f75fda68777d83b6cab992aa7778bf2}{create\+\_\+gold} (\hyperlink{structgold}{gold} $\ast$g, struct \hyperlink{structmkroom}{mkroom} $\ast$croom)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_ad7f4c8a0d48ccd9bc4ed7126aa6a1ca5}{create\+\_\+feature} (int fx, int fy, struct \hyperlink{structmkroom}{mkroom} $\ast$croom, int typ)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{sp__lev_8c_a3fa0973072ab41da6a8908299ad70f7c}{search\+\_\+door} (struct \hyperlink{structmkroom}{mkroom} $\ast$croom, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} $\ast$x, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} $\ast$y, \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} wall, int cnt)
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{sp__lev_8c_ad87ffe1562fb5ae4768446e053f08207}{dig\+\_\+corridor} (\hyperlink{structcoord}{coord} $\ast$org, \hyperlink{structcoord}{coord} $\ast$dest, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} nxcor, \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} ftyp, \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} btyp)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_afc958f5b0e8196b52466832cb751275e}{fix\+\_\+stair\+\_\+rooms} ()
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_a6f7499b11516d8034a446d06dba5b6df}{create\+\_\+corridor} (\hyperlink{structcorridor}{corridor} $\ast$c)
\item 
void \hyperlink{sp__lev_8c_a4e02bf4c52efa86f7646872d6ef341cb}{fill\+\_\+room} (struct \hyperlink{structmkroom}{mkroom} $\ast$croom, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} prefilled)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_a8e56974ec7cfc17438a372c340ef4d83}{free\+\_\+rooms} (\hyperlink{sp__lev_8h_a92a4ee12d286276ed17c9feda3bc4e42}{room} $\ast$$\ast$ro, int n)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_a9c5babd949d6728c669aa10a8f95a563}{build\+\_\+room} (\hyperlink{sp__lev_8h_a92a4ee12d286276ed17c9feda3bc4e42}{room} $\ast$r, \hyperlink{sp__lev_8h_a92a4ee12d286276ed17c9feda3bc4e42}{room} $\ast$pr)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_a90554aa410a51a4252d734f0d3815685}{light\+\_\+region} (\hyperlink{structregion}{region} $\ast$tmpregion)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_a1de2e47ec9b5c68d80af96a35ec54c61}{load\+\_\+common\+\_\+data} (\hyperlink{dlb_8h_a2c91af84569791b69abdf2b4644b0ddd}{dlb} $\ast$fd, int typ)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_a2ee0bfc55edf1c28cb206147c4b4d886}{load\+\_\+one\+\_\+monster} (\hyperlink{dlb_8h_a2c91af84569791b69abdf2b4644b0ddd}{dlb} $\ast$fd, \hyperlink{structmonster}{monster} $\ast$\hyperlink{muse_8c_a3ff7db235f25673e1fe2b7b1d66d305d}{m})
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_a403b9be0b0da32cd8f0feb1a6e5bcf5c}{load\+\_\+one\+\_\+object} (\hyperlink{dlb_8h_a2c91af84569791b69abdf2b4644b0ddd}{dlb} $\ast$fd, \hyperlink{structobject}{object} $\ast$o)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_a6edfc47664388d12901339007cd83aee}{load\+\_\+one\+\_\+engraving} (\hyperlink{dlb_8h_a2c91af84569791b69abdf2b4644b0ddd}{dlb} $\ast$fd, \hyperlink{structengraving}{engraving} $\ast$e)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{sp__lev_8c_a9542cf195f5f0ccc13693d734d30c749}{load\+\_\+rooms} (\hyperlink{dlb_8h_a2c91af84569791b69abdf2b4644b0ddd}{dlb} $\ast$fd)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void \hyperlink{sp__lev_8c_ad64df5bd43c6e3845f5df184fa4df0d3}{maze1xy} (\hyperlink{structcoord}{coord} $\ast$\hyperlink{muse_8c_a3ff7db235f25673e1fe2b7b1d66d305d}{m}, int humidity)
\item 
\hyperlink{hack_8h_a6584b0687fb4e0040a85bbcdaa3e0ee1}{S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{sp__lev_8c_ad577bf12221d2cd39282480d8e138391}{load\+\_\+maze} (\hyperlink{dlb_8h_a2c91af84569791b69abdf2b4644b0ddd}{dlb} $\ast$fd)
\item 
\hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} \hyperlink{sp__lev_8c_aecd77c8d5219946f49e15b9b741fec4c}{load\+\_\+special} (char $\ast$\hyperlink{lev__main_8c_a8f8f80d37794cde9472343e4487ba3eb}{name}) \hyperlink{tradstdc_8h_a2c212835823e3c54a8ab6d95c652660e}{const}
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{config1_8h_a9987bf629301f5fe76ddd96aa2717ca1}{N\+E\+A\+R\+D\+A\+T\+A} \hyperlink{structwalk}{walk} \hyperlink{sp__lev_8c_a31e63fe41665cf88ce4da8060a209b78}{walklist} \mbox{[}50\mbox{]}
\item 
int \hyperlink{sp__lev_8c_a894604b3687b9ef24fbd3860e4975fd3}{min\+\_\+rx}
\item 
int \hyperlink{sp__lev_8c_abc15291b7b86b60e0c490c8e8cbe0e51}{max\+\_\+rx}
\item 
int \hyperlink{sp__lev_8c_ad85187115f92107d269ef993f80036f0}{min\+\_\+ry}
\item 
int \hyperlink{sp__lev_8c_aedc93067a733f3fa903cf92c7b0cff4e}{max\+\_\+ry}
\item 
static char \hyperlink{sp__lev_8c_a8759e0f6c69dca527985b85d1c66dc9c}{Map} \mbox{[}\hyperlink{gnmap_8c_a308dbfcc29f5a427c0315f3cbf03c3ed}{C\+O\+L\+N\+O}\mbox{]}\mbox{[}\hyperlink{gnmap_8c_a9cce134868d97b23c35bcf1ff4a343d8}{R\+O\+W\+N\+O}\mbox{]}
\item 
static char \hyperlink{sp__lev_8c_a4c62499de047bc3a15f32e4f14c00c66}{robjects} \mbox{[}10\mbox{]}
\item 
static char \hyperlink{sp__lev_8c_a6179f3acad257eb4f3057010c6a6d187}{rloc\+\_\+x} \mbox{[}10\mbox{]}
\item 
static char \hyperlink{sp__lev_8c_a42c30954e08e02960a5096ed70009726}{rloc\+\_\+y} \mbox{[}10\mbox{]}
\item 
static char \hyperlink{sp__lev_8c_af35c3f24113af660b5d6e6b4105032e0}{rmonst} \mbox{[}10\mbox{]}
\item 
static \hyperlink{align_8h_a3e17b7a656899892e425fc89481aa2ab}{aligntyp} \hyperlink{sp__lev_8c_a2a0a619642f0bf17e690e1ab33a82b6c}{ralign} \mbox{[}3\mbox{]} = \{ \hyperlink{align_8h_a4bb126249b7cc0370b948950f11abe92}{A\+M\+\_\+\+C\+H\+A\+O\+T\+I\+C}, \hyperlink{align_8h_a67c4a32b3d1375a95c4416935399e338}{A\+M\+\_\+\+N\+E\+U\+T\+R\+A\+L}, \hyperlink{align_8h_ac5ed2af15492dbb6020886afd104f786}{A\+M\+\_\+\+L\+A\+W\+F\+U\+L} \}
\item 
static \hyperlink{config1_8h_a9987bf629301f5fe76ddd96aa2717ca1}{N\+E\+A\+R\+D\+A\+T\+A} \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart}
\item 
static \hyperlink{config1_8h_a9987bf629301f5fe76ddd96aa2717ca1}{N\+E\+A\+R\+D\+A\+T\+A} \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart}
\item 
static \hyperlink{config1_8h_a9987bf629301f5fe76ddd96aa2717ca1}{N\+E\+A\+R\+D\+A\+T\+A} char \hyperlink{sp__lev_8c_a22122ed2c15d87f3ff9e3dad23423244}{xsize}
\item 
static \hyperlink{config1_8h_a9987bf629301f5fe76ddd96aa2717ca1}{N\+E\+A\+R\+D\+A\+T\+A} char \hyperlink{sp__lev_8c_a17f6fa5b5051ab79afe70d9598576009}{ysize}
\item 
char $\ast$ \hyperlink{sp__lev_8c_a8a8cfd6f51acd4c0a227a5332be69227}{lev\+\_\+message} = 0
\item 
\hyperlink{structlev__region}{lev\+\_\+region} $\ast$ \hyperlink{sp__lev_8c_a5195d0e282f5603843e4a384e9995caa}{lregions} = 0
\item 
int \hyperlink{sp__lev_8c_a1f90034b6a3d7de0cba06ae8960de3ea}{num\+\_\+lregions} = 0
\item 
\hyperlink{structlev__init}{lev\+\_\+init} \hyperlink{sp__lev_8c_ac2ea43aa4412d3297d8af7faf0b1c927}{init\+\_\+lev}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{sp__lev_8c_ae420caa0af9cbdf102ed255034e27c5b}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!B\+O\+T\+T\+O\+M@{B\+O\+T\+T\+O\+M}}
\index{B\+O\+T\+T\+O\+M@{B\+O\+T\+T\+O\+M}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{B\+O\+T\+T\+O\+M}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\+O\+T\+T\+O\+M~5}}\label{sp__lev_8c_ae420caa0af9cbdf102ed255034e27c5b}


Definition at line 55 of file sp\+\_\+lev.\+c.



Referenced by create\+\_\+room(), and load\+\_\+maze().

\hypertarget{sp__lev_8c_a824fea1f256659e11e6cd8c82cb13338}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!C\+E\+N\+T\+E\+R@{C\+E\+N\+T\+E\+R}}
\index{C\+E\+N\+T\+E\+R@{C\+E\+N\+T\+E\+R}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{C\+E\+N\+T\+E\+R}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\+E\+N\+T\+E\+R~3}}\label{sp__lev_8c_a824fea1f256659e11e6cd8c82cb13338}


Definition at line 50 of file sp\+\_\+lev.\+c.



Referenced by create\+\_\+room(), load\+\_\+maze(), and yylex().

\hypertarget{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!D\+R\+Y@{D\+R\+Y}}
\index{D\+R\+Y@{D\+R\+Y}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{D\+R\+Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+R\+Y~0x1}}\label{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}


Definition at line 165 of file sp\+\_\+lev.\+c.



Referenced by create\+\_\+altar(), create\+\_\+engraving(), create\+\_\+feature(), create\+\_\+gold(), create\+\_\+monster(), create\+\_\+object(), create\+\_\+trap(), is\+\_\+ok\+\_\+location(), and load\+\_\+maze().

\hypertarget{sp__lev_8c_a98383dc3546cc8c17cd5c8e4d593d1ac}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!Fgetc@{Fgetc}}
\index{Fgetc@{Fgetc}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{Fgetc}]{\setlength{\rightskip}{0pt plus 5cm}\#define Fgetc~({\bf schar}){\bf dlb\+\_\+fgetc}}}\label{sp__lev_8c_a98383dc3546cc8c17cd5c8e4d593d1ac}


Definition at line 63 of file sp\+\_\+lev.\+c.



Referenced by load\+\_\+maze().

\hypertarget{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!Fread@{Fread}}
\index{Fread@{Fread}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{Fread}]{\setlength{\rightskip}{0pt plus 5cm}\#define Fread~(void){\bf dlb\+\_\+fread}}}\label{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}


Definition at line 62 of file sp\+\_\+lev.\+c.



Referenced by load\+\_\+common\+\_\+data(), load\+\_\+maze(), load\+\_\+one\+\_\+engraving(), load\+\_\+one\+\_\+monster(), load\+\_\+one\+\_\+object(), load\+\_\+rooms(), and load\+\_\+special().

\hypertarget{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!Free@{Free}}
\index{Free@{Free}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{Free}]{\setlength{\rightskip}{0pt plus 5cm}\#define Free(
\begin{DoxyParamCaption}
\item[{}]{ptr}
\end{DoxyParamCaption}
)~if(ptr) {\bf free}(({\bf genericptr\+\_\+t}) (ptr))}}\label{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}


Definition at line 66 of file sp\+\_\+lev.\+c.



Referenced by create\+\_\+monster(), create\+\_\+object(), free\+\_\+rooms(), and load\+\_\+maze().

\hypertarget{sp__lev_8c_af6b40fe268805d81d6a5d448873f910e}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!H\+\_\+\+L\+E\+F\+T@{H\+\_\+\+L\+E\+F\+T}}
\index{H\+\_\+\+L\+E\+F\+T@{H\+\_\+\+L\+E\+F\+T}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{H\+\_\+\+L\+E\+F\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define H\+\_\+\+L\+E\+F\+T~2}}\label{sp__lev_8c_af6b40fe268805d81d6a5d448873f910e}


Definition at line 49 of file sp\+\_\+lev.\+c.



Referenced by load\+\_\+maze().

\hypertarget{sp__lev_8c_ab3d394d63fa2de33a942bd63775c45e5}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!H\+\_\+\+R\+I\+G\+H\+T@{H\+\_\+\+R\+I\+G\+H\+T}}
\index{H\+\_\+\+R\+I\+G\+H\+T@{H\+\_\+\+R\+I\+G\+H\+T}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{H\+\_\+\+R\+I\+G\+H\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define H\+\_\+\+R\+I\+G\+H\+T~4}}\label{sp__lev_8c_ab3d394d63fa2de33a942bd63775c45e5}


Definition at line 51 of file sp\+\_\+lev.\+c.



Referenced by load\+\_\+maze().

\hypertarget{sp__lev_8c_a437ef08681e7210d6678427030446a54}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!L\+E\+F\+T@{L\+E\+F\+T}}
\index{L\+E\+F\+T@{L\+E\+F\+T}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{L\+E\+F\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\+E\+F\+T~1}}\label{sp__lev_8c_a437ef08681e7210d6678427030446a54}


Definition at line 48 of file sp\+\_\+lev.\+c.



Referenced by create\+\_\+room(), and load\+\_\+maze().

\hypertarget{sp__lev_8c_a8e58aceccc995a7b883ede5dd60dbad5}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!New@{New}}
\index{New@{New}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{New}]{\setlength{\rightskip}{0pt plus 5cm}\#define New(
\begin{DoxyParamCaption}
\item[{}]{{\bf type}}
\end{DoxyParamCaption}
)~({\bf type} $\ast$) {\bf alloc}(sizeof({\bf type}))}}\label{sp__lev_8c_a8e58aceccc995a7b883ede5dd60dbad5}


Definition at line 64 of file sp\+\_\+lev.\+c.



Referenced by load\+\_\+rooms().

\hypertarget{sp__lev_8c_a6b5f263b8333bc27300bf010f774ccd3}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!New\+Tab@{New\+Tab}}
\index{New\+Tab@{New\+Tab}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{New\+Tab}]{\setlength{\rightskip}{0pt plus 5cm}\#define New\+Tab(
\begin{DoxyParamCaption}
\item[{}]{{\bf type}, }
\item[{}]{{\bf size}}
\end{DoxyParamCaption}
)~({\bf type} $\ast$$\ast$) {\bf alloc}(sizeof({\bf type} $\ast$) $\ast$ (unsigned){\bf size})}}\label{sp__lev_8c_a6b5f263b8333bc27300bf010f774ccd3}


Definition at line 65 of file sp\+\_\+lev.\+c.



Referenced by load\+\_\+rooms().

\hypertarget{sp__lev_8c_a80fb826a684cf3f0d306b22aa100ddac}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!R\+I\+G\+H\+T@{R\+I\+G\+H\+T}}
\index{R\+I\+G\+H\+T@{R\+I\+G\+H\+T}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{R\+I\+G\+H\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+I\+G\+H\+T~5}}\label{sp__lev_8c_a80fb826a684cf3f0d306b22aa100ddac}


Definition at line 52 of file sp\+\_\+lev.\+c.



Referenced by create\+\_\+room(), and load\+\_\+maze().

\hypertarget{sp__lev_8c_ae7616788b30810a219d9cdee95904ba4}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!sq@{sq}}
\index{sq@{sq}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{sq}]{\setlength{\rightskip}{0pt plus 5cm}\#define sq(
\begin{DoxyParamCaption}
\item[{}]{x}
\end{DoxyParamCaption}
)~((x)$\ast$(x))}}\label{sp__lev_8c_ae7616788b30810a219d9cdee95904ba4}


Definition at line 57 of file sp\+\_\+lev.\+c.

\hypertarget{sp__lev_8c_afc0eef637f1016e8786e45e106a4881e}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!T\+O\+P@{T\+O\+P}}
\index{T\+O\+P@{T\+O\+P}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{T\+O\+P}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\+O\+P~1}}\label{sp__lev_8c_afc0eef637f1016e8786e45e106a4881e}


Definition at line 54 of file sp\+\_\+lev.\+c.



Referenced by create\+\_\+room(), and load\+\_\+maze().

\hypertarget{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!W\+E\+T@{W\+E\+T}}
\index{W\+E\+T@{W\+E\+T}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{W\+E\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define W\+E\+T~0x2}}\label{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}


Definition at line 166 of file sp\+\_\+lev.\+c.



Referenced by create\+\_\+monster(), is\+\_\+ok\+\_\+location(), and load\+\_\+maze().

\hypertarget{sp__lev_8c_a075f60def9a4c6c70532cc1c6e91ecd7}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!X\+L\+I\+M@{X\+L\+I\+M}}
\index{X\+L\+I\+M@{X\+L\+I\+M}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{X\+L\+I\+M}]{\setlength{\rightskip}{0pt plus 5cm}\#define X\+L\+I\+M~4}}\label{sp__lev_8c_a075f60def9a4c6c70532cc1c6e91ecd7}


Definition at line 59 of file sp\+\_\+lev.\+c.



Referenced by check\+\_\+room(), and create\+\_\+room().

\hypertarget{sp__lev_8c_a628ce4849b164cf89c658ef72eb6ac08}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!Y\+L\+I\+M@{Y\+L\+I\+M}}
\index{Y\+L\+I\+M@{Y\+L\+I\+M}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{Y\+L\+I\+M}]{\setlength{\rightskip}{0pt plus 5cm}\#define Y\+L\+I\+M~3}}\label{sp__lev_8c_a628ce4849b164cf89c658ef72eb6ac08}


Definition at line 60 of file sp\+\_\+lev.\+c.



Referenced by check\+\_\+room(), and create\+\_\+room().



\subsection{Function Documentation}
\hypertarget{sp__lev_8c_a9c5babd949d6728c669aa10a8f95a563}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!build\+\_\+room@{build\+\_\+room}}
\index{build\+\_\+room@{build\+\_\+room}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{build\+\_\+room}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void build\+\_\+room (
\begin{DoxyParamCaption}
\item[{{\bf room} $\ast$}]{r, }
\item[{{\bf room} $\ast$}]{pr}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a9c5babd949d6728c669aa10a8f95a563}


Definition at line 1595 of file sp\+\_\+lev.\+c.



References create\+\_\+altar(), create\+\_\+door(), create\+\_\+engraving(), create\+\_\+feature(), create\+\_\+gold(), create\+\_\+monster(), create\+\_\+object(), create\+\_\+room(), create\+\_\+stairs(), create\+\_\+subroom(), create\+\_\+trap(), F\+A\+L\+S\+E, fill\+\_\+room(), F\+O\+U\+N\+T\+A\+I\+N, nroom, nsubroom, O\+R\+O\+O\+M, P\+O\+O\+L, rooms, mkroom\+::rtype, S\+I\+N\+K, subrooms, and topologize().



Referenced by load\+\_\+rooms().


\begin{DoxyCode}
1597 \{
1598     \textcolor{keywordtype}{boolean} okroom;
1599     \textcolor{keyword}{struct }\hyperlink{structmkroom}{mkroom} *aroom;
1600     \textcolor{keywordtype}{short} i;
1601     \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} \hyperlink{structmkroom_a0ad2dc1a7e0527610e96e830b2cad471}{rtype} = (!r->\hyperlink{struct__room_a9c033e9f0b02e503f8c28e52f388f20b}{chance} || rn2(100) < r->\hyperlink{struct__room_a9c033e9f0b02e503f8c28e52f388f20b}{chance}) ? r->
      \hyperlink{struct__room_aead16a1e5cdaa60d26ec4be9240ceb94}{rtype} : \hyperlink{mkroom_8h_a24fe7e4ef6dbb56e7d2570a7ac640d71}{OROOM};
1602 
1603     \textcolor{keywordflow}{if}(pr) \{
1604         aroom = &\hyperlink{mkroom_8h_a2e0cf582d6940f97c67c8ef051f42ad7}{subrooms}[\hyperlink{decl_8h_ad3fae90c5f0a894ccda2c1811e609e70}{nsubroom}];
1605         okroom = \hyperlink{sp__lev_8c_a4bfada15bb3d2f87bdc72619b076bbcb}{create\_subroom}(pr->\hyperlink{struct__room_a64890d3c7d8c456474153a3a1dab9400}{mkr}, r->\hyperlink{struct__room_a7f3be8a31d75214a0e94c3bfb75d1fda}{x}, r->\hyperlink{struct__room_a62bdbccfce4dd3dcd1af7d5bf1d36041}{y}, r->\hyperlink{struct__room_a468bcdac94f7322f6ec4a0565e7e51d7}{w}, r->
      \hyperlink{struct__room_a3b5a0d626176f0e352f910f2b341dfa0}{h},
1606                     rtype, r->\hyperlink{struct__room_a4456f444341aea7d18c68cc4400becec}{rlit});
1607     \} \textcolor{keywordflow}{else} \{
1608         aroom = &\hyperlink{mkroom_8h_a45030df62e6451e79233760364dca9e1}{rooms}[\hyperlink{decl_8h_a5f1394ad444ca9a0b5e47123e8c454d9}{nroom}];
1609         okroom = \hyperlink{sp__lev_8c_aed0bf1587841aa8f663dfde599226f82}{create\_room}(r->\hyperlink{struct__room_a7f3be8a31d75214a0e94c3bfb75d1fda}{x}, r->\hyperlink{struct__room_a62bdbccfce4dd3dcd1af7d5bf1d36041}{y}, r->\hyperlink{struct__room_a468bcdac94f7322f6ec4a0565e7e51d7}{w}, r->\hyperlink{struct__room_a3b5a0d626176f0e352f910f2b341dfa0}{h}, r->\hyperlink{struct__room_a18538541f582181a368b543e6d36a4d2}{xalign},
1610                      r->\hyperlink{struct__room_a521977071dfc4981b7f294dfdf59cf6d}{yalign}, rtype, r->\hyperlink{struct__room_a4456f444341aea7d18c68cc4400becec}{rlit});
1611         r->\hyperlink{struct__room_a64890d3c7d8c456474153a3a1dab9400}{mkr} = aroom;
1612     \}
1613 
1614     \textcolor{keywordflow}{if} (okroom) \{
1615         \textcolor{comment}{/* Create subrooms if necessary... */}
1616         \textcolor{keywordflow}{for}(i=0; i < r->\hyperlink{struct__room_a33ab2c6401d14af02e880b4592738002}{nsubroom}; i++)
1617             \hyperlink{sp__lev_8c_a9c5babd949d6728c669aa10a8f95a563}{build\_room}(r->\hyperlink{struct__room_a2c343f093ae49664a4fa89b4e3b97518}{subrooms}[i], r);
1618         \textcolor{comment}{/* And now we can fill the room! */}
1619 
1620         \textcolor{comment}{/* Priority to the stairs */}
1621 
1622         \textcolor{keywordflow}{for}(i=0; i <r->\hyperlink{struct__room_a4c7178c7b2d6aae68c8bc575e65b4928}{nstair}; i++)
1623             \hyperlink{sp__lev_8c_ae26ceffab26c8763a1133119bf206b09}{create\_stairs}(r->\hyperlink{struct__room_ae3b0130f66fce4fc798876a6da829e64}{stairs}[i], aroom);
1624 
1625         \textcolor{comment}{/* Then to the various elements (sinks, etc..) */}
1626         \textcolor{keywordflow}{for}(i = 0; i<r->\hyperlink{struct__room_a49a3273df13628e3928da7ec7cd88d2c}{nsink}; i++)
1627             \hyperlink{sp__lev_8c_ad7f4c8a0d48ccd9bc4ed7126aa6a1ca5}{create\_feature}(r->\hyperlink{struct__room_a3e983d2628aef0ea6f2a5eefc6a6759e}{sinks}[i]->\hyperlink{structsink_a42373254ba38ee09fe50a8e35bf84575}{x}, r->\hyperlink{struct__room_a3e983d2628aef0ea6f2a5eefc6a6759e}{sinks}[i]->
      \hyperlink{structsink_ac71df1156c542994966c6ae5280b295a}{y}, aroom, \hyperlink{rm_8h_adb1aacb84dbc34f3a142a9d7bc80f375}{SINK});
1628         \textcolor{keywordflow}{for}(i = 0; i<r->\hyperlink{struct__room_a309691c7928482b72435ad884e731ee1}{npool}; i++)
1629             \hyperlink{sp__lev_8c_ad7f4c8a0d48ccd9bc4ed7126aa6a1ca5}{create\_feature}(r->\hyperlink{struct__room_a671fd6f463544e5d1815524a2501fa4e}{pools}[i]->\hyperlink{structpool_a5a1a80afb596115de6fc168a01d46c98}{x}, r->\hyperlink{struct__room_a671fd6f463544e5d1815524a2501fa4e}{pools}[i]->
      \hyperlink{structpool_a202ad40915dccb662447c4278484cb78}{y}, aroom, \hyperlink{rm_8h_abf0d5c9a865c02bf5cc94e5d5755997c}{POOL});
1630         \textcolor{keywordflow}{for}(i = 0; i<r->\hyperlink{struct__room_a1dd82879b9d6ec47eee892f2b1f02f28}{nfountain}; i++)
1631             \hyperlink{sp__lev_8c_ad7f4c8a0d48ccd9bc4ed7126aa6a1ca5}{create\_feature}(r->\hyperlink{struct__room_a4e68727ef155a3b332565ddf632b4e59}{fountains}[i]->\hyperlink{structfountain_a4d961bd1595cc47db7b98de352c664b4}{x}, r->
      \hyperlink{struct__room_a4e68727ef155a3b332565ddf632b4e59}{fountains}[i]->\hyperlink{structfountain_ac0c570fba191ef9f1c37908d3ddc07dc}{y},
1632                    aroom, \hyperlink{rm_8h_a88fabf28d6285490fea11089d88167ca}{FOUNTAIN});
1633         \textcolor{keywordflow}{for}(i = 0; i<r->\hyperlink{struct__room_a6e5fedf04693d5601d2fe64a2402963f}{naltar}; i++)
1634             \hyperlink{sp__lev_8c_a561caa9102927221bda21ed9eb0a848e}{create\_altar}(r->\hyperlink{struct__room_ae093807c3fc83a79dfb56ba31537fd37}{altars}[i], aroom);
1635         \textcolor{keywordflow}{for}(i = 0; i<r->\hyperlink{struct__room_adf93ac64ee6c689fc8faf034101104d2}{ndoor}; i++)
1636             \hyperlink{sp__lev_8c_ab37a25624368a78df18cdfd45c70bf35}{create\_door}(r->\hyperlink{struct__room_a7680e15d05c73add8201e0b05ac24433}{doors}[i], aroom);
1637 
1638         \textcolor{comment}{/* The traps */}
1639         \textcolor{keywordflow}{for}(i = 0; i<r->\hyperlink{struct__room_a8deec962297d6604afe7141d852413cc}{ntrap}; i++)
1640             \hyperlink{sp__lev_8c_ab040037bf30273b3fe8e9ceb90eacebe}{create\_trap}(r->\hyperlink{struct__room_aead249557eb11c2d252993fc008c480c}{traps}[i], aroom);
1641 
1642         \textcolor{comment}{/* The monsters */}
1643         \textcolor{keywordflow}{for}(i = 0; i<r->\hyperlink{struct__room_af54a6a7c092d32717c95edf356a23f88}{nmonster}; i++)
1644             \hyperlink{sp__lev_8c_ac4ba802065a2fdec996f8401dddc89f7}{create\_monster}(r->\hyperlink{struct__room_a3825f14ece25f8f21e8613d5b77df092}{monsters}[i], aroom);
1645 
1646         \textcolor{comment}{/* The objects */}
1647         \textcolor{keywordflow}{for}(i = 0; i<r->\hyperlink{struct__room_aa955a62dbaafdf4638c3d2ce3d08c650}{nobject}; i++)
1648             \hyperlink{sp__lev_8c_a98e854541b8194eb7b6337417e4b76fc}{create\_object}(r->\hyperlink{struct__room_a950a5ae5abd82208ba0ccaf95369c3ec}{objects}[i], aroom);
1649 
1650         \textcolor{comment}{/* The gold piles */}
1651         \textcolor{keywordflow}{for}(i = 0; i<r->\hyperlink{struct__room_af05297b65bbb8d9ac4234faf6cedef40}{ngold}; i++)
1652             \hyperlink{sp__lev_8c_a0f75fda68777d83b6cab992aa7778bf2}{create\_gold}(r->\hyperlink{struct__room_a098fb9c2d338496af31b6219a81eb3ab}{golds}[i], aroom);
1653 
1654         \textcolor{comment}{/* The engravings */}
1655         \textcolor{keywordflow}{for} (i = 0; i < r->\hyperlink{struct__room_a3490cb38c5c28a5b859ad715371f9a03}{nengraving}; i++)
1656             \hyperlink{sp__lev_8c_aa6f18cdee6178a2d1935e54bf7615479}{create\_engraving}(r->\hyperlink{struct__room_a39e5c581b788be17eaf8f3669fb7059a}{engravings}[i], aroom);
1657 
1658 \textcolor{preprocessor}{#ifdef SPECIALIZATION}
1659         \hyperlink{mklev_8c_ac3aecaa5e9dbd24cb58763276451439c}{topologize}(aroom,\hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});     \textcolor{comment}{/* set roomno */}
1660 \textcolor{preprocessor}{#else}
1661         \hyperlink{mklev_8c_ac3aecaa5e9dbd24cb58763276451439c}{topologize}(aroom);            \textcolor{comment}{/* set roomno */}
1662 \textcolor{preprocessor}{#endif}
1663         \textcolor{comment}{/* MRS - 07/04/91 - This is temporary but should result}
1664 \textcolor{comment}{         * in proper filling of shops, etc.}
1665 \textcolor{comment}{         * DLC - this can fail if corridors are added to this room}
1666 \textcolor{comment}{         * at a later point.  Currently no good way to fix this.}
1667 \textcolor{comment}{         */}
1668         \textcolor{keywordflow}{if}(aroom->\hyperlink{structmkroom_a0ad2dc1a7e0527610e96e830b2cad471}{rtype} != \hyperlink{mkroom_8h_a24fe7e4ef6dbb56e7d2570a7ac640d71}{OROOM} && r->\hyperlink{struct__room_a915f3f466b1a51ba9c70ea4cb669c19f}{filled}) \hyperlink{sp__lev_8c_a4e02bf4c52efa86f7646872d6ef341cb}{fill\_room}(aroom, 
      \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1669     \}
1670 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a82e8922c853831487f6f175225a5ea46}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!check\+\_\+room@{check\+\_\+room}}
\index{check\+\_\+room@{check\+\_\+room}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{check\+\_\+room}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} check\+\_\+room (
\begin{DoxyParamCaption}
\item[{{\bf xchar} $\ast$}]{lowx, }
\item[{{\bf xchar} $\ast$}]{ddx, }
\item[{{\bf xchar} $\ast$}]{lowy, }
\item[{{\bf xchar} $\ast$}]{ddy, }
\item[{{\bf boolean}}]{vault}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a82e8922c853831487f6f175225a5ea46}


Definition at line 308 of file sp\+\_\+lev.\+c.



References C\+O\+L\+N\+O, F\+A\+L\+S\+E, levl, R\+O\+W\+N\+O, T\+R\+U\+E, rm\+::typ, X\+L\+I\+M, Y\+L\+I\+M, and ymax.



Referenced by create\+\_\+room(), and makelevel().


\begin{DoxyCode}
311 \{
312     \textcolor{keyword}{register} \textcolor{keywordtype}{int} x,y,hix = *lowx + *ddx, hiy = *lowy + *ddy;
313     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structrm}{rm} *lev;
314     \textcolor{keywordtype}{int} xlim, ylim, \hyperlink{mkmaze_8c_a740732a581a525ffdac6d4124d517d0e}{ymax};
315 
316     xlim = \hyperlink{sp__lev_8c_a075f60def9a4c6c70532cc1c6e91ecd7}{XLIM} + (vault ? 1 : 0);
317     ylim = \hyperlink{sp__lev_8c_a628ce4849b164cf89c658ef72eb6ac08}{YLIM} + (vault ? 1 : 0);
318 
319     \textcolor{keywordflow}{if} (*lowx < 3)      *lowx = 3;
320     \textcolor{keywordflow}{if} (*lowy < 2)      *lowy = 2;
321     \textcolor{keywordflow}{if} (hix > \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}-3) hix = \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}-3;
322     \textcolor{keywordflow}{if} (hiy > \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}-3) hiy = \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}-3;
323 chk:
324     \textcolor{keywordflow}{if} (hix <= *lowx || hiy <= *lowy)   \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
325 
326     \textcolor{comment}{/* check area around room (and make room smaller if necessary) */}
327     \textcolor{keywordflow}{for} (x = *lowx - xlim; x<= hix + xlim; x++) \{
328         \textcolor{keywordflow}{if}(x <= 0 || x >= \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}) \textcolor{keywordflow}{continue};
329         y = *lowy - ylim;   ymax = hiy + ylim;
330         \textcolor{keywordflow}{if}(y < 0) y = 0;
331         \textcolor{keywordflow}{if}(ymax >= \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}) ymax = (\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}-1);
332         lev = &\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y];
333         \textcolor{keywordflow}{for} (; y <= \hyperlink{mkmaze_8c_a740732a581a525ffdac6d4124d517d0e}{ymax}; y++) \{
334             \textcolor{keywordflow}{if} (lev++->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ}) \{
335 \textcolor{preprocessor}{#ifdef DEBUG}
336                 \textcolor{keywordflow}{if}(!vault)
337                     debugpline(\textcolor{stringliteral}{"strange area [%d,%d] in check\_room."},x,y);
338 \textcolor{preprocessor}{#endif}
339                 \textcolor{keywordflow}{if} (!rn2(3))    \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
340                 \textcolor{keywordflow}{if} (x < *lowx)
341                     *lowx = x + xlim + 1;
342                 \textcolor{keywordflow}{else}
343                     hix = x - xlim - 1;
344                 \textcolor{keywordflow}{if} (y < *lowy)
345                     *lowy = y + ylim + 1;
346                 \textcolor{keywordflow}{else}
347                     hiy = y - ylim - 1;
348                 \textcolor{keywordflow}{goto} chk;
349             \}
350         \}
351     \}
352     *ddx = hix - *lowx;
353     *ddy = hiy - *lowy;
354     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
355 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a561caa9102927221bda21ed9eb0a848e}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!create\+\_\+altar@{create\+\_\+altar}}
\index{create\+\_\+altar@{create\+\_\+altar}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{create\+\_\+altar}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void create\+\_\+altar (
\begin{DoxyParamCaption}
\item[{{\bf altar}		$\ast$}]{a, }
\item[{struct {\bf mkroom}	$\ast$}]{croom}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a561caa9102927221bda21ed9eb0a848e}


Definition at line 1084 of file sp\+\_\+lev.\+c.



References A\+\_\+\+O\+R\+I\+G\+I\+N\+A\+L, Align2amask, A\+L\+T\+A\+R, A\+M\+\_\+\+S\+H\+R\+I\+N\+E, A\+M\+\_\+\+S\+P\+L\+E\+V\+\_\+\+C\+O, A\+M\+\_\+\+S\+P\+L\+E\+V\+\_\+\+N\+O\+N\+C\+O, D\+R\+Y, F\+A\+L\+S\+E, dlevel\+\_\+t\+::flags, F\+O\+U\+N\+T\+A\+I\+N, get\+\_\+free\+\_\+room\+\_\+loc(), get\+\_\+location(), L\+A\+D\+D\+E\+R, level, levl, levelflags\+::nfountains, noncoalignment(), levelflags\+::nsinks, R\+O\+O\+M\+O\+F\+F\+S\+E\+T, rooms, mkroom\+::rtype, S\+I\+N\+K, S\+T\+A\+I\+R\+S, T\+E\+M\+P\+L\+E, T\+R\+U\+E, u, you\+::ualignbase, and you\+::uz.



Referenced by build\+\_\+room(), and load\+\_\+maze().


\begin{DoxyCode}
1087 \{
1088     \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar}      sproom,x,y;
1089     \hyperlink{align_8h_a3e17b7a656899892e425fc89481aa2ab}{aligntyp}    amask;
1090     \textcolor{keywordtype}{boolean}     croom\_is\_temple = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1091     \textcolor{keywordtype}{int} oldtyp; 
1092 
1093     x = a->\hyperlink{structaltar_ab6398c7a80fc9af8b6b8a4276af9e916}{x}; y = a->\hyperlink{structaltar_a156ee63e1d9839d71f3407c83a03f872}{y};
1094 
1095     \textcolor{keywordflow}{if} (croom) \{
1096         \hyperlink{sp__lev_8c_aeb5a8f471c788d7ca454e56c9a7d97c9}{get\_free\_room\_loc}(&x, &y, croom);
1097         \textcolor{keywordflow}{if} (croom->\hyperlink{structmkroom_a0ad2dc1a7e0527610e96e830b2cad471}{rtype} != \hyperlink{mkroom_8h_ab8c9e1bea2ae73195887ee67f76acee2}{TEMPLE})
1098         croom\_is\_temple = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1099     \} \textcolor{keywordflow}{else} \{
1100         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&x, &y, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY});
1101         \textcolor{keywordflow}{if} ((sproom = (\hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar}) *in\_rooms(x, y, \hyperlink{mkroom_8h_ab8c9e1bea2ae73195887ee67f76acee2}{TEMPLE})) != 0)
1102         croom = &\hyperlink{mkroom_8h_a45030df62e6451e79233760364dca9e1}{rooms}[sproom - \hyperlink{mkroom_8h_acc0f2416007c594c5d38f980dedc1b68}{ROOMOFFSET}];
1103         \textcolor{keywordflow}{else}
1104         croom\_is\_temple = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1105     \}
1106 
1107     \textcolor{comment}{/* check for existing features */}
1108     oldtyp = \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ;
1109     \textcolor{keywordflow}{if} (oldtyp == \hyperlink{rm_8h_a814976bdce7e0d26e78d426fdb6f1b22}{STAIRS} || oldtyp == \hyperlink{rm_8h_aa5a9eab5827d942490d37fdc9ca87ba3}{LADDER})
1110         \textcolor{keywordflow}{return};
1111 
1112     a->\hyperlink{structaltar_ab6398c7a80fc9af8b6b8a4276af9e916}{x} = x;
1113     a->\hyperlink{structaltar_a156ee63e1d9839d71f3407c83a03f872}{y} = y;
1114 
1115     \textcolor{comment}{/* Is the alignment random ?}
1116 \textcolor{comment}{     * If so, it's an 80% chance that the altar will be co-aligned.}
1117 \textcolor{comment}{     *}
1118 \textcolor{comment}{     * The alignment is encoded as amask values instead of alignment}
1119 \textcolor{comment}{     * values to avoid conflicting with the rest of the encoding,}
1120 \textcolor{comment}{     * shared by many other parts of the special level code.}
1121 \textcolor{comment}{     */}
1122 
1123     amask = (a->\hyperlink{structaltar_a93ebb60cd31f3d024f347577e68f15c8}{align} == \hyperlink{align_8h_aeee6e2bb82fb386619f405c8246540cb}{AM\_SPLEV\_CO}) ?
1124             \hyperlink{align_8h_af4a9a83eaed30042a87e25ef373b1676}{Align2amask}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a842b4c48c384af3e9a8156009f8a82ac}{ualignbase}[\hyperlink{you_8h_aadbc53a20604f260f6f2b0db9fe19b1d}{A\_ORIGINAL}]) :
1125         (a->\hyperlink{structaltar_a93ebb60cd31f3d024f347577e68f15c8}{align} == \hyperlink{align_8h_a9ca409589b44979207bfe23fc4edae0c}{AM\_SPLEV\_NONCO}) ?
1126             \hyperlink{align_8h_af4a9a83eaed30042a87e25ef373b1676}{Align2amask}(\hyperlink{sp__lev_8c_a6f4731127240a202064d8a77defa7c0b}{noncoalignment}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a842b4c48c384af3e9a8156009f8a82ac}{ualignbase}[
      \hyperlink{you_8h_aadbc53a20604f260f6f2b0db9fe19b1d}{A\_ORIGINAL}])) :
1127         (a->\hyperlink{structaltar_a93ebb60cd31f3d024f347577e68f15c8}{align} == -11) ? induced\_align(80) :
1128         (a->\hyperlink{structalign}{align} < 0 ? \hyperlink{sp__lev_8c_a2a0a619642f0bf17e690e1ab33a82b6c}{ralign}[-a->\hyperlink{structalign}{align}-1] : a->\hyperlink{structalign}{align});
1129 
1130     \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ = \hyperlink{rm_8h_ae560558ed2367969c72e77c084a07ded}{ALTAR};
1131     \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].altarmask = amask;
1132 
1133     \textcolor{keywordflow}{if} (a->\hyperlink{structaltar_a307b482c89f08c22966a37f2c88a0dbb}{shrine} < 0) a->\hyperlink{structaltar_a307b482c89f08c22966a37f2c88a0dbb}{shrine} = rn2(2);  \textcolor{comment}{/* handle random case */}
1134 
1135     \textcolor{keywordflow}{if} (oldtyp == \hyperlink{rm_8h_a88fabf28d6285490fea11089d88167ca}{FOUNTAIN})
1136         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.\hyperlink{structlevelflags_a7f3dc00cbb7517b44e77ef3156d05521}{nfountains}--;
1137     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (oldtyp == \hyperlink{rm_8h_adb1aacb84dbc34f3a142a9d7bc80f375}{SINK})
1138         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.\hyperlink{structlevelflags_a1d908af257704f05dbaae0b1c69ed24d}{nsinks}--;
1139 
1140     \textcolor{keywordflow}{if} (!croom\_is\_temple || !a->\hyperlink{structaltar_a307b482c89f08c22966a37f2c88a0dbb}{shrine}) \textcolor{keywordflow}{return};
1141 
1142     \textcolor{keywordflow}{if} (a->\hyperlink{structaltar_a307b482c89f08c22966a37f2c88a0dbb}{shrine}) \{  \textcolor{comment}{/* Is it a shrine  or sanctum? */}
1143         priestini(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}, croom, x, y, (a->\hyperlink{structaltar_a307b482c89f08c22966a37f2c88a0dbb}{shrine} > 1));
1144         \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].altarmask |= \hyperlink{rm_8h_a9c8de6ca56b5ef907390c5fa518df9ed}{AM\_SHRINE};
1145         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.has\_temple = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1146     \}
1147 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a6f7499b11516d8034a446d06dba5b6df}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!create\+\_\+corridor@{create\+\_\+corridor}}
\index{create\+\_\+corridor@{create\+\_\+corridor}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{create\+\_\+corridor}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void create\+\_\+corridor (
\begin{DoxyParamCaption}
\item[{{\bf corridor}	$\ast$}]{c}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a6f7499b11516d8034a446d06dba5b6df}


Definition at line 1420 of file sp\+\_\+lev.\+c.



References C\+O\+R\+R, dig\+\_\+corridor(), F\+A\+L\+S\+E, fix\+\_\+stair\+\_\+rooms(), makecorridors(), rooms, search\+\_\+door(), sort\+\_\+rooms(), S\+T\+O\+N\+E, W\+\_\+\+E\+A\+S\+T, W\+\_\+\+N\+O\+R\+T\+H, W\+\_\+\+S\+O\+U\+T\+H, W\+\_\+\+W\+E\+S\+T, coord\+::x, and coord\+::y.



Referenced by load\+\_\+rooms().


\begin{DoxyCode}
1422 \{
1423     \hyperlink{structcoord}{coord} org, dest;
1424 
1425     \textcolor{keywordflow}{if} (c->\hyperlink{structcorridor_acbdc58c6cb46b4ec6d65bd41c75e7f3f}{src}.\hyperlink{structcorridor_af00114170dcd0889820aa58e1e7288a0}{room} == -1) \{
1426         \hyperlink{mklev_8c_ae00f5b38164c3c9c9b5c0de3734d6a22}{sort\_rooms}();
1427         \hyperlink{sp__lev_8c_afc958f5b0e8196b52466832cb751275e}{fix\_stair\_rooms}();
1428         \hyperlink{mklev_8c_a38cd064f4323a74d0ba4b94ce68b4fa3}{makecorridors}();
1429         \textcolor{keywordflow}{return};
1430     \}
1431 
1432     \textcolor{keywordflow}{if}( !\hyperlink{sp__lev_8c_a3fa0973072ab41da6a8908299ad70f7c}{search\_door}(&\hyperlink{mkroom_8h_a45030df62e6451e79233760364dca9e1}{rooms}[c->\hyperlink{structcorridor_acbdc58c6cb46b4ec6d65bd41c75e7f3f}{src}.\hyperlink{structcorridor_af00114170dcd0889820aa58e1e7288a0}{room}], &org.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}, &org.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}, c->
      \hyperlink{structcorridor_acbdc58c6cb46b4ec6d65bd41c75e7f3f}{src}.\hyperlink{structcorridor_a07d9e210f604e30abf5c36c7d7db1b71}{wall},
1433              c->\hyperlink{structcorridor_acbdc58c6cb46b4ec6d65bd41c75e7f3f}{src}.\hyperlink{structcorridor_a1940d9ead4d121f63d1d2f817c975680}{door}))
1434         \textcolor{keywordflow}{return};
1435 
1436     \textcolor{keywordflow}{if} (c->\hyperlink{structcorridor_a5ffa6faa08a26c327a29f0ac3eaad1e1}{dest}.\hyperlink{structcorridor_af00114170dcd0889820aa58e1e7288a0}{room} != -1) \{
1437         \textcolor{keywordflow}{if}(!\hyperlink{sp__lev_8c_a3fa0973072ab41da6a8908299ad70f7c}{search\_door}(&\hyperlink{mkroom_8h_a45030df62e6451e79233760364dca9e1}{rooms}[c->\hyperlink{structcorridor_a5ffa6faa08a26c327a29f0ac3eaad1e1}{dest}.\hyperlink{structcorridor_af00114170dcd0889820aa58e1e7288a0}{room}], &dest.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}, &dest.
      \hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y},
1438                 c->\hyperlink{structcorridor_a5ffa6faa08a26c327a29f0ac3eaad1e1}{dest}.\hyperlink{structcorridor_a07d9e210f604e30abf5c36c7d7db1b71}{wall}, c->\hyperlink{structcorridor_a5ffa6faa08a26c327a29f0ac3eaad1e1}{dest}.\hyperlink{structcorridor_a1940d9ead4d121f63d1d2f817c975680}{door}))
1439             \textcolor{keywordflow}{return};
1440         \textcolor{keywordflow}{switch}(c->\hyperlink{structcorridor_acbdc58c6cb46b4ec6d65bd41c75e7f3f}{src}.\hyperlink{structcorridor_a07d9e210f604e30abf5c36c7d7db1b71}{wall}) \{
1441               \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_a5f689cb20aa2498a4213291bf63c0ea6}{W\_NORTH}: org.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}--; \textcolor{keywordflow}{break};
1442               \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_af7883dbd7a068246a1596614dbe13b96}{W\_SOUTH}: org.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}++; \textcolor{keywordflow}{break};
1443               \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_a59a97200f26ccd6a0426bb2f6384c226}{W\_WEST}:  org.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}--; \textcolor{keywordflow}{break};
1444               \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_a0733adeaa8b46ec5f371a7bfe4e79cdb}{W\_EAST}:  org.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}++; \textcolor{keywordflow}{break};
1445         \}
1446         \textcolor{keywordflow}{switch}(c->\hyperlink{structcorridor_a5ffa6faa08a26c327a29f0ac3eaad1e1}{dest}.\hyperlink{structcorridor_a07d9e210f604e30abf5c36c7d7db1b71}{wall}) \{
1447               \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_a5f689cb20aa2498a4213291bf63c0ea6}{W\_NORTH}: dest.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}--; \textcolor{keywordflow}{break};
1448               \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_af7883dbd7a068246a1596614dbe13b96}{W\_SOUTH}: dest.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}++; \textcolor{keywordflow}{break};
1449               \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_a59a97200f26ccd6a0426bb2f6384c226}{W\_WEST}:  dest.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}--; \textcolor{keywordflow}{break};
1450               \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_a0733adeaa8b46ec5f371a7bfe4e79cdb}{W\_EAST}:  dest.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}++; \textcolor{keywordflow}{break};
1451         \}
1452         (void) \hyperlink{sp__lev_8c_ad87ffe1562fb5ae4768446e053f08207}{dig\_corridor}(&org, &dest, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{rm_8h_aeffd57885964c3a9a5c3ce0f81c06339}{CORR}, \hyperlink{rm_8h_a3a50d6c3dd0fbb5b801d6efe0279d267}{STONE});
1453     \}
1454 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_ab37a25624368a78df18cdfd45c70bf35}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!create\+\_\+door@{create\+\_\+door}}
\index{create\+\_\+door@{create\+\_\+door}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{create\+\_\+door}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void create\+\_\+door (
\begin{DoxyParamCaption}
\item[{{\bf room\+\_\+door} $\ast$}]{dd, }
\item[{struct {\bf mkroom} $\ast$}]{broom}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ab37a25624368a78df18cdfd45c70bf35}


Definition at line 582 of file sp\+\_\+lev.\+c.



References add\+\_\+door(), D\+\_\+\+C\+L\+O\+S\+E\+D, D\+\_\+\+I\+S\+O\+P\+E\+N, D\+\_\+\+L\+O\+C\+K\+E\+D, D\+\_\+\+N\+O\+D\+O\+O\+R, D\+\_\+\+T\+R\+A\+P\+P\+E\+D, D\+O\+O\+R, mkroom\+::hx, mkroom\+::hy, levl, mkroom\+::lx, mkroom\+::ly, okdoor(), panic(), S\+D\+O\+O\+R, W\+\_\+\+E\+A\+S\+T, W\+\_\+\+N\+O\+R\+T\+H, W\+\_\+\+S\+O\+U\+T\+H, and W\+\_\+\+W\+E\+S\+T.



Referenced by build\+\_\+room().


\begin{DoxyCode}
585 \{
586     \textcolor{keywordtype}{int} x, y;
587     \textcolor{keywordtype}{int} trycnt = 0;
588 
589     \textcolor{keywordflow}{if} (dd->\hyperlink{structroom__door_ad5d5bcf94d0f67472c5a17c3bc8907f1}{secret} == -1)
590         dd->\hyperlink{structroom__door_ad5d5bcf94d0f67472c5a17c3bc8907f1}{secret} = rn2(2);
591 
592     \textcolor{keywordflow}{if} (dd->\hyperlink{structroom__door_a32c276de3583b9d2d505c79cccfd7456}{mask} == -1) \{
593         \textcolor{comment}{/* is it a locked door, closed, or a doorway? */}
594         \textcolor{keywordflow}{if} (!dd->\hyperlink{structroom__door_ad5d5bcf94d0f67472c5a17c3bc8907f1}{secret}) \{
595             \textcolor{keywordflow}{if}(!rn2(3)) \{
596                 \textcolor{keywordflow}{if}(!rn2(5))
597                     dd->\hyperlink{structroom__door_a32c276de3583b9d2d505c79cccfd7456}{mask} = \hyperlink{rm_8h_a2b0c9bae4b5dacb4bf4dcd784655c55d}{D\_ISOPEN};
598                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!rn2(6))
599                     dd->\hyperlink{structroom__door_a32c276de3583b9d2d505c79cccfd7456}{mask} = \hyperlink{rm_8h_a0996530515217dfd9f5e12878cb1dc8b}{D\_LOCKED};
600                 \textcolor{keywordflow}{else}
601                     dd->\hyperlink{structroom__door_a32c276de3583b9d2d505c79cccfd7456}{mask} = \hyperlink{rm_8h_a65f9ce7db71ac3d4c13edfe69732ec9a}{D\_CLOSED};
602                 \textcolor{keywordflow}{if} (dd->\hyperlink{structroom__door_a32c276de3583b9d2d505c79cccfd7456}{mask} != \hyperlink{rm_8h_a2b0c9bae4b5dacb4bf4dcd784655c55d}{D\_ISOPEN} && !rn2(25))
603                     dd->\hyperlink{structroom__door_a32c276de3583b9d2d505c79cccfd7456}{mask} |= \hyperlink{rm_8h_a8e6ade17f05acca6896948b28917e3d2}{D\_TRAPPED};
604             \} \textcolor{keywordflow}{else}
605                 dd->\hyperlink{structroom__door_a32c276de3583b9d2d505c79cccfd7456}{mask} = \hyperlink{rm_8h_a69d5ca6801252b3e635889365d7b9d28}{D\_NODOOR};
606         \} \textcolor{keywordflow}{else} \{
607             \textcolor{keywordflow}{if}(!rn2(5)) dd->\hyperlink{structroom__door_a32c276de3583b9d2d505c79cccfd7456}{mask} = \hyperlink{rm_8h_a0996530515217dfd9f5e12878cb1dc8b}{D\_LOCKED};
608             \textcolor{keywordflow}{else}        dd->\hyperlink{structroom__door_a32c276de3583b9d2d505c79cccfd7456}{mask} = \hyperlink{rm_8h_a65f9ce7db71ac3d4c13edfe69732ec9a}{D\_CLOSED};
609 
610             \textcolor{keywordflow}{if}(!rn2(20)) dd->\hyperlink{structroom__door_a32c276de3583b9d2d505c79cccfd7456}{mask} |= \hyperlink{rm_8h_a8e6ade17f05acca6896948b28917e3d2}{D\_TRAPPED};
611         \}
612     \}
613 
614     \textcolor{keywordflow}{do} \{
615         \textcolor{keyword}{register} \textcolor{keywordtype}{int} dwall, dpos;
616 
617         dwall = dd->\hyperlink{structroom__door_a13f0f81ab36e5b33140d3987f76db7a7}{wall};
618         \textcolor{keywordflow}{if} (dwall == -1)    \textcolor{comment}{/* The wall is RANDOM */}
619             dwall = 1 << rn2(4);
620 
621         dpos = dd->\hyperlink{structroom__door_abb4701d0723c3bf87ede3b5a27be2488}{pos};
622         \textcolor{keywordflow}{if} (dpos == -1) \textcolor{comment}{/* The position is RANDOM */}
623             dpos = rn2((dwall == \hyperlink{sp__lev_8h_a59a97200f26ccd6a0426bb2f6384c226}{W\_WEST} || dwall == \hyperlink{sp__lev_8h_a0733adeaa8b46ec5f371a7bfe4e79cdb}{W\_EAST}) ?
624                 (broom->\hyperlink{structmkroom_aa767bcbf6e0de868bba6d2a1c7e7182e}{hy} - broom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly}) : (broom->\hyperlink{structmkroom_a1b738b591a7735add2af6d918c556543}{hx} - broom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx}));
625 
626         \textcolor{comment}{/* Convert wall and pos into an absolute coordinate! */}
627 
628         \textcolor{keywordflow}{switch} (dwall) \{
629               \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_a5f689cb20aa2498a4213291bf63c0ea6}{W\_NORTH}:
630             y = broom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly} - 1;
631             x = broom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx} + dpos;
632             \textcolor{keywordflow}{break};
633               \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_af7883dbd7a068246a1596614dbe13b96}{W\_SOUTH}:
634             y = broom->\hyperlink{structmkroom_aa767bcbf6e0de868bba6d2a1c7e7182e}{hy} + 1;
635             x = broom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx} + dpos;
636             \textcolor{keywordflow}{break};
637               \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_a59a97200f26ccd6a0426bb2f6384c226}{W\_WEST}:
638             x = broom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx} - 1;
639             y = broom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly} + dpos;
640             \textcolor{keywordflow}{break};
641               \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_a0733adeaa8b46ec5f371a7bfe4e79cdb}{W\_EAST}:
642             x = broom->\hyperlink{structmkroom_a1b738b591a7735add2af6d918c556543}{hx} + 1;
643             y = broom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly} + dpos;
644             \textcolor{keywordflow}{break};
645               \textcolor{keywordflow}{default}:
646             x = y = 0;
647             \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"create\_door: No wall for door!"});
648             \textcolor{keywordflow}{break};
649         \}
650         \textcolor{keywordflow}{if} (\hyperlink{mklev_8c_a00f6047f9a090c068598aa919e2dba4e}{okdoor}(x,y))
651             \textcolor{keywordflow}{break};
652     \} \textcolor{keywordflow}{while} (++trycnt <= 100);
653     \textcolor{keywordflow}{if} (trycnt > 100) \{
654         impossible(\textcolor{stringliteral}{"create\_door: Can't find a proper place!"});
655         \textcolor{keywordflow}{return};
656     \}
657     \hyperlink{mklev_8c_abfbeba318d849971ade63038b45c638e}{add\_door}(x,y,broom);
658     \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ = (dd->\hyperlink{structroom__door_ad5d5bcf94d0f67472c5a17c3bc8907f1}{secret} ? \hyperlink{rm_8h_a03fd0fa1e0dbd19ea38dff0c79e656a5}{SDOOR} : \hyperlink{rm_8h_aa19093eb0aa5c5af9c27464ae8f0d2de}{DOOR});
659     \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].doormask = dd->\hyperlink{structroom__door_a32c276de3583b9d2d505c79cccfd7456}{mask};
660 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_aa6f18cdee6178a2d1935e54bf7615479}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!create\+\_\+engraving@{create\+\_\+engraving}}
\index{create\+\_\+engraving@{create\+\_\+engraving}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{create\+\_\+engraving}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void create\+\_\+engraving (
\begin{DoxyParamCaption}
\item[{{\bf engraving} $\ast$}]{e, }
\item[{struct {\bf mkroom} $\ast$}]{croom}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_aa6f18cdee6178a2d1935e54bf7615479}


Definition at line 1046 of file sp\+\_\+lev.\+c.



References D\+R\+Y, free(), get\+\_\+location(), and get\+\_\+room\+\_\+loc().



Referenced by build\+\_\+room(), and load\+\_\+maze().


\begin{DoxyCode}
1049 \{
1050     \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} x, y;
1051 
1052     x = e->\hyperlink{structengraving_a8f28b49b2f2b90a9227855bdbb4de2ab}{x},  y = e->\hyperlink{structengraving_a1b6846c11b9bcac6198bcb904a4f531f}{y};
1053     \textcolor{keywordflow}{if} (croom)
1054         \hyperlink{sp__lev_8c_a7000c03207527bca2d559ff449c49c9b}{get\_room\_loc}(&x, &y, croom);
1055     \textcolor{keywordflow}{else}
1056         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&x, &y, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY});
1057 
1058     make\_engr\_at(x, y, e->\hyperlink{structengraving_a1255139d50d1e9e12a229d32a0422ae8}{engr}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str}, 0L, e->\hyperlink{structengraving_a03aa435dd8c489b0803f9f4a10ef92b2}{etype});
1059     \hyperlink{winproto_8h_a4bbec68d324de17b99fecede64b383ba}{free}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) e->\hyperlink{structengraving_a1255139d50d1e9e12a229d32a0422ae8}{engr}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str});
1060 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_ad7f4c8a0d48ccd9bc4ed7126aa6a1ca5}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!create\+\_\+feature@{create\+\_\+feature}}
\index{create\+\_\+feature@{create\+\_\+feature}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{create\+\_\+feature}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void create\+\_\+feature (
\begin{DoxyParamCaption}
\item[{int}]{fx, }
\item[{int}]{fy, }
\item[{struct {\bf mkroom}	$\ast$}]{croom, }
\item[{int}]{typ}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ad7f4c8a0d48ccd9bc4ed7126aa6a1ca5}


Definition at line 1176 of file sp\+\_\+lev.\+c.



References D\+R\+Y, dlevel\+\_\+t\+::flags, F\+O\+U\+N\+T\+A\+I\+N, get\+\_\+location(), get\+\_\+room\+\_\+loc(), I\+S\+\_\+\+F\+U\+R\+N\+I\+T\+U\+R\+E, level, levl, levelflags\+::nfountains, levelflags\+::nsinks, occupied(), and S\+I\+N\+K.



Referenced by build\+\_\+room(), and load\+\_\+maze().


\begin{DoxyCode}
1180 \{
1181     \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar}      x,y;
1182     \textcolor{keywordtype}{int}     trycnt = 0;
1183 
1184     x = fx;  y = fy;
1185     \textcolor{keywordflow}{if} (croom) \{
1186         \textcolor{keywordflow}{if} (x < 0 && y < 0)
1187         \textcolor{keywordflow}{do} \{
1188             x = -1;  y = -1;
1189             \hyperlink{sp__lev_8c_a7000c03207527bca2d559ff449c49c9b}{get\_room\_loc}(&x, &y, croom);
1190         \} \textcolor{keywordflow}{while} (++trycnt <= 200 && \hyperlink{mklev_8c_a6d2eb7d66d955a58567e29162cc8e371}{occupied}(x,y));
1191         \textcolor{keywordflow}{else}
1192         \hyperlink{sp__lev_8c_a7000c03207527bca2d559ff449c49c9b}{get\_room\_loc}(&x, &y, croom);
1193         \textcolor{keywordflow}{if}(trycnt > 200)
1194         \textcolor{keywordflow}{return};
1195     \} \textcolor{keywordflow}{else} \{
1196         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&x, &y, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY});
1197     \}
1198     \textcolor{comment}{/* Don't cover up an existing feature (particularly randomly}
1199 \textcolor{comment}{       placed stairs).  However, if the \_same\_ feature is already}
1200 \textcolor{comment}{       here, it came from the map drawing and we still need to}
1201 \textcolor{comment}{       update the special counters. */}
1202     \textcolor{keywordflow}{if} (\hyperlink{rm_8h_a45d6f42899b65732f3784e37e713773f}{IS\_FURNITURE}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ}) && \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ != typ)
1203         \textcolor{keywordflow}{return};
1204 
1205     \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ = \hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ};
1206     \textcolor{keywordflow}{if} (typ == \hyperlink{rm_8h_a88fabf28d6285490fea11089d88167ca}{FOUNTAIN})
1207         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.\hyperlink{structlevelflags_a7f3dc00cbb7517b44e77ef3156d05521}{nfountains}++;
1208     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (typ == \hyperlink{rm_8h_adb1aacb84dbc34f3a142a9d7bc80f375}{SINK})
1209         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.\hyperlink{structlevelflags_a1d908af257704f05dbaae0b1c69ed24d}{nsinks}++;
1210 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a0f75fda68777d83b6cab992aa7778bf2}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!create\+\_\+gold@{create\+\_\+gold}}
\index{create\+\_\+gold@{create\+\_\+gold}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{create\+\_\+gold}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void create\+\_\+gold (
\begin{DoxyParamCaption}
\item[{{\bf gold} $\ast$}]{g, }
\item[{struct {\bf mkroom}	$\ast$}]{croom}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a0f75fda68777d83b6cab992aa7778bf2}


Definition at line 1154 of file sp\+\_\+lev.\+c.



References D\+R\+Y, get\+\_\+location(), and get\+\_\+room\+\_\+loc().



Referenced by build\+\_\+room(), and load\+\_\+maze().


\begin{DoxyCode}
1157 \{
1158     \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar}      x,y;
1159 
1160     x = g->\hyperlink{structgold_abaa43c4f80e6054cda72314ca7928876}{x}; y= g->\hyperlink{structgold_a1fe44e270a7b537b490afa2151efd436}{y};
1161     \textcolor{keywordflow}{if} (croom)
1162         \hyperlink{sp__lev_8c_a7000c03207527bca2d559ff449c49c9b}{get\_room\_loc}(&x, &y, croom);
1163     \textcolor{keywordflow}{else}
1164         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&x, &y, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY});
1165 
1166     \textcolor{keywordflow}{if} (g->\hyperlink{structgold_acc8afa075b6fc7f2d698b5d6d34f2b75}{amount} == -1)
1167         g->\hyperlink{structgold_acc8afa075b6fc7f2d698b5d6d34f2b75}{amount} = rnd(200);
1168     (void) mkgold((\textcolor{keywordtype}{long}) g->\hyperlink{structgold_acc8afa075b6fc7f2d698b5d6d34f2b75}{amount}, x, y);
1169 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_ac4ba802065a2fdec996f8401dddc89f7}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!create\+\_\+monster@{create\+\_\+monster}}
\index{create\+\_\+monster@{create\+\_\+monster}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{create\+\_\+monster}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void create\+\_\+monster (
\begin{DoxyParamCaption}
\item[{{\bf monster}	$\ast$}]{m, }
\item[{struct {\bf mkroom}	$\ast$}]{croom}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ac4ba802065a2fdec996f8401dddc89f7}


Definition at line 747 of file sp\+\_\+lev.\+c.



References A\+\_\+\+O\+R\+I\+G\+I\+N\+A\+L, Align2amask, A\+M\+\_\+\+S\+P\+L\+E\+V\+\_\+\+C\+O, A\+M\+\_\+\+S\+P\+L\+E\+V\+\_\+\+N\+O\+N\+C\+O, Amask2align, block\+\_\+point(), monst\+::data, defsyms, does\+\_\+block(), D\+R\+Y, enexto(), F\+A\+L\+S\+E, Free, G\+\_\+\+E\+X\+T\+I\+N\+C\+T, G\+\_\+\+G\+O\+N\+E, G\+\_\+\+N\+O\+G\+E\+N, G\+\_\+\+U\+N\+I\+Q, permonst\+::geno, get\+\_\+location(), get\+\_\+room\+\_\+loc(), is\+\_\+swimmer, levl, M\+\_\+\+A\+P\+\_\+\+F\+U\+R\+N\+I\+T\+U\+R\+E, M\+\_\+\+A\+P\+\_\+\+M\+O\+N\+S\+T\+E\+R, M\+\_\+\+A\+P\+\_\+\+N\+O\+T\+H\+I\+N\+G, M\+\_\+\+A\+P\+\_\+\+O\+B\+J\+E\+C\+T, monst\+::m\+\_\+ap\+\_\+type, monst\+::mappearance, M\+A\+X\+M\+C\+L\+A\+S\+S\+E\+S, M\+A\+X\+P\+C\+H\+A\+R\+S, mk\+\_\+mplayer(), permonst\+::mlet, M\+O\+N\+\_\+\+A\+T, mons, mvitals\+::mvflags, N\+O\+\_\+\+M\+M\+\_\+\+F\+L\+A\+G\+S, N\+O\+N\+\_\+\+P\+M, noncoalignment(), O\+B\+J\+\_\+\+N\+A\+M\+E, objects, panic(), Race\+\_\+if, S\+\_\+\+E\+E\+L, S\+\_\+\+M\+I\+M\+I\+C, u, you\+::ualignbase, you\+::uz, W\+E\+T, coord\+::x, coord\+::y, and your\+\_\+race.



Referenced by build\+\_\+room(), and load\+\_\+maze().


\begin{DoxyCode}
750 \{
751     \textcolor{keyword}{struct }\hyperlink{structmonst}{monst} *mtmp;
752     \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} x, y;
753     \textcolor{keywordtype}{char} \textcolor{keyword}{class};
754     \hyperlink{align_8h_a3e17b7a656899892e425fc89481aa2ab}{aligntyp} amask;
755     \hyperlink{structcoord}{coord} cc;
756     \textcolor{keyword}{struct }\hyperlink{structpermonst}{permonst} *pm;
757     \textcolor{keywordtype}{unsigned} g\_mvflags;
758 
759     \textcolor{keywordflow}{if} (rn2(100) < m->\hyperlink{structmonster_ae5fb6db682fc3fd0c092b366759e18f5}{chance}) \{
760 
761     \textcolor{keywordflow}{if} (m->\hyperlink{structmonster_a4b3f5c37c4152aa7007f9973c816912e}{class} >= 0)
762         \textcolor{keyword}{class }= (char) \hyperlink{drawing_8c_a96d46e83653ce0f583dbced270cdf106}{def\_char\_to\_monclass}((char)m->class);
763     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m->\hyperlink{structmonster_a4b3f5c37c4152aa7007f9973c816912e}{class} > -11)
764         \textcolor{keyword}{class }= (char) \hyperlink{drawing_8c_a96d46e83653ce0f583dbced270cdf106}{def\_char\_to\_monclass}(\hyperlink{sp__lev_8c_af35c3f24113af660b5d6e6b4105032e0}{rmonst}[- m->class - 1]);
765     \textcolor{keywordflow}{else}
766         \textcolor{keyword}{class }= 0;
767 
768     \textcolor{keywordflow}{if} (\textcolor{keyword}{class} == \hyperlink{monsym_8h_a8c6bb361baecfba17240e1e0af655e1b}{MAXMCLASSES})
769         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"create\_monster: unknown monster class '%c'"}, m->\hyperlink{structmonster_a4b3f5c37c4152aa7007f9973c816912e}{class});
770 
771     amask = (m->\hyperlink{structmonster_a9572ac33b3cb42a51567421458c44ce6}{align} == \hyperlink{align_8h_aeee6e2bb82fb386619f405c8246540cb}{AM\_SPLEV\_CO}) ?
772             \hyperlink{align_8h_af4a9a83eaed30042a87e25ef373b1676}{Align2amask}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a842b4c48c384af3e9a8156009f8a82ac}{ualignbase}[\hyperlink{you_8h_aadbc53a20604f260f6f2b0db9fe19b1d}{A\_ORIGINAL}]) :
773         (m->\hyperlink{structmonster_a9572ac33b3cb42a51567421458c44ce6}{align} == \hyperlink{align_8h_a9ca409589b44979207bfe23fc4edae0c}{AM\_SPLEV\_NONCO}) ?
774             \hyperlink{align_8h_af4a9a83eaed30042a87e25ef373b1676}{Align2amask}(\hyperlink{sp__lev_8c_a6f4731127240a202064d8a77defa7c0b}{noncoalignment}(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a842b4c48c384af3e9a8156009f8a82ac}{ualignbase}[
      \hyperlink{you_8h_aadbc53a20604f260f6f2b0db9fe19b1d}{A\_ORIGINAL}])) :
775         (m->\hyperlink{structmonster_a9572ac33b3cb42a51567421458c44ce6}{align} <= -11) ? induced\_align(80) :
776         (m->\hyperlink{structalign}{align} < 0 ? \hyperlink{sp__lev_8c_a2a0a619642f0bf17e690e1ab33a82b6c}{ralign}[-m->\hyperlink{structalign}{align}-1] : m->\hyperlink{structalign}{align});
777 
778     \textcolor{keywordflow}{if} (!\textcolor{keyword}{class})
779         pm = (\textcolor{keyword}{struct }\hyperlink{structpermonst}{permonst} *) 0;
780     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m->\hyperlink{structmonster_a0f93873707206ac7f13bc2463bc0ad3b}{id} != \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM}) \{
781         pm = &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[m->\hyperlink{structmonster_a0f93873707206ac7f13bc2463bc0ad3b}{id}];
782         g\_mvflags = (unsigned) \hyperlink{structmvitals}{mvitals}[monsndx(pm)].\hyperlink{structmvitals_a51369b55e24dc02d3f5768b8f5b01381}{mvflags};
783         \textcolor{keywordflow}{if} ((pm->\hyperlink{structpermonst_a0f9f93635f6228a61551c835640b3c1d}{geno} & \hyperlink{monflag_8h_ab99532c9310183c20279ce79e7f594dd}{G\_UNIQ}) && (g\_mvflags & \hyperlink{monflag_8h_a6f4a7d5b60b0d1cdd5e5a194cfcc5cc3}{G\_EXTINCT}))
784         \textcolor{keywordflow}{goto} m\_done;
785         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (g\_mvflags & \hyperlink{monflag_8h_ad600313e20617adbf44819cf9707971a}{G\_GONE})  \textcolor{comment}{/* genocided or extinct */}
786         pm = (\textcolor{keyword}{struct }\hyperlink{structpermonst}{permonst} *) 0; \textcolor{comment}{/* make random monster */}
787     \} \textcolor{keywordflow}{else} \{
788         pm = mkclass(\textcolor{keyword}{class},\hyperlink{monflag_8h_a4958e656bfb1881e0d63df942488b1fd}{G\_NOGEN});
789         \textcolor{comment}{/* if we can't get a specific monster type (pm == 0) then the}
790 \textcolor{comment}{           class has been genocided, so settle for a random monster */}
791     \}
792     \textcolor{keywordflow}{if} (In\_mines(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}) && pm && \hyperlink{mondata_8h_a620adc730907c7d05a67956897fc4bcb}{your\_race}(pm) &&
793             (\hyperlink{you_8h_ac1b9b8d9c3387e3d3a36b9474945879c}{Race\_if}(PM\_DWARF) || \hyperlink{you_8h_ac1b9b8d9c3387e3d3a36b9474945879c}{Race\_if}(PM\_GNOME)) && rn2(3))
794         pm = (\textcolor{keyword}{struct }\hyperlink{structpermonst}{permonst} *) 0;
795 
796     x = m->\hyperlink{structmonster_a2af2a4a4778c20fadc588e1975548be1}{x};
797     y = m->\hyperlink{structmonster_ab070466d620bc4927de04afaaf9d362b}{y};
798     \textcolor{keywordflow}{if} (croom)
799         \hyperlink{sp__lev_8c_a7000c03207527bca2d559ff449c49c9b}{get\_room\_loc}(&x, &y, croom);
800     \textcolor{keywordflow}{else} \{
801         \textcolor{keywordflow}{if} (!pm || !\hyperlink{mondata_8h_ab8ffd447c2b8217b49848268e2b6493d}{is\_swimmer}(pm))
802         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&x, &y, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY});
803         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (pm->\hyperlink{structpermonst_ab402dbf1bed9d0e595a2b3da6558da92}{mlet} == \hyperlink{monsym_8h_a07cd4c997171ec30fbe1376341a26160}{S\_EEL})
804         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&x, &y, \hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{WET});
805         \textcolor{keywordflow}{else}
806         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&x, &y, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY}|\hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{WET});
807     \}
808     \textcolor{comment}{/* try to find a close place if someone else is already there */}
809     \textcolor{keywordflow}{if} (\hyperlink{rm_8h_a17ef631151b987fd582fca76a429c08a}{MON\_AT}(x,y) && \hyperlink{teleport_8c_a61ffc1bbdf6259d46ae8abd0dce3ce31}{enexto}(&cc, x, y, pm))
810         x = cc.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x},  y = cc.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y};
811 
812     \textcolor{keywordflow}{if}(m->\hyperlink{structmonster_a9572ac33b3cb42a51567421458c44ce6}{align} != -12)
813         mtmp = mk\_roamer(pm, \hyperlink{align_8h_a66f124a6eb13a3c3432946891aedcba4}{Amask2align}(amask), x, y, m->\hyperlink{structmonster_aebb89be3760164c80425bf7d87795809}{peaceful});
814     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(PM\_ARCHEOLOGIST <= m->\textcolor{keywordtype}{id} && m->\hyperlink{structmonster_a0f93873707206ac7f13bc2463bc0ad3b}{id} <= PM\_WIZARD)
815              mtmp = \hyperlink{mplayer_8c_ac08b2beba47b592806724a9ee4f346bd}{mk\_mplayer}(pm, x, y, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
816     \textcolor{keywordflow}{else} mtmp = makemon(pm, x, y, \hyperlink{hack_8h_ae449582f467baa0da531a6ea116a18f2}{NO\_MM\_FLAGS});
817 
818     \textcolor{keywordflow}{if} (mtmp) \{
819         \textcolor{comment}{/* handle specific attributes for some special monsters */}
820         \textcolor{keywordflow}{if} (m->\hyperlink{structmonster_aaa15fa26f0d72ddcd172dd3309791e87}{name}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str}) mtmp = christen\_monst(mtmp, m->\hyperlink{structmonster_aaa15fa26f0d72ddcd172dd3309791e87}{name}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str});
821 
822         \textcolor{comment}{/*}
823 \textcolor{comment}{         * This is currently hardwired for mimics only.  It should}
824 \textcolor{comment}{         * eventually be expanded.}
825 \textcolor{comment}{         */}
826         \textcolor{keywordflow}{if} (m->\hyperlink{structmonster_a5aee88b4ae76f77c49e9909cb019cd13}{appear\_as}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str} && mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ab402dbf1bed9d0e595a2b3da6558da92}{mlet} == \hyperlink{monsym_8h_ad8b9f73f4b42e8250eb5a69a12482436}{S\_MIMIC}) \{
827         \textcolor{keywordtype}{int} i;
828 
829         \textcolor{keywordflow}{switch} (m->\hyperlink{structmonster_a464f427d9d531bc63c569d3033bf552f}{appear}) \{
830             \textcolor{keywordflow}{case} \hyperlink{monst_8h_a58db2fb11cfd7427581d698582b9a386}{M\_AP\_NOTHING}:
831             impossible(
832         \textcolor{stringliteral}{"create\_monster: mon has an appearance, \(\backslash\)"%s\(\backslash\)", but no type"},
833                 m->\hyperlink{structmonster_a5aee88b4ae76f77c49e9909cb019cd13}{appear\_as}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str});
834             \textcolor{keywordflow}{break};
835 
836             \textcolor{keywordflow}{case} \hyperlink{monst_8h_a3470d5a82b5711ec2b38fb153c3eab2f}{M\_AP\_FURNITURE}:
837             \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{rm_8h_a472435b302b91eba97d406b38399506f}{MAXPCHARS}; i++)
838                 \textcolor{keywordflow}{if} (!strcmp(\hyperlink{rm_8h_a207dbacb240eb4a71d449e59280a72a6}{defsyms}[i].explanation,
839                     m->\hyperlink{structmonster_a5aee88b4ae76f77c49e9909cb019cd13}{appear\_as}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str}))
840                 \textcolor{keywordflow}{break};
841             \textcolor{keywordflow}{if} (i == MAXPCHARS) \{
842                 impossible(
843                 \textcolor{stringliteral}{"create\_monster: can't find feature \(\backslash\)"%s\(\backslash\)""},
844                 m->\hyperlink{structmonster_a5aee88b4ae76f77c49e9909cb019cd13}{appear\_as}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str});
845             \} \textcolor{keywordflow}{else} \{
846                 mtmp->\hyperlink{structmonst_aab8fc9a0be90b4db8333b09487e2620c}{m\_ap\_type} = \hyperlink{monst_8h_a3470d5a82b5711ec2b38fb153c3eab2f}{M\_AP\_FURNITURE};
847                 mtmp->\hyperlink{structmonst_a60ba74caeb4e779b7ccdb99150823bb9}{mappearance} = i;
848             \}
849             \textcolor{keywordflow}{break};
850 
851             \textcolor{keywordflow}{case} \hyperlink{monst_8h_a398e3dada51d63d91d8d9a6fb3f90c62}{M\_AP\_OBJECT}:
852             \textcolor{keywordflow}{for} (i = 0; i < NUM\_OBJECTS; i++)
853                 \textcolor{keywordflow}{if} (\hyperlink{objclass_8h_aaa71280f2bfe02894ab8c39af548d6ae}{OBJ\_NAME}(\hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[i]) &&
854                 !strcmp(\hyperlink{objclass_8h_aaa71280f2bfe02894ab8c39af548d6ae}{OBJ\_NAME}(\hyperlink{objclass_8h_a6fc960ca847bc1bef7559abb7bf29209}{objects}[i]),m->\hyperlink{structmonster_a5aee88b4ae76f77c49e9909cb019cd13}{appear\_as}.
      \hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str}))
855                 \textcolor{keywordflow}{break};
856             \textcolor{keywordflow}{if} (i == NUM\_OBJECTS) \{
857                 impossible(
858                 \textcolor{stringliteral}{"create\_monster: can't find object \(\backslash\)"%s\(\backslash\)""},
859                 m->\hyperlink{structmonster_a5aee88b4ae76f77c49e9909cb019cd13}{appear\_as}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str});
860             \} \textcolor{keywordflow}{else} \{
861                 mtmp->\hyperlink{structmonst_aab8fc9a0be90b4db8333b09487e2620c}{m\_ap\_type} = \hyperlink{monst_8h_a398e3dada51d63d91d8d9a6fb3f90c62}{M\_AP\_OBJECT};
862                 mtmp->\hyperlink{structmonst_a60ba74caeb4e779b7ccdb99150823bb9}{mappearance} = i;
863             \}
864             \textcolor{keywordflow}{break};
865 
866             \textcolor{keywordflow}{case} \hyperlink{monst_8h_ac3674020cb0ffbb50a783e53e76e21f4}{M\_AP\_MONSTER}:
867             \textcolor{comment}{/* note: mimics don't appear as monsters! */}
868             \textcolor{comment}{/*   (but chameleons can :-)      */}
869             \textcolor{keywordflow}{default}:
870             impossible(
871         \textcolor{stringliteral}{"create\_monster: unimplemented mon appear type [%d,\(\backslash\)"%s\(\backslash\)"]"},
872                 m->\hyperlink{structmonster_a464f427d9d531bc63c569d3033bf552f}{appear}, m->\hyperlink{structmonster_a5aee88b4ae76f77c49e9909cb019cd13}{appear\_as}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str});
873             \textcolor{keywordflow}{break};
874         \}
875         \textcolor{keywordflow}{if} (\hyperlink{vision_8c_a80edeba01340113e1d35f39debfd42a3}{does\_block}(x, y, &\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y]))
876             \hyperlink{vision_8c_ae985a63b19aa1a0a81fa91b46972e27e}{block\_point}(x, y);
877         \}
878 
879         \textcolor{keywordflow}{if} (m->\hyperlink{structmonster_aebb89be3760164c80425bf7d87795809}{peaceful} >= 0) \{
880         mtmp->mpeaceful = m->\hyperlink{structmonster_aebb89be3760164c80425bf7d87795809}{peaceful};
881         \textcolor{comment}{/* changed mpeaceful again; have to reset malign */}
882         set\_malign(mtmp);
883         \}
884         \textcolor{keywordflow}{if} (m->\hyperlink{structmonster_a8fd73840258e9cc6bb1f68e99b4a2fbd}{asleep} >= 0) \{
885 \textcolor{preprocessor}{#ifdef UNIXPC}
886         \textcolor{comment}{/* optimizer bug strikes again */}
887         \textcolor{keywordflow}{if} (m->\hyperlink{structmonster_a8fd73840258e9cc6bb1f68e99b4a2fbd}{asleep})
888             mtmp->msleeping = 1;
889         \textcolor{keywordflow}{else}
890             mtmp->msleeping = 0;
891 \textcolor{preprocessor}{#else}
892         mtmp->msleeping = m->\hyperlink{structmonster_a8fd73840258e9cc6bb1f68e99b4a2fbd}{asleep};
893 \textcolor{preprocessor}{#endif}
894         \}
895     \}
896 
897     \}       \textcolor{comment}{/* if (rn2(100) < m->chance) */}
898  m\_done:
899     \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(m->\hyperlink{structmonster_aaa15fa26f0d72ddcd172dd3309791e87}{name}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str});
900     \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(m->\hyperlink{structmonster_a5aee88b4ae76f77c49e9909cb019cd13}{appear\_as}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str});
901 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a98e854541b8194eb7b6337417e4b76fc}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!create\+\_\+object@{create\+\_\+object}}
\index{create\+\_\+object@{create\+\_\+object}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{create\+\_\+object}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void create\+\_\+object (
\begin{DoxyParamCaption}
\item[{{\bf object}	$\ast$}]{o, }
\item[{struct {\bf mkroom}	$\ast$}]{croom}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a98e854541b8194eb7b6337417e4b76fc}


Definition at line 908 of file sp\+\_\+lev.\+c.



References C\+O\+I\+N\+\_\+\+C\+L\+A\+S\+S, obj\+::corpsenm, def\+\_\+char\+\_\+to\+\_\+objclass(), D\+R\+Y, F\+A\+L\+S\+E, Free, get\+\_\+location(), get\+\_\+room\+\_\+loc(), Is\+\_\+medusa\+\_\+level, M\+A\+X\+O\+C\+L\+A\+S\+S\+E\+S, monst\+::minvent, mons, N\+O\+\_\+\+M\+M\+\_\+\+F\+L\+A\+G\+S, N\+O\+N\+\_\+\+P\+M, obj\+::oclass, otmp, obj\+::otyp, obj\+::owornmask, obj\+::owt, panic(), R\+A\+N\+D\+O\+M\+\_\+\+C\+L\+A\+S\+S, resists\+\_\+ston, obj\+::spe, T\+R\+U\+E, u, and you\+::uz.



Referenced by build\+\_\+room(), and load\+\_\+maze().


\begin{DoxyCode}
911 \{
912     \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp};
913     \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} x, y;
914     \textcolor{keywordtype}{char} c;
915     \textcolor{keywordtype}{boolean} named;  \textcolor{comment}{/* has a name been supplied in level description? */}
916 
917     \textcolor{keywordflow}{if} (rn2(100) < o->\hyperlink{structobject_ad3bcfb453ef8a5f6d3d98f1e6a7272f1}{chance}) \{
918     named = o->\hyperlink{structobject_acce2482cb9701001d8f378d3bfbdb8f6}{name}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str} ? \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} : \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
919 
920     x = o->\hyperlink{structobject_a33ab5ab578cd508e56751a631c232844}{x}; y = o->\hyperlink{structobject_ae2675b3ffe08b822d9e74e97fa663a39}{y};
921     \textcolor{keywordflow}{if} (croom)
922         \hyperlink{sp__lev_8c_a7000c03207527bca2d559ff449c49c9b}{get\_room\_loc}(&x, &y, croom);
923     \textcolor{keywordflow}{else}
924         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&x, &y, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY});
925 
926     \textcolor{keywordflow}{if} (o->\hyperlink{structobject_a5450b696036bcd71d636be3e98508a72}{class} >= 0)
927         c = o->\hyperlink{structobject_a5450b696036bcd71d636be3e98508a72}{class};
928     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (o->\hyperlink{structobject_a5450b696036bcd71d636be3e98508a72}{class} > -11)
929         c = \hyperlink{sp__lev_8c_a4c62499de047bc3a15f32e4f14c00c66}{robjects}[ -(o->\hyperlink{structobject_a5450b696036bcd71d636be3e98508a72}{class}+1)];
930     \textcolor{keywordflow}{else}
931         c = 0;
932 
933     \textcolor{keywordflow}{if} (!c)
934         otmp = mkobj\_at(\hyperlink{objclass_8h_ac72b41688ea83d87d0b4143899a9b0d7}{RANDOM\_CLASS}, x, y, !named);
935     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (o->\hyperlink{structobject_a89b27835790711d028e57faf65818b57}{id} != -1)
936         otmp = mksobj\_at(o->\hyperlink{structobject_a89b27835790711d028e57faf65818b57}{id}, x, y, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, !named);
937     \textcolor{keywordflow}{else} \{
938         \textcolor{comment}{/*}
939 \textcolor{comment}{         * The special levels are compiled with the default "text" object}
940 \textcolor{comment}{         * class characters.  We must convert them to the internal format.}
941 \textcolor{comment}{         */}
942         \textcolor{keywordtype}{char} \hyperlink{structobj_a716ba3ee00602dede9ea5c68c74d45bd}{oclass} = (char) \hyperlink{drawing_8c_a590c649cc5a0ec129bc65368e7202b55}{def\_char\_to\_objclass}(c);
943 
944         \textcolor{keywordflow}{if} (oclass == \hyperlink{objclass_8h_af51133138bfb718b55aaa7f29711a10a}{MAXOCLASSES})
945         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"create\_object:  unexpected object class '%c'"},c);
946 
947         \textcolor{comment}{/* KMH -- Create piles of gold properly */}
948         \textcolor{keywordflow}{if} (oclass == \hyperlink{objclass_8h_a2999621925083659147349e261e4cb3d}{COIN\_CLASS})
949         otmp = mkgold(0L, x, y);
950         \textcolor{keywordflow}{else}
951         otmp = mkobj\_at(oclass, x, y, !named);
952     \}
953 
954     \textcolor{keywordflow}{if} (o->\hyperlink{structobject_ad788b20b1a3ad90f77344c4c6d7ecb09}{spe} != -127)  \textcolor{comment}{/* That means NOT RANDOM! */}
955         otmp->\hyperlink{structobj_a14fc8dc59e9073bfbf1e170875a98448}{spe} = (\hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar})o->\hyperlink{structobject_ad788b20b1a3ad90f77344c4c6d7ecb09}{spe};
956 
957     switch (o->\hyperlink{structobject_a2a59500b53e0d54f2ee8b74139a984d5}{curse\_state}) \{
958           \textcolor{keywordflow}{case} 1:   bless(otmp); \textcolor{keywordflow}{break}; \textcolor{comment}{/* BLESSED */}
959           \textcolor{keywordflow}{case} 2:   unbless(otmp); uncurse(otmp); \textcolor{keywordflow}{break}; \textcolor{comment}{/* uncursed */}
960           \textcolor{keywordflow}{case} 3:   curse(otmp); \textcolor{keywordflow}{break}; \textcolor{comment}{/* CURSED */}
961           \textcolor{keywordflow}{default}:  \textcolor{keywordflow}{break};  \textcolor{comment}{/* Otherwise it's random and we're happy}
962 \textcolor{comment}{                 * with what mkobj gave us! */}
963     \}
964 
965     \textcolor{comment}{/*  corpsenm is "empty" if -1, random if -2, otherwise specific */}
966     \textcolor{keywordflow}{if} (o->\hyperlink{structobject_af0d57d60659d214f46dee12f33858b4e}{corpsenm} == \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM} - 1) otmp->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm} = rndmonnum();
967     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (o->\hyperlink{structobject_af0d57d60659d214f46dee12f33858b4e}{corpsenm} != \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM}) otmp->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm} = o->
      \hyperlink{structobject_af0d57d60659d214f46dee12f33858b4e}{corpsenm};
968 
969     \textcolor{comment}{/* assume we wouldn't be given an egg corpsenm unless it was}
970 \textcolor{comment}{       hatchable */}
971     \textcolor{keywordflow}{if} (otmp->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp} == EGG && otmp->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm} != \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM}) \{
972         \textcolor{keywordflow}{if} (dead\_species(otmp->\hyperlink{structobj_a95eb282afebd3599996035e8aab71751}{otyp}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}))
973         kill\_egg(otmp); \textcolor{comment}{/* make sure nothing hatches */}
974         \textcolor{keywordflow}{else}
975         attach\_egg\_hatch\_timeout(otmp); \textcolor{comment}{/* attach new hatch timeout */}
976     \}
977 
978     \textcolor{keywordflow}{if} (named)
979         otmp = oname(otmp, o->\hyperlink{structobject_acce2482cb9701001d8f378d3bfbdb8f6}{name}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str});
980 
981     \textcolor{keywordflow}{switch}(o->\hyperlink{structobject_a787b3970195160628997c28e50e448f2}{containment}) \{
982         \textcolor{keyword}{static} \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{structcontainer}{container} = 0;
983 
984         \textcolor{comment}{/* contents */}
985         \textcolor{keywordflow}{case} 1:
986         \textcolor{keywordflow}{if} (!container) \{
987             impossible(\textcolor{stringliteral}{"create\_object: no container"});
988             \textcolor{keywordflow}{break};
989         \}
990         remove\_object(otmp);
991         (void) add\_to\_container(container, otmp);
992         \textcolor{keywordflow}{goto} o\_done;        \textcolor{comment}{/* don't stack, but do other cleanup */}
993         \textcolor{comment}{/* container */}
994         \textcolor{keywordflow}{case} 2:
995         delete\_contents(otmp);
996         container = \hyperlink{mhitu_8c_a8cf94e09e1a72daf7050a2817ba70974}{otmp};
997         \textcolor{keywordflow}{break};
998         \textcolor{comment}{/* nothing */}
999         \textcolor{keywordflow}{case} 0: \textcolor{keywordflow}{break};
1000 
1001         \textcolor{keywordflow}{default}: impossible(\textcolor{stringliteral}{"containment type %d?"}, (\textcolor{keywordtype}{int}) o->\hyperlink{structobject_a787b3970195160628997c28e50e448f2}{containment});
1002     \}
1003 
1004     \textcolor{comment}{/* Medusa level special case: statues are petrified monsters, so they}
1005 \textcolor{comment}{     * are not stone-resistant and have monster inventory.  They also lack}
1006 \textcolor{comment}{     * other contents, but that can be specified as an empty container.}
1007 \textcolor{comment}{     */}
1008     \textcolor{keywordflow}{if} (o->\hyperlink{structobject_a89b27835790711d028e57faf65818b57}{id} == STATUE && \hyperlink{dungeon_8h_a577154aa517f59b492b3443a753c7a9a}{Is\_medusa\_level}(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}) &&
1009             o->\hyperlink{structobject_af0d57d60659d214f46dee12f33858b4e}{corpsenm} == \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM}) \{
1010         \textcolor{keyword}{struct }\hyperlink{structmonst}{monst} *was;
1011         \textcolor{keyword}{struct }\hyperlink{structobj}{obj} *\hyperlink{structobj}{obj};
1012         \textcolor{keywordtype}{int} wastyp;
1013 
1014         \textcolor{comment}{/* Named random statues are of player types, and aren't stone-}
1015 \textcolor{comment}{         * resistant (if they were, we'd have to reset the name as well as}
1016 \textcolor{comment}{         * setting corpsenm).}
1017 \textcolor{comment}{         */}
1018         \textcolor{keywordflow}{for} (wastyp = otmp->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm}; ; wastyp = rndmonnum()) \{
1019         \textcolor{comment}{/* makemon without rndmonst() might create a group */}
1020         was = makemon(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[wastyp], 0, 0, \hyperlink{hack_8h_ae449582f467baa0da531a6ea116a18f2}{NO\_MM\_FLAGS});
1021         \textcolor{keywordflow}{if} (!\hyperlink{mondata_8h_a372753958b3b36d2edd0add67aa6fc75}{resists\_ston}(was)) \textcolor{keywordflow}{break};
1022         mongone(was);
1023         \}
1024         otmp->\hyperlink{structobj_ad5db7220e2b815d06c3c80027ab9924f}{corpsenm} = wastyp;
1025         \textcolor{keywordflow}{while}(was->\hyperlink{structmonst_a480856d6a5db5610593c9816e525a978}{minvent}) \{
1026         obj = was->\hyperlink{structmonst_a480856d6a5db5610593c9816e525a978}{minvent};
1027         obj->\hyperlink{structobj_a7906e045755ba4099705764a4eb076c6}{owornmask} = 0;
1028         obj\_extract\_self(obj);
1029         (void) add\_to\_container(otmp, obj);
1030         \}
1031         otmp->\hyperlink{structobj_a606b1d5b273b814049cc1b1991adfeec}{owt} = weight(otmp);
1032         mongone(was);
1033     \}
1034 
1035     stackobj(otmp);
1036 
1037     \}       \textcolor{comment}{/* if (rn2(100) < o->chance) */}
1038  o\_done:
1039     \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(o->\hyperlink{structobject_acce2482cb9701001d8f378d3bfbdb8f6}{name}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str});
1040 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_aed0bf1587841aa8f663dfde599226f82}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!create\+\_\+room@{create\+\_\+room}}
\index{create\+\_\+room@{create\+\_\+room}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{create\+\_\+room}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} create\+\_\+room (
\begin{DoxyParamCaption}
\item[{{\bf xchar}}]{x, }
\item[{{\bf xchar}}]{y, }
\item[{{\bf xchar}}]{w, }
\item[{{\bf xchar}}]{h, }
\item[{{\bf xchar}}]{xal, }
\item[{{\bf xchar}}]{yal, }
\item[{{\bf xchar}}]{rtype, }
\item[{{\bf xchar}}]{rlit}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_aed0bf1587841aa8f663dfde599226f82}


Definition at line 363 of file sp\+\_\+lev.\+c.



References abs(), add\+\_\+room(), B\+O\+T\+T\+O\+M, C\+E\+N\+T\+E\+R, check\+\_\+room(), C\+O\+L\+N\+O, F\+A\+L\+S\+E, get\+\_\+rect(), nhrect\+::hx, nhrect\+::hy, L\+E\+F\+T, nhrect\+::lx, mkroom\+::lx, nhrect\+::ly, mkroom\+::ly, nroom, O\+R\+O\+O\+M, R\+I\+G\+H\+T, rn1, rnd\+\_\+rect(), rooms, R\+O\+W\+N\+O, smeq, split\+\_\+rects(), T\+O\+P, T\+R\+U\+E, u, you\+::uz, V\+A\+U\+L\+T, X\+L\+I\+M, and Y\+L\+I\+M.



Referenced by build\+\_\+room(), and makerooms().


\begin{DoxyCode}
368 \{
369     \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar}  xabs, yabs;
370     \textcolor{keywordtype}{int} wtmp, htmp, xaltmp, yaltmp, xtmp, ytmp;
371     \hyperlink{structnhrect}{NhRect}    *r1 = 0, r2;
372     \textcolor{keywordtype}{int} trycnt = 0;
373     \textcolor{keywordtype}{boolean} vault = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
374     \textcolor{keywordtype}{int} xlim = \hyperlink{sp__lev_8c_a075f60def9a4c6c70532cc1c6e91ecd7}{XLIM}, ylim = \hyperlink{sp__lev_8c_a628ce4849b164cf89c658ef72eb6ac08}{YLIM};
375 
376     \textcolor{keywordflow}{if} (rtype == -1)    \textcolor{comment}{/* Is the type random ? */}
377         rtype = \hyperlink{mkroom_8h_a24fe7e4ef6dbb56e7d2570a7ac640d71}{OROOM};
378 
379     \textcolor{keywordflow}{if} (rtype == \hyperlink{mkroom_8h_ab75d7f5a330f45915bd3794809ef1609}{VAULT}) \{
380         vault = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
381         xlim++;
382         ylim++;
383     \}
384 
385     \textcolor{comment}{/* on low levels the room is lit (usually) */}
386     \textcolor{comment}{/* some other rooms may require lighting */}
387 
388     \textcolor{comment}{/* is light state random ? */}
389     \textcolor{keywordflow}{if} (rlit == -1)
390         rlit = (rnd(1+\hyperlink{amidos_8c_a196e7f007a501cf9d0907cb2bab0b622}{abs}(depth(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}))) < 11 && rn2(77)) ? \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} : 
      \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
391 
392     \textcolor{comment}{/*}
393 \textcolor{comment}{     * Here we will try to create a room. If some parameters are}
394 \textcolor{comment}{     * random we are willing to make several try before we give}
395 \textcolor{comment}{     * it up.}
396 \textcolor{comment}{     */}
397     \textcolor{keywordflow}{do} \{
398         \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} xborder, yborder;
399         wtmp = w; htmp = h;
400         xtmp = x; ytmp = y;
401         xaltmp = xal; yaltmp = yal;
402 
403         \textcolor{comment}{/* First case : a totaly random room */}
404 
405         \textcolor{keywordflow}{if}((xtmp < 0 && ytmp <0 && wtmp < 0 && xaltmp < 0 &&
406            yaltmp < 0) || vault) \{
407             \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} hx, hy, lx, ly, dx, dy;
408             r1 = \hyperlink{rect_8c_a08d7614d2af07fb9f31a1744ff3b2295}{rnd\_rect}(); \textcolor{comment}{/* Get a random rectangle */}
409 
410             \textcolor{keywordflow}{if} (!r1) \{ \textcolor{comment}{/* No more free rectangles ! */}
411 \textcolor{preprocessor}{#ifdef DEBUG}
412                 debugpline(\textcolor{stringliteral}{"No more rects..."});
413 \textcolor{preprocessor}{#endif}
414                 \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
415             \}
416             hx = r1->\hyperlink{structnhrect_a42e30acf0258a3280d0e7d39384c235d}{hx};
417             hy = r1->\hyperlink{structnhrect_a9b42981eb9df1a1b9e37a79e07b1de5e}{hy};
418             lx = r1->\hyperlink{structnhrect_acfb56c33a9fd34960bb7b86f8470cdcf}{lx};
419             ly = r1->\hyperlink{structnhrect_ab036ec40a3e9eea9628acfd47c94a181}{ly};
420             \textcolor{keywordflow}{if} (vault)
421                 dx = dy = 1;
422             \textcolor{keywordflow}{else} \{
423                 dx = 2 + rn2((hx-lx > 28) ? 12 : 8);
424                 dy = 2 + rn2(4);
425                 \textcolor{keywordflow}{if}(dx*dy > 50)
426                     dy = 50/dx;
427             \}
428             xborder = (lx > 0 && hx < \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO} -1) ? 2*xlim : xlim+1;
429             yborder = (ly > 0 && hy < \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO} -1) ? 2*ylim : ylim+1;
430             \textcolor{keywordflow}{if}(hx-lx < dx + 3 + xborder ||
431                hy-ly < dy + 3 + yborder) \{
432                 r1 = 0;
433                 \textcolor{keywordflow}{continue};
434             \}
435             xabs = lx + (lx > 0 ? xlim : 3)
436                 + rn2(hx - (lx>0?lx : 3) - dx - xborder + 1);
437             yabs = ly + (ly > 0 ? ylim : 2)
438                 + rn2(hy - (ly>0?ly : 2) - dy - yborder + 1);
439             \textcolor{keywordflow}{if} (ly == 0 && hy >= (\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}-1) &&
440                 (!\hyperlink{decl_8h_a5f1394ad444ca9a0b5e47123e8c454d9}{nroom} || !rn2(\hyperlink{decl_8h_a5f1394ad444ca9a0b5e47123e8c454d9}{nroom})) && (yabs+dy > \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}/2)) \{
441                 yabs = \hyperlink{hack_8h_af107ca092682647f298989038020f9c8}{rn1}(3, 2);
442                 \textcolor{keywordflow}{if}(nroom < 4 && dy>1) dy--;
443                 \}
444             \textcolor{keywordflow}{if} (!\hyperlink{sp__lev_8c_a82e8922c853831487f6f175225a5ea46}{check\_room}(&xabs, &dx, &yabs, &dy, vault)) \{
445                 r1 = 0;
446                 \textcolor{keywordflow}{continue};
447             \}
448             wtmp = dx+1;
449             htmp = dy+1;
450             r2.\hyperlink{structnhrect_acfb56c33a9fd34960bb7b86f8470cdcf}{lx} = xabs-1; r2.ly = yabs-1;
451             r2.hx = xabs + wtmp;
452             r2.hy = yabs + htmp;
453         \} \textcolor{keywordflow}{else} \{    \textcolor{comment}{/* Only some parameters are random */}
454             \textcolor{keywordtype}{int} rndpos = 0;
455             \textcolor{keywordflow}{if} (xtmp < 0 && ytmp < 0) \{ \textcolor{comment}{/* Position is RANDOM */}
456                 xtmp = rnd(5);
457                 ytmp = rnd(5);
458                 rndpos = 1;
459             \}
460             \textcolor{keywordflow}{if} (wtmp < 0 || htmp < 0) \{ \textcolor{comment}{/* Size is RANDOM */}
461                 wtmp = \hyperlink{hack_8h_af107ca092682647f298989038020f9c8}{rn1}(15, 3);
462                 htmp = \hyperlink{hack_8h_af107ca092682647f298989038020f9c8}{rn1}(8, 2);
463             \}
464             \textcolor{keywordflow}{if} (xaltmp == -1) \textcolor{comment}{/* Horizontal alignment is RANDOM */}
465                 xaltmp = rnd(3);
466             \textcolor{keywordflow}{if} (yaltmp == -1) \textcolor{comment}{/* Vertical alignment is RANDOM */}
467                 yaltmp = rnd(3);
468 
469             \textcolor{comment}{/* Try to generate real (absolute) coordinates here! */}
470 
471             xabs = (((xtmp-1) * \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}) / 5) + 1;
472             yabs = (((ytmp-1) * \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}) / 5) + 1;
473             \textcolor{keywordflow}{switch} (xaltmp) \{
474                   \textcolor{keywordflow}{case} \hyperlink{sp__lev_8c_a437ef08681e7210d6678427030446a54}{LEFT}:
475                 \textcolor{keywordflow}{break};
476                   \textcolor{keywordflow}{case} \hyperlink{sp__lev_8c_a80fb826a684cf3f0d306b22aa100ddac}{RIGHT}:
477                 xabs += (\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO} / 5) - wtmp;
478                 \textcolor{keywordflow}{break};
479                   \textcolor{keywordflow}{case} \hyperlink{sp__lev_8c_a824fea1f256659e11e6cd8c82cb13338}{CENTER}:
480                 xabs += ((\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO} / 5) - wtmp) / 2;
481                 \textcolor{keywordflow}{break};
482             \}
483             \textcolor{keywordflow}{switch} (yaltmp) \{
484                   \textcolor{keywordflow}{case} \hyperlink{sp__lev_8c_afc0eef637f1016e8786e45e106a4881e}{TOP}:
485                 \textcolor{keywordflow}{break};
486                   \textcolor{keywordflow}{case} \hyperlink{sp__lev_8c_ae420caa0af9cbdf102ed255034e27c5b}{BOTTOM}:
487                 yabs += (\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO} / 5) - htmp;
488                 \textcolor{keywordflow}{break};
489                   \textcolor{keywordflow}{case} \hyperlink{sp__lev_8c_a824fea1f256659e11e6cd8c82cb13338}{CENTER}:
490                 yabs += ((\hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO} / 5) - htmp) / 2;
491                 \textcolor{keywordflow}{break};
492             \}
493 
494             \textcolor{keywordflow}{if} (xabs + wtmp - 1 > \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO} - 2)
495                 xabs = \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO} - wtmp - 3;
496             \textcolor{keywordflow}{if} (xabs < 2)
497                 xabs = 2;
498             \textcolor{keywordflow}{if} (yabs + htmp - 1> \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO} - 2)
499                 yabs = \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO} - htmp - 3;
500             \textcolor{keywordflow}{if} (yabs < 2)
501                 yabs = 2;
502 
503             \textcolor{comment}{/* Try to find a rectangle that fit our room ! */}
504 
505             r2.lx = xabs-1; r2.ly = yabs-1;
506             r2.hx = xabs + wtmp + rndpos;
507             r2.hy = yabs + htmp + rndpos;
508             r1 = \hyperlink{rect_8c_ae1368e613bcd993129ebc9a4753cbed9}{get\_rect}(&r2);
509         \}
510     \} \textcolor{keywordflow}{while} (++trycnt <= 100 && !r1);
511     \textcolor{keywordflow}{if} (!r1) \{  \textcolor{comment}{/* creation of room failed ? */}
512         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
513     \}
514     \hyperlink{rect_8c_aac03d4f873d60f5a994c8b2f14ff177c}{split\_rects}(r1, &r2);
515 
516     \textcolor{keywordflow}{if} (!vault) \{
517         \hyperlink{decl_8h_a25cf8516b9fa672c62c208cad05efc7a}{smeq}[\hyperlink{decl_8h_a5f1394ad444ca9a0b5e47123e8c454d9}{nroom}] = \hyperlink{decl_8h_a5f1394ad444ca9a0b5e47123e8c454d9}{nroom};
518         \hyperlink{mklev_8c_a5bfd1137aab85b0e7ee01c7c008e2cd6}{add\_room}(xabs, yabs, xabs+wtmp-1, yabs+htmp-1,
519              rlit, rtype, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
520     \} \textcolor{keywordflow}{else} \{
521         \hyperlink{mkroom_8h_a45030df62e6451e79233760364dca9e1}{rooms}[\hyperlink{decl_8h_a5f1394ad444ca9a0b5e47123e8c454d9}{nroom}].\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx} = xabs;
522         \hyperlink{mkroom_8h_a45030df62e6451e79233760364dca9e1}{rooms}[\hyperlink{decl_8h_a5f1394ad444ca9a0b5e47123e8c454d9}{nroom}].\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly} = yabs;
523     \}
524     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
525 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a8fdba0dd9aca405c0bfa964c90b3f4d4}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!create\+\_\+secret\+\_\+door@{create\+\_\+secret\+\_\+door}}
\index{create\+\_\+secret\+\_\+door@{create\+\_\+secret\+\_\+door}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{create\+\_\+secret\+\_\+door}]{\setlength{\rightskip}{0pt plus 5cm}void create\+\_\+secret\+\_\+door (
\begin{DoxyParamCaption}
\item[{struct {\bf mkroom} $\ast$}]{croom, }
\item[{{\bf xchar}}]{walls}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a8fdba0dd9aca405c0bfa964c90b3f4d4}


Definition at line 666 of file sp\+\_\+lev.\+c.



References add\+\_\+door(), count, D\+\_\+\+C\+L\+O\+S\+E\+D, levl, okdoor(), rn1, S\+D\+O\+O\+R, W\+\_\+\+E\+A\+S\+T, W\+\_\+\+N\+O\+R\+T\+H, W\+\_\+\+S\+O\+U\+T\+H, and W\+\_\+\+W\+E\+S\+T.



Referenced by fixup\+\_\+special().


\begin{DoxyCode}
669 \{
670     \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} sx, sy; \textcolor{comment}{/* location of the secret door */}
671     \textcolor{keywordtype}{int} \hyperlink{wingem1_8c_a66e3fedede6aa372e5196e55e5e8d5c1}{count};
672 
673     \textcolor{keywordflow}{for}(count = 0; count < 100; count++) \{
674     sx = \hyperlink{hack_8h_af107ca092682647f298989038020f9c8}{rn1}(croom->\hyperlink{structmkroom_a1b738b591a7735add2af6d918c556543}{hx} - croom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx} + 1, croom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx});
675     sy = \hyperlink{hack_8h_af107ca092682647f298989038020f9c8}{rn1}(croom->\hyperlink{structmkroom_aa767bcbf6e0de868bba6d2a1c7e7182e}{hy} - croom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly} + 1, croom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly});
676 
677     \textcolor{keywordflow}{switch}(rn2(4)) \{
678     \textcolor{keywordflow}{case} 0:  \textcolor{comment}{/* top */}
679         \textcolor{keywordflow}{if}(!(walls & \hyperlink{sp__lev_8h_a5f689cb20aa2498a4213291bf63c0ea6}{W\_NORTH})) \textcolor{keywordflow}{continue};
680         sy = croom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly}-1; \textcolor{keywordflow}{break};
681     \textcolor{keywordflow}{case} 1: \textcolor{comment}{/* bottom */}
682         \textcolor{keywordflow}{if}(!(walls & \hyperlink{sp__lev_8h_af7883dbd7a068246a1596614dbe13b96}{W\_SOUTH})) \textcolor{keywordflow}{continue};
683         sy = croom->\hyperlink{structmkroom_aa767bcbf6e0de868bba6d2a1c7e7182e}{hy}+1; \textcolor{keywordflow}{break};
684     \textcolor{keywordflow}{case} 2: \textcolor{comment}{/* left */}
685         \textcolor{keywordflow}{if}(!(walls & \hyperlink{sp__lev_8h_a0733adeaa8b46ec5f371a7bfe4e79cdb}{W\_EAST})) \textcolor{keywordflow}{continue};
686         sx = croom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx}-1; \textcolor{keywordflow}{break};
687     \textcolor{keywordflow}{case} 3: \textcolor{comment}{/* right */}
688         \textcolor{keywordflow}{if}(!(walls & \hyperlink{sp__lev_8h_a59a97200f26ccd6a0426bb2f6384c226}{W\_WEST})) \textcolor{keywordflow}{continue};
689         sx = croom->\hyperlink{structmkroom_a1b738b591a7735add2af6d918c556543}{hx}+1; \textcolor{keywordflow}{break};
690     \}
691 
692     \textcolor{keywordflow}{if}(\hyperlink{mklev_8c_a00f6047f9a090c068598aa919e2dba4e}{okdoor}(sx,sy)) \{
693         \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[sx][sy].typ = \hyperlink{rm_8h_a03fd0fa1e0dbd19ea38dff0c79e656a5}{SDOOR};
694         \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[sx][sy].doormask = \hyperlink{rm_8h_a65f9ce7db71ac3d4c13edfe69732ec9a}{D\_CLOSED};
695         \hyperlink{mklev_8c_abfbeba318d849971ade63038b45c638e}{add\_door}(sx,sy,croom);
696         \textcolor{keywordflow}{return};
697     \}
698     \}
699 
700     impossible(\textcolor{stringliteral}{"couldn't create secret door on any walls 0x%x"}, walls);
701 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_ae26ceffab26c8763a1133119bf206b09}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!create\+\_\+stairs@{create\+\_\+stairs}}
\index{create\+\_\+stairs@{create\+\_\+stairs}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{create\+\_\+stairs}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void create\+\_\+stairs (
\begin{DoxyParamCaption}
\item[{{\bf stair}	$\ast$}]{s, }
\item[{struct {\bf mkroom}	$\ast$}]{croom}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ae26ceffab26c8763a1133119bf206b09}


Definition at line 1068 of file sp\+\_\+lev.\+c.



References get\+\_\+free\+\_\+room\+\_\+loc(), and mkstairs().



Referenced by build\+\_\+room().


\begin{DoxyCode}
1071 \{
1072     \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar}      x,y;
1073 
1074     x = s->\hyperlink{structstair_ac2d7a1ec9399eeac8fc9b72f1a8bb402}{x}; y = s->\hyperlink{structstair_adb9f18b03852a2f5603811f0c3709d5a}{y};
1075     \hyperlink{sp__lev_8c_aeb5a8f471c788d7ca454e56c9a7d97c9}{get\_free\_room\_loc}(&x, &y, croom);
1076     \hyperlink{mklev_8c_a17be6d5832c5764f4c77e0d3ae9f507b}{mkstairs}(x,y,(\textcolor{keywordtype}{char})s->\hyperlink{structstair_afa205e9ad096655d5e5f988797d5e92f}{up}, croom);
1077 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a4bfada15bb3d2f87bdc72619b076bbcb}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!create\+\_\+subroom@{create\+\_\+subroom}}
\index{create\+\_\+subroom@{create\+\_\+subroom}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{create\+\_\+subroom}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} create\+\_\+subroom (
\begin{DoxyParamCaption}
\item[{struct {\bf mkroom} $\ast$}]{proom, }
\item[{{\bf xchar}}]{x, }
\item[{{\bf xchar}}]{y, }
\item[{{\bf xchar}}]{w, }
\item[{{\bf xchar}}]{h, }
\item[{{\bf xchar}}]{rtype, }
\item[{{\bf xchar}}]{rlit}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a4bfada15bb3d2f87bdc72619b076bbcb}


Definition at line 533 of file sp\+\_\+lev.\+c.



References abs(), add\+\_\+subroom(), F\+A\+L\+S\+E, height, O\+R\+O\+O\+M, T\+R\+U\+E, u, you\+::uz, and width.



Referenced by build\+\_\+room().


\begin{DoxyCode}
538 \{
539     \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} \hyperlink{xpm2img_8c_a2474a5474cbff19523a51eb1de01cda4}{width}, \hyperlink{xpm2img_8c_ad12fc34ce789bce6c8a05d8a17138534}{height};
540 
541     width = proom->\hyperlink{structmkroom_a1b738b591a7735add2af6d918c556543}{hx} - proom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx} + 1;
542     height = proom->\hyperlink{structmkroom_aa767bcbf6e0de868bba6d2a1c7e7182e}{hy} - proom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly} + 1;
543 
544     \textcolor{comment}{/* There is a minimum size for the parent room */}
545     \textcolor{keywordflow}{if} (width < 4 || height < 4)
546         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
547 
548     \textcolor{comment}{/* Check for random position, size, etc... */}
549 
550     \textcolor{keywordflow}{if} (w == -1)
551         w = rnd(width - 3);
552     \textcolor{keywordflow}{if} (h == -1)
553         h = rnd(height - 3);
554     \textcolor{keywordflow}{if} (x == -1)
555         x = rnd(width - w - 1) - 1;
556     \textcolor{keywordflow}{if} (y == -1)
557         y = rnd(height - h - 1) - 1;
558     \textcolor{keywordflow}{if} (x == 1)
559         x = 0;
560     \textcolor{keywordflow}{if} (y == 1)
561         y = 0;
562     \textcolor{keywordflow}{if} ((x + w + 1) == width)
563         x++;
564     \textcolor{keywordflow}{if} ((y + h + 1) == height)
565         y++;
566     \textcolor{keywordflow}{if} (rtype == -1)
567         rtype = \hyperlink{mkroom_8h_a24fe7e4ef6dbb56e7d2570a7ac640d71}{OROOM};
568     \textcolor{keywordflow}{if} (rlit == -1)
569         rlit = (rnd(1+\hyperlink{amidos_8c_a196e7f007a501cf9d0907cb2bab0b622}{abs}(depth(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}))) < 11 && rn2(77)) ? \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} : 
      \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
570     \hyperlink{mklev_8c_ad24a54764d74447379182186886ec193}{add\_subroom}(proom, proom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx} + x, proom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly} + y,
571             proom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx} + x + w - 1, proom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly} + y + h - 1,
572             rlit, rtype, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
573     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
574 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_ab040037bf30273b3fe8e9ceb90eacebe}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!create\+\_\+trap@{create\+\_\+trap}}
\index{create\+\_\+trap@{create\+\_\+trap}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{create\+\_\+trap}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void create\+\_\+trap (
\begin{DoxyParamCaption}
\item[{{\bf trap}	$\ast$}]{t, }
\item[{struct {\bf mkroom}	$\ast$}]{croom}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ab040037bf30273b3fe8e9ceb90eacebe}


Definition at line 708 of file sp\+\_\+lev.\+c.



References D\+R\+Y, get\+\_\+free\+\_\+room\+\_\+loc(), get\+\_\+location(), mktrap(), coord\+::x, and coord\+::y.



Referenced by build\+\_\+room(), and load\+\_\+maze().


\begin{DoxyCode}
711 \{
712     \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar}  x,y;
713     \hyperlink{structcoord}{coord}  \hyperlink{structtm}{tm};
714 
715     \textcolor{keywordflow}{if} (rn2(100) < t->\hyperlink{structtrap_a641c9896c51efde6d757cc1903209c98}{chance}) \{
716     x = t->\hyperlink{structtrap_aed25254cf556e3eae09dd98576d98d45}{x};
717     y = t->\hyperlink{structtrap_a3c7f72724bfcd0c4acb2a05ee75064df}{y};
718     \textcolor{keywordflow}{if} (croom)
719         \hyperlink{sp__lev_8c_aeb5a8f471c788d7ca454e56c9a7d97c9}{get\_free\_room\_loc}(&x, &y, croom);
720     \textcolor{keywordflow}{else}
721         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&x, &y, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY});
722 
723     tm.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x} = x;
724     tm.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y} = y;
725 
726     \hyperlink{mklev_8c_af2ceccec0c6f12db9dafcbb68b5d8b9a}{mktrap}(t->\hyperlink{structtrap_a6433bf21fd55f30507100598399aa727}{type}, 1, (\textcolor{keyword}{struct} \hyperlink{structmkroom}{mkroom}*) 0, &tm);
727     \}
728 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_ad87ffe1562fb5ae4768446e053f08207}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!dig\+\_\+corridor@{dig\+\_\+corridor}}
\index{dig\+\_\+corridor@{dig\+\_\+corridor}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{dig\+\_\+corridor}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} dig\+\_\+corridor (
\begin{DoxyParamCaption}
\item[{{\bf coord} $\ast$}]{org, }
\item[{{\bf coord} $\ast$}]{dest, }
\item[{{\bf boolean}}]{nxcor, }
\item[{{\bf schar}}]{ftyp, }
\item[{{\bf schar}}]{btyp}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ad87ffe1562fb5ae4768446e053f08207}


Definition at line 1270 of file sp\+\_\+lev.\+c.



References abs(), C\+O\+L\+N\+O, C\+O\+R\+R, F\+A\+L\+S\+E, levl, R\+O\+W\+N\+O, S\+C\+O\+R\+R, T\+R\+U\+E, and rm\+::typ.



Referenced by create\+\_\+corridor(), join(), and join\+\_\+map().


\begin{DoxyCode}
1274 \{
1275     \textcolor{keyword}{register} \textcolor{keywordtype}{int} dx=0, dy=0, dix, diy, cct;
1276     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structrm}{rm} *crm;
1277     \textcolor{keyword}{register} \textcolor{keywordtype}{int} tx, ty, xx, yy;
1278 
1279     xx = org->\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x};  yy = org->\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y};
1280     tx = dest->\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}; ty = dest->\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y};
1281     \textcolor{keywordflow}{if} (xx <= 0 || yy <= 0 || tx <= 0 || ty <= 0 ||
1282         xx > \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}-1 || tx > \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}-1 ||
1283         yy > \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}-1 || ty > \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}-1) \{
1284 \textcolor{preprocessor}{#ifdef DEBUG}
1285         debugpline(\textcolor{stringliteral}{"dig\_corridor: bad coords : (%d,%d) (%d,%d)."},
1286                xx,yy,tx,ty);
1287 \textcolor{preprocessor}{#endif}
1288         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1289     \}
1290     \textcolor{keywordflow}{if} (tx > xx)        dx = 1;
1291     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ty > yy)   dy = 1;
1292     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tx < xx)   dx = -1;
1293     \textcolor{keywordflow}{else}            dy = -1;
1294 
1295     xx -= dx;
1296     yy -= dy;
1297     cct = 0;
1298     \textcolor{keywordflow}{while}(xx != tx || yy != ty) \{
1299         \textcolor{comment}{/* loop: dig corridor at [xx,yy] and find new [xx,yy] */}
1300         \textcolor{keywordflow}{if}(cct++ > 500 || (nxcor && !rn2(35)))
1301         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1302 
1303         xx += dx;
1304         yy += dy;
1305 
1306         \textcolor{keywordflow}{if}(xx >= \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}-1 || xx <= 0 || yy <= 0 || yy >= \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}-1)
1307         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};      \textcolor{comment}{/* impossible */}
1308 
1309         crm = &\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[xx][yy];
1310         \textcolor{keywordflow}{if}(crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} == btyp) \{
1311         \textcolor{keywordflow}{if}(ftyp != \hyperlink{rm_8h_aeffd57885964c3a9a5c3ce0f81c06339}{CORR} || rn2(100)) \{
1312             crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} = ftyp;
1313             \textcolor{keywordflow}{if}(nxcor && !rn2(50))
1314                 (void) mksobj\_at(BOULDER, xx, yy, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1315         \} \textcolor{keywordflow}{else} \{
1316             crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} = \hyperlink{rm_8h_a35e6fdb78f87c982df30c7e9580ad95d}{SCORR};
1317         \}
1318         \} \textcolor{keywordflow}{else}
1319         \textcolor{keywordflow}{if}(crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} != ftyp && crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} != \hyperlink{rm_8h_a35e6fdb78f87c982df30c7e9580ad95d}{SCORR}) \{
1320         \textcolor{comment}{/* strange ... */}
1321         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1322         \}
1323 
1324         \textcolor{comment}{/* find next corridor position */}
1325         dix = \hyperlink{amidos_8c_a196e7f007a501cf9d0907cb2bab0b622}{abs}(xx-tx);
1326         diy = \hyperlink{amidos_8c_a196e7f007a501cf9d0907cb2bab0b622}{abs}(yy-ty);
1327 
1328         \textcolor{comment}{/* do we have to change direction ? */}
1329         \textcolor{keywordflow}{if}(dy && dix > diy) \{
1330         \textcolor{keyword}{register} \textcolor{keywordtype}{int} ddx = (xx > tx) ? -1 : 1;
1331 
1332         crm = &\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[xx+ddx][yy];
1333         \textcolor{keywordflow}{if}(crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} == btyp || crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} == ftyp || crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} == \hyperlink{rm_8h_a35e6fdb78f87c982df30c7e9580ad95d}{SCORR}) \{
1334             dx = ddx;
1335             dy = 0;
1336             \textcolor{keywordflow}{continue};
1337         \}
1338         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(dx && diy > dix) \{
1339         \textcolor{keyword}{register} \textcolor{keywordtype}{int} ddy = (yy > ty) ? -1 : 1;
1340 
1341         crm = &\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[xx][yy+ddy];
1342         \textcolor{keywordflow}{if}(crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} == btyp || crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} == ftyp || crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} == \hyperlink{rm_8h_a35e6fdb78f87c982df30c7e9580ad95d}{SCORR}) \{
1343             dy = ddy;
1344             dx = 0;
1345             \textcolor{keywordflow}{continue};
1346         \}
1347         \}
1348 
1349         \textcolor{comment}{/* continue straight on? */}
1350         crm = &\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[xx+dx][yy+dy];
1351         \textcolor{keywordflow}{if}(crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} == btyp || crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} == ftyp || crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} == \hyperlink{rm_8h_a35e6fdb78f87c982df30c7e9580ad95d}{SCORR})
1352         \textcolor{keywordflow}{continue};
1353 
1354         \textcolor{comment}{/* no, what must we do now?? */}
1355         \textcolor{keywordflow}{if}(dx) \{
1356         dx = 0;
1357         dy = (ty < yy) ? -1 : 1;
1358         \} \textcolor{keywordflow}{else} \{
1359         dy = 0;
1360         dx = (tx < xx) ? -1 : 1;
1361         \}
1362         crm = &\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[xx+dx][yy+dy];
1363         \textcolor{keywordflow}{if}(crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} == btyp || crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} == ftyp || crm->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} == \hyperlink{rm_8h_a35e6fdb78f87c982df30c7e9580ad95d}{SCORR})
1364         \textcolor{keywordflow}{continue};
1365         dy = -dy;
1366         dx = -dx;
1367     \}
1368     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1369 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a2d5b9784df809d6fc8a8140a5c75681d}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf mkmap}}]{, }
\item[{({\bf lev\+\_\+init} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a2d5b9784df809d6fc8a8140a5c75681d}
\hypertarget{sp__lev_8c_ab27bba6681014a5e0a104549dec640e6}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf get\+\_\+room\+\_\+loc}}]{, }
\item[{({\bf schar} $\ast$, {\bf schar} $\ast$, struct {\bf mkroom} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ab27bba6681014a5e0a104549dec640e6}
\hypertarget{sp__lev_8c_aa134c8dc3ef531ffc27f74cc133b02a6}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf get\+\_\+free\+\_\+room\+\_\+loc}}]{, }
\item[{({\bf schar} $\ast$, {\bf schar} $\ast$, struct {\bf mkroom} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_aa134c8dc3ef531ffc27f74cc133b02a6}
\hypertarget{sp__lev_8c_ada8f0d4594745e0607f6a242c5c9c039}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf create\+\_\+trap}}]{, }
\item[{({\bf trap} $\ast$, struct {\bf mkroom} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ada8f0d4594745e0607f6a242c5c9c039}
\hypertarget{sp__lev_8c_a1832ae3f1089c0e10ee7e9bf0f65f1d4}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf noncoalignment}}]{, }
\item[{({\bf A\+L\+I\+G\+N\+T\+Y\+P\+\_\+\+P})}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a1832ae3f1089c0e10ee7e9bf0f65f1d4}
\hypertarget{sp__lev_8c_a2aff51222d55bb9b4310de7dbbdc7be0}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf create\+\_\+monster}}]{, }
\item[{({\bf monster} $\ast$, struct {\bf mkroom} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a2aff51222d55bb9b4310de7dbbdc7be0}
\hypertarget{sp__lev_8c_aa1532287463014f24bfc19946d533693}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf create\+\_\+object}}]{, }
\item[{({\bf object} $\ast$, struct {\bf mkroom} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_aa1532287463014f24bfc19946d533693}
\hypertarget{sp__lev_8c_aecda703fe2709555bba95f3689a1515e}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf create\+\_\+engraving}}]{, }
\item[{({\bf engraving} $\ast$, struct {\bf mkroom} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_aecda703fe2709555bba95f3689a1515e}
\hypertarget{sp__lev_8c_a68fb399d62e0918b73d7b79de74f93c9}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf create\+\_\+stairs}}]{, }
\item[{({\bf stair} $\ast$, struct {\bf mkroom} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a68fb399d62e0918b73d7b79de74f93c9}
\hypertarget{sp__lev_8c_ab2ed548f4e63e6c8becdc46157bda834}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf create\+\_\+altar}}]{, }
\item[{({\bf altar} $\ast$, struct {\bf mkroom} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ab2ed548f4e63e6c8becdc46157bda834}
\hypertarget{sp__lev_8c_aeb48140100ec7aac74afd11766565b9f}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf create\+\_\+gold}}]{, }
\item[{({\bf gold} $\ast$, struct {\bf mkroom} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_aeb48140100ec7aac74afd11766565b9f}
\hypertarget{sp__lev_8c_ac2227dead796ccebbe714bb2f8da3323}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf create\+\_\+feature}}]{, }
\item[{(int, int, struct {\bf mkroom} $\ast$, int)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ac2227dead796ccebbe714bb2f8da3323}
\hypertarget{sp__lev_8c_a120ae854d74721a56c056845e81d7641}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf search\+\_\+door}}]{, }
\item[{(struct {\bf mkroom} $\ast$, {\bf xchar} $\ast$, {\bf xchar} $\ast$, {\bf X\+C\+H\+A\+R\+\_\+\+P}, int)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a120ae854d74721a56c056845e81d7641}
\hypertarget{sp__lev_8c_ac03e51065071dc400c81917e961fce9f}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf create\+\_\+corridor}}]{, }
\item[{({\bf corridor} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ac03e51065071dc400c81917e961fce9f}
\hypertarget{sp__lev_8c_a3d67add9a022d4017f7bbc4a23e6ee8d}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf create\+\_\+subroom}}]{, }
\item[{(struct {\bf mkroom} $\ast$, {\bf X\+C\+H\+A\+R\+\_\+\+P}, {\bf X\+C\+H\+A\+R\+\_\+\+P}, {\bf X\+C\+H\+A\+R\+\_\+\+P}, {\bf X\+C\+H\+A\+R\+\_\+\+P}, {\bf X\+C\+H\+A\+R\+\_\+\+P}, {\bf X\+C\+H\+A\+R\+\_\+\+P})}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a3d67add9a022d4017f7bbc4a23e6ee8d}
\hypertarget{sp__lev_8c_ab12d2b1ca020e6a293d44819114e4e99}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf set\+\_\+wall\+\_\+property}}]{, }
\item[{({\bf X\+C\+H\+A\+R\+\_\+\+P}, {\bf X\+C\+H\+A\+R\+\_\+\+P}, {\bf X\+C\+H\+A\+R\+\_\+\+P}, {\bf X\+C\+H\+A\+R\+\_\+\+P}, int)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ab12d2b1ca020e6a293d44819114e4e99}
\hypertarget{sp__lev_8c_a71276e5f88020beb8ef02f6979b0aa91}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf get\+\_\+location}}]{, }
\item[{({\bf schar} $\ast$, {\bf schar} $\ast$, int)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a71276e5f88020beb8ef02f6979b0aa91}
\hypertarget{sp__lev_8c_a382ef45465cf2ca4e1b28969db6a4d92}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf sp\+\_\+lev\+\_\+shuffle}}]{, }
\item[{(char $\ast$, char $\ast$, int)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a382ef45465cf2ca4e1b28969db6a4d92}
\hypertarget{sp__lev_8c_a5c29b4d2ab4c7f8c7c0433ab1563b8da}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf light\+\_\+region}}]{, }
\item[{({\bf region} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a5c29b4d2ab4c7f8c7c0433ab1563b8da}
\hypertarget{sp__lev_8c_a6ded9a0dcc3a5c646e7271a2300f90e6}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf load\+\_\+common\+\_\+data}}]{, }
\item[{({\bf dlb} $\ast$, int)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a6ded9a0dcc3a5c646e7271a2300f90e6}
\hypertarget{sp__lev_8c_aba631a0aa31e412c50fafb261cb8de6e}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf load\+\_\+one\+\_\+monster}}]{, }
\item[{({\bf dlb} $\ast$, {\bf monster} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_aba631a0aa31e412c50fafb261cb8de6e}
\hypertarget{sp__lev_8c_ac6f90697248ea43ec5f664a680ff4dcc}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf load\+\_\+one\+\_\+object}}]{, }
\item[{({\bf dlb} $\ast$, {\bf object} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ac6f90697248ea43ec5f664a680ff4dcc}
\hypertarget{sp__lev_8c_af7fb72bc52142b0e52afa3c828f7a878}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf load\+\_\+one\+\_\+engraving}}]{, }
\item[{({\bf dlb} $\ast$, {\bf engraving} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_af7fb72bc52142b0e52afa3c828f7a878}
\hypertarget{sp__lev_8c_afaa56e03f326b148fde8deb7bb2c4d45}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf load\+\_\+rooms}}]{, }
\item[{({\bf dlb} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_afaa56e03f326b148fde8deb7bb2c4d45}
\hypertarget{sp__lev_8c_aa0d53ef4a321857d2447fc724b41cd14}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf maze1xy}}]{, }
\item[{({\bf coord} $\ast$, int)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_aa0d53ef4a321857d2447fc724b41cd14}
\hypertarget{sp__lev_8c_aa80988326caedcd5c250b9c09127bb3d}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf load\+\_\+maze}}]{, }
\item[{({\bf dlb} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_aa80988326caedcd5c250b9c09127bb3d}
\hypertarget{sp__lev_8c_a89dee6ee65fd3edfdcb95748751f7c9d}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf create\+\_\+door}}]{, }
\item[{({\bf room\+\_\+door} $\ast$, struct {\bf mkroom} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a89dee6ee65fd3edfdcb95748751f7c9d}
\hypertarget{sp__lev_8c_a712bad5bd950db520ea42a81a91f5d8d}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf free\+\_\+rooms}}]{, }
\item[{({\bf room} $\ast$$\ast$, int)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a712bad5bd950db520ea42a81a91f5d8d}
\hypertarget{sp__lev_8c_a038a4de09e7ddce685c6dea04b3c41bd}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf build\+\_\+room}}]{, }
\item[{({\bf room} $\ast$, {\bf room} $\ast$)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a038a4de09e7ddce685c6dea04b3c41bd}
\hypertarget{sp__lev_8c_aeb31176a58328bca5f9be6d7df92a478}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!F\+D\+E\+C\+L@{F\+D\+E\+C\+L}}
\index{F\+D\+E\+C\+L@{F\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{F\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} {\bf boolean} F\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf is\+\_\+ok\+\_\+location}}]{, }
\item[{({\bf S\+C\+H\+A\+R\+\_\+\+P}, {\bf S\+C\+H\+A\+R\+\_\+\+P}, int)}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_aeb31176a58328bca5f9be6d7df92a478}
\hypertarget{sp__lev_8c_a4e02bf4c52efa86f7646872d6ef341cb}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!fill\+\_\+room@{fill\+\_\+room}}
\index{fill\+\_\+room@{fill\+\_\+room}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{fill\+\_\+room}]{\setlength{\rightskip}{0pt plus 5cm}void fill\+\_\+room (
\begin{DoxyParamCaption}
\item[{struct {\bf mkroom} $\ast$}]{croom, }
\item[{{\bf boolean}}]{prefilled}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a4e02bf4c52efa86f7646872d6ef341cb}


Definition at line 1462 of file sp\+\_\+lev.\+c.



References abs(), B\+A\+R\+R\+A\+C\+K\+S, B\+E\+E\+H\+I\+V\+E, C\+O\+U\+R\+T, dlevel\+\_\+t\+::flags, mkroom\+::hx, mkroom\+::hy, level, M\+O\+R\+G\+U\+E, O\+R\+O\+O\+M, rn1, S\+H\+O\+P\+B\+A\+S\+E, S\+W\+A\+M\+P, T\+E\+M\+P\+L\+E, T\+R\+U\+E, u, you\+::uz, V\+A\+U\+L\+T, and Z\+O\+O.



Referenced by build\+\_\+room(), load\+\_\+maze(), and makelevel().


\begin{DoxyCode}
1465 \{
1466     \textcolor{keywordflow}{if} (!croom || croom->\hyperlink{structmkroom_a0ad2dc1a7e0527610e96e830b2cad471}{rtype} == \hyperlink{mkroom_8h_a24fe7e4ef6dbb56e7d2570a7ac640d71}{OROOM})
1467         \textcolor{keywordflow}{return};
1468 
1469     \textcolor{keywordflow}{if} (!prefilled) \{
1470         \textcolor{keywordtype}{int} x,y;
1471 
1472         \textcolor{comment}{/* Shop ? */}
1473         \textcolor{keywordflow}{if} (croom->\hyperlink{structmkroom_a0ad2dc1a7e0527610e96e830b2cad471}{rtype} >= \hyperlink{mkroom_8h_a925701a88c7ed0db502cfac9d8fbcf9e}{SHOPBASE}) \{
1474             stock\_room(croom->\hyperlink{structmkroom_a0ad2dc1a7e0527610e96e830b2cad471}{rtype} - \hyperlink{mkroom_8h_a925701a88c7ed0db502cfac9d8fbcf9e}{SHOPBASE}, croom);
1475             \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.has\_shop = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1476             \textcolor{keywordflow}{return};
1477         \}
1478 
1479         \textcolor{keywordflow}{switch} (croom->\hyperlink{structmkroom_a0ad2dc1a7e0527610e96e830b2cad471}{rtype}) \{
1480         \textcolor{keywordflow}{case} \hyperlink{mkroom_8h_ab75d7f5a330f45915bd3794809ef1609}{VAULT}:
1481             \textcolor{keywordflow}{for} (x=croom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx};x<=croom->hx;x++)
1482             \textcolor{keywordflow}{for} (y=croom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly};y<=croom->hy;y++)
1483                 (void) mkgold((\textcolor{keywordtype}{long})\hyperlink{hack_8h_af107ca092682647f298989038020f9c8}{rn1}(\hyperlink{amidos_8c_a196e7f007a501cf9d0907cb2bab0b622}{abs}(depth(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}))*100, 51), x, y);
1484             \textcolor{keywordflow}{break};
1485         \textcolor{keywordflow}{case} \hyperlink{mkroom_8h_a4016e3727499e26b11c82324c0893aa2}{COURT}:
1486         \textcolor{keywordflow}{case} \hyperlink{mkroom_8h_a1e2090a3604c11b6e73a862a80cb1371}{ZOO}:
1487         \textcolor{keywordflow}{case} \hyperlink{mkroom_8h_aaf8160af3974204bedc1d7486e76aa52}{BEEHIVE}:
1488         \textcolor{keywordflow}{case} \hyperlink{mkroom_8h_a07dd2b8f8e4a31d28e883854255a85fd}{MORGUE}:
1489         \textcolor{keywordflow}{case} \hyperlink{mkroom_8h_ad55903dd4e0d482b9b430d2822c3457a}{BARRACKS}:
1490             fill\_zoo(croom);
1491             \textcolor{keywordflow}{break};
1492         \}
1493     \}
1494     \textcolor{keywordflow}{switch} (croom->\hyperlink{structmkroom_a0ad2dc1a7e0527610e96e830b2cad471}{rtype}) \{
1495         \textcolor{keywordflow}{case} \hyperlink{mkroom_8h_ab75d7f5a330f45915bd3794809ef1609}{VAULT}:
1496         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.has\_vault = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1497         \textcolor{keywordflow}{break};
1498         \textcolor{keywordflow}{case} \hyperlink{mkroom_8h_a1e2090a3604c11b6e73a862a80cb1371}{ZOO}:
1499         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.has\_zoo = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1500         \textcolor{keywordflow}{break};
1501         \textcolor{keywordflow}{case} \hyperlink{mkroom_8h_a4016e3727499e26b11c82324c0893aa2}{COURT}:
1502         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.has\_court = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1503         \textcolor{keywordflow}{break};
1504         \textcolor{keywordflow}{case} \hyperlink{mkroom_8h_a07dd2b8f8e4a31d28e883854255a85fd}{MORGUE}:
1505         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.has\_morgue = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1506         \textcolor{keywordflow}{break};
1507         \textcolor{keywordflow}{case} \hyperlink{mkroom_8h_aaf8160af3974204bedc1d7486e76aa52}{BEEHIVE}:
1508         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.has\_beehive = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1509         \textcolor{keywordflow}{break};
1510         \textcolor{keywordflow}{case} \hyperlink{mkroom_8h_ad55903dd4e0d482b9b430d2822c3457a}{BARRACKS}:
1511         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.has\_barracks = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1512         \textcolor{keywordflow}{break};
1513         \textcolor{keywordflow}{case} \hyperlink{mkroom_8h_ab8c9e1bea2ae73195887ee67f76acee2}{TEMPLE}:
1514         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.has\_temple = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1515         \textcolor{keywordflow}{break};
1516         \textcolor{keywordflow}{case} \hyperlink{mkroom_8h_ab02b728edc234e67cedb7b81dfc75958}{SWAMP}:
1517         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.has\_swamp = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1518         \textcolor{keywordflow}{break};
1519     \}
1520 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_afc958f5b0e8196b52466832cb751275e}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!fix\+\_\+stair\+\_\+rooms@{fix\+\_\+stair\+\_\+rooms}}
\index{fix\+\_\+stair\+\_\+rooms@{fix\+\_\+stair\+\_\+rooms}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{fix\+\_\+stair\+\_\+rooms}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void fix\+\_\+stair\+\_\+rooms (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_afc958f5b0e8196b52466832cb751275e}


Definition at line 1378 of file sp\+\_\+lev.\+c.



References dnstairs\+\_\+room, mkroom\+::hx, mkroom\+::hy, mkroom\+::lx, mkroom\+::ly, nroom, panic(), rooms, upstairs\+\_\+room, xdnstair, xupstair, ydnstair, and yupstair.



Referenced by create\+\_\+corridor().


\begin{DoxyCode}
1379 \{
1380     \textcolor{keywordtype}{int} i;
1381     \textcolor{keyword}{struct }\hyperlink{structmkroom}{mkroom} *croom;
1382 
1383     \textcolor{keywordflow}{if}(\hyperlink{decl_8h_a55486e08c2be9501e6817ca2a19e4d66}{xdnstair} &&
1384        !((\hyperlink{mkroom_8h_a3eba79e690418711a769e373c4ef239a}{dnstairs\_room}->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx} <= \hyperlink{decl_8h_a55486e08c2be9501e6817ca2a19e4d66}{xdnstair} && xdnstair <= dnstairs\_room->
      \hyperlink{structmkroom_a1b738b591a7735add2af6d918c556543}{hx}) &&
1385      (\hyperlink{mkroom_8h_a3eba79e690418711a769e373c4ef239a}{dnstairs\_room}->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly} <= \hyperlink{decl_8h_a3b86b85dda8af8bff9c5ea84bcc7a52a}{ydnstair} && ydnstair <= dnstairs\_room->
      \hyperlink{structmkroom_aa767bcbf6e0de868bba6d2a1c7e7182e}{hy}))) \{
1386     \textcolor{keywordflow}{for}(i=0; i < \hyperlink{decl_8h_a5f1394ad444ca9a0b5e47123e8c454d9}{nroom}; i++) \{
1387         croom = &\hyperlink{mkroom_8h_a45030df62e6451e79233760364dca9e1}{rooms}[i];
1388         \textcolor{keywordflow}{if}((croom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx} <= \hyperlink{decl_8h_a55486e08c2be9501e6817ca2a19e4d66}{xdnstair} && xdnstair <= croom->hx) &&
1389            (croom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly} <= \hyperlink{decl_8h_a3b86b85dda8af8bff9c5ea84bcc7a52a}{ydnstair} && ydnstair <= croom->hy)) \{
1390         \hyperlink{mkroom_8h_a3eba79e690418711a769e373c4ef239a}{dnstairs\_room} = croom;
1391         \textcolor{keywordflow}{break};
1392         \}
1393     \}
1394     \textcolor{keywordflow}{if}(i == nroom)
1395         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"Couldn't find dnstair room in fix\_stair\_rooms!"});
1396     \}
1397     \textcolor{keywordflow}{if}(\hyperlink{decl_8h_a6ddff041cb808902b66e0b7196f03e00}{xupstair} &&
1398        !((\hyperlink{mkroom_8h_ad0620a0a6e35627605ad83d527c992ac}{upstairs\_room}->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx} <= \hyperlink{decl_8h_a6ddff041cb808902b66e0b7196f03e00}{xupstair} && xupstair <= upstairs\_room->hx) &&
1399      (\hyperlink{mkroom_8h_ad0620a0a6e35627605ad83d527c992ac}{upstairs\_room}->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly} <= \hyperlink{decl_8h_a26867130b8519f38c26a8b28b4df9ac0}{yupstair} && yupstair <= upstairs\_room->hy))) \{
1400     \textcolor{keywordflow}{for}(i=0; i < \hyperlink{decl_8h_a5f1394ad444ca9a0b5e47123e8c454d9}{nroom}; i++) \{
1401         croom = &\hyperlink{mkroom_8h_a45030df62e6451e79233760364dca9e1}{rooms}[i];
1402         \textcolor{keywordflow}{if}((croom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx} <= \hyperlink{decl_8h_a6ddff041cb808902b66e0b7196f03e00}{xupstair} && xupstair <= croom->hx) &&
1403            (croom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly} <= \hyperlink{decl_8h_a26867130b8519f38c26a8b28b4df9ac0}{yupstair} && yupstair <= croom->hy)) \{
1404         \hyperlink{mkroom_8h_ad0620a0a6e35627605ad83d527c992ac}{upstairs\_room} = croom;
1405         \textcolor{keywordflow}{break};
1406         \}
1407     \}
1408     \textcolor{keywordflow}{if}(i == nroom)
1409         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"Couldn't find upstair room in fix\_stair\_rooms!"});
1410     \}
1411 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a8e56974ec7cfc17438a372c340ef4d83}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!free\+\_\+rooms@{free\+\_\+rooms}}
\index{free\+\_\+rooms@{free\+\_\+rooms}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{free\+\_\+rooms}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void free\+\_\+rooms (
\begin{DoxyParamCaption}
\item[{{\bf room} $\ast$$\ast$}]{ro, }
\item[{int}]{n}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a8e56974ec7cfc17438a372c340ef4d83}


Definition at line 1523 of file sp\+\_\+lev.\+c.



References \+\_\+room\+::altars, \+\_\+room\+::doors, \+\_\+room\+::engravings, \+\_\+room\+::fountains, Free, \+\_\+room\+::golds, \+\_\+room\+::monsters, \+\_\+room\+::naltar, \+\_\+room\+::name, \+\_\+room\+::ndoor, \+\_\+room\+::nengraving, \+\_\+room\+::nfountain, \+\_\+room\+::ngold, \+\_\+room\+::nmonster, \+\_\+room\+::nobject, \+\_\+room\+::npool, \+\_\+room\+::nsink, \+\_\+room\+::nstair, \+\_\+room\+::ntrap, \+\_\+room\+::objects, \+\_\+room\+::parent, \+\_\+room\+::pools, \+\_\+room\+::sinks, \+\_\+room\+::stairs, and \+\_\+room\+::traps.



Referenced by load\+\_\+rooms(), and yyparse().


\begin{DoxyCode}
1526 \{
1527     \textcolor{keywordtype}{short} j;
1528     \hyperlink{struct__room}{room} *r;
1529 
1530     \textcolor{keywordflow}{while}(n--) \{
1531         r = ro[n];
1532         \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_aca2280b1ca899bab061cca7b062ce195}{name});
1533         \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_ad0c17b49155ae5f1517fa3227e0d48e6}{parent});
1534         \textcolor{keywordflow}{if} ((j = r->\hyperlink{struct__room_adf93ac64ee6c689fc8faf034101104d2}{ndoor}) != 0) \{
1535             \textcolor{keywordflow}{while}(j--)
1536                 \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_a7680e15d05c73add8201e0b05ac24433}{doors}[j]);
1537             \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_a7680e15d05c73add8201e0b05ac24433}{doors});
1538         \}
1539         \textcolor{keywordflow}{if} ((j = r->\hyperlink{struct__room_a4c7178c7b2d6aae68c8bc575e65b4928}{nstair}) != 0) \{
1540             \textcolor{keywordflow}{while}(j--)
1541                 \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_ae3b0130f66fce4fc798876a6da829e64}{stairs}[j]);
1542             \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_ae3b0130f66fce4fc798876a6da829e64}{stairs});
1543         \}
1544         \textcolor{keywordflow}{if} ((j = r->\hyperlink{struct__room_a6e5fedf04693d5601d2fe64a2402963f}{naltar}) != 0) \{
1545             \textcolor{keywordflow}{while} (j--)
1546                 \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_ae093807c3fc83a79dfb56ba31537fd37}{altars}[j]);
1547             \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_ae093807c3fc83a79dfb56ba31537fd37}{altars});
1548         \}
1549         \textcolor{keywordflow}{if} ((j = r->\hyperlink{struct__room_a1dd82879b9d6ec47eee892f2b1f02f28}{nfountain}) != 0) \{
1550             \textcolor{keywordflow}{while}(j--)
1551                 \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_a4e68727ef155a3b332565ddf632b4e59}{fountains}[j]);
1552             \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_a4e68727ef155a3b332565ddf632b4e59}{fountains});
1553         \}
1554         \textcolor{keywordflow}{if} ((j = r->\hyperlink{struct__room_a49a3273df13628e3928da7ec7cd88d2c}{nsink}) != 0) \{
1555             \textcolor{keywordflow}{while}(j--)
1556                 \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_a3e983d2628aef0ea6f2a5eefc6a6759e}{sinks}[j]);
1557             \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_a3e983d2628aef0ea6f2a5eefc6a6759e}{sinks});
1558         \}
1559         \textcolor{keywordflow}{if} ((j = r->\hyperlink{struct__room_a309691c7928482b72435ad884e731ee1}{npool}) != 0) \{
1560             \textcolor{keywordflow}{while}(j--)
1561                 \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_a671fd6f463544e5d1815524a2501fa4e}{pools}[j]);
1562             \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_a671fd6f463544e5d1815524a2501fa4e}{pools});
1563         \}
1564         \textcolor{keywordflow}{if} ((j = r->\hyperlink{struct__room_a8deec962297d6604afe7141d852413cc}{ntrap}) != 0) \{
1565             \textcolor{keywordflow}{while} (j--)
1566                 \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_aead249557eb11c2d252993fc008c480c}{traps}[j]);
1567             \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_aead249557eb11c2d252993fc008c480c}{traps});
1568         \}
1569         \textcolor{keywordflow}{if} ((j = r->\hyperlink{struct__room_af54a6a7c092d32717c95edf356a23f88}{nmonster}) != 0) \{
1570             \textcolor{keywordflow}{while} (j--)
1571                 \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_a3825f14ece25f8f21e8613d5b77df092}{monsters}[j]);
1572             \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_a3825f14ece25f8f21e8613d5b77df092}{monsters});
1573         \}
1574         \textcolor{keywordflow}{if} ((j = r->\hyperlink{struct__room_aa955a62dbaafdf4638c3d2ce3d08c650}{nobject}) != 0) \{
1575             \textcolor{keywordflow}{while} (j--)
1576                 \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_a950a5ae5abd82208ba0ccaf95369c3ec}{objects}[j]);
1577             \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_a950a5ae5abd82208ba0ccaf95369c3ec}{objects});
1578         \}
1579         \textcolor{keywordflow}{if} ((j = r->\hyperlink{struct__room_af05297b65bbb8d9ac4234faf6cedef40}{ngold}) != 0) \{
1580             \textcolor{keywordflow}{while}(j--)
1581                 \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_a098fb9c2d338496af31b6219a81eb3ab}{golds}[j]);
1582             \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_a098fb9c2d338496af31b6219a81eb3ab}{golds});
1583         \}
1584         \textcolor{keywordflow}{if} ((j = r->\hyperlink{struct__room_a3490cb38c5c28a5b859ad715371f9a03}{nengraving}) != 0) \{
1585             \textcolor{keywordflow}{while} (j--)
1586                 \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_a39e5c581b788be17eaf8f3669fb7059a}{engravings}[j]);
1587             \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r->\hyperlink{struct__room_a39e5c581b788be17eaf8f3669fb7059a}{engravings});
1588         \}
1589         \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(r);
1590     \}
1591     \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(ro);
1592 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_aeb5a8f471c788d7ca454e56c9a7d97c9}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!get\+\_\+free\+\_\+room\+\_\+loc@{get\+\_\+free\+\_\+room\+\_\+loc}}
\index{get\+\_\+free\+\_\+room\+\_\+loc@{get\+\_\+free\+\_\+room\+\_\+loc}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{get\+\_\+free\+\_\+room\+\_\+loc}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void get\+\_\+free\+\_\+room\+\_\+loc (
\begin{DoxyParamCaption}
\item[{{\bf schar}		$\ast$}]{x, }
\item[{{\bf schar} $\ast$}]{y, }
\item[{struct {\bf mkroom}	$\ast$}]{croom}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_aeb5a8f471c788d7ca454e56c9a7d97c9}


Definition at line 290 of file sp\+\_\+lev.\+c.



References get\+\_\+room\+\_\+loc(), levl, panic(), and R\+O\+O\+M.



Referenced by create\+\_\+altar(), create\+\_\+stairs(), and create\+\_\+trap().


\begin{DoxyCode}
293 \{
294     \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar} try\_x, try\_y;
295     \textcolor{keyword}{register} \textcolor{keywordtype}{int} trycnt = 0;
296 
297     \textcolor{keywordflow}{do} \{
298         try\_x = *x,  try\_y = *y;
299         \hyperlink{sp__lev_8c_a7000c03207527bca2d559ff449c49c9b}{get\_room\_loc}(&try\_x, &try\_y, croom);
300     \} \textcolor{keywordflow}{while} (\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[try\_x][try\_y].typ != \hyperlink{rm_8h_ae635489e987ae17a3bf884376cc2fe34}{ROOM} && ++trycnt <= 100);
301 
302     \textcolor{keywordflow}{if} (trycnt > 100)
303         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"get\_free\_room\_loc:  can't find a place!"});
304     *x = try\_x,  *y = try\_y;
305 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!get\+\_\+location@{get\+\_\+location}}
\index{get\+\_\+location@{get\+\_\+location}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{get\+\_\+location}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void get\+\_\+location (
\begin{DoxyParamCaption}
\item[{{\bf schar} $\ast$}]{x, }
\item[{{\bf schar} $\ast$}]{y, }
\item[{int}]{humidity}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}


Definition at line 171 of file sp\+\_\+lev.\+c.



References is\+\_\+ok\+\_\+location(), panic(), x\+\_\+maze\+\_\+max, xsize, xstart, y\+\_\+maze\+\_\+max, ysize, and ystart.



Referenced by create\+\_\+altar(), create\+\_\+engraving(), create\+\_\+feature(), create\+\_\+gold(), create\+\_\+monster(), create\+\_\+object(), create\+\_\+trap(), and load\+\_\+maze().


\begin{DoxyCode}
174 \{
175     \textcolor{keywordtype}{int} cpt = 0;
176 
177     \textcolor{keywordflow}{if} (*x >= 0) \{          \textcolor{comment}{/* normal locations */}
178         *x += \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart};
179         *y += \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart};
180     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (*x > -11) \{      \textcolor{comment}{/* special locations */}
181         *y = \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart} + \hyperlink{sp__lev_8c_a42c30954e08e02960a5096ed70009726}{rloc\_y}[ - *y - 1];
182         *x = \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart} + \hyperlink{sp__lev_8c_a6179f3acad257eb4f3057010c6a6d187}{rloc\_x}[ - *x - 1];
183     \} \textcolor{keywordflow}{else} \{            \textcolor{comment}{/* random location */}
184         \textcolor{keywordflow}{do} \{
185         *x = \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart} + rn2((\textcolor{keywordtype}{int})\hyperlink{sp__lev_8c_a22122ed2c15d87f3ff9e3dad23423244}{xsize});
186         *y = \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart} + rn2((\textcolor{keywordtype}{int})\hyperlink{sp__lev_8c_a17f6fa5b5051ab79afe70d9598576009}{ysize});
187         \textcolor{keywordflow}{if} (\hyperlink{sp__lev_8c_a3aed0a0dffcf9b69d63541ae4131b8ae}{is\_ok\_location}(*x,*y,humidity)) \textcolor{keywordflow}{break};
188         \} \textcolor{keywordflow}{while} (++cpt < 100);
189         \textcolor{keywordflow}{if} (cpt >= 100) \{
190         \textcolor{keyword}{register} \textcolor{keywordtype}{int} xx, yy;
191         \textcolor{comment}{/* last try */}
192         \textcolor{keywordflow}{for} (xx = 0; xx < \hyperlink{sp__lev_8c_a22122ed2c15d87f3ff9e3dad23423244}{xsize}; xx++)
193             \textcolor{keywordflow}{for} (yy = 0; yy < \hyperlink{sp__lev_8c_a17f6fa5b5051ab79afe70d9598576009}{ysize}; yy++) \{
194             *x = \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart} + xx;
195             *y = \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart} + yy;
196             \textcolor{keywordflow}{if} (\hyperlink{sp__lev_8c_a3aed0a0dffcf9b69d63541ae4131b8ae}{is\_ok\_location}(*x,*y,humidity)) \textcolor{keywordflow}{goto} found\_it;
197             \}
198         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"get\_location:  can't find a place!"});
199         \}
200     \}
201 found\_it:;
202 
203     \textcolor{keywordflow}{if} (!isok(*x,*y)) \{
204         impossible(\textcolor{stringliteral}{"get\_location:  (%d,%d) out of bounds"}, *x, *y);
205         *x = \hyperlink{decl_8h_a5a8f3e210dcf5e1b8319f220200f7e91}{x\_maze\_max}; *y = \hyperlink{decl_8h_a148ae7e81a85b4cab11815530f82da17}{y\_maze\_max};
206     \}
207 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a7000c03207527bca2d559ff449c49c9b}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!get\+\_\+room\+\_\+loc@{get\+\_\+room\+\_\+loc}}
\index{get\+\_\+room\+\_\+loc@{get\+\_\+room\+\_\+loc}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{get\+\_\+room\+\_\+loc}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void get\+\_\+room\+\_\+loc (
\begin{DoxyParamCaption}
\item[{{\bf schar}		$\ast$}]{x, }
\item[{{\bf schar} $\ast$}]{y, }
\item[{struct {\bf mkroom}	$\ast$}]{croom}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a7000c03207527bca2d559ff449c49c9b}


Definition at line 262 of file sp\+\_\+lev.\+c.



References mkroom\+::hx, mkroom\+::hy, mkroom\+::lx, mkroom\+::ly, panic(), coord\+::x, and coord\+::y.



Referenced by create\+\_\+engraving(), create\+\_\+feature(), create\+\_\+gold(), create\+\_\+monster(), create\+\_\+object(), and get\+\_\+free\+\_\+room\+\_\+loc().


\begin{DoxyCode}
265 \{
266     \hyperlink{structcoord}{coord} c;
267 
268     \textcolor{keywordflow}{if} (*x <0 && *y <0) \{
269         \textcolor{keywordflow}{if} (somexy(croom, &c)) \{
270             *x = c.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x};
271             *y = c.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y};
272         \} \textcolor{keywordflow}{else}
273             \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"get\_room\_loc : can't find a place!"});
274     \} \textcolor{keywordflow}{else} \{
275         \textcolor{keywordflow}{if} (*x < 0)
276             *x = rn2(croom->\hyperlink{structmkroom_a1b738b591a7735add2af6d918c556543}{hx} - croom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx} + 1);
277         \textcolor{keywordflow}{if} (*y < 0)
278             *y = rn2(croom->\hyperlink{structmkroom_aa767bcbf6e0de868bba6d2a1c7e7182e}{hy} - croom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly} + 1);
279         *x += croom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx};
280         *y += croom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly};
281     \}
282 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a3aed0a0dffcf9b69d63541ae4131b8ae}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!is\+\_\+ok\+\_\+location@{is\+\_\+ok\+\_\+location}}
\index{is\+\_\+ok\+\_\+location@{is\+\_\+ok\+\_\+location}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{is\+\_\+ok\+\_\+location}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} is\+\_\+ok\+\_\+location (
\begin{DoxyParamCaption}
\item[{{\bf schar}}]{x, }
\item[{{\bf schar}}]{y, }
\item[{int}]{humidity}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a3aed0a0dffcf9b69d63541ae4131b8ae}


Definition at line 210 of file sp\+\_\+lev.\+c.



References A\+I\+R, C\+L\+O\+U\+D, C\+O\+R\+R, D\+R\+Y, F\+A\+L\+S\+E, I\+C\+E, Is\+\_\+waterlevel, levl, R\+O\+O\+M, T\+R\+U\+E, u, you\+::uz, and W\+E\+T.



Referenced by get\+\_\+location(), and maze1xy().


\begin{DoxyCode}
213 \{
214     \textcolor{keyword}{register} \textcolor{keywordtype}{int} typ;
215 
216     \textcolor{keywordflow}{if} (\hyperlink{dungeon_8h_a9fd7b21db47607a73332aa75ba8f4832}{Is\_waterlevel}(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz})) \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};  \textcolor{comment}{/* accept any spot */}
217 
218     \textcolor{keywordflow}{if} (humidity & \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY}) \{
219         typ = \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ;
220         \textcolor{keywordflow}{if} (typ == \hyperlink{rm_8h_ae635489e987ae17a3bf884376cc2fe34}{ROOM} || typ == \hyperlink{rm_8h_a9c9ed176f84de328afaf7f514ded7df3}{AIR} ||
221             typ == \hyperlink{rm_8h_a3ad8406dabd3873689181ce17236586b}{CLOUD} || typ == \hyperlink{rm_8h_ae41036839f2ae39cee0898016a723674}{ICE} || typ == \hyperlink{rm_8h_aeffd57885964c3a9a5c3ce0f81c06339}{CORR})
222         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
223     \}
224     \textcolor{keywordflow}{if} (humidity & \hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{WET}) \{
225         \textcolor{keywordflow}{if} (is\_pool(x,y) || is\_lava(x,y))
226         \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
227     \}
228     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
229 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a90554aa410a51a4252d734f0d3815685}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!light\+\_\+region@{light\+\_\+region}}
\index{light\+\_\+region@{light\+\_\+region}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{light\+\_\+region}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void light\+\_\+region (
\begin{DoxyParamCaption}
\item[{{\bf region}  $\ast$}]{tmpregion}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a90554aa410a51a4252d734f0d3815685}


Definition at line 1676 of file sp\+\_\+lev.\+c.



References C\+O\+L\+N\+O, L\+A\+V\+A\+P\+O\+O\+L, levl, max, min, region\+::rlit, R\+O\+W\+N\+O, and rm\+::typ.



Referenced by load\+\_\+maze().


\begin{DoxyCode}
1678 \{
1679     \textcolor{keyword}{register} \textcolor{keywordtype}{boolean} litstate = tmpregion->\hyperlink{structregion_aa560a01138b08e4502606ee04264b61a}{rlit} ? 1 : 0;
1680     \textcolor{keyword}{register} \textcolor{keywordtype}{int} hiy = tmpregion->\hyperlink{structregion_ab6a20ba1a0cdeeec5c17276ae9a48a6f}{y2};
1681     \textcolor{keyword}{register} \textcolor{keywordtype}{int} x, y;
1682     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structrm}{rm} *lev;
1683     \textcolor{keywordtype}{int} lowy = tmpregion->\hyperlink{structregion_a09c21dfa357e760d19824a94a79990bc}{y1};
1684     \textcolor{keywordtype}{int} lowx = tmpregion->\hyperlink{structregion_a80b426260fecceafe00d352ecf1b6705}{x1}, hix = tmpregion->\hyperlink{structregion_af0027dbdcdf1abf65a30619bd48c2862}{x2};
1685 
1686     \textcolor{keywordflow}{if}(litstate) \{
1687     \textcolor{comment}{/* adjust region size for walls, but only if lighted */}
1688     lowx = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(lowx-1,1);
1689     hix = \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(hix+1,\hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}-1);
1690     lowy = \hyperlink{hack_8h_affe776513b24d84b39af8ab0930fef7f}{max}(lowy-1,0);
1691     hiy = \hyperlink{hack_8h_abb702d8b501669a23aa0ab3b281b9384}{min}(hiy+1, \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}-1);
1692     \}
1693     \textcolor{keywordflow}{for}(x = lowx; x <= hix; x++) \{
1694     lev = &\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][lowy];
1695     \textcolor{keywordflow}{for}(y = lowy; y <= hiy; y++) \{
1696         \textcolor{keywordflow}{if} (lev->\hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} != \hyperlink{rm_8h_a610b535d9b5db82cd5617b7f2f1e06af}{LAVAPOOL}) \textcolor{comment}{/* this overrides normal lighting */}
1697         lev->lit = litstate;
1698         lev++;
1699     \}
1700     \}
1701 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a1de2e47ec9b5c68d80af96a35ec54c61}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!load\+\_\+common\+\_\+data@{load\+\_\+common\+\_\+data}}
\index{load\+\_\+common\+\_\+data@{load\+\_\+common\+\_\+data}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{load\+\_\+common\+\_\+data}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void load\+\_\+common\+\_\+data (
\begin{DoxyParamCaption}
\item[{{\bf dlb} $\ast$}]{fd, }
\item[{int}]{typ}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a1de2e47ec9b5c68d80af96a35ec54c61}


Definition at line 1705 of file sp\+\_\+lev.\+c.



References alloc(), A\+R\+B\+O\+R\+E\+A\+L, dlevel\+\_\+t\+::flags, Fread, H\+A\+R\+D\+F\+L\+O\+O\+R, lev\+\_\+flags, level, mkmap(), N\+O\+M\+M\+A\+P, N\+O\+T\+E\+L\+E\+P\+O\+R\+T, S\+H\+O\+R\+T\+S\+I\+G\+H\+T\+E\+D, and S\+P\+\_\+\+L\+E\+V\+\_\+\+M\+A\+Z\+E.



Referenced by load\+\_\+maze(), and load\+\_\+rooms().


\begin{DoxyCode}
1708 \{
1709     \hyperlink{config_8h_a65f85814a8290f9797005d3b28e7e5fc}{uchar}  n;
1710     \textcolor{keywordtype}{long}    \hyperlink{lev__yacc_8c_ac05e789cdec3ead539b13443070d03ea}{lev\_flags};
1711     \textcolor{keywordtype}{int} i;
1712 
1713       \{
1714     \hyperlink{align_8h_a3e17b7a656899892e425fc89481aa2ab}{aligntyp} atmp;
1715     \textcolor{comment}{/* shuffle 3 alignments; can't use sp\_lev\_shuffle() on aligntyp's */}
1716     i = rn2(3);   atmp=\hyperlink{sp__lev_8c_a2a0a619642f0bf17e690e1ab33a82b6c}{ralign}[2]; \hyperlink{sp__lev_8c_a2a0a619642f0bf17e690e1ab33a82b6c}{ralign}[2]=\hyperlink{sp__lev_8c_a2a0a619642f0bf17e690e1ab33a82b6c}{ralign}[i]; \hyperlink{sp__lev_8c_a2a0a619642f0bf17e690e1ab33a82b6c}{ralign}[i]=atmp;
1717     \textcolor{keywordflow}{if} (rn2(2)) \{ atmp=\hyperlink{sp__lev_8c_a2a0a619642f0bf17e690e1ab33a82b6c}{ralign}[1]; \hyperlink{sp__lev_8c_a2a0a619642f0bf17e690e1ab33a82b6c}{ralign}[1]=\hyperlink{sp__lev_8c_a2a0a619642f0bf17e690e1ab33a82b6c}{ralign}[0]; \hyperlink{sp__lev_8c_a2a0a619642f0bf17e690e1ab33a82b6c}{ralign}[0]=atmp; \}
1718       \}
1719 
1720     \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.is\_maze\_lev = \hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ} == \hyperlink{sp__lev_8h_acb33a58d540409b8f8e444cdbec90b8f}{SP\_LEV\_MAZE};
1721 
1722     \textcolor{comment}{/* Read the level initialization data */}
1723     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{sp__lev_8c_ac2ea43aa4412d3297d8af7faf0b1c927}{init\_lev}, 1, \textcolor{keyword}{sizeof}(\hyperlink{structlev__init}{lev\_init}), fd);
1724     \textcolor{keywordflow}{if}(init\_lev.init\_present) \{
1725         \textcolor{keywordflow}{if}(init\_lev.lit < 0)
1726         init\_lev.lit = rn2(2);
1727         \hyperlink{mkmap_8c_a76e9a8db64f065a236c615f278f5b98e}{mkmap}(&init\_lev);
1728     \}
1729 
1730     \textcolor{comment}{/* Read the per level flags */}
1731     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &lev\_flags, 1, \textcolor{keyword}{sizeof}(lev\_flags), fd);
1732     \textcolor{keywordflow}{if} (lev\_flags & \hyperlink{sp__lev_8h_a763a4f3408dd7a87d0372eeef3c95061}{NOTELEPORT})
1733         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.noteleport = 1;
1734     \textcolor{keywordflow}{if} (lev\_flags & \hyperlink{sp__lev_8h_afa881044c9a2507d8e00ea0a34716b65}{HARDFLOOR})
1735         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.hardfloor = 1;
1736     \textcolor{keywordflow}{if} (lev\_flags & \hyperlink{sp__lev_8h_af720a83fbb800f137fdc01d0a74ee4cb}{NOMMAP})
1737         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.nommap = 1;
1738     \textcolor{keywordflow}{if} (lev\_flags & \hyperlink{sp__lev_8h_aaf3c5f0dee4a82ec52bd20fbedfa30fb}{SHORTSIGHTED})
1739         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.shortsighted = 1;
1740     \textcolor{keywordflow}{if} (lev\_flags & \hyperlink{sp__lev_8h_a1d852e78cf8bfd3b32707d866b3dbde4}{ARBOREAL})
1741         \hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.arboreal = 1;
1742 
1743     \textcolor{comment}{/* Read message */}
1744     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
1745     \textcolor{keywordflow}{if} (n) \{
1746         \hyperlink{sp__lev_8c_a8a8cfd6f51acd4c0a227a5332be69227}{lev\_message} = (\textcolor{keywordtype}{char} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(n + 1);
1747         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) \hyperlink{sp__lev_8c_a8a8cfd6f51acd4c0a227a5332be69227}{lev\_message}, 1, (\textcolor{keywordtype}{int}) n, fd);
1748         lev\_message[n] = 0;
1749     \}
1750 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_ad577bf12221d2cd39282480d8e138391}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!load\+\_\+maze@{load\+\_\+maze}}
\index{load\+\_\+maze@{load\+\_\+maze}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{load\+\_\+maze}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} load\+\_\+maze (
\begin{DoxyParamCaption}
\item[{{\bf dlb} $\ast$}]{fd}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ad577bf12221d2cd39282480d8e138391}


Definition at line 2061 of file sp\+\_\+lev.\+c.



References abs(), add\+\_\+door(), add\+\_\+room(), alloc(), B\+O\+T\+T\+O\+M, C\+E\+N\+T\+E\+R, C\+O\+L\+N\+O, C\+O\+R\+R, create\+\_\+altar(), create\+\_\+engraving(), create\+\_\+feature(), create\+\_\+gold(), create\+\_\+monster(), create\+\_\+object(), create\+\_\+trap(), C\+R\+O\+S\+S\+W\+A\+L\+L, D\+\_\+\+C\+L\+O\+S\+E\+D, D\+O\+O\+R, doorindex, D\+O\+O\+R\+M\+A\+X, D\+R\+Y, F\+A\+L\+S\+E, Fgetc, fill\+\_\+room(), flood\+\_\+fill\+\_\+rm(), F\+O\+U\+N\+T\+A\+I\+N, Fread, Free, G\+E\+M\+\_\+\+C\+L\+A\+S\+S, get\+\_\+location(), H\+\_\+\+L\+E\+F\+T, H\+\_\+\+R\+I\+G\+H\+T, H\+O\+L\+E, H\+W\+A\+L\+L, mkroom\+::hx, mkroom\+::hy, lev\+\_\+init\+::init\+\_\+present, I\+R\+O\+N\+B\+A\+R\+S, mkroom\+::irregular, I\+S\+\_\+\+D\+O\+O\+R, I\+S\+\_\+\+W\+A\+L\+L, lev\+\_\+init\+::joined, L\+A\+\_\+\+D\+O\+W\+N, L\+A\+\_\+\+U\+P, L\+A\+D\+D\+E\+R, L\+A\+V\+A\+P\+O\+O\+L, L\+E\+F\+T, levl, light\+\_\+region(), load\+\_\+common\+\_\+data(), load\+\_\+one\+\_\+engraving(), load\+\_\+one\+\_\+monster(), load\+\_\+one\+\_\+object(), lregions, mkroom\+::lx, mkroom\+::ly, Map, M\+A\+X\+N\+R\+O\+F\+R\+O\+O\+M\+S, M\+A\+X\+R\+T\+Y\+P\+E, maze1xy(), mkstairs(), mm, mons, N\+O\+\_\+\+M\+M\+\_\+\+F\+L\+A\+G\+S, nroom, nwalk, O\+R\+O\+O\+M, panic(), P\+I\+T, R\+A\+N\+D\+O\+M\+\_\+\+C\+L\+A\+S\+S, remove\+\_\+rooms(), R\+I\+G\+H\+T, mkroom\+::rlit, rnddoor(), rndtrap(), R\+O\+O\+M, R\+O\+O\+M\+O\+F\+F\+S\+E\+T, rooms, R\+O\+W\+N\+O, S\+D\+O\+O\+R, set\+\_\+wall\+\_\+property(), S\+I\+Z\+E, S\+P\+\_\+\+L\+E\+V\+\_\+\+M\+A\+Z\+E, sp\+\_\+lev\+\_\+shuffle(), S\+P\+I\+K\+E\+D\+\_\+\+P\+I\+T, S\+T\+O\+N\+E, tmpaltar, tmpdb, tmpdig, tmpdoor, tmpengraving, tmpfountain, tmpgold, tmplad, tmpobj, tmpstair, tmptrap, tmpwalk, T\+O\+P, topologize(), T\+R\+A\+P\+D\+O\+O\+R, T\+R\+U\+E, rm\+::typ, u, you\+::uz, W\+\_\+\+E\+A\+S\+T, W\+\_\+\+N\+O\+N\+D\+I\+G\+G\+A\+B\+L\+E, W\+\_\+\+N\+O\+N\+P\+A\+S\+S\+W\+A\+L\+L, W\+\_\+\+N\+O\+R\+T\+H, W\+\_\+\+S\+O\+U\+T\+H, W\+\_\+\+W\+E\+S\+T, walkfrom(), wallification(), W\+E\+T, trap\+::x, coord\+::x, stair\+::x, x\+\_\+maze\+\_\+max, xdnladder, xsize, xupladder, trap\+::y, coord\+::y, stair\+::y, y\+\_\+maze\+\_\+max, ydnladder, ysize, and yupladder.



Referenced by load\+\_\+special().


\begin{DoxyCode}
2063 \{
2064     \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar}   x, y, \hyperlink{structrm_aa144ade377ba175f037c4e637329d4dc}{typ};
2065     \textcolor{keywordtype}{boolean} prefilled, room\_not\_needed;
2066 
2067     \textcolor{keywordtype}{char}    n, numpart = 0;
2068     \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar}   \hyperlink{lev__yacc_8c_adcac2df39079d4dddf121ca3ea57a22b}{nwalk} = 0, nwalk\_sav;
2069     \hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar}   filling;
2070     \textcolor{keywordtype}{char}    halign, valign;
2071 
2072     \textcolor{keywordtype}{int}     xi, dir, \hyperlink{structsize}{size};
2073     \hyperlink{structcoord}{coord}   \hyperlink{celib_8c_a378f364ce8f01015f43ce168ea8afd39}{mm};
2074     \textcolor{keywordtype}{int}     mapcount, mapcountmax, mapfact;
2075 
2076     \hyperlink{structlev__region}{lev\_region}  tmplregion;
2077     \hyperlink{structregion}{region}  tmpregion;
2078     \hyperlink{structdoor}{door}    \hyperlink{lev__yacc_8c_a33a3fc663ec24d7fcf132b0f48b9d329}{tmpdoor};
2079     \hyperlink{structtrap}{trap}    \hyperlink{lev__yacc_8c_a753379af408004874d260e05cf1ecbcf}{tmptrap};
2080     \hyperlink{structmonster}{monster} tmpmons;
2081     \textcolor{keywordtype}{object}  \hyperlink{lev__yacc_8c_a285e426f5dfbf870609567a7fa421305}{tmpobj};
2082     \hyperlink{structdrawbridge}{drawbridge} \hyperlink{lev__yacc_8c_a3d2b61ec250389197c95272ff5c9f525}{tmpdb};
2083     \hyperlink{structwalk}{walk}    \hyperlink{lev__yacc_8c_a74ff27b28e1b028593b65e09486a068f}{tmpwalk};
2084     \hyperlink{structdigpos}{digpos}  \hyperlink{lev__yacc_8c_a7afb466d14480c800df0e4a6caf9dd0a}{tmpdig};
2085     \hyperlink{structlad}{lad}     \hyperlink{lev__yacc_8c_ad1941ad660855ec844450ca55ab43e2d}{tmplad};
2086     \hyperlink{structstair}{stair}   \hyperlink{lev__yacc_8c_a3cd03a41a25593dc30c39265c3d9c9e9}{tmpstair}, prevstair;
2087     \hyperlink{structaltar}{altar}   \hyperlink{lev__yacc_8c_a28ea45bf3d1a5ae09655102939eda1da}{tmpaltar};
2088     \hyperlink{structgold}{gold}    \hyperlink{lev__yacc_8c_a1ce6a22779cded1be3cd549b44e9fa4b}{tmpgold};
2089     \hyperlink{structfountain}{fountain} \hyperlink{lev__yacc_8c_a8f1a008d2b2d2a6049a87e02e8286969}{tmpfountain};
2090     \hyperlink{structengraving}{engraving} \hyperlink{lev__yacc_8c_a1ba86b2bb794c93997a2268fc8a8557b}{tmpengraving};
2091     \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar}   mustfill[(\hyperlink{global_8h_ac93f3a160c2f2a9c3d201c505b0a5811}{MAXNROFROOMS}+1)*2];
2092     \textcolor{keyword}{struct }\hyperlink{structtrap}{trap} *badtrap;
2093     \textcolor{keywordtype}{boolean} has\_bounds;
2094 
2095     (void) memset((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})&\hyperlink{sp__lev_8c_a8759e0f6c69dca527985b85d1c66dc9c}{Map}[0][0], 0, \textcolor{keyword}{sizeof} \hyperlink{sp__lev_8c_a8759e0f6c69dca527985b85d1c66dc9c}{Map});
2096     \hyperlink{sp__lev_8c_a1de2e47ec9b5c68d80af96a35ec54c61}{load\_common\_data}(fd, \hyperlink{sp__lev_8h_acb33a58d540409b8f8e444cdbec90b8f}{SP\_LEV\_MAZE});
2097 
2098     \textcolor{comment}{/* Initialize map */}
2099     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &filling, 1, \textcolor{keyword}{sizeof}(filling), fd);
2100     \textcolor{keywordflow}{if} (!\hyperlink{sp__lev_8c_ac2ea43aa4412d3297d8af7faf0b1c927}{init\_lev}.\hyperlink{structlev__init_a3f0200a1efa4d4f3f16260524839036e}{init\_present}) \{ \textcolor{comment}{/* don't init if mkmap() has been called */}
2101       \textcolor{keywordflow}{for}(x = 2; x <= \hyperlink{decl_8h_a5a8f3e210dcf5e1b8319f220200f7e91}{x\_maze\_max}; x++)
2102     \textcolor{keywordflow}{for}(y = 0; y <= \hyperlink{decl_8h_a148ae7e81a85b4cab11815530f82da17}{y\_maze\_max}; y++)
2103         \textcolor{keywordflow}{if} (filling == -1) \{
2104 \textcolor{preprocessor}{#ifndef WALLIFIED\_MAZE}
2105             \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{structtrap_aed25254cf556e3eae09dd98576d98d45}{x}][\hyperlink{structtrap_a3c7f72724bfcd0c4acb2a05ee75064df}{y}].typ = \hyperlink{rm_8h_a3a50d6c3dd0fbb5b801d6efe0279d267}{STONE};
2106 \textcolor{preprocessor}{#else}
2107             \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{structtrap_aed25254cf556e3eae09dd98576d98d45}{x}][\hyperlink{structtrap_a3c7f72724bfcd0c4acb2a05ee75064df}{y}].typ =
2108             (y < 2 || ((x % 2) && (y % 2))) ? \hyperlink{rm_8h_a3a50d6c3dd0fbb5b801d6efe0279d267}{STONE} : \hyperlink{rm_8h_a3fcd4705d7b0ac05a88302170fcc58f5}{HWALL};
2109 \textcolor{preprocessor}{#endif}
2110         \} \textcolor{keywordflow}{else} \{
2111             \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{structtrap_aed25254cf556e3eae09dd98576d98d45}{x}][\hyperlink{structtrap_a3c7f72724bfcd0c4acb2a05ee75064df}{y}].typ = filling;
2112         \}
2113     \}
2114 
2115     \textcolor{comment}{/* Start reading the file */}
2116     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &numpart, 1, \textcolor{keyword}{sizeof}(numpart), fd);
2117                         \textcolor{comment}{/* Number of parts */}
2118     \textcolor{keywordflow}{if} (!numpart || numpart > 9)
2119     \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"load\_maze error: numpart = %d"}, (\textcolor{keywordtype}{int}) numpart);
2120 
2121     \textcolor{keywordflow}{while} (numpart--) \{
2122     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &halign, 1, \textcolor{keyword}{sizeof}(halign), fd);
2123                     \textcolor{comment}{/* Horizontal alignment */}
2124     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &valign, 1, \textcolor{keyword}{sizeof}(valign), fd);
2125                     \textcolor{comment}{/* Vertical alignment */}
2126     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{sp__lev_8c_a22122ed2c15d87f3ff9e3dad23423244}{xsize}, 1, \textcolor{keyword}{sizeof}(xsize), fd);
2127                     \textcolor{comment}{/* size in X */}
2128     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &\hyperlink{sp__lev_8c_a17f6fa5b5051ab79afe70d9598576009}{ysize}, 1, \textcolor{keyword}{sizeof}(ysize), fd);
2129                     \textcolor{comment}{/* size in Y */}
2130     \textcolor{keywordflow}{switch}((\textcolor{keywordtype}{int}) halign) \{
2131         \textcolor{keywordflow}{case} \hyperlink{sp__lev_8c_a437ef08681e7210d6678427030446a54}{LEFT}:      \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart} = 3;                   \textcolor{keywordflow}{break};
2132         \textcolor{keywordflow}{case} \hyperlink{sp__lev_8c_af6b40fe268805d81d6a5d448873f910e}{H\_LEFT}:    \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart} = 2+((\hyperlink{decl_8h_a5a8f3e210dcf5e1b8319f220200f7e91}{x\_maze\_max}-2-\hyperlink{sp__lev_8c_a22122ed2c15d87f3ff9e3dad23423244}{xsize})/4); \textcolor{keywordflow}{break};
2133         \textcolor{keywordflow}{case} \hyperlink{sp__lev_8c_a824fea1f256659e11e6cd8c82cb13338}{CENTER}:    \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart} = 2+((\hyperlink{decl_8h_a5a8f3e210dcf5e1b8319f220200f7e91}{x\_maze\_max}-2-\hyperlink{sp__lev_8c_a22122ed2c15d87f3ff9e3dad23423244}{xsize})/2); \textcolor{keywordflow}{break};
2134         \textcolor{keywordflow}{case} \hyperlink{sp__lev_8c_ab3d394d63fa2de33a942bd63775c45e5}{H\_RIGHT}:   \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart} = 2+((\hyperlink{decl_8h_a5a8f3e210dcf5e1b8319f220200f7e91}{x\_maze\_max}-2-\hyperlink{sp__lev_8c_a22122ed2c15d87f3ff9e3dad23423244}{xsize})*3/4);  \textcolor{keywordflow}{break};
2135         \textcolor{keywordflow}{case} \hyperlink{sp__lev_8c_a80fb826a684cf3f0d306b22aa100ddac}{RIGHT}:     \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart} = \hyperlink{decl_8h_a5a8f3e210dcf5e1b8319f220200f7e91}{x\_maze\_max}-xsize-1;       \textcolor{keywordflow}{break};
2136     \}
2137     \textcolor{keywordflow}{switch}((\textcolor{keywordtype}{int}) valign) \{
2138         \textcolor{keywordflow}{case} \hyperlink{sp__lev_8c_afc0eef637f1016e8786e45e106a4881e}{TOP}:        \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart} = 3;                   \textcolor{keywordflow}{break};
2139         \textcolor{keywordflow}{case} \hyperlink{sp__lev_8c_a824fea1f256659e11e6cd8c82cb13338}{CENTER}:    \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart} = 2+((\hyperlink{decl_8h_a148ae7e81a85b4cab11815530f82da17}{y\_maze\_max}-2-\hyperlink{sp__lev_8c_a17f6fa5b5051ab79afe70d9598576009}{ysize})/2); \textcolor{keywordflow}{break};
2140         \textcolor{keywordflow}{case} \hyperlink{sp__lev_8c_ae420caa0af9cbdf102ed255034e27c5b}{BOTTOM}:    \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart} = \hyperlink{decl_8h_a148ae7e81a85b4cab11815530f82da17}{y\_maze\_max}-ysize-1;      \textcolor{keywordflow}{break};
2141     \}
2142     \textcolor{keywordflow}{if} (!(\hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart} % 2)) \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart}++;
2143     \textcolor{keywordflow}{if} (!(\hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart} % 2)) \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart}++;
2144     \textcolor{keywordflow}{if} ((\hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart} < 0) || (\hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart} + ysize > \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO})) \{
2145         \textcolor{comment}{/* try to move the start a bit */}
2146         \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart} += (\hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart} > 0) ? -2 : 2;
2147         \textcolor{keywordflow}{if}(ysize == \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}) \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart} = 0;
2148         \textcolor{keywordflow}{if}(ystart < 0 || ystart + ysize > \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO})
2149         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"reading special level with ysize too large"});
2150     \}
2151 
2152     \textcolor{comment}{/*}
2153 \textcolor{comment}{     * If any CROSSWALLs are found, must change to ROOM after REGION's}
2154 \textcolor{comment}{     * are laid out.  CROSSWALLS are used to specify "invisible"}
2155 \textcolor{comment}{     * boundaries where DOOR syms look bad or aren't desirable.}
2156 \textcolor{comment}{     */}
2157     has\_bounds = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2158 
2159     \textcolor{keywordflow}{if}(\hyperlink{sp__lev_8c_ac2ea43aa4412d3297d8af7faf0b1c927}{init\_lev}.\hyperlink{structlev__init_a3f0200a1efa4d4f3f16260524839036e}{init\_present} && xsize <= 1 && ysize <= 1) \{
2160         \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart} = 1;
2161         \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart} = 0;
2162         xsize = \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}-1;
2163         ysize = \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO};
2164     \} \textcolor{keywordflow}{else} \{
2165         \textcolor{comment}{/* Load the map */}
2166         \textcolor{keywordflow}{for}(y = \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart}; y < \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart}+\hyperlink{sp__lev_8c_a17f6fa5b5051ab79afe70d9598576009}{ysize}; y++)
2167         \textcolor{keywordflow}{for}(x = \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart}; x < \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart}+\hyperlink{sp__lev_8c_a22122ed2c15d87f3ff9e3dad23423244}{xsize}; x++) \{
2168             \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{structtrap_aed25254cf556e3eae09dd98576d98d45}{x}][\hyperlink{structtrap_a3c7f72724bfcd0c4acb2a05ee75064df}{y}].typ = \hyperlink{sp__lev_8c_a98383dc3546cc8c17cd5c8e4d593d1ac}{Fgetc}(fd);
2169             \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{structtrap_aed25254cf556e3eae09dd98576d98d45}{x}][\hyperlink{structtrap_a3c7f72724bfcd0c4acb2a05ee75064df}{y}].lit = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2170             \textcolor{comment}{/* clear out levl: load\_common\_data may set them */}
2171             \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{structtrap_aed25254cf556e3eae09dd98576d98d45}{x}][\hyperlink{structtrap_a3c7f72724bfcd0c4acb2a05ee75064df}{y}].flags = 0;
2172             \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{structtrap_aed25254cf556e3eae09dd98576d98d45}{x}][\hyperlink{structtrap_a3c7f72724bfcd0c4acb2a05ee75064df}{y}].horizontal = 0;
2173             \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{structtrap_aed25254cf556e3eae09dd98576d98d45}{x}][\hyperlink{structtrap_a3c7f72724bfcd0c4acb2a05ee75064df}{y}].roomno = 0;
2174             \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{structtrap_aed25254cf556e3eae09dd98576d98d45}{x}][\hyperlink{structtrap_a3c7f72724bfcd0c4acb2a05ee75064df}{y}].edge = 0;
2175             \textcolor{comment}{/*}
2176 \textcolor{comment}{             * Note: Even though levl[x][y].typ is type schar,}
2177 \textcolor{comment}{             *   lev\_comp.y saves it as type char. Since schar != char}
2178 \textcolor{comment}{             *   all the time we must make this exception or hack}
2179 \textcolor{comment}{             *   through lev\_comp.y to fix.}
2180 \textcolor{comment}{             */}
2181 
2182             \textcolor{comment}{/*}
2183 \textcolor{comment}{             *  Set secret doors to closed (why not trapped too?).  Set}
2184 \textcolor{comment}{             *  the horizontal bit.}
2185 \textcolor{comment}{             */}
2186             \textcolor{keywordflow}{if} (\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ == \hyperlink{rm_8h_a03fd0fa1e0dbd19ea38dff0c79e656a5}{SDOOR} || \hyperlink{rm_8h_a44de5677b6310b3b96cad756e24b59d9}{IS\_DOOR}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ)) \{
2187             \textcolor{keywordflow}{if}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ == \hyperlink{rm_8h_a03fd0fa1e0dbd19ea38dff0c79e656a5}{SDOOR})
2188                 \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{structtrap_aed25254cf556e3eae09dd98576d98d45}{x}][\hyperlink{structtrap_a3c7f72724bfcd0c4acb2a05ee75064df}{y}].doormask = \hyperlink{rm_8h_a65f9ce7db71ac3d4c13edfe69732ec9a}{D\_CLOSED};
2189             \textcolor{comment}{/*}
2190 \textcolor{comment}{             *  If there is a wall to the left that connects to a}
2191 \textcolor{comment}{             *  (secret) door, then it is horizontal.  This does}
2192 \textcolor{comment}{             *  not allow (secret) doors to be corners of rooms.}
2193 \textcolor{comment}{             */}
2194             \textcolor{keywordflow}{if} (x != \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart} && (\hyperlink{rm_8h_a6bd7f45ec1e1ccd558d188e16a566208}{IS\_WALL}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x-1][y].typ) ||
2195                         \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x-1][y].horizontal))
2196                 \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{structtrap_aed25254cf556e3eae09dd98576d98d45}{x}][\hyperlink{structtrap_a3c7f72724bfcd0c4acb2a05ee75064df}{y}].horizontal = 1;
2197             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ == \hyperlink{rm_8h_a3fcd4705d7b0ac05a88302170fcc58f5}{HWALL} ||
2198                 \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ == \hyperlink{rm_8h_a07f57c69899f8f8d0746fea20d262022}{IRONBARS})
2199             \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{structtrap_aed25254cf556e3eae09dd98576d98d45}{x}][\hyperlink{structtrap_a3c7f72724bfcd0c4acb2a05ee75064df}{y}].horizontal = 1;
2200             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ == \hyperlink{rm_8h_a610b535d9b5db82cd5617b7f2f1e06af}{LAVAPOOL})
2201             \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[\hyperlink{structtrap_aed25254cf556e3eae09dd98576d98d45}{x}][\hyperlink{structtrap_a3c7f72724bfcd0c4acb2a05ee75064df}{y}].lit = 1;
2202             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ == \hyperlink{rm_8h_ac2a0c94b5722b98d84af548563e71d2f}{CROSSWALL})
2203             has\_bounds = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
2204             \hyperlink{sp__lev_8c_a8759e0f6c69dca527985b85d1c66dc9c}{Map}[\hyperlink{structtrap_aed25254cf556e3eae09dd98576d98d45}{x}][\hyperlink{structtrap_a3c7f72724bfcd0c4acb2a05ee75064df}{y}] = 1;
2205         \}
2206         \textcolor{keywordflow}{if} (\hyperlink{sp__lev_8c_ac2ea43aa4412d3297d8af7faf0b1c927}{init\_lev}.\hyperlink{structlev__init_a3f0200a1efa4d4f3f16260524839036e}{init\_present} && \hyperlink{sp__lev_8c_ac2ea43aa4412d3297d8af7faf0b1c927}{init\_lev}.\hyperlink{structlev__init_af7653a4a64cf753edc423d2ea2734a8d}{joined})
2207         \hyperlink{mkmap_8c_a915dcdbcbcc4653fd0f3c2311b4d7e85}{remove\_rooms}(\hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart}, \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart}, \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart}+xsize, 
      \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart}+ysize);
2208     \}
2209 
2210     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2211                         \textcolor{comment}{/* Number of level regions */}
2212     \textcolor{keywordflow}{if}(n) \{
2213         \textcolor{keywordflow}{if}(\hyperlink{sp__lev_8c_a1f90034b6a3d7de0cba06ae8960de3ea}{num\_lregions}) \{
2214         \textcolor{comment}{/* realloc the lregion space to add the new ones */}
2215         \textcolor{comment}{/* don't really free it up until the whole level is done */}
2216         \hyperlink{structlev__region}{lev\_region} *newl = (\hyperlink{structlev__region}{lev\_region} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(\textcolor{keyword}{sizeof}(
      \hyperlink{structlev__region}{lev\_region}) *
2217                         (unsigned)(n+\hyperlink{sp__lev_8c_a1f90034b6a3d7de0cba06ae8960de3ea}{num\_lregions}));
2218         (void) memcpy((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})(newl+n), (\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})
      \hyperlink{sp__lev_8c_a5195d0e282f5603843e4a384e9995caa}{lregions},
2219                     \textcolor{keyword}{sizeof}(\hyperlink{structlev__region}{lev\_region}) * \hyperlink{sp__lev_8c_a1f90034b6a3d7de0cba06ae8960de3ea}{num\_lregions});
2220         \hyperlink{sp__lev_8c_a0b8e3b7d52eecc10d64e8242fc30c816}{Free}(\hyperlink{sp__lev_8c_a5195d0e282f5603843e4a384e9995caa}{lregions});
2221         \hyperlink{sp__lev_8c_a1f90034b6a3d7de0cba06ae8960de3ea}{num\_lregions} += n;
2222         \hyperlink{sp__lev_8c_a5195d0e282f5603843e4a384e9995caa}{lregions} = newl;
2223         \} \textcolor{keywordflow}{else} \{
2224         \hyperlink{sp__lev_8c_a1f90034b6a3d7de0cba06ae8960de3ea}{num\_lregions} = n;
2225         \hyperlink{sp__lev_8c_a5195d0e282f5603843e4a384e9995caa}{lregions} = (\hyperlink{structlev__region}{lev\_region} *)
2226                 \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}(\textcolor{keyword}{sizeof}(\hyperlink{structlev__region}{lev\_region}) * (unsigned)n);
2227         \}
2228     \}
2229 
2230     \textcolor{keywordflow}{while}(n--) \{
2231         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &tmplregion, \textcolor{keyword}{sizeof}(tmplregion), 1, fd);
2232         \textcolor{keywordflow}{if} ((size = tmplregion.rname.len) != 0) \{
2233         tmplregion.rname.str = (\textcolor{keywordtype}{char} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}((\textcolor{keywordtype}{unsigned})size + 1);
2234         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) tmplregion.rname.str, size, 1, fd);
2235         tmplregion.rname.str[size] = \textcolor{charliteral}{'\(\backslash\)0'};
2236         \} \textcolor{keywordflow}{else}
2237         tmplregion.rname.str = (\textcolor{keywordtype}{char} *) 0;
2238         \textcolor{keywordflow}{if}(!tmplregion.in\_islev) \{
2239         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&tmplregion.inarea.x1, &tmplregion.inarea.y1,
2240                                 \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY}|\hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{WET});
2241         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&tmplregion.inarea.x2, &tmplregion.inarea.y2,
2242                                 \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY}|\hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{WET});
2243         \}
2244         \textcolor{keywordflow}{if}(!tmplregion.del\_islev) \{
2245         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&tmplregion.delarea.x1, &tmplregion.delarea.y1,
2246                                 \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY}|\hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{WET});
2247         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&tmplregion.delarea.x2, &tmplregion.delarea.y2,
2248                                 \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY}|\hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{WET});
2249         \}
2250         \hyperlink{sp__lev_8c_a5195d0e282f5603843e4a384e9995caa}{lregions}[(int)n] = tmplregion;
2251     \}
2252 
2253     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2254                         \textcolor{comment}{/* Random objects */}
2255     \textcolor{keywordflow}{if}(n) \{
2256         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})\hyperlink{sp__lev_8c_a4c62499de047bc3a15f32e4f14c00c66}{robjects}, \textcolor{keyword}{sizeof}(*robjects), (\textcolor{keywordtype}{int}) n, fd);
2257         \hyperlink{sp__lev_8c_a319f933b60e9c45af293065eeb52bde8}{sp\_lev\_shuffle}(robjects, (\textcolor{keywordtype}{char} *)0, (\textcolor{keywordtype}{int})n);
2258     \}
2259 
2260     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2261                         \textcolor{comment}{/* Random locations */}
2262     \textcolor{keywordflow}{if}(n) \{
2263         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})\hyperlink{sp__lev_8c_a6179f3acad257eb4f3057010c6a6d187}{rloc\_x}, \textcolor{keyword}{sizeof}(*rloc\_x), (\textcolor{keywordtype}{int}) n, fd);
2264         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})\hyperlink{sp__lev_8c_a42c30954e08e02960a5096ed70009726}{rloc\_y}, \textcolor{keyword}{sizeof}(*rloc\_y), (\textcolor{keywordtype}{int}) n, fd);
2265         \hyperlink{sp__lev_8c_a319f933b60e9c45af293065eeb52bde8}{sp\_lev\_shuffle}(rloc\_x, rloc\_y, (\textcolor{keywordtype}{int})n);
2266     \}
2267 
2268     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2269                         \textcolor{comment}{/* Random monsters */}
2270     \textcolor{keywordflow}{if}(n) \{
2271         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})\hyperlink{sp__lev_8c_af35c3f24113af660b5d6e6b4105032e0}{rmonst}, \textcolor{keyword}{sizeof}(*rmonst), (\textcolor{keywordtype}{int}) n, fd);
2272         \hyperlink{sp__lev_8c_a319f933b60e9c45af293065eeb52bde8}{sp\_lev\_shuffle}(rmonst, (\textcolor{keywordtype}{char} *)0, (\textcolor{keywordtype}{int})n);
2273     \}
2274 
2275     (void) memset((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})mustfill, 0, \textcolor{keyword}{sizeof}(mustfill));
2276     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2277                         \textcolor{comment}{/* Number of subrooms */}
2278     \textcolor{keywordflow}{while}(n--) \{
2279         \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structmkroom}{mkroom} *troom;
2280 
2281         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})&tmpregion, 1, \textcolor{keyword}{sizeof}(tmpregion), fd);
2282 
2283         \textcolor{keywordflow}{if}(tmpregion.rtype > \hyperlink{mkroom_8h_a7a6bbaa03f26e9e8517c84aa609c1b41}{MAXRTYPE}) \{
2284             tmpregion.rtype -= \hyperlink{mkroom_8h_a7a6bbaa03f26e9e8517c84aa609c1b41}{MAXRTYPE}+1;
2285             prefilled = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
2286         \} \textcolor{keywordflow}{else}
2287             prefilled = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2288 
2289         \textcolor{keywordflow}{if}(tmpregion.rlit < 0)
2290             tmpregion.rlit = (rnd(1+\hyperlink{amidos_8c_a196e7f007a501cf9d0907cb2bab0b622}{abs}(depth(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz}))) < 11 && rn2(77))
2291             ? \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} : \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2292 
2293         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&tmpregion.x1, &tmpregion.y1, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY}|\hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{WET});
2294         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&tmpregion.x2, &tmpregion.y2, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY}|\hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{WET});
2295 
2296         \textcolor{comment}{/* for an ordinary room, `prefilled' is a flag to force}
2297 \textcolor{comment}{           an actual room to be created (such rooms are used to}
2298 \textcolor{comment}{           control placement of migrating monster arrivals) */}
2299         room\_not\_needed = (tmpregion.rtype == \hyperlink{mkroom_8h_a24fe7e4ef6dbb56e7d2570a7ac640d71}{OROOM} &&
2300                    !tmpregion.rirreg && !prefilled);
2301         \textcolor{keywordflow}{if} (room\_not\_needed || \hyperlink{decl_8h_a5f1394ad444ca9a0b5e47123e8c454d9}{nroom} >= \hyperlink{global_8h_ac93f3a160c2f2a9c3d201c505b0a5811}{MAXNROFROOMS}) \{
2302             \textcolor{keywordflow}{if} (!room\_not\_needed)
2303             impossible(\textcolor{stringliteral}{"Too many rooms on new level!"});
2304             \hyperlink{sp__lev_8c_a90554aa410a51a4252d734f0d3815685}{light\_region}(&tmpregion);
2305             \textcolor{keywordflow}{continue};
2306         \}
2307 
2308         troom = &\hyperlink{mkroom_8h_a45030df62e6451e79233760364dca9e1}{rooms}[\hyperlink{decl_8h_a5f1394ad444ca9a0b5e47123e8c454d9}{nroom}];
2309 
2310         \textcolor{comment}{/* mark rooms that must be filled, but do it later */}
2311         \textcolor{keywordflow}{if} (tmpregion.rtype != \hyperlink{mkroom_8h_a24fe7e4ef6dbb56e7d2570a7ac640d71}{OROOM})
2312             mustfill[\hyperlink{decl_8h_a5f1394ad444ca9a0b5e47123e8c454d9}{nroom}] = (prefilled ? 2 : 1);
2313 
2314         \textcolor{keywordflow}{if}(tmpregion.rirreg) \{
2315             \hyperlink{sp__lev_8c_a894604b3687b9ef24fbd3860e4975fd3}{min\_rx} = \hyperlink{sp__lev_8c_abc15291b7b86b60e0c490c8e8cbe0e51}{max\_rx} = tmpregion.x1;
2316             \hyperlink{sp__lev_8c_ad85187115f92107d269ef993f80036f0}{min\_ry} = \hyperlink{sp__lev_8c_aedc93067a733f3fa903cf92c7b0cff4e}{max\_ry} = tmpregion.y1;
2317             \hyperlink{mkmap_8c_a88f49707103159575309f6dd6b961199}{flood\_fill\_rm}(tmpregion.x1, tmpregion.y1,
2318                   \hyperlink{decl_8h_a5f1394ad444ca9a0b5e47123e8c454d9}{nroom}+\hyperlink{mkroom_8h_acc0f2416007c594c5d38f980dedc1b68}{ROOMOFFSET}, tmpregion.rlit, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
2319             \hyperlink{mklev_8c_a5bfd1137aab85b0e7ee01c7c008e2cd6}{add\_room}(\hyperlink{sp__lev_8c_a894604b3687b9ef24fbd3860e4975fd3}{min\_rx}, \hyperlink{sp__lev_8c_ad85187115f92107d269ef993f80036f0}{min\_ry}, \hyperlink{sp__lev_8c_abc15291b7b86b60e0c490c8e8cbe0e51}{max\_rx}, \hyperlink{sp__lev_8c_aedc93067a733f3fa903cf92c7b0cff4e}{max\_ry},
2320                  \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, tmpregion.rtype, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
2321             troom->\hyperlink{structmkroom_a3c07fba081cb449add4c4cc858541b16}{rlit} = tmpregion.rlit;
2322             troom->\hyperlink{structmkroom_a394c3dd48b7fc60e0098c41afde6d6e8}{irregular} = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
2323         \} \textcolor{keywordflow}{else} \{
2324             \hyperlink{mklev_8c_a5bfd1137aab85b0e7ee01c7c008e2cd6}{add\_room}(tmpregion.x1, tmpregion.y1,
2325                  tmpregion.x2, tmpregion.y2,
2326                  tmpregion.rlit, tmpregion.rtype, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
2327 \textcolor{preprocessor}{#ifdef SPECIALIZATION}
2328             \hyperlink{mklev_8c_ac3aecaa5e9dbd24cb58763276451439c}{topologize}(troom,\hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});     \textcolor{comment}{/* set roomno */}
2329 \textcolor{preprocessor}{#else}
2330             \hyperlink{mklev_8c_ac3aecaa5e9dbd24cb58763276451439c}{topologize}(troom);            \textcolor{comment}{/* set roomno */}
2331 \textcolor{preprocessor}{#endif}
2332         \}
2333     \}
2334 
2335     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2336                         \textcolor{comment}{/* Number of doors */}
2337     \textcolor{keywordflow}{while}(n--) \{
2338         \textcolor{keyword}{struct }\hyperlink{structmkroom}{mkroom} *croom = &\hyperlink{mkroom_8h_a45030df62e6451e79233760364dca9e1}{rooms}[0];
2339 
2340         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})&tmpdoor, 1, \textcolor{keyword}{sizeof}(tmpdoor), fd);
2341 
2342         x = tmpdoor.x;  y = tmpdoor.y;
2343         typ = tmpdoor.mask == -1 ? \hyperlink{sp__lev_8c_a4afc679d2766b5aac3e3d2d9c3737efe}{rnddoor}() : tmpdoor.mask;
2344 
2345         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&x, &y, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY});
2346         \textcolor{keywordflow}{if}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ != \hyperlink{rm_8h_a03fd0fa1e0dbd19ea38dff0c79e656a5}{SDOOR})
2347             \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ = \hyperlink{rm_8h_aa19093eb0aa5c5af9c27464ae8f0d2de}{DOOR};
2348         \textcolor{keywordflow}{else} \{
2349             \textcolor{keywordflow}{if}(typ < \hyperlink{rm_8h_a65f9ce7db71ac3d4c13edfe69732ec9a}{D\_CLOSED})
2350                 typ = \hyperlink{rm_8h_a65f9ce7db71ac3d4c13edfe69732ec9a}{D\_CLOSED}; \textcolor{comment}{/* force it to be closed */}
2351         \}
2352         \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].doormask = typ;
2353 
2354         \textcolor{comment}{/* Now the complicated part, list it with each subroom */}
2355         \textcolor{comment}{/* The dog move and mail daemon routines use this */}
2356         \textcolor{keywordflow}{while}(croom->\hyperlink{structmkroom_a1b738b591a7735add2af6d918c556543}{hx} >= 0 && \hyperlink{decl_8h_a1982a8fa5c64011b962995dac72b6eff}{doorindex} < \hyperlink{global_8h_a7213d21e4bbb1af3d5e0588552e0f22c}{DOORMAX}) \{
2357             \textcolor{keywordflow}{if}(croom->\hyperlink{structmkroom_a1b738b591a7735add2af6d918c556543}{hx} >= x-1 && croom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx} <= x+1 &&
2358                croom->\hyperlink{structmkroom_aa767bcbf6e0de868bba6d2a1c7e7182e}{hy} >= y-1 && croom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly} <= y+1) \{
2359             \textcolor{comment}{/* Found it */}
2360             \hyperlink{mklev_8c_abfbeba318d849971ade63038b45c638e}{add\_door}(x, y, croom);
2361             \}
2362             croom++;
2363         \}
2364     \}
2365 
2366     \textcolor{comment}{/* now that we have rooms \_and\_ associated doors, fill the rooms */}
2367     \textcolor{keywordflow}{for}(n = 0; n < \hyperlink{global_8h_afd2537d19a3cb6556b0f727580ec6ee7}{SIZE}(mustfill); n++)
2368         \textcolor{keywordflow}{if}(mustfill[(\textcolor{keywordtype}{int})n])
2369         \hyperlink{sp__lev_8c_a4e02bf4c52efa86f7646872d6ef341cb}{fill\_room}(&\hyperlink{mkroom_8h_a45030df62e6451e79233760364dca9e1}{rooms}[(\textcolor{keywordtype}{int})n], (mustfill[(int)n] == 2));
2370 
2371     \textcolor{comment}{/* if special boundary syms (CROSSWALL) in map, remove them now */}
2372     \textcolor{keywordflow}{if}(has\_bounds) \{
2373         \textcolor{keywordflow}{for}(x = \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart}; x < \hyperlink{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{xstart}+\hyperlink{sp__lev_8c_a22122ed2c15d87f3ff9e3dad23423244}{xsize}; x++)
2374         \textcolor{keywordflow}{for}(y = \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart}; y < \hyperlink{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{ystart}+\hyperlink{sp__lev_8c_a17f6fa5b5051ab79afe70d9598576009}{ysize}; y++)
2375             \textcolor{keywordflow}{if}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ == \hyperlink{rm_8h_ac2a0c94b5722b98d84af548563e71d2f}{CROSSWALL})
2376             \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ = \hyperlink{rm_8h_ae635489e987ae17a3bf884376cc2fe34}{ROOM};
2377     \}
2378 
2379     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2380                         \textcolor{comment}{/* Number of drawbridges */}
2381     \textcolor{keywordflow}{while}(n--) \{
2382         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})&tmpdb, 1, \textcolor{keyword}{sizeof}(tmpdb), fd);
2383 
2384         x = tmpdb.x;  y = tmpdb.y;
2385         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&x, &y, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY}|\hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{WET});
2386 
2387         \textcolor{keywordflow}{if} (!create\_drawbridge(x, y, tmpdb.dir, tmpdb.db\_open))
2388             impossible(\textcolor{stringliteral}{"Cannot create drawbridge."});
2389     \}
2390 
2391     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2392                         \textcolor{comment}{/* Number of mazewalks */}
2393     \textcolor{keywordflow}{while}(n--) \{
2394         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})&tmpwalk, 1, \textcolor{keyword}{sizeof}(tmpwalk), fd);
2395 
2396         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&tmpwalk.x, &tmpwalk.y, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY}|\hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{WET});
2397 
2398         \hyperlink{sp__lev_8c_a31e63fe41665cf88ce4da8060a209b78}{walklist}[nwalk++] = \hyperlink{lev__yacc_8c_a74ff27b28e1b028593b65e09486a068f}{tmpwalk};
2399     \}
2400 
2401     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2402                         \textcolor{comment}{/* Number of non\_diggables */}
2403     \textcolor{keywordflow}{while}(n--) \{
2404         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})&tmpdig, 1, \textcolor{keyword}{sizeof}(tmpdig), fd);
2405 
2406         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&tmpdig.x1, &tmpdig.y1, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY}|\hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{WET});
2407         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&tmpdig.x2, &tmpdig.y2, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY}|\hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{WET});
2408 
2409         \hyperlink{sp__lev_8c_ac3e80e7bc7afed094c7af15df57677fd}{set\_wall\_property}(tmpdig.x1, tmpdig.y1,
2410                   tmpdig.x2, tmpdig.y2, \hyperlink{rm_8h_a55ee3cac4981ccaa6d27954589000595}{W\_NONDIGGABLE});
2411     \}
2412 
2413     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2414                         \textcolor{comment}{/* Number of non\_passables */}
2415     \textcolor{keywordflow}{while}(n--) \{
2416         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})&tmpdig, 1, \textcolor{keyword}{sizeof}(tmpdig), fd);
2417 
2418         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&tmpdig.x1, &tmpdig.y1, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY}|\hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{WET});
2419         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&tmpdig.x2, &tmpdig.y2, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY}|\hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{WET});
2420 
2421         \hyperlink{sp__lev_8c_ac3e80e7bc7afed094c7af15df57677fd}{set\_wall\_property}(tmpdig.x1, tmpdig.y1,
2422                   tmpdig.x2, tmpdig.y2, \hyperlink{rm_8h_a44ca16d27776ec10be38fb0d1c2ac8c4}{W\_NONPASSWALL});
2423     \}
2424 
2425     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2426                         \textcolor{comment}{/* Number of ladders */}
2427     \textcolor{keywordflow}{while}(n--) \{
2428         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})&tmplad, 1, \textcolor{keyword}{sizeof}(tmplad), fd);
2429 
2430         x = tmplad.x;  y = tmplad.y;
2431         \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&x, &y, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY});
2432 
2433         \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ = \hyperlink{rm_8h_aa5a9eab5827d942490d37fdc9ca87ba3}{LADDER};
2434         \textcolor{keywordflow}{if} (tmplad.up == 1) \{
2435             \hyperlink{decl_8h_a2d4548b0c42db4ef8ba1bc9621542da3}{xupladder} = x; \hyperlink{decl_8h_aa40db270d30fecdd58e8e47cc855936e}{yupladder} = y;
2436             \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].ladder = \hyperlink{rm_8h_a1ecf378536cdea01eb37ec943fe1d3df}{LA\_UP};
2437         \} \textcolor{keywordflow}{else} \{
2438             \hyperlink{decl_8h_a852b49ce12ba3e86a4924db9cb7e1eaa}{xdnladder} = x; \hyperlink{decl_8h_a4aa07a23b5b834e25b8b243f69c6473f}{ydnladder} = y;
2439             \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].ladder = \hyperlink{rm_8h_a6ae800b588662120096274fda9aa68e2}{LA\_DOWN};
2440         \}
2441     \}
2442 
2443     prevstair.\hyperlink{structstair_ac2d7a1ec9399eeac8fc9b72f1a8bb402}{x} = prevstair.\hyperlink{structstair_adb9f18b03852a2f5603811f0c3709d5a}{y} = 0;
2444     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2445                         \textcolor{comment}{/* Number of stairs */}
2446     \textcolor{keywordflow}{while}(n--) \{
2447         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})&tmpstair, 1, \textcolor{keyword}{sizeof}(tmpstair), fd);
2448 
2449         xi = 0;
2450         \textcolor{keywordflow}{do} \{
2451             x = tmpstair.x;  y = tmpstair.y;
2452             \hyperlink{sp__lev_8c_ab8698603e8279aee557fb77ab59774fe}{get\_location}(&x, &y, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY});
2453         \} \textcolor{keywordflow}{while}(prevstair.\hyperlink{structstair_ac2d7a1ec9399eeac8fc9b72f1a8bb402}{x} && xi++ < 100 &&
2454             distmin(x,y,prevstair.\hyperlink{structstair_ac2d7a1ec9399eeac8fc9b72f1a8bb402}{x},prevstair.\hyperlink{structstair_adb9f18b03852a2f5603811f0c3709d5a}{y}) <= 8);
2455         \textcolor{keywordflow}{if} ((badtrap = t\_at(x,y)) != 0) deltrap(badtrap);
2456         \hyperlink{mklev_8c_a17be6d5832c5764f4c77e0d3ae9f507b}{mkstairs}(x, y, (\textcolor{keywordtype}{char})tmpstair.up, (\textcolor{keyword}{struct} \hyperlink{structmkroom}{mkroom} *)0);
2457         prevstair.\hyperlink{structstair_ac2d7a1ec9399eeac8fc9b72f1a8bb402}{x} = x;
2458         prevstair.\hyperlink{structstair_adb9f18b03852a2f5603811f0c3709d5a}{y} = y;
2459     \}
2460 
2461     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2462                         \textcolor{comment}{/* Number of altars */}
2463     \textcolor{keywordflow}{while}(n--) \{
2464         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})&tmpaltar, 1, \textcolor{keyword}{sizeof}(tmpaltar), fd);
2465 
2466         \hyperlink{sp__lev_8c_a561caa9102927221bda21ed9eb0a848e}{create\_altar}(&tmpaltar, (\textcolor{keyword}{struct} \hyperlink{structmkroom}{mkroom} *)0);
2467     \}
2468 
2469     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2470                         \textcolor{comment}{/* Number of fountains */}
2471     \textcolor{keywordflow}{while} (n--) \{
2472         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})&tmpfountain, 1, \textcolor{keyword}{sizeof}(tmpfountain), fd);
2473 
2474         \hyperlink{sp__lev_8c_ad7f4c8a0d48ccd9bc4ed7126aa6a1ca5}{create\_feature}(tmpfountain.x, tmpfountain.y,
2475                    (\textcolor{keyword}{struct} \hyperlink{structmkroom}{mkroom} *)0, \hyperlink{rm_8h_a88fabf28d6285490fea11089d88167ca}{FOUNTAIN});
2476     \}
2477 
2478     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2479                         \textcolor{comment}{/* Number of traps */}
2480     \textcolor{keywordflow}{while}(n--) \{
2481         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})&tmptrap, 1, \textcolor{keyword}{sizeof}(tmptrap), fd);
2482 
2483         \hyperlink{sp__lev_8c_ab040037bf30273b3fe8e9ceb90eacebe}{create\_trap}(&tmptrap, (\textcolor{keyword}{struct} \hyperlink{structmkroom}{mkroom} *)0);
2484     \}
2485 
2486     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2487                         \textcolor{comment}{/* Number of monsters */}
2488     \textcolor{keywordflow}{while}(n--) \{
2489         \hyperlink{sp__lev_8c_a2ee0bfc55edf1c28cb206147c4b4d886}{load\_one\_monster}(fd, &tmpmons);
2490 
2491         \hyperlink{sp__lev_8c_ac4ba802065a2fdec996f8401dddc89f7}{create\_monster}(&tmpmons, (\textcolor{keyword}{struct} \hyperlink{structmkroom}{mkroom} *)0);
2492     \}
2493 
2494     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2495                         \textcolor{comment}{/* Number of objects */}
2496     \textcolor{keywordflow}{while}(n--) \{
2497         \hyperlink{sp__lev_8c_a403b9be0b0da32cd8f0feb1a6e5bcf5c}{load\_one\_object}(fd, &tmpobj);
2498 
2499         \hyperlink{sp__lev_8c_a98e854541b8194eb7b6337417e4b76fc}{create\_object}(&tmpobj, (\textcolor{keyword}{struct} \hyperlink{structmkroom}{mkroom} *)0);
2500     \}
2501 
2502     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2503                         \textcolor{comment}{/* Number of gold piles */}
2504     \textcolor{keywordflow}{while} (n--) \{
2505         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})&tmpgold, 1, \textcolor{keyword}{sizeof}(tmpgold), fd);
2506 
2507         \hyperlink{sp__lev_8c_a0f75fda68777d83b6cab992aa7778bf2}{create\_gold}(&tmpgold, (\textcolor{keyword}{struct} \hyperlink{structmkroom}{mkroom} *)0);
2508     \}
2509 
2510     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd);
2511                         \textcolor{comment}{/* Number of engravings */}
2512     \textcolor{keywordflow}{while}(n--) \{
2513         \hyperlink{sp__lev_8c_a6edfc47664388d12901339007cd83aee}{load\_one\_engraving}(fd, &tmpengraving);
2514 
2515         \hyperlink{sp__lev_8c_aa6f18cdee6178a2d1935e54bf7615479}{create\_engraving}(&tmpengraving, (\textcolor{keyword}{struct} \hyperlink{structmkroom}{mkroom} *)0);
2516     \}
2517 
2518     \}       \textcolor{comment}{/* numpart loop */}
2519 
2520     nwalk\_sav = \hyperlink{lev__yacc_8c_adcac2df39079d4dddf121ca3ea57a22b}{nwalk};
2521     \textcolor{keywordflow}{while}(nwalk--) \{
2522         x = (\hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar}) \hyperlink{sp__lev_8c_a31e63fe41665cf88ce4da8060a209b78}{walklist}[nwalk].x;
2523         y = (\hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar}) \hyperlink{sp__lev_8c_a31e63fe41665cf88ce4da8060a209b78}{walklist}[nwalk].y;
2524         dir = \hyperlink{sp__lev_8c_a31e63fe41665cf88ce4da8060a209b78}{walklist}[\hyperlink{lev__yacc_8c_adcac2df39079d4dddf121ca3ea57a22b}{nwalk}].\hyperlink{structwalk_a538cec5e9c13e1fa970af083c178ad8d}{dir};
2525 
2526         \textcolor{comment}{/* don't use move() - it doesn't use W\_NORTH, etc. */}
2527         \textcolor{keywordflow}{switch} (dir) \{
2528         \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_a5f689cb20aa2498a4213291bf63c0ea6}{W\_NORTH}: --y; \textcolor{keywordflow}{break};
2529         \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_af7883dbd7a068246a1596614dbe13b96}{W\_SOUTH}: y++; \textcolor{keywordflow}{break};
2530         \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_a0733adeaa8b46ec5f371a7bfe4e79cdb}{W\_EAST}:  x++; \textcolor{keywordflow}{break};
2531         \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_a59a97200f26ccd6a0426bb2f6384c226}{W\_WEST}:  --x; \textcolor{keywordflow}{break};
2532         \textcolor{keywordflow}{default}: \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"load\_maze: bad MAZEWALK direction"});
2533         \}
2534 
2535         \textcolor{keywordflow}{if}(!\hyperlink{rm_8h_a44de5677b6310b3b96cad756e24b59d9}{IS\_DOOR}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ)) \{
2536 \textcolor{preprocessor}{#ifndef WALLIFIED\_MAZE}
2537         \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ = \hyperlink{rm_8h_aeffd57885964c3a9a5c3ce0f81c06339}{CORR};
2538 \textcolor{preprocessor}{#else}
2539         \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ = \hyperlink{rm_8h_ae635489e987ae17a3bf884376cc2fe34}{ROOM};
2540 \textcolor{preprocessor}{#endif}
2541         \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].flags = 0;
2542         \}
2543 
2544         \textcolor{comment}{/*}
2545 \textcolor{comment}{         * We must be sure that the parity of the coordinates for}
2546 \textcolor{comment}{         * walkfrom() is odd.  But we must also take into account}
2547 \textcolor{comment}{         * what direction was chosen.}
2548 \textcolor{comment}{         */}
2549         \textcolor{keywordflow}{if}(!(x % 2)) \{
2550         \textcolor{keywordflow}{if} (dir == \hyperlink{sp__lev_8h_a0733adeaa8b46ec5f371a7bfe4e79cdb}{W\_EAST})
2551             x++;
2552         \textcolor{keywordflow}{else}
2553             x--;
2554 
2555         \textcolor{comment}{/* no need for IS\_DOOR check; out of map bounds */}
2556 \textcolor{preprocessor}{#ifndef WALLIFIED\_MAZE}
2557         \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ = \hyperlink{rm_8h_aeffd57885964c3a9a5c3ce0f81c06339}{CORR};
2558 \textcolor{preprocessor}{#else}
2559         \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ = \hyperlink{rm_8h_ae635489e987ae17a3bf884376cc2fe34}{ROOM};
2560 \textcolor{preprocessor}{#endif}
2561         \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].flags = 0;
2562         \}
2563 
2564         \textcolor{keywordflow}{if} (!(y % 2)) \{
2565         \textcolor{keywordflow}{if} (dir == \hyperlink{sp__lev_8h_af7883dbd7a068246a1596614dbe13b96}{W\_SOUTH})
2566             y++;
2567         \textcolor{keywordflow}{else}
2568             y--;
2569         \}
2570 
2571         \hyperlink{mkmaze_8c_a2d61d045fcb05a76cc0e437959d4b3e0}{walkfrom}(x, y);
2572     \}
2573     \hyperlink{mkmaze_8c_ae15934086870601facb65acfbf4fe03e}{wallification}(1, 0, \hyperlink{global_8h_a308dbfcc29f5a427c0315f3cbf03c3ed}{COLNO}-1, \hyperlink{global_8h_a9cce134868d97b23c35bcf1ff4a343d8}{ROWNO}-1);
2574 
2575     \textcolor{comment}{/*}
2576 \textcolor{comment}{     * If there's a significant portion of maze unused by the special level,}
2577 \textcolor{comment}{     * we don't want it empty.}
2578 \textcolor{comment}{     *}
2579 \textcolor{comment}{     * Makes the number of traps, monsters, etc. proportional}
2580 \textcolor{comment}{     * to the size of the maze.}
2581 \textcolor{comment}{     */}
2582     mapcountmax = mapcount = (\hyperlink{decl_8h_a5a8f3e210dcf5e1b8319f220200f7e91}{x\_maze\_max} - 2) * (\hyperlink{decl_8h_a148ae7e81a85b4cab11815530f82da17}{y\_maze\_max} - 2);
2583 
2584     \textcolor{keywordflow}{for}(x = 2; x < \hyperlink{decl_8h_a5a8f3e210dcf5e1b8319f220200f7e91}{x\_maze\_max}; x++)
2585     \textcolor{keywordflow}{for}(y = 0; y < \hyperlink{decl_8h_a148ae7e81a85b4cab11815530f82da17}{y\_maze\_max}; y++)
2586         \textcolor{keywordflow}{if}(\hyperlink{sp__lev_8c_a8759e0f6c69dca527985b85d1c66dc9c}{Map}[x][y]) mapcount--;
2587 
2588     \textcolor{keywordflow}{if} (nwalk\_sav && (mapcount > (\textcolor{keywordtype}{int}) (mapcountmax / 10))) \{
2589         mapfact = (int) ((mapcount * 100L) / mapcountmax);
2590         \textcolor{keywordflow}{for}(x = rnd((\textcolor{keywordtype}{int}) (20 * mapfact) / 100); x; x--) \{
2591             \hyperlink{sp__lev_8c_ad64df5bd43c6e3845f5df184fa4df0d3}{maze1xy}(&mm, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY});
2592             (void) mkobj\_at(rn2(2) ? \hyperlink{objclass_8h_afc09c51ea922e9928f86a51177244796}{GEM\_CLASS} : \hyperlink{objclass_8h_ac72b41688ea83d87d0b4143899a9b0d7}{RANDOM\_CLASS},
2593                             mm.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}, mm.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
2594         \}
2595         \textcolor{keywordflow}{for}(x = rnd((\textcolor{keywordtype}{int}) (12 * mapfact) / 100); x; x--) \{
2596             \hyperlink{sp__lev_8c_ad64df5bd43c6e3845f5df184fa4df0d3}{maze1xy}(&mm, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY});
2597             (void) mksobj\_at(BOULDER, mm.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}, mm.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
2598         \}
2599         \textcolor{keywordflow}{for} (x = rn2(2); x; x--) \{
2600         \hyperlink{sp__lev_8c_ad64df5bd43c6e3845f5df184fa4df0d3}{maze1xy}(&mm, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY});
2601         (void) makemon(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_MINOTAUR], mm.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}, mm.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}, \hyperlink{hack_8h_ae449582f467baa0da531a6ea116a18f2}{NO\_MM\_FLAGS});
2602         \}
2603         \textcolor{keywordflow}{for}(x = rnd((\textcolor{keywordtype}{int}) (12 * mapfact) / 100); x; x--) \{
2604             \hyperlink{sp__lev_8c_ad64df5bd43c6e3845f5df184fa4df0d3}{maze1xy}(&mm, \hyperlink{sp__lev_8c_aa0f6b5e01089c6cf7b47c81efb500644}{WET}|\hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY});
2605             (void) makemon((\textcolor{keyword}{struct} \hyperlink{structpermonst}{permonst} *) 0, mm.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}, mm.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}, 
      \hyperlink{hack_8h_ae449582f467baa0da531a6ea116a18f2}{NO\_MM\_FLAGS});
2606         \}
2607         \textcolor{keywordflow}{for}(x = rn2((\textcolor{keywordtype}{int}) (15 * mapfact) / 100); x; x--) \{
2608             \hyperlink{sp__lev_8c_ad64df5bd43c6e3845f5df184fa4df0d3}{maze1xy}(&mm, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY});
2609             (void) mkgold(0L,mm.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x},mm.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y});
2610         \}
2611         \textcolor{keywordflow}{for}(x = rn2((\textcolor{keywordtype}{int}) (15 * mapfact) / 100); x; x--) \{
2612             \textcolor{keywordtype}{int} trytrap;
2613 
2614             \hyperlink{sp__lev_8c_ad64df5bd43c6e3845f5df184fa4df0d3}{maze1xy}(&mm, \hyperlink{sp__lev_8c_af9cfb54b8208d52c9ee6eb611a4bc826}{DRY});
2615             trytrap = \hyperlink{sp__lev_8c_a08d42781cf218d72107acf7696461a90}{rndtrap}();
2616             \textcolor{keywordflow}{if} (sobj\_at(BOULDER, mm.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}, mm.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}))
2617             \textcolor{keywordflow}{while} (trytrap == \hyperlink{trap_8h_af181c9e6602b6432a0bf1a9243808968}{PIT} || trytrap == \hyperlink{trap_8h_a813fa80e09de5d455e2af3743a95bad9}{SPIKED\_PIT} ||
2618                 trytrap == \hyperlink{trap_8h_ab50570a3a3e65ed47edb98c63e355088}{TRAPDOOR} || trytrap == \hyperlink{trap_8h_a8049ef47c05eee8156bccee8d819c506}{HOLE})
2619                 trytrap = \hyperlink{sp__lev_8c_a08d42781cf218d72107acf7696461a90}{rndtrap}();
2620             (void) maketrap(mm.\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x}, mm.\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y}, trytrap);
2621         \}
2622     \}
2623     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
2624 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a6edfc47664388d12901339007cd83aee}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!load\+\_\+one\+\_\+engraving@{load\+\_\+one\+\_\+engraving}}
\index{load\+\_\+one\+\_\+engraving@{load\+\_\+one\+\_\+engraving}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{load\+\_\+one\+\_\+engraving}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void load\+\_\+one\+\_\+engraving (
\begin{DoxyParamCaption}
\item[{{\bf dlb} $\ast$}]{fd, }
\item[{{\bf engraving} $\ast$}]{e}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a6edfc47664388d12901339007cd83aee}


Definition at line 1791 of file sp\+\_\+lev.\+c.



References alloc(), and Fread.



Referenced by load\+\_\+maze(), and load\+\_\+rooms().


\begin{DoxyCode}
1794 \{
1795     \textcolor{keywordtype}{int} \hyperlink{structsize}{size};
1796 
1797     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) e, 1, \textcolor{keyword}{sizeof} *e, fd);
1798     size = e->\hyperlink{structengraving_a1255139d50d1e9e12a229d32a0422ae8}{engr}.\hyperlink{unionstr__or__len_adec1f846eaf281ba750d96d01f05d833}{len};
1799     e->\hyperlink{structengraving_a1255139d50d1e9e12a229d32a0422ae8}{engr}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str} = (\textcolor{keywordtype}{char} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}((\textcolor{keywordtype}{unsigned})size+1);
1800     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) e->\hyperlink{structengraving_a1255139d50d1e9e12a229d32a0422ae8}{engr}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str}, 1, size, fd);
1801     e->\hyperlink{structengraving_a1255139d50d1e9e12a229d32a0422ae8}{engr}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str}[size] = \textcolor{charliteral}{'\(\backslash\)0'};
1802 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a2ee0bfc55edf1c28cb206147c4b4d886}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!load\+\_\+one\+\_\+monster@{load\+\_\+one\+\_\+monster}}
\index{load\+\_\+one\+\_\+monster@{load\+\_\+one\+\_\+monster}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{load\+\_\+one\+\_\+monster}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void load\+\_\+one\+\_\+monster (
\begin{DoxyParamCaption}
\item[{{\bf dlb} $\ast$}]{fd, }
\item[{{\bf monster} $\ast$}]{m}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a2ee0bfc55edf1c28cb206147c4b4d886}


Definition at line 1753 of file sp\+\_\+lev.\+c.



References alloc(), and Fread.



Referenced by load\+\_\+maze(), and load\+\_\+rooms().


\begin{DoxyCode}
1756 \{
1757     \textcolor{keywordtype}{int} \hyperlink{structsize}{size};
1758 
1759     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) m, 1, \textcolor{keyword}{sizeof} *m, fd);
1760     \textcolor{keywordflow}{if} ((size = m->\hyperlink{structmonster_aaa15fa26f0d72ddcd172dd3309791e87}{name}.\hyperlink{unionstr__or__len_adec1f846eaf281ba750d96d01f05d833}{len}) != 0) \{
1761         m->\hyperlink{structmonster_aaa15fa26f0d72ddcd172dd3309791e87}{name}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str} = (\textcolor{keywordtype}{char} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}((\textcolor{keywordtype}{unsigned})size + 1);
1762         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) m->\hyperlink{structmonster_aaa15fa26f0d72ddcd172dd3309791e87}{name}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str}, 1, size, fd);
1763         m->\hyperlink{structmonster_aaa15fa26f0d72ddcd172dd3309791e87}{name}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str}[size] = \textcolor{charliteral}{'\(\backslash\)0'};
1764     \} \textcolor{keywordflow}{else}
1765         m->\hyperlink{structmonster_aaa15fa26f0d72ddcd172dd3309791e87}{name}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str} = (\textcolor{keywordtype}{char} *) 0;
1766     \textcolor{keywordflow}{if} ((size = m->\hyperlink{structmonster_a5aee88b4ae76f77c49e9909cb019cd13}{appear\_as}.\hyperlink{unionstr__or__len_adec1f846eaf281ba750d96d01f05d833}{len}) != 0) \{
1767         m->\hyperlink{structmonster_a5aee88b4ae76f77c49e9909cb019cd13}{appear\_as}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str} = (\textcolor{keywordtype}{char} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}((\textcolor{keywordtype}{unsigned})size + 1);
1768         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) m->\hyperlink{structmonster_a5aee88b4ae76f77c49e9909cb019cd13}{appear\_as}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str}, 1, size, fd);
1769         m->\hyperlink{structmonster_a5aee88b4ae76f77c49e9909cb019cd13}{appear\_as}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str}[size] = \textcolor{charliteral}{'\(\backslash\)0'};
1770     \} \textcolor{keywordflow}{else}
1771         m->\hyperlink{structmonster_a5aee88b4ae76f77c49e9909cb019cd13}{appear\_as}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str} = (\textcolor{keywordtype}{char} *) 0;
1772 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a403b9be0b0da32cd8f0feb1a6e5bcf5c}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!load\+\_\+one\+\_\+object@{load\+\_\+one\+\_\+object}}
\index{load\+\_\+one\+\_\+object@{load\+\_\+one\+\_\+object}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{load\+\_\+one\+\_\+object}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void load\+\_\+one\+\_\+object (
\begin{DoxyParamCaption}
\item[{{\bf dlb} $\ast$}]{fd, }
\item[{{\bf object} $\ast$}]{o}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a403b9be0b0da32cd8f0feb1a6e5bcf5c}


Definition at line 1775 of file sp\+\_\+lev.\+c.



References alloc(), and Fread.



Referenced by load\+\_\+maze(), and load\+\_\+rooms().


\begin{DoxyCode}
1778 \{
1779     \textcolor{keywordtype}{int} \hyperlink{structsize}{size};
1780 
1781     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) o, 1, \textcolor{keyword}{sizeof} *o, fd);
1782     \textcolor{keywordflow}{if} ((size = o->\hyperlink{structobject_acce2482cb9701001d8f378d3bfbdb8f6}{name}.\hyperlink{unionstr__or__len_adec1f846eaf281ba750d96d01f05d833}{len}) != 0) \{
1783         o->\hyperlink{structobject_acce2482cb9701001d8f378d3bfbdb8f6}{name}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str} = (\textcolor{keywordtype}{char} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}((\textcolor{keywordtype}{unsigned})size + 1);
1784         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) o->\hyperlink{structobject_acce2482cb9701001d8f378d3bfbdb8f6}{name}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str}, 1, size, fd);
1785         o->\hyperlink{structobject_acce2482cb9701001d8f378d3bfbdb8f6}{name}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str}[size] = \textcolor{charliteral}{'\(\backslash\)0'};
1786     \} \textcolor{keywordflow}{else}
1787         o->\hyperlink{structobject_acce2482cb9701001d8f378d3bfbdb8f6}{name}.\hyperlink{unionstr__or__len_a5e463454e22eb53eaa7b740ebccecfce}{str} = (\textcolor{keywordtype}{char} *) 0;
1788 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a9542cf195f5f0ccc13693d734d30c749}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!load\+\_\+rooms@{load\+\_\+rooms}}
\index{load\+\_\+rooms@{load\+\_\+rooms}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{load\+\_\+rooms}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} load\+\_\+rooms (
\begin{DoxyParamCaption}
\item[{{\bf dlb} $\ast$}]{fd}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a9542cf195f5f0ccc13693d734d30c749}


Definition at line 1805 of file sp\+\_\+lev.\+c.



References alloc(), \+\_\+room\+::altars, build\+\_\+room(), \+\_\+room\+::chance, create\+\_\+corridor(), \+\_\+room\+::doors, \+\_\+room\+::engravings, \+\_\+room\+::filled, \+\_\+room\+::fountains, Fread, free\+\_\+rooms(), \+\_\+room\+::golds, \+\_\+room\+::h, load\+\_\+common\+\_\+data(), load\+\_\+one\+\_\+engraving(), load\+\_\+one\+\_\+monster(), load\+\_\+one\+\_\+object(), \+\_\+room\+::monsters, \+\_\+room\+::naltar, name, \+\_\+room\+::name, \+\_\+room\+::ndoor, \+\_\+room\+::nengraving, New, New\+Tab, \+\_\+room\+::nfountain, \+\_\+room\+::ngold, \+\_\+room\+::nmonster, \+\_\+room\+::nobject, \+\_\+room\+::npool, nrooms, \+\_\+room\+::nsink, \+\_\+room\+::nstair, \+\_\+room\+::nsubroom, \+\_\+room\+::ntrap, \+\_\+room\+::objects, \+\_\+room\+::parent, \+\_\+room\+::pools, \+\_\+room\+::rlit, \+\_\+room\+::rtype, \+\_\+room\+::sinks, S\+P\+\_\+\+L\+E\+V\+\_\+\+R\+O\+O\+M\+S, sp\+\_\+lev\+\_\+shuffle(), \+\_\+room\+::stairs, \+\_\+room\+::subrooms, tmpcor, tmproom, \+\_\+room\+::traps, T\+R\+U\+E, \+\_\+room\+::w, \+\_\+room\+::x, \+\_\+room\+::xalign, \+\_\+room\+::y, and \+\_\+room\+::yalign.



Referenced by load\+\_\+special().


\begin{DoxyCode}
1807 \{
1808     \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar}      \hyperlink{lev__yacc_8c_a45e1d3556bb40a075f6665d5f896a28f}{nrooms}, ncorr;
1809     \textcolor{keywordtype}{char}        n;
1810     \textcolor{keywordtype}{short}       \hyperlink{structsize}{size};
1811     \hyperlink{structcorridor}{corridor}    \hyperlink{lev__yacc_8c_aad603b2b2b5e115c0ee67dc27f886857}{tmpcor};
1812     \hyperlink{struct__room}{room}**      \hyperlink{lev__yacc_8c_a7404db7492683b75623d65c57b68d7c5}{tmproom};
1813     \textcolor{keywordtype}{int}     i, j;
1814 
1815     \hyperlink{sp__lev_8c_a1de2e47ec9b5c68d80af96a35ec54c61}{load\_common\_data}(fd, \hyperlink{sp__lev_8h_a556c49dac370df0beebf516a93ded50b}{SP\_LEV\_ROOMS});
1816 
1817     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd); \textcolor{comment}{/* nrobjects */}
1818     \textcolor{keywordflow}{if} (n) \{
1819         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})\hyperlink{sp__lev_8c_a4c62499de047bc3a15f32e4f14c00c66}{robjects}, \textcolor{keyword}{sizeof}(*robjects), n, fd);
1820         \hyperlink{sp__lev_8c_a319f933b60e9c45af293065eeb52bde8}{sp\_lev\_shuffle}(robjects, (\textcolor{keywordtype}{char} *)0, (\textcolor{keywordtype}{int})n);
1821     \}
1822 
1823     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &n, 1, \textcolor{keyword}{sizeof}(n), fd); \textcolor{comment}{/* nrmonst */}
1824     \textcolor{keywordflow}{if} (n) \{
1825         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t})\hyperlink{sp__lev_8c_af35c3f24113af660b5d6e6b4105032e0}{rmonst}, \textcolor{keyword}{sizeof}(*rmonst), n, fd);
1826         \hyperlink{sp__lev_8c_a319f933b60e9c45af293065eeb52bde8}{sp\_lev\_shuffle}(rmonst, (\textcolor{keywordtype}{char} *)0, (\textcolor{keywordtype}{int})n);
1827     \}
1828 
1829     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &nrooms, 1, \textcolor{keyword}{sizeof}(nrooms), fd);
1830                         \textcolor{comment}{/* Number of rooms to read */}
1831     tmproom = \hyperlink{sp__lev_8c_a6b5f263b8333bc27300bf010f774ccd3}{NewTab}(\hyperlink{struct__room}{room},nrooms);
1832     \textcolor{keywordflow}{for} (i=0;i<\hyperlink{lev__yacc_8c_a45e1d3556bb40a075f6665d5f896a28f}{nrooms};i++) \{
1833         \hyperlink{struct__room}{room} *r;
1834 
1835         r = tmproom[i] = \hyperlink{sp__lev_8c_a8e58aceccc995a7b883ede5dd60dbad5}{New}(\hyperlink{struct__room}{room});
1836 
1837         \textcolor{comment}{/* Let's see if this room has a name */}
1838         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &size, 1, \textcolor{keyword}{sizeof}(size), fd);
1839         \textcolor{keywordflow}{if} (size > 0) \{ \textcolor{comment}{/* Yup, it does! */}
1840             r->\hyperlink{struct__room_aca2280b1ca899bab061cca7b062ce195}{name} = (\textcolor{keywordtype}{char} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}((\textcolor{keywordtype}{unsigned})size + 1);
1841             \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) r->\hyperlink{struct__room_aca2280b1ca899bab061cca7b062ce195}{name}, 1, size, fd);
1842             r->\hyperlink{struct__room_aca2280b1ca899bab061cca7b062ce195}{name}[size] = 0;
1843         \} \textcolor{keywordflow}{else}
1844             r->\hyperlink{struct__room_aca2280b1ca899bab061cca7b062ce195}{name} = (\textcolor{keywordtype}{char} *) 0;
1845 
1846         \textcolor{comment}{/* Let's see if this room has a parent */}
1847         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &size, 1, \textcolor{keyword}{sizeof}(size), fd);
1848         \textcolor{keywordflow}{if} (size > 0) \{ \textcolor{comment}{/* Yup, it does! */}
1849             r->\hyperlink{struct__room_ad0c17b49155ae5f1517fa3227e0d48e6}{parent} = (\textcolor{keywordtype}{char} *) \hyperlink{txt2iff_8c_ae273cbdce4cd64a076220ad06c41a5a1}{alloc}((\textcolor{keywordtype}{unsigned})size + 1);
1850             \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) r->\hyperlink{struct__room_ad0c17b49155ae5f1517fa3227e0d48e6}{parent}, 1, size, fd);
1851             r->\hyperlink{struct__room_ad0c17b49155ae5f1517fa3227e0d48e6}{parent}[size] = 0;
1852         \} \textcolor{keywordflow}{else}
1853             r->\hyperlink{struct__room_ad0c17b49155ae5f1517fa3227e0d48e6}{parent} = (\textcolor{keywordtype}{char} *) 0;
1854 
1855         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_a7f3be8a31d75214a0e94c3bfb75d1fda}{x}, 1, \textcolor{keyword}{sizeof}(r->\hyperlink{struct__room_a7f3be8a31d75214a0e94c3bfb75d1fda}{x}), fd);
1856                     \textcolor{comment}{/* x pos on the grid (1-5) */}
1857         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_a62bdbccfce4dd3dcd1af7d5bf1d36041}{y}, 1, \textcolor{keyword}{sizeof}(r->\hyperlink{struct__room_a62bdbccfce4dd3dcd1af7d5bf1d36041}{y}), fd);
1858                      \textcolor{comment}{/* y pos on the grid (1-5) */}
1859         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_a468bcdac94f7322f6ec4a0565e7e51d7}{w}, 1, \textcolor{keyword}{sizeof}(r->\hyperlink{struct__room_a468bcdac94f7322f6ec4a0565e7e51d7}{w}), fd);
1860                      \textcolor{comment}{/* width of the room */}
1861         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_a3b5a0d626176f0e352f910f2b341dfa0}{h}, 1, \textcolor{keyword}{sizeof}(r->\hyperlink{struct__room_a3b5a0d626176f0e352f910f2b341dfa0}{h}), fd);
1862                      \textcolor{comment}{/* height of the room */}
1863         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_a18538541f582181a368b543e6d36a4d2}{xalign}, 1, \textcolor{keyword}{sizeof}(r->
      \hyperlink{struct__room_a18538541f582181a368b543e6d36a4d2}{xalign}), fd);
1864                      \textcolor{comment}{/* horizontal alignment */}
1865         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_a521977071dfc4981b7f294dfdf59cf6d}{yalign}, 1, \textcolor{keyword}{sizeof}(r->
      \hyperlink{struct__room_a521977071dfc4981b7f294dfdf59cf6d}{yalign}), fd);
1866                      \textcolor{comment}{/* vertical alignment */}
1867         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_aead16a1e5cdaa60d26ec4be9240ceb94}{rtype}, 1, \textcolor{keyword}{sizeof}(r->\hyperlink{struct__room_aead16a1e5cdaa60d26ec4be9240ceb94}{rtype}), fd);
1868                      \textcolor{comment}{/* type of room (zoo, shop, etc.) */}
1869         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_a9c033e9f0b02e503f8c28e52f388f20b}{chance}, 1, \textcolor{keyword}{sizeof}(r->
      \hyperlink{struct__room_a9c033e9f0b02e503f8c28e52f388f20b}{chance}), fd);
1870                      \textcolor{comment}{/* chance of room being special. */}
1871         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_a4456f444341aea7d18c68cc4400becec}{rlit}, 1, \textcolor{keyword}{sizeof}(r->\hyperlink{struct__room_a4456f444341aea7d18c68cc4400becec}{rlit}), fd);
1872                      \textcolor{comment}{/* lit or not ? */}
1873         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_a915f3f466b1a51ba9c70ea4cb669c19f}{filled}, 1, \textcolor{keyword}{sizeof}(r->
      \hyperlink{struct__room_a915f3f466b1a51ba9c70ea4cb669c19f}{filled}), fd);
1874                      \textcolor{comment}{/* to be filled? */}
1875         r->\hyperlink{struct__room_a33ab2c6401d14af02e880b4592738002}{nsubroom}= 0;
1876 
1877         \textcolor{comment}{/* read the doors */}
1878         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_adf93ac64ee6c689fc8faf034101104d2}{ndoor}, 1, \textcolor{keyword}{sizeof}(r->\hyperlink{struct__room_adf93ac64ee6c689fc8faf034101104d2}{ndoor}), fd);
1879         \textcolor{keywordflow}{if} ((n = r->\hyperlink{struct__room_adf93ac64ee6c689fc8faf034101104d2}{ndoor}) != 0)
1880             r->\hyperlink{struct__room_a7680e15d05c73add8201e0b05ac24433}{doors} = \hyperlink{sp__lev_8c_a6b5f263b8333bc27300bf010f774ccd3}{NewTab}(\hyperlink{structroom__door}{room\_door}, n);
1881         \textcolor{keywordflow}{while}(n--) \{
1882             r->\hyperlink{struct__room_a7680e15d05c73add8201e0b05ac24433}{doors}[(int)n] = \hyperlink{sp__lev_8c_a8e58aceccc995a7b883ede5dd60dbad5}{New}(\hyperlink{structroom__door}{room\_door});
1883             \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) r->\hyperlink{struct__room_a7680e15d05c73add8201e0b05ac24433}{doors}[(\textcolor{keywordtype}{int})n], 1,
1884                 \textcolor{keyword}{sizeof}(\hyperlink{structroom__door}{room\_door}), fd);
1885         \}
1886 
1887         \textcolor{comment}{/* read the stairs */}
1888         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_a4c7178c7b2d6aae68c8bc575e65b4928}{nstair}, 1, \textcolor{keyword}{sizeof}(r->
      \hyperlink{struct__room_a4c7178c7b2d6aae68c8bc575e65b4928}{nstair}), fd);
1889         \textcolor{keywordflow}{if} ((n = r->\hyperlink{struct__room_a4c7178c7b2d6aae68c8bc575e65b4928}{nstair}) != 0)
1890             r->\hyperlink{struct__room_ae3b0130f66fce4fc798876a6da829e64}{stairs} = \hyperlink{sp__lev_8c_a6b5f263b8333bc27300bf010f774ccd3}{NewTab}(\hyperlink{structstair}{stair}, n);
1891         \textcolor{keywordflow}{while} (n--) \{
1892             r->\hyperlink{struct__room_ae3b0130f66fce4fc798876a6da829e64}{stairs}[(int)n] = \hyperlink{sp__lev_8c_a8e58aceccc995a7b883ede5dd60dbad5}{New}(\hyperlink{structstair}{stair});
1893             \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) r->\hyperlink{struct__room_ae3b0130f66fce4fc798876a6da829e64}{stairs}[(\textcolor{keywordtype}{int})n], 1,
1894                 \textcolor{keyword}{sizeof}(\hyperlink{structstair}{stair}), fd);
1895         \}
1896 
1897         \textcolor{comment}{/* read the altars */}
1898         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_a6e5fedf04693d5601d2fe64a2402963f}{naltar}, 1, \textcolor{keyword}{sizeof}(r->
      \hyperlink{struct__room_a6e5fedf04693d5601d2fe64a2402963f}{naltar}), fd);
1899         \textcolor{keywordflow}{if} ((n = r->\hyperlink{struct__room_a6e5fedf04693d5601d2fe64a2402963f}{naltar}) != 0)
1900             r->\hyperlink{struct__room_ae093807c3fc83a79dfb56ba31537fd37}{altars} = \hyperlink{sp__lev_8c_a6b5f263b8333bc27300bf010f774ccd3}{NewTab}(\hyperlink{structaltar}{altar}, n);
1901         \textcolor{keywordflow}{while} (n--) \{
1902             r->\hyperlink{struct__room_ae093807c3fc83a79dfb56ba31537fd37}{altars}[(int)n] = \hyperlink{sp__lev_8c_a8e58aceccc995a7b883ede5dd60dbad5}{New}(\hyperlink{structaltar}{altar});
1903             \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) r->\hyperlink{struct__room_ae093807c3fc83a79dfb56ba31537fd37}{altars}[(\textcolor{keywordtype}{int})n], 1,
1904                 \textcolor{keyword}{sizeof}(\hyperlink{structaltar}{altar}), fd);
1905         \}
1906 
1907         \textcolor{comment}{/* read the fountains */}
1908         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_a1dd82879b9d6ec47eee892f2b1f02f28}{nfountain}, 1,
1909             \textcolor{keyword}{sizeof}(r->\hyperlink{struct__room_a1dd82879b9d6ec47eee892f2b1f02f28}{nfountain}), fd);
1910         \textcolor{keywordflow}{if} ((n = r->\hyperlink{struct__room_a1dd82879b9d6ec47eee892f2b1f02f28}{nfountain}) != 0)
1911             r->\hyperlink{struct__room_a4e68727ef155a3b332565ddf632b4e59}{fountains} = \hyperlink{sp__lev_8c_a6b5f263b8333bc27300bf010f774ccd3}{NewTab}(\hyperlink{structfountain}{fountain}, n);
1912         \textcolor{keywordflow}{while} (n--) \{
1913             r->\hyperlink{struct__room_a4e68727ef155a3b332565ddf632b4e59}{fountains}[(int)n] = \hyperlink{sp__lev_8c_a8e58aceccc995a7b883ede5dd60dbad5}{New}(\hyperlink{structfountain}{fountain});
1914             \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) r->\hyperlink{struct__room_a4e68727ef155a3b332565ddf632b4e59}{fountains}[(\textcolor{keywordtype}{int})n], 1,
1915                 \textcolor{keyword}{sizeof}(\hyperlink{structfountain}{fountain}), fd);
1916         \}
1917 
1918         \textcolor{comment}{/* read the sinks */}
1919         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_a49a3273df13628e3928da7ec7cd88d2c}{nsink}, 1, \textcolor{keyword}{sizeof}(r->\hyperlink{struct__room_a49a3273df13628e3928da7ec7cd88d2c}{nsink}), fd);
1920         \textcolor{keywordflow}{if} ((n = r->\hyperlink{struct__room_a49a3273df13628e3928da7ec7cd88d2c}{nsink}) != 0)
1921             r->\hyperlink{struct__room_a3e983d2628aef0ea6f2a5eefc6a6759e}{sinks} = \hyperlink{sp__lev_8c_a6b5f263b8333bc27300bf010f774ccd3}{NewTab}(\hyperlink{structsink}{sink}, n);
1922         \textcolor{keywordflow}{while} (n--) \{
1923             r->\hyperlink{struct__room_a3e983d2628aef0ea6f2a5eefc6a6759e}{sinks}[(int)n] = \hyperlink{sp__lev_8c_a8e58aceccc995a7b883ede5dd60dbad5}{New}(\hyperlink{structsink}{sink});
1924             \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) r->\hyperlink{struct__room_a3e983d2628aef0ea6f2a5eefc6a6759e}{sinks}[(\textcolor{keywordtype}{int})n], 1, \textcolor{keyword}{sizeof}(
      \hyperlink{structsink}{sink}), fd);
1925         \}
1926 
1927         \textcolor{comment}{/* read the pools */}
1928         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_a309691c7928482b72435ad884e731ee1}{npool}, 1, \textcolor{keyword}{sizeof}(r->\hyperlink{struct__room_a309691c7928482b72435ad884e731ee1}{npool}), fd);
1929         \textcolor{keywordflow}{if} ((n = r->\hyperlink{struct__room_a309691c7928482b72435ad884e731ee1}{npool}) != 0)
1930             r->\hyperlink{struct__room_a671fd6f463544e5d1815524a2501fa4e}{pools} = \hyperlink{sp__lev_8c_a6b5f263b8333bc27300bf010f774ccd3}{NewTab}(\hyperlink{structpool}{pool},n);
1931         \textcolor{keywordflow}{while} (n--) \{
1932             r->\hyperlink{struct__room_a671fd6f463544e5d1815524a2501fa4e}{pools}[(int)n] = \hyperlink{sp__lev_8c_a8e58aceccc995a7b883ede5dd60dbad5}{New}(\hyperlink{structpool}{pool});
1933             \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) r->\hyperlink{struct__room_a671fd6f463544e5d1815524a2501fa4e}{pools}[(\textcolor{keywordtype}{int})n], 1, \textcolor{keyword}{sizeof}(
      \hyperlink{structpool}{pool}), fd);
1934         \}
1935 
1936         \textcolor{comment}{/* read the traps */}
1937         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_a8deec962297d6604afe7141d852413cc}{ntrap}, 1, \textcolor{keyword}{sizeof}(r->\hyperlink{struct__room_a8deec962297d6604afe7141d852413cc}{ntrap}), fd);
1938         \textcolor{keywordflow}{if} ((n = r->\hyperlink{struct__room_a8deec962297d6604afe7141d852413cc}{ntrap}) != 0)
1939             r->\hyperlink{struct__room_aead249557eb11c2d252993fc008c480c}{traps} = \hyperlink{sp__lev_8c_a6b5f263b8333bc27300bf010f774ccd3}{NewTab}(\hyperlink{structtrap}{trap}, n);
1940         \textcolor{keywordflow}{while}(n--) \{
1941             r->\hyperlink{struct__room_aead249557eb11c2d252993fc008c480c}{traps}[(int)n] = \hyperlink{sp__lev_8c_a8e58aceccc995a7b883ede5dd60dbad5}{New}(\hyperlink{structtrap}{trap});
1942             \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) r->\hyperlink{struct__room_aead249557eb11c2d252993fc008c480c}{traps}[(\textcolor{keywordtype}{int})n], 1, \textcolor{keyword}{sizeof}(
      \hyperlink{structtrap}{trap}), fd);
1943         \}
1944 
1945         \textcolor{comment}{/* read the monsters */}
1946         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_af54a6a7c092d32717c95edf356a23f88}{nmonster}, 1, \textcolor{keyword}{sizeof}(r->
      \hyperlink{struct__room_af54a6a7c092d32717c95edf356a23f88}{nmonster}), fd);
1947         \textcolor{keywordflow}{if} ((n = r->\hyperlink{struct__room_af54a6a7c092d32717c95edf356a23f88}{nmonster}) != 0) \{
1948             r->\hyperlink{struct__room_a3825f14ece25f8f21e8613d5b77df092}{monsters} = \hyperlink{sp__lev_8c_a6b5f263b8333bc27300bf010f774ccd3}{NewTab}(\hyperlink{structmonster}{monster}, n);
1949             \textcolor{keywordflow}{while}(n--) \{
1950             r->\hyperlink{struct__room_a3825f14ece25f8f21e8613d5b77df092}{monsters}[(int)n] = \hyperlink{sp__lev_8c_a8e58aceccc995a7b883ede5dd60dbad5}{New}(\hyperlink{structmonster}{monster});
1951             \hyperlink{sp__lev_8c_a2ee0bfc55edf1c28cb206147c4b4d886}{load\_one\_monster}(fd, r->\hyperlink{struct__room_a3825f14ece25f8f21e8613d5b77df092}{monsters}[(\textcolor{keywordtype}{int})n]);
1952             \}
1953         \} \textcolor{keywordflow}{else}
1954             r->\hyperlink{struct__room_a3825f14ece25f8f21e8613d5b77df092}{monsters} = 0;
1955 
1956         \textcolor{comment}{/* read the objects, in same order as mazes */}
1957         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_aa955a62dbaafdf4638c3d2ce3d08c650}{nobject}, 1, \textcolor{keyword}{sizeof}(r->
      \hyperlink{struct__room_aa955a62dbaafdf4638c3d2ce3d08c650}{nobject}), fd);
1958         \textcolor{keywordflow}{if} ((n = r->\hyperlink{struct__room_aa955a62dbaafdf4638c3d2ce3d08c650}{nobject}) != 0) \{
1959             r->\hyperlink{struct__room_a950a5ae5abd82208ba0ccaf95369c3ec}{objects} = \hyperlink{sp__lev_8c_a6b5f263b8333bc27300bf010f774ccd3}{NewTab}(\textcolor{keywordtype}{object}, n);
1960             \textcolor{keywordflow}{for} (j = 0; j < n; ++j) \{
1961             r->\hyperlink{struct__room_a950a5ae5abd82208ba0ccaf95369c3ec}{objects}[j] = \hyperlink{sp__lev_8c_a8e58aceccc995a7b883ede5dd60dbad5}{New}(\textcolor{keywordtype}{object});
1962             \hyperlink{sp__lev_8c_a403b9be0b0da32cd8f0feb1a6e5bcf5c}{load\_one\_object}(fd, r->\hyperlink{struct__room_a950a5ae5abd82208ba0ccaf95369c3ec}{objects}[j]);
1963             \}
1964         \} \textcolor{keywordflow}{else}
1965             r->\hyperlink{struct__room_a950a5ae5abd82208ba0ccaf95369c3ec}{objects} = 0;
1966 
1967         \textcolor{comment}{/* read the gold piles */}
1968         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_af05297b65bbb8d9ac4234faf6cedef40}{ngold}, 1, \textcolor{keyword}{sizeof}(r->\hyperlink{struct__room_af05297b65bbb8d9ac4234faf6cedef40}{ngold}), fd);
1969         \textcolor{keywordflow}{if} ((n = r->\hyperlink{struct__room_af05297b65bbb8d9ac4234faf6cedef40}{ngold}) != 0)
1970             r->\hyperlink{struct__room_a098fb9c2d338496af31b6219a81eb3ab}{golds} = \hyperlink{sp__lev_8c_a6b5f263b8333bc27300bf010f774ccd3}{NewTab}(\hyperlink{structgold}{gold}, n);
1971         \textcolor{keywordflow}{while} (n--) \{
1972             r->\hyperlink{struct__room_a098fb9c2d338496af31b6219a81eb3ab}{golds}[(int)n] = \hyperlink{sp__lev_8c_a8e58aceccc995a7b883ede5dd60dbad5}{New}(\hyperlink{structgold}{gold});
1973             \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) r->\hyperlink{struct__room_a098fb9c2d338496af31b6219a81eb3ab}{golds}[(\textcolor{keywordtype}{int})n], 1, \textcolor{keyword}{sizeof}(
      \hyperlink{structgold}{gold}), fd);
1974         \}
1975 
1976         \textcolor{comment}{/* read the engravings */}
1977         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &r->\hyperlink{struct__room_a3490cb38c5c28a5b859ad715371f9a03}{nengraving}, 1,
1978             \textcolor{keyword}{sizeof}(r->\hyperlink{struct__room_a3490cb38c5c28a5b859ad715371f9a03}{nengraving}), fd);
1979         \textcolor{keywordflow}{if} ((n = r->\hyperlink{struct__room_a3490cb38c5c28a5b859ad715371f9a03}{nengraving}) != 0) \{
1980             r->\hyperlink{struct__room_a39e5c581b788be17eaf8f3669fb7059a}{engravings} = \hyperlink{sp__lev_8c_a6b5f263b8333bc27300bf010f774ccd3}{NewTab}(\hyperlink{structengraving}{engraving},n);
1981             \textcolor{keywordflow}{while} (n--) \{
1982             r->\hyperlink{struct__room_a39e5c581b788be17eaf8f3669fb7059a}{engravings}[(int)n] = \hyperlink{sp__lev_8c_a8e58aceccc995a7b883ede5dd60dbad5}{New}(\hyperlink{structengraving}{engraving});
1983             \hyperlink{sp__lev_8c_a6edfc47664388d12901339007cd83aee}{load\_one\_engraving}(fd, r->\hyperlink{struct__room_a39e5c581b788be17eaf8f3669fb7059a}{engravings}[(\textcolor{keywordtype}{int})n]);
1984             \}
1985         \} \textcolor{keywordflow}{else}
1986             r->\hyperlink{struct__room_a39e5c581b788be17eaf8f3669fb7059a}{engravings} = 0;
1987 
1988     \}
1989 
1990     \textcolor{comment}{/* Now that we have loaded all the rooms, search the}
1991 \textcolor{comment}{     * subrooms and create the links.}
1992 \textcolor{comment}{     */}
1993 
1994     \textcolor{keywordflow}{for} (i = 0; i<\hyperlink{lev__yacc_8c_a45e1d3556bb40a075f6665d5f896a28f}{nrooms}; i++)
1995         \textcolor{keywordflow}{if} (tmproom[i]->parent) \{
1996             \textcolor{comment}{/* Search the parent room */}
1997             \textcolor{keywordflow}{for}(j=0; j<\hyperlink{lev__yacc_8c_a45e1d3556bb40a075f6665d5f896a28f}{nrooms}; j++)
1998             \textcolor{keywordflow}{if} (tmproom[j]->\hyperlink{lev__main_8c_a8f8f80d37794cde9472343e4487ba3eb}{name} && !strcmp(tmproom[j]->\hyperlink{lev__main_8c_a8f8f80d37794cde9472343e4487ba3eb}{name},
1999                                tmproom[i]->parent)) \{
2000                 n = tmproom[j]->\hyperlink{struct__room_a33ab2c6401d14af02e880b4592738002}{nsubroom}++;
2001                 tmproom[j]->\hyperlink{struct__room_a2c343f093ae49664a4fa89b4e3b97518}{subrooms}[(int)n] = tmproom[i];
2002                 \textcolor{keywordflow}{break};
2003             \}
2004         \}
2005 
2006     \textcolor{comment}{/*}
2007 \textcolor{comment}{     * Create the rooms now...}
2008 \textcolor{comment}{     */}
2009 
2010     \textcolor{keywordflow}{for} (i=0; i < \hyperlink{lev__yacc_8c_a45e1d3556bb40a075f6665d5f896a28f}{nrooms}; i++)
2011         \textcolor{keywordflow}{if}(!tmproom[i]->parent)
2012         \hyperlink{sp__lev_8c_a9c5babd949d6728c669aa10a8f95a563}{build\_room}(tmproom[i], (\hyperlink{struct__room}{room} *) 0);
2013 
2014     \hyperlink{sp__lev_8c_a8e56974ec7cfc17438a372c340ef4d83}{free\_rooms}(tmproom, nrooms);
2015 
2016     \textcolor{comment}{/* read the corridors */}
2017 
2018     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &ncorr, \textcolor{keyword}{sizeof}(ncorr), 1, fd);
2019     \textcolor{keywordflow}{for} (i=0; i<ncorr; i++) \{
2020         \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &tmpcor, 1, \textcolor{keyword}{sizeof}(tmpcor), fd);
2021         \hyperlink{sp__lev_8c_a6f7499b11516d8034a446d06dba5b6df}{create\_corridor}(&tmpcor);
2022     \}
2023 
2024     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
2025 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_aecd77c8d5219946f49e15b9b741fec4c}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!load\+\_\+special@{load\+\_\+special}}
\index{load\+\_\+special@{load\+\_\+special}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{load\+\_\+special}]{\setlength{\rightskip}{0pt plus 5cm}{\bf boolean} load\+\_\+special (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{name}
\end{DoxyParamCaption}
) const}}\label{sp__lev_8c_aecd77c8d5219946f49e15b9b741fec4c}


Definition at line 2631 of file sp\+\_\+lev.\+c.



References check\+\_\+version(), dlb, dlb\+\_\+fclose, dlb\+\_\+fopen, F\+A\+L\+S\+E, Fread, load\+\_\+maze(), load\+\_\+rooms(), R\+D\+B\+M\+O\+D\+E, S\+P\+\_\+\+L\+E\+V\+\_\+\+M\+A\+Z\+E, S\+P\+\_\+\+L\+E\+V\+\_\+\+R\+O\+O\+M\+S, and T\+R\+U\+E.



Referenced by makemaz().


\begin{DoxyCode}
2633 \{
2634     \hyperlink{dlb_8h_a2c91af84569791b69abdf2b4644b0ddd}{dlb} *fd;
2635     \textcolor{keywordtype}{boolean} result = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2636     \textcolor{keywordtype}{char} c;
2637     \textcolor{keyword}{struct }\hyperlink{structversion__info}{version\_info} vers\_info;
2638 
2639     fd = \hyperlink{dlb_8h_a46a9ab27d1ae601750baeacc2c0a8d44}{dlb\_fopen}(\hyperlink{lev__main_8c_a8f8f80d37794cde9472343e4487ba3eb}{name}, \hyperlink{dlb_8h_a79632e8c9d823c787062c20ec123ae24}{RDBMODE});
2640     \textcolor{keywordflow}{if} (!fd) \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2641 
2642     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &vers\_info, \textcolor{keyword}{sizeof} vers\_info, 1, fd);
2643     \textcolor{keywordflow}{if} (!\hyperlink{version_8c_a9ab2a6e9d7e125264af1e7446ccd9688}{check\_version}(&vers\_info, \hyperlink{lev__main_8c_a8f8f80d37794cde9472343e4487ba3eb}{name}, \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}))
2644         \textcolor{keywordflow}{goto} give\_up;
2645 
2646     \hyperlink{sp__lev_8c_a1fbca8841781b78ddf173d3f4ada25cd}{Fread}((\hyperlink{tradstdc_8h_ad4a7dab7269b4b00e3c7c7d2e66f31cd}{genericptr\_t}) &c, \textcolor{keyword}{sizeof} c, 1, fd); \textcolor{comment}{/* c Header */}
2647 
2648     \textcolor{keywordflow}{switch} (c) \{
2649         \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_a556c49dac370df0beebf516a93ded50b}{SP\_LEV\_ROOMS}:
2650             result = \hyperlink{sp__lev_8c_a9542cf195f5f0ccc13693d734d30c749}{load\_rooms}(fd);
2651             \textcolor{keywordflow}{break};
2652         \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_acb33a58d540409b8f8e444cdbec90b8f}{SP\_LEV\_MAZE}:
2653             result = \hyperlink{sp__lev_8c_ad577bf12221d2cd39282480d8e138391}{load\_maze}(fd);
2654             \textcolor{keywordflow}{break};
2655         \textcolor{keywordflow}{default}:    \textcolor{comment}{/* ??? */}
2656             result = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2657     \}
2658  give\_up:
2659     (void)\hyperlink{dlb_8h_a882e4d8dcdf2cd3d9eee2b94debe38e1}{dlb\_fclose}(fd);
2660     \textcolor{keywordflow}{return} result;
2661 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_ad64df5bd43c6e3845f5df184fa4df0d3}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!maze1xy@{maze1xy}}
\index{maze1xy@{maze1xy}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{maze1xy}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void maze1xy (
\begin{DoxyParamCaption}
\item[{{\bf coord} $\ast$}]{m, }
\item[{int}]{humidity}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ad64df5bd43c6e3845f5df184fa4df0d3}


Definition at line 2035 of file sp\+\_\+lev.\+c.



References is\+\_\+ok\+\_\+location(), rn1, x\+\_\+maze\+\_\+max, and y\+\_\+maze\+\_\+max.



Referenced by load\+\_\+maze().


\begin{DoxyCode}
2038 \{
2039     \textcolor{keyword}{register} \textcolor{keywordtype}{int} x, y, tryct = 2000;
2040     \textcolor{comment}{/* tryct:  normally it won't take more than ten or so tries due}
2041 \textcolor{comment}{       to the circumstances under which we'll be called, but the}
2042 \textcolor{comment}{       `humidity' screening might drastically change the chances */}
2043 
2044     \textcolor{keywordflow}{do} \{
2045         x = \hyperlink{hack_8h_af107ca092682647f298989038020f9c8}{rn1}(\hyperlink{decl_8h_a5a8f3e210dcf5e1b8319f220200f7e91}{x\_maze\_max} - 3, 3);
2046         y = \hyperlink{hack_8h_af107ca092682647f298989038020f9c8}{rn1}(\hyperlink{decl_8h_a148ae7e81a85b4cab11815530f82da17}{y\_maze\_max} - 3, 3);
2047         \textcolor{keywordflow}{if} (--tryct < 0) \textcolor{keywordflow}{break}; \textcolor{comment}{/* give up */}
2048     \} \textcolor{keywordflow}{while} (!(x % 2) || !(y % 2) || \hyperlink{sp__lev_8c_a8759e0f6c69dca527985b85d1c66dc9c}{Map}[x][y] ||
2049          !\hyperlink{sp__lev_8c_a3aed0a0dffcf9b69d63541ae4131b8ae}{is\_ok\_location}((\hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar})x, (\hyperlink{config_8h_a0fd9ce9d735064461bebfe6037026093}{schar})y, humidity));
2050 
2051     m->\hyperlink{structcoord_ac3e93ff628aa19d2888c5f6fa26f430d}{x} = (\hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar})x,  m->\hyperlink{structcoord_a2b099692d87f98e4844b615136ca37fb}{y} = (\hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar})y;
2052 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_acb5f9f6f1d638792de4bf47cf91791df}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!N\+D\+E\+C\+L@{N\+D\+E\+C\+L}}
\index{N\+D\+E\+C\+L@{N\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{N\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} void N\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf fix\+\_\+stair\+\_\+rooms}}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_acb5f9f6f1d638792de4bf47cf91791df}
\hypertarget{sp__lev_8c_aba392794b4c61e2b96fbc2b4d6218cbd}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!N\+D\+E\+C\+L@{N\+D\+E\+C\+L}}
\index{N\+D\+E\+C\+L@{N\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{N\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int N\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf rnddoor}}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_aba392794b4c61e2b96fbc2b4d6218cbd}
\hypertarget{sp__lev_8c_a2aee9c25fdc340cd3fb629c776e9c561}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!N\+D\+E\+C\+L@{N\+D\+E\+C\+L}}
\index{N\+D\+E\+C\+L@{N\+D\+E\+C\+L}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{N\+D\+E\+C\+L}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+D\+C\+L} int N\+D\+E\+C\+L (
\begin{DoxyParamCaption}
\item[{{\bf rndtrap}}]{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a2aee9c25fdc340cd3fb629c776e9c561}
\hypertarget{sp__lev_8c_a6f4731127240a202064d8a77defa7c0b}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!noncoalignment@{noncoalignment}}
\index{noncoalignment@{noncoalignment}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{noncoalignment}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int noncoalignment (
\begin{DoxyParamCaption}
\item[{{\bf aligntyp}}]{alignment}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a6f4731127240a202064d8a77defa7c0b}


Definition at line 735 of file sp\+\_\+lev.\+c.



Referenced by create\+\_\+altar(), and create\+\_\+monster().


\begin{DoxyCode}
737 \{
738     \textcolor{keywordtype}{int} k;
739 
740     k = rn2(2);
741     \textcolor{keywordflow}{if} (!alignment)
742         \textcolor{keywordflow}{return}(k ? -1 : 1);
743     \textcolor{keywordflow}{return}(k ? -alignment : 0);
744 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a4afc679d2766b5aac3e3d2d9c3737efe}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!rnddoor@{rnddoor}}
\index{rnddoor@{rnddoor}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{rnddoor}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int rnddoor (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a4afc679d2766b5aac3e3d2d9c3737efe}


Definition at line 120 of file sp\+\_\+lev.\+c.



Referenced by load\+\_\+maze().


\begin{DoxyCode}
121 \{
122     \textcolor{keywordtype}{int} i = 1 << rn2(5);
123     i >>= 1;
124     \textcolor{keywordflow}{return} i;
125 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a08d42781cf218d72107acf7696461a90}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!rndtrap@{rndtrap}}
\index{rndtrap@{rndtrap}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{rndtrap}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} int rndtrap (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a08d42781cf218d72107acf7696461a90}


Definition at line 131 of file sp\+\_\+lev.\+c.



References dlevel\+\_\+t\+::flags, H\+O\+L\+E, In\+\_\+endgame, level, L\+E\+V\+E\+L\+\_\+\+T\+E\+L\+E\+P, M\+A\+G\+I\+C\+\_\+\+P\+O\+R\+T\+A\+L, N\+O\+\_\+\+T\+R\+A\+P, R\+O\+C\+K\+T\+R\+A\+P, R\+O\+L\+L\+I\+N\+G\+\_\+\+B\+O\+U\+L\+D\+E\+R\+\_\+\+T\+R\+A\+P, T\+E\+L\+E\+P\+\_\+\+T\+R\+A\+P, T\+R\+A\+P\+D\+O\+O\+R, T\+R\+A\+P\+N\+U\+M, u, and you\+::uz.



Referenced by load\+\_\+maze().


\begin{DoxyCode}
132 \{
133     \textcolor{keywordtype}{int} rtrap;
134 
135     \textcolor{keywordflow}{do} \{
136         rtrap = rnd(\hyperlink{trap_8h_a6ecfd62de48aada48010c4fc52beb908}{TRAPNUM}-1);
137         \textcolor{keywordflow}{switch} (rtrap) \{
138          \textcolor{keywordflow}{case} \hyperlink{trap_8h_a8049ef47c05eee8156bccee8d819c506}{HOLE}:     \textcolor{comment}{/* no random holes on special levels */}
139          \textcolor{keywordflow}{case} \hyperlink{trap_8h_a64bfa610e12179ef4bfa46c65166b2fe}{MAGIC\_PORTAL}: rtrap = \hyperlink{trap_8h_af68fb09f448cca56bc40378990469a58}{NO\_TRAP};
140                 \textcolor{keywordflow}{break};
141          \textcolor{keywordflow}{case} \hyperlink{trap_8h_ab50570a3a3e65ed47edb98c63e355088}{TRAPDOOR}: \textcolor{keywordflow}{if} (!Can\_dig\_down(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz})) rtrap = \hyperlink{trap_8h_af68fb09f448cca56bc40378990469a58}{NO\_TRAP};
142                 \textcolor{keywordflow}{break};
143          \textcolor{keywordflow}{case} \hyperlink{trap_8h_a812288857838cc746345ce9e3e7d1368}{LEVEL\_TELEP}:
144          \textcolor{keywordflow}{case} \hyperlink{trap_8h_ae486eaa74be1dd922e16565d281cf94c}{TELEP\_TRAP}: \textcolor{keywordflow}{if} (\hyperlink{rm_8h_a721c99bfa099c4225215ba102e91fa39}{level}.\hyperlink{structdlevel__t_ad52c01d015e2456cdae3300848115916}{flags}.noteleport) rtrap = 
      \hyperlink{trap_8h_af68fb09f448cca56bc40378990469a58}{NO\_TRAP};
145                 \textcolor{keywordflow}{break};
146          \textcolor{keywordflow}{case} \hyperlink{trap_8h_a215ef29fac2b75e5c816a0398d2c4c52}{ROLLING\_BOULDER\_TRAP}:
147          \textcolor{keywordflow}{case} \hyperlink{trap_8h_a8ef04253777645707b7c1df6235b69d6}{ROCKTRAP}: \textcolor{keywordflow}{if} (\hyperlink{dungeon_8h_ae85486e6a752224948478a6e9dab0329}{In\_endgame}(&\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a89878490db5d54221f04b3fb44ebdaa2}{uz})) rtrap = 
      \hyperlink{trap_8h_af68fb09f448cca56bc40378990469a58}{NO\_TRAP};
148                 \textcolor{keywordflow}{break};
149         \}
150     \} \textcolor{keywordflow}{while} (rtrap == \hyperlink{trap_8h_af68fb09f448cca56bc40378990469a58}{NO\_TRAP});
151     \textcolor{keywordflow}{return} rtrap;
152 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a3fa0973072ab41da6a8908299ad70f7c}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!search\+\_\+door@{search\+\_\+door}}
\index{search\+\_\+door@{search\+\_\+door}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{search\+\_\+door}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} {\bf boolean} search\+\_\+door (
\begin{DoxyParamCaption}
\item[{struct {\bf mkroom} $\ast$}]{croom, }
\item[{{\bf xchar} $\ast$}]{x, }
\item[{{\bf xchar} $\ast$}]{y, }
\item[{{\bf xchar}}]{wall, }
\item[{int}]{cnt}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a3fa0973072ab41da6a8908299ad70f7c}


Definition at line 1217 of file sp\+\_\+lev.\+c.



References F\+A\+L\+S\+E, I\+S\+\_\+\+D\+O\+O\+R, levl, panic(), S\+D\+O\+O\+R, T\+R\+U\+E, W\+\_\+\+E\+A\+S\+T, W\+\_\+\+N\+O\+R\+T\+H, W\+\_\+\+S\+O\+U\+T\+H, and W\+\_\+\+W\+E\+S\+T.



Referenced by create\+\_\+corridor().


\begin{DoxyCode}
1222 \{
1223     \textcolor{keywordtype}{int} dx, dy;
1224     \textcolor{keywordtype}{int} xx,yy;
1225 
1226     \textcolor{keywordflow}{switch}(wall) \{
1227           \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_a5f689cb20aa2498a4213291bf63c0ea6}{W\_NORTH}:
1228         dy = 0; dx = 1;
1229         xx = croom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx};
1230         yy = croom->\hyperlink{structmkroom_aa767bcbf6e0de868bba6d2a1c7e7182e}{hy} + 1;
1231         \textcolor{keywordflow}{break};
1232           \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_af7883dbd7a068246a1596614dbe13b96}{W\_SOUTH}:
1233         dy = 0; dx = 1;
1234         xx = croom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx};
1235         yy = croom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly} - 1;
1236         \textcolor{keywordflow}{break};
1237           \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_a0733adeaa8b46ec5f371a7bfe4e79cdb}{W\_EAST}:
1238         dy = 1; dx = 0;
1239         xx = croom->\hyperlink{structmkroom_a1b738b591a7735add2af6d918c556543}{hx} + 1;
1240         yy = croom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly};
1241         \textcolor{keywordflow}{break};
1242           \textcolor{keywordflow}{case} \hyperlink{sp__lev_8h_a59a97200f26ccd6a0426bb2f6384c226}{W\_WEST}:
1243         dy = 1; dx = 0;
1244         xx = croom->\hyperlink{structmkroom_afbd368ef987a49bd9ea830f2019a565f}{lx} - 1;
1245         yy = croom->\hyperlink{structmkroom_af60defeaae679cf06715a5b645e0d8b8}{ly};
1246         \textcolor{keywordflow}{break};
1247           \textcolor{keywordflow}{default}:
1248         dx = dy = xx = yy = 0;
1249         \hyperlink{txt2iff_8c_ab0824b6f5eb51db9371d2e9a222249d3}{panic}(\textcolor{stringliteral}{"search\_door: Bad wall!"});
1250         \textcolor{keywordflow}{break};
1251     \}
1252     \textcolor{keywordflow}{while} (xx <= croom->hx+1 && yy <= croom->hy+1) \{
1253         \textcolor{keywordflow}{if} (\hyperlink{rm_8h_a44de5677b6310b3b96cad756e24b59d9}{IS\_DOOR}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[xx][yy].typ) || \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[xx][yy].typ == 
      \hyperlink{rm_8h_a03fd0fa1e0dbd19ea38dff0c79e656a5}{SDOOR}) \{
1254             *x = xx;
1255             *y = yy;
1256             \textcolor{keywordflow}{if} (cnt-- <= 0)
1257                 \textcolor{keywordflow}{return} \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1258         \}
1259         xx += dx;
1260         yy += dy;
1261     \}
1262     \textcolor{keywordflow}{return} \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1263 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_ac3e80e7bc7afed094c7af15df57677fd}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!set\+\_\+wall\+\_\+property@{set\+\_\+wall\+\_\+property}}
\index{set\+\_\+wall\+\_\+property@{set\+\_\+wall\+\_\+property}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{set\+\_\+wall\+\_\+property}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void set\+\_\+wall\+\_\+property (
\begin{DoxyParamCaption}
\item[{{\bf xchar}}]{x1, }
\item[{{\bf xchar}}]{y1, }
\item[{{\bf xchar}}]{x2, }
\item[{{\bf xchar}}]{y2, }
\item[{int}]{prop}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_ac3e80e7bc7afed094c7af15df57677fd}


Definition at line 104 of file sp\+\_\+lev.\+c.



References I\+S\+\_\+\+S\+T\+W\+A\+L\+L, and levl.



Referenced by load\+\_\+maze().


\begin{DoxyCode}
107 \{
108     \textcolor{keyword}{register} \hyperlink{global_8h_a2043b7d01ce89f4ee2fa6c345a752d32}{xchar} x, y;
109 
110     \textcolor{keywordflow}{for}(y = y1; y <= y2; y++)
111         \textcolor{keywordflow}{for}(x = x1; x <= x2; x++)
112         \textcolor{keywordflow}{if}(\hyperlink{rm_8h_adeca168807e617d1a199f722556a49ea}{IS\_STWALL}(\hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].typ))
113             \hyperlink{rm_8h_a8cd681fba60fdedbabfd71a0b4bbfc00}{levl}[x][y].wall\_info |= \hyperlink{structprop}{prop};
114 \}
\end{DoxyCode}
\hypertarget{sp__lev_8c_a319f933b60e9c45af293065eeb52bde8}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!sp\+\_\+lev\+\_\+shuffle@{sp\+\_\+lev\+\_\+shuffle}}
\index{sp\+\_\+lev\+\_\+shuffle@{sp\+\_\+lev\+\_\+shuffle}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{sp\+\_\+lev\+\_\+shuffle}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+T\+A\+T\+I\+C\+\_\+\+O\+V\+L} void sp\+\_\+lev\+\_\+shuffle (
\begin{DoxyParamCaption}
\item[{list1}]{, }
\item[{list2}]{, }
\item[{int}]{n}
\end{DoxyParamCaption}
)}}\label{sp__lev_8c_a319f933b60e9c45af293065eeb52bde8}


Definition at line 236 of file sp\+\_\+lev.\+c.



Referenced by load\+\_\+maze(), and load\+\_\+rooms().


\begin{DoxyCode}
239 \{
240     \textcolor{keyword}{register} \textcolor{keywordtype}{int} i, j;
241     \textcolor{keyword}{register} \textcolor{keywordtype}{char} k;
242 
243     \textcolor{keywordflow}{for} (i = n - 1; i > 0; i--) \{
244         \textcolor{keywordflow}{if} ((j = rn2(i + 1)) == i) \textcolor{keywordflow}{continue};
245         k = list1[j];
246         list1[j] = list1[i];
247         list1[i] = k;
248         \textcolor{keywordflow}{if} (list2) \{
249             k = list2[j];
250             list2[j] = list2[i];
251             list2[i] = k;
252         \}
253     \}
254 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{sp__lev_8c_ac2ea43aa4412d3297d8af7faf0b1c927}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!init\+\_\+lev@{init\+\_\+lev}}
\index{init\+\_\+lev@{init\+\_\+lev}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{init\+\_\+lev}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lev\+\_\+init} init\+\_\+lev}}\label{sp__lev_8c_ac2ea43aa4412d3297d8af7faf0b1c927}


Definition at line 97 of file sp\+\_\+lev.\+c.

\hypertarget{sp__lev_8c_a8a8cfd6f51acd4c0a227a5332be69227}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!lev\+\_\+message@{lev\+\_\+message}}
\index{lev\+\_\+message@{lev\+\_\+message}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{lev\+\_\+message}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ lev\+\_\+message = 0}}\label{sp__lev_8c_a8a8cfd6f51acd4c0a227a5332be69227}


Definition at line 94 of file sp\+\_\+lev.\+c.



Referenced by fixup\+\_\+special().

\hypertarget{sp__lev_8c_a5195d0e282f5603843e4a384e9995caa}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!lregions@{lregions}}
\index{lregions@{lregions}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{lregions}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lev\+\_\+region}$\ast$ lregions = 0}}\label{sp__lev_8c_a5195d0e282f5603843e4a384e9995caa}


Definition at line 95 of file sp\+\_\+lev.\+c.



Referenced by fixup\+\_\+special(), load\+\_\+maze(), and store\+\_\+part().

\hypertarget{sp__lev_8c_a8759e0f6c69dca527985b85d1c66dc9c}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!Map@{Map}}
\index{Map@{Map}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{Map}]{\setlength{\rightskip}{0pt plus 5cm}char Map\mbox{[}{\bf C\+O\+L\+N\+O}\mbox{]}\mbox{[}{\bf R\+O\+W\+N\+O}\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}}\label{sp__lev_8c_a8759e0f6c69dca527985b85d1c66dc9c}


Definition at line 71 of file sp\+\_\+lev.\+c.



Referenced by load\+\_\+maze().

\hypertarget{sp__lev_8c_abc15291b7b86b60e0c490c8e8cbe0e51}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!max\+\_\+rx@{max\+\_\+rx}}
\index{max\+\_\+rx@{max\+\_\+rx}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{max\+\_\+rx}]{\setlength{\rightskip}{0pt plus 5cm}int max\+\_\+rx}}\label{sp__lev_8c_abc15291b7b86b60e0c490c8e8cbe0e51}


Definition at line 24 of file mkmap.\+c.



Referenced by join\+\_\+map().

\hypertarget{sp__lev_8c_aedc93067a733f3fa903cf92c7b0cff4e}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!max\+\_\+ry@{max\+\_\+ry}}
\index{max\+\_\+ry@{max\+\_\+ry}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{max\+\_\+ry}]{\setlength{\rightskip}{0pt plus 5cm}int max\+\_\+ry}}\label{sp__lev_8c_aedc93067a733f3fa903cf92c7b0cff4e}


Definition at line 24 of file mkmap.\+c.



Referenced by join\+\_\+map().

\hypertarget{sp__lev_8c_a894604b3687b9ef24fbd3860e4975fd3}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!min\+\_\+rx@{min\+\_\+rx}}
\index{min\+\_\+rx@{min\+\_\+rx}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{min\+\_\+rx}]{\setlength{\rightskip}{0pt plus 5cm}int min\+\_\+rx}}\label{sp__lev_8c_a894604b3687b9ef24fbd3860e4975fd3}


Definition at line 24 of file mkmap.\+c.

\hypertarget{sp__lev_8c_ad85187115f92107d269ef993f80036f0}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!min\+\_\+ry@{min\+\_\+ry}}
\index{min\+\_\+ry@{min\+\_\+ry}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{min\+\_\+ry}]{\setlength{\rightskip}{0pt plus 5cm}int min\+\_\+ry}}\label{sp__lev_8c_ad85187115f92107d269ef993f80036f0}


Definition at line 24 of file mkmap.\+c.

\hypertarget{sp__lev_8c_a1f90034b6a3d7de0cba06ae8960de3ea}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!num\+\_\+lregions@{num\+\_\+lregions}}
\index{num\+\_\+lregions@{num\+\_\+lregions}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{num\+\_\+lregions}]{\setlength{\rightskip}{0pt plus 5cm}int num\+\_\+lregions = 0}}\label{sp__lev_8c_a1f90034b6a3d7de0cba06ae8960de3ea}


Definition at line 96 of file sp\+\_\+lev.\+c.



Referenced by fixup\+\_\+special().

\hypertarget{sp__lev_8c_a2a0a619642f0bf17e690e1ab33a82b6c}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!ralign@{ralign}}
\index{ralign@{ralign}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{ralign}]{\setlength{\rightskip}{0pt plus 5cm}{\bf aligntyp} ralign\mbox{[}3\mbox{]} = \{ {\bf A\+M\+\_\+\+C\+H\+A\+O\+T\+I\+C}, {\bf A\+M\+\_\+\+N\+E\+U\+T\+R\+A\+L}, {\bf A\+M\+\_\+\+L\+A\+W\+F\+U\+L} \}\hspace{0.3cm}{\ttfamily [static]}}}\label{sp__lev_8c_a2a0a619642f0bf17e690e1ab33a82b6c}


Definition at line 73 of file sp\+\_\+lev.\+c.

\hypertarget{sp__lev_8c_a6179f3acad257eb4f3057010c6a6d187}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!rloc\+\_\+x@{rloc\+\_\+x}}
\index{rloc\+\_\+x@{rloc\+\_\+x}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{rloc\+\_\+x}]{\setlength{\rightskip}{0pt plus 5cm}char rloc\+\_\+x\mbox{[}10\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}}\label{sp__lev_8c_a6179f3acad257eb4f3057010c6a6d187}


Definition at line 72 of file sp\+\_\+lev.\+c.

\hypertarget{sp__lev_8c_a42c30954e08e02960a5096ed70009726}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!rloc\+\_\+y@{rloc\+\_\+y}}
\index{rloc\+\_\+y@{rloc\+\_\+y}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{rloc\+\_\+y}]{\setlength{\rightskip}{0pt plus 5cm}char rloc\+\_\+y\mbox{[}10\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}}\label{sp__lev_8c_a42c30954e08e02960a5096ed70009726}


Definition at line 72 of file sp\+\_\+lev.\+c.

\hypertarget{sp__lev_8c_af35c3f24113af660b5d6e6b4105032e0}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!rmonst@{rmonst}}
\index{rmonst@{rmonst}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{rmonst}]{\setlength{\rightskip}{0pt plus 5cm}char rmonst\mbox{[}10\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}}\label{sp__lev_8c_af35c3f24113af660b5d6e6b4105032e0}


Definition at line 72 of file sp\+\_\+lev.\+c.

\hypertarget{sp__lev_8c_a4c62499de047bc3a15f32e4f14c00c66}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!robjects@{robjects}}
\index{robjects@{robjects}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{robjects}]{\setlength{\rightskip}{0pt plus 5cm}char robjects\mbox{[}10\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}}\label{sp__lev_8c_a4c62499de047bc3a15f32e4f14c00c66}


Definition at line 72 of file sp\+\_\+lev.\+c.

\hypertarget{sp__lev_8c_a31e63fe41665cf88ce4da8060a209b78}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!walklist@{walklist}}
\index{walklist@{walklist}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{walklist}]{\setlength{\rightskip}{0pt plus 5cm}{\bf N\+E\+A\+R\+D\+A\+T\+A} {\bf walk} walklist\mbox{[}50\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}}\label{sp__lev_8c_a31e63fe41665cf88ce4da8060a209b78}


Definition at line 68 of file sp\+\_\+lev.\+c.

\hypertarget{sp__lev_8c_a22122ed2c15d87f3ff9e3dad23423244}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!xsize@{xsize}}
\index{xsize@{xsize}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{xsize}]{\setlength{\rightskip}{0pt plus 5cm}{\bf N\+E\+A\+R\+D\+A\+T\+A} char xsize\hspace{0.3cm}{\ttfamily [static]}}}\label{sp__lev_8c_a22122ed2c15d87f3ff9e3dad23423244}


Definition at line 75 of file sp\+\_\+lev.\+c.



Referenced by amiv\+\_\+flush\+\_\+glyph\+\_\+buffer(), Do\+Menu\+Scroll(), get\+\_\+location(), load\+\_\+maze(), main(), and My\+Alloc\+Bit\+Map().

\hypertarget{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!xstart@{xstart}}
\index{xstart@{xstart}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{xstart}]{\setlength{\rightskip}{0pt plus 5cm}{\bf N\+E\+A\+R\+D\+A\+T\+A} {\bf xchar} xstart\hspace{0.3cm}{\ttfamily [static]}}}\label{sp__lev_8c_a67293d0e0b4dd16bc44cdc6b3cddebbe}


Definition at line 74 of file sp\+\_\+lev.\+c.



Referenced by get\+\_\+location().

\hypertarget{sp__lev_8c_a17f6fa5b5051ab79afe70d9598576009}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!ysize@{ysize}}
\index{ysize@{ysize}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{ysize}]{\setlength{\rightskip}{0pt plus 5cm}{\bf N\+E\+A\+R\+D\+A\+T\+A} char ysize\hspace{0.3cm}{\ttfamily [static]}}}\label{sp__lev_8c_a17f6fa5b5051ab79afe70d9598576009}


Definition at line 75 of file sp\+\_\+lev.\+c.



Referenced by amiv\+\_\+flush\+\_\+glyph\+\_\+buffer(), Do\+Menu\+Scroll(), get\+\_\+location(), load\+\_\+maze(), main(), and My\+Alloc\+Bit\+Map().

\hypertarget{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}{\index{sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}!ystart@{ystart}}
\index{ystart@{ystart}!sp\+\_\+lev.\+c@{sp\+\_\+lev.\+c}}
\subsubsection[{ystart}]{\setlength{\rightskip}{0pt plus 5cm}{\bf N\+E\+A\+R\+D\+A\+T\+A} {\bf xchar} ystart\hspace{0.3cm}{\ttfamily [static]}}}\label{sp__lev_8c_ad0c2bba9ccd096b6fb82a55e293daed9}


Definition at line 74 of file sp\+\_\+lev.\+c.



Referenced by get\+\_\+location().

