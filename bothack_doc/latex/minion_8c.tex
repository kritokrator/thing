\hypertarget{minion_8c}{\section{nethack/src/minion.c File Reference}
\label{minion_8c}\index{nethack/src/minion.\+c@{nethack/src/minion.\+c}}
}
{\ttfamily \#include \char`\"{}hack.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}emin.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}epri.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{minion_8c_a8f102a313e6cd8ad8a4067ebe604fdf3}{Athome}~(\hyperlink{dungeon_8h_a5cd7abaad3082e8a7b2f5ec30e44d2f4}{Inhell} \&\& !mtmp-\/$>$cham)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{minion_8c_a81b52e95ccc9055c8667999ce20de7cf}{msummon} (struct \hyperlink{structmonst}{monst} $\ast$mon)
\item 
void \hyperlink{minion_8c_a241dff05fee4de3cbbace9bc1a9110b7}{summon\+\_\+minion} (\hyperlink{align_8h_a3e17b7a656899892e425fc89481aa2ab}{aligntyp} alignment, \hyperlink{global_8h_a531b10dd351aa162d7dcccd1966308b8}{boolean} talk)
\item 
int \hyperlink{minion_8c_a503b1229f66b0121dcdb0cb08feec0ce}{demon\+\_\+talk} (struct \hyperlink{structmonst}{monst} $\ast$mtmp)
\item 
long \hyperlink{minion_8c_a899c251edbfde5f18841cbf447c7649f}{bribe} (struct \hyperlink{structmonst}{monst} $\ast$mtmp)
\item 
int \hyperlink{minion_8c_a46273fd6b9806505f7199dd8f7567681}{dprince} (\hyperlink{align_8h_a3e17b7a656899892e425fc89481aa2ab}{aligntyp} atyp)
\item 
int \hyperlink{minion_8c_a28e57747e10523178f3e84e6b3deb450}{dlord} (\hyperlink{align_8h_a3e17b7a656899892e425fc89481aa2ab}{aligntyp} atyp)
\item 
int \hyperlink{minion_8c_a6d7d9ef2992b4b20ac73419e71ce990c}{llord} ()
\item 
int \hyperlink{minion_8c_a6e8a75d6f04c6e178cdba818eae17847}{lminion} ()
\item 
int \hyperlink{minion_8c_a44cebb3fe62fbb6f7d4308bf5b3d31c0}{ndemon} (\hyperlink{align_8h_a3e17b7a656899892e425fc89481aa2ab}{aligntyp} atyp)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{minion_8c_a8f102a313e6cd8ad8a4067ebe604fdf3}{\index{minion.\+c@{minion.\+c}!Athome@{Athome}}
\index{Athome@{Athome}!minion.\+c@{minion.\+c}}
\subsubsection[{Athome}]{\setlength{\rightskip}{0pt plus 5cm}\#define Athome~({\bf Inhell} \&\& !mtmp-\/$>$cham)}}\label{minion_8c_a8f102a313e6cd8ad8a4067ebe604fdf3}


Definition at line 139 of file minion.\+c.



Referenced by demon\+\_\+talk().



\subsection{Function Documentation}
\hypertarget{minion_8c_a899c251edbfde5f18841cbf447c7649f}{\index{minion.\+c@{minion.\+c}!bribe@{bribe}}
\index{bribe@{bribe}!minion.\+c@{minion.\+c}}
\subsubsection[{bribe}]{\setlength{\rightskip}{0pt plus 5cm}long bribe (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mtmp}
\end{DoxyParamCaption}
)}}\label{minion_8c_a899c251edbfde5f18841cbf447c7649f}


Definition at line 207 of file minion.\+c.



References buf, B\+U\+F\+S\+Z, getlin, invent, u, and you\+::ugold.



Referenced by demon\+\_\+talk().


\begin{DoxyCode}
209 \{
210     \textcolor{keywordtype}{char} \hyperlink{xpm2iff_8c_a6f4b9854141692d23b0d072176044ca6}{buf}[\hyperlink{global_8h_ab26c26cbf7a0c97d8960c3cfb413f882}{BUFSZ}];
211     \textcolor{keywordtype}{long} offer;
212 \textcolor{preprocessor}{#ifdef GOLDOBJ}
213     \textcolor{keywordtype}{long} umoney = money\_cnt(\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent});
214 \textcolor{preprocessor}{#endif}
215 
216     \hyperlink{winprocs_8h_ab09682cb017e224c23b0c4e7989a81a7}{getlin}(\textcolor{stringliteral}{"How much will you offer?"}, buf);
217     \textcolor{keywordflow}{if} (sscanf(buf, \textcolor{stringliteral}{"%ld"}, &offer) != 1) offer = 0L;
218 
219     \textcolor{comment}{/*Michael Paddon -- fix for negative offer to monster*/}
220     \textcolor{comment}{/*JAR880815 - */}
221     \textcolor{keywordflow}{if} (offer < 0L) \{
222         You(\textcolor{stringliteral}{"try to shortchange %s, but fumble."},
223             mon\_nam(mtmp));
224         \textcolor{keywordflow}{return} 0L;
225     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (offer == 0L) \{
226         You(\textcolor{stringliteral}{"refuse."});
227         \textcolor{keywordflow}{return} 0L;
228 \textcolor{preprocessor}{#ifndef GOLDOBJ}
229     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (offer >= \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold}) \{
230         You(\textcolor{stringliteral}{"give %s all your gold."}, mon\_nam(mtmp));
231         offer = \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold};
232     \} \textcolor{keywordflow}{else} \{
233         You(\textcolor{stringliteral}{"give %s %ld %s."}, mon\_nam(mtmp), offer, currency(offer));
234     \}
235     \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold} -= offer;
236     mtmp->\hyperlink{structmonst_a06dbdd0ca7ee096216aa10f86beed533}{mgold} += offer;
237 \textcolor{preprocessor}{#else}
238     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (offer >= umoney) \{
239         You(\textcolor{stringliteral}{"give %s all your gold."}, mon\_nam(mtmp));
240         offer = umoney;
241     \} \textcolor{keywordflow}{else} \{
242         You(\textcolor{stringliteral}{"give %s %ld %s."}, mon\_nam(mtmp), offer, currency(offer));
243     \}
244     (void) money2mon(mtmp, offer);
245 \textcolor{preprocessor}{#endif}
246     \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_a51f16d01a910b52fdf0c05a44739f7d8}{botl} = 1;
247     \textcolor{keywordflow}{return}(offer);
248 \}
\end{DoxyCode}
\hypertarget{minion_8c_a503b1229f66b0121dcdb0cb08feec0ce}{\index{minion.\+c@{minion.\+c}!demon\+\_\+talk@{demon\+\_\+talk}}
\index{demon\+\_\+talk@{demon\+\_\+talk}!minion.\+c@{minion.\+c}}
\subsubsection[{demon\+\_\+talk}]{\setlength{\rightskip}{0pt plus 5cm}int demon\+\_\+talk (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mtmp}
\end{DoxyParamCaption}
)}}\label{minion_8c_a503b1229f66b0121dcdb0cb08feec0ce}


Definition at line 142 of file minion.\+c.



References Athome, Blind, bribe(), monst\+::data, F\+A\+L\+S\+E, flag\+::female, flags, invent, is\+\_\+dprince, permonst\+::mlet, newsym(), obj\+::oartifact, rloc(), rn1, S\+\_\+\+D\+E\+M\+O\+N, tele\+\_\+restrict(), align\+::type, u, you\+::ualign, you\+::ugold, uwep, and youmonst.


\begin{DoxyCode}
144 \{
145     \textcolor{keywordtype}{long} cash, demand, offer;
146 
147     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep} && \hyperlink{decl_8h_a1aefaef88eef9075d8136d19410fd3b1}{uwep}->\hyperlink{structobj_af03ce8a6a0ca51e8d8954fb1a1a31fbe}{oartifact} == ART\_EXCALIBUR) \{
148         pline(\textcolor{stringliteral}{"%s looks very angry."}, Amonnam(mtmp));
149         mtmp->mpeaceful = mtmp->\hyperlink{structmonst_a6d525ec48f9d38cda6accbb0cb39efba}{mtame} = 0;
150         set\_malign(mtmp);
151         \hyperlink{display_8c_a185c6ad6e4c5a6be26a371b9aa17c32e}{newsym}(mtmp->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx}, mtmp->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my});
152         \textcolor{keywordflow}{return} 0;
153     \}
154 
155     \textcolor{comment}{/* Slight advantage given. */}
156     \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_adea0f5aad9185b27a8244ef26d388f15}{is\_dprince}(mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}) && mtmp->minvis) \{
157         mtmp->minvis = mtmp->perminvis = 0;
158         \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind}) pline(\textcolor{stringliteral}{"%s appears before you."}, Amonnam(mtmp));
159         \hyperlink{display_8c_a185c6ad6e4c5a6be26a371b9aa17c32e}{newsym}(mtmp->\hyperlink{structmonst_a9bc20171e986845daccff8aafd8b5194}{mx},mtmp->\hyperlink{structmonst_a0b969d9b6af5b55393f6acfe508c6f08}{my});
160     \}
161     \textcolor{keywordflow}{if} (\hyperlink{decl_8h_ad15893dbcb60e2777ae0dfac9f840858}{youmonst}.\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->\hyperlink{structpermonst_ab402dbf1bed9d0e595a2b3da6558da92}{mlet} == \hyperlink{monsym_8h_a6428ef16323852a393830dbac4bc72ee}{S\_DEMON}) \{    \textcolor{comment}{/* Won't blackmail their own. */}
162         pline(\textcolor{stringliteral}{"%s says, \(\backslash\)"Good hunting, %s.\(\backslash\)""},
163           Amonnam(mtmp), \hyperlink{flag_8h_a997133526e0c6bed44ebc0116a48b50a}{flags}.\hyperlink{structflag_ae3f866c572c50c676ecadf8acccf0c50}{female} ? \textcolor{stringliteral}{"Sister"} : \textcolor{stringliteral}{"Brother"});
164         \textcolor{keywordflow}{if} (!\hyperlink{teleport_8c_ae7a3070a79b803227ad2474af019d5ab}{tele\_restrict}(mtmp)) (void) \hyperlink{teleport_8c_aa6c4370d0e90b61589cd46404ceab176}{rloc}(mtmp, \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
165         \textcolor{keywordflow}{return}(1);
166     \}
167 \textcolor{preprocessor}{#ifndef GOLDOBJ}
168     cash = \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_af666e1fd44c5efe34df9053aef068245}{ugold};
169 \textcolor{preprocessor}{#else}
170     cash = money\_cnt(\hyperlink{decl_8h_a65d03deeacf265a14fa3af961820b33f}{invent});
171 \textcolor{preprocessor}{#endif}
172     demand = (cash * (rnd(80) + 20 * \hyperlink{minion_8c_a8f102a313e6cd8ad8a4067ebe604fdf3}{Athome})) /
173         (100 * (1 + (sgn(\hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a3f202dd89a837a9772a9eb1f1965f30c}{ualign}.\hyperlink{structalign_a0dadfa91b9ff06447f91ea8a2b898827}{type}) == sgn(mtmp->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data}->
      \hyperlink{structpermonst_ad92ab559c3dc08cc1a40f3413377d787}{maligntyp}))));
174 
175     \textcolor{keywordflow}{if} (!demand) \{      \textcolor{comment}{/* you have no gold */}
176         mtmp->mpeaceful = 0;
177         set\_malign(mtmp);
178         \textcolor{keywordflow}{return} 0;
179     \} \textcolor{keywordflow}{else} \{
180         \textcolor{comment}{/* make sure that the demand is unmeetable if the monster}
181 \textcolor{comment}{           has the Amulet, preventing monster from being satisified}
182 \textcolor{comment}{           and removed from the game (along with said Amulet...) */}
183         \textcolor{keywordflow}{if} (mon\_has\_amulet(mtmp))
184         demand = cash + (long)\hyperlink{hack_8h_af107ca092682647f298989038020f9c8}{rn1}(1000,40);
185 
186         pline(\textcolor{stringliteral}{"%s demands %ld %s for safe passage."},
187           Amonnam(mtmp), demand, currency(demand));
188 
189         \textcolor{keywordflow}{if} ((offer = \hyperlink{minion_8c_a899c251edbfde5f18841cbf447c7649f}{bribe}(mtmp)) >= demand) \{
190         pline(\textcolor{stringliteral}{"%s vanishes, laughing about cowardly mortals."},
191               Amonnam(mtmp));
192         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (offer > 0L && (\textcolor{keywordtype}{long})rnd(40) > (demand - offer)) \{
193         pline(\textcolor{stringliteral}{"%s scowls at you menacingly, then vanishes."},
194               Amonnam(mtmp));
195         \} \textcolor{keywordflow}{else} \{
196         pline(\textcolor{stringliteral}{"%s gets angry..."}, Amonnam(mtmp));
197         mtmp->mpeaceful = 0;
198         set\_malign(mtmp);
199         \textcolor{keywordflow}{return} 0;
200         \}
201     \}
202     mongone(mtmp);
203     \textcolor{keywordflow}{return}(1);
204 \}
\end{DoxyCode}
\hypertarget{minion_8c_a28e57747e10523178f3e84e6b3deb450}{\index{minion.\+c@{minion.\+c}!dlord@{dlord}}
\index{dlord@{dlord}!minion.\+c@{minion.\+c}}
\subsubsection[{dlord}]{\setlength{\rightskip}{0pt plus 5cm}int dlord (
\begin{DoxyParamCaption}
\item[{{\bf aligntyp}}]{atyp}
\end{DoxyParamCaption}
)}}\label{minion_8c_a28e57747e10523178f3e84e6b3deb450}


Definition at line 266 of file minion.\+c.



References A\+\_\+\+N\+O\+N\+E, G\+\_\+\+G\+O\+N\+E, permonst\+::maligntyp, mons, ndemon(), and rn1.



Referenced by dosacrifice(), dprince(), and msummon().


\begin{DoxyCode}
268 \{
269     \textcolor{keywordtype}{int} tryct, pm;
270 
271     \textcolor{keywordflow}{for} (tryct = 0; tryct < 20; tryct++) \{
272         pm = \hyperlink{hack_8h_af107ca092682647f298989038020f9c8}{rn1}(PM\_YEENOGHU + 1 - PM\_JUIBLEX, PM\_JUIBLEX);
273         \textcolor{keywordflow}{if} (!(\hyperlink{structmvitals}{mvitals}[pm].mvflags & \hyperlink{monflag_8h_ad600313e20617adbf44819cf9707971a}{G\_GONE}) &&
274             (atyp == \hyperlink{align_8h_abe65d0cb8c8ae018c5bd63a280000eaa}{A\_NONE} || sgn(\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[pm].maligntyp) == sgn(atyp)))
275         \textcolor{keywordflow}{return}(pm);
276     \}
277     \textcolor{keywordflow}{return}(\hyperlink{minion_8c_a44cebb3fe62fbb6f7d4308bf5b3d31c0}{ndemon}(atyp)); \textcolor{comment}{/* approximate */}
278 \}
\end{DoxyCode}
\hypertarget{minion_8c_a46273fd6b9806505f7199dd8f7567681}{\index{minion.\+c@{minion.\+c}!dprince@{dprince}}
\index{dprince@{dprince}!minion.\+c@{minion.\+c}}
\subsubsection[{dprince}]{\setlength{\rightskip}{0pt plus 5cm}int dprince (
\begin{DoxyParamCaption}
\item[{{\bf aligntyp}}]{atyp}
\end{DoxyParamCaption}
)}}\label{minion_8c_a46273fd6b9806505f7199dd8f7567681}


Definition at line 251 of file minion.\+c.



References A\+\_\+\+N\+O\+N\+E, dlord(), G\+\_\+\+G\+O\+N\+E, permonst\+::maligntyp, mons, and rn1.



Referenced by msummon().


\begin{DoxyCode}
253 \{
254     \textcolor{keywordtype}{int} tryct, pm;
255 
256     \textcolor{keywordflow}{for} (tryct = 0; tryct < 20; tryct++) \{
257         pm = \hyperlink{hack_8h_af107ca092682647f298989038020f9c8}{rn1}(PM\_DEMOGORGON + 1 - PM\_ORCUS, PM\_ORCUS);
258         \textcolor{keywordflow}{if} (!(\hyperlink{structmvitals}{mvitals}[pm].mvflags & \hyperlink{monflag_8h_ad600313e20617adbf44819cf9707971a}{G\_GONE}) &&
259             (atyp == \hyperlink{align_8h_abe65d0cb8c8ae018c5bd63a280000eaa}{A\_NONE} || sgn(\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[pm].maligntyp) == sgn(atyp)))
260         \textcolor{keywordflow}{return}(pm);
261     \}
262     \textcolor{keywordflow}{return}(\hyperlink{minion_8c_a28e57747e10523178f3e84e6b3deb450}{dlord}(atyp));   \textcolor{comment}{/* approximate */}
263 \}
\end{DoxyCode}
\hypertarget{minion_8c_a6d7d9ef2992b4b20ac73419e71ce990c}{\index{minion.\+c@{minion.\+c}!llord@{llord}}
\index{llord@{llord}!minion.\+c@{minion.\+c}}
\subsubsection[{llord}]{\setlength{\rightskip}{0pt plus 5cm}int llord (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{minion_8c_a6d7d9ef2992b4b20ac73419e71ce990c}


Definition at line 282 of file minion.\+c.



References G\+\_\+\+G\+O\+N\+E, and lminion().



Referenced by msummon().


\begin{DoxyCode}
283 \{
284     \textcolor{keywordflow}{if} (!(\hyperlink{structmvitals}{mvitals}[PM\_ARCHON].mvflags & \hyperlink{monflag_8h_ad600313e20617adbf44819cf9707971a}{G\_GONE}))
285         \textcolor{keywordflow}{return}(PM\_ARCHON);
286 
287     \textcolor{keywordflow}{return}(\hyperlink{minion_8c_a6e8a75d6f04c6e178cdba818eae17847}{lminion}());   \textcolor{comment}{/* approximate */}
288 \}
\end{DoxyCode}
\hypertarget{minion_8c_a6e8a75d6f04c6e178cdba818eae17847}{\index{minion.\+c@{minion.\+c}!lminion@{lminion}}
\index{lminion@{lminion}!minion.\+c@{minion.\+c}}
\subsubsection[{lminion}]{\setlength{\rightskip}{0pt plus 5cm}int lminion (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{minion_8c_a6e8a75d6f04c6e178cdba818eae17847}


Definition at line 291 of file minion.\+c.



References is\+\_\+lord, N\+O\+N\+\_\+\+P\+M, and S\+\_\+\+A\+N\+G\+E\+L.



Referenced by llord(), msummon(), and summon\+\_\+minion().


\begin{DoxyCode}
292 \{
293     \textcolor{keywordtype}{int} tryct;
294     \textcolor{keyword}{struct  }\hyperlink{structpermonst}{permonst} *ptr;
295 
296     \textcolor{keywordflow}{for} (tryct = 0; tryct < 20; tryct++) \{
297         ptr = mkclass(\hyperlink{monsym_8h_a090fde972c0c8b83a994ae5472ff0852}{S\_ANGEL},0);
298         \textcolor{keywordflow}{if} (ptr && !\hyperlink{mondata_8h_afeb3370436f9f0f0543e3546a2782b3d}{is\_lord}(ptr))
299         \textcolor{keywordflow}{return}(monsndx(ptr));
300     \}
301 
302     \textcolor{keywordflow}{return} \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM};
303 \}
\end{DoxyCode}
\hypertarget{minion_8c_a81b52e95ccc9055c8667999ce20de7cf}{\index{minion.\+c@{minion.\+c}!msummon@{msummon}}
\index{msummon@{msummon}!minion.\+c@{minion.\+c}}
\subsubsection[{msummon}]{\setlength{\rightskip}{0pt plus 5cm}void msummon (
\begin{DoxyParamCaption}
\item[{struct {\bf monst} $\ast$}]{mon}
\end{DoxyParamCaption}
)}}\label{minion_8c_a81b52e95ccc9055c8667999ce20de7cf}


Definition at line 10 of file minion.\+c.



References A\+\_\+\+C\+H\+A\+O\+T\+I\+C, A\+\_\+\+N\+E\+U\+T\+R\+A\+L, A\+\_\+\+N\+O\+N\+E, dlord(), dprince(), E\+P\+R\+I, G\+\_\+\+G\+O\+N\+E, G\+\_\+\+U\+N\+I\+Q, is\+\_\+dlord, is\+\_\+dprince, is\+\_\+lminion, is\+\_\+lord, is\+\_\+ndemon, llord(), lminion(), permonst\+::maligntyp, mons, ndemon(), N\+O\+\_\+\+M\+M\+\_\+\+F\+L\+A\+G\+S, N\+O\+N\+\_\+\+P\+M, u, you\+::ux, and you\+::uy.


\begin{DoxyCode}
12 \{
13     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structpermonst}{permonst} *ptr;
14     \textcolor{keyword}{register} \textcolor{keywordtype}{int} dtype = \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM}, cnt = 0;
15     \hyperlink{align_8h_a3e17b7a656899892e425fc89481aa2ab}{aligntyp} atyp;
16     \textcolor{keyword}{struct }\hyperlink{structmonst}{monst} *mtmp;
17 
18     \textcolor{keywordflow}{if} (mon) \{
19         ptr = mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data};
20         atyp = (ptr->\hyperlink{structpermonst_ad92ab559c3dc08cc1a40f3413377d787}{maligntyp}==\hyperlink{align_8h_abe65d0cb8c8ae018c5bd63a280000eaa}{A\_NONE}) ? \hyperlink{align_8h_abe65d0cb8c8ae018c5bd63a280000eaa}{A\_NONE} : sgn(ptr->
      \hyperlink{structpermonst_ad92ab559c3dc08cc1a40f3413377d787}{maligntyp});
21         \textcolor{keywordflow}{if} (mon->ispriest || mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_ALIGNED\_PRIEST]
22         || mon->\hyperlink{structmonst_a5c8369d63f2ae0ca4466258542edecbe}{data} == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_ANGEL])
23         atyp = \hyperlink{epri_8h_a8af728f8ed3894c68f86757f5308af8f}{EPRI}(mon)->shralign;
24     \} \textcolor{keywordflow}{else} \{
25         ptr = &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_WIZARD\_OF\_YENDOR];
26         atyp = (ptr->\hyperlink{structpermonst_ad92ab559c3dc08cc1a40f3413377d787}{maligntyp}==\hyperlink{align_8h_abe65d0cb8c8ae018c5bd63a280000eaa}{A\_NONE}) ? \hyperlink{align_8h_abe65d0cb8c8ae018c5bd63a280000eaa}{A\_NONE} : sgn(ptr->
      \hyperlink{structpermonst_ad92ab559c3dc08cc1a40f3413377d787}{maligntyp});
27     \}
28         
29     \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_adea0f5aad9185b27a8244ef26d388f15}{is\_dprince}(ptr) || (ptr == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_WIZARD\_OF\_YENDOR])) \{
30         dtype = (!rn2(20)) ? \hyperlink{minion_8c_a46273fd6b9806505f7199dd8f7567681}{dprince}(atyp) :
31                  (!rn2(4)) ? \hyperlink{minion_8c_a28e57747e10523178f3e84e6b3deb450}{dlord}(atyp) : \hyperlink{minion_8c_a44cebb3fe62fbb6f7d4308bf5b3d31c0}{ndemon}(atyp);
32         cnt = (!rn2(4) && \hyperlink{mondata_8h_a4e4710e23825db37f89573ca6ab1e3b4}{is\_ndemon}(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[dtype])) ? 2 : 1;
33     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_ae6e0c04112b1025e2f836baa3c70b320}{is\_dlord}(ptr)) \{
34         dtype = (!rn2(50)) ? \hyperlink{minion_8c_a46273fd6b9806505f7199dd8f7567681}{dprince}(atyp) :
35                  (!rn2(20)) ? \hyperlink{minion_8c_a28e57747e10523178f3e84e6b3deb450}{dlord}(atyp) : \hyperlink{minion_8c_a44cebb3fe62fbb6f7d4308bf5b3d31c0}{ndemon}(atyp);
36         cnt = (!rn2(4) && \hyperlink{mondata_8h_a4e4710e23825db37f89573ca6ab1e3b4}{is\_ndemon}(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[dtype])) ? 2 : 1;
37     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a4e4710e23825db37f89573ca6ab1e3b4}{is\_ndemon}(ptr)) \{
38         dtype = (!rn2(20)) ? \hyperlink{minion_8c_a28e57747e10523178f3e84e6b3deb450}{dlord}(atyp) :
39                  (!rn2(6)) ? \hyperlink{minion_8c_a44cebb3fe62fbb6f7d4308bf5b3d31c0}{ndemon}(atyp) : monsndx(ptr);
40         cnt = 1;
41     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{mondata_8h_a6bd06bc29ef4aaf6e4f982b587e1ea88}{is\_lminion}(mon)) \{
42         dtype = (\hyperlink{mondata_8h_afeb3370436f9f0f0543e3546a2782b3d}{is\_lord}(ptr) && !rn2(20)) ? \hyperlink{minion_8c_a6d7d9ef2992b4b20ac73419e71ce990c}{llord}() :
43              (\hyperlink{mondata_8h_afeb3370436f9f0f0543e3546a2782b3d}{is\_lord}(ptr) || !rn2(6)) ? \hyperlink{minion_8c_a6e8a75d6f04c6e178cdba818eae17847}{lminion}() : monsndx(ptr);
44         cnt = (!rn2(4) && !\hyperlink{mondata_8h_afeb3370436f9f0f0543e3546a2782b3d}{is\_lord}(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[dtype])) ? 2 : 1;
45     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ptr == &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[PM\_ANGEL]) \{
46         \textcolor{comment}{/* non-lawful angels can also summon */}
47         \textcolor{keywordflow}{if} (!rn2(6)) \{
48         \textcolor{keywordflow}{switch} (atyp) \{ \textcolor{comment}{/* see summon\_minion */}
49         \textcolor{keywordflow}{case} \hyperlink{align_8h_a58fee99b3a5a5db767e86d4c6705c9a1}{A\_NEUTRAL}:
50             dtype = PM\_AIR\_ELEMENTAL + rn2(4);
51             \textcolor{keywordflow}{break};
52         \textcolor{keywordflow}{case} \hyperlink{align_8h_a1d8f0bc268ba9729ef2e1cb0d3ea763b}{A\_CHAOTIC}:
53         \textcolor{keywordflow}{case} \hyperlink{align_8h_abe65d0cb8c8ae018c5bd63a280000eaa}{A\_NONE}:
54             dtype = \hyperlink{minion_8c_a44cebb3fe62fbb6f7d4308bf5b3d31c0}{ndemon}(atyp);
55             \textcolor{keywordflow}{break};
56         \}
57         \} \textcolor{keywordflow}{else} \{
58         dtype = PM\_ANGEL;
59         \}
60         cnt = (!rn2(4) && !\hyperlink{mondata_8h_afeb3370436f9f0f0543e3546a2782b3d}{is\_lord}(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[dtype])) ? 2 : 1;
61     \}
62 
63     \textcolor{keywordflow}{if} (dtype == \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM}) \textcolor{keywordflow}{return};
64 
65     \textcolor{comment}{/* sanity checks */}
66     \textcolor{keywordflow}{if} (cnt > 1 && (\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[dtype].geno & \hyperlink{monflag_8h_ab99532c9310183c20279ce79e7f594dd}{G\_UNIQ})) cnt = 1;
67     \textcolor{comment}{/*}
68 \textcolor{comment}{     * If this daemon is unique and being re-summoned (the only way we}
69 \textcolor{comment}{     * could get this far with an extinct dtype), try another.}
70 \textcolor{comment}{     */}
71     \textcolor{keywordflow}{if} (\hyperlink{structmvitals}{mvitals}[dtype].mvflags & \hyperlink{monflag_8h_ad600313e20617adbf44819cf9707971a}{G\_GONE}) \{
72         dtype = \hyperlink{minion_8c_a44cebb3fe62fbb6f7d4308bf5b3d31c0}{ndemon}(atyp);
73         \textcolor{keywordflow}{if} (dtype == \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM}) \textcolor{keywordflow}{return};
74     \}
75 
76     \textcolor{keywordflow}{while} (cnt > 0) \{
77         mtmp = makemon(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[dtype], \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}, \hyperlink{hack_8h_ae449582f467baa0da531a6ea116a18f2}{NO\_MM\_FLAGS});
78         \textcolor{keywordflow}{if} (mtmp && (dtype == PM\_ANGEL)) \{
79         \textcolor{comment}{/* alignment should match the summoner */}
80         \hyperlink{epri_8h_a8af728f8ed3894c68f86757f5308af8f}{EPRI}(mtmp)->shralign = atyp;
81         \}
82         cnt--;
83     \}
84 \}
\end{DoxyCode}
\hypertarget{minion_8c_a44cebb3fe62fbb6f7d4308bf5b3d31c0}{\index{minion.\+c@{minion.\+c}!ndemon@{ndemon}}
\index{ndemon@{ndemon}!minion.\+c@{minion.\+c}}
\subsubsection[{ndemon}]{\setlength{\rightskip}{0pt plus 5cm}int ndemon (
\begin{DoxyParamCaption}
\item[{{\bf aligntyp}}]{atyp}
\end{DoxyParamCaption}
)}}\label{minion_8c_a44cebb3fe62fbb6f7d4308bf5b3d31c0}


Definition at line 306 of file minion.\+c.



References A\+\_\+\+N\+O\+N\+E, is\+\_\+ndemon, permonst\+::maligntyp, N\+O\+N\+\_\+\+P\+M, and S\+\_\+\+D\+E\+M\+O\+N.



Referenced by demonpet(), dlord(), msummon(), and summon\+\_\+minion().


\begin{DoxyCode}
308 \{
309     \textcolor{keywordtype}{int} tryct;
310     \textcolor{keyword}{struct  }\hyperlink{structpermonst}{permonst} *ptr;
311 
312     \textcolor{keywordflow}{for} (tryct = 0; tryct < 20; tryct++) \{
313         ptr = mkclass(\hyperlink{monsym_8h_a6428ef16323852a393830dbac4bc72ee}{S\_DEMON}, 0);
314         \textcolor{keywordflow}{if} (ptr && \hyperlink{mondata_8h_a4e4710e23825db37f89573ca6ab1e3b4}{is\_ndemon}(ptr) &&
315             (atyp == \hyperlink{align_8h_abe65d0cb8c8ae018c5bd63a280000eaa}{A\_NONE} || sgn(ptr->\hyperlink{structpermonst_ad92ab559c3dc08cc1a40f3413377d787}{maligntyp}) == sgn(atyp)))
316         \textcolor{keywordflow}{return}(monsndx(ptr));
317     \}
318 
319     \textcolor{keywordflow}{return} \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM};
320 \}
\end{DoxyCode}
\hypertarget{minion_8c_a241dff05fee4de3cbbace9bc1a9110b7}{\index{minion.\+c@{minion.\+c}!summon\+\_\+minion@{summon\+\_\+minion}}
\index{summon\+\_\+minion@{summon\+\_\+minion}!minion.\+c@{minion.\+c}}
\subsubsection[{summon\+\_\+minion}]{\setlength{\rightskip}{0pt plus 5cm}void summon\+\_\+minion (
\begin{DoxyParamCaption}
\item[{{\bf aligntyp}}]{alignment, }
\item[{{\bf boolean}}]{talk}
\end{DoxyParamCaption}
)}}\label{minion_8c_a241dff05fee4de3cbbace9bc1a9110b7}


Definition at line 87 of file minion.\+c.



References A\+\_\+\+C\+H\+A\+O\+T\+I\+C, A\+\_\+\+L\+A\+W\+F\+U\+L, A\+\_\+\+N\+E\+U\+T\+R\+A\+L, A\+\_\+\+N\+O\+N\+E, align\+\_\+gname(), Blind, E\+M\+I\+N, E\+P\+R\+I, F\+A\+L\+S\+E, lminion(), M\+M\+\_\+\+E\+M\+I\+N, monst\+::mnum, mons, ndemon(), N\+O\+\_\+\+M\+M\+\_\+\+F\+L\+A\+G\+S, N\+O\+N\+\_\+\+P\+M, T\+R\+U\+E, u, you\+::ux, and you\+::uy.



Referenced by angrygods(), dosacrifice(), and god\+\_\+zaps\+\_\+you().


\begin{DoxyCode}
90 \{
91     \textcolor{keyword}{register} \textcolor{keyword}{struct }\hyperlink{structmonst}{monst} *mon;
92     \textcolor{keywordtype}{int} \hyperlink{structmonst_a1a7aab6d8ab6271ccb21d34806c73f47}{mnum};
93 
94     \textcolor{keywordflow}{switch} ((\textcolor{keywordtype}{int})alignment) \{
95     \textcolor{keywordflow}{case} \hyperlink{align_8h_aa21537fe5fcc5cd77de27bc6907ecc6a}{A\_LAWFUL}:
96         mnum = \hyperlink{minion_8c_a6e8a75d6f04c6e178cdba818eae17847}{lminion}();
97         \textcolor{keywordflow}{break};
98     \textcolor{keywordflow}{case} \hyperlink{align_8h_a58fee99b3a5a5db767e86d4c6705c9a1}{A\_NEUTRAL}:
99         mnum = PM\_AIR\_ELEMENTAL + rn2(4);
100         \textcolor{keywordflow}{break};
101     \textcolor{keywordflow}{case} \hyperlink{align_8h_a1d8f0bc268ba9729ef2e1cb0d3ea763b}{A\_CHAOTIC}:
102     \textcolor{keywordflow}{case} \hyperlink{align_8h_abe65d0cb8c8ae018c5bd63a280000eaa}{A\_NONE}:
103         mnum = \hyperlink{minion_8c_a44cebb3fe62fbb6f7d4308bf5b3d31c0}{ndemon}(alignment);
104         \textcolor{keywordflow}{break};
105     \textcolor{keywordflow}{default}:
106         impossible(\textcolor{stringliteral}{"unaligned player?"});
107         mnum = \hyperlink{minion_8c_a44cebb3fe62fbb6f7d4308bf5b3d31c0}{ndemon}(\hyperlink{align_8h_abe65d0cb8c8ae018c5bd63a280000eaa}{A\_NONE});
108         \textcolor{keywordflow}{break};
109     \}
110     \textcolor{keywordflow}{if} (mnum == \hyperlink{permonst_8h_a6485376b5cfc1627d2c68fcb98432cb0}{NON\_PM}) \{
111     mon = 0;
112     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[mnum].pxlth == 0) \{
113     \textcolor{keyword}{struct }\hyperlink{structpermonst}{permonst} *pm = &\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[mnum];
114     mon = makemon(pm, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}, \hyperlink{hack_8h_a748ce8be8371670ccbbc5e5debfc2e18}{MM\_EMIN});
115     \textcolor{keywordflow}{if} (mon) \{
116         mon->isminion = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
117         \hyperlink{emin_8h_aeda364b460b280fc3499c0f672979186}{EMIN}(mon)->min\_align = alignment;
118     \}
119     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mnum == PM\_ANGEL) \{
120     mon = makemon(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[mnum], \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}, \hyperlink{hack_8h_ae449582f467baa0da531a6ea116a18f2}{NO\_MM\_FLAGS});
121     \textcolor{keywordflow}{if} (mon) \{
122         mon->isminion = \hyperlink{global_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
123         \hyperlink{epri_8h_a8af728f8ed3894c68f86757f5308af8f}{EPRI}(mon)->shralign = alignment;    \textcolor{comment}{/* always A\_LAWFUL here */}
124     \}
125     \} \textcolor{keywordflow}{else}
126     mon = makemon(&\hyperlink{permonst_8h_ab96e7c4682ea5ae4f83339a15c06f676}{mons}[mnum], \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_ace2fd92f7f1a640e45775efe6e5f6cf7}{ux}, \hyperlink{decl_8h_a342ae6d3415cd569bcea437201040743}{u}.\hyperlink{structyou_a8571cf3a9cfc41c3f877d0f56cda11a9}{uy}, \hyperlink{hack_8h_ae449582f467baa0da531a6ea116a18f2}{NO\_MM\_FLAGS});
127     \textcolor{keywordflow}{if} (mon) \{
128     \textcolor{keywordflow}{if} (talk) \{
129         pline\_The(\textcolor{stringliteral}{"voice of %s booms:"}, \hyperlink{pray_8c_af3e995a7dd99833d915ecd826c5f610e}{align\_gname}(alignment));
130         verbalize(\textcolor{stringliteral}{"Thou shalt pay for thy indiscretion!"});
131         \textcolor{keywordflow}{if} (!\hyperlink{youprop_8h_a1b6e24068169af4177e15b48595c08c9}{Blind})
132         pline(\textcolor{stringliteral}{"%s appears before you."}, Amonnam(mon));
133     \}
134     mon->mpeaceful = \hyperlink{global_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
135     \textcolor{comment}{/* don't call set\_malign(); player was naughty */}
136     \}
137 \}
\end{DoxyCode}
